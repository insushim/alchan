{"version":3,"file":"static/js/710.0cdf5197.chunk.js","mappings":"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","sources":["pages/government/NationalTaxService.js","pages/banking/Investment.js","pages/banking/SendReceive.js","pages/government/Government.js"],"sourcesContent":["// src/NationalTaxService.js\r\nimport React, { useState, useEffect, useCallback } from \"react\";\r\nimport { db, getCachedDocument, invalidateCache } from \"../../firebase\";\r\nimport {\r\n  doc,\r\n  getDoc,\r\n  updateDoc,\r\n  setDoc,\r\n  serverTimestamp,\r\n  increment,\r\n} from \"firebase/firestore\";\r\nimport { usePolling } from \"../../hooks/usePolling\";\r\nimport { formatKoreanCurrency } from \"../../numberFormatter\";\r\n\r\nconst formatDate = (timestamp) => {\r\n  if (!timestamp) return \"-\";\r\n  const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\r\n  if (isNaN(date.getTime())) return \"ìœ íš¨í•˜ì§€ ì•Šì€ ë‚ ì§œ\";\r\n  return date.toLocaleString(\"ko-KR\");\r\n};\r\n\r\nconst DEFAULT_TREASURY_DATA = {\r\n  totalAmount: 0,\r\n  stockTaxRevenue: 0,\r\n  stockCommissionRevenue: 0,\r\n  realEstateTransactionTaxRevenue: 0,\r\n  vatRevenue: 0,\r\n  auctionTaxRevenue: 0,\r\n  propertyHoldingTaxRevenue: 0,\r\n  itemMarketTaxRevenue: 0,\r\n  incomeTaxRevenue: 0,\r\n  corporateTaxRevenue: 0,\r\n  otherTaxRevenue: 0,\r\n  lastUpdated: null,\r\n};\r\n\r\nconst DEFAULT_TAX_SETTINGS = {\r\n  stockTransactionTaxRate: 0.01,\r\n  realEstateTransactionTaxRate: 0.03,\r\n  itemStoreVATRate: 0.1,\r\n  auctionTransactionTaxRate: 0.03,\r\n  propertyHoldingTaxRate: 0.002,\r\n  propertyHoldingTaxInterval: \"weekly\",\r\n  itemMarketTransactionTaxRate: 0.03,\r\n  lastUpdated: null,\r\n};\r\n\r\nconst NationalTaxService = ({ classCode }) => {\r\n  const [treasuryData, setTreasuryData] = useState(DEFAULT_TREASURY_DATA);\r\n  const [taxSettings, setTaxSettings] = useState(DEFAULT_TAX_SETTINGS);\r\n  const [loadingTreasury, setLoadingTreasury] = useState(true);\r\n  const [loadingSettings, setLoadingSettings] = useState(true);\r\n  const [activeTab, setActiveTab] = useState(\"overview\");\r\n  const [editableSettings, setEditableSettings] = useState(DEFAULT_TAX_SETTINGS);\r\n\r\n  const fetchTreasuryData = useCallback(async () => {\r\n    if (!classCode) {\r\n      setLoadingTreasury(false);\r\n      setTreasuryData(DEFAULT_TREASURY_DATA);\r\n      return;\r\n    }\r\n    setLoadingTreasury(true);\r\n    const treasuryRef = doc(db, \"nationalTreasuries\", classCode);\r\n    try {\r\n      const cached = await getCachedDocument(\"nationalTreasuries\", classCode, 5 * 60 * 1000);\r\n      if (cached) {\r\n        setTreasuryData({ ...DEFAULT_TREASURY_DATA, ...cached });\r\n        setLoadingTreasury(false);\r\n        return;\r\n      }\r\n\r\n      const docSnap = await getDoc(treasuryRef);\r\n      if (docSnap.exists()) {\r\n        setTreasuryData({ ...DEFAULT_TREASURY_DATA, ...docSnap.data() });\r\n        invalidateCache(`doc_nationalTreasuries_${classCode}`);\r\n      } else {\r\n        await setDoc(treasuryRef, {\r\n          ...DEFAULT_TREASURY_DATA,\r\n          createdAt: serverTimestamp(),\r\n          lastUpdated: serverTimestamp(),\r\n        });\r\n        invalidateCache(`doc_nationalTreasuries_${classCode}`);\r\n        setTreasuryData({\r\n          ...DEFAULT_TREASURY_DATA,\r\n          lastUpdated: new Date(),\r\n        });\r\n      }\r\n      setLoadingTreasury(false);\r\n    } catch (error) {\r\n      console.error(`[${classCode}] êµ­ê³  ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:`, error);\r\n      setLoadingTreasury(false);\r\n    }\r\n  }, [classCode]);\r\n\r\n  const { refetch: refetchTreasury } = usePolling(fetchTreasuryData, { interval: 300000, enabled: !!classCode });\r\n\r\n  const fetchTaxSettings = useCallback(async () => {\r\n    if (!classCode) {\r\n      setLoadingSettings(false);\r\n      setTaxSettings(DEFAULT_TAX_SETTINGS);\r\n      setEditableSettings(DEFAULT_TAX_SETTINGS);\r\n      return;\r\n    }\r\n    setLoadingSettings(true);\r\n    const settingsRef = doc(db, \"governmentSettings\", classCode);\r\n    try {\r\n      const cached = await getCachedDocument(\"governmentSettings\", classCode, 5 * 60 * 1000);\r\n      if (cached?.taxSettings) {\r\n        const newSettings = { ...DEFAULT_TAX_SETTINGS, ...cached.taxSettings };\r\n        setTaxSettings(newSettings);\r\n        setEditableSettings(newSettings);\r\n        setLoadingSettings(false);\r\n        return;\r\n      }\r\n\r\n      const docSnap = await getDoc(settingsRef);\r\n      if (docSnap.exists() && docSnap.data().taxSettings) {\r\n        const newSettings = { ...DEFAULT_TAX_SETTINGS, ...docSnap.data().taxSettings };\r\n        setTaxSettings(newSettings);\r\n        setEditableSettings(newSettings);\r\n        invalidateCache(`doc_governmentSettings_${classCode}`);\r\n      } else {\r\n        await setDoc(settingsRef, {\r\n          taxSettings: {\r\n            ...DEFAULT_TAX_SETTINGS,\r\n            lastUpdated: serverTimestamp(),\r\n          },\r\n        }, { merge: true });\r\n        invalidateCache(`doc_governmentSettings_${classCode}`);\r\n        setTaxSettings(DEFAULT_TAX_SETTINGS);\r\n        setEditableSettings(DEFAULT_TAX_SETTINGS);\r\n      }\r\n      setLoadingSettings(false);\r\n    } catch (error) {\r\n      console.error(`[${classCode}] ì„¸ê¸ˆ ì •ì±… ë¡œë“œ ì‹¤íŒ¨:`, error);\r\n      setLoadingSettings(false);\r\n    }\r\n  }, [classCode]);\r\n\r\n  const { refetch: refetchSettings } = usePolling(fetchTaxSettings, { interval: 300000, enabled: !!classCode });\r\n\r\n  const handleSettingChange = (e) => {\r\n    const { name, value } = e.target;\r\n    const numericValue = value === \"\" ? \"\" : parseFloat(value);\r\n    setEditableSettings((prev) => ({\r\n      ...prev,\r\n      [name]: numericValue,\r\n    }));\r\n  };\r\n\r\n  const handleIntervalChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setEditableSettings((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const saveTaxSettings = async () => {\r\n    if (!classCode) return;\r\n    for (const key in editableSettings) {\r\n      if (\r\n        key.endsWith(\"Rate\") &&\r\n        (editableSettings[key] < 0 || editableSettings[key] > 1)\r\n      ) {\r\n        if (\r\n          editableSettings[key] !== \"\" &&\r\n          !(key === \"itemStoreVATRate\" && editableSettings[key] > 1)\r\n        ) {\r\n          alert(\r\n            `${key} ì„¸ìœ¨ì€ 0ê³¼ 1 ì‚¬ì´ì˜ ê°’ì´ì–´ì•¼ í•©ë‹ˆë‹¤ (ì˜ˆ: 3%ëŠ” 0.03). í˜„ì¬ê°’: ${editableSettings[key]}`\r\n          );\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    const settingsRef = doc(db, \"governmentSettings\", classCode);\r\n    try {\r\n      await updateDoc(settingsRef, {\r\n        taxSettings: {\r\n          ...editableSettings,\r\n          lastUpdated: serverTimestamp(),\r\n        },\r\n      });\r\n      refetchSettings();\r\n      alert(\"ì„¸ê¸ˆ ì •ì±…ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.\");\r\n    } catch (error) {\r\n      console.error(\"ì„¸ê¸ˆ ì •ì±… ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:\", error);\r\n      alert(\"ì„¸ê¸ˆ ì •ì±… ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\r\n    }\r\n  };\r\n\r\n  if (!classCode) {\r\n    return (\r\n      <div className=\"p-8 text-center\">\r\n        <h2 className=\"text-xl font-bold text-slate-800 mb-2\">í•™ê¸‰ ì½”ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤</h2>\r\n        <p className=\"text-slate-500\">\r\n          ì •ë¶€ ë©”ë‰´ì—ì„œ êµ­ì„¸ì²­ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ í•™ê¸‰ì— ë¨¼ì € ì°¸ì—¬í•´ì•¼ í•©ë‹ˆë‹¤.\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (loadingTreasury || loadingSettings) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-96\">\r\n        <div className=\"text-center\">\r\n          <div className=\"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\r\n          <p className=\"text-slate-500 font-medium\">êµ­ì„¸ì²­ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ (í•™ê¸‰: {classCode})...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const totalTaxRevenue = Object.keys(treasuryData)\r\n    .filter((key) => key.endsWith(\"Revenue\") && key !== \"totalAmount\")\r\n    .reduce((sum, key) => sum + (treasuryData[key] || 0), 0);\r\n\r\n  const taxPolicyFields = [\r\n    { name: \"stockTransactionTaxRate\", label: \"ì£¼ì‹ ê±°ë˜ì„¸ìœ¨\", type: \"number\", step: \"0.001\", min: \"0\", max: \"1\" },\r\n    { name: \"realEstateTransactionTaxRate\", label: \"ë¶€ë™ì‚° ê±°ë˜ì„¸ìœ¨\", type: \"number\", step: \"0.001\", min: \"0\", max: \"1\" },\r\n    { name: \"itemStoreVATRate\", label: \"ì•„ì´í…œ ìƒì  ë¶€ê°€ì„¸ìœ¨\", type: \"number\", step: \"0.01\", min: \"0\", max: \"1\" },\r\n    { name: \"auctionTransactionTaxRate\", label: \"ê²½ë§¤ì¥ ê±°ë˜ì„¸ìœ¨\", type: \"number\", step: \"0.001\", min: \"0\", max: \"1\" },\r\n    { name: \"propertyHoldingTaxRate\", label: \"ë¶€ë™ì‚° ë³´ìœ ì„¸ìœ¨\", type: \"number\", step: \"0.0001\", min: \"0\", max: \"1\" },\r\n    { name: \"propertyHoldingTaxInterval\", label: \"ë¶€ë™ì‚° ë³´ìœ ì„¸ ì§•ìˆ˜ ì£¼ê¸°\", type: \"select\", options: [\"daily\", \"weekly\", \"monthly\"] },\r\n    { name: \"itemMarketTransactionTaxRate\", label: \"ì•„ì´í…œ ì‹œì¥ ê±°ë˜ì„¸ìœ¨\", type: \"number\", step: \"0.001\", min: \"0\", max: \"1\" },\r\n  ];\r\n\r\n  const tabs = [\r\n    { id: \"overview\", label: \"ê°œìš”\", icon: \"ğŸ“Š\" },\r\n    { id: \"revenue\", label: \"ì„¸ìˆ˜ í˜„í™©\", icon: \"ğŸ’°\" },\r\n    { id: \"policy\", label: \"ì„¸ê¸ˆ ì •ì±…\", icon: \"ğŸ“‹\" },\r\n    { id: \"analytics\", label: \"ë¶„ì„\", icon: \"ğŸ“ˆ\" },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* í—¤ë” */}\r\n      <div className=\"bg-gradient-to-r from-indigo-600 via-violet-600 to-purple-600 rounded-2xl p-8 text-white shadow-xl\">\r\n        <h1 className=\"text-3xl font-bold mb-2\">ğŸ›ï¸ {classCode} í•™ê¸‰ êµ­ì„¸ì²­</h1>\r\n        <p className=\"text-white/80 text-lg\">ì„¸ê¸ˆ ì •ì±… ê´€ë¦¬ ë° êµ­ê³  ìš´ì˜</p>\r\n      </div>\r\n\r\n      {/* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */}\r\n      <div className=\"flex gap-2 border-b border-slate-200 pb-0\">\r\n        {tabs.map((tab) => (\r\n          <button\r\n            key={tab.id}\r\n            onClick={() => setActiveTab(tab.id)}\r\n            className={`px-6 py-3 rounded-t-xl font-bold text-sm transition-all ${activeTab === tab.id\r\n                ? \"bg-indigo-600 text-white shadow-lg\"\r\n                : \"bg-white text-slate-600 hover:bg-slate-50\"\r\n              }`}\r\n          >\r\n            {tab.icon} {tab.label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* ê°œìš” íƒ­ */}\r\n      {activeTab === \"overview\" && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4\">\r\n            {/* ì´ êµ­ê³  */}\r\n            <div className=\"bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-2xl p-6 text-white shadow-lg border border-emerald-400/30\">\r\n              <p className=\"text-emerald-100 text-sm font-medium mb-1\">ğŸ’° ì´ êµ­ê³ </p>\r\n              <p className=\"text-2xl font-bold text-shadow-sm\">{formatKoreanCurrency(treasuryData.totalAmount)}</p>\r\n            </div>\r\n\r\n            {/* ì£¼ì‹ ê±°ë˜ì„¸ ìˆ˜ì… */}\r\n            <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-6 text-white shadow-lg border border-blue-400/30\">\r\n              <p className=\"text-blue-100 text-sm font-medium mb-1\">ğŸ“ˆ ì£¼ì‹ ê±°ë˜ì„¸ ìˆ˜ì…</p>\r\n              <p className=\"text-2xl font-bold text-shadow-sm\">{formatKoreanCurrency(treasuryData.stockTaxRevenue)}</p>\r\n            </div>\r\n\r\n            {/* ì£¼ì‹ ê±°ë˜ ìˆ˜ìˆ˜ë£Œ ìˆ˜ì… */}\r\n            <div className=\"bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-2xl p-6 text-white shadow-lg border border-indigo-400/30\">\r\n              <p className=\"text-indigo-100 text-sm font-medium mb-1\">ğŸ“Š ì£¼ì‹ ê±°ë˜ ìˆ˜ìˆ˜ë£Œ ìˆ˜ì…</p>\r\n              <p className=\"text-2xl font-bold text-shadow-sm\">{formatKoreanCurrency(treasuryData.stockCommissionRevenue)}</p>\r\n            </div>\r\n\r\n            {/* ë¶€ë™ì‚° ê±°ë˜ì„¸ ìˆ˜ì… */}\r\n            <div className=\"bg-gradient-to-br from-amber-500 to-amber-600 rounded-2xl p-6 text-white shadow-lg border border-amber-400/30\">\r\n              <p className=\"text-amber-100 text-sm font-medium mb-1\">ğŸ  ë¶€ë™ì‚° ê±°ë˜ì„¸ ìˆ˜ì…</p>\r\n              <p className=\"text-2xl font-bold text-shadow-sm\">{formatKoreanCurrency(treasuryData.realEstateTransactionTaxRevenue)}</p>\r\n            </div>\r\n\r\n            {/* ì•„ì´í…œ ë¶€ê°€ì„¸ ìˆ˜ì… */}\r\n            <div className=\"bg-gradient-to-br from-pink-500 to-pink-600 rounded-2xl p-6 text-white shadow-lg border border-pink-400/30\">\r\n              <p className=\"text-pink-100 text-sm font-medium mb-1\">ğŸ›’ ì•„ì´í…œ ë¶€ê°€ì„¸ ìˆ˜ì…</p>\r\n              <p className=\"text-2xl font-bold text-shadow-sm\">{formatKoreanCurrency(treasuryData.vatRevenue)}</p>\r\n            </div>\r\n\r\n            {/* ê²½ë§¤ì¥ ê±°ë˜ì„¸ ìˆ˜ì… */}\r\n            <div className=\"bg-gradient-to-br from-cyan-500 to-cyan-600 rounded-2xl p-6 text-white shadow-lg border border-cyan-400/30\">\r\n              <p className=\"text-cyan-100 text-sm font-medium mb-1\">ğŸ”¨ ê²½ë§¤ì¥ ê±°ë˜ì„¸ ìˆ˜ì…</p>\r\n              <p className=\"text-2xl font-bold text-shadow-sm\">{formatKoreanCurrency(treasuryData.auctionTaxRevenue)}</p>\r\n            </div>\r\n\r\n            {/* ë¶€ë™ì‚° ë³´ìœ ì„¸ ìˆ˜ì… */}\r\n            <div className=\"bg-gradient-to-br from-lime-500 to-lime-600 rounded-2xl p-6 text-white shadow-lg border border-lime-400/30\">\r\n              <p className=\"text-lime-100 text-sm font-medium mb-1\">ğŸ˜ï¸ ë¶€ë™ì‚° ë³´ìœ ì„¸ ìˆ˜ì…</p>\r\n              <p className=\"text-2xl font-bold text-shadow-sm\">{formatKoreanCurrency(treasuryData.propertyHoldingTaxRevenue)}</p>\r\n            </div>\r\n\r\n            {/* ì•„ì´í…œ ì‹œì¥ ê±°ë˜ì„¸ ìˆ˜ì… */}\r\n            <div className=\"bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl p-6 text-white shadow-lg border border-orange-400/30\">\r\n              <p className=\"text-orange-100 text-sm font-medium mb-1\">ğŸª ì•„ì´í…œ ì‹œì¥ ê±°ë˜ì„¸ ìˆ˜ì…</p>\r\n              <p className=\"text-2xl font-bold text-shadow-sm\">{formatKoreanCurrency(treasuryData.itemMarketTaxRevenue)}</p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* ìµœê·¼ ì—…ë°ì´íŠ¸ */}\r\n          <div className=\"bg-[#1a1a2e] rounded-2xl p-6 border border-[#00fff2]/30 shadow-lg shadow-[#00fff2]/5\">\r\n            <h3 className=\"text-lg font-bold text-[#00fff2] mb-4\">ğŸ“… ìµœê·¼ ì—…ë°ì´íŠ¸</h3>\r\n            <div className=\"space-y-2 text-slate-300\">\r\n              <p>êµ­ê³  ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: <span className=\"font-medium text-white\">{formatDate(treasuryData.lastUpdated)}</span></p>\r\n              <p>ì„¸ê¸ˆ ì •ì±… ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: <span className=\"font-medium text-white\">{formatDate(taxSettings.lastUpdated)}</span></p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* ì„¸ìˆ˜ í˜„í™© íƒ­ */}\r\n      {activeTab === \"revenue\" && (\r\n        <div className=\"bg-[#1a1a2e] rounded-2xl p-6 border border-[#00fff2]/30 shadow-lg shadow-[#00fff2]/5\">\r\n          <div className=\"flex justify-between items-center mb-6\">\r\n            <h3 className=\"text-xl font-bold text-[#00fff2]\">ğŸ’° ì„¸ìˆ˜ í˜„í™© ë¶„ì„</h3>\r\n            <div className=\"text-right\">\r\n              <p className=\"text-sm text-slate-400\">ì„¸ìˆ˜ ì´í•©</p>\r\n              <p className=\"text-2xl font-bold text-white text-shadow-sm\">{formatKoreanCurrency(totalTaxRevenue)}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-4\">\r\n            {[\r\n              { label: \"ì£¼ì‹ ê±°ë˜ì„¸\", amount: treasuryData.stockTaxRevenue, color: \"bg-blue-500\" },\r\n              { label: \"ì£¼ì‹ ìˆ˜ìˆ˜ë£Œ\", amount: treasuryData.stockCommissionRevenue, color: \"bg-indigo-500\" },\r\n              { label: \"ë¶€ë™ì‚° ê±°ë˜ì„¸\", amount: treasuryData.realEstateTransactionTaxRevenue, color: \"bg-amber-500\" },\r\n              { label: \"ë¶€ê°€ì„¸\", amount: treasuryData.vatRevenue, color: \"bg-pink-500\" },\r\n              { label: \"ê²½ë§¤ì¥ ê±°ë˜ì„¸\", amount: treasuryData.auctionTaxRevenue, color: \"bg-cyan-500\" },\r\n              { label: \"ë¶€ë™ì‚° ë³´ìœ ì„¸\", amount: treasuryData.propertyHoldingTaxRevenue, color: \"bg-lime-500\" },\r\n              { label: \"ì•„ì´í…œ ì‹œì¥ì„¸\", amount: treasuryData.itemMarketTaxRevenue, color: \"bg-orange-500\" },\r\n            ].map((item) => {\r\n              const percentage = totalTaxRevenue > 0 ? ((item.amount / totalTaxRevenue) * 100).toFixed(1) : \"0.0\";\r\n              return (\r\n                <div key={item.label} className=\"flex items-center gap-4\">\r\n                  <div className=\"w-32 font-medium text-slate-300\">{item.label}</div>\r\n                  <div className=\"flex-1 h-6 bg-slate-800 rounded-full overflow-hidden border border-slate-700\">\r\n                    <div\r\n                      className={`h-full ${item.color} transition-all duration-500 shadow-[0_0_10px_rgba(0,0,0,0.5)]`}\r\n                      style={{ width: `${percentage}%` }}\r\n                    />\r\n                  </div>\r\n                  <div className=\"w-40 text-right text-sm\">\r\n                    <span className=\"font-bold text-white\">{formatKoreanCurrency(item.amount)}</span>\r\n                    <span className=\"text-slate-400 ml-2\">({percentage}%)</span>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* ì„¸ê¸ˆ ì •ì±… íƒ­ */}\r\n      {activeTab === \"policy\" && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-[#1a1a2e] rounded-2xl p-6 border border-[#00fff2]/30 shadow-lg shadow-[#00fff2]/5\">\r\n            <h3 className=\"text-xl font-bold text-[#00fff2] mb-6\">ğŸ“‹ í˜„í–‰ ì„¸ê¸ˆ ì •ì±… (í•™ê¸‰: {classCode})</h3>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              {taxPolicyFields.map((field) => (\r\n                <div key={field.name}>\r\n                  <label className=\"block text-sm font-bold text-slate-300 mb-2\">\r\n                    {field.label}\r\n                    <span className=\"text-[#00fff2] font-normal ml-2\">\r\n                      (í˜„ì¬: {field.type === \"select\"\r\n                        ? taxSettings[field.name]\r\n                        : `${((taxSettings[field.name] || 0) * 100).toFixed(field.name.includes(\"propertyHoldingTaxRate\") ? 2 : 1)}%`})\r\n                    </span>\r\n                  </label>\r\n                  {field.type === \"select\" ? (\r\n                    <select\r\n                      name={field.name}\r\n                      value={editableSettings[field.name] || DEFAULT_TAX_SETTINGS[field.name]}\r\n                      onChange={handleIntervalChange}\r\n                      className=\"w-full px-4 py-3 bg-[#13131f] border-2 border-slate-700 rounded-xl focus:outline-none focus:border-[#00fff2] text-white transition-colors\"\r\n                    >\r\n                      {field.options.map((opt) => (\r\n                        <option key={opt} value={opt}>\r\n                          {opt === \"daily\" ? \"ë§¤ì¼\" : opt === \"weekly\" ? \"ë§¤ì£¼\" : \"ë§¤ì›”\"}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  ) : (\r\n                    <input\r\n                      type={field.type}\r\n                      name={field.name}\r\n                      value={editableSettings[field.name] === \"\" ? \"\" : editableSettings[field.name]}\r\n                      onChange={handleSettingChange}\r\n                      step={field.step}\r\n                      min={field.min}\r\n                      max={field.max}\r\n                      placeholder={`ì˜ˆ: ${field.label.includes(\"ë¶€ê°€\") ? \"0.1 (10%)\" : \"0.03 (3%)\"}`}\r\n                      className=\"w-full px-4 py-3 bg-[#13131f] border-2 border-slate-700 rounded-xl focus:outline-none focus:border-[#00fff2] text-white transition-colors placeholder-slate-600\"\r\n                    />\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            <button\r\n              onClick={saveTaxSettings}\r\n              className=\"mt-6 px-8 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded-xl font-bold transition-all shadow-lg border border-indigo-400/30\"\r\n            >\r\n              ì„¸ê¸ˆ ì •ì±… ì €ì¥\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"bg-[#13131f] rounded-2xl p-6 border border-blue-500/30 shadow-lg\">\r\n            <h3 className=\"text-lg font-bold text-blue-400 mb-3\">ğŸ’¡ ì„¸ê¸ˆ ì •ì±… ëª©í‘œ</h3>\r\n            <ul className=\"text-blue-300 space-y-2\">\r\n              <li>â€¢ ê³µì •í•œ ì‹œì¥ ê²½ì œ ì§ˆì„œ í™•ë¦½</li>\r\n              <li>â€¢ ì•ˆì •ì ì¸ í•™ê¸‰ ì¬ì • ì •ë³´ ë° ê³µê³µ ì„œë¹„ìŠ¤ íˆ¬ì</li>\r\n              <li>â€¢ ê²½ì œ í™œë™ ì°¸ì—¬ì™€ ê°ì˜ í˜•í‰ì„± ì œê³ </li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* ë¶„ì„ íƒ­ */}\r\n      {activeTab === \"analytics\" && (\r\n        <div className=\"bg-[#1a1a2e] rounded-2xl p-6 border border-[#00fff2]/30 shadow-lg\">\r\n          <h3 className=\"text-xl font-bold text-[#00fff2] mb-4\">ğŸ“ˆ ì„¸ìˆ˜ ë¶„ì„ (í•™ê¸‰: {classCode})</h3>\r\n          <div className=\"bg-[#13131f] rounded-xl p-8 text-center border border-slate-700\">\r\n            <div className=\"text-6xl mb-4\">ğŸ“Š</div>\r\n            <p className=\"text-slate-300\">ì¶”í›„ ë‹¤ì–‘í•œ ì„¸ìˆ˜ ë¶„ì„ ì°¨íŠ¸ì™€ ìƒì„¸ ì •ë³´ê°€ í‘œì‹œë  ì˜ˆì •ì…ë‹ˆë‹¤.</p>\r\n            <p className=\"text-slate-500 text-sm mt-2\">ì˜ˆ: ì‹œê°„ì— ë”°ë¥¸ ì„¸ìˆ˜ ë³€í™”, ì¹´í…Œê³ ë¦¬ë³„ ê¸°ì—¬ë„ ë“±</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NationalTaxService;\r\n","// src/Investment.js\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAuth } from \"../../contexts/AuthContext\"; // AuthContextì—ì„œ user ì •ë³´ ê°€ì ¸ì˜¤ê¸°\r\nimport { formatKoreanCurrency } from '../../numberFormatter';\r\nimport { usePolling } from '../../hooks/usePolling';\r\n\r\n// Firestore ê´€ë ¨ í•¨ìˆ˜ ì„í¬íŠ¸\r\nimport {\r\n  db,\r\n  doc,\r\n  runTransaction,\r\n  serverTimestamp,\r\n  collection,\r\n  // addDoc, // ë” ì´ìƒ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ (transaction.set ì‚¬ìš©)\r\n  getDoc,\r\n  getDocs,\r\n  setDoc,\r\n  increment,\r\n  // query, orderBy, limit ë“±ì€ firebase/firestoreì—ì„œ ì§ì ‘ ê°€ì ¸ì˜´\r\n} from \"../../firebase\"; // firebase.js ê²½ë¡œ í™•ì¸\r\n\r\n// â­ï¸ query, orderBy, limit, Timestampë¥¼ firebase/firestoreì—ì„œ ì§ì ‘ ê°€ì ¸ì˜µë‹ˆë‹¤.\r\nimport {\r\n  query,\r\n  orderBy,\r\n  limit,\r\n  Timestamp,\r\n} from \"firebase/firestore\";\r\n\r\n// Investment ì»´í¬ë„ŒíŠ¸\r\nconst Investment = ({ classCode }) => {\r\n  // classCodeë¥¼ propìœ¼ë¡œ ë°›ìŒ\r\n  const { user, userDoc, isAdmin, refreshUserDocument } = useAuth(); // í˜„ì¬ ì‚¬ìš©ì ì •ë³´ ë° isAdmin í•¨ìˆ˜ ì‚¬ìš©\r\n\r\n  const [treasuryBalance, setTreasuryBalance] = useState(0);\r\n  const [adminCash, setAdminCash] = useState(userDoc?.cash || 0); // ê´€ë¦¬ì(í˜„ì¬ ì‚¬ìš©ì)ì˜ í˜„ê¸ˆ\r\n  const [transferAmount, setTransferAmount] = useState(\"\");\r\n  const [message, setMessage] = useState({ text: \"\", type: \"\" });\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [lastTransactions, setLastTransactions] = useState([]);\r\n\r\n  // Firestore ê²½ë¡œ ì°¸ì¡° (classCodeê°€ ìˆì„ ë•Œë§Œ ì •ì˜)\r\n  // NationalTaxService.jsì™€ ë™ì¼í•œ ì»¬ë ‰ì…˜ ì‚¬ìš©: nationalTreasuries\r\n  let treasuryRef = null;\r\n  let treasuryTransactionsColRef = null;\r\n  if (classCode) {\r\n    treasuryRef = doc(db, \"nationalTreasuries\", classCode);\r\n    treasuryTransactionsColRef = collection(\r\n      db,\r\n      \"classes\",\r\n      classCode,\r\n      \"treasuryTransactions\"\r\n    );\r\n  }\r\n\r\n  // ì‚¬ìš©ì(ê´€ë¦¬ì) í˜„ê¸ˆ ìƒíƒœ ì—…ë°ì´íŠ¸ (userDoc ë³€ê²½ ê°ì§€)\r\n  useEffect(() => {\r\n    setAdminCash(userDoc?.cash || 0);\r\n  }, [userDoc?.cash]);\r\n\r\n  // êµ­ê³  ì”ì•¡ í´ë§\r\n  const { data: treasuryData } = usePolling(\r\n    async () => {\r\n      if (!classCode || !treasuryRef) return null;\r\n\r\n      const docSnap = await getDoc(treasuryRef);\r\n      if (docSnap.exists()) {\r\n        // NationalTaxService.jsì™€ ë™ì¼í•˜ê²Œ totalAmount í•„ë“œ ì‚¬ìš©\r\n        return docSnap.data().totalAmount || 0;\r\n      } else {\r\n        try {\r\n          // NationalTaxService.jsì˜ DEFAULT_TREASURY_DATAì™€ ë™ì¼í•œ êµ¬ì¡°ë¡œ ìƒì„±\r\n          await setDoc(treasuryRef, {\r\n            totalAmount: 0,\r\n            stockTaxRevenue: 0,\r\n            stockCommissionRevenue: 0,\r\n            realEstateTransactionTaxRevenue: 0,\r\n            realEstateAnnualTaxRevenue: 0,\r\n            incomeTaxRevenue: 0,\r\n            corporateTaxRevenue: 0,\r\n            otherTaxRevenue: 0,\r\n            classCode: classCode,\r\n            createdAt: serverTimestamp(),\r\n            lastUpdated: serverTimestamp(),\r\n          });\r\n          console.log(`í•™ê¸‰ [${classCode}]ì˜ êµ­ê³ ê°€ ì—†ì–´ ìƒˆë¡œ ìƒì„±í–ˆìŠµë‹ˆë‹¤.`);\r\n          return 0;\r\n        } catch (error) {\r\n          console.error(\"êµ­ê³  ìƒì„± ì¤‘ ì˜¤ë¥˜:\", error);\r\n          setMessage({\r\n            type: \"error\",\r\n            text: \"êµ­ê³  ì •ë³´ë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\",\r\n          });\r\n          return 0;\r\n        }\r\n      }\r\n    },\r\n    { interval: 300000, enabled: !!classCode && !!treasuryRef, deps: [classCode] }\r\n  );\r\n\r\n  // ìµœê·¼ ê±°ë˜ ë‚´ì—­ í´ë§\r\n  const { data: transactionsData } = usePolling(\r\n    async () => {\r\n      if (!classCode || !treasuryTransactionsColRef) return [];\r\n\r\n      const q = query(\r\n        treasuryTransactionsColRef,\r\n        orderBy(\"timestamp\", \"desc\"),\r\n        limit(5)\r\n      );\r\n      const snapshot = await getDocs(q);\r\n      return snapshot.docs.map((doc) => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      }));\r\n    },\r\n    { interval: 300000, enabled: !!classCode && !!treasuryTransactionsColRef, deps: [classCode] }\r\n  );\r\n\r\n  // treasuryDataì™€ transactionsDataë¥¼ stateì— ë°˜ì˜\r\n  useEffect(() => {\r\n    if (treasuryData !== undefined && treasuryData !== null) {\r\n      setTreasuryBalance(treasuryData);\r\n    } else if (!classCode || !treasuryRef) {\r\n      setTreasuryBalance(0);\r\n    }\r\n  }, [treasuryData, classCode, treasuryRef]);\r\n\r\n  useEffect(() => {\r\n    if (transactionsData !== undefined && transactionsData !== null) {\r\n      setLastTransactions(Array.isArray(transactionsData) ? transactionsData : []);\r\n      setIsLoading(false);\r\n    } else if (!classCode || !treasuryTransactionsColRef) {\r\n      setLastTransactions([]);\r\n      setIsLoading(false);\r\n    }\r\n  }, [transactionsData, classCode, treasuryTransactionsColRef]);\r\n\r\n  // êµ­ê³  â†” ê´€ë¦¬ì í˜„ê¸ˆ ì´ì²´ í•¨ìˆ˜\r\n  const handleTreasuryTransfer = async (e, operationType) => {\r\n    e.preventDefault();\r\n    setMessage({ text: \"\", type: \"\" });\r\n\r\n    if (!isAdmin()) {\r\n      setMessage({\r\n        text: \"ì´ ì‘ì—…ì€ ê´€ë¦¬ìë§Œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\",\r\n        type: \"error\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !user ||\r\n      !userDoc ||\r\n      !classCode ||\r\n      !treasuryRef ||\r\n      !treasuryTransactionsColRef\r\n    ) {\r\n      setMessage({\r\n        text: \"ì‚¬ìš©ì ë˜ëŠ” í•™ê¸‰ ì •ë³´ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\",\r\n        type: \"error\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    const amount = parseFloat(transferAmount);\r\n    if (isNaN(amount) || amount <= 0) {\r\n      setMessage({ text: \"ìœ íš¨í•œ ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\", type: \"error\" });\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    const adminUserRef = doc(db, \"users\", user.uid);\r\n\r\n    try {\r\n      await runTransaction(db, async (transaction) => {\r\n        const latestTreasurySnap = await transaction.get(treasuryRef);\r\n        const latestAdminSnap = await transaction.get(adminUserRef);\r\n\r\n        if (!latestAdminSnap.exists())\r\n          throw new Error(\"ê´€ë¦¬ì(ì‚¬ìš©ì) ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\r\n\r\n        const currentTreasuryBalance = latestTreasurySnap.exists()\r\n          ? latestTreasurySnap.data().totalAmount || 0\r\n          : 0;\r\n        const currentAdminCash = latestAdminSnap.data().cash || 0;\r\n\r\n        let reason = \"\";\r\n        let newTreasuryBalance, newAdminCash;\r\n\r\n        if (operationType === \"withdraw_to_admin\") {\r\n          // êµ­ê³  -> ê´€ë¦¬ì í˜„ê¸ˆ\r\n          reason = \"íˆ¬ì ìê¸ˆ ì¸ì¶œ (ê´€ë¦¬ì)\";\r\n          if (currentTreasuryBalance < amount)\r\n            throw new Error(\"êµ­ê³  ì”ì•¡ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.\");\r\n          newTreasuryBalance = currentTreasuryBalance - amount;\r\n          newAdminCash = currentAdminCash + amount;\r\n          transaction.update(treasuryRef, {\r\n            totalAmount: increment(-amount),\r\n            lastUpdated: serverTimestamp(),\r\n          });\r\n          transaction.update(adminUserRef, {\r\n            cash: increment(amount),\r\n            updatedAt: serverTimestamp(),\r\n          });\r\n        } else if (operationType === \"deposit_from_admin\") {\r\n          // ê´€ë¦¬ì í˜„ê¸ˆ -> êµ­ê³ \r\n          reason = \"íˆ¬ì ìˆ˜ìµ ì…ê¸ˆ (ê´€ë¦¬ì)\";\r\n          if (currentAdminCash < amount)\r\n            throw new Error(\"ê´€ë¦¬ì í˜„ê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤.\");\r\n          newTreasuryBalance = currentTreasuryBalance + amount;\r\n          newAdminCash = currentAdminCash - amount;\r\n          transaction.update(adminUserRef, {\r\n            cash: increment(-amount),\r\n            updatedAt: serverTimestamp(),\r\n          });\r\n          transaction.update(treasuryRef, {\r\n            totalAmount: increment(amount),\r\n            lastUpdated: serverTimestamp(),\r\n          });\r\n        } else {\r\n          throw new Error(\"ì˜ëª»ëœ ì‘ì—… ìœ í˜•ì…ë‹ˆë‹¤.\");\r\n        }\r\n\r\n        // ê±°ë˜ ê¸°ë¡ ì¶”ê°€ (ìƒˆ ë¬¸ì„œ ID ìë™ ìƒì„±)\r\n        const newTransactionRef = doc(treasuryTransactionsColRef);\r\n        transaction.set(newTransactionRef, {\r\n          type: operationType,\r\n          actorId: user.uid,\r\n          actorDisplayName: userDoc.name || userDoc.nickname || user.email,\r\n          amount: amount,\r\n          reason: reason,\r\n          classCode: classCode,\r\n          timestamp: serverTimestamp(),\r\n          treasuryBalanceBefore: currentTreasuryBalance,\r\n          treasuryBalanceAfter: newTreasuryBalance,\r\n          adminCashBefore: currentAdminCash,\r\n          adminCashAfter: newAdminCash,\r\n        });\r\n      });\r\n\r\n      setMessage({\r\n        text: `${operationType === \"withdraw_to_admin\" ? \"ì¸ì¶œ\" : \"ì…ê¸ˆ\"\r\n          } ì„±ê³µ! (${amount.toLocaleString()}ì›)`,\r\n        type: \"success\",\r\n      });\r\n      setTransferAmount(\"\");\r\n      if (refreshUserDocument) refreshUserDocument();\r\n    } catch (error) {\r\n      console.error(\"ìê¸ˆ ì´ì²´ ì˜¤ë¥˜:\", error);\r\n      setMessage({ text: `ì˜¤ë¥˜: ${error.message}`, type: \"error\" });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  if (!classCode) {\r\n    return (\r\n      <div className=\"investment-container\" style={styles.container}>\r\n        <p>í•™ê¸‰ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì´ê±°ë‚˜, í•™ê¸‰ ì½”ë“œê°€ í• ë‹¹ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (\r\n    isLoading &&\r\n    treasuryBalance === 0 &&\r\n    lastTransactions.length === 0 &&\r\n    !message.text\r\n  ) {\r\n    return (\r\n      <div className=\"investment-container\" style={styles.container}>\r\n        ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!isAdmin()) {\r\n    return (\r\n      <div className=\"investment-container\" style={styles.container}>\r\n        <p>ì´ ê¸°ëŠ¥ì€ ê´€ë¦¬ìë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"investment-container\" style={styles.container}>\r\n      <h2>íˆ¬ì ê´€ë¦¬ (êµ­ê³  â†” ê´€ë¦¬ì í˜„ê¸ˆ)</h2>\r\n      <p style={styles.classCodeDisplay}>í•™ê¸‰ ì½”ë“œ: {classCode}</p>\r\n\r\n      {message.text && (\r\n        <div\r\n          style={{\r\n            ...styles.messageBox,\r\n            borderColor: message.type === \"success\" ? \"#c3e6cb\" : \"#f5c6cb\",\r\n            backgroundColor: message.type === \"success\" ? \"#d4edda\" : \"#f8d7da\",\r\n            color: message.type === \"success\" ? \"#155724\" : \"#721c24\",\r\n          }}\r\n        >\r\n          {message.text}\r\n        </div>\r\n      )}\r\n\r\n      <div style={styles.balanceDisplay}>\r\n        <p>\r\n          í˜„ì¬ êµ­ê³  ì”ì•¡:{\" \"}\r\n          <span style={styles.balanceValue}>\r\n            {treasuryBalance.toLocaleString()}ì›\r\n          </span>\r\n        </p>\r\n        <p>\r\n          ê´€ë¦¬ì (ë‚´) í˜„ê¸ˆ:{\" \"}\r\n          <span style={styles.balanceValue}>\r\n            {adminCash.toLocaleString()}ì›\r\n          </span>\r\n        </p>\r\n      </div>\r\n\r\n      <form\r\n        onSubmit={(e) => handleTreasuryTransfer(e, \"withdraw_to_admin\")}\r\n        style={styles.form}\r\n      >\r\n        <h3>êµ­ê³ ì—ì„œ íˆ¬ì ìê¸ˆ ì¸ì¶œ (â†’ ë‚´ í˜„ê¸ˆìœ¼ë¡œ)</h3>\r\n        <div style={styles.formGroup}>\r\n          <label htmlFor=\"withdrawAmount\" style={styles.label}>\r\n            ì¸ì¶œ ê¸ˆì•¡:\r\n          </label>\r\n          <input\r\n            type=\"number\"\r\n            id=\"withdrawAmount\"\r\n            value={transferAmount}\r\n            onChange={(e) => setTransferAmount(e.target.value)}\r\n            required\r\n            min=\"1\"\r\n            placeholder=\"ì¸ì¶œí•  ê¸ˆì•¡\"\r\n            style={styles.input}\r\n            disabled={isLoading}\r\n          />\r\n        </div>\r\n        <button\r\n          type=\"submit\"\r\n          style={{ ...styles.actionButton, backgroundColor: \"#007bff\" }}\r\n          disabled={isLoading}\r\n        >\r\n          {isLoading ? \"ì²˜ë¦¬ì¤‘...\" : \"ìê¸ˆ ì¸ì¶œ ì‹¤í–‰\"}\r\n        </button>\r\n      </form>\r\n\r\n      <hr style={styles.divider} />\r\n\r\n      <form\r\n        onSubmit={(e) => handleTreasuryTransfer(e, \"deposit_from_admin\")}\r\n        style={styles.form}\r\n      >\r\n        <h3>íˆ¬ì ìˆ˜ìµ êµ­ê³  ì…ê¸ˆ (ë‚´ í˜„ê¸ˆì—ì„œ â†’)</h3>\r\n        <div style={styles.formGroup}>\r\n          <label htmlFor=\"depositAmount\" style={styles.label}>\r\n            ì…ê¸ˆ ê¸ˆì•¡:\r\n          </label>\r\n          <input\r\n            type=\"number\"\r\n            id=\"depositAmount\"\r\n            value={transferAmount}\r\n            onChange={(e) => setTransferAmount(e.target.value)}\r\n            required\r\n            min=\"1\"\r\n            placeholder=\"êµ­ê³ ë¡œ ì…ê¸ˆí•  ê¸ˆì•¡\"\r\n            style={styles.input}\r\n            disabled={isLoading}\r\n          />\r\n        </div>\r\n        <button type=\"submit\" style={styles.actionButton} disabled={isLoading}>\r\n          {isLoading ? \"ì²˜ë¦¬ì¤‘...\" : \"êµ­ê³  ì…ê¸ˆ ì‹¤í–‰\"}\r\n        </button>\r\n      </form>\r\n\r\n      <hr style={styles.divider} />\r\n      <div>\r\n        <h3>ìµœê·¼ êµ­ê³  ê±°ë˜ ë‚´ì—­ (ê´€ë¦¬ì ê´€ë ¨)</h3>\r\n        {lastTransactions.length === 0 && !isLoading ? (\r\n          <p>ìµœê·¼ ê±°ë˜ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>\r\n        ) : (\r\n          <ul style={styles.transactionList}>\r\n            {lastTransactions.map((tx) => (\r\n              <li key={tx.id} style={styles.transactionItem}>\r\n                <span style={styles.transactionItem_span}>\r\n                  {tx.timestamp && tx.timestamp.toDate\r\n                    ? new Date(tx.timestamp.toDate()).toLocaleString()\r\n                    : \"ë‚ ì§œ ì •ë³´ ì—†ìŒ\"}\r\n                </span>\r\n                <span style={styles.transactionItem_span}>\r\n                  {\" \"}\r\n                  [\r\n                  {tx.type === \"withdraw_to_admin\"\r\n                    ? \"ì¸ì¶œ(ê´€ë¦¬ì)\"\r\n                    : tx.type === \"deposit_from_admin\"\r\n                      ? \"ì…ê¸ˆ(ê´€ë¦¬ì)\"\r\n                      : tx.type || \"ì•Œ ìˆ˜ ì—†ìŒ\"}\r\n                  ]\r\n                </span>\r\n                <span style={styles.transactionItem_span}>\r\n                  {\" \"}\r\n                  {tx.actorDisplayName || \"ì •ë³´ ì—†ìŒ\"}\r\n                </span>\r\n                <span style={styles.transactionItem_span}>\r\n                  : {tx.amount?.toLocaleString()}ì›\r\n                </span>\r\n                {tx.reason && (\r\n                  <span style={styles.transactionItem_span}>\r\n                    {\" \"}\r\n                    ({tx.reason})\r\n                  </span>\r\n                )}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        )}\r\n      </div>\r\n\r\n      <hr style={styles.divider} />\r\n\r\n      <div>\r\n        <h3>ì‹¤ì œ íˆ¬ì ì§‘í–‰</h3>\r\n        <p>ìœ„ì—ì„œ ì¸ì¶œí•œ ìê¸ˆìœ¼ë¡œ ì•„ë˜ ë§í¬ë¥¼ í†µí•´ ì‹¤ì œ íˆ¬ìë¥¼ ì§„í–‰í•˜ì„¸ìš”.</p>\r\n        <div style={styles.linkContainer}>\r\n          <Link to=\"/stock-trading\" style={styles.linkButton}>\r\n            ì£¼ì‹ ê±°ë˜ì†Œ ê°€ê¸°\r\n          </Link>\r\n          <Link to=\"/banking\" style={styles.linkButton}>\r\n            í•œêµ­ ì€í–‰ ê°€ê¸°\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// ê°„ë‹¨í•œ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼\r\nconst styles = {\r\n  container: {\r\n    maxWidth: \"800px\",\r\n    margin: \"20px auto\",\r\n    padding: \"20px\",\r\n    border: \"1px solid rgba(0, 255, 242, 0.2)\",\r\n    borderRadius: \"20px\",\r\n    backgroundColor: \"#1a1a2e\",\r\n    fontFamily: \"'Noto Sans KR', sans-serif\",\r\n    boxShadow: \"0 10px 40px rgba(0, 0, 0, 0.5)\",\r\n    color: \"#e8e8ff\",\r\n  },\r\n  classCodeDisplay: {\r\n    textAlign: \"center\",\r\n    marginBottom: \"15px\",\r\n    fontSize: \"0.9em\",\r\n    color: \"#00fff2\",\r\n    backgroundColor: \"rgba(0, 255, 242, 0.1)\",\r\n    padding: \"5px\",\r\n    borderRadius: \"4px\",\r\n    border: \"1px solid rgba(0, 255, 242, 0.2)\",\r\n  },\r\n  balanceDisplay: {\r\n    marginBottom: \"20px\",\r\n    padding: \"20px\",\r\n    backgroundColor: \"#13131f\",\r\n    borderRadius: \"16px\",\r\n    border: \"1px solid rgba(255, 255, 255, 0.05)\",\r\n    boxShadow: \"inset 0 2px 10px rgba(0, 0, 0, 0.3)\",\r\n  },\r\n  balanceValue: { fontWeight: \"bold\", color: \"#00fff2\", textShadow: \"0 0 10px rgba(0, 255, 242, 0.3)\" },\r\n  form: {\r\n    marginBottom: \"20px\",\r\n    padding: \"20px\",\r\n    border: \"1px solid rgba(255, 255, 255, 0.05)\",\r\n    borderRadius: \"16px\",\r\n    backgroundColor: \"#13131f\",\r\n  },\r\n  formGroup: { marginBottom: \"15px\" },\r\n  label: {\r\n    display: \"block\",\r\n    marginBottom: \"8px\",\r\n    fontWeight: \"500\",\r\n    color: \"#94a3b8\",\r\n  },\r\n  input: {\r\n    width: \"calc(100% - 22px)\", // íŒ¨ë”© ê³ ë ¤\r\n    padding: \"10px\",\r\n    border: \"1px solid rgba(255, 255, 255, 0.1)\",\r\n    borderRadius: \"8px\",\r\n    fontSize: \"1rem\",\r\n    backgroundColor: \"rgba(0, 0, 0, 0.3)\",\r\n    color: \"white\",\r\n  },\r\n  actionButton: {\r\n    padding: \"10px 20px\",\r\n    backgroundColor: \"rgba(16, 185, 129, 0.2)\",\r\n    color: \"#34d399\",\r\n    border: \"1px solid rgba(16, 185, 129, 0.3)\",\r\n    borderRadius: \"8px\",\r\n    cursor: \"pointer\",\r\n    fontSize: \"1rem\",\r\n    fontWeight: \"bold\",\r\n    transition: \"background-color 0.2s ease, opacity 0.2s ease, transform 0.2s ease\",\r\n    boxShadow: \"0 0 10px rgba(16, 185, 129, 0.1)\",\r\n  },\r\n  divider: { margin: \"30px 0\", border: 0, borderTop: \"1px solid rgba(255, 255, 255, 0.1)\" },\r\n  messageBox: {\r\n    padding: \"15px\",\r\n    marginBottom: \"20px\",\r\n    borderRadius: \"8px\",\r\n    borderWidth: \"1px\",\r\n    borderStyle: \"solid\",\r\n    fontSize: \"1rem\",\r\n  },\r\n  linkContainer: {\r\n    marginTop: \"15px\",\r\n    display: \"flex\",\r\n    gap: \"15px\",\r\n  },\r\n  linkButton: {\r\n    display: \"inline-block\",\r\n    padding: \"10px 15px\",\r\n    backgroundColor: \"rgba(255, 255, 255, 0.1)\",\r\n    color: \"white\",\r\n    textDecoration: \"none\",\r\n    borderRadius: \"8px\",\r\n    textAlign: \"center\",\r\n    transition: \"background-color 0.2s ease\",\r\n    border: \"1px solid rgba(255, 255, 255, 0.1)\",\r\n  },\r\n  transactionList: {\r\n    listStyleType: \"none\",\r\n    paddingLeft: 0,\r\n    maxHeight: \"200px\",\r\n    overflowY: \"auto\",\r\n    border: \"1px solid rgba(255, 255, 255, 0.05)\",\r\n    borderRadius: \"8px\",\r\n    padding: \"10px\",\r\n    backgroundColor: \"rgba(0, 0, 0, 0.2)\",\r\n  },\r\n  transactionItem: {\r\n    padding: \"8px 0\",\r\n    borderBottom: \"1px solid rgba(255, 255, 255, 0.05)\",\r\n    fontSize: \"0.9em\",\r\n    display: \"flex\",\r\n    flexWrap: \"wrap\",\r\n    gap: \"5px\",\r\n    color: \"#a0a0c0\",\r\n  },\r\n  transactionItem_span: {\r\n    // ìµœê·¼ ê±°ë˜ ë‚´ì—­ì˜ ê° span íƒœê·¸ì— ì˜¤ë¥¸ìª½ ì—¬ë°±ì„ ì£¼ê¸° ìœ„í•œ ìŠ¤íƒ€ì¼\r\n    marginRight: \"5px\",\r\n  },\r\n};\r\n\r\nexport default Investment;\r\n","// src/SendReceive.js\r\nimport { getDoc } from \"firebase/firestore\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport {\r\n  db,\r\n  doc,\r\n  runTransaction,\r\n  serverTimestamp,\r\n  collection,\r\n  setDoc,\r\n  increment,\r\n} from \"../../firebase\";\r\nimport { logActivity, LOG_TYPES } from \"../../database\"; // logActivityì™€ LOG_TYPES ê°€ì ¸ì˜¤ê¸°\r\nimport { usePolling } from \"../../hooks/usePolling\";\r\nimport \"./SendReceive.css\";\r\n\r\nconst SendReceive = ({ classCode }) => {\r\n  const { user, userDoc, refreshUserDocument, isAdmin } = useAuth();\r\n  const [amount, setAmount] = useState(\"\");\r\n  const [actionType, setActionType] = useState(\"deposit\");\r\n  const [depositSource, setDepositSource] = useState(\"personal\"); // 'personal', 'nationalTreasury', 'mint'\r\n  const [withdrawDestination, setWithdrawDestination] = useState(\"personal\"); // 'personal', 'nationalTreasury'\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [feedback, setFeedback] = useState({ type: \"\", message: \"\" });\r\n  const [treasuryBalance, setTreasuryBalance] = useState(0);\r\n  const [userCash, setUserCash] = useState(userDoc?.cash || 0);\r\n\r\n  // --- ìì‚° ì •ë³´ ê³„ì‚° ë¡œì§ ---\r\n  // ë³´ìœ  ì£¼ì‹ ìˆ˜ ê³„ì‚°: userDoc.stocks ê°ì²´ì˜ ëª¨ë“  ê°’ì„ í•©ì‚°í•©ë‹ˆë‹¤.\r\n  const userStocks = userDoc?.stocks\r\n    ? Object.values(userDoc.stocks).reduce((sum, count) => sum + count, 0)\r\n    : 0;\r\n    \r\n  // ë³´ìœ  ì¿ í° ìˆ˜ ê³„ì‚°: userDoc.coupons ë°°ì—´ì˜ ê¸¸ì´ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.\r\n  const userCoupons = userDoc?.coupons?.length || 0;\r\n  \r\n  // ì€í–‰ ê³„ì¢Œ ì”ì•¡ ê³„ì‚°: userDoc.accounts ê°ì²´ì˜ ëª¨ë“  ì”ì•¡ì„ í•©ì‚°í•©ë‹ˆë‹¤.\r\n  const bankBalance = userDoc?.accounts \r\n    ? Object.values(userDoc.accounts).reduce((sum, acc) => sum + (acc.balance || 0), 0) \r\n    : 0;\r\n\r\n  // ì´ ìì‚° ê³„ì‚° (í˜„ê¸ˆ + ì€í–‰ ì˜ˆê¸ˆ)\r\n  const totalAssets = (userDoc?.cash || 0) + bankBalance;\r\n  // --- ìì‚° ì •ë³´ ê³„ì‚° ë¡œì§ ë ---\r\n\r\n\r\n  // í•™ê¸‰ ê¸ˆê³ ì™€ êµ­ì„¸ì²­ ëª¨ë‘ nationalTreasuries ì»¬ë ‰ì…˜ ì‚¬ìš© (í†µì¼)\r\n  const treasuryRef = doc(db, \"nationalTreasuries\", classCode);\r\n  const nationalTreasuryRef = doc(db, \"nationalTreasuries\", classCode);\r\n\r\n  // ê¸ˆê³  ì”ì•¡ í´ë§ (nationalTreasuries ì»¬ë ‰ì…˜ì˜ totalAmount í•„ë“œ ì‚¬ìš©)\r\n  const fetchTreasuryBalance = async () => {\r\n    if (!classCode) return;\r\n\r\n    try {\r\n      const docSnap = await getDoc(treasuryRef);\r\n      if (docSnap.exists()) {\r\n        setTreasuryBalance(docSnap.data().totalAmount || 0);\r\n      } else {\r\n        // êµ­ê³  ë¬¸ì„œê°€ ì—†ìœ¼ë©´ ìƒì„± (NationalTaxService.jsì˜ DEFAULT_TREASURY_DATAì™€ ë™ì¼)\r\n        await setDoc(treasuryRef, {\r\n          totalAmount: 0,\r\n          stockTaxRevenue: 0,\r\n          stockCommissionRevenue: 0,\r\n          realEstateTransactionTaxRevenue: 0,\r\n          realEstateAnnualTaxRevenue: 0,\r\n          incomeTaxRevenue: 0,\r\n          corporateTaxRevenue: 0,\r\n          otherTaxRevenue: 0,\r\n          classCode: classCode,\r\n          createdAt: serverTimestamp(),\r\n          lastUpdated: serverTimestamp(),\r\n        });\r\n        setTreasuryBalance(0);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"ê¸ˆê³  ì”ì•¡ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜:\", error);\r\n      setFeedback({\r\n        type: \"error\",\r\n        message: \"ê¸ˆê³  ì”ì•¡ì„ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const { refetch: refetchTreasuryBalance } = usePolling(fetchTreasuryBalance, { interval: 300000, enabled: !!classCode });\r\n\r\n  useEffect(() => {\r\n    setUserCash(userDoc?.cash || 0);\r\n  }, [userDoc?.cash]);\r\n\r\n  const handleTransaction = async () => {\r\n    if (!user || !userDoc || !classCode) {\r\n      setFeedback({ type: \"error\", message: \"í•„ìˆ˜ ì •ë³´(ë¡œê·¸ì¸, í•™ê¸‰ì½”ë“œ)ê°€ ì—†ìŠµë‹ˆë‹¤.\" });\r\n      return;\r\n    }\r\n\r\n    const numAmount = parseFloat(amount);\r\n    if (isNaN(numAmount) || numAmount <= 0) {\r\n      setFeedback({ type: \"error\", message: \"ìœ íš¨í•œ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”.\" });\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setFeedback({ type: \"\", message: \"\" });\r\n\r\n    const userRef = doc(db, \"users\", user.uid);\r\n\r\n    try {\r\n      let logInfo = {}; // ë¡œê·¸ ì •ë³´ë¥¼ ë‹´ì„ ë³€ìˆ˜\r\n\r\n      await runTransaction(db, async (transaction) => {\r\n        const latestUserDocSnap = await transaction.get(userRef);\r\n        const latestTreasurySnap = await transaction.get(treasuryRef);\r\n        \r\n        if (!latestUserDocSnap.exists()) {\r\n          throw new Error(\"ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\r\n        }\r\n\r\n        const latestUserCash = latestUserDocSnap.data().cash || 0;\r\n        const currentTreasuryBalance = latestTreasurySnap.exists() ? latestTreasurySnap.data().totalAmount || 0 : 0;\r\n        \r\n        if (actionType === \"deposit\") {\r\n            let sourceText = '';\r\n            if (depositSource === \"personal\") {\r\n                if (latestUserCash < numAmount) throw new Error(\"ì…ê¸ˆí•  ê¸ˆì•¡ì´ í˜„ì¬ ë³´ìœ  í˜„ê¸ˆë³´ë‹¤ ë§ìŠµë‹ˆë‹¤.\");\r\n                transaction.update(userRef, { cash: increment(-numAmount) });\r\n                sourceText = 'ê°œì¸ í˜„ê¸ˆ';\r\n            } else if (depositSource === \"nationalTreasury\") {\r\n                if (!isAdmin?.()) throw new Error(\"êµ­ê³  ì´ì²´ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.\");\r\n                const latestNationalTreasurySnap = await transaction.get(nationalTreasuryRef);\r\n                const currentNationalBalance = latestNationalTreasurySnap?.exists() ? latestNationalTreasurySnap.data().totalAmount || 0 : 0;\r\n                if (currentNationalBalance < numAmount) throw new Error(\"êµ­ê³  ì”ì•¡ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.\");\r\n                transaction.update(nationalTreasuryRef, { totalAmount: increment(-numAmount), lastUpdated: serverTimestamp() });\r\n                sourceText = 'êµ­ê³ ';\r\n            } else if (depositSource === \"mint\") {\r\n                if (!isAdmin?.()) throw new Error(\"ì‹ ê·œ ë°œí–‰ì€ ê´€ë¦¬ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.\");\r\n                sourceText = 'ì‹ ê·œ ë°œí–‰';\r\n            }\r\n            \r\n            transaction.update(treasuryRef, { totalAmount: increment(numAmount), lastUpdated: serverTimestamp() });\r\n            \r\n            // ë¡œê·¸ ì •ë³´ ì €ì¥\r\n            logInfo = {\r\n                type: LOG_TYPES.TREASURY_DEPOSIT,\r\n                description: `${sourceText}ì—ì„œ í•™ê¸‰ ê¸ˆê³ ë¡œ ${numAmount.toLocaleString()}ì› ì…ê¸ˆí–ˆìŠµë‹ˆë‹¤.`,\r\n                metadata: { amount: numAmount, source: depositSource, treasuryBalance: currentTreasuryBalance + numAmount },\r\n            };\r\n\r\n        } else if (actionType === \"withdraw\") {\r\n            if (currentTreasuryBalance < numAmount) throw new Error(\"ì¶œê¸ˆí•  ê¸ˆì•¡ì´ ê¸ˆê³  ì”ì•¡ë³´ë‹¤ ë§ìŠµë‹ˆë‹¤.\");\r\n            if (!isAdmin?.() && !userDoc.canWithdrawTreasury) throw new Error(\"ê¸ˆê³ ì—ì„œ ì¶œê¸ˆí•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.\");\r\n\r\n            transaction.update(treasuryRef, { totalAmount: increment(-numAmount), lastUpdated: serverTimestamp() });\r\n\r\n            let destinationText = '';\r\n            if (withdrawDestination === \"personal\") {\r\n                transaction.update(userRef, { cash: increment(numAmount) });\r\n                destinationText = 'ê°œì¸ í˜„ê¸ˆ';\r\n            } else if (withdrawDestination === \"nationalTreasury\") {\r\n                if (!isAdmin?.()) throw new Error(\"êµ­ì„¸ì²­ ì´ì²´ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.\");\r\n                transaction.update(nationalTreasuryRef, { totalAmount: increment(numAmount), otherTaxRevenue: increment(numAmount), lastUpdated: serverTimestamp() });\r\n                destinationText = 'êµ­ì„¸ì²­';\r\n            }\r\n\r\n            // ë¡œê·¸ ì •ë³´ ì €ì¥\r\n            logInfo = {\r\n                type: LOG_TYPES.TREASURY_WITHDRAW,\r\n                description: `í•™ê¸‰ ê¸ˆê³ ì—ì„œ ${destinationText}(ìœ¼)ë¡œ ${numAmount.toLocaleString()}ì› ì¶œê¸ˆí–ˆìŠµë‹ˆë‹¤.`,\r\n                metadata: { amount: numAmount, destination: withdrawDestination, treasuryBalance: currentTreasuryBalance - numAmount },\r\n            };\r\n        }\r\n      });\r\n      \r\n      // íŠ¸ëœì­ì…˜ ì„±ê³µ í›„ í†µí•© ë¡œê·¸ ê¸°ë¡\r\n      if (logInfo.type) {\r\n        await logActivity(user.uid, logInfo.type, logInfo.description, logInfo.metadata);\r\n      }\r\n\r\n      setFeedback({ type: \"success\", message: \"ê±°ë˜ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\" });\r\n      setAmount(\"\");\r\n      if (refreshUserDocument) refreshUserDocument();\r\n      refetchTreasuryBalance();\r\n\r\n    } catch (error) {\r\n      console.error(\"ê±°ë˜ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:\", error);\r\n      setFeedback({ type: \"error\", message: `ì˜¤ë¥˜: ${error.message}` });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"send-receive-panel\">\r\n      <h3>í•™ê¸‰ ê¸ˆê³  ê´€ë¦¬ (í•™ê¸‰: {classCode})</h3>\r\n      \r\n      {/* --- ìˆ˜ì •ëœ ìì‚° í‘œì‹œ ë¶€ë¶„ --- */}\r\n      <div className=\"balance-display asset-summary\">\r\n        <div className=\"asset-row\">\r\n            <span className=\"asset-label\">ë‚´ í˜„ê¸ˆ:</span>\r\n            <span className=\"asset-value\">{userCash.toLocaleString()} ì›</span>\r\n        </div>\r\n        <div className=\"asset-row\">\r\n            <span className=\"asset-label\">ì´ ìì‚° (í˜„ê¸ˆ+ì˜ˆê¸ˆ):</span>\r\n            <span className=\"asset-value\">{totalAssets.toLocaleString()} ì›</span>\r\n        </div>\r\n        <div className=\"asset-row\">\r\n            <span className=\"asset-label\">ë³´ìœ  ì£¼ì‹:</span>\r\n            <span className=\"asset-value\">{userStocks} ì£¼</span>\r\n        </div>\r\n        <div className=\"asset-row\">\r\n            <span className=\"asset-label\">ë³´ìœ  ì¿ í°:</span>\r\n            <span className=\"asset-value\">{userCoupons} ê°œ</span>\r\n        </div>\r\n        <hr />\r\n        <div className=\"asset-row treasury\">\r\n            <span className=\"asset-label\">í•™ê¸‰ ê¸ˆê³  ì”ì•¡:</span>\r\n            <span className=\"asset-value\">{treasuryBalance.toLocaleString()} ì›</span>\r\n        </div>\r\n      </div>\r\n      {/* --- ìì‚° í‘œì‹œ ë¶€ë¶„ ë --- */}\r\n\r\n      <div className=\"action-selector\">\r\n        <button\r\n          onClick={() => setActionType(\"deposit\")}\r\n          className={actionType === \"deposit\" ? \"active\" : \"\"}\r\n          disabled={isLoading}\r\n        >\r\n          ì…ê¸ˆ (ë³´ë‚´ê¸°)\r\n        </button>\r\n        <button\r\n          onClick={() => setActionType(\"withdraw\")}\r\n          className={actionType === \"withdraw\" ? \"active\" : \"\"}\r\n          disabled={isLoading}\r\n        >\r\n          ì¶œê¸ˆ (ê°€ì ¸ì˜¤ê¸°)\r\n        </button>\r\n      </div>\r\n\r\n      {actionType === 'deposit' && (\r\n        <div className=\"source-selector\">\r\n          <strong>ì–´ë””ì—ì„œ ë³´ë‚´ì‹œê² ìŠµë‹ˆê¹Œ?</strong>\r\n          <label>\r\n            <input type=\"radio\" name=\"source\" value=\"personal\" checked={depositSource === \"personal\"} onChange={(e) => setDepositSource(e.target.value)} disabled={isLoading} />\r\n            ë‚´ í˜„ê¸ˆ\r\n          </label>\r\n          {isAdmin?.() && (\r\n            <>\r\n              <label>\r\n                <input type=\"radio\" name=\"source\" value=\"nationalTreasury\" checked={depositSource === \"nationalTreasury\"} onChange={(e) => setDepositSource(e.target.value)} disabled={isLoading}/>\r\n                êµ­ì„¸ì²­ (êµ­ê³ )\r\n              </label>\r\n              <label>\r\n                <input type=\"radio\" name=\"source\" value=\"mint\" checked={depositSource === \"mint\"} onChange={(e) => setDepositSource(e.target.value)} disabled={isLoading} />\r\n                ì‹ ê·œ ë°œí–‰\r\n              </label>\r\n            </>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {actionType === \"withdraw\" && (\r\n        <div className=\"destination-selector\">\r\n          <strong>ì–´ë””ë¡œ ê°€ì ¸ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?</strong>\r\n          <label>\r\n            <input type=\"radio\" name=\"destination\" value=\"personal\" checked={withdrawDestination === \"personal\"} onChange={(e) => setWithdrawDestination(e.target.value)} disabled={isLoading} />\r\n            ë‚´ í˜„ê¸ˆìœ¼ë¡œ\r\n          </label>\r\n          {isAdmin?.() && (\r\n            <label>\r\n              <input type=\"radio\" name=\"destination\" value=\"nationalTreasury\" checked={withdrawDestination === \"nationalTreasury\"} onChange={(e) => setWithdrawDestination(e.target.value)} disabled={isLoading} />\r\n              êµ­ì„¸ì²­ìœ¼ë¡œ\r\n            </label>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"transaction-form\">\r\n        <input\r\n          type=\"number\"\r\n          value={amount}\r\n          onChange={(e) => setAmount(e.target.value)}\r\n          placeholder=\"ê¸ˆì•¡ ì…ë ¥\"\r\n          min=\"0\"\r\n          className=\"amount-input\"\r\n          disabled={isLoading}\r\n        />\r\n        <button\r\n          onClick={handleTransaction}\r\n          disabled={isLoading || !amount}\r\n          className=\"submit-button\"\r\n        >\r\n          {isLoading ? \"ì²˜ë¦¬ ì¤‘...\" : \"ì‹¤í–‰í•˜ê¸°\"}\r\n        </button>\r\n      </div>\r\n\r\n      {feedback.message && (\r\n        <p className={`feedback-message ${feedback.type === \"error\" ? \"error\" : \"success\"}`}>\r\n          {feedback.message}\r\n        </p>\r\n      )}\r\n      <div className=\"info-text\">\r\n        <p><strong>ì…ê¸ˆ:</strong> ì„ íƒí•œ ìê¸ˆ ì¶œì²˜ì—ì„œ í•™ê¸‰ ê³µìš© ê¸ˆê³ ë¡œ ëˆì„ ë³´ëƒ…ë‹ˆë‹¤.</p>\r\n        <p><strong>ì¶œê¸ˆ:</strong> í•™ê¸‰ ê³µìš© ê¸ˆê³ ì˜ ëˆì„ ê°œì¸ í˜„ê¸ˆ ë˜ëŠ” êµ­ì„¸ì²­(êµ­ê³ )ìœ¼ë¡œ ë³´ëƒ…ë‹ˆë‹¤. (êµ­ì„¸ì²­ ì´ì²´ëŠ” ê´€ë¦¬ìë§Œ ê°€ëŠ¥)</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SendReceive;","// src/Government.js\r\nimport React, { useState, useEffect, useCallback } from \"react\";\r\nimport \"./Government.css\";\r\nimport \"./NationalAssembly.css\"; // ë²•ì•ˆ ì¹´ë“œ ìŠ¤íƒ€ì¼ ì¬ì‚¬ìš©\r\nimport NationalTaxService from \"./NationalTaxService\";\r\nimport Investment from \"../banking/Investment\";\r\nimport SendReceive from \"../banking/SendReceive\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { usePolling } from \"../../hooks/usePolling\";\r\nimport { db } from \"../../firebase\";\r\nimport { AlchanLoading } from \"../../components/AlchanLayout\";\r\nimport {\r\n  collection,\r\n  query,\r\n  where,\r\n  getDocs,\r\n  doc,\r\n  updateDoc,\r\n  serverTimestamp,\r\n  // orderBy, // orderByëŠ” ì ì‹œ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\r\n} from \"firebase/firestore\";\r\n\r\n// ë‚ ì§œ í¬ë§·íŒ… í—¬í¼ í•¨ìˆ˜\r\nconst formatDate = (dateString) => {\r\n    if (!dateString) return \"ì •ë³´ ì—†ìŒ\";\r\n    try {\r\n      const date = new Date(dateString);\r\n      if (isNaN(date.getTime())) return \"ìœ íš¨í•˜ì§€ ì•Šì€ ë‚ ì§œ\";\r\n      return `${date.getFullYear()}ë…„ ${\r\n        date.getMonth() + 1\r\n      }ì›” ${date.getDate()}ì¼`;\r\n    } catch (e) {\r\n      return \"ë‚ ì§œ ë³€í™˜ ì˜¤ë¥˜\";\r\n    }\r\n  };\r\n\r\n// ë²•ì•ˆ ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸\r\nconst LawManagement = ({ classCode }) => {\r\n  const [laws, setLaws] = useState([]);\r\n  const { isAdmin, userDoc } = useAuth();\r\n\r\n  const { data: jobs } = usePolling(\r\n    async () => {\r\n      if (!classCode) return [];\r\n      const jobsRef = collection(db, \"jobs\");\r\n      const q = query(jobsRef, where(\"classCode\", \"==\", classCode));\r\n      const snapshot = await getDocs(q);\r\n      return snapshot.docs.map((doc) => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      }));\r\n    },\r\n    {\r\n      // ğŸ”¥ [ìµœì í™”] 1ë¶„ â†’ 5ë¶„ìœ¼ë¡œ ë³€ê²½ (ì½ê¸° ë¹„ìš© ì ˆê°)\r\n      interval: 300000,\r\n      enabled: !!classCode,\r\n      deps: [classCode],\r\n    }\r\n  );\r\n\r\n  // ëŒ€í†µë ¹ ë˜ëŠ” ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ í•¨ìˆ˜\r\n  const canManageLaws = useCallback(() => {\r\n    if (isAdmin()) return true;\r\n    if (!userDoc?.selectedJobIds || !jobs || jobs.length === 0) return false;\r\n    const selectedJobs = jobs.filter(job => userDoc.selectedJobIds.includes(job.id));\r\n    return selectedJobs.some(job => job.title === 'ëŒ€í†µë ¹');\r\n  }, [isAdmin, userDoc, jobs]);\r\n\r\n  // ë²•ì•ˆ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜\r\n  const fetchLaws = async () => {\r\n    if (!classCode) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const lawsCollectionRef = collection(\r\n        db,\r\n        \"classes\",\r\n        classCode,\r\n        \"nationalAssemblyLaws\"\r\n      );\r\n\r\n      const q = query(\r\n        lawsCollectionRef,\r\n        where(\"status\", \"==\", \"pending_government_approval\")\r\n      );\r\n\r\n      const querySnapshot = await getDocs(q);\r\n      const loadedLaws = querySnapshot.docs.map((doc) => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      }));\r\n      setLaws(loadedLaws);\r\n    } catch (error) {\r\n      console.error(\"Error fetching pending laws:\", error);\r\n      alert(\"ì •ë¶€ ì´ì†¡ ë²•ì•ˆì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì½˜ì†”ì„ í™•ì¸í•´ì£¼ì„¸ìš”.\");\r\n    }\r\n  };\r\n\r\n  // usePolling hook ì‚¬ìš© (30ì´ˆ ê°„ê²©)\r\n  const { loading, refetch } = usePolling(fetchLaws, { interval: 300000, enabled: !!classCode });\r\n\r\n  // ë²•ì•ˆ ìŠ¹ì¸ í•¸ë“¤ëŸ¬\r\n  const handleApprove = async (lawId) => {\r\n    if (!canManageLaws()) {\r\n        alert(\"ëŒ€í†µë ¹ ë˜ëŠ” ê´€ë¦¬ìë§Œ ë²•ì•ˆì„ ìŠ¹ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\");\r\n        return;\r\n    }\r\n    if(window.confirm(\"ì´ ë²•ì•ˆì„ ìµœì¢… ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\")) {\r\n        const lawDocRef = doc(db, \"classes\", classCode, \"nationalAssemblyLaws\", lawId);\r\n        try {\r\n            await updateDoc(lawDocRef, {\r\n                status: \"approved\",\r\n                finalStatus: \"final_approved\",\r\n                finalApprovalDate: serverTimestamp(),\r\n            });\r\n            alert(\"ë²•ì•ˆì´ ìµœì¢… ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.\");\r\n            refetch(); // ì¦‰ì‹œ ë°ì´í„° ê°±ì‹ \r\n        } catch (error) {\r\n            console.error(\"Error approving law:\", error);\r\n            alert(\"ë²•ì•ˆ ìŠ¹ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\r\n        }\r\n    }\r\n  };\r\n\r\n  // ê±°ë¶€ê¶Œ í–‰ì‚¬ í•¸ë“¤ëŸ¬\r\n  const handleVeto = async (lawId) => {\r\n    if (!canManageLaws()) {\r\n        alert(\"ëŒ€í†µë ¹ ë˜ëŠ” ê´€ë¦¬ìë§Œ ê±°ë¶€ê¶Œì„ í–‰ì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\");\r\n        return;\r\n    }\r\n    const reason = prompt(\"ê±°ë¶€ê¶Œ í–‰ì‚¬ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\");\r\n    if (reason && reason.trim() !== \"\") {\r\n        const lawDocRef = doc(db, \"classes\", classCode, \"nationalAssemblyLaws\", lawId);\r\n        const deadline = new Date();\r\n        deadline.setDate(deadline.getDate() + 7); // ì¬ì˜ê²° ê¸°í•œ: 7ì¼\r\n\r\n        try {\r\n            await updateDoc(lawDocRef, {\r\n                status: \"vetoed\",\r\n                vetoReason: reason,\r\n                vetoDate: serverTimestamp(),\r\n                vetoDeadline: deadline,\r\n                approvals: 0,\r\n                disapprovals: 0,\r\n                voters: {},\r\n            });\r\n            alert(\"ê±°ë¶€ê¶Œì´ í–‰ì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë²•ì•ˆì€ êµ­íšŒì—ì„œ ì¬ì˜ê²° ì ˆì°¨ë¥¼ ê±°ì¹©ë‹ˆë‹¤.\");\r\n            refetch(); // ì¦‰ì‹œ ë°ì´í„° ê°±ì‹ \r\n        } catch (error) {\r\n            console.error(\"Error vetoing law:\", error);\r\n            alert(\"ê±°ë¶€ê¶Œ í–‰ì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\r\n        }\r\n    } else {\r\n        alert(\"ê±°ë¶€ ì‚¬ìœ ë¥¼ ë°˜ë“œì‹œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.\");\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <AlchanLoading />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"law-management-container\">\r\n      <h2>ì •ë¶€ ì´ì†¡ ë²•ì•ˆ ëª©ë¡</h2>\r\n      {laws.length === 0 ? (\r\n        <div className=\"empty-state\">í˜„ì¬ ì •ë¶€ë¡œ ì´ì†¡ëœ ë²•ì•ˆì´ ì—†ìŠµë‹ˆë‹¤.</div>\r\n      ) : (\r\n        <div className=\"law-list\">\r\n          {laws.map((law) => (\r\n            <div key={law.id} className=\"law-card pending-gov\">\r\n              <div className=\"law-content-wrapper\">\r\n                <div className=\"law-header\">\r\n                  <h3 className=\"law-title\">{law.title}</h3>\r\n                  <span className=\"law-status pending-gov\">ì •ë¶€ ì‹¬ì˜ì¤‘</span>\r\n                </div>\r\n                <div className=\"law-content\">\r\n                    <p><strong>ì œì•ˆì:</strong> {law.proposerName || \"ì •ë³´ ì—†ìŒ\"}</p>\r\n                    <p><strong>ì·¨ì§€:</strong> {law.purpose}</p>\r\n                    <p><strong>ì„¤ëª…:</strong> {law.description}</p>\r\n                    <p><strong>ë²Œê¸ˆ:</strong> {law.fine}</p>\r\n                    <p className=\"law-timestamp\">êµ­íšŒ í†µê³¼ì¼: {formatDate(law.approvalDate?.toDate().toISOString())}</p>\r\n                </div>\r\n                {canManageLaws() && (\r\n                    <div className=\"law-footer government-actions\">\r\n                        <button onClick={() => handleApprove(law.id)} className=\"gov-action-button approve\">ìŠ¹ì¸</button>\r\n                        <button onClick={() => handleVeto(law.id)} className=\"gov-action-button veto\">ê±°ë¶€ê¶Œ í–‰ì‚¬</button>\r\n                    </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\nconst Government = () => {\r\n  const { userDoc } = useAuth();\r\n  const classCode = userDoc?.classCode;\r\n\r\n  const [activeTab, setActiveTab] = useState(\"lawManage\");\r\n\r\n  const handleTabClick = (tabName) => {\r\n    setActiveTab(tabName);\r\n  };\r\n\r\n  const renderTabContent = () => {\r\n    if (!classCode) {\r\n      return <AlchanLoading />;\r\n    }\r\n\r\n    switch (activeTab) {\r\n      case \"lawManage\":\r\n        return <LawManagement classCode={classCode} />;\r\n      case \"tax\":\r\n        return <NationalTaxService classCode={classCode} />;\r\n      case \"investment\":\r\n        return <Investment classCode={classCode} />;\r\n      case \"transfer\":\r\n        return <SendReceive classCode={classCode} />;\r\n      default:\r\n        return <LawManagement classCode={classCode} />;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"government-container\">\r\n      <h1 className=\"government-header\">\r\n        ì •ë¶€ ({classCode ? `í•™ê¸‰: ${classCode}` : \"í•™ê¸‰ ì •ë³´ ì—†ìŒ\"})\r\n      </h1>\r\n\r\n      <div className=\"government-tabs\">\r\n        <button\r\n          className={`gov-tab-button ${\r\n            activeTab === \"lawManage\" ? \"active\" : \"\"\r\n          }`}\r\n          onClick={() => handleTabClick(\"lawManage\")}\r\n          disabled={!classCode}\r\n        >\r\n          ë²•ì•ˆ ê´€ë¦¬\r\n        </button>\r\n        <button\r\n          className={`gov-tab-button ${activeTab === \"tax\" ? \"active\" : \"\"}`}\r\n          onClick={() => handleTabClick(\"tax\")}\r\n          disabled={!classCode}\r\n        >\r\n          êµ­ì„¸ì²­\r\n        </button>\r\n        <button\r\n          className={`gov-tab-button ${\r\n            activeTab === \"investment\" ? \"active\" : \"\"\r\n          }`}\r\n          onClick={() => handleTabClick(\"investment\")}\r\n          disabled={!classCode}\r\n        >\r\n          íˆ¬ìí•˜ê¸°\r\n        </button>\r\n        <button\r\n          className={`gov-tab-button ${\r\n            activeTab === \"transfer\" ? \"active\" : \"\"\r\n          }`}\r\n          onClick={() => handleTabClick(\"transfer\")}\r\n          disabled={!classCode}\r\n        >\r\n          ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸°\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"government-tab-content\">{renderTabContent()}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Government;"],"names":["formatDate","timestamp","date","toDate","Date","isNaN","getTime","toLocaleString","DEFAULT_TREASURY_DATA","totalAmount","stockTaxRevenue","stockCommissionRevenue","realEstateTransactionTaxRevenue","vatRevenue","auctionTaxRevenue","propertyHoldingTaxRevenue","itemMarketTaxRevenue","incomeTaxRevenue","corporateTaxRevenue","otherTaxRevenue","lastUpdated","DEFAULT_TAX_SETTINGS","stockTransactionTaxRate","realEstateTransactionTaxRate","itemStoreVATRate","auctionTransactionTaxRate","propertyHoldingTaxRate","propertyHoldingTaxInterval","itemMarketTransactionTaxRate","_ref","classCode","treasuryData","setTreasuryData","useState","taxSettings","setTaxSettings","loadingTreasury","setLoadingTreasury","loadingSettings","setLoadingSettings","activeTab","setActiveTab","editableSettings","setEditableSettings","fetchTreasuryData","useCallback","async","treasuryRef","doc","db","cached","getCachedDocument","_objectSpread","docSnap","getDoc","exists","data","invalidateCache","concat","setDoc","createdAt","serverTimestamp","error","console","refetch","refetchTreasury","usePolling","interval","enabled","fetchTaxSettings","settingsRef","newSettings","merge","refetchSettings","handleSettingChange","e","name","value","target","numericValue","parseFloat","prev","handleIntervalChange","_jsxs","className","children","_jsx","totalTaxRevenue","Object","keys","filter","key","endsWith","reduce","sum","id","label","icon","map","tab","onClick","formatKoreanCurrency","amount","color","item","percentage","toFixed","style","width","type","step","min","max","options","field","includes","onChange","opt","placeholder","alert","updateDoc","styles","container","maxWidth","margin","padding","border","borderRadius","backgroundColor","fontFamily","boxShadow","classCodeDisplay","textAlign","marginBottom","fontSize","balanceDisplay","balanceValue","fontWeight","textShadow","form","formGroup","display","input","actionButton","cursor","transition","divider","borderTop","messageBox","borderWidth","borderStyle","linkContainer","marginTop","gap","linkButton","textDecoration","transactionList","listStyleType","paddingLeft","maxHeight","overflowY","transactionItem","borderBottom","flexWrap","transactionItem_span","marginRight","user","userDoc","isAdmin","refreshUserDocument","useAuth","treasuryBalance","setTreasuryBalance","adminCash","setAdminCash","cash","transferAmount","setTransferAmount","message","setMessage","text","isLoading","setIsLoading","lastTransactions","setLastTransactions","treasuryTransactionsColRef","collection","useEffect","realEstateAnnualTaxRevenue","log","deps","transactionsData","q","query","orderBy","limit","getDocs","docs","undefined","Array","isArray","handleTreasuryTransfer","operationType","preventDefault","adminUserRef","uid","runTransaction","latestTreasurySnap","transaction","get","latestAdminSnap","Error","currentTreasuryBalance","currentAdminCash","newTreasuryBalance","newAdminCash","reason","update","increment","updatedAt","newTransactionRef","set","actorId","actorDisplayName","nickname","email","treasuryBalanceBefore","treasuryBalanceAfter","adminCashBefore","adminCashAfter","length","borderColor","onSubmit","htmlFor","required","disabled","tx","_tx$amount","Link","to","_userDoc$coupons","setAmount","actionType","setActionType","depositSource","setDepositSource","withdrawDestination","setWithdrawDestination","feedback","setFeedback","userCash","setUserCash","userStocks","stocks","values","count","userCoupons","coupons","bankBalance","accounts","acc","balance","totalAssets","nationalTreasuryRef","refetchTreasuryBalance","checked","_Fragment","numAmount","userRef","logInfo","latestUserDocSnap","latestUserCash","sourceText","latestNationalTreasurySnap","LOG_TYPES","TREASURY_DEPOSIT","description","metadata","source","canWithdrawTreasury","destinationText","TREASURY_WITHDRAW","destination","logActivity","dateString","getFullYear","getMonth","getDate","LawManagement","laws","setLaws","jobs","jobsRef","where","canManageLaws","selectedJobIds","job","some","title","loading","lawsCollectionRef","loadedLaws","AlchanLoading","law","_law$approvalDate","proposerName","purpose","fine","approvalDate","toISOString","window","confirm","lawDocRef","lawId","status","finalStatus","finalApprovalDate","handleApprove","prompt","trim","deadline","setDate","vetoReason","vetoDate","vetoDeadline","approvals","disapprovals","voters","handleVeto","Government","handleTabClick","tabName","renderTabContent","NationalTaxService","Investment","SendReceive"],"sourceRoot":""}