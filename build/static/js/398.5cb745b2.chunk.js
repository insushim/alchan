"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[398],{4398(e,t,a){a.r(t),a.d(t,{default:()=>H});var s=a(2555),c=a(5043),n=a(5016),r=a(4689),i=a(2395),o=a(577),l=a(5472),d=a(4891),m=a(9270),u=a(5452);const h="stock",p="etf",x="bond",b={TECH:{name:"\uae30\uc220"},FINANCE:{name:"\uae08\uc735"},CONSUMER:{name:"\uc18c\ube44\uc7ac"},HEALTHCARE:{name:"\ud5ec\uc2a4\ucf00\uc5b4"},ENERGY:{name:"\uc5d0\ub108\uc9c0"},INDUSTRIAL:{name:"\uc0b0\uc5c5"},MATERIALS:{name:"\uc18c\uc7ac"},REALESTATE:{name:"\ubd80\ub3d9\uc0b0"},UTILITIES:{name:"\uc720\ud2f8\ub9ac\ud2f0"},COMMUNICATION:{name:"\ud1b5\uc2e0"},ENTERTAINMENT:{name:"\uc5d4\ud130\ud14c\uc778\uba3c\ud2b8"},INDEX:{name:"\uc9c0\uc218"},GOVERNMENT:{name:"\uad6d\ucc44"},CORPORATE:{name:"\ud68c\uc0ac\ucc44"}},y=36e5,v=.003,g=18e5,f={pendingRequests:new Map,loadBatchData:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=d.Eb.generateKey("BATCH",{classCode:e,userId:t});if(a)u.vF.log("[batchDataLoader] forceRefresh=true - \uce90\uc2dc \ubb34\uc2dc\ud558\uace0 \uc11c\ubc84\uc5d0\uc11c \ub85c\ub4dc"),d.Eb.invalidate(s);else{const e=d.Eb.get(s);if(e)return u.vF.log("[batchDataLoader] Cache HIT - \uce90\uc2dc\ub41c \ub370\uc774\ud130 \uc0ac\uc6a9"),e}if(this.pendingRequests.has(s))return await this.pendingRequests.get(s);const c=this._executeBatchLoad(e,t);this.pendingRequests.set(s,c);try{const e=await c;return d.Eb.set(s,e,18e5),e}finally{this.pendingRequests.delete(s)}},_executeBatchLoad:async function(e,t){const[a,s]=await Promise.all([this._loadStocks(e),this._loadPortfolio(t,e)]);return{stocks:a||[],portfolio:s||[],errors:[]}},_loadStocks:async function(e){try{try{const e=(0,i.Qg)(r.Cn,"getStocksSnapshot"),t=await e({});if(t.data&&Array.isArray(t.data.stocks)&&t.data.stocks.length>0)return t.data.stocks}catch(t){u.vF.warn("[batchDataLoader] \uc2a4\ub0c5\uc0f7 \ud568\uc218 \ud638\ucd9c \uc2e4\ud328, \ubb38\uc11c/\ucffc\ub9ac \ud3f4\ubc31 \uc2dc\ub3c4:",t)}try{const e=(0,l.H9)(r.db,"Settings","centralStocksCache"),t=await(0,l.x7)(e),a=t.exists()?t.data():null;if(a&&Array.isArray(a.stocks)&&a.stocks.length>0)return a.stocks}catch(a){u.vF.warn("[batchDataLoader] \uc2a4\ub0c5\uc0f7 \ubb38\uc11c \uc77d\uae30 \uc2e4\ud328:",a)}const e=(0,l.rJ)(r.db,"CentralStocks"),c=(0,l.query)(e,(0,l.where)("isListed","==",!0));return(await(0,l.getDocs)(c)).docs.map(e=>(0,s.A)({id:e.id},e.data()))}catch(c){return u.vF.error("[batchDataLoader] Stocks load error:",c),[]}},_loadPortfolio:async function(e,t){try{const a=(0,l.rJ)(r.db,"users",e,"portfolio"),c=(0,l.query)(a,(0,l.where)("classCode","==",t));return(await(0,l.getDocs)(c)).docs.map(e=>{var t,a;const c=e.data();return(0,s.A)((0,s.A)({id:e.id},c),{},{lastBuyTime:null!==(t=c.lastBuyTime)&&void 0!==t&&t.toDate?c.lastBuyTime.toDate():c.lastBuyTime,delistedAt:null!==(a=c.delistedAt)&&void 0!==a&&a.toDate?c.delistedAt.toDate():c.delistedAt})})}catch(a){return u.vF.error("[batchDataLoader] Portfolio load error:",a),[]}}},k=e=>{const t=(e=>{var t;return null!==e&&void 0!==e&&e.isRealStock&&null!==(t=e.realStockData)&&void 0!==t&&t.marketState?e.realStockData.marketState:null})(e);if(!t)return null;switch(t){case"REGULAR":return"\uc7a5\uc911";case"PRE":return"\uc7a5\uc804";case"POST":return"\uc7a5\ud6c4";default:return"\uc7a5\ub9c8\uac10"}},j=e=>"number"!==typeof e||isNaN(e)?"0\uc6d0":new Intl.NumberFormat("ko-KR").format(Math.round(e))+"\uc6d0",N=e=>{const t=parseFloat(e);return isNaN(t)?"0.00%":(t>=0?"+":"")+t.toFixed(2)+"%"},S=e=>{const t=Math.floor(e/1e3),a=Math.floor(t/60),s=t%60;return"".concat(a,"\ubd84 ").concat(s,"\ucd08")},w=function(e){return e<=0?0:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:h)===x?Math.round(.154*e):Math.round(.22*e)},T=(new Map,e=>{var t;if(!e.lastBuyTime)return 0;let a;if(e.lastBuyTime instanceof Date)a=e.lastBuyTime.getTime();else if(null!==(t=e.lastBuyTime)&&void 0!==t&&t.toDate)a=e.lastBuyTime.toDate().getTime();else if("number"===typeof e.lastBuyTime)a=e.lastBuyTime;else{if("string"!==typeof e.lastBuyTime)return 0;a=new Date(e.lastBuyTime).getTime()}const s=Date.now(),c=y-(s-a);return Math.max(0,c)}),C=e=>{switch(e){case p:return"\ud83d\udcca";case x:return"\ud83d\udcdc";default:return"\ud83d\udcc8"}},A=e=>{switch(e){case p:return"etf";case x:return"bond";default:return"stock"}},E=e=>{d.Eb&&"function"===typeof d.Eb.invalidatePattern&&d.Eb.invalidatePattern(e)},F=()=>{try{const e=[];for(let t=0;t<localStorage.length;t++){const a=localStorage.key(t);a&&a.includes("BATCH")&&e.push(a)}e.forEach(e=>{localStorage.removeItem(e)}),e.length>0&&u.vF.log("[\uce90\uc2dc] localStorage BATCH \uce90\uc2dc \uc0ad\uc81c:",e.length,"\uac1c")}catch(e){u.vF.warn("[\uce90\uc2dc] localStorage \uc815\ub9ac \uc624\ub958:",e)}};var R=a(579);const M=e=>{let{size:t=24,color:a="currentColor"}=e;return(0,R.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",children:[(0,R.jsx)("polyline",{points:"22,7 13.5,15.5 8.5,10.5 2,17"}),(0,R.jsx)("polyline",{points:"16,7 22,7 22,13"})]})},I=e=>{let{size:t=24,color:a="currentColor"}=e;return(0,R.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",children:[(0,R.jsx)("polyline",{points:"22,17 13.5,8.5 8.5,13.5 2,7"}),(0,R.jsx)("polyline",{points:"16,17 22,17 22,11"})]})},L=e=>{let{size:t=24,color:a="currentColor"}=e;return(0,R.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",children:[(0,R.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,R.jsx)("path",{d:"M12 1v6m0 6v6m11-7h-6m-6 0H1m17.5-3.5L19 10m-2 2l-2.5 2.5M6.5 6.5L9 9m-2 2l-2.5 2.5"})]})},B=e=>{let{size:t=16,color:a="currentColor"}=e;return(0,R.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,R.jsx)("polyline",{points:"23 4 23 10 17 10"}),(0,R.jsx)("polyline",{points:"1 20 1 14 7 14"}),(0,R.jsx)("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L20.49 10"}),(0,R.jsx)("path",{d:"M20.49 15a9 9 0 0 1-14.85 3.36L3.51 14"})]})},D=e=>{let{size:t=24,color:a="currentColor"}=e;return(0,R.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",children:[(0,R.jsx)("line",{x1:"12",y1:"20",x2:"12",y2:"10"}),(0,R.jsx)("line",{x1:"18",y1:"20",x2:"18",y2:"4"}),(0,R.jsx)("line",{x1:"6",y1:"20",x2:"6",y2:"16"})]})},P=e=>{let{size:t=24,color:a="currentColor"}=e;return(0,R.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",children:[(0,R.jsx)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,R.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})},O=c.memo(e=>{let{onAddStock:t}=e;const[a,n]=(0,c.useState)(!1),[r,i]=(0,c.useState)(!1),[o,l]=(0,c.useState)({name:"",symbol:"",sector:"TECH",productType:"stock"});return(0,R.jsxs)("div",{className:"mt-2.5",children:[(0,R.jsx)("button",{onClick:()=>n(!a),className:"btn btn-secondary w-full mb-2.5",children:a?"\uc811\uae30":"\u2795 \uac1c\ubcc4 \uc8fc\uc2dd/ETF \ucd94\uac00"}),a&&(0,R.jsxs)("div",{className:"bg-[rgba(20,20,35,0.8)] p-3 rounded-lg border border-white/10",children:[(0,R.jsx)("p",{className:"text-[0.85rem] text-slate-400 mb-2.5",children:"\ud83d\udccc \ube60\ub978 \ucd94\uac00 (\ud074\ub9ad\ud558\uba74 \ubc14\ub85c \ucd94\uac00\ub429\ub2c8\ub2e4)"}),(0,R.jsx)("div",{className:"flex flex-wrap gap-1.5 mb-4",children:[{name:"\uc0bc\uc131\uc804\uc790",symbol:"005930.KS",type:"\ud55c\uad6d \uc8fc\uc2dd"},{name:"SK\ud558\uc774\ub2c9\uc2a4",symbol:"000660.KS",type:"\ud55c\uad6d \uc8fc\uc2dd"},{name:"LG\uc5d0\ub108\uc9c0\uc194\ub8e8\uc158",symbol:"373220.KS",type:"\ud55c\uad6d \uc8fc\uc2dd"},{name:"NAVER",symbol:"035420.KS",type:"\ud55c\uad6d \uc8fc\uc2dd"},{name:"\uce74\uce74\uc624",symbol:"035720.KS",type:"\ud55c\uad6d \uc8fc\uc2dd"},{name:"\ud604\ub300\ucc28",symbol:"005380.KS",type:"\ud55c\uad6d \uc8fc\uc2dd"},{name:"Apple",symbol:"AAPL",type:"\ubbf8\uad6d \uc8fc\uc2dd"},{name:"Microsoft",symbol:"MSFT",type:"\ubbf8\uad6d \uc8fc\uc2dd"},{name:"Google",symbol:"GOOGL",type:"\ubbf8\uad6d \uc8fc\uc2dd"},{name:"Tesla",symbol:"TSLA",type:"\ubbf8\uad6d \uc8fc\uc2dd"},{name:"NVIDIA",symbol:"NVDA",type:"\ubbf8\uad6d \uc8fc\uc2dd"},{name:"Amazon",symbol:"AMZN",type:"\ubbf8\uad6d \uc8fc\uc2dd"},{name:"KODEX 200",symbol:"069500.KS",type:"\ud55c\uad6d ETF"},{name:"KODEX \ub808\ubc84\ub9ac\uc9c0",symbol:"122630.KS",type:"\ud55c\uad6d ETF"},{name:"TIGER \ubbf8\uad6dS&P500",symbol:"360750.KS",type:"\ud55c\uad6d ETF"},{name:"SPY",symbol:"SPY",type:"\ubbf8\uad6d ETF (S&P500)"},{name:"QQQ",symbol:"QQQ",type:"\ubbf8\uad6d ETF (\ub098\uc2a4\ub2e5100)"},{name:"TLT",symbol:"TLT",type:"\ucc44\uad8c ETF (\ubbf8\uad6d \uc7a5\uae30\uad6d\ucc44)"},{name:"GLD",symbol:"GLD",type:"\uc6d0\uc790\uc7ac ETF (\uae08)"}].map(e=>(0,R.jsx)("button",{onClick:()=>(async e=>{if(!r){i(!0);try{await t({name:e.name,symbol:e.symbol}),alert("".concat(e.name," \ucd94\uac00 \uc644\ub8cc!"))}catch(a){alert("\ucd94\uac00 \uc2e4\ud328: "+a.message)}finally{i(!1)}}})(e),disabled:r,className:"px-2 py-1 text-xs text-white rounded cursor-pointer whitespace-nowrap ".concat(e.type.includes("ETF")?"bg-blue-500/20 border border-blue-500/30":e.type.includes("\ucc44\uad8c")?"bg-amber-500/20 border border-amber-500/30":e.type.includes("\uc6d0\uc790\uc7ac")?"bg-pink-500/20 border border-pink-500/30":"bg-emerald-500/20 border border-emerald-500/30"),title:"".concat(e.type," - ").concat(e.symbol),children:e.name},e.symbol))}),(0,R.jsx)("p",{className:"text-[0.85rem] text-slate-400 mb-2",children:"\u270f\ufe0f \uc9c1\uc811 \uc785\ub825 (Yahoo Finance \uc2ec\ubcfc \uc0ac\uc6a9)"}),(0,R.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,R.jsx)("input",{type:"text",placeholder:"\uc774\ub984 (\uc608: \uc0bc\uc131\uc804\uc790)",value:o.name,onChange:e=>l(t=>(0,s.A)((0,s.A)({},t),{},{name:e.target.value})),className:"flex-1 min-w-[120px] p-2 rounded border border-white/20 bg-black/30 text-white"}),(0,R.jsx)("input",{type:"text",placeholder:"\uc2ec\ubcfc (\uc608: 005930.KS)",value:o.symbol,onChange:e=>l(t=>(0,s.A)((0,s.A)({},t),{},{symbol:e.target.value})),className:"flex-1 min-w-[120px] p-2 rounded border border-white/20 bg-black/30 text-white"}),(0,R.jsx)("button",{onClick:async()=>{if(o.name&&o.symbol){if(!r){i(!0);try{await t(o),alert("".concat(o.name," \ucd94\uac00 \uc644\ub8cc!")),l({name:"",symbol:"",sector:"TECH",productType:"stock"}),n(!1)}catch(e){alert("\ucd94\uac00 \uc2e4\ud328: "+e.message)}finally{i(!1)}}}else alert("\uc774\ub984\uacfc \uc2ec\ubcfc\uc744 \ubaa8\ub450 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:r,className:"btn btn-success px-4 py-2",children:r?"\ucd94\uac00 \uc911...":"\ucd94\uac00"})]}),(0,R.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"\ud83d\udca1 \ud55c\uad6d \uc8fc\uc2dd: \uc885\ubaa9\ucf54\ub4dc.KS (\uc608: 005930.KS) | \ubbf8\uad6d \uc8fc\uc2dd: \ud2f0\ucee4 (\uc608: AAPL, TSLA)"})]})]})}),K=c.memo(e=>{let{stocks:t,classCode:a,onClose:n,onAddStock:r,onDeleteStock:i,onEditStock:o,onToggleManualStock:l,cacheStats:d,onManualUpdate:m,onCreateRealStocks:u,onUpdateRealStocks:y,onAddSingleRealStock:v,onDeleteSimulationStocks:g}=e;const[f,k]=(0,c.useState)(!1),[N,S]=(0,c.useState)(!1),[w,T]=(0,c.useState)(!1),[A,E]=(0,c.useState)(!1),[F,M]=(0,c.useState)(!1),[I,B]=(0,c.useState)({name:"",price:"",minListingPrice:"",isManual:!1,sector:"TECH",productType:h,maturityYears:"",couponRate:""});return(0,R.jsxs)("div",{className:"admin-panel-fullscreen",children:[(0,R.jsxs)("div",{className:"admin-header",children:[(0,R.jsxs)("h2",{children:[(0,R.jsx)(L,{size:24})," \uad00\ub9ac\uc790 \ud328\ub110 (",a,")"]}),(0,R.jsxs)("div",{className:"flex gap-2.5 items-center",children:[(0,R.jsxs)("div",{className:"text-[0.85rem] text-gray-500",children:["\uce90\uc2dc \ud1b5\uacc4: \uc801\uc911 ",d.hits,", \ub204\ub77d ",d.misses,", \uc808\uc57d ",d.savings,"\ud68c"]}),(0,R.jsx)("button",{onClick:n,className:"btn btn-danger",children:"\ub2eb\uae30"})]})]}),(0,R.jsxs)("div",{className:"admin-content",children:[(0,R.jsxs)("div",{className:"admin-section",children:[(0,R.jsx)("h3",{children:"\ud83d\udcca \uc2e4\uc81c \uc8fc\uc2dd \uad00\ub9ac (Yahoo Finance)"}),(0,R.jsxs)("div",{className:"mb-5 p-4 bg-emerald-500/10 rounded-lg border border-emerald-500/30",children:[(0,R.jsxs)("p",{className:"mb-2.5 text-emerald-400 text-[0.9rem]",children:["\ud83c\udf10 \uc2e4\uc81c \uc8fc\uc2dd \ub370\uc774\ud130\ub97c Yahoo Finance\uc5d0\uc11c \uac00\uc838\uc635\ub2c8\ub2e4.",(0,R.jsx)("br",{}),"\ud83d\udcc8 \uc0bc\uc131\uc804\uc790, SK\ud558\uc774\ub2c9\uc2a4, \uc560\ud50c, \ud14c\uc2ac\ub77c, ETF, \ucc44\uad8c ETF \ub4f1 \uc9c0\uc6d0",(0,R.jsx)("br",{}),"\u23f0 15\ubd84\ub9c8\ub2e4 \uc790\ub3d9\uc73c\ub85c \uac00\uaca9\uc774 \uc5c5\ub370\uc774\ud2b8\ub429\ub2c8\ub2e4. | \ud83d\udcb1 \ud658\uc728: \ud558\ub8e8 1\ud68c \uc790\ub3d9 \uc5c5\ub370\uc774\ud2b8"]}),(0,R.jsxs)("div",{className:"flex gap-2.5 mb-2.5",children:[(0,R.jsx)("button",{onClick:async()=>{if(window.confirm("\uc2e4\uc81c \uc8fc\uc2dd \ub370\uc774\ud130(\uc0bc\uc131\uc804\uc790, \uc560\ud50c \ub4f1)\ub97c \uc0dd\uc131\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n(Yahoo Finance\uc5d0\uc11c \uc2e4\uc2dc\uac04 \uac00\uaca9\uc744 \uac00\uc838\uc635\ub2c8\ub2e4)")&&!w){T(!0);try{await u(),alert("\uc2e4\uc81c \uc8fc\uc2dd\uc774 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4! 15\ubd84\ub9c8\ub2e4 \uc790\ub3d9\uc73c\ub85c \uac00\uaca9\uc774 \uc5c5\ub370\uc774\ud2b8\ub429\ub2c8\ub2e4.")}catch(e){alert("\uc2e4\uc81c \uc8fc\uc2dd \uc0dd\uc131 \uc2e4\ud328: "+e.message)}finally{T(!1)}}},disabled:w,className:"btn btn-success flex-1 p-3 text-[0.9rem] font-bold",children:w?"\u23f3 \uc0dd\uc131 \uc911...":"\ud83c\udfe2 \uae30\ubcf8 \uc8fc\uc2dd \uc0dd\uc131"}),(0,R.jsx)("button",{onClick:async()=>{if(!A){E(!0);try{await y(),alert("\uc2e4\uc81c \uc8fc\uc2dd \uac00\uaca9\uc774 \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4!")}catch(e){alert("\uc2e4\uc81c \uc8fc\uc2dd \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328: "+e.message)}finally{E(!1)}}},disabled:A,className:"btn btn-primary flex-1 p-3 text-[0.9rem] font-bold",children:A?"\u23f3 \uc5c5\ub370\uc774\ud2b8 \uc911...":"\ud83d\udd04 \uac00\uaca9 \uc989\uc2dc \uc5c5\ub370\uc774\ud2b8"})]}),(0,R.jsx)(O,{onAddStock:v}),(0,R.jsxs)("div",{className:"mt-2.5 pt-2.5 border-t border-white/10",children:[(0,R.jsx)("button",{onClick:async()=>{if(window.confirm("\u26a0\ufe0f \ubaa8\ub4e0 \uc2dc\ubbac\ub808\uc774\uc158 \uc8fc\uc2dd\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\n\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.\n(\uc2e4\uc81c \uc8fc\uc2dd\uc740 \uc720\uc9c0\ub429\ub2c8\ub2e4)")&&!F){M(!0);try{await g(),alert("\uc2dc\ubbac\ub808\uc774\uc158 \uc8fc\uc2dd\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4!")}catch(e){alert("\uc0ad\uc81c \uc2e4\ud328: "+e.message)}finally{M(!1)}}},disabled:F,className:"btn btn-danger w-full p-2.5 text-[0.85rem]",children:F?"\u23f3 \uc0ad\uc81c \uc911...":"\ud83d\uddd1\ufe0f \uc2dc\ubbac\ub808\uc774\uc158 \uc8fc\uc2dd \uc804\uccb4 \uc0ad\uc81c"}),(0,R.jsx)("p",{className:"text-xs text-gray-400 mt-1 text-center",children:"\u26a0\ufe0f \uc2e4\uc81c \uc8fc\uc2dd(\uc2e4\uc2dc\uac04)\ub9cc \ub0a8\uae30\uace0 \uac00\uc0c1 \uc8fc\uc2dd\uc744 \ubaa8\ub450 \uc0ad\uc81c\ud569\ub2c8\ub2e4"})]})]})]}),(0,R.jsxs)("div",{className:"admin-section",children:[(0,R.jsxs)("h3",{children:[(0,R.jsx)(D,{size:20})," \uc0c1\ud488 \ubaa9\ub85d \uad00\ub9ac"]}),(0,R.jsx)("div",{className:"admin-stock-list",children:t.map(e=>{var t;return(0,R.jsxs)("div",{className:"admin-stock-item",children:[(0,R.jsxs)("div",{className:"admin-stock-info",children:[(0,R.jsxs)("span",{className:"stock-name",children:[C(e.productType)," ",e.name,e.isRealStock&&(0,R.jsx)("span",{className:"ml-1.5 bg-emerald-500 text-white text-[0.65rem] px-1 py-px rounded-sm font-bold",children:"\uc2e4\uc2dc\uac04"})]}),(0,R.jsxs)("span",{className:"stock-details",children:[j(e.price)," | ",(null===(t=b[e.sector])||void 0===t?void 0:t.name)||"\uae30\ud0c0"," | ",e.isListed?"\uc0c1\uc7a5":"\uc0c1\uc7a5\ud3d0\uc9c0"," | ",e.isManual?"\uc218\ub3d9":e.isRealStock?"\uc2e4\uc2dc\uac04":"\uc790\ub3d9",e.productType===x&&" | \ub9cc\uae30: ".concat(e.maturityYears,"\ub144 | \uc774\uc790\uc728: ").concat(e.couponRate,"%")]})]}),(0,R.jsxs)("div",{className:"form-actions",children:[(0,R.jsx)("button",{onClick:()=>o(e.id),className:"btn btn-primary",children:"\uac00\uaca9 \uc218\uc815"}),(0,R.jsx)("button",{onClick:()=>l(e.id,e.isListed),className:"btn ".concat(e.isListed?"btn-secondary":"btn-success"),children:e.isListed?"\uc0c1\uc7a5\ud3d0\uc9c0":"\uc7ac\uc0c1\uc7a5"}),(0,R.jsx)("button",{onClick:()=>i(e.id,e.name),className:"btn btn-danger",children:"\uc0ad\uc81c"})]})]},e.id)})})]}),(0,R.jsxs)("div",{className:"admin-section",children:[(0,R.jsx)("h3",{children:"\uc0c8 \uc0c1\ud488 \ucd94\uac00"}),(0,R.jsx)("button",{onClick:()=>k(!f),className:"btn btn-primary",children:f?"\ucde8\uc18c":"\uc0c8 \uc0c1\ud488 \ucd94\uac00 \uc591\uc2dd \uc5f4\uae30"}),f&&(0,R.jsxs)("div",{className:"add-stock-form",children:[(0,R.jsxs)("div",{className:"form-grid",children:[(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsx)("label",{className:"form-label",children:"\uc0c1\ud488 \uc720\ud615"}),(0,R.jsxs)("select",{value:I.productType,onChange:e=>B(t=>(0,s.A)((0,s.A)({},t),{},{productType:e.target.value})),className:"form-input",children:[(0,R.jsx)("option",{value:h,children:"\uc8fc\uc2dd"}),(0,R.jsx)("option",{value:p,children:"ETF/\uc9c0\uc218"}),(0,R.jsx)("option",{value:x,children:"\ucc44\uad8c"})]})]}),(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsx)("label",{className:"form-label",children:"\uc0c1\ud488\uba85"}),(0,R.jsx)("input",{type:"text",value:I.name,onChange:e=>B(t=>(0,s.A)((0,s.A)({},t),{},{name:e.target.value})),className:"form-input",placeholder:I.productType===x?"\uc608: \uad6d\uace0\ucc44 10\ub144":I.productType===p?"\uc608: KOSPI 200":"\uc608: \uc0bc\uc131\uc804\uc790"})]}),(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsx)("label",{className:"form-label",children:"\ucd08\uae30 \uac00\uaca9"}),(0,R.jsx)("input",{type:"number",value:I.price,onChange:e=>B(t=>(0,s.A)((0,s.A)({},t),{},{price:e.target.value})),className:"form-input"})]}),(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsx)("label",{className:"form-label",children:"\ucd5c\uc18c \uc0c1\uc7a5\uac00"}),(0,R.jsx)("input",{type:"number",value:I.minListingPrice,onChange:e=>B(t=>(0,s.A)((0,s.A)({},t),{},{minListingPrice:e.target.value})),className:"form-input"})]}),I.productType===h&&(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsx)("label",{className:"form-label",children:"\uc139\ud130"}),(0,R.jsx)("select",{value:I.sector,onChange:e=>B(t=>(0,s.A)((0,s.A)({},t),{},{sector:e.target.value})),className:"form-input",children:Object.entries(b).filter(e=>{let[t]=e;return!["INDEX","GOVERNMENT","CORPORATE"].includes(t)}).map(e=>{let[t,a]=e;return(0,R.jsx)("option",{value:t,children:a.name},t)})})]}),I.productType===x&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsx)("label",{className:"form-label",children:"\ub9cc\uae30 (\ub144)"}),(0,R.jsx)("input",{type:"number",value:I.maturityYears,onChange:e=>B(t=>(0,s.A)((0,s.A)({},t),{},{maturityYears:e.target.value})),className:"form-input",placeholder:"\uc608: 10"})]}),(0,R.jsxs)("div",{className:"form-group",children:[(0,R.jsx)("label",{className:"form-label",children:"\ud45c\uba74\uc774\uc790\uc728 (%)"}),(0,R.jsx)("input",{type:"number",step:"0.1",value:I.couponRate,onChange:e=>B(t=>(0,s.A)((0,s.A)({},t),{},{couponRate:e.target.value})),className:"form-input",placeholder:"\uc608: 3.5"})]})]}),(0,R.jsxs)("div",{className:"form-group checkbox-group",children:[(0,R.jsx)("input",{type:"checkbox",checked:I.isManual,onChange:e=>B(t=>(0,s.A)((0,s.A)({},t),{},{isManual:e.target.checked})),id:"isManualCheckbox",className:"checkbox-input"}),(0,R.jsx)("label",{htmlFor:"isManualCheckbox",children:"\uc218\ub3d9 \uad00\ub9ac (\uc790\ub3d9 \uac00\uaca9 \ubcc0\ub3d9 \uc81c\uc678)"})]})]}),(0,R.jsx)("div",{className:"form-actions",children:(0,R.jsx)("button",{onClick:async()=>{if(!I.name||!I.price||!I.minListingPrice)return alert("\ubaa8\ub4e0 \ud544\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.");const e=parseFloat(I.price),t=parseFloat(I.minListingPrice);if(e<=0||t<=0)return alert("\uac00\uaca9\uc740 0\ubcf4\ub2e4 \ucee4\uc57c \ud569\ub2c8\ub2e4.");const a={name:I.name,price:e,minListingPrice:t,isListed:!0,isManual:I.isManual,sector:I.sector,productType:I.productType,buyVolume:0,sellVolume:0,recentBuyVolume:0,recentSellVolume:0,volatility:I.productType===x?.005:.02};I.productType===x&&(a.maturityYears=parseFloat(I.maturityYears)||10,a.couponRate=parseFloat(I.couponRate)||3.5,a.sector="GOVERNMENT"),I.productType===p&&(a.sector="INDEX"),await r(a),B({name:"",price:"",minListingPrice:"",isManual:!1,sector:"TECH",productType:h,maturityYears:"",couponRate:""}),k(!1)},className:"btn btn-success",children:"\uc0c1\ud488 \ucd94\uac00"})})]})]})]})]})}),H=()=>{const{user:e,userDoc:t,isAdmin:a,loading:O,firebaseReady:H,functions:q,optimisticUpdate:_,refreshUserDocument:V}=(0,n.As)(),U=(0,c.useMemo)(()=>({getVacationModeStatus:(0,i.Qg)(q,"getVacationModeStatus"),toggleVacationMode:(0,i.Qg)(q,"toggleVacationMode"),updateStocksSnapshot:(0,i.Qg)(q,"updateStocksSnapshot"),addStockDoc:(0,i.Qg)(q,"addStockDoc"),buyStock:(0,i.Qg)(q,"buyStock"),sellStock:(0,i.Qg)(q,"sellStock"),manualUpdateStockMarket:(0,i.Qg)(q,"manualUpdateStockMarket"),createRealStocks:(0,i.Qg)(q,"createRealStocks"),updateRealStocks:(0,i.Qg)(q,"updateRealStocks"),addSingleRealStock:(0,i.Qg)(q,"addSingleRealStock"),deleteSimulationStocks:(0,i.Qg)(q,"deleteSimulationStocks")}),[q]),[z,Q]=(0,c.useState)(null),[Y,G]=(0,c.useState)([]),[W,X]=(0,c.useState)([]),[Z,J]=(0,c.useState)(!1),[$,ee]=(0,c.useState)({}),[te,ae]=(0,c.useState)({}),[se,ce]=(0,c.useState)(!1),[ne,re]=(0,c.useState)({}),[ie,oe]=(0,c.useState)("stocks"),[le,de]=(0,c.useState)(null),[me,ue]=(0,c.useState)(!1),[he,pe]=(0,c.useState)(!1),[xe,be]=(0,c.useState)(!1),[ye,ve]=(0,c.useState)(!1),[ge,fe]=(0,c.useState)({hits:0,misses:0,savings:0}),[ke,je]=(0,c.useState)(null),Ne=(0,c.useRef)({stocks:0,portfolio:0,marketStatus:0,batchLoad:0}),Se=(0,c.useRef)(!1);(0,c.useEffect)(()=>{const e=()=>{const e=new Date,t=new Date(e.toLocaleString("en-US",{timeZone:"Asia/Seoul"})),a=t.getDay(),s=60*t.getHours()+t.getMinutes(),c=a>=1&&a<=5&&s>=540&&s<930,n=new Date(e.toLocaleString("en-US",{timeZone:"America/New_York"})),r=n.getDay(),i=60*n.getHours()+n.getMinutes();pe(c||r>=1&&r<=5&&i>=570&&i<960)};e();const t=setInterval(e,6e4);return()=>clearInterval(t)},[]),(0,c.useEffect)(()=>{null!==t&&void 0!==t&&t.classCode&&Q(t.classCode)},[t]);const we=(0,c.useRef)(W);(0,c.useEffect)(()=>{we.current=W},[W]),(0,c.useEffect)(()=>{if(!we.current||0===we.current.length)return;const e=setInterval(()=>{we.current.some(e=>T(e)>0)&&re(e=>{const t={};return we.current.forEach(e=>{const a=T(e);a>0&&(t[e.id]=a)}),t})},1e3);return()=>clearInterval(e)},[W.length]),(0,c.useEffect)(()=>{const e={};W.forEach(t=>{const a=T(t);a>0&&(e[t.id]=a)}),re(e)},[W]);const Te=(0,c.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return;if(!z)return;if(Se.current&&!t)return void u.vF.log("[StockExchange] \uc774\ubbf8 fetching \uc911\uc774\ubbc0\ub85c \ub300\uae30");const a=Date.now(),s=a-Ne.current.batchLoad;if(t||!(s<=g)){Se.current=!0,ue(!0);try{const s=await f.loadBatchData(z,e.uid,t);s.errors&&s.errors.length>0&&u.vF.warn("[StockExchange] \ubc30\uce58 \ub85c\ub4dc \uc911 \uc77c\ubd80 \uc624\ub958 \ubc1c\uc0dd:",s.errors),G(s.stocks||[]),X(s.portfolio||[]),Ne.current.batchLoad=a,Ne.current.stocks=a,Ne.current.portfolio=a,Ne.current.marketStatus=a,je(new Date),de(new Date)}catch(c){u.vF.error("[StockExchange] \ubc30\uce58 \ub85c\ub4dc \uc2e4\ud328:",c)}finally{Se.current=!1,ue(!1)}}},[z,e]);(0,o.nm)(Te,{interval:36e5,enabled:H&&!!e&&!!z,deps:[e,z,a]});const Ce=(0,c.useCallback)(async()=>{if(null!==t&&void 0!==t&&t.isSuperAdmin)try{const e=U.getVacationModeStatus,t=await e({});be(t.data.vacationMode)}catch(e){u.vF.error("[fetchVacationMode] \uc870\ud68c \uc2e4\ud328:",e)}},[U,null===t||void 0===t?void 0:t.isSuperAdmin]);(0,c.useEffect)(()=>{null!==t&&void 0!==t&&t.isSuperAdmin&&q&&Ce()},[null===t||void 0===t?void 0:t.isSuperAdmin,q,Ce]);const Ae=(0,c.useCallback)(async()=>{if(null!==t&&void 0!==t&&t.isSuperAdmin){ve(!0);try{const e=U.toggleVacationMode,t=await e({enabled:!xe});be(t.data.vacationMode),alert(t.data.message)}catch(e){u.vF.error("[toggleVacationMode] \ud1a0\uae00 \uc2e4\ud328:",e),alert("\ubc29\ud559 \ubaa8\ub4dc \uc124\uc815 \uc2e4\ud328: "+e.message)}finally{ve(!1)}}},[U,null===t||void 0===t?void 0:t.isSuperAdmin,xe]),Ee=(0,c.useCallback)(async()=>{try{const e=U.updateStocksSnapshot;await e({}),u.vF.log("[updateStocksSnapshot] \uc2a4\ub0c5\uc0f7 \uac31\uc2e0 \uc644\ub8cc")}catch(e){u.vF.error("[updateStocksSnapshot] \uc2a4\ub0c5\uc0f7 \uac31\uc2e0 \uc2e4\ud328:",e)}},[U]),Fe=(0,c.useCallback)(async t=>{if(!z||!e)return alert("\ud074\ub798\uc2a4 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");try{const a=U.addStockDoc;await a({stock:t}),await Ee();const s=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});d.Eb.invalidate(s),E("STOCKS_".concat(z)),await Te(!0),alert("".concat(t.name," \uc0c1\ud488\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))}catch(a){u.vF.error("[addStock] \ud568\uc218 \ucd94\uac00 \uc2e4\ud328, Firestore \uc9c1\uc811 \uc2dc\ub3c4:",a);try{const a=(0,l.H9)((0,l.rJ)(r.db,"CentralStocks"));await(0,l.BN)(a,(0,s.A)((0,s.A)({},t),{},{initialPrice:t.price,priceHistory:[t.price],createdAt:(0,l.O5)(),holderCount:0,tradingVolume:1e3,buyVolume:0,sellVolume:0,recentBuyVolume:0,recentSellVolume:0,volatility:t.volatility||.02})),await Ee();const c=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});d.Eb.invalidate(c),E("STOCKS_".concat(z)),await Te(!0),alert("".concat(t.name," \uc0c1\ud488\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))}catch(c){u.vF.error("[addStock] Firestore \uc9c1\uc811 \ucd94\uac00 \uc2e4\ud328:",c),alert("\uc0c1\ud488 \ucd94\uac00 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790 \uad8c\ud55c/Rules\ub97c \ud655\uc778\ud574\uc8fc\uc138\uc694.")}}},[z,e,Te,Ee,U]),Re=(0,c.useCallback)(async(t,a)=>{if(!z||!e)return alert("\ud074\ub798\uc2a4 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");if(window.confirm("'".concat(a,"' \uc0c1\ud488\uc744 \uc815\ub9d0\ub85c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))try{await(0,l.kd)((0,l.H9)(r.db,"CentralStocks",t)),await Ee();const s=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});d.Eb.invalidate(s),E("STOCKS_".concat(z)),await Te(!0),alert("".concat(a," \uc0c1\ud488\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))}catch(s){alert("\uc0c1\ud488 \uc0ad\uc81c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},[z,e,Te,Ee]),Me=(0,c.useCallback)(async t=>{if(!z||!e)return alert("\ud074\ub798\uc2a4 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const a=Y.find(e=>e.id===t);if(!a)return;const s=prompt("'".concat(a.name,"'\uc758 \uc0c8\ub85c\uc6b4 \uac00\uaca9:"),a.price.toString()),c=parseFloat(s);if(isNaN(c)||c<=0)return alert("\uc720\ud6a8\ud55c \uac00\uaca9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");try{await(0,l.mZ)((0,l.H9)(r.db,"CentralStocks",t),{price:c,priceHistory:[...(a.priceHistory||[]).slice(-19),c]}),await Ee();const s=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});d.Eb.invalidate(s),E("STOCKS_".concat(z)),await Te(!0),alert("\uac00\uaca9\uc774 \uc218\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(n){alert("\uac00\uaca9 \uc218\uc815 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},[Y,z,e,Te,Ee]),Ie=(0,c.useCallback)(async(t,a)=>{if(!z||!e)return alert("\ud074\ub798\uc2a4 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const s=Y.find(e=>e.id===t);if(!s)return;const c=a?"\uc0c1\uc7a5\ud3d0\uc9c0":"\uc7ac\uc0c1\uc7a5";if(window.confirm("'".concat(s.name,"' \uc0c1\ud488\uc744 ").concat(c,"\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))try{const n=a?{isListed:!1,price:0,delistedAt:(0,l.O5)()}:{isListed:!0,price:s.minListingPrice,priceHistory:[s.minListingPrice],delistedAt:null};if(await(0,l.mZ)((0,l.H9)(r.db,"CentralStocks",t),n),a){const e=(0,l.wP)(r.db),a=(0,l.query)((0,l.Cs)(r.db,"portfolio"),(0,l.where)("classCode","==",z),(0,l.where)("stockId","==",t));(await(0,l.getDocs)(a)).forEach(t=>{e.update(t.ref,{delistedAt:(0,l.O5)()})}),await e.commit()}await Ee();const i=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});d.Eb.invalidate(i),E("STOCKS_".concat(z)),E("PORTFOLIO"),await Te(!0),alert("".concat(c," \ucc98\ub9ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))}catch(n){alert("".concat(c," \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."))}},[Y,z,e,Te,Ee]),Le=(0,c.useCallback)(async(a,c)=>{if(!he)return alert("\uc8fc\uc2dd\uc2dc\uc7a5\uc774 \ub9c8\uac10\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc6b4\uc601 \uc2dc\uac04: \uc6d4-\uae08 \uc624\uc804 8\uc2dc-\uc624\ud6c4 3\uc2dc");if(se||!z)return;const n=parseInt(c,10);if(isNaN(n)||n<=0)return alert("\uc720\ud6a8\ud55c \uc218\ub7c9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");const i=Y.find(e=>e.id===a);if(!e||!i||!i.isListed)return alert("\ub9e4\uc218\ud560 \uc218 \uc5c6\ub294 \uc0c1\ud0dc\uc785\ub2c8\ub2e4.");const o=i.price*n,l=Math.round(o*v),h=Math.floor(.01*o),p=o+l+h;u.vF.log("[buyStock] \ub9e4\uc218 \uc2dc\uc791:",{stockId:a,stockName:i.name,quantity:n,totalCost:p}),_&&_({cash:-p}),ce(!0);try{const c=U.buyStock,o=await c({stockId:a,quantity:n});if(u.vF.log("[buyStock] \ub9e4\uc218 \uc131\uacf5:",o.data),void 0!==o.data.newBalance&&_){const e=(null===t||void 0===t?void 0:t.cash)||0,a=o.data.newBalance-e;_({cash:a}),u.vF.log("[buyStock] \ud604\uae08 \uc815\ud655\ud55c \uac12\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8:",o.data.newBalance)}const x=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});d.Eb.invalidate(x),E("PORTFOLIO_user_".concat(e.uid)),F(),X(e=>{const t=e.findIndex(e=>e.stockId===a);if(t>=0){const a=e[t],c=a.quantity+n,r=(a.averagePrice*a.quantity+i.price*n)/c;return[...e.slice(0,t),(0,s.A)((0,s.A)({},a),{},{quantity:c,averagePrice:r,lastBuyTime:new Date}),...e.slice(t+1)]}return[...e,{id:"temp_".concat(Date.now()),stockId:a,stockName:i.name,quantity:n,averagePrice:i.price,classCode:z,lastBuyTime:new Date}]}),ee(e=>(0,s.A)((0,s.A)({},e),{},{[a]:""})),(0,m.Mx)(r.db,{classCode:z,userId:e.uid,userName:(null===t||void 0===t?void 0:t.name)||e.displayName||"\uc0ac\uc6a9\uc790",type:m.gI.STOCK_BUY,description:"".concat(i.name," ").concat(n,"\uc8fc \ub9e4\uc218 (").concat(j(p),")"),amount:-p,metadata:{stockId:a,stockName:i.name,quantity:n,pricePerShare:i.price,commission:l,taxAmount:h,totalCost:p}}),alert("".concat(i.name," ").concat(n,"\uc8fc \ub9e4\uc218 \uc644\ub8cc!\n\uc218\uc218\ub8cc: ").concat(j(l)))}catch(x){u.vF.error("[buyStock] \ub9e4\uc218 \uc2e4\ud328:",x),_&&_({cash:p}),alert(x.message||"\ub9e4\uc218 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{ce(!1)}},[Y,e,null===t||void 0===t?void 0:t.cash,null===t||void 0===t?void 0:t.name,se,z,he,q,_]),Be=(0,c.useCallback)(async(a,c)=>{if(!he)return alert("\uc8fc\uc2dd\uc2dc\uc7a5\uc774 \ub9c8\uac10\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc6b4\uc601 \uc2dc\uac04: \uc6d4-\uae08 \uc624\uc804 8\uc2dc-\uc624\ud6c4 3\uc2dc");if(se)return;const n=parseInt(c,10);if(isNaN(n)||n<=0)return alert("\uc720\ud6a8\ud55c \uc218\ub7c9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");const i=W.find(e=>e.id===a);if(!e||!t||!i||n>i.quantity)return alert("\ub9e4\ub3c4\ud560 \uc218 \uc5c6\ub294 \uc0c1\ud0dc\uc785\ub2c8\ub2e4.");if(i.delistedAt)return alert("\uc0c1\uc7a5\ud3d0\uc9c0\ub41c \uc0c1\ud488\uc740 \ub9e4\ub3c4\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!(e=>{var t;if(!e.lastBuyTime)return!0;let a;if(e.lastBuyTime instanceof Date)a=e.lastBuyTime.getTime();else if(null!==(t=e.lastBuyTime)&&void 0!==t&&t.toDate)a=e.lastBuyTime.toDate().getTime();else if("number"===typeof e.lastBuyTime)a=e.lastBuyTime;else{if("string"!==typeof e.lastBuyTime)return!0;a=new Date(e.lastBuyTime).getTime()}return Date.now()-a>=y})(i)){const e=T(i);return alert("\ub9e4\uc218 \ud6c4 1\uc2dc\uac04 \ub3d9\uc548\uc740 \ub9e4\ub3c4\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.\n\ub0a8\uc740 \uc2dc\uac04: ".concat(S(e)))}const o=Y.find(e=>e.id===i.stockId);if(!o||!o.isListed)return alert("\ud604\uc7ac \uac70\ub798\ud560 \uc218 \uc5c6\ub294 \uc0c1\ud488\uc785\ub2c8\ub2e4.");const l=o.price*n,h=Math.round(l*v),p=(o.price-i.averagePrice)*n,x=l-h-((p>0?Math.floor(.22*p):0)+Math.floor(.01*l));u.vF.log("[sellStock] \ub9e4\ub3c4 \uc2dc\uc791:",{holdingId:a,stockName:o.name,quantity:n,estimatedNetRevenue:x}),_&&_({cash:x}),ce(!0);try{const c=U.sellStock,i=await c({holdingId:a,quantity:n});if(u.vF.log("[sellStock] \ub9e4\ub3c4 \uc131\uacf5:",i.data),void 0!==i.data.newBalance&&_){const e=(null===t||void 0===t?void 0:t.cash)||0,a=i.data.newBalance-e;_({cash:a}),u.vF.log("[sellStock] \ud604\uae08 \uc815\ud655\ud55c \uac12\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8:",i.data.newBalance)}const o=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});d.Eb.invalidate(o),E("PORTFOLIO_user_".concat(e.uid)),F(),X(e=>{const t=e.findIndex(e=>e.id===a);if(t>=0){const a=e[t],c=a.quantity-n;return c<=0?[...e.slice(0,t),...e.slice(t+1)]:[...e.slice(0,t),(0,s.A)((0,s.A)({},a),{},{quantity:c}),...e.slice(t+1)]}return e}),ae(e=>(0,s.A)((0,s.A)({},e),{},{[a]:""}));const{stockName:l,sellPrice:h,commission:p,totalTax:x,profit:b,netRevenue:y}=i.data;(0,m.Mx)(r.db,{classCode:z,userId:e.uid,userName:(null===t||void 0===t?void 0:t.name)||e.displayName||"\uc0ac\uc6a9\uc790",type:m.gI.STOCK_SELL,description:"".concat(l," ").concat(n,"\uc8fc \ub9e4\ub3c4 (\uc21c\uc218\uc775: ").concat(j(y),")"),amount:y,metadata:{holdingId:a,stockName:l,quantity:n,sellPrice:h,commission:p,tax:x,profit:b,netRevenue:y}});const v=x>0?"\n\uc138\uae08: ".concat(j(x)):"";alert("".concat(l," ").concat(n,"\uc8fc \ub9e4\ub3c4 \uc644\ub8cc!\n\uc218\uc775: ").concat(j(b)).concat(v,"\n\uc218\uc218\ub8cc: ").concat(j(p),"\n\uc21c\uc218\uc775: ").concat(j(y)))}catch(b){u.vF.error("[sellStock] \ub9e4\ub3c4 \uc2e4\ud328:",b),_&&_({cash:-x}),alert(b.message||"\ub9e4\ub3c4 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{ce(!1)}},[Y,W,e,t,se,z,he,U,_]),De=(0,c.useCallback)(async t=>{if(e&&z&&window.confirm("\uc774 \uc0c1\ud488(\ud734\uc9c0\uc870\uac01)\uc744 \ud3ec\ud2b8\ud3f4\ub9ac\uc624\uc5d0\uc11c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))try{await(0,l.kd)((0,l.H9)(r.db,"users",e.uid,"portfolio",t));const a=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});d.Eb.invalidate(a),E("PORTFOLIO_user_".concat(e.uid)),await Te(!0),alert("\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(a){alert("\uc0ad\uc81c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},[e,z,Te]),Pe=(0,c.useCallback)(async()=>{if(!z||!e)throw new Error("Firebase Functions\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");try{u.vF.log("[manualUpdateStockMarket] \uc218\ub3d9 \uc5c5\ub370\uc774\ud2b8 \uc2dc\uc791");const t=U.manualUpdateStockMarket,a=await t({});u.vF.log("[manualUpdateStockMarket] \uc5c5\ub370\uc774\ud2b8 \uc131\uacf5:",a.data);const s=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});return d.Eb.invalidate(s),E("STOCKS_".concat(z)),await Te(!0),a.data}catch(t){throw u.vF.error("[manualUpdateStockMarket] \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328:",t),t}},[U,z,e,Te]),Oe=(0,c.useCallback)(async()=>{if(!z||!e)throw new Error("Firebase Functions\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");try{u.vF.log("[createRealStocks] \uc2e4\uc81c \uc8fc\uc2dd \uc0dd\uc131 \uc2dc\uc791");const t=U.createRealStocks,a=await t({});u.vF.log("[createRealStocks] \uc0dd\uc131 \uc131\uacf5:",a.data);const s=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});return d.Eb.invalidate(s),E("STOCKS_".concat(z)),await Te(!0),a.data}catch(t){throw u.vF.error("[createRealStocks] \uc0dd\uc131 \uc2e4\ud328:",t),t}},[U,z,e,Te]),Ke=(0,c.useCallback)(async()=>{if(!z||!e)throw new Error("Firebase Functions\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");try{u.vF.log("[updateRealStocks] \uc2e4\uc81c \uc8fc\uc2dd \uc5c5\ub370\uc774\ud2b8 \uc2dc\uc791");const t=U.updateRealStocks,a=await t({});u.vF.log("[updateRealStocks] \uc5c5\ub370\uc774\ud2b8 \uc131\uacf5:",a.data);const s=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});return d.Eb.invalidate(s),E("STOCKS_".concat(z)),await Te(!0),a.data}catch(t){throw u.vF.error("[updateRealStocks] \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328:",t),t}},[U,z,e,Te]),He=(0,c.useCallback)(async t=>{let{name:a,symbol:s,sector:c,productType:n}=t;if(!z||!e)throw new Error("Firebase Functions\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");try{u.vF.log("[addSingleRealStock] \uac1c\ubcc4 \uc2e4\uc81c \uc8fc\uc2dd \ucd94\uac00 \uc2dc\uc791:",a);const t=U.addSingleRealStock,r=await t({name:a,symbol:s,sector:c,productType:n});u.vF.log("[addSingleRealStock] \ucd94\uac00 \uc131\uacf5:",r.data);const i=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});return d.Eb.invalidate(i),E("STOCKS_".concat(z)),await Te(!0),r.data}catch(r){throw u.vF.error("[addSingleRealStock] \ucd94\uac00 \uc2e4\ud328:",r),r}},[U,z,e,Te]),qe=(0,c.useCallback)(async()=>{if(!z||!e)throw new Error("Firebase Functions\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");try{u.vF.log("[deleteSimulationStocks] \uc2dc\ubbac\ub808\uc774\uc158 \uc8fc\uc2dd \uc0ad\uc81c \uc2dc\uc791");const t=U.deleteSimulationStocks,a=await t({});u.vF.log("[deleteSimulationStocks] \uc0ad\uc81c \uc131\uacf5:",a.data);const s=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});return d.Eb.invalidate(s),E("STOCKS_".concat(z)),await Te(!0),a.data}catch(t){throw u.vF.error("[deleteSimulationStocks] \uc0ad\uc81c \uc2e4\ud328:",t),t}},[U,z,e,Te]),_e=(0,c.useMemo)(()=>{const e=new Map;return Y.forEach(t=>e.set(t.id,t)),e},[Y]),Ve=(0,c.useMemo)(()=>{let e=0,t=0;W.forEach(a=>{const s=a.averagePrice*a.quantity;if(t+=s,!a.delistedAt){const t=_e.get(a.stockId);t&&t.isListed&&(e+=t.price*a.quantity)}});const a=e-t;return{totalValue:e,totalInvested:t,totalProfit:a,profitPercent:t>0?a/t*100:0}},[W,_e]),Ue=(0,c.useMemo)(()=>{const e={stocks:0,etfs:0,bonds:0};return Y.forEach(t=>{t.isListed&&(t.productType===p?e.etfs++:t.productType===x?e.bonds++:e.stocks++)}),e},[Y]),ze=(0,c.useMemo)(()=>Y.filter(e=>!!e.isListed&&("stocks"===ie?e.productType===h||!e.productType:"etfs"===ie?e.productType===p:"bonds"===ie&&e.productType===x)),[Y,ie]),[Qe,Ye]=(0,c.useState)(!1),Ge=(0,c.useMemo)(()=>Qe?ze:ze.slice(0,20),[ze,Qe]),We=(0,c.useCallback)(()=>{if(!z||!e)return;const t=d.Eb.generateKey("BATCH",{classCode:z,userId:e.uid});d.Eb.invalidate(t),Te(!0)},[Te,z,e]);return O||!H?(0,R.jsx)("div",{className:"loading-message",children:"\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911\uc785\ub2c8\ub2e4..."}):e&&t?a()||z&&"\ubbf8\uc9c0\uc815"!==z?z||O?Z&&a()?(0,R.jsx)(K,{stocks:Y,classCode:z,onClose:()=>J(!1),onAddStock:Fe,onDeleteStock:Re,onEditStock:Me,onToggleManualStock:Ie,cacheStats:ge,onManualUpdate:Pe,onCreateRealStocks:Oe,onUpdateRealStocks:Ke,onAddSingleRealStock:He,onDeleteSimulationStocks:qe}):(0,R.jsxs)("div",{className:"stock-exchange-container",children:[(0,R.jsx)("header",{className:"stock-header",children:(0,R.jsxs)("div",{className:"stock-header-content",children:[(0,R.jsxs)("div",{className:"logo-title",children:[(0,R.jsx)(D,{size:32,color:"white"}),(0,R.jsxs)("h1",{children:["\ud22c\uc790 \uac70\ub798\uc18c (",z,")"]})]}),(0,R.jsx)("div",{className:"market-status ".concat(he?"open":"closed"),children:he?"\u25cf \uac1c\uc7a5":"\u25cb \ub9c8\uac10"}),(0,R.jsxs)("div",{className:"stock-header-actions",children:[(0,R.jsx)("div",{className:"user-info-display",children:j(t.cash)}),a()&&(0,R.jsxs)("button",{onClick:()=>J(!0),className:"btn btn-primary",children:[(0,R.jsx)(L,{size:16})," \uad00\ub9ac"]}),(null===t||void 0===t?void 0:t.isSuperAdmin)&&(0,R.jsx)("button",{onClick:Ae,disabled:ye,className:"btn ml-2 ".concat(xe?"btn-warning":"btn-secondary"),title:xe?"\ubc29\ud559 \ubaa8\ub4dc ON - \uc2a4\ucf00\uc904\ub7ec \uc911\uc9c0\ub428":"\ubc29\ud559 \ubaa8\ub4dc OFF - \uc2a4\ucf00\uc904\ub7ec \uc791\ub3d9 \uc911",children:ye?"...":xe?"\ud83c\udfd6\ufe0f \ubc29\ud559\ubaa8\ub4dc ON":"\ud83d\udcc5 \ubc29\ud559\ubaa8\ub4dc OFF"})]})]})}),(0,R.jsxs)("main",{className:"market-section",children:[(0,R.jsxs)("section",{className:"asset-summary",children:[(0,R.jsxs)("div",{className:"asset-cards",children:[(0,R.jsx)("div",{className:"asset-card",children:(0,R.jsxs)("div",{className:"asset-card-content",children:[(0,R.jsxs)("div",{className:"asset-card-info",children:[(0,R.jsx)("h3",{children:"\ud22c\uc790 \ud3c9\uac00\uc561"}),(0,R.jsx)("p",{className:"value",children:j(Ve.totalValue)})]}),(0,R.jsx)("div",{className:"asset-card-icon blue",children:"\ud83d\udcca"})]})}),(0,R.jsx)("div",{className:"asset-card",children:(0,R.jsxs)("div",{className:"asset-card-content",children:[(0,R.jsxs)("div",{className:"asset-card-info",children:[(0,R.jsx)("h3",{children:"\ucd1d \uc790\uc0b0"}),(0,R.jsx)("p",{className:"value",children:j(t.cash+Ve.totalValue)})]}),(0,R.jsx)("div",{className:"asset-card-icon purple",children:"\ud83d\udc8e"})]})}),(0,R.jsx)("div",{className:"asset-card",children:(0,R.jsxs)("div",{className:"asset-card-content",children:[(0,R.jsxs)("div",{className:"asset-card-info",children:[(0,R.jsx)("h3",{children:"\ud3c9\uac00\uc190\uc775"}),(0,R.jsx)("p",{className:"value ".concat(Ve.totalProfit>=0?"profit-positive":"profit-negative"),children:j(Ve.totalProfit)})]}),(0,R.jsx)("div",{className:"asset-card-icon ".concat(Ve.totalProfit>=0?"red":"blue"),children:Ve.totalProfit>=0?(0,R.jsx)(M,{size:24,color:"white"}):(0,R.jsx)(I,{size:24,color:"white"})})]})}),(0,R.jsx)("div",{className:"asset-card",children:(0,R.jsxs)("div",{className:"asset-card-content",children:[(0,R.jsxs)("div",{className:"asset-card-info",children:[(0,R.jsx)("h3",{children:"\uc218\uc775\ub960"}),(0,R.jsx)("p",{className:"value ".concat(Ve.profitPercent>=0?"profit-positive":"profit-negative"),children:N(Ve.profitPercent)})]}),(0,R.jsx)("div",{className:"asset-card-icon ".concat(Ve.profitPercent>=0?"red":"blue"),children:Ve.profitPercent>=0?(0,R.jsx)(M,{size:24,color:"white"}):(0,R.jsx)(I,{size:24,color:"white"})})]})})]}),a()&&(0,R.jsxs)("div",{className:"mt-2.5 px-3 py-2 bg-sky-50 rounded-md text-[0.8rem] text-sky-700 flex justify-between items-center",children:[(0,R.jsxs)("div",{children:["\ud83d\ude80 \uc131\ub2a5 \ucd5c\uc801\ud654 \uc0c1\ud0dc: \uce90\uc2dc \uc801\uc911 ",ge.hits,"\ud68c, \ub204\ub77d ",ge.misses,"\ud68c (\uc808\uc57d\ub960: ",ge.hits+ge.misses>0?Math.round(ge.hits/(ge.hits+ge.misses)*100):0,"%)"]}),ke&&(0,R.jsxs)("div",{children:["\ub9c8\uc9c0\ub9c9 \ubc30\uce58\ub85c\ub4dc: ",ke.toLocaleTimeString()]})]})]}),(0,R.jsxs)("section",{className:"market-list-section",children:[(0,R.jsxs)("div",{className:"section-header",children:[(0,R.jsx)("h2",{className:"section-title",children:"\ud83d\udcc8 \ud22c\uc790 \uc2dc\uc7a5"}),(0,R.jsxs)("div",{className:"update-indicator",children:[(0,R.jsxs)("button",{onClick:We,disabled:me,className:"btn btn-secondary px-2 py-1 text-xs",children:[(0,R.jsx)(B,{size:12}),me?"\uac31\uc2e0\uc911...":"\uc0c8\ub85c\uace0\uce68"]}),le&&(0,R.jsxs)("span",{className:"text-xs text-gray-500",children:["\ub9c8\uc9c0\ub9c9 \uac31\uc2e0: ",le.toLocaleTimeString()]})]})]}),(0,R.jsxs)("div",{className:"market-tabs",children:[(0,R.jsxs)("button",{onClick:()=>oe("stocks"),className:"tab-button ".concat("stocks"===ie?"active":""),children:["\uc8fc\uc2dd (",Ue.stocks,")"]}),(0,R.jsxs)("button",{onClick:()=>oe("etfs"),className:"tab-button ".concat("etfs"===ie?"active":""),children:["ETF/\uc9c0\uc218 (",Ue.etfs,")"]}),(0,R.jsxs)("button",{onClick:()=>oe("bonds"),className:"tab-button ".concat("bonds"===ie?"active":""),children:["\ucc44\uad8c (",Ue.bonds,")"]})]}),(0,R.jsx)("div",{className:"market-grid",children:Ge.map(e=>{var t;const a=e.priceHistory||[e.price],c=a.length>=2?(a.slice(-1)[0]-a.slice(-2)[0])/a.slice(-2)[0]*100:0,n=!0===e.isRealStock;return(0,R.jsxs)("div",{className:"stock-card ".concat(c>0?"price-up":c<0?"price-down":""," ").concat(n?"real-stock":""),children:[(0,R.jsxs)("div",{className:"stock-card-header",children:[(0,R.jsxs)("div",{className:"stock-info",children:[(0,R.jsxs)("h3",{children:[C(e.productType)," ",e.name]}),(0,R.jsxs)("div",{className:"stock-badges",children:[n&&(0,R.jsx)("span",{className:"stock-badge real bg-gradient-to-br from-emerald-500 to-emerald-600 text-white font-bold text-[0.7rem] px-1.5 py-0.5 rounded mr-1",children:"\uc2e4\uc2dc\uac04"}),(0,R.jsx)("span",{className:"stock-badge ".concat(A(e.productType)),children:e.productType===x?"".concat(e.maturityYears,"\ub144 ").concat(e.couponRate,"%"):(null===(t=b[e.sector])||void 0===t?void 0:t.name)||"\uae30\ud0c0"})]})]}),(0,R.jsxs)("div",{className:"stock-price-section",children:[(0,R.jsx)("div",{className:"stock-price",children:j(e.price)}),(0,R.jsx)("div",{className:"stock-change ".concat(c>0?"up":"down"),children:(0,R.jsx)("span",{children:N(c)})}),n&&(0,R.jsx)("div",{className:"text-[0.7rem] text-gray-500 mt-0.5",children:k(e)||"\uc7a5\ub9c8\uac10"})]})]}),(0,R.jsxs)("div",{className:"stock-actions",children:[(0,R.jsx)("input",{type:"number",min:"1",value:$[e.id]||"",onChange:t=>ee(a=>(0,s.A)((0,s.A)({},a),{},{[e.id]:t.target.value})),placeholder:"\uc218\ub7c9",className:"quantity-input"}),(0,R.jsx)("button",{onClick:()=>Le(e.id,$[e.id]),disabled:!$[e.id]||se||!he,className:"trade-button buy",children:"\ub9e4\uc218"})]}),(0,R.jsx)("div",{className:"cost-display",children:$[e.id]&&"\uc608\uc0c1 \ube44\uc6a9: ".concat(j(e.price*parseInt($[e.id])*1.003))})]},e.id)})}),ze.length>20&&(0,R.jsx)("div",{className:"load-more-container",children:(0,R.jsx)("button",{onClick:()=>Ye(!Qe),className:"load-more-button",children:Qe?"\uc811\uae30":"\ub354 \ubcf4\uae30"})})]}),(0,R.jsxs)("section",{className:"portfolio-section",children:[(0,R.jsx)("div",{className:"section-header",children:(0,R.jsx)("h2",{className:"section-title",children:"\ud83d\udcbc \ub0b4 \ud3ec\ud2b8\ud3f4\ub9ac\uc624"})}),(0,R.jsx)("div",{className:"portfolio-cards",children:0===W.length?(0,R.jsx)("p",{className:"no-transactions",children:"\ubcf4\uc720\ud55c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):W.map(e=>{const t=_e.get(e.stockId);if(e.isWorthless)return(0,R.jsxs)("div",{className:"portfolio-card delisted",children:[(0,R.jsxs)("div",{className:"portfolio-card-header",children:[(0,R.jsxs)("div",{className:"stock-title-section",children:[(0,R.jsx)("h3",{className:"stock-name",children:e.stockName}),(0,R.jsx)("span",{className:"stock-status delisted",children:"\ud83d\uddd1\ufe0f \ud734\uc9c0\uc870\uac01"})]}),(0,R.jsxs)("div",{className:"stock-quantity",children:[e.quantity,(0,R.jsx)("span",{className:"unit",children:"\uc8fc"})]})]}),(0,R.jsx)("div",{className:"portfolio-metrics-compact",children:(0,R.jsxs)("div",{className:"metrics-row",children:[(0,R.jsxs)("div",{className:"metric-item",children:[(0,R.jsx)("span",{className:"metric-label",children:"\ud604\uc7ac \uac00\uce58"}),(0,R.jsx)("span",{className:"metric-value text-red-500 font-bold",children:"0\uc6d0"})]}),(0,R.jsxs)("div",{className:"metric-item",children:[(0,R.jsx)("span",{className:"metric-label",children:"\uc190\uc2e4"}),(0,R.jsx)("span",{className:"metric-value text-red-500",children:"-100%"})]})]})}),(0,R.jsx)("p",{className:"text-[0.85rem] text-gray-500 mt-2",children:"\uc0c1\uc7a5\ud3d0\uc9c0\ub41c \uc0c1\ud488\uc785\ub2c8\ub2e4. 10\ubd84 \ud6c4 \uc790\ub3d9 \uc0ad\uc81c\ub429\ub2c8\ub2e4."}),(0,R.jsx)("div",{className:"portfolio-card-actions",children:(0,R.jsx)("button",{onClick:()=>De(e.id),className:"action-btn delete-btn",children:"\uc9c0\uae08 \uc0ad\uc81c"})})]},e.id);if(!t)return null;const a=t.price*e.quantity,c=e.averagePrice*e.quantity,n=a-c,r=c>0?n/c*100:0,i=!!ne[e.id];return(0,R.jsxs)("div",{className:"portfolio-card ".concat(n>=0?"profit":"loss"),children:[(0,R.jsxs)("div",{className:"portfolio-card-header",children:[(0,R.jsxs)("div",{className:"stock-title-section",children:[(0,R.jsxs)("h3",{className:"stock-name",children:[C(t.productType)," ",e.stockName]}),i&&(0,R.jsxs)("span",{className:"text-xs px-2 py-0.5 bg-amber-100 text-amber-800 rounded font-bold inline-flex items-center gap-1",children:[(0,R.jsx)(P,{size:12}),"\ub9e4\ub3c4 \ubd88\uac00"]})]}),(0,R.jsxs)("div",{className:"stock-quantity",children:[e.quantity,(0,R.jsx)("span",{className:"unit",children:"\uc8fc"})]})]}),(0,R.jsx)("div",{className:"portfolio-metrics-compact",children:(0,R.jsxs)("div",{className:"metrics-row",children:[(0,R.jsxs)("div",{className:"metric-item",children:[(0,R.jsx)("span",{className:"metric-label",children:"\ud3c9\uade0 \ub9e4\uc218\uac00"}),(0,R.jsx)("span",{className:"metric-value",children:j(e.averagePrice)})]}),(0,R.jsxs)("div",{className:"metric-item",children:[(0,R.jsx)("span",{className:"metric-label",children:"\ud604\uc7ac\uac00"}),(0,R.jsx)("span",{className:"metric-value current",children:j(t.price)})]})]})}),(0,R.jsxs)("div",{className:"profit-summary ".concat(n>=0?"profit":"loss"),children:[(0,R.jsx)("div",{className:"profit-amount",children:j(n)}),(0,R.jsx)("div",{className:"profit-percent",children:N(r)})]}),i&&(0,R.jsxs)("div",{className:"px-3 py-2.5 bg-gradient-to-br from-amber-100 to-amber-200 rounded-lg flex flex-col gap-1 mt-2 border border-amber-400",children:[(0,R.jsxs)("div",{className:"flex items-center gap-2 text-[0.9rem] text-amber-800 font-bold",children:[(0,R.jsx)(P,{size:16}),(0,R.jsx)("span",{children:"\ub9e4\ub3c4 \uc81c\ud55c \uc2dc\uac04"})]}),(0,R.jsxs)("div",{className:"text-[1.1rem] text-amber-900 font-bold text-center mt-1 font-mono",children:["\u23f1\ufe0f ",S(ne[e.id])," \ub0a8\uc74c"]})]}),(0,R.jsx)("div",{className:"portfolio-card-actions",children:(0,R.jsxs)("div",{className:"trade-section",children:[(0,R.jsxs)("div",{className:"trade-input-group",children:[(0,R.jsx)("input",{type:"number",min:"1",max:e.quantity,value:te[e.id]||"",onChange:t=>ae(a=>(0,s.A)((0,s.A)({},a),{},{[e.id]:t.target.value})),placeholder:"\ub9e4\ub3c4 \uc218\ub7c9",className:"trade-input",disabled:!!ne[e.id]||!he}),(0,R.jsx)("button",{onClick:()=>Be(e.id,te[e.id]),disabled:!te[e.id]||se||!!ne[e.id]||!he,className:"action-btn sell-btn",children:"\ub9e4\ub3c4"})]}),te[e.id]&&!ne[e.id]&&(0,R.jsxs)("div",{className:"expected-amount",children:["\uc608\uc0c1 \uc218\uc775: ",j(t.price*parseInt(te[e.id])*.997-w(Math.max(0,(t.price-e.averagePrice)*parseInt(te[e.id])),t.productType))]})]})})]},e.id)})})]})]})]}):(0,R.jsx)("div",{className:"loading-message",children:"\ucc38\uc5ec \uc911\uc778 \ud074\ub798\uc2a4 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."}):(0,R.jsxs)("div",{className:"stock-exchange-container",children:[(0,R.jsx)("header",{className:"stock-header",children:(0,R.jsx)("div",{className:"stock-header-content",children:(0,R.jsxs)("div",{className:"logo-title",children:[(0,R.jsx)(D,{size:32,color:"white"}),(0,R.jsx)("h1",{children:"\ud22c\uc790 \uac70\ub798\uc18c"})]})})}),(0,R.jsx)("main",{className:"market-section flex justify-center items-center",children:(0,R.jsxs)("div",{className:"text-center p-5 bg-white rounded-lg shadow-[0_2px_10px_rgba(0,0,0,0.1)]",children:[(0,R.jsx)("h2",{children:"\ud559\uae09 \ubbf8\ubc30\uc815 \uc548\ub0b4"}),(0,R.jsx)("p",{className:"mt-2.5 text-base text-gray-700",children:"\uc18c\uc18d\ub41c \ud559\uae09\uc774 \uc5c6\uc5b4 \uc8fc\uc2dd \uc2dc\uc7a5\uc744 \uc774\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,R.jsx)("p",{className:"mt-1 text-[0.9rem] text-gray-500",children:"\ub2f4\ub2f9 \uc120\uc0dd\ub2d8\uaed8 \ubb38\uc758\ud558\uc5ec \ud559\uae09\uc5d0 \ub4f1\ub85d\ud574\uc8fc\uc138\uc694."})]})})]}):(0,R.jsx)("div",{className:"loading-message",children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})}}}]);
//# sourceMappingURL=398.5cb745b2.chunk.js.map