{"version":3,"file":"static/js/259.39e35b52.chunk.js","mappings":"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","sources":["pages/banking/MoneyTransfer.js"],"sourcesContent":["// src/MoneyTransfer.js - ì„œë²„ ì‘ë‹µ ê¸°ë°˜ ìƒíƒœ ì—…ë°ì´íŠ¸ ìˆ˜ì • ë²„ì „\r\n\r\nimport React, { useState, useEffect, useMemo } from \"react\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\nimport { adminCashAction } from \"../../database\";\r\nimport \"./MoneyTransfer.css\";\r\nimport { formatKoreanCurrency } from '../../numberFormatter';\r\n\r\nfunction MoneyTransfer() {\r\n  // AuthContextì—ì„œ í•„ìš”í•œ ë°ì´í„°ì™€ í•¨ìˆ˜ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.\r\n  const { \r\n    userDoc, \r\n    allClassMembers, \r\n    loading: authLoading,\r\n    setUserDoc,\r\n    setAllClassMembers\r\n  } = useAuth();\r\n\r\n  // ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ ìƒíƒœ ê´€ë¦¬\r\n  const [selectedUsers, setSelectedUsers] = useState([]);\r\n  const [amount, setAmount] = useState(\"\");\r\n  const [amountType, setAmountType] = useState(\"fixed\");\r\n  const [action, setAction] = useState(\"send\");\r\n  const [takeMode, setTakeMode] = useState(\"toMe\"); // \"toMe\" ë˜ëŠ” \"remove\"\r\n  const [taxRate, setTaxRate] = useState(10);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [selectAll, setSelectAll] = useState(false);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n  // ê´€ë¦¬ì ì •ë³´ ì¶”ì¶œ\r\n  const adminName = userDoc?.name;\r\n  const adminClassCode = userDoc?.classCode;\r\n\r\n  // ì „ì²´ ì‚¬ìš©ì ëª©ë¡ì„ ê°€ë‚˜ë‹¤ìˆœìœ¼ë¡œ ì •ë ¬\r\n  const users = useMemo(() => {\r\n    if (!allClassMembers || allClassMembers.length === 0) return [];\r\n    return [...allClassMembers].sort((a, b) => {\r\n      const nameA = a.name || a.nickname || \"\";\r\n      const nameB = b.name || b.nickname || \"\";\r\n      return nameA.localeCompare(nameB, \"ko\");\r\n    });\r\n  }, [allClassMembers]);\r\n\r\n  // ì•¡ì…˜ íƒ€ì…ì´ ë³€ê²½ë˜ë©´ ì„ íƒ ì´ˆê¸°í™”\r\n  useEffect(() => {\r\n    setSelectedUsers([]);\r\n    setSelectAll(false);\r\n  }, [action, amountType]);\r\n\r\n  // ì‚¬ìš©ì ì„ íƒ í•¸ë“¤ëŸ¬\r\n  const handleUserSelection = (userId) => {\r\n    setSelectedUsers((prevSelected) =>\r\n      prevSelected.includes(userId)\r\n        ? prevSelected.filter((id) => id !== userId)\r\n        : [...prevSelected, userId]\r\n    );\r\n  };\r\n\r\n  // ì „ì²´ ì„ íƒ í•¸ë“¤ëŸ¬\r\n  const handleSelectAll = () => {\r\n    setSelectAll(prev => {\r\n      const newSelectAll = !prev;\r\n      setSelectedUsers(newSelectAll ? users.map((user) => user.id) : []);\r\n      return newSelectAll;\r\n    });\r\n  };\r\n  \r\n  // ë¯¸ë¦¬ë³´ê¸° ê¸ˆì•¡ ê³„ì‚° í•¨ìˆ˜\r\n  const calculatePreviewAmount = (userCash, inputValue, applyTax = false) => {\r\n    let baseAmount;\r\n    if (amountType === \"percentage\") {\r\n      baseAmount = Math.floor((userCash * Number(inputValue)) / 100);\r\n    } else {\r\n      baseAmount = Number(inputValue);\r\n    }\r\n    \r\n    if (applyTax && action === \"send\") {\r\n      const taxAmount = Math.floor((baseAmount * taxRate) / 100);\r\n      return baseAmount - taxAmount;\r\n    }\r\n    \r\n    return baseAmount;\r\n  };\r\n\r\n  // í¼ ì œì¶œ (ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸° ì‹¤í–‰) í•¸ë“¤ëŸ¬\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (selectedUsers.length === 0 || !amount || isNaN(Number(amount))) {\r\n      setError(\"ì‚¬ìš©ìë¥¼ ì„ íƒí•˜ê³  ìœ íš¨í•œ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”.\");\r\n      return;\r\n    }\r\n\r\n    const inputValue = Number(amount);\r\n    if (inputValue <= 0) {\r\n      setError(`${amountType === 'percentage' ? 'í¼ì„¼íŠ¸' : 'ê¸ˆì•¡'}ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.`);\r\n      return;\r\n    }\r\n    if (amountType === 'percentage' && (inputValue > 100 || inputValue < 0)) {\r\n      setError(\"í¼ì„¼íŠ¸ëŠ” 0ê³¼ 100 ì‚¬ì´ì˜ ê°’ì´ì–´ì•¼ í•©ë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    setMessage(\"\");\r\n    setError(\"\");\r\n\r\n    try {\r\n      const targetUsersData = users.filter(user => selectedUsers.includes(user.id));\r\n      \r\n      // âœ¨ DB ì‘ì—… ì‹¤í–‰í•˜ê³  ì„œë²„ë¡œë¶€í„° ì‹¤ì œ ê²°ê³¼ ë°›ê¸°\r\n      const { count, totalProcessed, updatedUsers } = await adminCashAction({\r\n        adminName,\r\n        adminClassCode,\r\n        targetUsers: targetUsersData,\r\n        action,\r\n        takeMode: action === \"take\" ? takeMode : undefined, // ê°€ì ¸ì˜¤ê¸° ëª¨ë“œ ì „ë‹¬\r\n        amountType,\r\n        amount: inputValue,\r\n        taxRate,\r\n      });\r\n\r\n      // âœ¨ ì„œë²„ì—ì„œ ë°›ì€ 'ì§„ì§œ' ë°ì´í„°ë¡œ ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\r\n      if (updatedUsers && updatedUsers.length > 0) {\r\n        // 1. ëŒ€ìƒ ì‚¬ìš©ìë“¤ì˜ ì”ì•¡ ì—…ë°ì´íŠ¸\r\n        setAllClassMembers(currentMembers =>\r\n          currentMembers.map(member => {\r\n            const updatedInfo = updatedUsers.find(u => u.id === member.id);\r\n            return updatedInfo ? { ...member, cash: updatedInfo.newCash } : member;\r\n          })\r\n        );\r\n\r\n        // 2. ê´€ë¦¬ì ë³¸ì¸ì˜ ì”ì•¡ ì—…ë°ì´íŠ¸\r\n        setUserDoc(currentAdminDoc => {\r\n          const currentAdminCash = Number(currentAdminDoc.cash || 0);\r\n          let newAdminCash;\r\n          if (action === \"send\") {\r\n            // ë³´ëƒˆì„ ë•ŒëŠ” ì²˜ë¦¬ëœ ì´ì•¡ë§Œí¼ ì°¨ê° (ì„¸ê¸ˆ í¬í•¨ëœ ê¸ˆì•¡ì´ totalProcessed)\r\n            newAdminCash = currentAdminCash - totalProcessed;\r\n          } else if (action === \"take\" && takeMode === \"toMe\") {\r\n            // ë‚˜ì—ê²Œ ê°€ì ¸ì˜¬ ë•ŒëŠ” ì²˜ë¦¬ëœ ì´ì•¡ë§Œí¼ ì¦ê°€\r\n            newAdminCash = currentAdminCash + totalProcessed;\r\n          } else {\r\n            // ëˆ ì—†ì• ê¸° ëª¨ë“œëŠ” ê´€ë¦¬ì ì”ì•¡ ë³€í™” ì—†ìŒ\r\n            newAdminCash = currentAdminCash;\r\n          }\r\n          return { ...currentAdminDoc, cash: newAdminCash };\r\n        });\r\n      }\r\n\r\n      // ì„±ê³µ ë©”ì‹œì§€ ì„¤ì •\r\n      const actionText = action === \"send\" ? \"ë³´ë‚´ê¸°\" : (takeMode === \"toMe\" ? \"ê°€ì ¸ì˜¤ê¸°\" : \"ì—†ì• ê¸°\");\r\n      setMessage(\r\n        `${count}ëª…ì—ê²Œ ${amountType === 'percentage' ? `${inputValue}%` : `${inputValue.toLocaleString()}ì›`} ${actionText} ì™„ë£Œ! (ì´ ${totalProcessed.toLocaleString()}ì› ì²˜ë¦¬${action === 'send' && taxRate > 0 ? `, ì„¸ê¸ˆ ${taxRate}% ì ìš©` : ''})`\r\n      );\r\n      \r\n      setAmount(\"\");\r\n      setSelectedUsers([]);\r\n      setSelectAll(false);\r\n\r\n      setTimeout(() => setMessage(\"\"), 3000);\r\n\r\n    } catch (err) {\r\n      console.error(\"ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:\", err);\r\n      setError(`ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${err.message}`);\r\n      // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ëŠ” ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒì´ ê°€ì¥ ì •í™•í•˜ì§€ë§Œ,\r\n      // Firestore ì‚¬ìš© ìµœì†Œí™”ë¥¼ ìœ„í•´ ì—¬ê¸°ì„œëŠ” ì—ëŸ¬ ë©”ì‹œì§€ë§Œ í‘œì‹œí•©ë‹ˆë‹¤.\r\n      setTimeout(() => setError(\"\"), 5000);\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n  \r\n  const previewAmounts = useMemo(() => {\r\n    if (!amount || selectedUsers.length === 0) return {};\r\n    const preview = {};\r\n    selectedUsers.forEach(userId => {\r\n      const user = users.find(u => u.id === userId);\r\n      if (user) {\r\n        const userCash = Number(user.cash || 0);\r\n        const applyTax = action === 'send';\r\n        preview[userId] = calculatePreviewAmount(userCash, amount, applyTax);\r\n      }\r\n    });\r\n    return preview;\r\n  }, [selectedUsers, amount, amountType, action, taxRate, users]);\r\n\r\n  return (\r\n    <div className=\"money-transfer-container\">\r\n      <div className=\"header\">\r\n        <div className=\"admin-info\">\r\n          <span className=\"admin-label\">ê´€ë¦¬ì</span>\r\n          <span className=\"admin-name\">{adminName || \"ë¡œë”© ì¤‘...\"}</span>\r\n          <span className=\"admin-cash\">í˜„ê¸ˆ: {(userDoc?.cash || 0).toLocaleString()}ì›</span>\r\n        </div>\r\n      </div>\r\n\r\n      {error && <div className=\"alert alert-error\">{error}</div>}\r\n      {message && <div className=\"alert alert-success\">{message}</div>}\r\n\r\n      <form onSubmit={handleSubmit} className=\"transfer-form\">\r\n        <div className=\"action-selector\">\r\n          <button type=\"button\" className={`action-btn ${action === \"send\" ? \"active send\" : \"\"}`} onClick={() => setAction(\"send\")}>\r\n            <span className=\"icon\">ğŸ“¤</span> ë³´ë‚´ê¸°\r\n          </button>\r\n          <button type=\"button\" className={`action-btn ${action === \"take\" ? \"active take\" : \"\"}`} onClick={() => setAction(\"take\")}>\r\n            <span className=\"icon\">ğŸ“¥</span> ê°€ì ¸ì˜¤ê¸°\r\n          </button>\r\n        </div>\r\n\r\n        {action === \"take\" && (\r\n          <div className=\"take-mode-section\">\r\n            <h4>ê°€ì ¸ì˜¤ê¸° ì˜µì…˜</h4>\r\n            <div className=\"take-mode-selector\">\r\n              <label className={`mode-option ${takeMode === 'toMe' ? 'active' : ''}`}>\r\n                <input\r\n                  type=\"radio\"\r\n                  name=\"takeMode\"\r\n                  value=\"toMe\"\r\n                  checked={takeMode === 'toMe'}\r\n                  onChange={(e) => setTakeMode(e.target.value)}\r\n                />\r\n                <span className=\"radio-custom\"></span>\r\n                <span className=\"mode-text\">\r\n                  <strong>ğŸ’° ë‚˜ì—ê²Œ ê°€ì ¸ì˜¤ê¸°</strong>\r\n                  <small>ì„ íƒí•œ í•™ìƒë“¤ì˜ ëˆì„ ë‚´ ê³„ì¢Œë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤</small>\r\n                </span>\r\n              </label>\r\n              <label className={`mode-option ${takeMode === 'remove' ? 'active' : ''}`}>\r\n                <input\r\n                  type=\"radio\"\r\n                  name=\"takeMode\"\r\n                  value=\"remove\"\r\n                  checked={takeMode === 'remove'}\r\n                  onChange={(e) => setTakeMode(e.target.value)}\r\n                />\r\n                <span className=\"radio-custom\"></span>\r\n                <span className=\"mode-text\">\r\n                  <strong>ğŸ—‘ï¸ ëˆ ì—†ì• ê¸°</strong>\r\n                  <small>ì„ íƒí•œ í•™ìƒë“¤ì˜ ëˆì„ ì˜êµ¬ì ìœ¼ë¡œ ì œê±°í•©ë‹ˆë‹¤</small>\r\n                </span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"amount-section\">\r\n          <div className=\"amount-type-selector\">\r\n            <label className={`type-option ${amountType === 'fixed' ? 'active' : ''}`}>\r\n              <input type=\"radio\" name=\"amountType\" value=\"fixed\" checked={amountType === 'fixed'} onChange={(e) => setAmountType(e.target.value)} />\r\n              <span className=\"radio-custom\"></span> ê³ ì • ê¸ˆì•¡\r\n            </label>\r\n            <label className={`type-option ${amountType === 'percentage' ? 'active' : ''}`}>\r\n              <input type=\"radio\" name=\"amountType\" value=\"percentage\" checked={amountType === 'percentage'} onChange={(e) => setAmountType(e.target.value)} />\r\n              <span className=\"radio-custom\"></span> í¼ì„¼íŠ¸ (%)\r\n            </label>\r\n          </div>\r\n          <div className=\"amount-input-group\">\r\n            <input type=\"number\" value={amount} onChange={(e) => setAmount(e.target.value)} placeholder={amountType === 'fixed' ? 'ê¸ˆì•¡ ì…ë ¥' : 'í¼ì„¼íŠ¸ ì…ë ¥'} min=\"1\" max={amountType === 'percentage' ? \"100\" : undefined} required className=\"amount-input\" />\r\n            <span className=\"amount-unit\">{amountType === 'fixed' ? 'ì›' : '%'}</span>\r\n          </div>\r\n        </div>\r\n\r\n        {action === \"send\" && (\r\n          <div className=\"tax-section\">\r\n            <div className=\"tax-header\">\r\n              <h4>ğŸ’¸ ì„¸ê¸ˆ ì„¤ì •</h4>\r\n              <span className=\"tax-description\">ë³´ë‚´ëŠ” ê¸ˆì•¡ì—ì„œ ì„¸ê¸ˆì„ ì œì™¸í•˜ê³  ì§€ê¸‰ë©ë‹ˆë‹¤.</span>\r\n            </div>\r\n            <div className=\"tax-input-group\">\r\n              <label htmlFor=\"taxRate\">ì„¸ê¸ˆìœ¨:</label>\r\n              <input type=\"number\" id=\"taxRate\" value={taxRate} onChange={(e) => setTaxRate(Math.max(0, Math.min(100, Number(e.target.value))))} min=\"0\" max=\"100\" className=\"tax-input\" />\r\n              <span className=\"tax-unit\">%</span>\r\n            </div>\r\n            {amount && (\r\n              <div className=\"tax-preview\">\r\n                {amountType === 'fixed' ? (\r\n                  <>ì‹¤ì œ ì§€ê¸‰ì•¡: {calculatePreviewAmount(0, amount, true).toLocaleString()}ì› (ì„¸ê¸ˆ {Math.floor((Number(amount) * taxRate) / 100).toLocaleString()}ì› ì œì™¸)</>\r\n                ) : (\r\n                  `ê° í•™ìƒ ì”ì•¡ì˜ ${amount}%ì—ì„œ ì„¸ê¸ˆ ${taxRate}%ê°€ ì¶”ê°€ë¡œ ì°¨ê°ë©ë‹ˆë‹¤.`\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"user-selection-section\">\r\n          <div className=\"section-header\">\r\n            <h3>ëŒ€ìƒ ì„ íƒ</h3>\r\n            <label className=\"select-all-label\">\r\n              <input type=\"checkbox\" checked={selectAll} onChange={handleSelectAll} className=\"checkbox-custom\" />\r\n              <span className=\"checkmark\"></span> ì „ì²´ ì„ íƒ\r\n            </label>\r\n          </div>\r\n\r\n          {authLoading && users.length === 0 ? (\r\n            <div className=\"loading\">ì‚¬ìš©ì ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>\r\n          ) : (\r\n            <div className=\"user-list\">\r\n              {users.map((user) => {\r\n                const previewAmount = previewAmounts[user.id];\r\n                return (\r\n                  <div key={user.id} className=\"user-item\">\r\n                    <label className=\"user-label\">\r\n                      <input type=\"checkbox\" checked={selectedUsers.includes(user.id)} onChange={() => handleUserSelection(user.id)} className=\"checkbox-custom\" />\r\n                      <span className=\"checkmark\"></span>\r\n                      <div className=\"user-info\">\r\n                        <span className=\"user-name\">{user.name}</span>\r\n                        <span className=\"user-balance\">ì”ì•¡: {user.cash?.toLocaleString() || 0}ì›</span>\r\n                        {previewAmount !== undefined && (\r\n                          <span className={`preview-amount ${action}`}>\r\n                            {action === 'send' ? '+' : 'âˆ’'}{previewAmount.toLocaleString()}ì›\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    </label>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <button type=\"submit\" className={`submit-btn ${action}`} disabled={authLoading || isProcessing}>\r\n          {isProcessing ? (\r\n            <><span className=\"spinner\"></span> ì²˜ë¦¬ ì¤‘...</>\r\n          ) : (\r\n            <><span className=\"icon\">{action === 'send' ? 'ğŸ“¤' : 'ğŸ“¥'}</span> {action === 'send' ? 'ë³´ë‚´ê¸°' : 'ê°€ì ¸ì˜¤ê¸°'} ì‹¤í–‰</>\r\n          )}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MoneyTransfer;"],"names":["userDoc","allClassMembers","loading","authLoading","setUserDoc","setAllClassMembers","useAuth","selectedUsers","setSelectedUsers","useState","amount","setAmount","amountType","setAmountType","action","setAction","takeMode","setTakeMode","taxRate","setTaxRate","message","setMessage","error","setError","selectAll","setSelectAll","isProcessing","setIsProcessing","adminName","name","adminClassCode","classCode","users","useMemo","length","sort","a","b","nameA","nickname","nameB","localeCompare","useEffect","calculatePreviewAmount","userCash","inputValue","baseAmount","applyTax","arguments","undefined","Math","floor","Number","previewAmounts","preview","forEach","userId","user","find","u","id","cash","_jsxs","className","children","_jsx","toLocaleString","onSubmit","async","e","preventDefault","isNaN","concat","targetUsersData","filter","includes","count","totalProcessed","updatedUsers","adminCashAction","targetUsers","currentMembers","map","member","updatedInfo","_objectSpread","newCash","currentAdminDoc","currentAdminCash","newAdminCash","actionText","setTimeout","err","console","type","onClick","value","checked","onChange","target","placeholder","min","max","required","htmlFor","_Fragment","handleSelectAll","prev","newSelectAll","_user$cash","previewAmount","handleUserSelection","prevSelected","disabled"],"sourceRoot":""}