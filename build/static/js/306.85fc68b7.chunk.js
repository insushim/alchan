"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[306],{262(e,t,s){s.d(t,{A:()=>n});s(5043),s(5173);var a=s(579);const n=()=>(0,a.jsxs)("div",{className:"login-warning",children:[(0,a.jsx)("h3",{children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4"}),(0,a.jsx)("p",{children:"\uc544\uc774\ud15c\uc744 \uad6c\ub9e4\ud558\uac70\ub098 \uc0ac\uc6a9\ud558\ub824\uba74 \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})]})},577(e,t,s){s.d(t,{nm:()=>o,v5:()=>i});var a=s(5043),n=s(5452);const i={REALTIME:6e5,NORMAL:18e5,LOW:36e5,MANUAL:null};let l=[],r=!1;const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{interval:s=i.NORMAL,enabled:o=!0,deps:d=[]}=t,[c,m]=(0,a.useState)(null),[u,x]=(0,a.useState)(!0),[p,h]=(0,a.useState)(null),g=(0,a.useRef)(null),b=(0,a.useRef)(!0),f=(0,a.useRef)(e);(0,a.useEffect)(()=>{f.current=e},[e]);const y=(0,a.useCallback)(async()=>{if(o)try{h(null);const e=await f.current();b.current&&(m(e),x(!1))}catch(e){n.vF.error("[usePolling] \ub370\uc774\ud130 \uc870\ud68c \uc624\ub958:",e),b.current&&(h(e),x(!1))}else x(!1)},[o]),v=(0,a.useCallback)(()=>(x(!0),y()),[y]);return(0,a.useEffect)(()=>{if(b.current=!0,g.current&&(clearInterval(g.current),g.current=null),o&&s!==i.MANUAL)return l.push(y),(async()=>{if(!r&&0!==l.length){for(r=!0;l.length>0;){const e=l.shift();await e(),await new Promise(e=>setTimeout(e,100))}r=!1}})(),s&&s>0&&(g.current=setInterval(y,s)),()=>{b.current=!1,g.current&&(clearInterval(g.current),g.current=null)};x(!1)},[y,s,o,...d]),{data:c,loading:u,error:p,refetch:v}}},783(e,t,s){s.d(t,{A:()=>l});var a=s(5043),n=s(5452),i=s(579);const l=(0,a.memo)(function(e){let{showSellCouponModal:t,setShowSellCouponModal:s,currentCoupons:l=0,couponValue:r=1e3,sellAmount:o="",setSellAmount:d,SellCoupon:c}=e;const[m,u]=(0,a.useState)(!1),[x,p]=(0,a.useState)("");if(!t)return null;const h=()=>{d(""),p(""),s(!1)},g=!o||isNaN(parseInt(o))||parseInt(o)<=0||parseInt(o)>l;return(0,i.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[1000]",onClick:h,children:(0,i.jsxs)("div",{className:"bg-white p-5 rounded-lg max-w-[500px] w-[90%] max-h-[90vh] overflow-y-auto shadow-md",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"\ucfe0\ud3f0 \ud310\ub9e4\ud558\uae30"}),(0,i.jsx)("p",{className:"mb-2.5 text-sm text-gray-600",children:"\ucfe0\ud3f0\uc744 \ud310\ub9e4\ud558\uace0 \ud604\uae08\uc73c\ub85c \uad50\ud658\ud558\uc138\uc694."}),(0,i.jsxs)("div",{className:"flex justify-between mb-4 p-2.5 bg-gray-50 rounded-md text-[15px]",children:[(0,i.jsx)("span",{children:"\ud604\uc7ac \ubcf4\uc720 \ucfe0\ud3f0:"}),(0,i.jsx)("strong",{children:l.toLocaleString()})]}),(0,i.jsxs)("div",{className:"flex justify-between mb-4 p-2.5 bg-gray-50 rounded-md text-[15px] text-indigo-600",children:[(0,i.jsx)("span",{children:"1\ucfe0\ud3f0 \ud310\ub9e4\uac00:"}),(0,i.jsxs)("strong",{children:[r.toLocaleString(),"\uc6d0"]})]}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=parseInt(o);if(p(""),!t||isNaN(t)||t<=0)p("\uc720\ud6a8\ud55c \ucfe0\ud3f0 \uc218\ub7c9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");else if(t>l)p("\ubcf4\uc720\ud55c \ucfe0\ud3f0\ubcf4\ub2e4 \ub9ce\uc740 \uc218\ub7c9\uc744 \ud310\ub9e4\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");else{if("function"!==typeof c)return p("\ud310\ub9e4 \ucc98\ub9ac \ud568\uc218\uac00 \uc62c\ubc14\ub974\uac8c \uc804\ub2ec\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),void n.vF.error("SellCoupon prop is not a function:",c);u(!0);try{await c()}catch(s){n.vF.error("\ud310\ub9e4 \ucc98\ub9ac \uc911 \uc608\uc0c1\uce58 \ubabb\ud55c \uc624\ub958:",s),p(s.message||"\ud310\ub9e4 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")}finally{u(!1)}}},children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{htmlFor:"sellAmount",className:"block mb-1 font-medium text-gray-700",children:"\ud310\ub9e4\ud560 \ucfe0\ud3f0 \uc218:"}),(0,i.jsx)("input",{id:"sellAmount",type:"number",value:o,onChange:e=>d(e.target.value),min:"1",max:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm outline-none",disabled:m,required:!0})]}),x&&(0,i.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md px-4 py-3 mb-4 text-red-800 text-sm",children:(0,i.jsxs)("p",{className:"m-0",children:["\u26a0\ufe0f ",x]})}),(0,i.jsx)("div",{className:"mb-5 px-4 py-2.5 bg-indigo-50 rounded-md border-l-4 border-indigo-600",children:(0,i.jsxs)("div",{className:"flex justify-between text-base font-semibold text-gray-800",children:[(0,i.jsx)("span",{children:"\uc608\uc0c1 \uc218\ub839\uc561:"}),(0,i.jsxs)("span",{className:"text-indigo-600",children:[(()=>{const e=parseInt(o);return!isNaN(e)&&e>0?e*r:0})().toLocaleString(),"\uc6d0"]})]})}),(0,i.jsxs)("div",{className:"flex justify-end gap-2.5 mt-5",children:[(0,i.jsx)("button",{type:"button",onClick:h,className:"px-4 py-2 bg-gray-100 text-gray-600 border-0 rounded-md text-sm cursor-pointer transition-colors duration-200",disabled:m,children:"\ucde8\uc18c"}),(0,i.jsx)("button",{type:"submit",className:"px-4 py-2 bg-red-500 text-white border-0 rounded-md text-sm font-medium transition-all duration-200",style:{cursor:g||m?"not-allowed":"pointer",opacity:g||m?.6:1},disabled:g||m,children:m?"\ucc98\ub9ac \uc911...":"\ud310\ub9e4\ud558\uae30"})]})]})]})})})},813(e,t,s){s.d(t,{A:()=>l});var a=s(5043),n=s(5452),i=s(579);const l=(0,a.memo)(function(e){let{showGiftCouponModal:t,setShowGiftCouponModal:s,recipients:a,giftRecipient:l,setGiftRecipient:r,giftAmount:o,setGiftAmount:d,handleGiftCoupon:c,currentCoupons:m,userId:u}=e;if(!t)return null;const x=null!==a&&void 0!==a?a:[],p=()=>{s(!1),"function"===typeof d?d(""):n.vF.error("setGiftAmount prop is not a function!",d),"function"===typeof r?r(""):n.vF.error("setGiftRecipient prop is not a function!",r)};return(0,i.jsx)("div",{className:"modal-backdrop fixed inset-0 bg-black/50 flex justify-center items-center z-[1000]",onClick:p,children:(0,i.jsxs)("div",{className:"gift-coupon-modal bg-white rounded-xl p-6 w-[90%] max-w-[400px] shadow-xl",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("h3",{className:"mt-0 text-gray-700",children:"\ucfe0\ud3f0 \uc120\ubb3c\ud558\uae30"}),(0,i.jsx)("div",{className:"mb-4 text-gray-500",children:(0,i.jsxs)("p",{children:["\ud604\uc7ac \ubcf4\uc720 \ucfe0\ud3f0: ",(0,i.jsxs)("strong",{children:[m,"\uac1c"]})]})}),(0,i.jsxs)("div",{className:"form-group mb-4",children:[(0,i.jsx)("label",{className:"block mb-2 font-medium text-gray-600",children:"\ubc1b\ub294 \uc0ac\ub78c"}),(0,i.jsxs)("select",{value:l,onChange:e=>"function"===typeof r?r(e.target.value):n.vF.error("setGiftRecipient is not a function"),className:"w-full p-2.5 border border-gray-300 rounded-md text-sm",children:[(0,i.jsx)("option",{value:"",children:"\ubc1b\ub294 \ubd84\uc744 \uc120\ud0dd\ud558\uc138\uc694"}),x.filter(e=>e.id!==u).map(e=>(0,i.jsxs)("option",{value:e.id,children:[e.name," (",e.id,")"]},e.id))]})]}),(0,i.jsxs)("div",{className:"form-group mb-6",children:[(0,i.jsx)("label",{className:"block mb-2 font-medium text-gray-600",children:"\uc120\ubb3c\ud560 \ucfe0\ud3f0 \uc218\ub7c9"}),(0,i.jsx)("input",{type:"number",value:o,onChange:e=>"function"===typeof d?d(e.target.value):n.vF.error("setGiftAmount is not a function"),placeholder:"\uc120\ubb3c\ud560 \ucfe0\ud3f0 \uc218\ub7c9\uc744 \uc785\ub825\ud558\uc138\uc694",className:"w-full p-2.5 border border-gray-300 rounded-md text-sm",max:m,min:"1"})]}),(0,i.jsxs)("div",{className:"modal-actions flex justify-end gap-2.5",children:[(0,i.jsx)("button",{className:"cancel-button px-4 py-2 bg-gray-100 text-gray-600 border-0 rounded-md cursor-pointer font-medium",onClick:p,children:"\ucde8\uc18c"}),(0,i.jsx)("button",{className:"confirm-button px-4 py-2 bg-emerald-500 text-white border-0 rounded-md text-sm font-medium",onClick:c,disabled:!l||!o||parseInt(o)<=0||parseInt(o)>m,style:{cursor:!l||!o||parseInt(o)<=0||parseInt(o)>m?"not-allowed":"pointer",opacity:!l||!o||parseInt(o)<=0||parseInt(o)>m?.7:1},children:"\uc120\ubb3c\ud558\uae30"})]})]})})})},3057(e,t,s){s.d(t,{A:()=>o});var a=s(2555),n=s(5043),i=s(5016),l=s(5452),r=s(579);const o=(0,n.memo)(function(e){var t;let{showDonationHistoryModal:s,setShowDonationHistoryModal:o,students:d=[],classCode:c,donations:m=[]}=e;const{user:u,userDoc:x}=(0,i.As)(),p=null===u||void 0===u?void 0:u.uid,h=(null===x||void 0===x?void 0:x.classCode)||c,[g,b]=(0,n.useState)([]),[f,y]=(0,n.useState)(!0),[v,j]=(0,n.useState)(null),[N,w]=(0,n.useState)(0),k={table:{width:"100%",borderCollapse:"collapse",fontSize:"14px",borderRadius:"8px",overflow:"hidden",border:"1px solid #e5e7eb"},thead:{backgroundColor:"#f3f4f6"},th:{padding:"12px 16px",textAlign:"left",fontWeight:"600",color:"#374151",borderBottom:"1px solid #d1d5db",position:"sticky",top:0,backgroundColor:"#f3f4f6",zIndex:1},td:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",color:"#4b5563"},tr:{transition:"background-color 0.2s"},emptyContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"40px 20px",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px dashed #d1d5db",textAlign:"center",color:"#6b7280"},emptyIcon:{fontSize:"36px",marginBottom:"16px",color:"#9ca3af"}};(0,n.useEffect)(()=>{if(s){(()=>{if(y(!0),j(null),b([]),w(0),l.vF.log("[DonationHistoryModal] \ub370\uc774\ud130 \ucc98\ub9ac \uc2dc\uc791:",{userClassCode:h,studentsCount:d.length,donationsCount:m.length,students:d.map(e=>({id:e.id||e.uid,name:e.name||e.nickname,classCode:e.classCode})),donations:m}),!h)return j("\ud559\uae09 \uc815\ubcf4\ub97c \ud655\uc778\ud560 \uc218 \uc5c6\uc5b4 \uae30\ubd80 \ub0b4\uc5ed\uc744 \ucc98\ub9ac\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),void y(!1);try{const e=m||[],t=Array.isArray(d)?d:[],s={};let a=0;e.forEach(e=>{const t=Number(e.amount)||0,n=e.userId,i=e.userName||e.name||"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790";n&&(s[n]||(s[n]={amount:0,name:i}),s[n].amount+=t,i&&"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790"!==i&&(s[n].name=i)),a+=t}),w(a),l.vF.log("[DonationHistoryModal] \uae30\ubd80 \uc9d1\uacc4:",{donationsByStudent:s,totalAmount:a,uniqueDonors:Object.keys(s).length});const n=new Set;t.forEach(e=>{const t=e.id||e.uid||e.userId;t&&n.add(t)}),Object.keys(s).forEach(e=>{n.add(e)});const i=new Map;t.forEach(e=>{const t=e.id||e.uid||e.userId,s=e.name||e.nickname||"\uc54c \uc218 \uc5c6\ub294 \ud559\uc0dd";t&&i.set(t,s)}),Object.keys(s).forEach(e=>{i.has(e)&&"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790"===s[e].name||i.set(e,s[e].name)});const r=Array.from(n).map(e=>{var t;return{id:e,name:i.get(e)||"\uc54c \uc218 \uc5c6\ub294 \ud559\uc0dd",cumulativeAmount:(null===(t=s[e])||void 0===t?void 0:t.amount)||0,isCurrentUser:p&&e===p}}).sort((e,t)=>e.name.localeCompare(t.name,"ko"));l.vF.log("[DonationHistoryModal] \ucd5c\uc885 \ud559\uc0dd \ubaa9\ub85d:",{totalStudents:r.length,studentsWithDonations:r.filter(e=>e.cumulativeAmount>0).length,summary:r}),b(r)}catch(e){l.vF.error("[DonationHistoryModal] \uae30\ubd80 \ub0b4\uc5ed \ucc98\ub9ac \uc911 \uc624\ub958:",e),j("\uae30\ubd80 \ub0b4\uc5ed\uc744 \ucc98\ub9ac\ud558\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{y(!1)}})()}},[s,d,p,h,m]);const C=()=>{o(!1)},S=e=>"number"!==typeof e||isNaN(e)?"0":e.toLocaleString(),A=(null===(t=g.find(e=>e.isCurrentUser))||void 0===t?void 0:t.cumulativeAmount)||0;return(0,r.jsx)("div",{className:"".concat(s?"flex":"hidden"," fixed inset-0 bg-black/50 items-center justify-center z-[1000] p-5"),onClick:C,children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-[600px] max-h-[85vh] overflow-hidden flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"px-5 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[(0,r.jsxs)("h3",{className:"m-0 text-lg font-semibold text-gray-800",children:["\uc6b0\ub9ac \ud559\uae09 \uae30\ubd80 \ud604\ud669",h&&(0,r.jsx)("span",{className:"ml-2 text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-xl font-medium",children:h})]}),(0,r.jsx)("button",{onClick:C,className:"bg-transparent border-0 cursor-pointer text-xl text-gray-400 p-0 leading-none","aria-label":"\ub2eb\uae30",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"p-5 overflow-y-auto max-h-[calc(85vh-120px)]",children:[(0,r.jsxs)("div",{className:"bg-indigo-50 px-4 py-3 rounded-lg mb-5 border border-indigo-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-indigo-700",children:"\ub0b4 \ub204\uc801 \uae30\ubd80\uc561"}),(0,r.jsxs)("span",{className:"text-base font-semibold text-indigo-600",children:[S(A)," \ucfe0\ud3f0"]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-indigo-700",children:"\uc6b0\ub9ac \ud559\uae09 \ucd1d \uae30\ubd80\uc561"}),(0,r.jsxs)("span",{className:"text-base font-semibold text-indigo-600",children:[S(N)," \ucfe0\ud3f0"]})]})]}),f?(0,r.jsx)("div",{className:"text-center py-10 text-gray-500",children:"\uae30\ubd80 \ud604\ud669\uc744 \ubd88\ub7ec\uc624\ub294 \uc911..."}):v?(0,r.jsx)("div",{className:"text-red-500 text-center py-10",children:v}):(0,r.jsx)(r.Fragment,{children:g.length>0?(0,r.jsxs)("table",{style:k.table,children:[(0,r.jsx)("thead",{style:k.thead,children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{style:k.th,children:"\ud559\uc0dd \uc774\ub984"}),(0,r.jsx)("th",{style:(0,a.A)((0,a.A)({},k.th),{},{width:"150px",textAlign:"right"}),children:"\ub204\uc801 \uae30\ubd80 \ucfe0\ud3f0"})]})}),(0,r.jsx)("tbody",{children:g.map((e,t)=>(0,r.jsxs)("tr",{style:(0,a.A)((0,a.A)({},k.tr),{},{backgroundColor:e.isCurrentUser?"#e0e7ff":t%2===0?"#f9fafb":"#ffffff"}),onMouseOver:t=>{e.isCurrentUser||(t.currentTarget.style.backgroundColor="#eef2ff")},onMouseOut:s=>{e.isCurrentUser||(s.currentTarget.style.backgroundColor=t%2===0?"#f9fafb":"#ffffff")},children:[(0,r.jsxs)("td",{style:k.td,children:[e.name,e.isCurrentUser&&(0,r.jsx)("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 px-1.5 py-0.5 rounded-lg font-semibold align-middle",children:"\ub098"})]}),(0,r.jsxs)("td",{style:(0,a.A)((0,a.A)({},k.td),{},{textAlign:"right",color:e.cumulativeAmount>0?"#4f46e5":"#6b7280",fontWeight:e.cumulativeAmount>0?"600":"normal"}),children:[S(e.cumulativeAmount)," \ucfe0\ud3f0"]})]},e.id||t))})]}):(0,r.jsxs)("div",{style:k.emptyContainer,children:[(0,r.jsx)("div",{style:k.emptyIcon,children:"\ud83d\udc65"}),(0,r.jsx)("p",{className:"m-0 mb-2 text-base font-medium",children:"\ud559\uae09 \ud559\uc0dd \uc815\ubcf4\ub97c \ubd88\ub7ec\uc62c \uc218 \uc5c6\uac70\ub098 \ub4f1\ub85d\ub41c \ud559\uc0dd\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,r.jsx)("p",{className:"m-0 text-sm",children:"\uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc5ec \ud559\uae09 \uc124\uc815\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694."})]})})]}),(0,r.jsx)("div",{className:"px-5 py-4 border-t border-gray-200 flex justify-end",children:(0,r.jsx)("button",{onClick:C,className:"px-4 py-2 bg-gray-200 text-gray-700 border-0 rounded-md cursor-pointer font-medium transition-all duration-200 hover:bg-gray-300 hover:text-gray-800",children:"\ub2eb\uae30"})})]})})})},5226(e,t,s){s.d(t,{A:()=>l});var a=s(5043),n=s(5452),i=s(579);const l=(0,a.memo)(function(e){let{showDonateModal:t,setShowDonateModal:s,currentCoupons:l,onDonate:r,classCode:o}=e;const[d,c]=(0,a.useState)(""),[m,u]=(0,a.useState)(""),[x,p]=(0,a.useState)(!1),h=()=>{x||(s(!1),c(""),u(""))};return t?(0,i.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[1000] p-5",onClick:h,children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-[500px] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"px-5 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[(0,i.jsxs)("h3",{className:"m-0 text-lg font-semibold text-gray-800",children:["\ucfe0\ud3f0 \uae30\ubd80\ud558\uae30",o&&(0,i.jsx)("span",{className:"ml-2 text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-xl font-medium",children:o})]}),(0,i.jsx)("button",{onClick:h,disabled:x,className:"bg-transparent border-0 text-xl text-gray-400 p-0 leading-none ".concat(x?"cursor-not-allowed":"cursor-pointer"),"aria-label":"\ub2eb\uae30",children:"\xd7"})]}),(0,i.jsxs)("div",{className:"p-5",children:[(0,i.jsx)("div",{className:"mb-5",children:(0,i.jsxs)("div",{className:"flex justify-between items-center bg-indigo-50 px-4 py-3 rounded-lg border border-indigo-200",children:[(0,i.jsx)("span",{className:"text-sm font-medium text-indigo-700",children:"\ud604\uc7ac \ubcf4\uc720 \ucfe0\ud3f0"}),(0,i.jsxs)("span",{className:"text-base font-semibold text-indigo-600",children:[l.toLocaleString()," \uac1c"]})]})}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"\uae30\ubd80\ud560 \ucfe0\ud3f0 \uc218\ub7c9"}),(0,i.jsx)("input",{type:"number",min:"1",max:l,value:d,onChange:e=>c(e.target.value),disabled:x,className:"w-full p-3 border border-gray-300 rounded-md text-base ".concat(x?"bg-gray-50 cursor-not-allowed":"bg-white cursor-text"),placeholder:"\uae30\ubd80\ud560 \ucfe0\ud3f0 \uc218\ub7c9\uc744 \uc785\ub825\ud558\uc138\uc694"})]}),(0,i.jsxs)("div",{className:"mb-5",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"\uae30\ubd80 \uba54\uc2dc\uc9c0 (\uc120\ud0dd\uc0ac\ud56d)"}),(0,i.jsx)("textarea",{value:m,onChange:e=>u(e.target.value),disabled:x,className:"w-full p-3 border border-gray-300 rounded-md text-sm resize-y min-h-[80px] ".concat(x?"bg-gray-50 cursor-not-allowed":"bg-white cursor-text"),placeholder:"\uae30\ubd80\uc640 \ud568\uaed8 \uc804\ud560 \uba54\uc2dc\uc9c0\ub97c \uc785\ub825\ud558\uc138\uc694"})]}),d&&!isNaN(parseInt(d,10))&&(0,i.jsx)("div",{className:"bg-green-50 px-4 py-3 rounded-lg border border-green-200 mb-5",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("span",{className:"text-sm font-medium text-green-800",children:"\uae30\ubd80 \uc608\uc815 \ucfe0\ud3f0"}),(0,i.jsxs)("span",{className:"text-base font-semibold text-green-600",children:[parseInt(d,10).toLocaleString()," \uac1c"]})]})})]}),(0,i.jsxs)("div",{className:"px-5 py-4 border-t border-gray-200 flex justify-end gap-3",children:[(0,i.jsx)("button",{onClick:h,disabled:x,className:"px-4 py-2 bg-gray-200 text-gray-700 border-0 rounded-md font-medium ".concat(x?"cursor-not-allowed opacity-60":"cursor-pointer opacity-100"),children:"\ucde8\uc18c"}),(0,i.jsx)("button",{onClick:async()=>{const e=parseInt(d,10);if(isNaN(e)||e<=0)alert("\uc62c\ubc14\ub978 \ucfe0\ud3f0 \uc218\ub7c9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");else if(e>l)alert("\ubcf4\uc720 \ucfe0\ud3f0\ubcf4\ub2e4 \ub9ce\uc774 \uae30\ubd80\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");else{p(!0);try{await r(e,m)&&(c(""),u(""),s(!1))}catch(t){n.vF.error("[DonateCouponModal] \uae30\ubd80 \ucc98\ub9ac \uc911 \uc624\ub958:",t),alert("\uae30\ubd80 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{p(!1)}}},disabled:x||!d||isNaN(parseInt(d,10))||parseInt(d,10)<=0||parseInt(d,10)>l,style:{backgroundColor:x||!d||isNaN(parseInt(d,10))||parseInt(d,10)<=0||parseInt(d,10)>l?"#9ca3af":"#4f46e5"},className:"px-4 py-2 text-white border-0 rounded-md font-medium ".concat(x||!d||isNaN(parseInt(d,10))||parseInt(d,10)<=0||parseInt(d,10)>l?"cursor-not-allowed":"cursor-pointer"),children:x?"\uae30\ubd80 \uc911...":"\uae30\ubd80\ud558\uae30"})]})]})}):null})},5967(e,t,s){s.r(t),s.d(t,{default:()=>g});var a=s(5043),n=s(5016),i=s(2555),l=s(2419),r=s(5472),o=s(5452);const d=e=>e||null,c=new Map,m=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return"".concat(e,"_").concat(t,"_").concat(JSON.stringify(s))},u=e=>{const t=c.get(e);if(!t)return null;return Date.now()-t.timestamp>9e5?(c.delete(e),null):t.data},x=(e,t)=>{c.set(e,{data:t,timestamp:Date.now()})},p=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{userId:s,type:a,startDate:n,endDate:c,limitCount:p=50,lastDoc:h=null}=t;try{const h=m(e,"activity_logs",t),g=u(h);if(g)return o.vF.log("[AdminDatabaseService] \uce90\uc2dc\ub41c \ud65c\ub3d9 \ub85c\uadf8 \uc0ac\uc6a9"),g;o.vF.log("[AdminDatabaseService] \ud65c\ub3d9 \ub85c\uadf8 \uc11c\ubc84 \uc0ac\uc774\ub4dc \ud544\ud130\ub9c1 \uc870\ud68c:",{classCode:e,userId:s,type:a,limitCount:p});const b=[(0,r.where)("classCode","==",e)];if(s&&b.push((0,r.where)("userId","==",s)),n){const e=n instanceof Date?r.Dc.fromDate(n):n;b.push((0,r.where)("timestamp",">=",e))}if(c){const e=c instanceof Date?r.Dc.fromDate(c):c;b.push((0,r.where)("timestamp","<=",e))}const f=a&&!n&&!c;f&&b.push((0,r.where)("type","==",d(a))),b.push((0,r.orderBy)("timestamp","desc")),b.push((0,r.limit)(p+1));const y=(0,r.query)((0,r.rJ)(l.db,"activity_logs"),...b),v=await(0,r.getDocs)(y);let j=[];if(v.forEach(e=>{var t;const s=e.data();j.push((0,i.A)((0,i.A)({id:e.id},s),{},{timestamp:(null===(t=s.timestamp)||void 0===t?void 0:t.toDate())||new Date}))}),a&&!f){const e=d(a);j=j.filter(t=>t.type===e)}const N=j.length>p,w=j.slice(0,p),k=w.length>0?w[w.length-1].id:null;o.vF.log("[AdminDatabaseService] \ud65c\ub3d9 \ub85c\uadf8 \uc870\ud68c \uc644\ub8cc: ".concat(w.length,"\uac1c (\uc11c\ubc84 \ud544\ud130\ub9c1)"));const C={logs:w,hasMore:N,lastDoc:k};return x(h,C),C}catch(g){throw o.vF.error("[AdminDatabaseService] \ud65c\ub3d9 \ub85c\uadf8 \uc870\ud68c \uc624\ub958:",g),g}};var h=s(579);const g=()=>{const{userDoc:e,allClassMembers:t}=(0,n.As)(),[s,d]=(0,a.useState)("all"),[m,u]=(0,a.useState)([]),[x,g]=(0,a.useState)(!1),[b,f]=(0,a.useState)(null),[y,v]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null),[w,k]=(0,a.useState)(""),[C,S]=(0,a.useState)(""),[A,I]=(0,a.useState)("all"),E=null===e||void 0===e?void 0:e.classCode,T=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(E&&"\ubbf8\uc9c0\uc815"!==E){g(!0),f(null);try{const n="all"!==A||""!==C.trim(),d={userId:"all"!==s?s:null,limitCount:n?100:10,lastDoc:e?null:a,useCache:!e},c=await p(E,d);if(0===c.logs.length&&t.length>0&&e){const e="all"!==s?[s]:t.map(e=>e.id||e.uid),a=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const{limitCount:s=100}=t;if(o.vF.log("[AdminDatabaseService] transactions \uceec\ub809\uc158 \uc870\ud68c \uc2dc\uc791:",{userIdsCount:e.length}),0===e.length)return o.vF.warn("[AdminDatabaseService] userIds\uac00 \ube44\uc5b4\uc788\uc74c"),[];const a=[];for(let t=0;t<e.length;t+=10)a.push(e.slice(t,t+10));const n=[];for(const e of a){let t=(0,r.query)((0,r.rJ)(l.db,"transactions"),(0,r.where)("userId","in",e),(0,r.orderBy)("timestamp","desc"),(0,r.limit)(s));(await(0,r.getDocs)(t)).forEach(e=>{var t;const s=e.data();n.push((0,i.A)((0,i.A)({id:e.id},s),{},{timestamp:(null===(t=s.timestamp)||void 0===t?void 0:t.toDate())||new Date}))})}return o.vF.log("[AdminDatabaseService] transactions \uc870\ud68c \uc644\ub8cc: ".concat(n.length,"\uac1c")),n}catch(b){return o.vF.error("[AdminDatabaseService] transactions \uc870\ud68c \uc624\ub958:",b),[]}}(e,{limitCount:100});a.length>0&&(c.logs=(e=>e.map(e=>{let t="CASH_INCOME",s=e.description||"\uac70\ub798";return e.description&&(e.description.includes("\ucfe0\ud3f0")&&e.description.includes("\ud68d\ub4dd")?t="COUPON_EARN":e.description.includes("\ucfe0\ud3f0")&&e.description.includes("\uc0ac\uc6a9")?t="COUPON_USE":e.description.includes("\uc544\uc774\ud15c")&&e.description.includes("\uad6c\ub9e4")?t="ITEM_PURCHASE":e.description.includes("\uc544\uc774\ud15c")&&e.description.includes("\uc0ac\uc6a9")?t="ITEM_USE":e.description.includes("\uc544\uc774\ud15c")&&(e.description.includes("\ud310\ub9e4")||e.description.includes("\ub4f1\ub85d"))?t="ITEM_SELL":e.description.includes("\uc1a1\uae08")?t=e.amount>0?"CASH_TRANSFER_RECEIVE":"CASH_TRANSFER_SEND":"expense"===e.type&&(t="CASH_EXPENSE")),{id:e.id,userId:e.userId,userName:e.userName||"\uc54c \uc218 \uc5c6\uc74c",type:t,description:s,timestamp:e.timestamp,metadata:(0,i.A)({amount:e.amount,category:e.category},e.metadata)}}))(a),c.hasMore=!1)}u(e?c.logs:e=>[...e,...c.logs]),v(c.hasMore),N(c.lastDoc)}catch(n){o.vF.error("[AdminDatabase] \ub370\uc774\ud130 \ub85c\ub4dc \uc624\ub958:",n),f("\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{g(!1)}}else f("\ud559\uae09\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.")},[E,s,t,A,C]);(0,a.useEffect)(()=>{u([]),N(null),v(!1),T(!0,null)},[s,E]),(0,a.useEffect)(()=>{m.length>0&&(u([]),N(null),v(!1),T(!0,null))},[A,C]);const D=()=>{!x&&y&&T(!1,j)},M=e=>{if(!e)return"text-gray-600";const t=e.toString().toLowerCase();return t.includes("\ucfe0\ud3f0")&&(t.includes("\ud68d\ub4dd")||t.includes("\uc9c0\uae09"))?"text-green-600":t.includes("\ucfe0\ud3f0")&&(t.includes("\uc0ac\uc6a9")||t.includes("\ud68c\uc218"))?"text-red-600":"COUPON_EARN"===e||"COUPON_GIVE"===e||"COUPON_TRANSFER_RECEIVE"===e||"ADMIN_COUPON_GIVE"===e?"text-green-600":"COUPON_USE"===e||"COUPON_TAKE"===e||"COUPON_TRANSFER_SEND"===e||"ADMIN_COUPON_TAKE"===e?"text-red-600":t.includes("\uc544\uc774\ud15c")&&t.includes("\uad6c\ub9e4")?"text-blue-600":t.includes("\uc544\uc774\ud15c")&&t.includes("\uc0ac\uc6a9")?"text-orange-600":t.includes("\uc544\uc774\ud15c")&&(t.includes("\ud310\ub9e4")||t.includes("\ub4f1\ub85d"))?"text-purple-600":"ITEM_PURCHASE"===e||"ITEM_MARKET_BUY"===e?"text-blue-600":"ITEM_USE"===e?"text-orange-600":"ITEM_SELL"===e||"ITEM_MARKET_LIST"===e?"text-purple-600":t.includes("\uc9c0\uae09")||t.includes("\uc785\uae08")||t.includes("\uc218\uc2e0")?"text-green-600":t.includes("\ud68c\uc218")||t.includes("\ucd9c\uae08")||t.includes("\uc1a1\uae08")?"text-red-600":"ADMIN_CASH_SEND"===e||"CASH_TRANSFER_RECEIVE"===e||"CASH_DEPOSIT"===e||"\ud604\uae08 \uc785\uae08"===e?"text-green-600":"ADMIN_CASH_TAKE"===e||"CASH_TRANSFER_SEND"===e||"CASH_WITHDRAW"===e||"\ud604\uae08 \ucd9c\uae08"===e?"text-red-600":t.includes("\ub9e4\uc218")?"text-blue-600":t.includes("\ub9e4\ub3c4")?"text-indigo-600":t.includes("\uac70\ub798\uc138")||t.includes("\uc138\uae08")?"text-yellow-600":"STOCK_BUY"===e?"text-blue-600":"STOCK_SELL"===e?"text-indigo-600":"STOCK_TAX"===e||"TAX_PAYMENT"===e?"text-yellow-600":"GAME_WIN"===e?"text-green-600":"GAME_LOSE"===e?"text-red-600":"text-gray-600"},F=e=>{if(!e)return"-";return(e instanceof Date?e:new Date(e)).toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},O=m.filter(e=>{if(C){var t,s,a;const n=C.toLowerCase();if(!((null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(n))||(null===(s=e.userName)||void 0===s?void 0:s.toLowerCase().includes(n))||(null===(a=e.type)||void 0===a?void 0:a.toLowerCase().includes(n))))return!1}if("all"!==A){var n,i;const t=(null===(n=e.type)||void 0===n?void 0:n.toString())||"",s=(null===(i=e.description)||void 0===i?void 0:i.toString())||"";if("coupon"===A){if(!(["\ucfe0\ud3f0 \ud68d\ub4dd","\ucfe0\ud3f0 \uc0ac\uc6a9","\ucfe0\ud3f0 \uc9c0\uae09","\ucfe0\ud3f0 \ud68c\uc218","\ucfe0\ud3f0 \uc1a1\uae08","\ucfe0\ud3f0 \uc218\uc2e0","\ucfe0\ud3f0 \uae30\ubd80","\ucfe0\ud3f0 \ud310\ub9e4","COUPON_EARN","COUPON_USE","COUPON_GIVE","COUPON_TAKE","COUPON_TRANSFER_SEND","COUPON_TRANSFER_RECEIVE","COUPON_DONATE","COUPON_SELL"].some(e=>t===e)||t.includes("\ucfe0\ud3f0")||s.includes("\ucfe0\ud3f0")))return!1}else if("item"===A){if(!(["\uc544\uc774\ud15c \uad6c\ub9e4","\uc544\uc774\ud15c \uc0ac\uc6a9","\uc544\uc774\ud15c \ud310\ub9e4","\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d","\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4","\uc544\uc774\ud15c \ud68d\ub4dd","\uc544\uc774\ud15c \uc774\ub3d9","ITEM_PURCHASE","ITEM_USE","ITEM_SELL","ITEM_MARKET_LIST","ITEM_MARKET_BUY","ITEM_OBTAIN","ITEM_MOVE"].some(e=>t===e)||t.includes("\uc544\uc774\ud15c")||s.includes("\uc544\uc774\ud15c")))return!1}else if("cash"===A){if(!(t.includes("CASH")||t.includes("\uc1a1\uae08")||t.includes("\uc785\uae08")||t.includes("\ucd9c\uae08")||t.includes("ADMIN_CASH")||t.includes("TRANSFER")||t.includes("\ud604\uae08")))return!1}else if("stock"===A){if(!(t.includes("STOCK")||t.includes("\uc8fc\uc2dd")||t.includes("\uac70\ub798\uc138")||t.includes("TAX")))return!1}else if("game"===A){if(!(t.includes("GAME")||t.includes("\uac8c\uc784")))return!1}}return!0});return(0,h.jsxs)("div",{className:"admin-database p-6",children:[(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"\ud559\uae09 \ub370\uc774\ud130\ubca0\uc774\uc2a4"}),(0,h.jsx)("p",{className:"text-gray-600",children:"\ud559\uae09 \ud559\uc0dd\ub4e4\uc758 \ubaa8\ub4e0 \ud65c\ub3d9 \ub0b4\uc5ed\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})]}),(0,h.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm mb-6",children:[(0,h.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,h.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\ud559\uc0dd \uc120\ud0dd"}),(0,h.jsxs)("select",{value:s,onChange:e=>d(e.target.value),className:"w-full p-2 border rounded-md",children:[(0,h.jsx)("option",{value:"all",children:"\uc804\uccb4 \ud559\uc0dd"}),t&&t.map(e=>(0,h.jsx)("option",{value:e.id||e.id,children:e.name||e.nickname||"\uc774\ub984 \uc5c6\uc74c"},e.id||e.uid))]})]}),(0,h.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\ud65c\ub3d9 \ud0c0\uc785"}),(0,h.jsxs)("select",{value:A,onChange:e=>I(e.target.value),className:"w-full p-2 border rounded-md",children:[(0,h.jsx)("option",{value:"all",children:"\uc804\uccb4 \ud65c\ub3d9"}),(0,h.jsx)("option",{value:"coupon",children:"\ucfe0\ud3f0 \uad00\ub828"}),(0,h.jsx)("option",{value:"item",children:"\uc544\uc774\ud15c \uad00\ub828"}),(0,h.jsx)("option",{value:"cash",children:"\ud604\uae08 \uad00\ub828"}),(0,h.jsx)("option",{value:"stock",children:"\uc8fc\uc2dd \uad00\ub828"}),(0,h.jsx)("option",{value:"game",children:"\uac8c\uc784 \uad00\ub828"})]})]}),(0,h.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\uac80\uc0c9"}),(0,h.jsx)("input",{type:"text",value:C,onChange:e=>S(e.target.value),placeholder:"\ud559\uc0dd\uba85, \ud65c\ub3d9 \ub0b4\uc6a9 \uac80\uc0c9...",className:"w-full p-2 border rounded-md"})]}),(0,h.jsxs)("div",{className:"flex items-end gap-2",children:[(0,h.jsx)("button",{onClick:()=>{(e=>{const t=[];c.forEach((s,a)=>{a.startsWith(e)&&t.push(a)}),t.forEach(e=>c.delete(e)),o.vF.log("[AdminDatabaseService] ".concat(e," \ud559\uae09 \uce90\uc2dc \ucd08\uae30\ud654 \uc644\ub8cc"))})(E),u([]),N(null),v(!1),k(""),T(!0,null)},disabled:x,className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 disabled:bg-gray-300",children:"\uc0c8\ub85c\uace0\uce68"}),(0,h.jsx)("button",{onClick:async()=>{k("\uc870\ud68c \uc911...");try{let e=[];const t={},s={};m.forEach(e=>{const a=e.type||"undefined";t[a]=(t[a]||0)+1,s[a]||(s[a]={description:e.description,userName:e.userName,timestamp:e.timestamp})}),e.push("=== \ud604\uc7ac \ub85c\ub4dc\ub41c \ub370\uc774\ud130 \ud0c0\uc785 \ubd84\ud3ec ==="),e.push("\ucd1d ".concat(m.length,"\uac1c\uc758 \ub85c\uadf8")),e.push(""),Object.entries(t).sort((e,t)=>t[1]-e[1]).forEach(t=>{let[a,n]=t;e.push("".concat(a,": ").concat(n,"\uac1c")),s[a]&&e.push("  \uc608\uc2dc: ".concat(s[a].description)),(a.includes("COUPON")||a.includes("\ucfe0\ud3f0")||a.includes("ITEM")||a.includes("\uc544\uc774\ud15c"))&&e.push("  \u2b50 \ucfe0\ud3f0/\uc544\uc774\ud15c \uad00\ub828 \ud0c0\uc785 \ubc1c\uacac!")}),e.push(""),e.push("=== \ud544\ud130\ubcc4 \ub9e4\uce6d \uacb0\uacfc ===");const a={coupon:e=>{var t,s;const a=(null===(t=e.type)||void 0===t?void 0:t.toString())||"",n=(null===(s=e.description)||void 0===s?void 0:s.toString())||"";return["\ucfe0\ud3f0 \ud68d\ub4dd","\ucfe0\ud3f0 \uc0ac\uc6a9","\ucfe0\ud3f0 \uc9c0\uae09","\ucfe0\ud3f0 \ud68c\uc218","\ucfe0\ud3f0 \uc1a1\uae08","\ucfe0\ud3f0 \uc218\uc2e0","\ucfe0\ud3f0 \uae30\ubd80","\ucfe0\ud3f0 \ud310\ub9e4","COUPON_EARN","COUPON_USE","COUPON_GIVE","COUPON_TAKE","COUPON_TRANSFER_SEND","COUPON_TRANSFER_RECEIVE","COUPON_DONATE","COUPON_SELL"].some(e=>a===e)||a.includes("\ucfe0\ud3f0")||n.includes("\ucfe0\ud3f0")},item:e=>{var t,s;const a=(null===(t=e.type)||void 0===t?void 0:t.toString())||"",n=(null===(s=e.description)||void 0===s?void 0:s.toString())||"";return["\uc544\uc774\ud15c \uad6c\ub9e4","\uc544\uc774\ud15c \uc0ac\uc6a9","\uc544\uc774\ud15c \ud310\ub9e4","\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d","\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4","\uc544\uc774\ud15c \ud68d\ub4dd","\uc544\uc774\ud15c \uc774\ub3d9","ITEM_PURCHASE","ITEM_USE","ITEM_SELL","ITEM_MARKET_LIST","ITEM_MARKET_BUY","ITEM_OBTAIN","ITEM_MOVE"].some(e=>a===e)||a.includes("\uc544\uc774\ud15c")||n.includes("\uc544\uc774\ud15c")},cash:e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("CASH")||s.includes("\uc1a1\uae08")||s.includes("\uc785\uae08")||s.includes("\ucd9c\uae08")||s.includes("ADMIN_CASH")||s.includes("TRANSFER")||s.includes("\ud604\uae08")},stock:e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("STOCK")||s.includes("\uc8fc\uc2dd")||s.includes("\uac70\ub798\uc138")||s.includes("TAX")},game:e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("GAME")||s.includes("\uac8c\uc784")}};Object.entries(a).forEach(t=>{let[s,a]=t;const n=m.filter(e=>a(e));e.push("".concat(s,": ").concat(n.length,"\uac1c"));const i=new Set(n.map(e=>e.type));i.size>0&&e.push("  \ub9e4\uce6d\ub41c \ud0c0\uc785: ".concat(Array.from(i).join(", ")))});const n=e.join("\n");k(n)}catch(b){o.vF.error("[AdminDatabase DEBUG] \uc624\ub958:",b),k("\uc624\ub958: ".concat(b.message))}},className:"px-4 py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600",children:"\ub514\ubc84\uadf8"})]})]}),w&&(0,h.jsxs)("div",{className:"mt-4 p-4 bg-gray-100 rounded-md",children:[(0,h.jsx)("h4",{className:"font-semibold mb-2",children:"\ub514\ubc84\uadf8 \uc815\ubcf4:"}),(0,h.jsx)("pre",{className:"text-xs whitespace-pre-wrap",children:w})]})]}),m.length>0&&(()=>{const e=m.filter(e=>{var t,s;const a=(null===(t=e.type)||void 0===t?void 0:t.toString())||"",n=(null===(s=e.description)||void 0===s?void 0:s.toString())||"";return["\ucfe0\ud3f0 \ud68d\ub4dd","\ucfe0\ud3f0 \uc0ac\uc6a9","\ucfe0\ud3f0 \uc9c0\uae09","\ucfe0\ud3f0 \ud68c\uc218","\ucfe0\ud3f0 \uc1a1\uae08","\ucfe0\ud3f0 \uc218\uc2e0","\ucfe0\ud3f0 \uae30\ubd80","\ucfe0\ud3f0 \ud310\ub9e4","COUPON_EARN","COUPON_USE","COUPON_GIVE","COUPON_TAKE","COUPON_TRANSFER_SEND","COUPON_TRANSFER_RECEIVE","COUPON_DONATE","COUPON_SELL"].some(e=>a===e)||a.includes("\ucfe0\ud3f0")||n.includes("\ucfe0\ud3f0")}).length,t=m.filter(e=>{var t,s;const a=(null===(t=e.type)||void 0===t?void 0:t.toString())||"",n=(null===(s=e.description)||void 0===s?void 0:s.toString())||"";return["\uc544\uc774\ud15c \uad6c\ub9e4","\uc544\uc774\ud15c \uc0ac\uc6a9","\uc544\uc774\ud15c \ud310\ub9e4","\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d","\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4","\uc544\uc774\ud15c \ud68d\ub4dd","\uc544\uc774\ud15c \uc774\ub3d9","ITEM_PURCHASE","ITEM_USE","ITEM_SELL","ITEM_MARKET_LIST","ITEM_MARKET_BUY","ITEM_OBTAIN","ITEM_MOVE"].some(e=>a===e)||a.includes("\uc544\uc774\ud15c")||n.includes("\uc544\uc774\ud15c")}).length,s=m.filter(e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("CASH")||s.includes("\uc1a1\uae08")||s.includes("\uc785\uae08")||s.includes("\ucd9c\uae08")||s.includes("ADMIN_CASH")||s.includes("TRANSFER")}).length,a=m.filter(e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("STOCK")||s.includes("\uc8fc\uc2dd")||s.includes("\uac70\ub798\uc138")||s.includes("TAX")}).length,n=m.filter(e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("GAME")||s.includes("\uac8c\uc784")}).length;return(0,h.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm mb-6",children:[(0,h.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"\ud65c\ub3d9 \ud1b5\uacc4 (\ud074\ub9ad\ud558\uc5ec \ud544\ud130)"}),(0,h.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,h.jsxs)("div",{className:"bg-blue-50 p-3 rounded cursor-pointer hover:shadow-md transition-shadow",onClick:()=>I("all"),children:[(0,h.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\uc804\uccb4 \ud65c\ub3d9"}),(0,h.jsx)("div",{className:"text-xl font-bold text-blue-600",children:m.length})]}),(0,h.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(e>0?"bg-green-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>e>0&&I("coupon"),title:0===e?"\uc544\uc9c1 \ucfe0\ud3f0 \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \ucfe0\ud3f0 \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,h.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\ucfe0\ud3f0 \uad00\ub828"}),(0,h.jsx)("div",{className:"text-xl font-bold ".concat(e>0?"text-green-600":"text-gray-400"),children:e})]}),(0,h.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(t>0?"bg-purple-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>t>0&&I("item"),title:0===t?"\uc544\uc9c1 \uc544\uc774\ud15c \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \uc544\uc774\ud15c \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,h.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\uc544\uc774\ud15c \uad00\ub828"}),(0,h.jsx)("div",{className:"text-xl font-bold ".concat(t>0?"text-purple-600":"text-gray-400"),children:t})]}),(0,h.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(s>0?"bg-yellow-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>s>0&&I("cash"),title:0===s?"\uc544\uc9c1 \ud604\uae08 \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \ud604\uae08 \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,h.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\ud604\uae08 \uad00\ub828"}),(0,h.jsx)("div",{className:"text-xl font-bold ".concat(s>0?"text-yellow-600":"text-gray-400"),children:s})]}),(0,h.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(a>0?"bg-indigo-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>a>0&&I("stock"),title:0===a?"\uc544\uc9c1 \uc8fc\uc2dd \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \uc8fc\uc2dd \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,h.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\uc8fc\uc2dd \uad00\ub828"}),(0,h.jsx)("div",{className:"text-xl font-bold ".concat(a>0?"text-indigo-600":"text-gray-400"),children:a})]}),(0,h.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(n>0?"bg-red-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>n>0&&I("game"),title:0===n?"\uc544\uc9c1 \uac8c\uc784 \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \uac8c\uc784 \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,h.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\uac8c\uc784 \uad00\ub828"}),(0,h.jsx)("div",{className:"text-xl font-bold ".concat(n>0?"text-red-600":"text-gray-400"),children:n})]})]})]})})(),(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"\uc804\uccb4 \ud65c\ub3d9 \ub0b4\uc5ed"}),(0,h.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"\uc2dc\uac04\uc21c\uc73c\ub85c \uc815\ub82c\ub41c \ubaa8\ub4e0 \ud65c\ub3d9\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})]}),b&&(0,h.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:b}),x&&0===m.length&&(0,h.jsxs)("div",{className:"text-center py-12",children:[(0,h.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,h.jsx)("p",{className:"mt-4 text-gray-600",children:"\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})]}),!x||m.length>0?(0,h.jsx)("div",{children:0===O.length?(0,h.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,h.jsx)("p",{className:"text-lg mb-2",children:C?"\uac80\uc0c9 \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.":"\ud65c\ub3d9 \ub0b4\uc5ed\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,h.jsxs)("p",{className:"text-sm",children:["\uc804\uccb4 \ub370\uc774\ud130: ",m.length,"\uac1c"]})]}):(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{className:"text-sm text-gray-600 mb-4",children:["\ucd1d ",O.length,"\uac1c\uc758 \ud65c\ub3d9 (\uac80\uc0c9: ",m.length,"\uac1c \uc911)"]}),O.map((e,t)=>{return(0,h.jsx)("div",{className:"bg-white border-2 border-gray-300 rounded-lg p-4 hover:shadow-lg transition-shadow",children:(0,h.jsx)("div",{className:"flex justify-between items-start",children:(0,h.jsxs)("div",{className:"flex-1",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,h.jsx)("span",{className:"font-bold text-base ".concat(M(e.type)),children:(s=e.type,{"\ucfe0\ud3f0 \ud68d\ub4dd":"\ucfe0\ud3f0 \ud68d\ub4dd","\ucfe0\ud3f0 \uc0ac\uc6a9":"\ucfe0\ud3f0 \uc0ac\uc6a9","\ucfe0\ud3f0 \uc9c0\uae09":"\ucfe0\ud3f0 \uc9c0\uae09","\ucfe0\ud3f0 \ud68c\uc218":"\ucfe0\ud3f0 \ud68c\uc218","\uc544\uc774\ud15c \uad6c\ub9e4":"\uc544\uc774\ud15c \uad6c\ub9e4","\uc544\uc774\ud15c \uc0ac\uc6a9":"\uc544\uc774\ud15c \uc0ac\uc6a9","\uc544\uc774\ud15c \ud310\ub9e4":"\uc544\uc774\ud15c \ud310\ub9e4","\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d":"\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d","\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4":"\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4","\uc8fc\uc2dd \ub9e4\uc218":"\uc8fc\uc2dd \ub9e4\uc218","\uc8fc\uc2dd \ub9e4\ub3c4":"\uc8fc\uc2dd \ub9e4\ub3c4","\uc8fc\uc2dd \uac70\ub798\uc138":"\uc8fc\uc2dd \uac70\ub798\uc138","\uac70\ub798\uc138":"\uc8fc\uc2dd \uac70\ub798\uc138","\uc1a1\uae08":"\uc1a1\uae08","\uc1a1\uae08 \uc218\uc2e0":"\uc1a1\uae08 \uc218\uc2e0","\ub3c8 \uc1a1\uae08":"\uc1a1\uae08","\ub3c8 \ucd9c\uae08":"\ucd9c\uae08","\ub3c8 \uc785\uae08":"\uc785\uae08","\ud604\uae08 \ucd9c\uae08":"\ucd9c\uae08","\ud604\uae08 \uc785\uae08":"\uc785\uae08",COUPON_EARN:"\ucfe0\ud3f0 \ud68d\ub4dd",COUPON_USE:"\ucfe0\ud3f0 \uc0ac\uc6a9",COUPON_GIVE:"\ucfe0\ud3f0 \uc9c0\uae09",COUPON_TAKE:"\ucfe0\ud3f0 \ud68c\uc218",COUPON_TRANSFER_SEND:"\ucfe0\ud3f0 \uc1a1\uae08",COUPON_TRANSFER_RECEIVE:"\ucfe0\ud3f0 \uc218\uc2e0",ITEM_PURCHASE:"\uc544\uc774\ud15c \uad6c\ub9e4",ITEM_USE:"\uc544\uc774\ud15c \uc0ac\uc6a9",ITEM_SELL:"\uc544\uc774\ud15c \ud310\ub9e4",ITEM_MARKET_LIST:"\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d",ITEM_MARKET_BUY:"\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4",CASH_TRANSFER_SEND:"\uc1a1\uae08",CASH_TRANSFER_RECEIVE:"\uc1a1\uae08 \uc218\uc2e0",CASH_WITHDRAW:"\ucd9c\uae08",CASH_DEPOSIT:"\uc785\uae08",STOCK_BUY:"\uc8fc\uc2dd \ub9e4\uc218",STOCK_SELL:"\uc8fc\uc2dd \ub9e4\ub3c4",STOCK_TAX:"\uc8fc\uc2dd \uac70\ub798\uc138",TAX_PAYMENT:"\uc8fc\uc2dd \uac70\ub798\uc138",ADMIN_CASH_SEND:"\uad00\ub9ac\uc790 \uc9c0\uae09",ADMIN_CASH_TAKE:"\uad00\ub9ac\uc790 \ud68c\uc218",ADMIN_COUPON_GIVE:"\uad00\ub9ac\uc790 \ucfe0\ud3f0 \uc9c0\uae09",ADMIN_COUPON_TAKE:"\uad00\ub9ac\uc790 \ucfe0\ud3f0 \ud68c\uc218",TASK_COMPLETE:"\uacfc\uc81c \uc644\ub8cc",GAME_WIN:"\uac8c\uc784 \uc2b9\ub9ac",GAME_LOSE:"\uac8c\uc784 \ud328\ubc30"}[s]||s)}),(0,h.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.userName||"\uc54c \uc218 \uc5c6\uc74c"}),(0,h.jsx)("span",{className:"text-xs text-gray-500",children:F(e.timestamp)})]}),(0,h.jsx)("p",{className:"text-gray-800 text-sm mb-2 font-medium",children:e.description||"\uc124\uba85 \uc5c6\uc74c"}),e.metadata&&Object.keys(e.metadata).length>0&&(0,h.jsxs)("div",{className:"bg-gray-50 p-3 rounded text-sm text-gray-700 border border-gray-200",children:[e.metadata.activity&&(0,h.jsxs)("div",{className:"mb-1",children:[(0,h.jsx)("strong",{children:"\ud65c\ub3d9:"})," ",e.metadata.activity]}),e.metadata.reason&&(0,h.jsxs)("div",{className:"mb-1",children:[(0,h.jsx)("strong",{children:"\uc0ac\uc720:"})," ",e.metadata.reason]}),e.metadata.itemName&&(0,h.jsxs)("div",{className:"mb-1",children:[(0,h.jsx)("strong",{children:"\uc544\uc774\ud15c:"})," ",e.metadata.itemName]}),e.metadata.quantity&&(0,h.jsxs)("div",{className:"mb-1",children:[(0,h.jsx)("strong",{children:"\uc218\ub7c9:"})," ",e.metadata.quantity]}),void 0!==e.metadata.amount&&(0,h.jsxs)("div",{className:"mb-1",children:[(0,h.jsx)("strong",{children:"\uae08\uc561:"})," ",e.metadata.amount.toLocaleString(),"\uc6d0"]}),void 0!==e.metadata.couponAmount&&(0,h.jsxs)("div",{className:"mb-1",children:[(0,h.jsx)("strong",{children:"\ucfe0\ud3f0:"})," ",e.metadata.couponAmount,"\uac1c"]})]})]})})},e.id||t);var s}),y&&(0,h.jsx)("div",{className:"text-center py-4",children:(0,h.jsx)("button",{onClick:D,disabled:x,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300",children:x?"\ub85c\ub529 \uc911...":"\ub354\ubcf4\uae30"})})]})}):null]})}},6353(){},6555(e,t,s){s.d(t,{Gu:()=>r,LN:()=>i,pp:()=>o,rA:()=>d,zY:()=>l});s(5043);var a=s(2024),n=(s(5881),s(579));const i=e=>{let{children:t,className:s=""}=e;return(0,n.jsx)("div",{className:"min-h-full w-full bg-[#0a0a12] ".concat(s),children:(0,n.jsx)("div",{className:"w-full max-w-none px-2 md:px-3 lg:px-4 py-1 md:py-2",children:t})})},l=e=>{let{title:t,subtitle:s,icon:a,badge:i,action:l,backButton:r,className:o=""}=e;return(0,n.jsxs)("section",{className:"bg-[#14142380] backdrop-blur-sm rounded-lg px-3 py-1.5 md:px-4 md:py-2 shadow-lg border border-cyan-900/30 flex flex-col md:flex-row md:items-center justify-between gap-1.5 md:gap-2 mb-2 md:mb-3 ".concat(o),children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[r,a&&(0,n.jsx)("div",{className:"w-9 h-9 md:w-10 md:h-10 bg-cyan-900/30 rounded-lg flex items-center justify-center text-cyan-400 shrink-0 shadow-sm border border-cyan-500/30",children:(0,n.jsx)(a,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("h2",{className:"text-lg md:text-xl font-bold text-white tracking-tight",children:t}),i]}),s&&(0,n.jsx)("p",{className:"text-xs md:text-sm text-slate-400 font-medium",children:s})]})]}),l&&(0,n.jsx)("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 md:ml-auto",children:l})]})},r=e=>{let{message:t="\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."}=e;return null},o=e=>{let{icon:t,title:s,description:a,action:i}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[t&&(0,n.jsx)("div",{className:"w-16 h-16 rounded-full bg-[#14142380] shadow-lg flex items-center justify-center mb-4 border border-cyan-900/30",children:(0,n.jsx)(t,{className:"w-8 h-8 text-slate-400"})}),s&&(0,n.jsx)("h3",{className:"text-lg font-bold text-slate-300 mb-2",children:s}),a&&(0,n.jsx)("p",{className:"text-slate-500 font-medium mb-6 max-w-md",children:a}),i]})},d=e=>{let{children:t,icon:s,variant:i="primary",size:l="md",loading:r=!1,disabled:o=!1,onClick:d,className:c="",title:m}=e;return(0,n.jsxs)("button",{onClick:d,disabled:o||r,title:m,className:"inline-flex items-center justify-center gap-2 font-bold rounded-xl transition-all duration-200 active:scale-95 whitespace-nowrap focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ".concat({primary:"bg-cyan-500 text-slate-900 hover:bg-cyan-400 ring-1 ring-cyan-400 shadow-cyan-500/30",secondary:"bg-slate-800 hover:bg-slate-700 text-slate-200",outline:"bg-transparent text-slate-300 ring-1 ring-slate-600 hover:bg-slate-800 hover:ring-slate-500 shadow-sm","outline-green":"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm","outline-red":"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm",danger:"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm",success:"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm",ghost:"text-slate-400 hover:bg-slate-800 hover:text-white",indigo:"bg-purple-900/30 text-purple-400 hover:bg-purple-900/50"}[i]," ").concat({sm:"px-4 py-2 text-sm",md:"px-5 py-2.5 text-sm",lg:"px-6 py-3 text-base"}[l]," ").concat(c),children:[r?(0,n.jsx)(a.A,{className:"w-4 h-4 animate-spin"}):s?(0,n.jsx)(s,{className:"w-4 h-4"}):null,t]})}},8164(e,t,s){s.r(t),s.d(t,{default:()=>o});var a=s(2555),n=s(5043),i=s(579);const l={"\uc74c\uc2dd":["\ud83c\udf55","\ud83c\udf54","\ud83c\udf5f","\ud83c\udf2d","\ud83e\udd50","\ud83e\udd56","\ud83e\uddc0","\ud83c\udf56","\ud83c\udf57","\ud83e\udd53","\ud83c\udf73","\ud83e\udd5e"],"\uc74c\ub8cc":["\u2615","\ud83c\udf75","\ud83e\uddc3","\ud83e\udd64","\ud83e\uddcb","\ud83c\udf7a","\ud83c\udf77","\ud83e\udd5b","\ud83c\udf79","\ud83c\udf78","\ud83c\udf7e","\ud83e\uddc9"],"\uacfc\uc77c":["\ud83c\udf4e","\ud83c\udf4a","\ud83c\udf4b","\ud83c\udf4c","\ud83c\udf49","\ud83c\udf47","\ud83c\udf53","\ud83e\uded0","\ud83c\udf48","\ud83c\udf52","\ud83c\udf51","\ud83e\udd6d"],"\ucc44\uc18c":["\ud83e\udd66","\ud83e\udd6c","\ud83e\udd52","\ud83c\udf3d","\ud83e\udd55","\ud83e\uded1","\ud83c\udf36\ufe0f","\ud83e\udd54","\ud83c\udf60","\ud83e\uddc4","\ud83e\uddc5","\ud83c\udf44"],"\ub514\uc800\ud2b8":["\ud83c\udf70","\ud83c\udf82","\ud83e\uddc1","\ud83e\udd67","\ud83c\udf6e","\ud83c\udf6d","\ud83c\udf6c","\ud83c\udf6b","\ud83c\udf69","\ud83c\udf6a","\ud83c\udf66","\ud83e\uddca"],"\ubb34\uae30":["\u2694\ufe0f","\ud83d\udde1\ufe0f","\ud83c\udff9","\ud83d\udee1\ufe0f","\ud83e\ude93","\ud83d\udd2b","\ud83d\udca3","\ud83e\udde8","\ud83e\ude83","\ud83e\udd4a","\ud83c\udfaf","\ud83c\udfcf"],"\ub9c8\ubc95":["\u2728","\ud83d\udcab","\u2b50","\ud83c\udf1f","\ud83d\udca5","\u26a1","\ud83d\udd25","\u2744\ufe0f","\ud83d\udca7","\ud83c\udf0a","\ud83c\udf2a\ufe0f","\u2604\ufe0f"],"\ubcf4\ubb3c":["\ud83d\udc8e","\ud83d\udc8d","\ud83d\udc51","\ud83c\udfc6","\ud83c\udf81","\ud83d\udcb0","\ud83d\udcb5","\ud83e\ude99","\ud83d\udd2e","\ud83d\udcff","\ud83d\udddd\ufe0f","\ud83c\udf96\ufe0f"],"\ub3c4\uad6c":["\ud83d\udd28","\ud83e\ude9b","\ud83d\udd27","\ud83e\ude9a","\u26cf\ufe0f","\ud83e\ude9d","\ud83e\uddf2","\ud83d\udd29","\u2699\ufe0f","\ud83d\udddc\ufe0f","\u2696\ufe0f","\ud83d\udd26"],"\uc758\ub8cc":["\ud83d\udc8a","\ud83d\udc89","\ud83e\ude79","\ud83e\ude7a","\ud83e\uddea","\ud83e\uddeb","\ud83e\ude78","\ud83e\udda0","\ud83e\uddec","\ud83d\udd2c","\u2697\ufe0f","\ud83c\udf21\ufe0f"],"\uc790\uc5f0":["\ud83c\udf38","\ud83c\udf3a","\ud83c\udf3b","\ud83c\udf39","\ud83c\udf37","\ud83c\udf31","\ud83c\udf3f","\ud83c\udf40","\ud83c\udf8b","\ud83c\udf8d","\ud83c\udf3e","\ud83c\udf34"],"\ud2b9\ubcc4":["\ud83c\udfaa","\ud83c\udfa8","\ud83c\udfad","\ud83c\udfaa","\ud83c\udfaf","\ud83c\udfb2","\ud83c\udfb0","\ud83e\udde9","\ud83e\ude84","\ud83d\udd14","\ud83d\udcef","\ud83e\udd41"],"\uc2e0\uaddc":["\ud83c\udd95","\u2705","\u274c","\u2753","\u2757","\ud83d\udcaf","\ud83d\udd36","\ud83d\udd37","\ud83d\udd38","\ud83d\udd39","\u2660\ufe0f","\u2663\ufe0f"]},r={container:{padding:"20px",maxWidth:"1000px",margin:"0 auto",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},card:{backgroundColor:"#ffffff",borderRadius:"16px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",padding:"30px",marginBottom:"20px"},header:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"30px",borderRadius:"16px 16px 0 0",marginBottom:"0"},title:{fontSize:"28px",fontWeight:"bold",marginBottom:"8px"},subtitle:{opacity:"0.9",fontSize:"14px"},tabs:{display:"flex",borderBottom:"2px solid #e5e7eb",backgroundColor:"#f9fafb",marginTop:"-4px"},tab:{flex:1,padding:"16px",backgroundColor:"transparent",border:"none",fontSize:"16px",fontWeight:"600",color:"#6b7280",cursor:"pointer",transition:"all 0.3s ease",borderBottom:"3px solid transparent"},activeTab:{color:"#667eea",backgroundColor:"white",borderBottom:"3px solid #667eea"},disabledTab:{opacity:"0.5",cursor:"not-allowed"},formSection:{backgroundColor:"#f9fafb",padding:"20px",borderRadius:"12px",marginBottom:"20px"},formTitle:{fontSize:"20px",fontWeight:"700",color:"#374151",marginBottom:"20px"},inputGroup:{marginBottom:"20px"},label:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},input:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",transition:"border-color 0.3s ease",boxSizing:"border-box"},textarea:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",minHeight:"100px",resize:"vertical",boxSizing:"border-box"},gridTwo:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"20px"},iconSelector:{backgroundColor:"white",padding:"20px",borderRadius:"12px",border:"2px solid #e5e7eb"},selectedIcon:{fontSize:"48px",width:"80px",height:"80px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",borderRadius:"12px",marginBottom:"16px"},button:{padding:"12px 24px",borderRadius:"8px",border:"none",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease"},primaryButton:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},secondaryButton:{backgroundColor:"white",color:"#374151",border:"2px solid #e5e7eb"},iconGrid:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"8px",marginTop:"16px"},iconButton:{fontSize:"28px",padding:"8px",border:"2px solid transparent",borderRadius:"8px",backgroundColor:"#f9fafb",cursor:"pointer",transition:"all 0.2s ease"},categoryButtons:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"16px"},categoryButton:{padding:"8px 16px",borderRadius:"8px",border:"2px solid #e5e7eb",backgroundColor:"white",fontSize:"13px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},activeCategoryButton:{backgroundColor:"#667eea",color:"white",borderColor:"#667eea"},priceIncreaseSection:{backgroundColor:"#fef3c7",border:"2px solid #fcd34d",padding:"20px",borderRadius:"12px",marginBottom:"20px"},helpText:{fontSize:"13px",color:"#6b7280",marginTop:"8px",lineHeight:"1.5"},checkboxWrapper:{display:"flex",alignItems:"center",gap:"12px"},checkbox:{width:"20px",height:"20px",cursor:"pointer"},buttonGroup:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"30px",paddingTop:"20px",borderTop:"2px solid #e5e7eb"}},o=e=>{let{classCode:t,editingItemFromStore:s,onAddItem:o,onUpdateItem:d,onClose:c}=e;const[m,u]=(0,n.useState)("addItem"),[x,p]=(0,n.useState)(!1),[h,g]=(0,n.useState)("\ub9c8\ubc95"),[b,f]=(0,n.useState)({name:"",description:"",price:"",stock:"",initialStock:"",icon:"\u2728",available:!0,priceIncreasePercentage:"10"});(0,n.useEffect)(()=>{s?(f((0,a.A)((0,a.A)({},s),{},{priceIncreasePercentage:s.priceIncreasePercentage||"10"})),u("editItem")):f({name:"",description:"",price:"",stock:"",initialStock:"",icon:"\u2728",available:!0,priceIncreasePercentage:"10"})},[s]);const y=e=>{const{name:t,value:s,type:n,checked:i}=e.target;f(e=>(0,a.A)((0,a.A)({},e),{},{[t]:"checkbox"===n?i:s}))},v=e=>{u(e),s&&c(),"addItem"===e&&f({name:"",description:"",price:"",stock:"",initialStock:"",icon:"\u2728",available:!0,priceIncreasePercentage:"10"})};return(0,i.jsx)("div",{style:r.container,children:(0,i.jsxs)("div",{style:r.card,children:[(0,i.jsxs)("div",{style:r.header,children:[(0,i.jsx)("h2",{style:r.title,children:"\ud83c\udfea \uc0c1\uc810 \uad00\ub9ac \uc2dc\uc2a4\ud15c"}),(0,i.jsx)("p",{style:r.subtitle,children:"\uc544\uc774\ud15c\uc744 \ucd94\uac00\ud558\uace0 \uad00\ub9ac\ud558\uc138\uc694"})]}),(0,i.jsxs)("div",{style:r.tabs,children:[(0,i.jsx)("button",{style:(0,a.A)((0,a.A)({},r.tab),"addItem"===m?r.activeTab:{}),onClick:()=>v("addItem"),children:"\u2795 \uc544\uc774\ud15c \ucd94\uac00"}),(0,i.jsx)("button",{style:(0,a.A)((0,a.A)((0,a.A)({},r.tab),"editItem"===m?r.activeTab:{}),s?{}:r.disabledTab),disabled:!s,onClick:()=>u("editItem"),children:"\u270f\ufe0f \uc544\uc774\ud15c \uc218\uc815"})]}),(0,i.jsx)("div",{style:{padding:"30px"},children:("addItem"===m||"editItem"===m)&&(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const s=!(!b||!b.id);if(!b.name||!b.price||!b.stock||isNaN(b.price)||isNaN(b.stock)||parseInt(b.price,10)<0||parseInt(b.stock,10)<0)return void alert("\uc0c1\ud488\uba85, \uac00\uaca9, \uc7ac\uace0\ub97c \uc62c\ubc14\ub974\uac8c (0 \uc774\uc0c1 \uc22b\uc790) \uc785\ub825\ud574\uc8fc\uc138\uc694.");const n=(0,a.A)((0,a.A)({},b),{},{price:parseInt(b.price,10),stock:parseInt(b.stock,10),initialStock:b.initialStock?parseInt(b.initialStock,10):parseInt(b.stock,10),priceIncreasePercentage:parseFloat(b.priceIncreasePercentage)||0,classCode:t});let i=!1;i=s?await d(n):await o(n),i&&(s||(f({name:"",description:"",price:"",stock:"",initialStock:"",icon:"\u2728",available:!0,priceIncreasePercentage:"10"}),u("addItem")))},children:[(0,i.jsxs)("div",{style:r.formSection,children:[(0,i.jsx)("h3",{style:r.formTitle,children:"editItem"===m?"\uc544\uc774\ud15c \uc815\ubcf4 \uc218\uc815":"\uc0c8 \uc544\uc774\ud15c \ub9cc\ub4e4\uae30"}),(0,i.jsxs)("div",{style:r.iconSelector,children:[(0,i.jsx)("label",{style:r.label,children:"\uc544\uc774\ud15c \uc544\uc774\ucf58"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,i.jsx)("div",{style:r.selectedIcon,children:b.icon}),(0,i.jsx)("button",{type:"button",onClick:()=>p(!x),style:(0,a.A)((0,a.A)({},r.button),r.primaryButton),children:"\uc544\uc774\ucf58 \uc120\ud0dd"})]}),x&&(0,i.jsxs)("div",{style:{marginTop:"20px",padding:"16px",backgroundColor:"#f9fafb",borderRadius:"8px",width:"100%",boxSizing:"border-box",maxHeight:"400px",overflowY:"auto"},children:[(0,i.jsx)("div",{style:r.categoryButtons,children:Object.keys(l).map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>g(e),style:(0,a.A)((0,a.A)({},r.categoryButton),h===e?r.activeCategoryButton:{}),children:e},e))}),(0,i.jsx)("div",{style:r.iconGrid,children:l[h].map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{f(t=>(0,a.A)((0,a.A)({},t),{},{icon:e})),p(!1)})(e),style:r.iconButton,onMouseEnter:e=>{e.target.style.backgroundColor="#e5e7eb",e.target.style.transform="scale(1.1)"},onMouseLeave:e=>{e.target.style.backgroundColor="#f9fafb",e.target.style.transform="scale(1)"},children:e},e))})]})]}),(0,i.jsxs)("div",{style:r.gridTwo,children:[(0,i.jsxs)("div",{style:r.inputGroup,children:[(0,i.jsxs)("label",{style:r.label,children:["\uc0c1\ud488\uba85 ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("input",{name:"name",value:b.name,onChange:y,placeholder:"\uc608: \ub9c8\ubc95\uc758 \ubb3c\uc57d",required:!0,style:r.input})]}),(0,i.jsxs)("div",{style:r.inputGroup,children:[(0,i.jsxs)("label",{style:r.label,children:["\uae30\ubcf8 \uac00\uaca9 (\uc6d0) ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("input",{name:"price",type:"number",value:b.price,onChange:y,placeholder:"\uc608: 1000",required:!0,min:"0",style:r.input})]}),(0,i.jsxs)("div",{style:r.inputGroup,children:[(0,i.jsxs)("label",{style:r.label,children:["\ud604\uc7ac \uc7ac\uace0 ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("input",{name:"stock",type:"number",value:b.stock,onChange:y,placeholder:"\uc608: 10",required:!0,min:"0",style:r.input})]}),(0,i.jsxs)("div",{style:r.inputGroup,children:[(0,i.jsx)("label",{style:r.label,children:"\ucd08\uae30 \uc7ac\uace0 (\uc790\ub3d9 \ubcf4\ucda9 \uae30\uc900)"}),(0,i.jsx)("input",{name:"initialStock",type:"number",value:b.initialStock,onChange:y,placeholder:"\ubbf8\uc785\ub825\uc2dc \ud604\uc7ac \uc7ac\uace0\uc640 \ub3d9\uc77c",min:"0",style:r.input})]})]}),(0,i.jsxs)("div",{style:r.priceIncreaseSection,children:[(0,i.jsx)("label",{style:r.label,children:"\uc790\ub3d9 \uc7ac\uace0 \ubcf4\ucda9 \uc2dc \uac00\uaca9 \uc0c1\uc2b9\ub960 (%)"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,i.jsx)("input",{name:"priceIncreasePercentage",type:"number",value:b.priceIncreasePercentage,onChange:y,placeholder:"10",min:"0",max:"100",step:"0.5",style:(0,a.A)((0,a.A)({},r.input),{},{width:"120px"})}),(0,i.jsx)("span",{style:{fontSize:"16px",color:"#374151"},children:"%"})]}),(0,i.jsxs)("p",{style:r.helpText,children:["\ud83d\udca1 \uc7ac\uace0\uac00 0\uc774 \ub418\uc5b4 \uc790\ub3d9\uc73c\ub85c \ucd08\uae30 \uc7ac\uace0\ub9cc\ud07c \ubcf4\ucda9\ub420 \ub54c\ub9c8\ub2e4 \uac00\uaca9\uc774 \uc124\uc815\ud55c \ube44\uc728\ub9cc\ud07c \uc0c1\uc2b9\ud569\ub2c8\ub2e4.",(0,i.jsx)("br",{}),"\uc608: 10% \uc124\uc815 \uc2dc, 1000\uc6d0 \u2192 1100\uc6d0 \u2192 1210\uc6d0 \uc21c\uc73c\ub85c \uc0c1\uc2b9"]})]}),(0,i.jsxs)("div",{style:r.inputGroup,children:[(0,i.jsx)("label",{style:r.label,children:"\uc0c1\ud488 \uc124\uba85"}),(0,i.jsx)("textarea",{name:"description",value:b.description,onChange:y,placeholder:"\uc544\uc774\ud15c\uc5d0 \ub300\ud55c \uc790\uc138\ud55c \uc124\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",style:r.textarea})]})]}),(0,i.jsxs)("div",{style:r.buttonGroup,children:[(0,i.jsxs)("div",{style:r.checkboxWrapper,children:[(0,i.jsx)("input",{type:"checkbox",name:"available",checked:b.available,onChange:y,style:r.checkbox}),(0,i.jsx)("label",{style:{fontSize:"16px",fontWeight:"500"},children:b.available?"\ud83d\udfe2 \ud310\ub9e4\uc911":"\ud83d\udd34 \ud310\ub9e4\uc911\uc9c0"})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px"},children:["editItem"===m&&(0,i.jsx)("button",{type:"button",onClick:()=>v("addItem"),style:(0,a.A)((0,a.A)({},r.button),r.secondaryButton),children:"\ucde8\uc18c"}),(0,i.jsx)("button",{type:"submit",style:(0,a.A)((0,a.A)({},r.button),r.primaryButton),children:"editItem"===m?"\u2705 \uc218\uc815 \uc644\ub8cc":"\u2795 \uc544\uc774\ud15c \ucd94\uac00"})]})]})]})})]})})}},8343(e,t,s){s.d(t,{FR:()=>a,bL:()=>n});const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(null===e||void 0===e||""===e)return"0"+t;let s=e;if("string"===typeof s&&(s=s.replace(/[,\uc6d0\uac1c]/g,"").trim(),s=parseFloat(s),isNaN(s)))return"0"+t;if(0===s)return"0"+t;const a=s<0,n=[{value:1e20,name:"\ub2e8"},{value:1e16,name:"\uacbd"},{value:1e12,name:"\uc870"},{value:1e8,name:"\uc5b5"},{value:1e4,name:"\ub9cc"}],i=[];let l=Math.abs(s);for(const{value:o,name:d}of n)if(l>=o){const e=Math.floor(l/o);i.push("".concat(e).concat(d)),l%=o}l>0&&(l%1!==0?i.push(l.toLocaleString("ko-KR",{maximumFractionDigits:2})):i.push(Math.floor(l)));let r=i.join(" ");return t&&(r+=t),a&&(r="-"+r),r},n=e=>a(e,"\uc6d0")},8719(e,t,s){s.d(t,{px:()=>x,wB:()=>u});var a=s(2555),n=s(5043),i=s(5016),l=s(2419),r=s(577),o=s(9270),d=s(5452),c=s(579);const m=(0,n.createContext)(null),u=()=>{const e=(0,n.useContext)(m);return e||(d.vF.warn("useItems: ItemContext \ubc94\uc704 \ubc16\uc5d0\uc11c \uc0ac\uc6a9\ub428"),{items:[],userItems:[],marketListings:[],marketOffers:[],loading:!0,error:null,addItem:async()=>({success:!1,message:"Context not available"}),purchaseItem:async()=>({success:!1,message:"Context not available"}),updateItem:async()=>({success:!1,message:"Context not available"}),deleteItem:async()=>({success:!1,message:"Context not available"}),useItem:async()=>({success:!1,message:"Context not available"}),updateUserItemQuantity:async()=>({success:!1,message:"Context not available"}),listItemForSale:async()=>({success:!1,message:"Context not available"}),buyMarketItem:async()=>({success:!1,message:"Context not available"}),cancelSale:async()=>({success:!1,message:"Context not available"}),makeOffer:async()=>({success:!1,message:"Context not available"}),respondToOffer:async()=>({success:!1,message:"Context not available"}),adminCancelSale:async()=>({success:!1,message:"Context not available"}),adminDeleteItem:async()=>({success:!1,message:"Context not available"}),refreshData:async()=>{}})},x=e=>{let{children:t}=e;const{user:s,userDoc:u,isAdmin:x,loading:p,deductCash:h,addCash:g,optimisticUpdate:b}=(0,i.As)()||{},f=null===s||void 0===s?void 0:s.uid,y=null===u||void 0===u?void 0:u.classCode,[v,j]=(0,n.useState)([]),[N,w]=(0,n.useState)([]),[k,C]=(0,n.useState)([]),[S,A]=(0,n.useState)([]),[I,E]=(0,n.useState)(!0),[T,D]=(0,n.useState)(null),M=p||I,F=(0,n.useMemo)(()=>(0,l.Qg)(l.Cn,"getItemContextData"),[]),O=(0,n.useMemo)(()=>({addStoreItem:(0,l.Qg)(l.Cn,"addStoreItem"),updateStoreItem:(0,l.Qg)(l.Cn,"updateStoreItem"),deleteStoreItem:(0,l.Qg)(l.Cn,"deleteStoreItem"),purchaseStoreItem:(0,l.Qg)(l.Cn,"purchaseStoreItem"),useUserItem:(0,l.Qg)(l.Cn,"useUserItem"),updateUserItemQuantity:(0,l.Qg)(l.Cn,"updateUserItemQuantity"),listUserItemForSale:(0,l.Qg)(l.Cn,"listUserItemForSale"),buyMarketItem:(0,l.Qg)(l.Cn,"buyMarketItem"),cancelMarketSale:(0,l.Qg)(l.Cn,"cancelMarketSale"),makeOffer:(0,l.Qg)(l.Cn,"makeOffer"),respondToOffer:(0,l.Qg)(l.Cn,"respondToOffer"),adminCancelSale:(0,l.Qg)(l.Cn,"adminCancelSale"),adminDeleteItem:(0,l.Qg)(l.Cn,"adminDeleteItem")}),[]),_=(0,n.useCallback)(async()=>{if(f&&y){E(!0);try{const e=await F();if(!e.data.success)throw new Error(e.data.message||"\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");{const{storeItems:t,userItems:s,marketListings:a,marketOffers:n}=e.data.data;j(t||[]),w(s||[]),C(a||[]),A(n||[]),D(null)}}catch(e){d.vF.error("[ItemContext] \ub370\uc774\ud130 \ub85c\ub4dc \uc624\ub958:",e),D(e)}finally{E(!1)}}else E(!1)},[f,y,F]);(0,r.nm)(_,{interval:18e5,enabled:!p&&!!f&&!!y,deps:[p,f,y]});const R=(0,n.useCallback)(()=>_(),[_]),z=(0,n.useCallback)(e=>{d.vF.log("[ItemContext] \ub85c\uceec userItems \uc5c5\ub370\uc774\ud2b8:",null===e||void 0===e?void 0:e.length,"\uac1c"),w(e)},[]),L=(0,n.useCallback)(async e=>{if(!x())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};const t="temp_".concat(Date.now()),n=(0,a.A)((0,a.A)({},e),{},{id:t});j(e=>[...e,n]);try{const t=await(null===s||void 0===s?void 0:s.getIdToken());if(!t)throw new Error("\uc778\uc99d \ud1a0\ud070\uc744 \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const a="https://asia-northeast3-inconomysu-class.cloudfunctions.net/addStoreItem",n=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({data:{newItemData:e}})});if(!n.ok){const e=await n.text();throw new Error(e||"\uc11c\ubc84 \uc624\ub958: ".concat(n.status))}const i=await n.json();if(i.data.success)return await R(),{success:!0};throw new Error(i.data.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}catch(T){return j(e=>e.filter(e=>e.id!==t)),{success:!1,message:T.message}}},[x,s,R]),P=(0,n.useCallback)(async(e,t)=>{if(!x())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};try{return await O.updateStoreItem({itemId:e,updatesToApply:t}),R(),{success:!0}}catch(T){return"not-found"===T.code?{success:!1,message:"\uc544\uc774\ud15c \uc218\uc815 \ud568\uc218(updateStoreItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[x,O,R]),W=(0,n.useCallback)(async e=>{if(!x())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};try{return await O.deleteStoreItem({itemId:e}),R(),{success:!0}}catch(T){return"not-found"===T.code?{success:!1,message:"\uc544\uc774\ud15c \uc0ad\uc81c \ud568\uc218(deleteStoreItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[x,O,R]),B=(0,n.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};const s=v.find(t=>t.id===e);if(!s)return{success:!1,message:"\uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};const n=s.price*t;b&&b({cash:-n});const i={id:"temp-".concat(Date.now(),"-").concat(Math.random()),itemId:s.id,name:s.name,icon:s.icon||"\ud83d\udd2e",description:s.description||"",type:s.type||"general",quantity:t,price:s.price,durationMs:s.durationMs||3e5,purchasedAt:new Date};d.vF.log("[ItemContext] \ub099\uad00\uc801 \uc5c5\ub370\uc774\ud2b8: Store \uc544\uc774\ud15c \ucd94\uac00",i);const r=[...N],c=s.stock,m=s.price;w(e=>{const s=e.findIndex(e=>e.itemId===i.itemId);if(s>=0){const n=[...e];return n[s]=(0,a.A)((0,a.A)({},n[s]),{},{quantity:n[s].quantity+t}),n}return[...e,i]});try{const i=await O.purchaseStoreItem({itemId:e,quantity:t});if(i.data.success){const{restocked:r,newStock:x,newPrice:p}=i.data;return d.vF.log("[ItemContext] \uad6c\ub9e4 \uc131\uacf5:",{itemId:e,quantity:t,restocked:r,newStock:x,newPrice:p,oldPrice:m,oldStock:c}),(0,o.Mx)(l.db,{classCode:y,userId:f,userName:(null===u||void 0===u?void 0:u.name)||"\uc0ac\uc6a9\uc790",type:o.gI.ITEM_PURCHASE,description:"".concat(s.name," ").concat(t,"\uac1c \uad6c\ub9e4 (").concat(n.toLocaleString(),"\uc6d0)"),amount:-n,metadata:{itemId:e,itemName:s.name,quantity:t,pricePerItem:s.price,totalPrice:n}}),void 0!==s.stock&&j(t=>t.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),{},{stock:x,price:p}):t)),d.vF.log("[ItemContext] \uad6c\ub9e4 \uc131\uacf5, \uc11c\ubc84 \ub370\uc774\ud130\ub85c \ub3d9\uae30\ud654"),R(),{success:!0,restocked:r,newStock:x,newPrice:p}}throw d.vF.warn("[ItemContext] \uad6c\ub9e4 \uc2e4\ud328, \ub864\ubc31 \uc218\ud589"),b&&b({cash:n}),w(r),new Error(i.data.message||"\uad6c\ub9e4\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(T){return d.vF.error("[ItemContext] \uad6c\ub9e4 \uc5d0\ub7ec, \ub864\ubc31 \uc218\ud589:",T),b&&b({cash:n}),w(r),R(),"not-found"===T.code?{success:!1,message:"\uc544\uc774\ud15c \uad6c\ub9e4 \ud568\uc218(purchaseStoreItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[f,O,R,v,N,b,y,u]),q=(0,n.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};const s=N.find(t=>t.id===e||t.itemId===e),a=(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.itemName)||"\uc544\uc774\ud15c";try{return await O.useUserItem({itemId:e,quantityToUse:t,sourceCollection:"inventory"}),(0,o.Mx)(l.db,{classCode:y,userId:f,userName:(null===u||void 0===u?void 0:u.name)||"\uc0ac\uc6a9\uc790",type:o.gI.ITEM_USE,description:"".concat(a," ").concat(t,"\uac1c \uc0ac\uc6a9"),metadata:{itemId:e,itemName:a,quantity:t}}),R(),{success:!0}}catch(T){return R(),"not-found"===T.code?{success:!1,message:"\uc544\uc774\ud15c \uc0ac\uc6a9 \ud568\uc218(useUserItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[f,N,y,u,O,R]),U=(0,n.useCallback)(async e=>{let{itemId:t,quantity:s,price:a}=e;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};const n=N.find(e=>e.id===t||e.itemId===t),i=(null===n||void 0===n?void 0:n.name)||(null===n||void 0===n?void 0:n.itemName)||"\uc544\uc774\ud15c";try{return await O.listUserItemForSale({inventoryItemId:t,quantity:s,price:a,sourceCollection:"inventory"}),(0,o.Mx)(l.db,{classCode:y,userId:f,userName:(null===u||void 0===u?void 0:u.name)||"\uc0ac\uc6a9\uc790",type:o.gI.ITEM_MARKET_LIST,description:"".concat(i," ").concat(s,"\uac1c \uc2dc\uc7a5 \ub4f1\ub85d (").concat(a.toLocaleString(),"\uc6d0)"),metadata:{itemId:t,itemName:i,quantity:s,price:a}}),R(),{success:!0}}catch(T){return R(),"not-found"===T.code?{success:!1,message:"\uc544\uc774\ud15c \ud310\ub9e4 \ub4f1\ub85d \ud568\uc218(listUserItemForSale)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[f,O,R,N,y,u]),Q=(0,n.useCallback)(async e=>{if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};const t=k.find(t=>t.id===e);if(!t)return{success:!1,message:"\ud310\ub9e4 \ubaa9\ub85d\uc5d0\uc11c \uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};const s=t.price||t.totalPrice||0;if(!await h(s,"".concat(t.itemName," \uad6c\ub9e4")))return{success:!1,message:"\ud604\uae08 \ucc28\uac10\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."};const n={id:"temp-".concat(Date.now(),"-").concat(Math.random()),itemId:t.itemId||t.id,name:t.itemName,icon:t.icon||"\ud83d\udd2e",description:t.description||"",type:t.category||t.itemType||"general",quantity:t.quantity||1,purchasedAt:new Date};d.vF.log("[ItemContext] \ub099\uad00\uc801 \uc5c5\ub370\uc774\ud2b8: \uc544\uc774\ud15c \ucd94\uac00",n);const i=[...N],r=[...k];w(e=>{const t=e.findIndex(e=>e.itemId===n.itemId);if(t>=0){const s=[...e];return s[t]=(0,a.A)((0,a.A)({},s[t]),{},{quantity:s[t].quantity+n.quantity}),s}return[...e,n]}),C(t=>t.filter(t=>t.id!==e));try{const a=await O.buyMarketItem({listingId:e});if(a.data.success)return d.vF.log("[ItemContext] \uad6c\ub9e4 \uc131\uacf5, \uc11c\ubc84 \ub370\uc774\ud130\ub85c \ub3d9\uae30\ud654"),(0,o.Mx)(l.db,{classCode:y,userId:f,userName:(null===u||void 0===u?void 0:u.name)||"\uc0ac\uc6a9\uc790",type:o.gI.ITEM_MARKET_BUY,description:"".concat(t.itemName," ").concat(t.quantity||1,"\uac1c \uc2dc\uc7a5 \uad6c\ub9e4 (").concat(s.toLocaleString(),"\uc6d0)"),amount:-s,metadata:{listingId:e,itemName:t.itemName,quantity:t.quantity||1,sellerId:t.sellerId,sellerName:t.sellerName,price:s}}),R(),{success:!0};throw d.vF.warn("[ItemContext] \uad6c\ub9e4 \uc2e4\ud328, \ub864\ubc31 \uc218\ud589"),await g(s,"".concat(t.itemName," \uad6c\ub9e4 \uc2e4\ud328 (\ub864\ubc31)")),w(i),C(r),new Error(a.data.message||"\uad6c\ub9e4\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(T){return d.vF.error("[ItemContext] \uad6c\ub9e4 \uc5d0\ub7ec, \ub864\ubc31 \uc218\ud589:",T),await g(s,"".concat(t.itemName," \uad6c\ub9e4 \uc2e4\ud328 (\ub864\ubc31)")),w(i),C(r),"not-found"===T.code?{success:!1,message:"\uad6c\ub9e4 \ucc98\ub9ac \ud568\uc218(buyMarketItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[f,O,R,k,N,h,g,y,u]),G=(0,n.useCallback)(async e=>{if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};try{return await O.cancelMarketSale({listingId:e}),R(),{success:!0}}catch(T){return R(),"not-found"===T.code?{success:!1,message:"\ud310\ub9e4 \ucde8\uc18c \ud568\uc218(cancelMarketSale)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[f,O,R]),J=(0,n.useCallback)(async e=>{let{listingId:t,offerPrice:s,quantity:a=1}=e;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};try{const e=await O.makeOffer({listingId:t,offerPrice:s,quantity:a});return R(),{success:!0,offerId:e.data.offerId}}catch(T){return R(),"not-found"===T.code?{success:!1,message:"\uac00\uaca9 \uc81c\uc548 \ud568\uc218(makeOffer)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[f,O,R]),H=(0,n.useCallback)(async e=>{let{offerId:t,response:s}=e;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};try{return await O.respondToOffer({offerId:t,response:s}),R(),{success:!0}}catch(T){return R(),"not-found"===T.code?{success:!1,message:"\uc81c\uc548 \uc751\ub2f5 \ud568\uc218(respondToOffer)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[f,O,R]),V=(0,n.useCallback)(async e=>{if(!x())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};try{return await O.adminCancelSale({listingId:e}),R(),{success:!0}}catch(T){return R(),"not-found"===T.code?{success:!1,message:"\uad00\ub9ac\uc790 \ud310\ub9e4 \ucde8\uc18c \ud568\uc218(adminCancelSale)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[x,O,R]),K=(0,n.useCallback)(async e=>{if(!x())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};try{return await O.adminDeleteItem({listingId:e}),R(),{success:!0}}catch(T){return R(),"not-found"===T.code?{success:!1,message:"\uad00\ub9ac\uc790 \uc544\uc774\ud15c \uc0ad\uc81c \ud568\uc218(adminDeleteItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[x,O,R]),X=(0,n.useCallback)(async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inventory";if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};try{const a=await O.updateUserItemQuantity({itemId:e,quantityChange:t,sourceCollection:s});if(a.data.success)return R(),{success:!0};throw new Error(a.data.message||"\uc544\uc774\ud15c \uc218\ub7c9 \uc5c5\ub370\uc774\ud2b8\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(T){return R(),"not-found"===T.code?{success:!1,message:"\uc544\uc774\ud15c \uc218\ub7c9 \uc5c5\ub370\uc774\ud2b8 \ud568\uc218(updateUserItemQuantity)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:T.message}}},[f,O,R]),Y=(0,n.useMemo)(()=>({items:v,userItems:N,marketListings:k,marketOffers:S,loading:M,error:T,addItem:L,updateItem:P,deleteItem:W,purchaseItem:B,useItem:q,updateUserItemQuantity:X,listItemForSale:U,buyMarketItem:Q,cancelSale:G,makeOffer:J,respondToOffer:H,adminCancelSale:V,adminDeleteItem:K,refreshData:R,updateLocalUserItems:z}),[v,N,k,S,M,T,L,P,W,B,q,X,U,Q,G,J,H,V,K,R,z]);return(0,c.jsx)(m.Provider,{value:Y,children:t})}},9270(e,t,s){s.d(t,{Mx:()=>o,gI:()=>r});var a=s(2555),n=s(5472),i=s(2419),l=s(5452);const r={CASH_INCOME:"\ud604\uae08 \uc785\uae08",CASH_EXPENSE:"\ud604\uae08 \ucd9c\uae08",TRANSFER_SEND:"\uc1a1\uae08 \ubc1c\uc1a1",TRANSFER_RECEIVE:"\uc1a1\uae08 \uc218\uc2e0",STOCK_BUY:"\uc8fc\uc2dd \ub9e4\uc218",STOCK_SELL:"\uc8fc\uc2dd \ub9e4\ub3c4",ITEM_PURCHASE:"\uc544\uc774\ud15c \uad6c\ub9e4",ITEM_SELL:"\uc544\uc774\ud15c \ud310\ub9e4",ITEM_USE:"\uc544\uc774\ud15c \uc0ac\uc6a9",ITEM_MARKET_LIST:"\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d",ITEM_MARKET_BUY:"\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4",DEPOSIT_CREATE:"\uc608\uae08 \uac00\uc785",DEPOSIT_WITHDRAW:"\uc608\uae08 \ucd9c\uae08",DEPOSIT_MATURITY:"\uc608\uae08 \ub9cc\uae30",LOAN_CREATE:"\ub300\ucd9c \uc2e4\ud589",LOAN_REPAY:"\ub300\ucd9c \uc0c1\ud658",PARKING_DEPOSIT:"\ud30c\ud0b9\ud1b5\uc7a5 \uc785\uae08",PARKING_WITHDRAW:"\ud30c\ud0b9\ud1b5\uc7a5 \ucd9c\uae08",PARKING_INTEREST:"\ud30c\ud0b9\ud1b5\uc7a5 \uc774\uc790",COUPON_EARN:"\ucfe0\ud3f0 \ud68d\ub4dd",COUPON_USE:"\ucfe0\ud3f0 \uc0ac\uc6a9",COUPON_GIVE:"\ucfe0\ud3f0 \uc9c0\uae09",COUPON_DONATE:"\ucfe0\ud3f0 \uae30\ubd80",COUPON_GIFT_SEND:"\ucfe0\ud3f0 \uc120\ubb3c",COUPON_GIFT_RECEIVE:"\ucfe0\ud3f0 \uc218\uc2e0",GAME_WIN:"\uac8c\uc784 \uc2b9\ub9ac",GAME_LOSE:"\uac8c\uc784 \ud328\ubc30",GAME_REWARD:"\uac8c\uc784 \ubcf4\uc0c1",GAME_BET:"\uac8c\uc784 \ubca0\ud305",AUCTION_BID:"\uacbd\ub9e4 \uc785\ucc30",AUCTION_WIN:"\uacbd\ub9e4 \ub099\ucc30",AUCTION_SOLD:"\uacbd\ub9e4 \ud310\ub9e4",AUCTION_REFUND:"\uacbd\ub9e4 \ud658\ubd88",REALESTATE_BUY:"\ubd80\ub3d9\uc0b0 \uad6c\ub9e4",REALESTATE_SELL:"\ubd80\ub3d9\uc0b0 \ud310\ub9e4",REALESTATE_RENT:"\uc784\ub300\ub8cc \uc218\uc785",TAX_PAYMENT:"\uc138\uae08 \ub0a9\ubd80",FINE_PAYMENT:"\ubc8c\uae08 \ub0a9\ubd80",SALARY_RECEIVE:"\uae09\uc5ec \uc218\ub839",ADMIN_GIVE:"\uad00\ub9ac\uc790 \uc9c0\uae09",ADMIN_TAKE:"\uad00\ub9ac\uc790 \ud68c\uc218"};async function o(e,t){let{classCode:s,userId:r,userName:o,type:d,description:c,amount:m=0,couponAmount:u=0,metadata:x={}}=t;if(!s||!r||!d)return l.vF.warn("[logActivity] \ud544\uc218 \ud30c\ub77c\ubbf8\ud130 \ub204\ub77d:",{classCode:s,userId:r,type:d}),{success:!1,error:"\ud544\uc218 \ud30c\ub77c\ubbf8\ud130 \ub204\ub77d"};const p=e||i.db;try{const e=(0,n.rJ)(p,"activity_logs"),t={classCode:s,userId:r,userName:o||"\uc54c \uc218 \uc5c6\uc74c",type:d,description:c||d,amount:m||0,couponAmount:u||0,metadata:(0,a.A)((0,a.A)({},x),{},{timestamp:(new Date).toISOString()}),timestamp:(0,n.O5)(),createdAt:(0,n.O5)()},i=await(0,n.addDoc)(e,t);return l.vF.log("[logActivity] \ud65c\ub3d9 \ub85c\uadf8 \uae30\ub85d:",d,c),{success:!0,logId:i.id}}catch(h){return l.vF.error("[logActivity] \ub85c\uadf8 \uae30\ub85d \uc2e4\ud328:",h),{success:!1,error:h.message}}}},9306(e,t,s){s.r(t),s.d(t,{AlchanLoading:()=>Na,default:()=>Aa});var a=s(5043),n=s(3216),i=s(5016),l=s(8719),r=s(2555),o=s(4379),d=s(2029),c=s(3165),m=s(5326),u=s(9868),x=s(4473),p=s(2629),h=s(1990),g=s(2171),b=s(6511),f=s(7095),y=s(4919),v=s(6790),j=s(7033),N=s(830),w=s(3639),k=s(920),C=s(7118),S=s(8012),A=s(2489),I=s(1680),E=s(2626),T=s(9829),D=s(7365),M=s(9809),F=s(3190),O=s(2382),_=s(614),R=s(9493),z=s(579);const L=e=>{let{className:t,style:s}=e;return(0,z.jsxs)("svg",{className:t,style:s,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,z.jsxs)("defs",{children:[(0,z.jsxs)("linearGradient",{id:"iconGradient",x1:"0",y1:"0",x2:"100",y2:"100",gradientUnits:"userSpaceOnUse",children:[(0,z.jsx)("stop",{offset:"0%",stopColor:"#7C3AED"}),(0,z.jsx)("stop",{offset:"100%",stopColor:"#4F46E5"})]}),(0,z.jsxs)("filter",{id:"glow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[(0,z.jsx)("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),(0,z.jsxs)("feMerge",{children:[(0,z.jsx)("feMergeNode",{in:"coloredBlur"}),(0,z.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})]}),(0,z.jsx)("rect",{x:"5",y:"5",width:"90",height:"90",rx:"22",fill:"url(#iconGradient)"}),(0,z.jsx)("path",{d:"M28 52 L42 66 L72 36",stroke:"white",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#glow)"}),(0,z.jsx)("path",{d:"M75 25 L77 30 L82 30 L78 34 L79 39 L75 36 L71 39 L72 34 L68 30 L73 30 Z",fill:"#FFD700",stroke:"#B45309",strokeWidth:"1"})]})},P=[{id:"todayTasks",label:"\uc54c\ucc2c \uc624\ub298\uc758 \ud560\uc77c",icon:o.A,path:"/dashboard/tasks",category:"main"},{id:"myAssets",label:"\uc54c\ucc2c \ub098\uc758 \uc790\uc0b0",icon:d.A,path:"/my-assets",category:"main"},{id:"couponGoal",label:"\uc54c\ucc2c \ucfe0\ud3f0 \ubaa9\ud45c",icon:c.A,path:"/coupon-goal",category:"main"},{id:"gamesCategory",label:"\uc54c\ucc2c \ud559\uc2b5 \uac8c\uc784",icon:m.A,isCategory:!0,category:"play"},{id:"omokGame",label:"\uc624\ubaa9",icon:u.A,path:"/learning-games/omok",parentId:"gamesCategory"},{id:"typingGame",label:"\ud0c0\uc790\uc5f0\uc2b5",icon:x.A,path:"/learning-games/typing",parentId:"gamesCategory"},{id:"chessGame",label:"\uccb4\uc2a4 \uac8c\uc784",icon:p.A,path:"/learning-games/science",parentId:"gamesCategory"},{id:"itemsCategory",label:"\uc54c\ucc2c \uc544\uc774\ud15c",icon:h.A,isCategory:!0,category:"economy"},{id:"myItems",label:"\ub0b4 \uc544\uc774\ud15c",icon:g.A,path:"/my-items",parentId:"itemsCategory"},{id:"itemStore",label:"\uc544\uc774\ud15c \uc0c1\uc810",icon:b.A,path:"/item-shop",parentId:"itemsCategory"},{id:"personalShop",label:"\uac1c\uc778 \uc0c1\uc810",icon:f.A,path:"/personal-shop",parentId:"itemsCategory"},{id:"financeCategory",label:"\uc54c\ucc2c \uae08\uc735",icon:y.A,isCategory:!0,category:"economy"},{id:"banking",label:"\uc740\ud589",icon:v.A,path:"/banking",parentId:"financeCategory"},{id:"stockTrading",label:"\uc8fc\uc2dd \uac70\ub798\uc18c",icon:j.A,path:"/stock-trading",parentId:"financeCategory"},{id:"auction",label:"\uacbd\ub9e4\uc7a5",icon:N.A,path:"/auction",parentId:"financeCategory"},{id:"realEstate",label:"\ubd80\ub3d9\uc0b0",icon:w.A,path:"/real-estate",parentId:"financeCategory"},{id:"publicCategory",label:"\uc54c\ucc2c \uacf5\uacf5\uae30\uad00",icon:k.A,isCategory:!0,category:"society"},{id:"government",label:"\uc815\ubd80",icon:k.A,path:"/government",parentId:"publicCategory"},{id:"nationalAssembly",label:"\uad6d\ud68c",icon:C.A,path:"/national-assembly",parentId:"publicCategory"},{id:"court",label:"\ubc95\uc6d0",icon:S.A,path:"/court",parentId:"publicCategory"},{id:"policeStation",label:"\uacbd\ucc30\uc11c",icon:A.A,path:"/police",parentId:"publicCategory"},{id:"boardCategory",label:"\uc54c\ucc2c \uac8c\uc2dc\ud310",icon:I.A,isCategory:!0,category:"community"},{id:"learningBoard",label:"\ud559\uc2b5 \uac8c\uc2dc\ud310",icon:E.A,path:"/learning-board",parentId:"boardCategory"},{id:"musicRequest",label:"\uc74c\uc545 \uc2e0\uccad",icon:T.A,path:"/learning-board/music-request",parentId:"boardCategory"},{id:"adminCategory",label:"\uc54c\ucc2c \uad00\ub9ac\uc790",icon:D.A,isCategory:!0,category:"admin",adminOnly:!0},{id:"adminUserGroup",label:"\ud83d\udc65 \ud559\uc0dd \uad00\ub9ac",icon:C.A,isSubGroup:!0,parentId:"adminCategory",adminOnly:!0},{id:"studentManagement",label:"\ud559\uc0dd \ubaa9\ub85d",icon:C.A,path:"/admin/students",parentId:"adminCategory",adminOnly:!0},{id:"classMemberManagement",label:"\ud559\uae09 \uad6c\uc131\uc6d0",icon:C.A,path:"/admin/class-members",parentId:"adminCategory",adminOnly:!0},{id:"adminAssetGroup",label:"\ud83d\udcb0 \uc790\uc0b0 \uad00\ub9ac",icon:v.A,isSubGroup:!0,parentId:"adminCategory",adminOnly:!0},{id:"moneyTransfer",label:"\ub3c8 \ubcf4\ub0b4\uae30/\uac00\uc838\uc624\uae30",icon:v.A,path:"/admin/money-transfer",parentId:"adminCategory",adminOnly:!0},{id:"couponTransfer",label:"\ucfe0\ud3f0 \ubcf4\ub0b4\uae30/\uac00\uc838\uc624\uae30",icon:c.A,path:"/admin/coupon-transfer",parentId:"adminCategory",adminOnly:!0},{id:"adminSettingsGroup",label:"\u2699\ufe0f \ud559\uae09 \uc124\uc815",icon:D.A,isSubGroup:!0,parentId:"adminCategory",adminOnly:!0},{id:"adminAppSettings",label:"\ubaa9\ud45c/\ucfe0\ud3f0 \uc124\uc815",icon:c.A,path:"/admin/app-settings",parentId:"adminCategory",adminOnly:!0},{id:"taskManagement",label:"\ud560\uc77c \uad00\ub9ac",icon:M.A,path:"/admin/task-management",parentId:"adminCategory",adminOnly:!0},{id:"jobManagement",label:"\uc9c1\uc5c5 \uad00\ub9ac",icon:F.A,path:"/admin/job-settings",parentId:"adminCategory",adminOnly:!0},{id:"salarySettings",label:"\uae09\uc5ec \uc124\uc815",icon:v.A,path:"/admin/salary-settings",parentId:"adminCategory",adminOnly:!0},{id:"adminSystemGroup",label:"\ud83d\udd27 \uc2dc\uc2a4\ud15c",icon:D.A,isSubGroup:!0,parentId:"adminCategory",adminOnly:!0},{id:"activityLog",label:"\ub370\uc774\ud130\ubca0\uc774\uc2a4",icon:I.A,path:"/admin/activity-log",parentId:"adminCategory",adminOnly:!0},{id:"adminPage",label:"\uad00\ub9ac\uc790 \uc81c\uc5b4\ud310",icon:D.A,path:"/admin/page",parentId:"adminCategory",adminOnly:!0},{id:"superAdminCategory",label:"\uc571 \uad00\ub9ac\uc790",icon:A.A,isCategory:!0,category:"superadmin",superAdminOnly:!0},{id:"superAdminDashboard",label:"\uc571 \uad00\ub9ac \ub300\uc2dc\ubcf4\ub4dc",icon:A.A,path:"/super-admin",parentId:"superAdminCategory",superAdminOnly:!0}],W={main:"\uba54\uc778",play:"\uac8c\uc784",economy:"\uacbd\uc81c",society:"\uc0ac\ud68c",community:"\ucee4\ubba4\ub2c8\ud2f0",admin:"\uad00\ub9ac",superadmin:"\uc571 \uad00\ub9ac"},B=e=>{let{title:t,children:s}=e;return(0,z.jsxs)("div",{className:"mb-6",children:[(0,z.jsx)("h3",{className:"px-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider mb-2",children:t}),(0,z.jsx)("ul",{className:"space-y-1",children:s})]})},q=e=>{let{icon:t,label:s,active:a,hasSubmenu:n,onClick:i}=e;return(0,z.jsx)("li",{children:(0,z.jsxs)("button",{onClick:i,className:"w-full flex items-center justify-between px-4 py-2.5 rounded-xl transition-all duration-200 group ".concat(a?"bg-indigo-500/20 text-indigo-400 font-bold shadow-sm border border-indigo-500/30":"text-slate-400 hover:bg-white/5 hover:text-slate-200"),children:[(0,z.jsxs)("div",{className:"flex items-center gap-3",children:[(0,z.jsx)(t,{className:"w-[18px] h-[18px] ".concat(a?"text-indigo-400":"text-slate-500 group-hover:text-slate-300")}),(0,z.jsx)("span",{className:"text-sm",children:s})]}),n&&(0,z.jsx)(O.A,{className:"w-3.5 h-3.5 text-slate-400"})]})})},U=e=>{let{icon:t,label:s,active:a,onClick:n}=e;return(0,z.jsxs)("button",{onClick:n,className:"w-full flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg transition-colors ".concat(a?"text-indigo-400 bg-indigo-500/20 shadow-[0_0_10px_rgba(99,102,241,0.2)]":"text-slate-500 hover:text-slate-200 hover:bg-white/5"),children:[(0,z.jsx)(t,{className:"w-3.5 h-3.5"}),s]})},Q=e=>{let{category:t,children:s,isExpanded:a,onToggle:n,hasActiveChild:i}=e;const l=t.icon;return(0,z.jsxs)("div",{className:"mb-1",children:[(0,z.jsxs)("button",{onClick:n,className:"w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group ".concat(i?"bg-indigo-500/10 text-indigo-400 border border-indigo-500/20":"text-slate-400 hover:bg-white/5 hover:text-slate-200"),children:[(0,z.jsx)(l,{className:"w-[18px] h-[18px] transition-colors flex-shrink-0 ".concat(i?"text-indigo-400":"text-slate-500 group-hover:text-slate-300")}),(0,z.jsx)("span",{className:"flex-1 text-left",children:t.label}),(0,z.jsx)(O.A,{className:"w-3.5 h-3.5 transition-transform duration-300 opacity-50 flex-shrink-0 ".concat(a?"rotate-180":"")})]}),(0,z.jsx)("div",{className:"overflow-hidden transition-all duration-300 ".concat(a?"max-h-96 opacity-100":"max-h-0 opacity-0"),children:(0,z.jsx)("div",{className:"pl-4 mt-2 space-y-1 border-l-2 border-slate-700 ml-4",children:s})})]})};function G(e){let{isOpen:t,onClose:s,isCollapsed:l=!1}=e;const o=(0,n.zy)(),d=(0,n.Zp)(),{userDoc:c,logout:m}=(0,i.As)(),[u,x]=(0,a.useState)({}),[p,h]=(0,a.useState)(window.innerWidth<768);(0,a.useEffect)(()=>{const e=()=>h(window.innerWidth<768);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const g=(0,a.useCallback)(e=>{x(t=>(0,r.A)((0,r.A)({},t),{},{[e]:!t[e]}))},[]),b=(0,a.useCallback)(e=>!!e&&(o.pathname===e||o.pathname.startsWith("".concat(e,"/"))),[o.pathname]),f=(0,a.useCallback)(e=>P.some(t=>t.parentId===e&&b(t.path)),[b]),y=(0,a.useCallback)(e=>{e.path&&(d(e.path),p&&(null===s||void 0===s||s()))},[d,p,s]),v=(0,a.useCallback)(async()=>{m&&(await m(),d("/login"))},[m,d]),j=(null===c||void 0===c?void 0:c.isAdmin)||(null===c||void 0===c?void 0:c.isSuperAdmin),N=null===c||void 0===c?void 0:c.isSuperAdmin;let w="\ud559\uc0dd";null!==c&&void 0!==c&&c.isSuperAdmin?w="\uc571 \uad00\ub9ac\uc790":null!==c&&void 0!==c&&c.isAdmin&&(w="\uad50\uc0ac");const k=(null===c||void 0===c?void 0:c.name)||(null===c||void 0===c?void 0:c.nickname)||"\uc0ac\uc6a9\uc790",C=e=>{const t=P.filter(t=>t.category===e&&(!(t.adminOnly&&!j)&&!(t.superAdminOnly&&!N)));return 0===t.length?null:(0,z.jsx)(B,{title:W[e],children:t.map(e=>{if(e.isCategory){const t=P.filter(t=>t.parentId===e.id&&(!(t.adminOnly&&!j)&&!(t.superAdminOnly&&!N)));return 0===t.length?null:(0,z.jsx)(Q,{category:e,isExpanded:u[e.id]||f(e.id),onToggle:()=>g(e.id),hasActiveChild:f(e.id),children:t.map(e=>e.isSubGroup?(0,z.jsx)("div",{className:"mt-3 mb-1 first:mt-0",children:(0,z.jsx)("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider px-2",children:e.label})},e.id):(0,z.jsx)(U,{icon:e.icon,label:e.label,active:b(e.path),onClick:()=>y(e)},e.id))},e.id)}return e.parentId?null:(0,z.jsx)(q,{icon:e.icon,label:e.label,active:b(e.path),onClick:()=>y(e)},e.id)})},e)};return l&&!p?(0,z.jsxs)("aside",{className:"hidden md:flex flex-col w-20 bg-[#141423] border-r border-[#00fff2]/10 h-screen sticky top-0 left-0 z-50 shadow-xl transition-all duration-300",children:[(0,z.jsx)("div",{className:"h-16 min-h-16 flex items-center justify-center bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600",children:(0,z.jsx)("div",{className:"p-1 bg-white/10 rounded-lg shadow-md",children:(0,z.jsx)(L,{style:{width:"32px",height:"32px"}})})}),(0,z.jsx)("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-2",children:P.filter(e=>!e.parentId&&!e.isCategory).map(e=>{if(e.adminOnly&&!j)return null;if(e.superAdminOnly&&!N)return null;const t=e.icon,s=b(e.path);return(0,z.jsx)("button",{onClick:()=>y(e),title:e.label,className:"w-14 h-14 mx-auto rounded-2xl flex items-center justify-center transition-all duration-200 ".concat(s?"bg-gradient-to-br from-indigo-600 to-violet-700 text-white shadow-lg shadow-indigo-500/40 border-none":"bg-[#1a1a2e] border border-slate-700/50 text-slate-400 hover:bg-indigo-900/30 hover:text-indigo-400 hover:border-indigo-500/30"),children:(0,z.jsx)(t,{size:24})},e.id)})}),(0,z.jsx)("div",{className:"p-4 border-t border-slate-800 bg-[#0a0a12]/50",children:(0,z.jsx)("div",{className:"w-10 h-10 mx-auto rounded-full bg-gradient-to-tr from-blue-500 to-indigo-500 flex items-center justify-center text-white font-bold",children:k.charAt(0)})})]}):(0,z.jsxs)(z.Fragment,{children:[p&&t&&(0,z.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-40 md:hidden",onClick:s}),(0,z.jsxs)("aside",{className:"\n          fixed inset-y-0 left-0 z-50 w-72 bg-[#141423] border-r border-[#00fff2]/10 shadow-[0_4px_20px_rgba(0,0,0,0.5)] transform transition-transform duration-300 ease-in-out\n          ".concat(p?t?"translate-x-0":"-translate-x-full":"relative translate-x-0","\n          lg:relative lg:translate-x-0 lg:w-72 flex flex-col shrink-0\n        "),children:[(0,z.jsxs)("div",{className:"h-[72px] min-h-[72px] m-3 flex items-center relative rounded-2xl bg-gradient-to-br from-[#0a0a12]/95 to-[#141423]/95 border border-[#00fff2]/20 shadow-[0_0_15px_rgba(0,255,242,0.1)]",children:[(0,z.jsx)("div",{className:"absolute -top-5 -right-5 w-20 h-20 bg-white/10 rounded-full"}),(0,z.jsx)("div",{className:"absolute -bottom-7 -left-2 w-15 h-15 bg-white/[0.08] rounded-full"}),(0,z.jsxs)("div",{className:"flex items-center gap-3.5 px-4 w-full relative z-10",children:[(0,z.jsx)("div",{className:"p-1.5 bg-white/5 rounded-xl shadow-md border border-white/10",children:(0,z.jsx)(L,{style:{width:"36px",height:"36px"}})}),(0,z.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,z.jsx)("span",{className:"text-[22px] font-black text-[#00fff2] leading-tight",style:{fontFamily:"'Jua', sans-serif",textShadow:"0 0 10px rgba(0, 255, 242, 0.5)"},children:"\uc54c\ucc2c"}),(0,z.jsx)("span",{className:"text-[11px] font-bold text-[#e8e8ff]/70 tracking-[0.2em] leading-tight mt-0.5",children:"ALCHAN"})]})]}),p&&(0,z.jsx)("button",{onClick:s,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 rounded-full bg-white/20 border-0 text-white cursor-pointer",children:(0,z.jsx)(_.A,{size:18})})]}),(0,z.jsxs)("nav",{className:"flex-1 overflow-y-auto py-6 px-4 space-y-8 scrollbar-hide",children:[C("main"),C("play"),C("economy"),C("society"),C("community"),C("admin"),C("superadmin")]}),(0,z.jsx)("div",{className:"p-4 border-t border-slate-800 bg-[#0a0a12]/50",children:(0,z.jsxs)("div",{onClick:v,className:"flex items-center gap-3 p-3 rounded-xl bg-[#141423] shadow-sm border border-slate-700 hover:shadow-md hover:border-indigo-500/50 transition-all cursor-pointer group",children:[(0,z.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-tr from-blue-500 to-indigo-500 flex items-center justify-center text-white font-bold",children:k.charAt(0)}),(0,z.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,z.jsx)("p",{className:"text-sm font-bold text-slate-200 truncate",children:k}),(0,z.jsx)("p",{className:"text-xs text-slate-500 truncate",children:w})]}),(0,z.jsx)(R.A,{className:"w-4 h-4 text-slate-400 group-hover:text-red-500 transition-colors"})]})})]})]})}var J=s(2419),H=s(3946),V=s(8326),K=s(9463),X=s(4459),Y=s(7737),Z=s(9855),$=s(3005),ee=s(5472),te=s(5452),se=s(6099),ae=s(6210);se.A,d.A,c.A,f.A,m.A,y.A,C.A,ae.A;var ne=s(8393),ie=s(7940),le=s(2300),re=s(9233),oe=s(3677),de=s(7666),ce=s(6963);const me=function(e){let{isOpen:t,onClose:s}=e;const{isDarkMode:n,toggleDarkMode:l,fontSize:r,setFontSize:o}=(0,$.DP)(),{resetTutorial:d}=function(){const{user:e}=(0,i.As)(),[t,s]=(0,a.useState)(!1),[n,l]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{null!==e&&void 0!==e&&e.uid?(async()=>{try{const t=(0,ee.H9)(J.db,"users",e.uid,"settings","tutorial"),a=await(0,ee.x7)(t);a.exists()&&a.data().completed||s(!0)}catch(t){te.vF.error("\ud29c\ud1a0\ub9ac\uc5bc \uccb4\ud06c \uc624\ub958:",t)}finally{l(!1)}})():l(!1)},[null===e||void 0===e?void 0:e.uid]),{showTutorial:t,loading:n,completeTutorial:(0,a.useCallback)(async()=>{if(null!==e&&void 0!==e&&e.uid)try{const t=(0,ee.H9)(J.db,"users",e.uid,"settings","tutorial");await(0,ee.BN)(t,{completed:!0,completedAt:(0,ee.O5)()}),s(!1)}catch(t){te.vF.error("\ud29c\ud1a0\ub9ac\uc5bc \uc644\ub8cc \uc800\uc7a5 \uc624\ub958:",t)}},[null===e||void 0===e?void 0:e.uid]),skipTutorial:(0,a.useCallback)(async()=>{if(null!==e&&void 0!==e&&e.uid)try{const t=(0,ee.H9)(J.db,"users",e.uid,"settings","tutorial");await(0,ee.BN)(t,{completed:!0,skipped:!0,skippedAt:(0,ee.O5)()}),s(!1)}catch(t){te.vF.error("\ud29c\ud1a0\ub9ac\uc5bc \uc2a4\ud0b5 \uc800\uc7a5 \uc624\ub958:",t)}},[null===e||void 0===e?void 0:e.uid]),resetTutorial:(0,a.useCallback)(async()=>{if(null!==e&&void 0!==e&&e.uid)try{const t=(0,ee.H9)(J.db,"users",e.uid,"settings","tutorial");await(0,ee.BN)(t,{completed:!1}),s(!0)}catch(t){te.vF.error("\ud29c\ud1a0\ub9ac\uc5bc \ub9ac\uc14b \uc624\ub958:",t)}},[null===e||void 0===e?void 0:e.uid])}}(),[c,m]=(0,a.useState)("false"!==localStorage.getItem("alchan-notifications")),[u,x]=(0,a.useState)("false"!==localStorage.getItem("alchan-sounds"));return t?(0,z.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,z.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-3xl w-full max-w-md max-h-[90vh] overflow-hidden shadow-2xl",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-gray-700",children:[(0,z.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"\uc124\uc815"}),(0,z.jsx)("button",{onClick:s,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:(0,z.jsx)(_.A,{size:20,className:"text-gray-500"})})]}),(0,z.jsxs)("div",{className:"overflow-y-auto p-4 space-y-6",children:[(0,z.jsxs)("section",{children:[(0,z.jsx)("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"\ud654\uba74"}),(0,z.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-2xl p-4 space-y-4",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex items-center gap-3",children:[n?(0,z.jsx)(ne.A,{size:20,className:"text-indigo-500"}):(0,z.jsx)(ie.A,{size:20,className:"text-amber-500"}),(0,z.jsxs)("div",{children:[(0,z.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\ub2e4\ud06c \ubaa8\ub4dc"}),(0,z.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc5b4\ub450\uc6b4 \ud654\uba74\uc73c\ub85c \ub208\uc758 \ud53c\ub85c\ub97c \uc904\uc5ec\uc694"})]})]}),(0,z.jsx)("button",{onClick:l,className:"w-12 h-7 rounded-full transition-colors relative ".concat(n?"bg-indigo-500":"bg-gray-300"),children:(0,z.jsx)("div",{className:"absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform ".concat(n?"left-6":"left-1")})})]}),(0,z.jsxs)("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-600",children:[(0,z.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,z.jsx)(le.A,{size:20,className:"text-blue-500"}),(0,z.jsxs)("div",{children:[(0,z.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\uae00\uaf34 \ud06c\uae30"}),(0,z.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc77d\uae30 \ud3b8\ud55c \ud06c\uae30\ub97c \uc120\ud0dd\ud558\uc138\uc694"})]})]}),(0,z.jsx)("div",{className:"grid grid-cols-4 gap-2",children:Object.entries($.$N).map(e=>{let[t,{label:s}]=e;return(0,z.jsx)("button",{onClick:()=>o(t),className:"py-2 rounded-xl text-sm font-medium transition-all ".concat(r===t?"bg-indigo-500 text-white":"bg-white dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-500"),children:s},t)})})]})]})]}),(0,z.jsxs)("section",{children:[(0,z.jsx)("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"\uc54c\ub9bc"}),(0,z.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-2xl divide-y divide-gray-200 dark:divide-gray-600",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,z.jsxs)("div",{className:"flex items-center gap-3",children:[(0,z.jsx)(re.A,{size:20,className:"text-green-500"}),(0,z.jsxs)("div",{children:[(0,z.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\ud478\uc2dc \uc54c\ub9bc"}),(0,z.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc0c8 \uc18c\uc2dd\uc744 \uc54c\ub824\ub4dc\ub824\uc694"})]})]}),(0,z.jsx)("button",{onClick:()=>{const e=!c;m(e),localStorage.setItem("alchan-notifications",String(e))},className:"w-12 h-7 rounded-full transition-colors relative ".concat(c?"bg-green-500":"bg-gray-300"),children:(0,z.jsx)("div",{className:"absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform ".concat(c?"left-6":"left-1")})})]}),(0,z.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,z.jsxs)("div",{className:"flex items-center gap-3",children:[(0,z.jsx)(oe.A,{size:20,className:"text-purple-500"}),(0,z.jsxs)("div",{children:[(0,z.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\uc18c\ub9ac"}),(0,z.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc54c\ub9bc\uc74c\uacfc \ud6a8\uacfc\uc74c"})]})]}),(0,z.jsx)("button",{onClick:()=>{const e=!u;x(e),localStorage.setItem("alchan-sounds",String(e))},className:"w-12 h-7 rounded-full transition-colors relative ".concat(u?"bg-purple-500":"bg-gray-300"),children:(0,z.jsx)("div",{className:"absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform ".concat(u?"left-6":"left-1")})})]})]})]}),(0,z.jsxs)("section",{children:[(0,z.jsx)("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"\uae30\ud0c0"}),(0,z.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-2xl divide-y divide-gray-200 dark:divide-gray-600",children:[(0,z.jsxs)("button",{onClick:()=>{window.confirm("\ud29c\ud1a0\ub9ac\uc5bc\uc744 \ub2e4\uc2dc \ubcf4\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(d(),s())},className:"flex items-center justify-between p-4 w-full hover:bg-gray-100 dark:hover:bg-gray-600/50 transition-colors",children:[(0,z.jsxs)("div",{className:"flex items-center gap-3",children:[(0,z.jsx)(de.A,{size:20,className:"text-amber-500"}),(0,z.jsxs)("div",{className:"text-left",children:[(0,z.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\ud29c\ud1a0\ub9ac\uc5bc \ub2e4\uc2dc \ubcf4\uae30"}),(0,z.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc0ac\uc6a9\ubc95\uc744 \ub2e4\uc2dc \ubc30\uc6cc\uc694"})]})]}),(0,z.jsx)(V.A,{size:20,className:"text-gray-400"})]}),(0,z.jsx)("div",{className:"p-4",children:(0,z.jsxs)("div",{className:"flex items-center gap-3",children:[(0,z.jsx)(ce.A,{size:20,className:"text-gray-400"}),(0,z.jsxs)("div",{children:[(0,z.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\uc571 \ubc84\uc804"}),(0,z.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"v1.0.0"})]})]})})]})]})]}),(0,z.jsx)("div",{className:"p-4 border-t border-gray-100 dark:border-gray-700",children:(0,z.jsx)("button",{onClick:s,className:"w-full py-3 bg-indigo-500 hover:bg-indigo-600 text-white rounded-xl font-semibold transition-colors",children:"\uc644\ub8cc"})})]})}):null},ue=[{id:"fair",name:"\ubc1d\uc740 \ud53c\ubd80",color:"#FFE4C4"},{id:"light",name:"\uc5f0\ud55c \ud53c\ubd80",color:"#F5DEB3"},{id:"medium",name:"\uc911\uac04 \ud53c\ubd80",color:"#DEB887"},{id:"tan",name:"\uadf8\uc744\ub9b0 \ud53c\ubd80",color:"#D2A679"},{id:"dark",name:"\uc5b4\ub450\uc6b4 \ud53c\ubd80",color:"#8B7355"}],xe=[{id:"round",name:"\ub465\uadfc\ud615",icon:"\ud83d\udd35",path:"M50,10 C82,10 90,32 90,55 C90,78 78,90 50,90 C22,90 10,78 10,55 C10,32 18,10 50,10"},{id:"oval",name:"\uacc4\ub780\ud615",icon:"\ud83e\udd5a",path:"M50,8 C78,8 88,28 88,52 C88,80 72,92 50,92 C28,92 12,80 12,52 C12,28 22,8 50,8"},{id:"square",name:"\uac01\uc9c4\ud615",icon:"\ud83d\udfe7",path:"M50,10 C85,10 90,30 90,55 C90,80 82,90 50,90 C18,90 10,80 10,55 C10,30 15,10 50,10"},{id:"heart",name:"\ud558\ud2b8\ud615",icon:"\ud83d\udc9c",path:"M50,10 C80,10 90,30 90,52 C90,78 70,90 50,92 C30,90 10,78 10,52 C10,30 20,10 50,10"},{id:"long",name:"\uae34\ud615",icon:"\ud83d\udccf",path:"M50,5 C72,5 80,25 80,50 C80,82 65,95 50,95 C35,95 20,82 20,50 C20,25 28,5 50,5"}],pe=[{id:"normal",name:"\uae30\ubcf8",leftX:35,rightX:65,y:45,size:6},{id:"big",name:"\ud070 \ub208",leftX:35,rightX:65,y:45,size:8},{id:"small",name:"\uc791\uc740 \ub208",leftX:35,rightX:65,y:45,size:4},{id:"almond",name:"\uc544\ubaac\ub4dc\ud615",leftX:35,rightX:65,y:45,size:6,shape:"almond"},{id:"round",name:"\ub3d9\uadf8\ub780 \ub208",leftX:35,rightX:65,y:45,size:7,shape:"round"}],he=[{id:"black",name:"\uac80\uc740\uc0c9",color:"#1a1a1a"},{id:"brown",name:"\uac08\uc0c9",color:"#654321"},{id:"hazel",name:"\ud5e4\uc774\uc990",color:"#8E7618"},{id:"blue",name:"\ud30c\ub780\uc0c9",color:"#1E90FF"},{id:"green",name:"\ucd08\ub85d\uc0c9",color:"#228B22"},{id:"gray",name:"\ud68c\uc0c9",color:"#696969"}],ge=[{id:"smile",name:"\ubbf8\uc18c",path:"M35,65 Q50,75 65,65",stroke:!0},{id:"grin",name:"\ud65c\uc9dd \uc6c3\uc74c",path:"M30,62 Q50,80 70,62",stroke:!0},{id:"neutral",name:"\ubb34\ud45c\uc815",path:"M38,65 L62,65",stroke:!0},{id:"small_smile",name:"\uc791\uc740 \ubbf8\uc18c",path:"M40,65 Q50,70 60,65",stroke:!0},{id:"open",name:"\ubc8c\ub9b0 \uc785",path:"M35,63 Q50,75 65,63 Q50,80 35,63",fill:!0}],be=["round","oval","square","heart","long"],fe=[{id:"none",name:"\ubbfc\uba38\ub9ac",paths:[],compatibleFaces:be},{id:"short",name:"\uc9e7\uc740 \uba38\ub9ac",paths:["M15,28 Q15,8 50,5 Q85,8 85,28 Q85,18 50,15 Q15,18 15,28 Z"],compatibleFaces:be},{id:"medium",name:"\uc911\uac04 \uba38\ub9ac",paths:["M8,50 Q5,15 50,2 Q95,15 92,50 L88,48 Q88,20 50,12 Q12,20 12,48 Z"],bangsPath:"M20,22 Q35,32 50,30 Q65,32 80,22 L80,12 Q65,22 50,20 Q35,22 20,12 Z",compatibleFaces:be},{id:"long",name:"\uae34 \uba38\ub9ac",paths:["M3,95 Q-2,40 50,0 Q102,40 97,95 L92,90 Q92,35 50,10 Q8,35 8,90 Z"],bangsPath:"M15,25 Q30,38 50,35 Q70,38 85,25 L85,10 Q70,25 50,22 Q30,25 15,10 Z",compatibleFaces:be},{id:"bob",name:"\ub2e8\ubc1c",paths:["M5,70 L5,30 Q5,5 50,2 Q95,5 95,30 L95,70 Q95,75 90,75 L85,55 Q85,20 50,12 Q15,20 15,55 L10,75 Q5,75 5,70 Z"],bangsPath:"M15,30 L20,18 Q35,30 50,28 Q65,30 80,18 L85,30 Q70,38 50,35 Q30,38 15,30 Z",compatibleFaces:be},{id:"ponytail",name:"\ud3ec\ub2c8\ud14c\uc77c",paths:["M15,35 Q12,12 50,5 Q88,12 85,35 Q85,22 50,15 Q15,22 15,35 Z","M75,15 Q95,10 100,25 Q105,50 95,75 Q90,85 82,70 Q88,50 85,30 Q82,20 75,15 Z"],compatibleFaces:be},{id:"twintail",name:"\ud2b8\uc708\ud14c\uc77c",paths:["M18,35 Q15,12 50,5 Q85,12 82,35 Q82,22 50,15 Q18,22 18,35 Z","M12,35 Q0,40 -5,55 Q-8,80 5,90 Q12,85 8,65 Q5,50 12,35 Z","M88,35 Q100,40 105,55 Q108,80 95,90 Q88,85 92,65 Q95,50 88,35 Z"],compatibleFaces:be},{id:"curly",name:"\uacf1\uc2ac\uba38\ub9ac",paths:["M0,55 Q-5,25 50,0 Q105,25 100,55 Q100,35 50,12 Q0,35 0,55 Z","M5,40 Q-2,50 5,60 Q-2,70 5,75 Q12,65 8,55 Q12,45 5,40 Z","M95,40 Q102,50 95,60 Q102,70 95,75 Q88,65 92,55 Q88,45 95,40 Z"],compatibleFaces:be},{id:"mohawk",name:"\ubaa8\ud788\uce78",paths:["M35,25 L40,-5 L45,-15 L50,-20 L55,-15 L60,-5 L65,25 Q60,20 50,18 Q40,20 35,25 Z"],compatibleFaces:be}],ye=[{id:"black",name:"\uac80\uc740\uc0c9",color:"#1a1a1a"},{id:"dark_brown",name:"\uc9c4\ud55c \uac08\uc0c9",color:"#3d2314"},{id:"brown",name:"\uac08\uc0c9",color:"#6b4423"},{id:"light_brown",name:"\ubc1d\uc740 \uac08\uc0c9",color:"#a0522d"},{id:"blonde",name:"\uae08\ubc1c",color:"#f4d03f"},{id:"red",name:"\ube68\uac04\uc0c9",color:"#c0392b"},{id:"orange",name:"\uc8fc\ud669\uc0c9",color:"#e67e22"},{id:"pink",name:"\ud551\ud06c",color:"#ff69b4"},{id:"purple",name:"\ubcf4\ub77c\uc0c9",color:"#9b59b6"},{id:"blue",name:"\ud30c\ub780\uc0c9",color:"#3498db"},{id:"green",name:"\ucd08\ub85d\uc0c9",color:"#27ae60"},{id:"gray",name:"\ud68c\uc0c9",color:"#7f8c8d"},{id:"white",name:"\ud770\uc0c9",color:"#ecf0f1"},{id:"rainbow",name:"\ubb34\uc9c0\uac1c",gradient:["#ff0000","#ff7f00","#ffff00","#00ff00","#0000ff","#8b00ff"]}],ve=[{id:"none",name:"\uc5c6\uc74c",color:null},{id:"tshirt",name:"\ud2f0\uc154\uce20",baseColor:"#3498db",path:"M20,95 L15,120 L85,120 L80,95 Q78,88 65,88 L58,92 L42,92 L35,88 Q22,88 20,95",sleeves:"M20,95 L8,105 L15,110 L22,100 M80,95 L92,105 L85,110 L78,100"},{id:"suit",name:"\uc815\uc7a5",baseColor:"#2c3e50",path:"M18,95 L15,120 L85,120 L82,95 Q80,88 65,88 L58,92 L42,92 L35,88 Q20,88 18,95",tie:!0,lapels:!0},{id:"hoodie",name:"\ud6c4\ub4dc\ud2f0",baseColor:"#e74c3c",path:"M15,95 L12,120 L88,120 L85,95 Q82,86 65,86 L58,90 L42,90 L35,86 Q18,86 15,95",hood:!0,pocket:!0},{id:"dress",name:"\uc6d0\ud53c\uc2a4",baseColor:"#9b59b6",path:"M28,92 L22,125 L78,125 L72,92 Q70,88 60,88 L55,92 L45,92 L40,88 Q30,88 28,92"},{id:"uniform",name:"\uad50\ubcf5",baseColor:"#34495e",path:"M20,95 L18,120 L82,120 L80,95 Q78,88 65,88 L58,92 L42,92 L35,88 Q22,88 20,95",collar:!0,buttons:!0}],je=[{id:"blue",name:"\ud30c\ub780\uc0c9",color:"#3498db"},{id:"red",name:"\ube68\uac04\uc0c9",color:"#e74c3c"},{id:"green",name:"\ucd08\ub85d\uc0c9",color:"#27ae60"},{id:"purple",name:"\ubcf4\ub77c\uc0c9",color:"#9b59b6"},{id:"yellow",name:"\ub178\ub780\uc0c9",color:"#f1c40f"},{id:"orange",name:"\uc8fc\ud669\uc0c9",color:"#e67e22"},{id:"pink",name:"\ud551\ud06c",color:"#ff69b4"},{id:"black",name:"\uac80\uc740\uc0c9",color:"#2c3e50"},{id:"white",name:"\ud770\uc0c9",color:"#ecf0f1"},{id:"navy",name:"\ub124\uc774\ube44",color:"#2c3e50"}],Ne=[{id:"none",name:"\uc5c6\uc74c"},{id:"glasses",name:"\uc548\uacbd",path:"M25,43 L28,43 A8,8 0 1,1 42,43 L58,43 A8,8 0 1,1 72,43 L75,43",color:"#1a1a1a"},{id:"sunglasses",name:"\uc120\uae00\ub77c\uc2a4",path:"M22,40 L25,40 C25,40 25,50 35,50 C45,50 45,40 45,40 L55,40 C55,40 55,50 65,50 C75,50 75,40 75,40 L78,40",color:"#1a1a1a",fill:!0},{id:"earrings",name:"\uadc0\uac78\uc774",type:"earrings",color:"#f1c40f"},{id:"necklace",name:"\ubaa9\uac78\uc774",path:"M35,88 Q50,95 65,88",color:"#f1c40f"},{id:"hat",name:"\ubaa8\uc790",path:"M15,15 L85,15 L85,5 Q50,-5 15,5 Z",color:"#e74c3c"},{id:"crown",name:"\uc655\uad00",type:"crown",color:"#f1c40f"},{id:"headband",name:"\uba38\ub9ac\ub760",path:"M12,25 Q50,18 88,25",color:"#ff69b4"},{id:"bow",name:"\ub9ac\ubcf8",type:"bow",color:"#ff69b4"},{id:"mask",name:"\ub9c8\uc2a4\ud06c",path:"M25,55 Q50,70 75,55 L75,65 Q50,80 25,65 Z",color:"#ffffff"}],we=[{id:"none",name:"\uc5c6\uc74c",color:"transparent"},{id:"sky_blue",name:"\ud558\ub298\uc0c9",color:"#87CEEB"},{id:"sunset",name:"\uc11d\uc591",gradient:["#ff7e5f","#feb47b"]},{id:"night",name:"\ubc24\ud558\ub298",gradient:["#0f0c29","#302b63","#24243e"]},{id:"forest",name:"\uc232",gradient:["#134e5e","#71b280"]},{id:"ocean",name:"\ubc14\ub2e4",gradient:["#2193b0","#6dd5ed"]},{id:"pink",name:"\ud551\ud06c",gradient:["#ee9ca7","#ffdde1"]},{id:"purple",name:"\ubcf4\ub77c",gradient:["#667eea","#764ba2"]},{id:"gold",name:"\uace8\ub4dc",gradient:["#f7971e","#ffd200"]},{id:"rainbow",name:"\ubb34\uc9c0\uac1c",gradient:["#ff0000","#ff7f00","#ffff00","#00ff00","#0000ff","#8b00ff"]},{id:"galaxy",name:"\uc740\ud558\uc218",gradient:["#0f0c29","#302b63","#24243e"],stars:!0}],ke=[{id:"none",name:"\uc5c6\uc74c",style:null},{id:"simple",name:"\ub2e8\uc21c",color:"#ffffff",width:3},{id:"gold",name:"\uace8\ub4dc",color:"#f1c40f",width:4,glow:!0},{id:"silver",name:"\uc2e4\ubc84",color:"#bdc3c7",width:4,glow:!0},{id:"bronze",name:"\ube0c\ub860\uc988",color:"#cd7f32",width:4,glow:!0},{id:"rainbow",name:"\ubb34\uc9c0\uac1c",gradient:["#ff0000","#ff7f00","#ffff00","#00ff00","#0000ff","#8b00ff"],width:4,animated:!0},{id:"neon_blue",name:"\ub124\uc628 \ube14\ub8e8",color:"#00fff2",width:3,glow:!0,glowColor:"#00fff2"},{id:"neon_pink",name:"\ub124\uc628 \ud551\ud06c",color:"#ff69b4",width:3,glow:!0,glowColor:"#ff69b4"},{id:"fire",name:"\ubd88\uaf43",gradient:["#ff4500","#ff6347","#ffa500"],width:4,animated:!0},{id:"ice",name:"\uc5bc\uc74c",gradient:["#00bfff","#87ceeb","#e0ffff"],width:4,glow:!0}],Ce=[{id:"normal",name:"\uae30\ubcf8",eyeMod:null,mouthMod:null},{id:"happy",name:"\ud589\ubcf5",eyeMod:"happy",mouthMod:"grin"},{id:"sad",name:"\uc2ac\ud514",eyeMod:"sad",mouthMod:"sad"},{id:"angry",name:"\ud654\ub0a8",eyeMod:"angry",mouthMod:"angry"},{id:"surprised",name:"\ub180\ub78c",eyeMod:"wide",mouthMod:"open"},{id:"wink",name:"\uc719\ud06c",eyeMod:"wink",mouthMod:"smile"},{id:"love",name:"\uc0ac\ub791",eyeMod:"hearts",mouthMod:"smile"},{id:"cool",name:"\uba4b\uc9d0",eyeMod:"sunglasses",mouthMod:"smirk"}],Se={skinTone:"light",faceShape:"oval",eyeStyle:"normal",eyeColor:"brown",mouthStyle:"smile",hairstyle:"short",hairColor:"black",outfit:"tshirt",outfitColor:"blue",accessory:"none",background:"sky_blue",border:"simple",expression:"normal"};function Ae(e){try{const t=localStorage.getItem("avatar_".concat(e));if(t)return(0,r.A)((0,r.A)({},Se),JSON.parse(t))}catch(t){}return(0,r.A)({},Se)}function Ie(e){switch(e){case"skinTone":return ue;case"faceShape":return xe;case"eyeStyle":return pe;case"eyeColor":return he;case"mouthStyle":return ge;case"hairstyle":return fe;case"hairColor":return ye;case"outfit":return ve;case"outfitColor":return je;case"accessory":return Ne;case"background":return we;case"border":return ke;case"expression":return Ce;default:return[]}}function Ee(e,t){const s=fe.find(t=>t.id===e);return!s||s.compatibleFaces.includes(t)}const Te=[{id:"skinTone",name:"\ud53c\ubd80",icon:"#FFE4C4"},{id:"faceShape",name:"\uc5bc\uad74",icon:"#F5DEB3"},{id:"eyeStyle",name:"\ub208",icon:"#1E90FF"},{id:"eyeColor",name:"\ub208\uc0c9",icon:"#654321"},{id:"mouthStyle",name:"\uc785",icon:"#e74c3c"},{id:"hairstyle",name:"\ud5e4\uc5b4",icon:"#3d2314"},{id:"hairColor",name:"\uba38\ub9ac\uc0c9",icon:"#1a1a1a"},{id:"outfit",name:"\uc758\uc0c1",icon:"#3498db"},{id:"outfitColor",name:"\uc758\uc0c1\uc0c9",icon:"#e74c3c"},{id:"accessory",name:"\uc545\uc138",icon:"#f1c40f"},{id:"background",name:"\ubc30\uacbd",icon:"#87CEEB"},{id:"border",name:"\ud14c\ub450\ub9ac",icon:"#a78bfa"}];function De(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if(!e||"none"===e||"transparent"===e)return e;let s=parseInt(e.slice(1,3),16),a=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16);return s=Math.max(0,Math.floor(s*(100-t)/100)),a=Math.max(0,Math.floor(a*(100-t)/100)),n=Math.max(0,Math.floor(n*(100-t)/100)),"#".concat(s.toString(16).padStart(2,"0")).concat(a.toString(16).padStart(2,"0")).concat(n.toString(16).padStart(2,"0"))}function Me(e){let{config:t={},size:s=100,showBorder:a=!0,onClick:n}=e;const i=(0,r.A)((0,r.A)({},Se),t),l=ue.find(e=>e.id===i.skinTone)||ue[1],o=xe.find(e=>e.id===i.faceShape)||xe[1],d=pe.find(e=>e.id===i.eyeStyle)||pe[0],c=he.find(e=>e.id===i.eyeColor)||he[1],m=ge.find(e=>e.id===i.mouthStyle)||ge[0],u=fe.find(e=>e.id===i.hairstyle)||fe[1],x=ye.find(e=>e.id===i.hairColor)||ye[0],p=ve.find(e=>e.id===i.outfit)||ve[1],h=je.find(e=>e.id===i.outfitColor)||je[0],g=Ne.find(e=>e.id===i.accessory),b=we.find(e=>e.id===i.background)||we[0],f=ke.find(e=>e.id===i.border),y=De(l.color,12),v=f&&"none"!==f.id&&a?{stroke:f.gradient?"url(#border-gradient-".concat(f.id,")"):f.color,strokeWidth:f.width||3,filter:f.glow?"drop-shadow(0 0 ".concat(2*f.width,"px ").concat(f.glowColor||f.color,")"):void 0}:null,j=()=>null!==x&&void 0!==x&&x.gradient?"url(#hair-rainbow)":(null===x||void 0===x?void 0:x.color)||"#1a1a1a";return(0,z.jsxs)("svg",{width:s,height:s,viewBox:"-15 ".concat(-25," 130 ").concat(150),onClick:n,style:{cursor:n?"pointer":"default",overflow:"visible"},preserveAspectRatio:"xMidYMid meet",children:[(0,z.jsxs)("defs",{children:[(null===b||void 0===b?void 0:b.gradient)&&(0,z.jsx)("linearGradient",{id:"bg-gradient-".concat(b.id),x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:b.gradient.map((e,t)=>(0,z.jsx)("stop",{offset:"".concat(t/(b.gradient.length-1)*100,"%"),stopColor:e},t))}),(null===f||void 0===f?void 0:f.gradient)&&(0,z.jsx)("linearGradient",{id:"border-gradient-".concat(f.id),x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:f.gradient.map((e,t)=>(0,z.jsx)("stop",{offset:"".concat(t/(f.gradient.length-1)*100,"%"),stopColor:e},t))}),(null===x||void 0===x?void 0:x.gradient)&&(0,z.jsx)("linearGradient",{id:"hair-rainbow",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:x.gradient.map((e,t)=>(0,z.jsx)("stop",{offset:"".concat(t/(x.gradient.length-1)*100,"%"),stopColor:e},t))}),(0,z.jsx)("filter",{id:"shadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:(0,z.jsx)("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.3"})}),(0,z.jsx)("clipPath",{id:"face-clip",children:(0,z.jsx)("path",{d:o.path})})]}),b&&"none"!==b.id&&(0,z.jsx)("rect",{x:"-15",y:-25,width:"130",height:150,fill:b&&"none"!==b.id?b.gradient?"url(#bg-gradient-".concat(b.id,")"):b.color:"#1a1a2e",rx:"10"}),(null===b||void 0===b?void 0:b.stars)&&(0,z.jsxs)("g",{children:[(0,z.jsx)("circle",{cx:"15",cy:"10",r:"1.5",fill:"white",opacity:"0.9"}),(0,z.jsx)("circle",{cx:"85",cy:"15",r:"2",fill:"white",opacity:"0.8"}),(0,z.jsx)("circle",{cx:"45",cy:"-5",r:"1.2",fill:"white",opacity:"0.9"}),(0,z.jsx)("circle",{cx:"70",cy:"0",r:"1.5",fill:"white",opacity:"0.7"}),(0,z.jsx)("circle",{cx:"25",cy:"20",r:"1",fill:"white",opacity:"0.8"}),(0,z.jsx)("circle",{cx:"95",cy:"25",r:"1.2",fill:"white",opacity:"0.7"}),(0,z.jsx)("circle",{cx:"5",cy:"30",r:"1.5",fill:"white",opacity:"0.6"}),(0,z.jsx)("circle",{cx:"60",cy:"100",r:"1",fill:"white",opacity:"0.9"}),(0,z.jsx)("circle",{cx:"30",cy:"110",r:"1.2",fill:"white",opacity:"0.7"})]}),(0,z.jsx)("rect",{x:"42",y:"85",width:"16",height:"12",fill:l.color}),p&&"none"!==p.id&&(0,z.jsxs)("g",{children:[(0,z.jsx)("path",{d:p.path,fill:(null===h||void 0===h?void 0:h.color)||p.baseColor}),p.collar&&(0,z.jsx)("g",{children:(0,z.jsx)("path",{d:"M40,95 L50,103 L60,95",stroke:"#ffffff",strokeWidth:"3",fill:"none"})}),p.buttons&&(0,z.jsxs)("g",{children:[(0,z.jsx)("circle",{cx:"50",cy:"103",r:"2",fill:"#f1c40f"}),(0,z.jsx)("circle",{cx:"50",cy:"110",r:"2",fill:"#f1c40f"})]}),p.tie&&(0,z.jsxs)("g",{children:[(0,z.jsx)("path",{d:"M47,95 L50,98 L53,95",fill:"#c0392b"}),(0,z.jsx)("path",{d:"M48,98 L50,118 L52,98 Z",fill:"#e74c3c"})]}),p.hood&&(0,z.jsx)("path",{d:"M25,92 Q22,80 35,75 L65,75 Q78,80 75,92",fill:De((null===h||void 0===h?void 0:h.color)||p.baseColor,15)})]}),(0,z.jsxs)("g",{children:[(()=>{const e={round:{leftX:7,rightX:93,y:50},oval:{leftX:9,rightX:91,y:48},square:{leftX:7,rightX:93,y:50},heart:{leftX:7,rightX:93,y:48},long:{leftX:17,rightX:83,y:50}},t=e[o.id]||e.round;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("ellipse",{cx:t.leftX,cy:t.y,rx:"5",ry:"8",fill:l.color}),(0,z.jsx)("ellipse",{cx:t.leftX+1,cy:t.y,rx:"2",ry:"4",fill:De(l.color,12)}),(0,z.jsx)("ellipse",{cx:t.rightX,cy:t.y,rx:"5",ry:"8",fill:l.color}),(0,z.jsx)("ellipse",{cx:t.rightX-1,cy:t.y,rx:"2",ry:"4",fill:De(l.color,12)})]})})(),(0,z.jsx)("path",{d:o.path,fill:l.color}),(0,z.jsx)("ellipse",{cx:"30",cy:"60",rx:"8",ry:"5",fill:"#ffb6c1",opacity:"0.3"}),(0,z.jsx)("ellipse",{cx:"70",cy:"60",rx:"8",ry:"5",fill:"#ffb6c1",opacity:"0.3"})]}),(0,z.jsxs)("g",{children:[(0,z.jsx)("ellipse",{cx:d.leftX,cy:d.y,rx:d.size,ry:.75*d.size,fill:"white"}),(0,z.jsx)("circle",{cx:d.leftX,cy:d.y,r:.55*d.size,fill:c.color}),(0,z.jsx)("circle",{cx:d.leftX-1,cy:d.y-1,r:.22*d.size,fill:"white"}),(0,z.jsx)("ellipse",{cx:d.rightX,cy:d.y,rx:d.size,ry:.75*d.size,fill:"white"}),(0,z.jsx)("circle",{cx:d.rightX,cy:d.y,r:.55*d.size,fill:c.color}),(0,z.jsx)("circle",{cx:d.rightX-1,cy:d.y-1,r:.22*d.size,fill:"white"}),(0,z.jsx)("path",{d:"M".concat(d.leftX-7,",").concat(d.y-11," Q").concat(d.leftX,",").concat(d.y-14," ").concat(d.leftX+7,",").concat(d.y-11),stroke:null!==x&&void 0!==x&&x.gradient?"#1a1a1a":(null===x||void 0===x?void 0:x.color)||"#1a1a1a",strokeWidth:"2.5",fill:"none",strokeLinecap:"round"}),(0,z.jsx)("path",{d:"M".concat(d.rightX-7,",").concat(d.y-11," Q").concat(d.rightX,",").concat(d.y-14," ").concat(d.rightX+7,",").concat(d.y-11),stroke:null!==x&&void 0!==x&&x.gradient?"#1a1a1a":(null===x||void 0===x?void 0:x.color)||"#1a1a1a",strokeWidth:"2.5",fill:"none",strokeLinecap:"round"})]}),(0,z.jsx)("path",{d:"M48,53 L50,60 L52,53",stroke:y,strokeWidth:"2.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),(0,z.jsx)("path",{d:m.path,stroke:m.stroke?"#c0392b":"none",strokeWidth:"2.5",fill:m.fill?"#c0392b":"none",strokeLinecap:"round"}),u&&"none"!==u.id&&(0,z.jsxs)("g",{children:[u.paths&&u.paths[0]&&(0,z.jsx)("path",{d:u.paths[0],fill:j(),stroke:"#1a1a1a"===(null===x||void 0===x?void 0:x.color)?"#333":"none",strokeWidth:"1"}),u.paths&&u.paths.slice(1).map((e,t)=>(0,z.jsx)("path",{d:e,fill:j(),stroke:"#1a1a1a"===(null===x||void 0===x?void 0:x.color)?"#333":"none",strokeWidth:"1"},"hair-".concat(t))),u.bangsPath&&(0,z.jsx)("path",{d:u.bangsPath,fill:j(),stroke:"#1a1a1a"===(null===x||void 0===x?void 0:x.color)?"#333":"none",strokeWidth:"1"})]}),g&&"none"!==g.id&&(0,z.jsxs)("g",{children:["glasses"===g.id&&(0,z.jsxs)("g",{children:[(0,z.jsx)("circle",{cx:"35",cy:"45",r:"10",fill:"none",stroke:"#1a1a1a",strokeWidth:"2"}),(0,z.jsx)("circle",{cx:"65",cy:"45",r:"10",fill:"none",stroke:"#1a1a1a",strokeWidth:"2"}),(0,z.jsx)("path",{d:"M45,45 Q50,42 55,45",fill:"none",stroke:"#1a1a1a",strokeWidth:"2"}),(0,z.jsx)("path",{d:"M25,45 L10,42",stroke:"#1a1a1a",strokeWidth:"2"}),(0,z.jsx)("path",{d:"M75,45 L90,42",stroke:"#1a1a1a",strokeWidth:"2"})]}),"sunglasses"===g.id&&(0,z.jsxs)("g",{children:[(0,z.jsx)("ellipse",{cx:"35",cy:"45",rx:"12",ry:"8",fill:"#1a1a1a"}),(0,z.jsx)("ellipse",{cx:"65",cy:"45",rx:"12",ry:"8",fill:"#1a1a1a"}),(0,z.jsx)("path",{d:"M47,45 Q50,42 53,45",fill:"none",stroke:"#1a1a1a",strokeWidth:"2"}),(0,z.jsx)("path",{d:"M23,45 L8,42",stroke:"#1a1a1a",strokeWidth:"2"}),(0,z.jsx)("path",{d:"M77,45 L92,42",stroke:"#1a1a1a",strokeWidth:"2"}),(0,z.jsx)("ellipse",{cx:"32",cy:"43",rx:"3",ry:"2",fill:"white",opacity:"0.3"}),(0,z.jsx)("ellipse",{cx:"62",cy:"43",rx:"3",ry:"2",fill:"white",opacity:"0.3"})]}),"earrings"===g.id&&(0,z.jsxs)("g",{children:[(0,z.jsx)("circle",{cx:"6",cy:"58",r:"4",fill:"#f1c40f"}),(0,z.jsx)("circle",{cx:"94",cy:"58",r:"4",fill:"#f1c40f"}),(0,z.jsx)("circle",{cx:"5",cy:"56",r:"1",fill:"white",opacity:"0.6"}),(0,z.jsx)("circle",{cx:"93",cy:"56",r:"1",fill:"white",opacity:"0.6"})]}),"necklace"===g.id&&(0,z.jsxs)("g",{children:[(0,z.jsx)("path",{d:"M30,88 Q50,95 70,88",fill:"none",stroke:"#f1c40f",strokeWidth:"2"}),(0,z.jsx)("circle",{cx:"50",cy:"94",r:"4",fill:"#f1c40f"}),(0,z.jsx)("circle",{cx:"49",cy:"92",r:"1",fill:"white",opacity:"0.5"})]}),"hat"===g.id&&(0,z.jsxs)("g",{children:[(0,z.jsx)("ellipse",{cx:"50",cy:"8",rx:"45",ry:"8",fill:"#e74c3c"}),(0,z.jsx)("path",{d:"M15,8 Q15,-15 50,-18 Q85,-15 85,8",fill:"#e74c3c"}),(0,z.jsx)("rect",{x:"15",y:"5",width:"70",height:"5",fill:"#c0392b"})]}),"crown"===g.id&&(0,z.jsxs)("g",{children:[(0,z.jsx)("path",{d:"M18,12 L22,0 L32,-12 L42,5 L50,-15 L58,5 L68,-12 L78,0 L82,12 Z",fill:"#f1c40f",stroke:"#d4ac0d",strokeWidth:"1"}),(0,z.jsx)("circle",{cx:"32",cy:"-2",r:"4",fill:"#e74c3c"}),(0,z.jsx)("circle",{cx:"50",cy:"-5",r:"5",fill:"#3498db"}),(0,z.jsx)("circle",{cx:"68",cy:"-2",r:"4",fill:"#2ecc71"}),(0,z.jsx)("circle",{cx:"31",cy:"-4",r:"1.5",fill:"white",opacity:"0.5"}),(0,z.jsx)("circle",{cx:"49",cy:"-7",r:"2",fill:"white",opacity:"0.5"}),(0,z.jsx)("circle",{cx:"67",cy:"-4",r:"1.5",fill:"white",opacity:"0.5"})]}),"headband"===g.id&&(0,z.jsx)("path",{d:"M10,22 Q50,15 90,22",fill:"none",stroke:"#ff69b4",strokeWidth:"4"}),"bow"===g.id&&(0,z.jsxs)("g",{transform:"translate(78, 15)",children:[(0,z.jsx)("ellipse",{cx:"-10",cy:"0",rx:"10",ry:"6",fill:"#ff69b4"}),(0,z.jsx)("ellipse",{cx:"10",cy:"0",rx:"10",ry:"6",fill:"#ff69b4"}),(0,z.jsx)("circle",{cx:"0",cy:"0",r:"5",fill:"#e91e8c"})]}),"mask"===g.id&&(0,z.jsxs)("g",{children:[(0,z.jsx)("path",{d:"M20,55 Q50,72 80,55 L80,70 Q50,88 20,70 Z",fill:"#ffffff",stroke:"#e0e0e0",strokeWidth:"1"}),(0,z.jsx)("path",{d:"M35,62 L65,62",stroke:"#e0e0e0",strokeWidth:"1"})]})]}),v&&a&&(0,z.jsx)("rect",{x:"-13",y:-23,width:"126",height:146,fill:"none",stroke:v.stroke,strokeWidth:v.strokeWidth,rx:"12",style:{filter:v.filter}})]})}const Fe=[{level:0,minAssets:0,title:"\uacbd\uc81c \uc785\ubb38\uc790",icon:"\ud83c\udf31",color:"#6b7280",badge:"\ud83c\udfc5",description:"\uacbd\uc81c \uc5ec\uc815\uc758 \uc2dc\uc791"},{level:1,minAssets:1e7,title:"\ucc9c\ub9cc\uc7a5\uc790",icon:"\ud83d\udcb0",color:"#22c55e",badge:"\ud83e\udd49",description:"\uccab \ucc9c\ub9cc\uc6d0 \ub2ec\uc131!"},{level:2,minAssets:5e7,title:"\uc624\ucc9c\ub9cc \ud074\ub7fd",icon:"\ud83d\udcb5",color:"#84cc16",badge:"\ud83e\udd48",description:"\ubc18\uc5b5 \ub3cc\ud30c!"},{level:3,minAssets:1e8,title:"\uc5b5\ub300 \uc790\uc0b0\uac00",icon:"\ud83d\udc8e",color:"#eab308",badge:"\ud83e\udd47",description:"\uc5b5\ub300 \uc790\uc0b0 \ubcf4\uc720\uc790"},{level:4,minAssets:2e8,title:"\uc790\uc0b0 \uad00\ub9ac\uc0ac",icon:"\ud83d\udcca",color:"#f97316",badge:"\ud83c\udfc6",description:"2\uc5b5 \uc790\uc0b0 \ub2ec\uc131"},{level:5,minAssets:3e8,title:"\ud22c\uc790 \uc804\ubb38\uac00",icon:"\ud83d\udcc8",color:"#ef4444",badge:"\ud83d\udcab",description:"3\uc5b5 \uace0\uc9c0 \uc810\ub839"},{level:6,minAssets:5e8,title:"\ubd80\ub3d9\uc0b0 \uc655",icon:"\ud83c\udfe2",color:"#ec4899",badge:"\u2b50",description:"5\uc5b5 \uc790\uc0b0\uac00"},{level:7,minAssets:1e9,title:"10\uc5b5 \ud074\ub7fd",icon:"\ud83d\udc51",color:"#a855f7",badge:"\ud83c\udf1f",description:"10\uc5b5 \ub3cc\ud30c! \uc9c4\uc815\ud55c \ubd80\uc790"},{level:8,minAssets:5e9,title:"\uacbd\uc81c \uac70\ubb3c",icon:"\ud83e\udd81",color:"#8b5cf6",badge:"\ud83d\udc8e",description:"50\uc5b5 \uc790\uc0b0\uc758 \uac70\ubb3c"},{level:9,minAssets:1e10,title:"100\uc5b5 \uc7ac\ubc8c",icon:"\ud83d\udc09",color:"#6366f1",badge:"\ud83d\udc51",description:"100\uc5b5! \uc7ac\ubc8c\uc758 \ubc18\uc5f4"},{level:10,minAssets:5e10,title:"\uacbd\uc81c \ud669\uc81c",icon:"\ud83c\udff0",color:"#3b82f6",badge:"\ud83c\udfef",description:"500\uc5b5 \uacbd\uc81c \ud669\uc81c"},{level:11,minAssets:1e11,title:"\ucc9c\uc5b5 \ud0c0\uc774\ucfe4",icon:"\ud83c\udf0d",color:"#0ea5e9",badge:"\ud83c\udf0d",description:"1000\uc5b5! \uae00\ub85c\ubc8c \ud0c0\uc774\ucfe4"},{level:12,minAssets:1e12,title:"\uc54c\ucc2c \uc804\uc124",icon:"\ud83c\udf0c",color:"#00fff2",badge:"\ud83c\udf0c",description:"1\uc870 \ub2ec\uc131! \uc804\uc124\uc774 \ub418\ub2e4"}];function Oe(e){const t=Number(e)||0;let s=Fe[0];for(let l=Fe.length-1;l>=0;l--)if(t>=Fe[l].minAssets){s=Fe[l];break}const a=Fe.findIndex(e=>e.level===s.level+1),n=-1!==a?Fe[a]:null;let i=100;if(n){const e=s.minAssets,a=n.minAssets;i=Math.min(100,Math.floor((t-e)/(a-e)*100))}return{level:s.level,title:s.title,icon:s.icon,color:s.color,badge:s.badge,description:s.description,progress:i,nextLevel:n,currentAssets:t,assetsToNextLevel:n?n.minAssets-t:0}}const _e={FIRST_THOUSAND:{id:"first_thousand",name:"\uccab \ucc9c \uc6d0",description:"1,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83e\ude99",category:"wealth",condition:e=>e.totalAssets>=1e3,rarity:"common",points:10},FIRST_TEN_THOUSAND:{id:"first_ten_thousand",name:"\ub9cc \uc6d0\uc758 \uae30\uc068",description:"10,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83d\udcb5",category:"wealth",condition:e=>e.totalAssets>=1e4,rarity:"common",points:25},HUNDRED_THOUSAND:{id:"hundred_thousand",name:"10\ub9cc \uc6d0 \ud074\ub7fd",description:"100,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83d\udcb0",category:"wealth",condition:e=>e.totalAssets>=1e5,rarity:"uncommon",points:50},MILLIONAIRE:{id:"millionaire",name:"\ubc31\ub9cc\uc7a5\uc790",description:"1,000,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83e\udd11",category:"wealth",condition:e=>e.totalAssets>=1e6,rarity:"rare",points:100},MULTI_MILLIONAIRE:{id:"multi_millionaire",name:"\ucc9c\ub9cc\uc7a5\uc790",description:"10,000,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83d\udc8e",category:"wealth",condition:e=>e.totalAssets>=1e7,rarity:"legendary",points:500},COUPON_COLLECTOR:{id:"coupon_collector",name:"\ucfe0\ud3f0 \uc218\uc9d1\uac00",description:"\ucfe0\ud3f0 10\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udf9f\ufe0f",category:"coupon",condition:e=>e.coupons>=10,rarity:"common",points:15},COUPON_MASTER:{id:"coupon_master",name:"\ucfe0\ud3f0 \ub9c8\uc2a4\ud130",description:"\ucfe0\ud3f0 50\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udfab",category:"coupon",condition:e=>e.coupons>=50,rarity:"uncommon",points:40},COUPON_HOARDER:{id:"coupon_hoarder",name:"\ucfe0\ud3f0 \ubd80\uc790",description:"\ucfe0\ud3f0 100\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udff7\ufe0f",category:"coupon",condition:e=>e.coupons>=100,rarity:"rare",points:80},FIRST_TRADE:{id:"first_trade",name:"\uccab \uac70\ub798",description:"\uccab \ubc88\uc9f8 \uac70\ub798 \uc644\ub8cc\ud558\uae30",icon:"\ud83e\udd1d",category:"trading",condition:e=>e.totalTransactions>=1,rarity:"common",points:10},ACTIVE_TRADER:{id:"active_trader",name:"\ud65c\ubc1c\ud55c \uac70\ub798\uc790",description:"10\ud68c \uc774\uc0c1 \uac70\ub798\ud558\uae30",icon:"\ud83d\udcca",category:"trading",condition:e=>e.totalTransactions>=10,rarity:"common",points:25},TRADING_EXPERT:{id:"trading_expert",name:"\uac70\ub798 \uc804\ubb38\uac00",description:"50\ud68c \uc774\uc0c1 \uac70\ub798\ud558\uae30",icon:"\ud83d\udcc8",category:"trading",condition:e=>e.totalTransactions>=50,rarity:"uncommon",points:50},GENEROUS_HEART:{id:"generous_heart",name:"\ub530\ub73b\ud55c \ub9c8\uc74c",description:"\ud559\uae09 \ubaa9\ud45c\uc5d0 \ucc98\uc74c\uc73c\ub85c \uae30\ubd80\ud558\uae30",icon:"\u2764\ufe0f",category:"donation",condition:e=>e.totalDonations>=1,rarity:"common",points:20},PHILANTHROPIST:{id:"philanthropist",name:"\uc790\uc120\uac00",description:"\ucd1d 10\uac1c \uc774\uc0c1 \uae30\ubd80\ud558\uae30",icon:"\ud83c\udf81",category:"donation",condition:e=>e.totalDonations>=10,rarity:"uncommon",points:50},DONATION_KING:{id:"donation_king",name:"\uae30\ubd80\uc655",description:"\ucd1d 100\uac1c \uc774\uc0c1 \uae30\ubd80\ud558\uae30",icon:"\ud83d\udc51",category:"donation",condition:e=>e.totalDonations>=100,rarity:"rare",points:150},SAVER_BEGINNER:{id:"saver_beginner",name:"\uc800\ucd95\uc758 \uc2dc\uc791",description:"\uccab \uc608\uae08 \ub610\ub294 \uc801\uae08 \uac00\uc785\ud558\uae30",icon:"\ud83c\udfe6",category:"saving",condition:e=>e.savingProducts>=1,rarity:"common",points:15},SMART_SAVER:{id:"smart_saver",name:"\ub611\ub611\ud55c \uc800\ucd95\ub7ec",description:"\uc608\uae08/\uc801\uae08 3\uac1c \uc774\uc0c1 \uac00\uc785\ud558\uae30",icon:"\ud83d\udcb3",category:"saving",condition:e=>e.savingProducts>=3,rarity:"uncommon",points:40},FIRST_PROPERTY:{id:"first_property",name:"\uccab \ubd80\ub3d9\uc0b0",description:"\uccab \ubc88\uc9f8 \ubd80\ub3d9\uc0b0 \uad6c\ub9e4\ud558\uae30",icon:"\ud83c\udfe0",category:"realestate",condition:e=>e.properties>=1,rarity:"common",points:30},REAL_ESTATE_INVESTOR:{id:"real_estate_investor",name:"\ubd80\ub3d9\uc0b0 \ud22c\uc790\uc790",description:"\ubd80\ub3d9\uc0b0 3\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udfe2",category:"realestate",condition:e=>e.properties>=3,rarity:"uncommon",points:70},PROPERTY_TYCOON:{id:"property_tycoon",name:"\ubd80\ub3d9\uc0b0 \uc7ac\ubc8c",description:"\ubd80\ub3d9\uc0b0 5\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udff0",category:"realestate",condition:e=>e.properties>=5,rarity:"rare",points:150},PERFECT_ATTENDANCE:{id:"perfect_attendance",name:"\uac1c\uadfc\uc0c1",description:"7\uc77c \uc5f0\uc18d \uc811\uc18d\ud558\uae30",icon:"\ud83d\udcc5",category:"special",condition:e=>e.loginStreak>=7,rarity:"uncommon",points:100},MONTHLY_STREAK:{id:"monthly_streak",name:"\ud55c \ub2ec \ucd9c\uc11d\uc655",description:"30\uc77c \uc5f0\uc18d \uc811\uc18d\ud558\uae30",icon:"\ud83d\uddd3\ufe0f",category:"special",condition:e=>e.loginStreak>=30,rarity:"rare",points:300},EARLY_BIRD:{id:"early_bird",name:"\uc5bc\ub9ac\ubc84\ub4dc",description:"\uc11c\ube44\uc2a4 \ucd08\uae30 \uc0ac\uc6a9\uc790",icon:"\ud83d\udc26",category:"special",condition:()=>!1,rarity:"legendary",points:200}};function Re(e){return Object.values(_e).find(t=>t.id===e)||null}function ze(e){if(!e)return[];try{const t="alchan_achievements_".concat(e),s=localStorage.getItem(t);return s?JSON.parse(s):[]}catch(t){return te.vF.error("\uc5c5\uc801 \ub370\uc774\ud130 \ub85c\ub4dc \uc2e4\ud328:",t),[]}}var Le=s(8343);const Pe=e=>(0,Le.FR)(e,""),We=e=>{let{isOpen:t,onClose:s,title:a,children:n}=e;return t?(0,z.jsx)("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",onClick:s,children:(0,z.jsxs)("div",{className:"bg-[#1a1a2e] rounded-2xl shadow-2xl w-full max-w-md overflow-hidden border border-slate-700",onClick:e=>e.stopPropagation(),children:[(0,z.jsxs)("div",{className:"px-6 py-5 border-b border-slate-700 bg-gradient-to-r from-[#141423] to-indigo-900/20 flex items-center justify-between",children:[(0,z.jsx)("h3",{className:"text-lg font-bold text-white",children:a}),(0,z.jsx)("button",{onClick:s,className:"w-8 h-8 rounded-lg bg-slate-800 hover:bg-slate-700 flex items-center justify-center text-slate-400 transition-colors",children:(0,z.jsx)(_.A,{size:18})})]}),(0,z.jsx)("div",{className:"p-6",children:n})]})}):null},Be=(0,a.memo)(e=>{let{toggleSidebar:t,isMobile:s,isSidebarCollapsed:l,onToggleSidebarCollapse:r}=e;const d=(0,n.Zp)(),{user:c,userDoc:m,logout:u,updateUser:x,changePassword:p,deleteCurrentUserAccount:h,loginWithEmailPassword:g}=(0,i.As)(),[b,f]=(0,a.useState)(!1),[y,v]=(0,a.useState)(!1),j=(0,a.useRef)(null),[N,k]=(0,a.useState)(null),[C,S]=(0,a.useState)(!1),[A,I]=(0,a.useState)(""),[E,T]=(0,a.useState)(""),[M,F]=(0,a.useState)(""),[O,_]=(0,a.useState)(""),[L,P]=(0,a.useState)(""),[W,B]=(0,a.useState)(""),[q,U]=(0,a.useState)(!1),[Q,G]=(0,a.useState)(""),[$,ee]=(0,a.useState)(""),[te,se]=(0,a.useState)(!1),ae=(null===m||void 0===m?void 0:m.isAdmin)||"admin"===(null===m||void 0===m?void 0:m.role)||(null===m||void 0===m?void 0:m.isSuperAdmin),ne=(null===m||void 0===m?void 0:m.name)||(null===m||void 0===m?void 0:m.nickname)||(null===c||void 0===c?void 0:c.displayName)||"\uc0ac\uc6a9\uc790";let ie="\ud559\uc0dd";null!==m&&void 0!==m&&m.isSuperAdmin?ie="\uc571 \uad00\ub9ac\uc790":null!==m&&void 0!==m&&m.isAdmin&&(ie="\uad50\uc0ac");const[le,re]=(0,a.useState)(null);(0,a.useEffect)(()=>{null!==c&&void 0!==c&&c.uid&&re(Ae(c.uid));const e=e=>{e.detail.userId===(null===c||void 0===c?void 0:c.uid)&&re(e.detail.config)};return window.addEventListener("avatarChanged",e),()=>window.removeEventListener("avatarChanged",e)},[null===c||void 0===c?void 0:c.uid]);const oe=(0,a.useMemo)(()=>Oe((Number(null===m||void 0===m?void 0:m.cash)||0)+(Number(null===m||void 0===m?void 0:m.stockValue)||0)+(Number(null===m||void 0===m?void 0:m.realEstateValue)||0)+(Number(null===m||void 0===m?void 0:m.itemValue)||0)),[null===m||void 0===m?void 0:m.cash,null===m||void 0===m?void 0:m.stockValue,null===m||void 0===m?void 0:m.realEstateValue,null===m||void 0===m?void 0:m.itemValue]),de=(0,a.useMemo)(()=>{if(null===c||void 0===c||!c.uid)return null;const e=ze(c.uid);if(0===e.length)return null;const t={legendary:0,epic:1,rare:2,common:3},s=[...e].sort((e,s)=>{const a=Re(e.id),n=Re(s.id);return(t[null===a||void 0===a?void 0:a.rarity]||99)-(t[null===n||void 0===n?void 0:n.rarity]||99)});return Re(s[0].id)},[null===c||void 0===c?void 0:c.uid]);(0,a.useEffect)(()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&f(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const ce=()=>{k(null),T(""),B(""),U(!1),ee(""),se(!1),F(""),_(""),P("")};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("header",{className:"md:hidden sticky top-0 z-30 bg-[#141423] border-b border-[#00fff2]/10",children:[(0,z.jsxs)("div",{className:"h-14 px-3 flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,z.jsx)("button",{onClick:t,className:"p-1.5 rounded-lg hover:bg-white/5 transition-colors",children:(0,z.jsx)(o.A,{size:22,className:"text-white"})}),(0,z.jsxs)("h2",{className:"text-sm font-bold text-white whitespace-nowrap",children:["\uc624\ub298\ub3c4 ",(0,z.jsx)("span",{className:"text-[#00fff2]",children:"\uc54c\ucc2c"})," \ud558\ub8e8!"]})]}),(0,z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,z.jsxs)("div",{onClick:()=>d("/my-profile"),className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg cursor-pointer",style:{background:"rgba(167, 139, 250, 0.2)"},children:[(0,z.jsx)("span",{className:"text-sm",children:(null===oe||void 0===oe?void 0:oe.icon)||"\ud83c\udf1f"}),(0,z.jsxs)("div",{className:"flex flex-col leading-none",children:[(0,z.jsx)("span",{className:"text-[9px] text-gray-400",children:"LEVEL"}),(0,z.jsx)("span",{className:"text-xs font-bold",style:{color:(null===oe||void 0===oe?void 0:oe.color)||"#a78bfa"},children:(null===oe||void 0===oe?void 0:oe.level)||1})]}),de&&(0,z.jsx)("span",{className:"text-sm ml-0.5",children:de.icon})]}),(0,z.jsx)("div",{onClick:()=>f(!b),className:"cursor-pointer",children:(0,z.jsx)(Me,{config:le,size:40,showBorder:!0})})]})]}),(0,z.jsxs)("div",{className:"px-4 pb-3 flex gap-3",children:[(0,z.jsxs)("div",{className:"flex-1 flex items-center gap-2 px-3 py-2 bg-emerald-900/10 rounded-xl border border-emerald-500/20",children:[(0,z.jsx)("div",{className:"w-8 h-8 rounded-lg bg-emerald-600 text-white flex items-center justify-center shadow-sm flex-shrink-0",children:(0,z.jsx)("span",{className:"font-bold text-xs",children:"\u20a9"})}),(0,z.jsxs)("div",{className:"min-w-0",children:[(0,z.jsx)("p",{className:"text-[9px] text-emerald-400 font-bold uppercase tracking-wider leading-none",children:"\ud604\uae08"}),(0,z.jsxs)("p",{className:"text-sm font-bold text-white truncate",children:[Pe((null===m||void 0===m?void 0:m.cash)||0),"\uc6d0"]})]})]}),(0,z.jsxs)("div",{className:"flex-1 flex items-center gap-2 px-3 py-2 bg-rose-900/10 rounded-xl border border-rose-500/20",children:[(0,z.jsx)("div",{className:"w-8 h-8 rounded-lg bg-rose-600 text-white flex items-center justify-center shadow-sm flex-shrink-0",children:(0,z.jsx)(H.A,{size:14})}),(0,z.jsxs)("div",{className:"min-w-0",children:[(0,z.jsx)("p",{className:"text-[9px] text-rose-400 font-bold uppercase tracking-wider leading-none",children:"\ucfe0\ud3f0"}),(0,z.jsxs)("p",{className:"text-sm font-bold text-white truncate",children:[(null===m||void 0===m?void 0:m.coupons)||0,"\uac1c"]})]})]})]})]}),(0,z.jsxs)("header",{className:"hidden md:flex items-center justify-between bg-[#141423] border-b border-[#00fff2]/10 shadow-sm z-10 h-16 min-h-16 max-h-16 px-4",children:[(0,z.jsxs)("div",{className:"flex items-center gap-3",children:[(0,z.jsx)("button",{onClick:r,className:"p-2 rounded-lg border border-[#00fff2]/10 bg-white/5 text-white cursor-pointer flex items-center justify-center",children:l?(0,z.jsx)(V.A,{size:16}):(0,z.jsx)(K.A,{size:16})}),(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"text-[15px] font-bold text-white whitespace-nowrap leading-tight",children:["\uc624\ub298\ub3c4 ",(0,z.jsx)("span",{className:"text-[#00fff2]",style:{fontFamily:"'Jua', sans-serif"},children:"\uc54c\ucc2c"})," \ud558\ub8e8! \ud83d\udc4b"]}),(0,z.jsxs)("div",{className:"text-xs text-slate-400 whitespace-nowrap leading-tight",children:[ne,"\ub2d8 \ud658\uc601\ud569\ub2c8\ub2e4"]})]})]}),(0,z.jsxs)("div",{className:"flex items-center gap-3",children:[(0,z.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-900/10 rounded-lg text-emerald-400",children:[(0,z.jsx)("div",{className:"w-8 h-8 rounded-lg bg-emerald-600 text-white flex items-center justify-center font-bold text-xs",children:"\u20a9"}),(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"text-[10px] font-semibold opacity-70 leading-tight",children:"\ud604\uae08"}),(0,z.jsxs)("div",{className:"text-[13px] font-bold whitespace-nowrap leading-tight",children:[Pe((null===m||void 0===m?void 0:m.cash)||0),"\uc6d0"]})]})]}),(0,z.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-rose-900/10 rounded-lg text-rose-400",children:[(0,z.jsx)("div",{className:"w-8 h-8 rounded-lg bg-rose-600 text-white flex items-center justify-center",children:(0,z.jsx)(H.A,{size:14})}),(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"text-[10px] font-semibold opacity-70 leading-tight",children:"\ucfe0\ud3f0"}),(0,z.jsxs)("div",{className:"text-[13px] font-bold whitespace-nowrap leading-tight",children:[(null===m||void 0===m?void 0:m.coupons)||0,"\uac1c"]})]})]}),(0,z.jsxs)("div",{onClick:()=>d("/my-profile"),className:"flex items-center gap-2 px-3 py-1.5 bg-violet-500/10 rounded-lg cursor-pointer transition-all duration-200 hover:bg-violet-500/20",children:[(0,z.jsx)("div",{className:"flex items-center justify-center w-7 h-7 rounded-md text-sm",style:{background:(null===oe||void 0===oe?void 0:oe.color)||"#a78bfa"},children:(null===oe||void 0===oe?void 0:oe.icon)||"\ud83c\udf1f"}),(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"text-[10px] font-semibold leading-tight",style:{color:(null===oe||void 0===oe?void 0:oe.color)||"#a78bfa"},children:["Lv.",(null===oe||void 0===oe?void 0:oe.level)||1]}),(0,z.jsx)("div",{className:"text-[11px] font-bold text-[#e8e8ff] whitespace-nowrap leading-tight",children:(null===oe||void 0===oe?void 0:oe.title)||"\uc0c8\uc2f9"})]}),de&&(0,z.jsx)("div",{className:"flex items-center gap-1 ml-1 px-1.5 py-0.5 rounded",style:{background:"legendary"===de.rarity?"rgba(245, 158, 11, 0.2)":"epic"===de.rarity?"rgba(167, 139, 250, 0.2)":"rare"===de.rarity?"rgba(59, 130, 246, 0.2)":"rgba(107, 114, 128, 0.2)"},children:(0,z.jsx)("span",{className:"text-xs",children:de.icon})})]}),(0,z.jsxs)("div",{className:"relative",ref:j,children:[(0,z.jsxs)("button",{onClick:()=>f(!b),className:"flex items-center gap-2 pl-3 border-l border-white/10 bg-transparent cursor-pointer",style:{border:"none"},children:[(0,z.jsxs)("div",{className:"text-right",children:[(0,z.jsx)("div",{className:"text-[13px] font-bold text-white whitespace-nowrap leading-tight",children:ne}),(0,z.jsx)("div",{className:"text-[11px] text-indigo-400 font-medium whitespace-nowrap leading-tight",children:ie})]}),(0,z.jsx)("div",{onClick:e=>{e.stopPropagation(),d("/my-profile")},className:"cursor-pointer",children:(0,z.jsx)(Me,{config:le,size:40,showBorder:!0})})]}),b&&(0,z.jsxs)("div",{className:"absolute top-full right-0 mt-2 w-72 bg-[#1a1a2e] rounded-2xl shadow-2xl border border-slate-700 overflow-hidden z-50",children:[(0,z.jsxs)("div",{className:"px-5 py-4 bg-gradient-to-r from-[#141423] to-indigo-900/20 border-b border-slate-700",children:[(0,z.jsx)("p",{className:"font-bold text-white",children:ne}),(0,z.jsxs)("p",{className:"text-sm text-slate-400 flex items-center gap-2 mt-1",children:[ae&&(0,z.jsx)("span",{className:"text-indigo-400 font-semibold",children:"\uad00\ub9ac\uc790"}),(null===m||void 0===m?void 0:m.classCode)&&(0,z.jsxs)("span",{children:["\ud559\uae09: ",m.classCode]})]})]}),(0,z.jsxs)("div",{className:"md:hidden px-5 py-4 bg-[#141423]/50 border-b border-slate-700",children:[(0,z.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,z.jsx)("span",{className:"text-sm text-slate-400",children:"\ud604\uae08"}),(0,z.jsxs)("span",{className:"font-bold text-emerald-400",children:[Pe((null===m||void 0===m?void 0:m.cash)||0),"\uc6d0"]})]}),(0,z.jsxs)("div",{className:"flex justify-between items-center",children:[(0,z.jsx)("span",{className:"text-sm text-slate-400",children:"\ucfe0\ud3f0"}),(0,z.jsxs)("span",{className:"font-bold text-rose-400",children:[(null===m||void 0===m?void 0:m.coupons)||0,"\uac1c"]})]})]}),(0,z.jsxs)("div",{className:"p-2",children:[(0,z.jsxs)("button",{onClick:()=>{d("/my-profile"),f(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-white hover:bg-indigo-600/20 transition-colors bg-indigo-500/10 border border-indigo-500/30 mb-2",children:[(0,z.jsx)(X.A,{size:18,className:"text-indigo-400"}),"\ub0b4 \ud504\ub85c\ud544",(0,z.jsxs)("span",{className:"ml-auto text-xs text-indigo-400",children:["Lv.",(null===oe||void 0===oe?void 0:oe.level)||0]})]}),(0,z.jsx)("div",{className:"h-px bg-slate-700 my-2"}),(0,z.jsxs)("button",{onClick:()=>{I((null===m||void 0===m?void 0:m.name)||(null===m||void 0===m?void 0:m.nickname)||""),k("nickname"),f(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,z.jsx)(X.A,{size:18,className:"text-slate-500"}),"\ub2c9\ub124\uc784 \ubcc0\uacbd"]}),(0,z.jsxs)("button",{onClick:()=>{k("password"),f(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,z.jsx)(Y.A,{size:18,className:"text-slate-500"}),"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"]}),(0,z.jsxs)("button",{onClick:()=>{G((null===m||void 0===m?void 0:m.classCode)||""),k("classCode"),f(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,z.jsx)(w.A,{size:18,className:"text-slate-500"}),"\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd"]}),(0,z.jsxs)("button",{onClick:()=>{S(!0),f(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,z.jsx)(D.A,{size:18,className:"text-slate-500"}),"\uc124\uc815"]}),(0,z.jsx)("div",{className:"h-px bg-slate-700 my-2"}),(0,z.jsxs)("button",{onClick:async()=>{f(!1);if("\uacc4\uc815\uc0ad\uc81c"===window.prompt("\uc815\ub9d0\ub85c \uacc4\uc815\uc744 \uc0ad\uc81c\ud558\uc2dc\ub824\uba74 '\uacc4\uc815\uc0ad\uc81c'\ub77c\uace0 \uc785\ub825\ud574\uc8fc\uc138\uc694.")){const t=window.prompt("\ud604\uc7ac \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.");if(t)try{await g(c.email,t,!0),await h(),alert("\uacc4\uc815\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(e){alert("\uc0ad\uc81c \uc624\ub958: ".concat(e.message))}}},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-red-400 hover:bg-red-900/10 transition-colors",children:[(0,z.jsx)(Z.A,{size:18}),"\uacc4\uc815 \uc0ad\uc81c"]}),(0,z.jsx)("div",{className:"h-px bg-slate-700 my-2"}),(0,z.jsxs)("button",{onClick:async()=>{u&&(await u(),d("/login")),f(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,z.jsx)(R.A,{size:18,className:"text-slate-500"}),"\ub85c\uadf8\uc544\uc6c3"]})]})]})]})]})]}),(0,z.jsx)(We,{isOpen:"nickname"===N,onClose:ce,title:"\ub2c9\ub124\uc784 \ubcc0\uacbd",children:(0,z.jsxs)("div",{className:"space-y-4",children:[(0,z.jsxs)("div",{children:[(0,z.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\uc0c8 \ub2c9\ub124\uc784"}),(0,z.jsx)("input",{type:"text",value:A,onChange:e=>I(e.target.value),placeholder:"2-12\uc790",maxLength:12,className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors",autoFocus:!0})]}),E&&(0,z.jsx)("p",{className:"text-sm text-red-400 bg-red-900/10 p-3 rounded-xl",children:E}),(0,z.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,z.jsx)("button",{onClick:ce,className:"flex-1 py-3 border border-slate-700 rounded-xl text-sm font-semibold text-slate-300 hover:bg-slate-800 transition-colors",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{const e=A.trim();if(!e)return T("\ub2c9\ub124\uc784\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");if(e.length<2)return T("\ub2c9\ub124\uc784\uc740 \ucd5c\uc18c 2\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");if(e.length>12)return T("\ub2c9\ub124\uc784\uc740 \ucd5c\ub300 12\uc790\uae4c\uc9c0 \uac00\ub2a5\ud569\ub2c8\ub2e4.");v(!0);try{await x({name:e})?(alert("\ub2c9\ub124\uc784\uc774 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),ce()):T("\ubcc0\uacbd\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(t){T("\uc624\ub958: ".concat(t.message))}v(!1)},disabled:y,className:"flex-1 py-3 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-xl text-sm font-semibold shadow-lg shadow-indigo-500/30 hover:from-indigo-700 hover:to-violet-700 transition-all disabled:opacity-50",children:y?"\uc800\uc7a5 \uc911...":"\uc800\uc7a5"})]})]})}),(0,z.jsx)(We,{isOpen:"password"===N,onClose:ce,title:"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd",children:(0,z.jsxs)("div",{className:"space-y-4",children:[(0,z.jsxs)("div",{children:[(0,z.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\ud604\uc7ac \ube44\ubc00\ubc88\ud638"}),(0,z.jsx)("input",{type:"password",value:M,onChange:e=>F(e.target.value),className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors"})]}),(0,z.jsxs)("div",{children:[(0,z.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\uc0c8 \ube44\ubc00\ubc88\ud638"}),(0,z.jsx)("input",{type:"password",value:O,onChange:e=>_(e.target.value),className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors"})]}),(0,z.jsxs)("div",{children:[(0,z.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\ube44\ubc00\ubc88\ud638 \ud655\uc778"}),(0,z.jsx)("input",{type:"password",value:L,onChange:e=>P(e.target.value),className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors"})]}),W&&(0,z.jsx)("p",{className:"text-sm text-red-400 bg-red-900/10 p-3 rounded-xl",children:W}),q&&(0,z.jsx)("p",{className:"text-sm text-green-400 bg-green-900/10 p-3 rounded-xl",children:"\ube44\ubc00\ubc88\ud638\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4!"}),(0,z.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,z.jsx)("button",{onClick:ce,className:"flex-1 py-3 border border-slate-700 rounded-xl text-sm font-semibold text-slate-300 hover:bg-slate-800 transition-colors",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{if(!M||!O||!L)return B("\ubaa8\ub4e0 \ud544\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.");if(O.length<6)return B("\uc0c8 \ube44\ubc00\ubc88\ud638\ub294 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");if(O!==L)return B("\ube44\ubc00\ubc88\ud638\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");v(!0);try{await g(c.email,M,!0),await p(O),U(!0),setTimeout(ce,2e3)}catch(e){"auth/wrong-password"===e.code||"auth/invalid-credential"===e.code?B("\ud604\uc7ac \ube44\ubc00\ubc88\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."):B("\uc624\ub958: ".concat(e.message))}v(!1)},disabled:y||q,className:"flex-1 py-3 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-xl text-sm font-semibold shadow-lg shadow-indigo-500/30 hover:from-indigo-700 hover:to-violet-700 transition-all disabled:opacity-50",children:y?"\ubcc0\uacbd \uc911...":"\ubcc0\uacbd"})]})]})}),(0,z.jsx)(We,{isOpen:"classCode"===N,onClose:ce,title:"\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd",children:(0,z.jsxs)("div",{className:"space-y-4",children:[(null===m||void 0===m?void 0:m.classCode)&&(0,z.jsxs)("p",{className:"text-sm text-slate-400 bg-slate-800/50 p-3 rounded-xl",children:["\ud604\uc7ac \ud559\uae09 \ucf54\ub4dc: ",(0,z.jsx)("strong",{className:"text-white",children:m.classCode})]}),(0,z.jsxs)("div",{children:[(0,z.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\uc0c8 \ud559\uae09 \ucf54\ub4dc"}),(0,z.jsx)("input",{type:"text",value:Q,onChange:e=>G(e.target.value.replace(/[^a-zA-Z0-9]/g,"").toUpperCase()),placeholder:"\uc601\ubb38\uc790\uc640 \uc22b\uc790\ub9cc",maxLength:20,className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors",autoFocus:!0}),(0,z.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"\uc601\ubb38\uc790\uc640 \uc22b\uc790\ub9cc \uc785\ub825 \uac00\ub2a5\ud569\ub2c8\ub2e4."})]}),$&&(0,z.jsx)("p",{className:"text-sm text-red-400 bg-red-900/10 p-3 rounded-xl",children:$}),te&&(0,z.jsx)("p",{className:"text-sm text-green-400 bg-green-900/10 p-3 rounded-xl",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4!"}),(0,z.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,z.jsx)("button",{onClick:ce,className:"flex-1 py-3 border border-slate-700 rounded-xl text-sm font-semibold text-slate-300 hover:bg-slate-800 transition-colors",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{const e=Q.trim().toUpperCase();if(!e)return ee("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.");v(!0);try{if(!await(0,J.JK)(e))return ee("'".concat(e,"'\ub294 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud559\uae09 \ucf54\ub4dc\uc785\ub2c8\ub2e4.")),void v(!1);await x({classCode:e})?(se(!0),setTimeout(()=>{alert("\ud559\uae09 \ucf54\ub4dc\uac00 '".concat(e,"'\ub85c \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4!")),ce()},1e3)):ee("\uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(t){ee("\uc624\ub958: ".concat(t.message))}v(!1)},disabled:y,className:"flex-1 py-3 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-xl text-sm font-semibold shadow-lg shadow-indigo-500/30 hover:from-indigo-700 hover:to-violet-700 transition-all disabled:opacity-50",children:y?"\uc800\uc7a5 \uc911...":"\uc800\uc7a5"})]})]})}),(0,z.jsx)(me,{isOpen:C,onClose:()=>S(!1)})]})});const qe=[{id:"home",icon:s(3658).A,label:"\ud648",path:"/dashboard/tasks"},{id:"assets",icon:d.A,label:"\uc790\uc0b0",path:"/my-assets"},{id:"game",icon:m.A,label:"\uac8c\uc784",paths:["/learning-games"]},{id:"community",icon:C.A,label:"\ucee4\ubba4\ub2c8\ud2f0",path:"/learning-board"}];function Ue(){const e=(0,n.zy)(),t=(0,n.Zp)(),s=(0,a.useCallback)(t=>t.paths?t.paths.some(t=>e.pathname.startsWith(t)):e.pathname===t.path||e.pathname.startsWith(t.path+"/"),[e.pathname]),i=(0,a.useCallback)(e=>{e.paths?t(e.paths[0]+"/omok"):t(e.path)},[t]);return(0,z.jsx)("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-md border-t border-gray-100/50 pb-safe pt-2 px-6 shadow-[0_-4px_20px_rgba(0,0,0,0.03)] z-50",children:(0,z.jsx)("div",{className:"flex justify-between items-center max-w-md mx-auto",children:qe.map(e=>{const t=s(e),a=e.icon;return(0,z.jsxs)("button",{onClick:()=>i(e),className:"flex flex-col items-center gap-1 p-2 min-w-[64px] transition-all duration-300 ".concat(t?"text-indigo-600 -translate-y-1":"text-gray-400"),children:[(0,z.jsx)(a,{size:24,strokeWidth:t?2.5:2,className:t?"drop-shadow-md":""}),(0,z.jsx)("span",{className:"text-[10px] font-medium ".concat(t?"opacity-100":"opacity-70"),children:e.label})]},e.id)})})})}var Qe=s(441),Ge=s(1360),Je=s(7104);function He(){const[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!1),[i,l]=(0,a.useState)(!1),[r,o]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(l(e),window.matchMedia("(display-mode: standalone)").matches)return void o(!0);const s=localStorage.getItem("pwa-install-dismissed");if(s){const e=parseInt(s,10);if(Date.now()-e<6048e5)return}const a=e=>{e.preventDefault(),t(e),setTimeout(()=>n(!0),2e3)};return window.addEventListener("beforeinstallprompt",a),e&&!window.matchMedia("(display-mode: standalone)").matches&&setTimeout(()=>n(!0),3e3),window.addEventListener("appinstalled",()=>{o(!0),n(!1),t(null)}),()=>{window.removeEventListener("beforeinstallprompt",a)}},[]);const d=()=>{n(!1),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return r||!s?null:(0,z.jsx)("div",{className:"fixed bottom-20 md:bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-50 animate-slide-up",children:(0,z.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden",children:[(0,z.jsxs)("div",{className:"bg-gradient-to-r from-indigo-500 to-violet-600 px-4 py-3 flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex items-center gap-2 text-white",children:[(0,z.jsx)(ce.A,{size:20}),(0,z.jsx)("span",{className:"font-semibold",children:"\uc571 \uc124\uce58\ud558\uae30"})]}),(0,z.jsx)("button",{onClick:d,className:"text-white/80 hover:text-white transition-colors",children:(0,z.jsx)(_.A,{size:20})})]}),(0,z.jsxs)("div",{className:"p-4",children:[(0,z.jsxs)("div",{className:"flex items-start gap-4",children:[(0,z.jsx)("div",{className:"w-14 h-14 bg-gradient-to-tr from-indigo-500 to-violet-600 rounded-2xl flex items-center justify-center flex-shrink-0 shadow-lg shadow-indigo-200/50",children:(0,z.jsx)("span",{className:"text-white text-2xl",children:"\u2728"})}),(0,z.jsxs)("div",{className:"flex-1",children:[(0,z.jsx)("h3",{className:"font-bold text-gray-900 mb-1",children:"\uc54c\ucc2c \uc571\uc744 \uc124\uce58\ud558\uc138\uc694!"}),(0,z.jsx)("p",{className:"text-sm text-gray-500 leading-relaxed",children:"\ud648 \ud654\uba74\uc5d0 \ucd94\uac00\ud558\uba74 \ub354 \ube60\ub974\uac8c \uc811\uc18d\ud558\uace0, \uc624\ud504\ub77c\uc778\uc5d0\uc11c\ub3c4 \uc77c\ubd80 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc5b4\uc694."})]})]}),i?(0,z.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-xl",children:[(0,z.jsx)("p",{className:"text-sm text-gray-600 mb-2 font-medium",children:"iOS\uc5d0\uc11c \uc124\uce58\ud558\uae30:"}),(0,z.jsxs)("div",{className:"space-y-2",children:[(0,z.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,z.jsx)(Qe.A,{size:16,className:"text-indigo-500"}),(0,z.jsx)("span",{children:"1. \ud558\ub2e8\uc758 \uacf5\uc720 \ubc84\ud2bc \ud0ed"})]}),(0,z.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,z.jsx)(Ge.A,{size:16,className:"text-indigo-500"}),(0,z.jsx)("span",{children:'2. "\ud648 \ud654\uba74\uc5d0 \ucd94\uac00" \uc120\ud0dd'})]})]})]}):(0,z.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,z.jsx)("button",{onClick:d,className:"flex-1 px-4 py-2.5 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-medium transition-colors",children:"\ub098\uc911\uc5d0"}),(0,z.jsxs)("button",{onClick:async()=>{if(!e)return;e.prompt();const{outcome:s}=await e.userChoice;"accepted"===s?te.vF.log("PWA \uc124\uce58 \uc218\ub77d"):te.vF.log("PWA \uc124\uce58 \uac70\uc808"),t(null),n(!1)},className:"flex-1 px-4 py-2.5 text-white bg-gradient-to-r from-indigo-500 to-violet-600 hover:from-indigo-600 hover:to-violet-700 rounded-xl font-medium transition-all flex items-center justify-center gap-2 shadow-lg shadow-indigo-200/50",children:[(0,z.jsx)(Je.A,{size:18}),"\uc124\uce58\ud558\uae30"]})]})]}),(0,z.jsx)("div",{className:"px-4 py-2 bg-gray-50 border-t border-gray-100",children:(0,z.jsx)("p",{className:"text-xs text-gray-400 text-center",children:"\uc124\uce58\ud574\ub3c4 \uc800\uc7a5\uacf5\uac04\uc744 \uac70\uc758 \ucc28\uc9c0\ud558\uc9c0 \uc54a\uc544\uc694"})})]})})}var Ve=s(516);function Ke(e){let{onUpdate:t,onDismiss:s}=e;return(0,z.jsx)("div",{className:"fixed top-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-50 animate-slide-up",children:(0,z.jsx)("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl shadow-2xl p-4 text-white",children:(0,z.jsxs)("div",{className:"flex items-start gap-3",children:[(0,z.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0",children:(0,z.jsx)(Ve.A,{size:20,className:"animate-spin-slow"})}),(0,z.jsxs)("div",{className:"flex-1",children:[(0,z.jsx)("h3",{className:"font-bold mb-1",children:"\uc0c8 \ubc84\uc804\uc774 \uc788\uc5b4\uc694!"}),(0,z.jsx)("p",{className:"text-sm text-white/80 mb-3",children:"\ub354 \ub098\uc740 \uc54c\ucc2c\uc744 \uc704\ud574 \uc5c5\ub370\uc774\ud2b8\ub97c \uc801\uc6a9\ud574\uc8fc\uc138\uc694."}),(0,z.jsxs)("div",{className:"flex gap-2",children:[(0,z.jsx)("button",{onClick:s,className:"px-3 py-1.5 text-sm bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:"\ub098\uc911\uc5d0"}),(0,z.jsxs)("button",{onClick:t,className:"px-3 py-1.5 text-sm bg-white text-emerald-600 font-semibold rounded-lg hover:bg-white/90 transition-colors flex items-center gap-1",children:[(0,z.jsx)(Ve.A,{size:14}),"\uc9c0\uae08 \uc5c5\ub370\uc774\ud2b8"]})]})]}),(0,z.jsx)("button",{onClick:s,className:"text-white/60 hover:text-white transition-colors",children:(0,z.jsx)(_.A,{size:18})})]})})})}function Xe(){const[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!1),[i,l]=(0,a.useState)(navigator.onLine);(0,a.useEffect)(()=>{const e=()=>l(!0),t=()=>l(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),"serviceWorker"in navigator&&c(),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]);const[o,d]=(0,a.useState)(null);(0,a.useEffect)(()=>()=>{o&&clearInterval(o)},[o]);const c=async()=>{try{const e=await navigator.serviceWorker.register("/sw.js",{scope:"/"});t(e),te.vF.log("[PWA] \uc11c\ube44\uc2a4 \uc6cc\ucee4 \ub4f1\ub85d \uc131\uacf5:",e.scope),e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{if("installed"===t.state&&navigator.serviceWorker.controller){const e=sessionStorage.getItem("alchan_updated");if(e&&Date.now()-parseInt(e)<3e5)return void te.vF.log("[PWA] \ucd5c\uadfc \uc5c5\ub370\uc774\ud2b8\ub428 - \uc54c\ub9bc \uc0dd\ub7b5");te.vF.log("[PWA] \uc0c8 \ubc84\uc804 \uc0ac\uc6a9 \uac00\ub2a5"),n(!0)}})});const s=setInterval(()=>{e.update()},36e5);d(s)}catch(e){te.vF.error("[PWA] \uc11c\ube44\uc2a4 \uc6cc\ucee4 \ub4f1\ub85d \uc2e4\ud328:",e)}},m=(0,a.useCallback)(()=>{n(!1),sessionStorage.setItem("alchan_updated",Date.now().toString()),e&&e.waiting?(navigator.serviceWorker.addEventListener("controllerchange",()=>{te.vF.log("[PWA] \uc0c8 \uc11c\ube44\uc2a4 \uc6cc\ucee4 \ud65c\uc131\ud654\ub428 - \uc0c8\ub85c\uace0\uce68"),window.location.reload()}),e.waiting.postMessage({type:"SKIP_WAITING"})):(te.vF.log("[PWA] \ub300\uae30 \uc911\uc778 \uc11c\ube44\uc2a4 \uc6cc\ucee4 \uc5c6\uc74c - \uac15\uc81c \uc0c8\ub85c\uace0\uce68"),window.location.reload())},[e]),u=(0,a.useCallback)(async()=>{if(!("Notification"in window))return te.vF.log("[PWA] \uc774 \ube0c\ub77c\uc6b0\uc800\ub294 \uc54c\ub9bc\uc744 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."),!1;if("granted"===Notification.permission)return!0;if("denied"!==Notification.permission){return"granted"===await Notification.requestPermission()}return!1},[]),x=(0,a.useCallback)(async function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await u()&&e&&e.showNotification(t,(0,r.A)({icon:"/icons/icon-192x192.png",badge:"/icons/icon-72x72.png",vibrate:[100,50,100]},s))},[e,u]);return{registration:e,updateAvailable:s,updateServiceWorker:m,isOnline:i,requestNotificationPermission:u,showNotification:x}}var Ye=s(5881),Ze=s(2861);const $e=[{day:1,reward:1e4,icon:"\ud83c\udf81",label:"1\uc77c\ucc28"},{day:2,reward:15e3,icon:"\ud83c\udf81",label:"2\uc77c\ucc28"},{day:3,reward:2e4,icon:"\ud83c\udf81",label:"3\uc77c\ucc28"},{day:4,reward:3e4,icon:"\ud83c\udf81",label:"4\uc77c\ucc28"},{day:5,reward:4e4,icon:"\ud83c\udf81",label:"5\uc77c\ucc28"},{day:6,reward:5e4,icon:"\ud83c\udf81",label:"6\uc77c\ucc28"},{day:7,reward:6e4,icon:"\ud83c\udf89",label:"7\uc77c\ucc28"},{day:8,reward:7e4,icon:"\ud83c\udf89",label:"8\uc77c\ucc28"},{day:9,reward:85e3,icon:"\ud83c\udf89",label:"9\uc77c\ucc28"},{day:10,reward:1e5,icon:"\ud83c\udfc6",label:"10\uc77c\ucc28!"}];function et(e){const t="dailyStreak_".concat(e),s=(new Date).toDateString();try{const e=localStorage.getItem(t);if(e){const t=JSON.parse(e),a=new Date(t.lastLogin).toDateString(),n=new Date(Date.now()-864e5).toDateString();return a===s?(0,r.A)((0,r.A)({},t),{},{isNewDay:!1,canClaim:!1}):a===n?{streak:t.streak,lastLogin:t.lastLogin,totalClaimed:t.totalClaimed||0,isNewDay:!0,canClaim:!0}:{streak:0,lastLogin:null,totalClaimed:t.totalClaimed||0,isNewDay:!0,canClaim:!0,streakBroken:!0}}return{streak:0,lastLogin:null,totalClaimed:0,isNewDay:!0,canClaim:!0}}catch(a){return{streak:0,lastLogin:null,totalClaimed:0,isNewDay:!0,canClaim:!0}}}function tt(e){var t;return e<=10?(null===(t=$e[e-1])||void 0===t?void 0:t.reward)||1e4:1e5}function st(e){var t;let{userId:s,onClaim:n}=e;const[i,l]=(0,a.useState)(null),[r,o]=(0,a.useState)(!1),[d,c]=(0,a.useState)(null),[m,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(s){const e=et(s);l(e),u(e.canClaim)}},[s]);if(!m||!i)return null;const x=i.streak+1,p=tt(x),h=x>=10;return(0,z.jsx)("div",{className:"rounded-2xl p-5 mb-5",style:{background:r?"linear-gradient(135deg, #10b981 0%, #059669 100%)":h?"linear-gradient(135deg, #f59e0b 0%, #ea580c 100%)":"linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%)",boxShadow:r?"0 4px 20px rgba(16, 185, 129, 0.4)":h?"0 4px 20px rgba(245, 158, 11, 0.4)":"0 4px 20px rgba(139, 92, 246, 0.4)",animation:"slideDown 0.3s ease-out",border:"2px solid rgba(255,255,255,0.2)"},children:r?(0,z.jsxs)("div",{className:"text-center py-2.5",children:[(0,z.jsx)("div",{className:"text-5xl mb-3",style:{animation:"bounce 0.5s ease"},children:(null===d||void 0===d?void 0:d.icon)||"\ud83c\udf89"}),(0,z.jsxs)("div",{className:"text-white text-3xl font-extrabold mb-2",children:["+",null===d||void 0===d||null===(t=d.reward)||void 0===t?void 0:t.toLocaleString(),"\uc6d0"]}),(0,z.jsxs)("div",{className:"text-base font-semibold",style:{color:"rgba(255,255,255,0.9)"},children:["\ud83d\udd25 ",null===d||void 0===d?void 0:d.newStreak,"\uc77c \uc5f0\uc18d \ucd9c\uc11d!"]}),(null===d||void 0===d?void 0:d.isMilestone)&&(0,z.jsx)("div",{className:"mt-2.5 px-4 py-2 rounded-2xl inline-block text-sm text-white",style:{background:"rgba(255,255,255,0.2)"},children:"\ud83c\udfc6 \ucd95\ud558\ud569\ub2c8\ub2e4! \ub9c8\uc77c\uc2a4\ud1a4 \ub2ec\uc131!"})]}):(0,z.jsxs)(z.Fragment,{children:[i.streakBroken&&(0,z.jsx)("div",{className:"px-3 py-2 rounded-lg mb-3 text-sm",style:{background:"rgba(0,0,0,0.2)",color:"rgba(255,255,255,0.9)"},children:"\ud83d\ude22 \uc5f0\uc18d \ucd9c\uc11d\uc774 \ub04a\uc5b4\uc84c\uc5b4\uc694. \ub2e4\uc2dc 1\uc77c\ucc28\ubd80\ud130 \uc2dc\uc791!"}),(0,z.jsxs)("div",{className:"flex justify-between items-center",children:[(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"flex items-center gap-2.5 mb-1.5",children:[(0,z.jsx)("span",{className:"text-3xl",children:h?"\ud83c\udfc6":"\ud83c\udf81"}),(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"text-white text-lg font-bold",children:[x,"\uc77c\ucc28 \ucd9c\uc11d \ubcf4\uc0c1"]}),x>=10&&(0,z.jsxs)("div",{className:"text-xs mt-0.5",style:{color:"rgba(255,255,255,0.8)"},children:["\ud83d\udd25 ",x,"\uc77c \uc5f0\uc18d \ucd9c\uc11d \uc911!"]})]})]}),(0,z.jsxs)("div",{className:"text-2xl font-extrabold mt-1",style:{color:"rgba(255,255,255,0.95)"},children:["+",p.toLocaleString(),"\uc6d0"]})]}),(0,z.jsx)("button",{onClick:()=>{const e=function(e){const t="dailyStreak_".concat(e),s=(new Date).toISOString(),a=et(e);if(!a.canClaim)return{success:!1,message:"\uc624\ub298 \uc774\ubbf8 \ubcf4\uc0c1\uc744 \ubc1b\uc558\uc2b5\ub2c8\ub2e4."};const n=a.streak+1,i=tt(n),l=n>=10?"\ud83c\udfc6":n>=7?"\ud83c\udf89":"\ud83c\udf81",r={streak:n,lastLogin:s,totalClaimed:(a.totalClaimed||0)+i};return localStorage.setItem(t,JSON.stringify(r)),{success:!0,reward:i,newStreak:n,icon:l,message:"".concat(n,"\uc77c\ucc28 \ucd9c\uc11d \ubcf4\uc0c1: ").concat(i.toLocaleString(),"\uc6d0!"),isMilestone:10===n||n%30===0}}(s);c(e),o(!0),e.success&&n&&n(e.reward),setTimeout(()=>{u(!1)},5e3)},className:"border-none py-3.5 px-7 rounded-xl text-base font-bold cursor-pointer transition-all",style:{background:"rgba(255,255,255,0.95)",color:h?"#ea580c":"#6366f1",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:"\ubc1b\uae30! \ud83c\udf89"})]}),(0,z.jsxs)("div",{className:"mt-4",children:[(0,z.jsx)("div",{className:"flex justify-between gap-1",children:$e.map((e,t)=>(0,z.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,z.jsx)("div",{className:"w-full h-2 rounded mb-1",style:{background:t<i.streak?"rgba(255,255,255,0.9)":t===i.streak?"rgba(255,255,255,0.5)":"rgba(255,255,255,0.2)"}}),(0===t||4===t||9===t)&&(0,z.jsxs)("span",{className:"text-[9px]",style:{color:"rgba(255,255,255,0.7)"},children:[t+1,"\uc77c"]})]},e.day))}),x>10&&(0,z.jsx)("div",{className:"text-center mt-2 text-xs",style:{color:"rgba(255,255,255,0.8)"},children:"\u2728 10\uc77c \uc774\uc0c1 \uc5f0\uc18d \ucd9c\uc11d \uc2dc \ub9e4\uc77c 10\ub9cc\uc6d0!"})]})]})})}function at(e){let{userId:t}=e;const[s,n]=(0,a.useState)({streak:0});(0,a.useEffect)(()=>{if(t){const e=et(t);n(e)}},[t]);const i=s.streak||0;return 0===i?null:(0,z.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-xl text-sm font-semibold",style:{background:i>=10?"linear-gradient(135deg, #f59e0b20 0%, #ea580c20 100%)":"linear-gradient(135deg, #8b5cf620 0%, #6366f120 100%)",border:"1px solid ".concat(i>=10?"#f59e0b40":"#8b5cf640"),color:i>=10?"#f59e0b":"#a78bfa"},children:[(0,z.jsx)("span",{children:"\ud83d\udd25"}),(0,z.jsxs)("span",{children:[i,"\uc77c \uc5f0\uc18d"]}),i>=10&&(0,z.jsx)("span",{children:"\ud83c\udfc6"})]})}function nt(){return(0,z.jsxs)("div",{className:"rounded-2xl p-4",style:{background:"linear-gradient(145deg, #1a1a2e 0%, #16213e 100%)",border:"2px solid #8b5cf640"},children:[(0,z.jsx)("h4",{className:"text-sm font-bold mb-3 flex items-center gap-2",style:{color:"#e8e8ff"},children:"\ud83c\udf81 \uc77c\uc77c \ucd9c\uc11d \ubcf4\uc0c1 \uc548\ub0b4"}),(0,z.jsxs)("div",{className:"flex flex-col gap-1.5",children:[$e.map(e=>(0,z.jsxs)("div",{className:"flex justify-between items-center px-2.5 py-1.5 rounded-lg",style:{background:10===e.day?"#f59e0b15":"transparent",border:10===e.day?"1px solid #f59e0b30":"none"},children:[(0,z.jsxs)("span",{className:"text-sm",style:{color:10===e.day?"#f59e0b":"#9ca3af"},children:[e.icon," ",e.label]}),(0,z.jsxs)("span",{style:{color:10===e.day?"#f59e0b":"#e8e8ff",fontWeight:10===e.day?"700":"500",fontSize:10===e.day?"15px":"13px"},children:[e.reward.toLocaleString(),"\uc6d0"]})]},e.day)),(0,z.jsx)("div",{className:"mt-2 p-2.5 rounded-xl text-center",style:{background:"#f59e0b15",border:"1px solid #f59e0b30"},children:(0,z.jsx)("span",{className:"text-sm font-semibold",style:{color:"#f59e0b"},children:"\ud83c\udfc6 10\uc77c \uc774\ud6c4: \ub9e4\uc77c 100,000\uc6d0!"})})]})]})}var it=s(4891),lt=s(2395),rt=s(7950);const ot=(0,a.memo)(function(e){let{task:t,onEarnCoupon:s,isJobTask:n,isAdmin:i,onEditTask:l,onDeleteTask:o,taskId:d,jobId:c=null}=e;const[m,u]=(0,a.useState)(!1),[x,p]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1),[b,f]=(0,a.useState)(null),[y,v]=(0,a.useState)(null),[j,N]=(0,a.useState)(!1),w=e=>{j||y||(te.vF.log("[TaskItem] \uce74\ub4dc \uc120\ud0dd:",{cardType:e,taskId:d,jobId:c,isJobTask:n}),v(e),N(!0),setTimeout(()=>{const a="cash"===e?b.cash:b.coupon,i="cash"===e?"".concat(a.toLocaleString(),"\uc6d0"):"".concat(a,"\uac1c");te.vF.log("[TaskItem] onEarnCoupon \ud638\ucd9c \uc900\ube44:",{taskId:d,jobId:c,isJobTask:n,cardType:e,reward:a}),"function"===typeof s&&s(d||t.id,c,n,e,a),g(!1),p("".concat("cash"===e?"\ud83d\udcb0 \ud604\uae08":"\ud83c\udfab \ucfe0\ud3f0"," ").concat(i," \ud68d\ub4dd! \ud83d\ude0a")),u(!0),N(!1)},800))};(0,a.useEffect)(()=>{let e;return m&&(e=setTimeout(()=>{u(!1),p("")},2e3)),()=>clearTimeout(e)},[m]);const k=t&&t.maxClicks>0&&t.clicks>=t.maxClicks;if(!t)return null;const C=window.innerWidth<=768,S={backgroundColor:k?"rgba(20, 20, 35, 0.4)":"rgba(30, 30, 50, 0.6)",border:"1px solid ".concat(k?"rgba(100, 116, 139, 0.1)":"rgba(0, 255, 242, 0.15)"),opacity:k?.6:1,padding:C?"8px 10px":"12px",boxShadow:k?"none":"0 4px 12px rgba(0, 0, 0, 0.1)"},A={gap:C?"6px":"10px"},I={color:k?"#64748b":"#e8e8ff",fontSize:C?"12px":"16px",lineHeight:"1.4"},E={gap:C?"4px":"8px"},T={backgroundColor:n?"rgba(79, 70, 229, 0.3)":"rgba(16, 185, 129, 0.3)",color:n?"#818cf8":"#34d399",border:n?"1px solid rgba(99, 102, 241, 0.5)":"1px solid rgba(52, 211, 153, 0.5)",padding:C?"3px 6px":"4px 10px",fontSize:C?"10px":"13px"};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex flex-row items-center justify-between relative rounded-lg mb-2 transition-all",style:(0,r.A)((0,r.A)({},S),{},{cursor:k?"default":"pointer",gap:C?"6px":"8px"}),onClick:k?null:()=>{if(te.vF.log("[TaskItem] handleInternalClick \ud638\ucd9c\ub428:",{taskName:null===t||void 0===t?void 0:t.name,isJobTask:n,taskId:d,jobId:c}),!t||"number"!==typeof t.clicks||"number"!==typeof t.maxClicks)return void te.vF.error("Invalid task prop:",t);if(t.maxClicks>0&&t.clicks>=t.maxClicks)return;te.vF.log("[TaskItem] \uce74\ub4dc \ubaa8\ub2ec \uc5f4\uae30");const e=(()=>{const e=e=>{const t=e.reduce((e,t)=>e+t.weight,0);let s=Math.random()*t;for(const a of e)if(s-=a.weight,s<=0)return a.amount;return e[e.length-1].amount};return{cash:e([{amount:5e4,weight:5},{amount:3e4,weight:10},{amount:2e4,weight:15},{amount:1e4,weight:20},{amount:5e3,weight:18},{amount:3e3,weight:12},{amount:1e3,weight:10},{amount:500,weight:7},{amount:100,weight:3}]),coupon:e([{amount:20,weight:10},{amount:10,weight:20},{amount:5,weight:20},{amount:3,weight:20},{amount:1,weight:30}])}})();f(e),v(null),N(!1),g(!0)},children:[(0,z.jsx)("div",{className:"flex items-center flex-grow min-w-0 overflow-hidden",style:A,children:(0,z.jsx)("span",{className:"font-semibold overflow-hidden text-ellipsis whitespace-nowrap flex-1 min-w-0",style:I,title:t.name,children:t.name})}),(0,z.jsxs)("div",{className:"flex items-center flex-shrink-0",style:E,children:[(0,z.jsx)("span",{className:"rounded-lg font-medium whitespace-nowrap",style:T,children:"\ud83c\udf81 \ub79c\ub364\ubcf4\uc0c1"}),i&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("button",{onClick:e=>{e.stopPropagation(),l()},className:"cursor-pointer p-1 flex items-center justify-center",style:dt,"aria-label":"\ud560\uc77c \uc218\uc815",children:"\u270f\ufe0f"}),(0,z.jsx)("button",{onClick:e=>{e.stopPropagation(),o()},className:"cursor-pointer p-1 flex items-center justify-center",style:dt,"aria-label":"\ud560\uc77c \uc0ad\uc81c",children:"\ud83d\uddd1\ufe0f"})]})]}),m&&(0,z.jsxs)("div",{className:"absolute left-1/2 -translate-x-1/2 rounded-md font-medium whitespace-nowrap z-10 pointer-events-none",style:ct,children:[x,(0,z.jsx)("div",{className:"absolute",style:mt})]})]}),(()=>{if(!h||!b)return null;const e=(0,r.A)((0,r.A)({},xt),{},{padding:C?"20px":"40px"}),t=(0,r.A)((0,r.A)({},pt),{},{fontSize:C?"20px":"28px"}),s=(0,r.A)((0,r.A)({},ht),{},{fontSize:C?"13px":"16px"}),a=(0,r.A)((0,r.A)({},gt),{},{gap:C?"15px":"20px"}),n=(0,r.A)((0,r.A)({},bt),{},{width:C?"140px":"200px",height:C?"200px":"280px"}),i=(0,r.A)((0,r.A)({},wt),{},{fontSize:C?"50px":"80px",marginBottom:C?"10px":"20px"}),l=(0,r.A)((0,r.A)({},kt),{},{fontSize:C?"18px":"24px"}),o=(0,r.A)((0,r.A)({},Ct),{},{fontSize:C?"24px":"36px"}),d=(0,r.A)((0,r.A)({},St),{},{fontSize:C?"14px":"18px"});return(0,rt.createPortal)((0,z.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-[10000]",style:ut,onClick:()=>g(!1),children:(0,z.jsxs)("div",{className:"rounded-[20px] max-w-[600px]",style:(0,r.A)((0,r.A)({},e),{},{width:C?"95%":"90%"}),onClick:e=>e.stopPropagation(),children:[(0,z.jsx)("h3",{className:"text-center font-bold",style:(0,r.A)((0,r.A)({},t),{},{marginBottom:C?"8px":"10px"}),children:"\ud83c\udf81 \ubcf4\uc0c1 \uc120\ud0dd"}),(0,z.jsx)("p",{className:"text-center",style:(0,r.A)((0,r.A)({},s),{},{marginBottom:C?"20px":"30px"}),children:"\ub450 \uac1c\uc758 \uce74\ub4dc \uc911 \ud558\ub098\ub97c \uc120\ud0dd\ud558\uc138\uc694!"}),(0,z.jsxs)("div",{className:"flex justify-center flex-wrap",style:a,children:[(0,z.jsx)("div",{className:"cursor-pointer",style:(0,r.A)((0,r.A)({},n),"cash"===y&&ft),onClick:()=>!y&&w("cash"),children:(0,z.jsxs)("div",{className:"relative w-full h-full",style:(0,r.A)((0,r.A)({},yt),{},{transform:"cash"===y?"rotateY(180deg)":"rotateY(0deg)"}),children:[(0,z.jsxs)("div",{className:"absolute w-full h-full rounded-2xl flex flex-col items-center justify-center",style:(0,r.A)((0,r.A)({},vt),{},{backfaceVisibility:"hidden"}),children:[(0,z.jsx)("div",{style:i,children:"\ud83d\udcb0"}),(0,z.jsx)("div",{className:"text-2xl font-bold",style:l,children:"\ud604\uae08"})]}),(0,z.jsxs)("div",{className:"absolute w-full h-full rounded-2xl flex flex-col items-center justify-center",style:(0,r.A)((0,r.A)((0,r.A)({},jt),"cash"===y&&Nt),{},{backfaceVisibility:"hidden"}),children:[(0,z.jsxs)("div",{className:"text-4xl font-bold mb-2.5",style:o,children:[b.cash.toLocaleString(),"\uc6d0"]}),(0,z.jsx)("div",{className:"text-lg",style:d,children:"\ud83d\udcb0 \ud604\uae08 \ud68d\ub4dd!"})]})]})}),(0,z.jsx)("div",{className:"cursor-pointer",style:(0,r.A)((0,r.A)({},n),"coupon"===y&&ft),onClick:()=>!y&&w("coupon"),children:(0,z.jsxs)("div",{className:"relative w-full h-full",style:(0,r.A)((0,r.A)({},yt),{},{transform:"coupon"===y?"rotateY(180deg)":"rotateY(0deg)"}),children:[(0,z.jsxs)("div",{className:"absolute w-full h-full rounded-2xl flex flex-col items-center justify-center",style:(0,r.A)((0,r.A)({},vt),{},{backfaceVisibility:"hidden"}),children:[(0,z.jsx)("div",{style:i,children:"\ud83c\udfab"}),(0,z.jsx)("div",{className:"text-2xl font-bold",style:l,children:"\ucfe0\ud3f0"})]}),(0,z.jsxs)("div",{className:"absolute w-full h-full rounded-2xl flex flex-col items-center justify-center",style:(0,r.A)((0,r.A)((0,r.A)({},jt),"coupon"===y&&Nt),{},{backfaceVisibility:"hidden"}),children:[(0,z.jsxs)("div",{className:"text-4xl font-bold mb-2.5",style:o,children:[b.coupon,"\uac1c"]}),(0,z.jsx)("div",{className:"text-lg",style:d,children:"\ud83c\udfab \ucfe0\ud3f0 \ud68d\ub4dd!"})]})]})})]})]})}),document.body)})()]})}),dt={background:"none",border:"none",fontSize:"16px",color:"#94a3b8"},ct={bottom:"calc(100% + 8px)",backgroundColor:"rgba(0, 0, 0, 0.75)",color:"white",padding:"5px 10px",fontSize:"12px",boxShadow:"0 2px 5px rgba(0,0,0,0.2)"},mt={content:'""',top:"100%",left:"50%",marginLeft:"-5px",borderWidth:"5px",borderStyle:"solid",borderColor:"rgba(0, 0, 0, 0.75) transparent transparent transparent"},ut={backgroundColor:"rgba(0, 0, 0, 0.7)",animation:"fadeIn 0.3s ease"},xt={backgroundColor:"#1a1a2e",border:"1px solid rgba(0, 255, 242, 0.3)",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",animation:"zoomIn 0.3s ease"},pt={color:"#ffffff",textShadow:"0 0 10px rgba(0, 255, 242, 0.5)"},ht={color:"#a0a0c0"},gt={gap:"20px"},bt={perspective:"1000px",transition:"transform 0.2s ease"},ft={transform:"scale(1.05)"},yt={transition:"transform 0.8s",transformStyle:"preserve-3d"},vt={background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.2)",border:"3px solid #fff"},jt={backgroundColor:"#fff",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.2)",border:"3px solid #667eea",transform:"rotateY(180deg)",opacity:0,transition:"opacity 0.3s ease 0.4s"},Nt={opacity:1},wt={fontSize:"80px",marginBottom:"20px"},kt={color:"white"},Ct={color:"#667eea"},St={color:"#666"},At=(0,a.memo)(function(e){let{job:t,isAdmin:s,onEditJob:a,onDeleteJob:n,onAddTask:i,onEditTask:l,onDeleteTask:r,onEarnCoupon:o,addJobTaskButtonStyle:d}=e;if(!t)return null;const c=window.innerWidth<=768;return(0,z.jsxs)("div",{className:"flex flex-col h-full rounded-lg overflow-hidden mb-4",style:{backgroundColor:"rgba(20, 20, 35, 0.6)",border:"1px solid rgba(0, 255, 242, 0.2)",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.3)",backdropFilter:"blur(5px)"},children:[(0,z.jsxs)("div",{className:"job-header-container flex justify-between items-center",style:{background:"linear-gradient(135deg, rgba(79, 70, 229, 0.2) 0%, rgba(99, 102, 241, 0.2) 100%)",padding:c?"12px 14px":"14px 16px",borderBottom:"1px solid rgba(0, 255, 242, 0.2)"},children:[(0,z.jsx)("div",{className:"job-title-text font-bold",style:{fontSize:c?"15px":"18px",textShadow:"0 0 10px rgba(0, 255, 242, 0.3)",letterSpacing:"-0.01em",color:"#e8e8ff"},children:t.title}),s&&(0,z.jsxs)("div",{children:[(0,z.jsx)("button",{onClick:()=>a(t.id),className:"cursor-pointer p-0 mr-2",style:{background:"none",border:"none",color:"rgba(255, 255, 255, 0.7)"},"aria-label":"".concat(t.title," \uc9c1\uc5c5 \uc218\uc815"),children:"\u270f\ufe0f"}),(0,z.jsx)("button",{onClick:()=>n(t.id),className:"cursor-pointer p-0",style:{background:"none",border:"none",color:"rgba(255, 255, 255, 0.7)"},"aria-label":"".concat(t.title," \uc9c1\uc5c5 \uc0ad\uc81c"),children:"\ud83d\uddd1\ufe0f"})]})]}),(0,z.jsx)("div",{className:"flex-grow overflow-y-auto",style:{padding:c?"8px":"10px"},children:t.tasks&&t.tasks.length>0?t.tasks.map(e=>(0,z.jsx)(ot,{task:e,taskId:e.id,jobId:t.id,onEarnCoupon:o,onEditTask:()=>l(e.id,t.id),onDeleteTask:()=>r(e.id,t.id),isAdmin:s,isJobTask:!0},e.id)):(0,z.jsx)("p",{className:"text-center my-2.5",style:{fontSize:"13px",color:"#9999bb"},children:"\ub4f1\ub85d\ub41c \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})}),s&&(0,z.jsx)("div",{style:{padding:c?"8px":"10px",borderTop:"1px solid rgba(0, 255, 242, 0.1)"},children:(0,z.jsx)("button",{onClick:i,className:"w-full cursor-pointer rounded-md mt-0 transition-all",style:d||{padding:c?"6px":"8px",backgroundColor:"rgba(0, 255, 242, 0.1)",border:"1px solid rgba(0, 255, 242, 0.3)",color:"#00fff2",fontSize:c?"12px":"13px",fontWeight:"500"},children:"+ \uc774 \uc9c1\uc5c5\uc5d0 \ud560\uc77c \ucd94\uac00"})})]},t.id)});function It(e){let{tasks:t,isAdmin:s,onEditTask:a,onDeleteTask:n,onEarnCoupon:i}=e;if(!Array.isArray(t)||0===t.length)return(0,z.jsx)("div",{className:"p-5 text-center",style:{color:"#6b7280"},children:s?"\ub4f1\ub85d\ub41c \uacf5\ud1b5 \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790 \uc124\uc815\uc5d0\uc11c \ucd94\uac00\ud574\uc8fc\uc138\uc694.":"\ud604\uc7ac \uc218\ud589\ud560 \uc218 \uc788\ub294 \uacf5\ud1b5 \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."});const l="undefined"!==typeof window&&window.innerWidth<=768;return(0,z.jsx)("div",{className:"grid",style:{gridTemplateColumns:l?"1fr":"repeat(2, 1fr)",gap:l?"8px":"10px"},children:t.map(e=>(0,z.jsx)(ot,{task:e,taskId:e.id,onEarnCoupon:i,onEditTask:()=>a(e.id),onDeleteTask:()=>n(e.id),isAdmin:s,isJobTask:!1},e.id))})}const Et=(0,a.memo)(function(e){let{showTransferModal:t,setShowTransferModal:s,recipients:a=[],transferRecipient:n,setTransferRecipient:i,transferAmount:l,setTransferAmount:r,handleTransfer:o,userId:d,userCash:c=0}=e;const m=a.filter(e=>e&&e.id&&e.id!==d).sort((e,t)=>{const s=e.name||e.nickname||"\uc0ac\uc6a9\uc790 ".concat(e.id.substring(0,6)),a=t.name||t.nickname||"\uc0ac\uc6a9\uc790 ".concat(t.id.substring(0,6));return s.localeCompare(a,"ko")});return(0,z.jsx)("div",{className:"".concat(t?"flex":"hidden"," fixed inset-0 bg-black/50 items-center justify-center z-[1000] p-5"),onClick:()=>s(!1),children:(0,z.jsxs)("div",{className:"bg-white rounded-xl p-8 max-w-[450px] w-full shadow-lg relative",onClick:e=>e.stopPropagation(),children:[(0,z.jsx)("button",{onClick:()=>s(!1),className:"absolute top-4 right-4 bg-transparent border-0 text-2xl cursor-pointer text-gray-500 p-0 w-8 h-8 flex items-center justify-center","aria-label":"\ub2eb\uae30",children:"\xd7"}),(0,z.jsx)("h2",{className:"text-xl font-semibold mb-6 text-gray-800",children:"\ud83d\udcb8 \uc1a1\uae08\ud558\uae30"}),(0,z.jsx)("div",{className:"bg-gray-100 rounded-lg p-3 mb-5",children:(0,z.jsxs)("p",{className:"text-sm text-gray-600 m-0",children:["\ud604\uc7ac \ubcf4\uc720 \ud604\uae08: ",(0,z.jsxs)("strong",{className:"text-gray-800",children:[c.toLocaleString(),"\uc6d0"]})]})}),(0,z.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o()},children:[(0,z.jsxs)("div",{className:"mb-5",children:[(0,z.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"\ubc1b\ub294 \uc0ac\ub78c"}),(0,z.jsxs)("select",{value:n,onChange:e=>i(e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-md text-sm outline-none transition-colors cursor-pointer bg-white",required:!0,children:[(0,z.jsx)("option",{value:"",children:"\ubc1b\ub294 \ubd84\uc744 \uc120\ud0dd\ud558\uc138\uc694"}),m.length>0?m.map(e=>(0,z.jsx)("option",{value:e.id,children:e.name||e.nickname||"\uc0ac\uc6a9\uc790 ".concat(e.id.substring(0,6))},e.id)):(0,z.jsx)("option",{value:"",disabled:!0,children:"\uc1a1\uae08 \uac00\ub2a5\ud55c \ud559\uae09 \uce5c\uad6c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4"})]}),0===m.length&&(0,z.jsx)("p",{className:"mt-2 text-xs text-red-500",children:"\u26a0\ufe0f \uac19\uc740 \ud559\uae09\uc758 \ub2e4\ub978 \uc0ac\uc6a9\uc790\uac00 \uc5c6\uac70\ub098 \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911\uc785\ub2c8\ub2e4."})]}),(0,z.jsxs)("div",{className:"mb-6",children:[(0,z.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"\uc1a1\uae08 \uae08\uc561"}),(0,z.jsx)("input",{type:"number",value:l,onChange:e=>r(e.target.value),placeholder:"\uc1a1\uae08\ud560 \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694",className:"w-full px-3 py-2.5 border border-gray-300 rounded-md text-sm outline-none transition-colors",min:"1",max:c,required:!0}),l&&parseInt(l)>c&&(0,z.jsx)("p",{className:"mt-2 text-xs text-red-500",children:"\ubcf4\uc720 \ud604\uae08\ubcf4\ub2e4 \ub9ce\uc740 \uae08\uc561\uc740 \uc1a1\uae08\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,z.jsxs)("div",{className:"flex justify-end pt-2.5 border-t border-gray-200",children:[(0,z.jsx)("button",{type:"button",onClick:()=>s(!1),className:"px-5 py-2.5 rounded-md border-0 text-sm font-medium cursor-pointer transition-all duration-200 bg-gray-200 text-gray-700 mr-2.5 hover:bg-gray-300",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{type:"submit",className:"px-5 py-2.5 rounded-md border-0 text-sm font-medium cursor-pointer transition-all duration-200 bg-indigo-600 text-white hover:bg-indigo-700 disabled:cursor-not-allowed disabled:opacity-50",disabled:!n||!l||parseInt(l)>c||0===m.length,children:"\uc1a1\uae08"})]})]})]})})});s(5226),s(3057),s(783);var Tt=s(2532),Dt=s(3248),Mt=s(7097);const Ft=e=>{const t=(0,lt.Qg)(J.Cn,e);return async s=>{try{const e=await t(s);if(e.data.success)return e.data;throw new Error(e.data.message||"\ud568\uc218 \uc2e4\ud589 \uc2e4\ud328")}catch(a){throw te.vF.error("".concat(e," \uc624\ub958:"),a),a}}},Ot={getAdminSettingsData:Ft("getAdminSettingsData"),batchPaySalaries:Ft("batchPaySalaries"),getItemContextData:Ft("getItemContextData")},_t=(e,t)=>["adminSettings",e,t],Rt=e=>["students",e],zt=e=>["salarySettings",e],Lt=()=>["systemManagement"],Pt=()=>navigator.onLine&&!document.hidden,Wt=(e,t)=>{try{localStorage.setItem("backup_".concat(e),JSON.stringify({data:t,timestamp:Date.now()}))}catch(s){te.vF.warn("\ub85c\uceec \ubc31\uc5c5 \uc800\uc7a5 \uc2e4\ud328:",s)}},Bt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e4;try{const s=localStorage.getItem("backup_".concat(e));if(s){const e=JSON.parse(s);if(Date.now()-e.timestamp<t)return e.data}}catch(s){te.vF.warn("\ub85c\uceec \ubc31\uc5c5 \ub85c\ub4dc \uc2e4\ud328:",s)}return null},qt=e=>{try{localStorage.removeItem("backup_".concat(e))}catch(t){te.vF.warn("\ub85c\uceec \ubc31\uc5c5 \uc0ad\uc81c \uc2e4\ud328:",t)}},Ut=e=>{let{isSuperAdmin:t}=e;const[s,n]=(0,a.useState)(null),[i,l]=(0,a.useState)(!1),[r,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1),[m,u]=(0,a.useState)(null),[x,p]=(0,a.useState)(0),h=(0,lt.Qg)(J.Cn,"getSystemStatus"),g=(0,lt.Qg)(J.Cn,"resolveSystemAlert"),b=(0,a.useCallback)(async()=>{if(t){l(!0),o(null);try{const e=await h();if(!e.data.success)throw new Error(e.data.message||"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc \uc870\ud68c \uc2e4\ud328");n(e.data.data),u(new Date),p(0)}catch(e){te.vF.error("[SystemMonitoring] \uc0c1\ud0dc \uc870\ud68c \uc624\ub958:",e),o(e.message||"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc\ub97c \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),p(e=>e+1),x>=2&&(c(!1),te.vF.warn("[SystemMonitoring] \uc5f0\uc18d \uc5d0\ub7ec \ubc1c\uc0dd\uc73c\ub85c \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\uc744 \uc911\uc9c0\ud569\ub2c8\ub2e4."))}finally{l(!1)}}},[t,h,x]),f=(0,a.useCallback)(async e=>{if(window.confirm("\uc774 \uacbd\uace0\ub97c \ud574\uacb0 \ucc98\ub9ac\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))try{(await g({alertId:e})).data.success&&(alert("\uacbd\uace0\uac00 \ud574\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),b())}catch(t){te.vF.error("[SystemMonitoring] \uacbd\uace0 \ud574\uacb0 \uc624\ub958:",t),alert("\uacbd\uace0 \ud574\uacb0 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(t.message))}},[g,b]);return(0,a.useEffect)(()=>{t&&b()},[t,b]),(0,a.useEffect)(()=>{if(!d||!t)return;const e=setInterval(()=>{b()},12e4);return()=>clearInterval(e)},[d,t,b]),(0,a.useEffect)(()=>{d&&p(0)},[d]),t?(0,z.jsxs)("div",{className:"system-monitoring section-card",children:[(0,z.jsxs)("div",{className:"monitoring-header",children:[(0,z.jsx)("h3",{children:"\ud83d\udda5\ufe0f \uc11c\ubc84 \uc0c1\ud0dc \ubaa8\ub2c8\ud130\ub9c1"}),(0,z.jsxs)("div",{className:"monitoring-controls",children:[(0,z.jsxs)("label",{className:"auto-refresh-toggle",children:[(0,z.jsx)("input",{type:"checkbox",checked:d,onChange:e=>c(e.target.checked)}),(0,z.jsx)("span",{children:"\uc790\ub3d9 \uc0c8\ub85c\uace0\uce68 (30\ucd08)"})]}),(0,z.jsx)("button",{onClick:b,disabled:i,className:"refresh-button",children:i?"\u23f3 \uc870\ud68c \uc911...":"\ud83d\udd04 \uc0c8\ub85c\uace0\uce68"})]})]}),m&&(0,z.jsxs)("p",{className:"last-update",children:["\ub9c8\uc9c0\ub9c9 \uc5c5\ub370\uc774\ud2b8: ",m.toLocaleTimeString("ko-KR")]}),r&&(0,z.jsxs)("div",{className:"error-message",children:[(0,z.jsxs)("p",{children:["\u274c ",r]}),x>=3&&(0,z.jsx)("p",{style:{marginTop:"8px",fontSize:"14px"},children:"\u26a0\ufe0f \uc5f0\uc18d \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud558\uc5ec \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\uc774 \uc911\uc9c0\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc218\ub3d9\uc73c\ub85c \uc0c8\ub85c\uace0\uce68\ud558\uac70\ub098 \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\uc744 \ub2e4\uc2dc \ud65c\uc131\ud654\ud574\uc8fc\uc138\uc694."})]}),s&&(0,z.jsxs)(z.Fragment,{children:[s.message&&(0,z.jsx)("div",{className:"info-message",style:{padding:"12px",background:"#e3f2fd",border:"1px solid #90caf9",borderRadius:"4px",marginBottom:"15px",color:"#1976d2"},children:(0,z.jsxs)("p",{style:{margin:0},children:["\u2139\ufe0f ",s.message]})}),(0,z.jsxs)("div",{className:"system-health-card",children:[(0,z.jsx)("h4",{children:"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc"}),(0,z.jsxs)("div",{className:"health-indicator health-".concat(s.health),children:[(0,z.jsx)("span",{className:"health-icon",children:"healthy"===s.health?"\u2705":"warning"===s.health?"\u26a0\ufe0f":"\ud83d\udea8"}),(0,z.jsx)("span",{className:"health-text",children:"healthy"===s.health?"\uc815\uc0c1":"warning"===s.health?"\uc8fc\uc758":"\uc704\ud5d8"})]}),(0,z.jsx)("div",{className:"stats-grid",children:(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\uc804\uccb4 \uc0ac\uc6a9\uc790"}),(0,z.jsx)("span",{className:"stat-value",children:s.totalUsers})]})})]}),(0,z.jsxs)("div",{className:"stats-card",children:[(0,z.jsx)("h4",{children:"\ucd5c\uadfc 1\ubd84 \ud1b5\uacc4"}),(0,z.jsxs)("div",{className:"stats-grid",children:[(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\uc77d\uae30 \uc791\uc5c5"}),(0,z.jsx)("span",{className:"stat-value",children:s.stats.lastMinute.reads.toLocaleString()})]}),(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\uc4f0\uae30 \uc791\uc5c5"}),(0,z.jsx)("span",{className:"stat-value",children:s.stats.lastMinute.writes.toLocaleString()})]}),(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\uc5d0\ub7ec \uc218"}),(0,z.jsx)("span",{className:"stat-value",children:s.stats.lastMinute.errors})]}),(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\uc5d0\ub7ec\uc728"}),(0,z.jsxs)("span",{className:"stat-value",children:[(100*s.stats.lastMinute.errorRate).toFixed(2),"%"]})]}),(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\ud3c9\uade0 \uc751\ub2f5 \uc2dc\uac04"}),(0,z.jsxs)("span",{className:"stat-value",children:[s.stats.lastMinute.avgResponseTime.toFixed(0),"ms"]})]})]})]}),s.anomalies&&s.anomalies.length>0&&(0,z.jsxs)("div",{className:"anomalies-card",children:[(0,z.jsx)("h4",{children:"\u26a0\ufe0f \ube44\uc815\uc0c1 \ud328\ud134 \uac10\uc9c0"}),(0,z.jsx)("div",{className:"anomalies-list",children:s.anomalies.map((e,t)=>(0,z.jsxs)("div",{className:"anomaly-item anomaly-".concat(e.severity),children:[(0,z.jsxs)("div",{className:"anomaly-header",children:[(0,z.jsx)("span",{className:"anomaly-severity",children:"critical"===e.severity?"\ud83d\udea8 \uc2ec\uac01":"error"===e.severity?"\u274c \uc624\ub958":"\u26a0\ufe0f \uacbd\uace0"}),(0,z.jsx)("span",{className:"anomaly-type",children:e.type})]}),(0,z.jsx)("p",{className:"anomaly-message",children:e.message})]},t))})]}),s.alerts&&s.alerts.length>0&&(0,z.jsxs)("div",{className:"alerts-card",children:[(0,z.jsxs)("h4",{children:["\ud83d\udd14 \ud65c\uc131 \uacbd\uace0 (",s.alerts.length,")"]}),(0,z.jsx)("div",{className:"alerts-list",children:s.alerts.map(e=>{var t,s;const a=null!==(t=e.timestamp)&&void 0!==t&&t.toDate?e.timestamp.toDate():new Date(1e3*(null===(s=e.timestamp)||void 0===s?void 0:s.seconds)||Date.now());return(0,z.jsxs)("div",{className:"alert-item alert-".concat(e.severity),children:[(0,z.jsxs)("div",{className:"alert-header",children:[(0,z.jsx)("span",{className:"alert-time",children:a.toLocaleString("ko-KR")}),(0,z.jsx)("button",{onClick:()=>f(e.id),className:"resolve-alert-button",children:"\ud574\uacb0"})]}),(0,z.jsx)("p",{className:"alert-message",children:e.message})]},e.id)})})]}),s.errorLogs&&s.errorLogs.length>0&&(0,z.jsxs)("div",{className:"error-logs-card",children:[(0,z.jsx)("h4",{children:"\ud83d\udcdd \ucd5c\uadfc \uc5d0\ub7ec \ub85c\uadf8 (1\uc2dc\uac04)"}),(0,z.jsx)("div",{className:"error-logs-list",children:s.errorLogs.slice(0,10).map(e=>{var t,s;const a=null!==(t=e.timestamp)&&void 0!==t&&t.toDate?e.timestamp.toDate():new Date(1e3*(null===(s=e.timestamp)||void 0===s?void 0:s.seconds)||Date.now());return(0,z.jsxs)("div",{className:"error-log-item",children:[(0,z.jsx)("span",{className:"log-time",children:a.toLocaleTimeString("ko-KR")}),(0,z.jsx)("span",{className:"log-message",children:e.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958"})]},e.id)})})]}),(0,z.jsxs)("div",{className:"stats-card",children:[(0,z.jsx)("h4",{children:"\ucd5c\uadfc 5\ubd84 \ud1b5\uacc4"}),(0,z.jsxs)("div",{className:"stats-grid",children:[(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\ucd1d \uc77d\uae30 \uc791\uc5c5"}),(0,z.jsx)("span",{className:"stat-value",children:s.stats.last5Minutes.reads.toLocaleString()})]}),(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\ucd1d \uc4f0\uae30 \uc791\uc5c5"}),(0,z.jsx)("span",{className:"stat-value",children:s.stats.last5Minutes.writes.toLocaleString()})]}),(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\ucd1d \uc5d0\ub7ec"}),(0,z.jsx)("span",{className:"stat-value",children:s.stats.last5Minutes.errors})]})]})]})]}),!s&&!i&&!r&&(0,z.jsx)("div",{className:"no-data-message",children:(0,z.jsx)("p",{children:"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub824\uba74 \uc0c8\ub85c\uace0\uce68 \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694."})})]}):(0,z.jsxs)("div",{className:"system-monitoring section-card",children:[(0,z.jsx)("h3",{children:"\ud83d\udd12 \uc11c\ubc84 \uc0c1\ud0dc \ubaa8\ub2c8\ud130\ub9c1"}),(0,z.jsx)("p",{className:"admin-section-desc",children:"\ucd5c\uace0 \uad00\ub9ac\uc790\ub9cc \uc811\uadfc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})]})};var Qt=s(5967);const Gt=[{id:"KP",name:"\ucf54\ub529 \ud30c\ud2b8\ub108",price:1e4,history:[{price:1e4,timestamp:new Date}]},{id:"SS",name:"\uc0bc\uc131\uc804\uc790",price:8e4,history:[{price:8e4,timestamp:new Date}]},{id:"LG",name:"LG\uc5d0\ub108\uc9c0\uc194\ub8e8\uc158",price:35e4,history:[{price:35e4,timestamp:new Date}]},{id:"SK",name:"SK\ud558\uc774\ub2c9\uc2a4",price:23e4,history:[{price:23e4,timestamp:new Date}]}],Jt=e=>{let{userClassCode:t,isAdmin:s,isSuperAdmin:n}=e;const[i,l]=(0,a.useState)(""),[r,o]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1);return s||n?(0,z.jsxs)("div",{className:"section-card mt-6 border-2 border-red-500/50 bg-red-900/10",children:[(0,z.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,z.jsx)("span",{className:"text-2xl",children:"\u26a0\ufe0f"}),(0,z.jsx)("h3",{className:"text-xl font-bold text-red-400",children:"\uc704\ud5d8 \uad6c\uc5ed: \ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c"})]}),(0,z.jsxs)("div",{className:"bg-red-900/20 rounded-lg p-4 mb-4 border border-red-500/30",children:[(0,z.jsx)("p",{className:"text-sm text-red-200 mb-2",children:(0,z.jsx)("strong",{children:"\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4!"})}),(0,z.jsx)("p",{className:"text-sm text-red-200 mb-2",children:"\uac1c\uc778\uc815\ubcf4 \ud30c\uae30 \uc758\ubb34\ub97c \uc704\ud574 \ud559\ub144 \ub9d0\uc5d0 \uc0ac\uc6a9\ud558\uc138\uc694."}),(0,z.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:"\uc0ad\uc81c \ub300\uc0c1:"}),(0,z.jsxs)("ul",{className:"text-sm text-gray-300 list-disc list-inside ml-2 space-y-1",children:[(0,z.jsx)("li",{children:"\ud559\uc0dd \uacc4\uc815 (role: 'student')"}),(0,z.jsx)("li",{children:"\ud65c\ub3d9 \ub85c\uadf8 (activity_logs)"}),(0,z.jsx)("li",{children:"\uac70\ub798 \ub0b4\uc5ed (transactions)"})]}),(0,z.jsx)("p",{className:"text-sm text-green-300 mt-2",children:"\u2713 \uc120\uc0dd\ub2d8(admin) \uacc4\uc815\uc740 \uc720\uc9c0\ub429\ub2c8\ub2e4."}),(0,z.jsx)("p",{className:"text-sm text-green-300",children:"\u2713 \uc9c1\uc5c5, \ud560\uc77c, \uc0c1\uc810 \uc544\uc774\ud15c \uc124\uc815\uc740 \uc720\uc9c0\ub429\ub2c8\ub2e4."})]}),d?(0,z.jsxs)("div",{className:"space-y-4",children:[(0,z.jsxs)("div",{children:[(0,z.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:['\ud655\uc778\uc744 \uc704\ud574 "',(0,z.jsx)("strong",{className:"text-red-400",children:"\uc0ad\uc81c"}),'"\ub97c \uc815\ud655\ud788 \uc785\ub825\ud558\uc138\uc694:']}),(0,z.jsx)("input",{type:"text",value:i,onChange:e=>l(e.target.value),placeholder:"\uc0ad\uc81c",disabled:r,className:"w-full px-4 py-2 bg-[#1a1a2e] border border-gray-600 rounded-lg text-white focus:outline-none focus:border-red-500"})]}),(0,z.jsxs)("div",{className:"flex gap-3",children:[(0,z.jsx)("button",{onClick:async()=>{if(!t)return void alert("\ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");if("\uc0ad\uc81c"!==i)return void alert("'\uc0ad\uc81c'\ub97c \uc815\ud655\ud788 \uc785\ub825\ud574\uc8fc\uc138\uc694.");if(window.confirm("\uc815\ub9d0\ub85c '".concat(t,"' \ud559\uae09\uc758 \ubaa8\ub4e0 \ud559\uc0dd \ub370\uc774\ud130\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\n\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc73c\uba70 \ub2e4\uc74c \ub370\uc774\ud130\uac00 \uc601\uad6c \uc0ad\uc81c\ub429\ub2c8\ub2e4:\n- \ud559\uc0dd \uacc4\uc815 (role: 'student')\n- \ud65c\ub3d9 \ub85c\uadf8\n- \uac70\ub798 \ub0b4\uc5ed\n\n\uc120\uc0dd\ub2d8(admin) \uacc4\uc815\uc740 \uc720\uc9c0\ub429\ub2c8\ub2e4."))){o(!0);try{te.vF.log("[ClassDataDeletion] ".concat(t," \ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c \uc2dc\uc791"));const e=firestoreCollection(J.db,"users"),s=(0,J.P)(e,(0,J._M)("classCode","==",t),(0,J._M)("role","==","student")),a=await(0,J.FX)(s);te.vF.log("[ClassDataDeletion] \uc0ad\uc81c\ud560 \ud559\uc0dd \uc218: ".concat(a.size,"\uba85"));const n=firestoreCollection(J.db,"activity_logs"),i=(0,J.P)(n,(0,J._M)("classCode","==",t)),r=await(0,J.FX)(i);te.vF.log("[ClassDataDeletion] \uc0ad\uc81c\ud560 \ud65c\ub3d9 \ub85c\uadf8: ".concat(r.size,"\uac1c"));const o=a.docs.map(e=>e.id);let d=[];if(o.length>0){const e=[];for(let t=0;t<o.length;t+=10)e.push(o.slice(t,t+10));for(const t of e){const e=firestoreCollection(J.db,"transactions"),s=(0,J.P)(e,(0,J._M)("userId","in",t)),a=await(0,J.FX)(s);d.push(...a.docs)}}te.vF.log("[ClassDataDeletion] \uc0ad\uc81c\ud560 \uac70\ub798 \ub0b4\uc5ed: ".concat(d.length,"\uac1c"));const m=[...a.docs,...r.docs,...d];te.vF.log("[ClassDataDeletion] \ucd1d \uc0ad\uc81c\ud560 \ubb38\uc11c: ".concat(m.length,"\uac1c"));const u=500;for(let t=0;t<m.length;t+=u){const e=(0,J.wP)(J.db);m.slice(t,t+u).forEach(t=>{e.delete(t.ref)}),await e.commit(),te.vF.log("[ClassDataDeletion] \ubc30\uce58 ".concat(Math.floor(t/u)+1," \uc0ad\uc81c \uc644\ub8cc"))}alert("\ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c \uc644\ub8cc!\n\n\uc0ad\uc81c\ub41c \ub370\uc774\ud130:\n- \ud559\uc0dd \uacc4\uc815: ".concat(a.size,"\uba85\n- \ud65c\ub3d9 \ub85c\uadf8: ").concat(r.size,"\uac1c\n- \uac70\ub798 \ub0b4\uc5ed: ").concat(d.length,"\uac1c")),te.vF.log("[ClassDataDeletion] ".concat(t," \ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c \uc644\ub8cc")),l(""),c(!1)}catch(e){te.vF.error("[ClassDataDeletion] \uc0ad\uc81c \uc911 \uc624\ub958:",e),alert("\uc624\ub958 \ubc1c\uc0dd: ".concat(e.message,"\n\n\uc77c\ubd80 \ub370\uc774\ud130\ub9cc \uc0ad\uc81c\ub418\uc5c8\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."))}finally{o(!1)}}},disabled:r||"\uc0ad\uc81c"!==i,className:"px-6 py-2 rounded-lg font-medium transition-colors ".concat("\uc0ad\uc81c"!==i||r?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"),children:r?"\uc0ad\uc81c \uc911...":"\ucd5c\uc885 \uc0ad\uc81c \uc2e4\ud589"}),(0,z.jsx)("button",{onClick:()=>{c(!1),l("")},disabled:r,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"\ucde8\uc18c"})]})]}):(0,z.jsx)("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"\ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c \uc2dc\uc791"})]}):null},Ht=e=>{var t;let{isAdmin:s,isSuperAdmin:n,userClassCode:l,showAdminSettingsModal:o,setShowAdminSettingsModal:d,adminSelectedMenu:c,setAdminSelectedMenu:m,newGoalAmount:u,setNewGoalAmount:x,adminCouponValue:p,setAdminCouponValue:h,handleSaveAdminSettings:g,jobs:b,adminNewJobTitle:f,setAdminNewJobTitle:y,adminEditingJob:v,setAdminEditingJob:j,handleSaveJob:N,handleDeleteJob:w,handleEditJob:k,commonTasks:C,showAddTaskForm:S,setShowAddTaskForm:A,adminNewTaskName:I,setAdminNewTaskName:E,adminNewTaskReward:T,setAdminNewTaskReward:D,adminNewTaskMaxClicks:M,setAdminNewTaskMaxClicks:F,adminEditingTask:O,setAdminEditingTask:_,handleSaveTask:R,handleEditTask:L,handleDeleteTask:P,taskFormJobId:W,taskFormIsJobTask:B,handleAddTaskClick:q,classCodes:U=[],onAddClassCode:Q,onRemoveClassCode:G}=e;const[H,V]=(0,a.useState)(""),[K,X]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)([]),[$,se]=(0,a.useState)(!1),[ae,ne]=(0,a.useState)(!1),[ie,le]=(0,a.useState)(null),[re,oe]=(0,a.useState)([]),[de,ce]=(0,a.useState)([]),[me,ue]=(0,a.useState)(!1),[xe,pe]=(0,a.useState)(!1),[he,ge]=(0,a.useState)(!1),[be,fe]=(0,a.useState)(null),[ye,ve]=(0,a.useState)([]),[je,Ne]=(0,a.useState)(!1),[we,ke]=(0,a.useState)(""),[Ce,Se]=(0,a.useState)([]),[Ae,Ie]=(0,a.useState)([]),[Ee,Te]=(0,a.useState)([]),[De,Me]=(0,a.useState)(""),[Fe,Oe]=(0,a.useState)(""),[_e,Re]=(0,a.useState)(""),[ze,Le]=(0,a.useState)("deposit"),[Pe,We]=(0,a.useState)(null),[Be,qe]=(0,a.useState)({isOpen:!1}),[Ue,Qe]=(0,a.useState)(""),[Ge,Je]=(0,a.useState)(!1),He=(0,a.useRef)(null),[Ve,Ke]=(0,a.useState)(.1),[Xe,Ye]=(0,a.useState)(""),[Ze,$e]=(0,a.useState)(null),et=(0,lt.Qg)(J.Cn,"toggleMarketManually"),[tt,st]=(0,a.useState)({taxRate:.1,salaryIncreaseRate:.03}),[at,nt]=(0,a.useState)("10"),[it,rt]=(0,a.useState)("3"),[ot,dt]=(0,a.useState)(!1),ct=(()=>{const{userDoc:e,isAdmin:t,isSuperAdmin:s}=(0,i.As)(),a=null===e||void 0===e?void 0:e.classCode;return(0,Tt.I)({queryKey:Rt(a),queryFn:async()=>(await Ot.getAdminSettingsData({tab:"studentManagement"})).data,enabled:!(null===t||void 0===t||!t()||!a),staleTime:18e4,cacheTime:48e4})})(),mt=(()=>{const{userDoc:e,isAdmin:t}=(0,i.As)(),s=null===e||void 0===e?void 0:e.classCode;return(0,Tt.I)({queryKey:zt(s),queryFn:async()=>(await Ot.getAdminSettingsData({tab:"salarySettings"})).data,enabled:!(null===t||void 0===t||!t()||!s),staleTime:6e5,cacheTime:9e5})})(),ut=((()=>{const{isSuperAdmin:e}=(0,i.As)();(0,Tt.I)({queryKey:Lt(),queryFn:async()=>(await Ot.getAdminSettingsData({tab:"systemManagement"})).data,enabled:!(null===e||void 0===e||!e()),staleTime:9e5,cacheTime:12e5})})(),(e=>{const{userDoc:t,isAdmin:s}=(0,i.As)(),a=null===t||void 0===t?void 0:t.classCode;(0,Tt.I)({queryKey:_t(a,e),queryFn:async()=>{const t="admin_".concat(a,"_").concat(e),s=Bt(t,3e4);if(s&&!navigator.onLine)return s;const n=await Ot.getAdminSettingsData({tab:e});return Wt(t,n),n},enabled:!!(null!==s&&void 0!==s&&s()&&a&&e),staleTime:3e5,cacheTime:6e5,retry:(e,t)=>"permission-denied"!==(null===t||void 0===t?void 0:t.code)&&e<2,refetchInterval:!!Pt()&&3e5})})("generalSettings"),(()=>{const e=(0,Dt.jE)(),{userDoc:t}=(0,i.As)(),s=null===t||void 0===t?void 0:t.classCode;return(0,Mt.n)({mutationFn:async e=>{let{studentIds:t,payAll:s}=e;return await Ot.batchPaySalaries({studentIds:t,payAll:s})},onSuccess:()=>{e.invalidateQueries({queryKey:Rt(s)}),e.invalidateQueries({queryKey:zt(s)}),qt("admin_".concat(s,"_studentManagement")),qt("admin_".concat(s,"_salarySettings"))},onError:e=>{te.vF.error("\uae09\uc5ec \uc9c0\uae09 \uc2e4\ud328:",e)}})})()),{preloadAdminData:xt}=(()=>{const e=(0,Dt.jE)(),{userDoc:t,isAdmin:s}=(0,i.As)(),a=null===t||void 0===t?void 0:t.classCode;return{preloadAdminData:async()=>{if(null===s||void 0===s||!s()||!a)return;const t=["generalSettings","studentManagement","salarySettings"].map(t=>e.prefetchQuery({queryKey:_t(a,t),queryFn:async()=>await Ot.getAdminSettingsData({tab:t}),staleTime:3e5}));await Promise.allSettled(t)}}})(),pt=(0,a.useCallback)(async()=>{if(J.db)try{const e=l?(0,J.EW)(J.db,"settings","salarySettings_".concat(l)):(0,J.EW)(J.db,"settings","salarySettings"),t=await(0,J.I_)(e);if(t.exists()){const e=t.data(),s={taxRate:e.taxRate||.1,salaryIncreaseRate:e.salaryIncreaseRate||.03};st(s),nt(String((100*s.taxRate).toFixed(1))),rt(String((100*s.salaryIncreaseRate).toFixed(1))),e.lastPaidDate&&fe(e.lastPaidDate.toDate())}else await(0,J.iv)(e,{taxRate:.1,salaryIncreaseRate:.03,lastPaidDate:null,classCode:l||null,createdAt:(0,J.O5)(),updatedAt:(0,J.O5)()})}catch(we){te.vF.error("\uae09\uc5ec \uc124\uc815 \ub85c\ub4dc \uc624\ub958:",we)}},[l]),ht=(0,a.useCallback)(async()=>{if(!J.db)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.");const e=parseFloat(at),t=parseFloat(it);if(isNaN(e)||e<0||e>100)alert("\uc138\uc728\uc740 0~100 \uc0ac\uc774\uc758 \uc22b\uc790\uc5ec\uc57c \ud569\ub2c8\ub2e4.");else if(isNaN(t)||t<0||t>100)alert("\uc8fc\uae09 \uc778\uc0c1\ub960\uc740 0~100 \uc0ac\uc774\uc758 \uc22b\uc790\uc5ec\uc57c \ud569\ub2c8\ub2e4.");else{dt(!0);try{const s=l?(0,J.EW)(J.db,"settings","salarySettings_".concat(l)):(0,J.EW)(J.db,"settings","salarySettings"),a={taxRate:e/100,salaryIncreaseRate:t/100,classCode:l||null,updatedAt:(0,J.O5)()};await(0,J.tI)(s,a),st({taxRate:a.taxRate,salaryIncreaseRate:a.salaryIncreaseRate}),alert("\uae09\uc5ec \uc124\uc815\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(we){te.vF.error("\uae09\uc5ec \uc124\uc815 \uc800\uc7a5 \uc624\ub958:",we),alert("\uae09\uc5ec \uc124\uc815 \uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message)}finally{dt(!1)}}},[l,at,it]),gt=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Array.isArray(e)||0===e.length)return{gross:0,tax:0,net:0};const s=2e6+5e5*Math.max(0,e.length-1);if(!t)return s;const a=Math.floor(s*tt.taxRate);return{gross:s,tax:a,net:s-a}},[tt.taxRate]),bt=(0,a.useCallback)(e=>{te.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \ud3b8\uc9d1 \ud074\ub9ad:",e),k&&"function"===typeof k?k(e):(te.vF.error("[AdminSettingsModal] handleEditJob \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\uc9c1\uc5c5 \ud3b8\uc9d1 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[k]),ft=(0,a.useCallback)(e=>{te.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc0ad\uc81c \ud074\ub9ad:",e),w&&"function"===typeof w?w(e):(te.vF.error("[AdminSettingsModal] handleDeleteJob \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\uc9c1\uc5c5 \uc0ad\uc81c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[w]),yt=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;te.vF.log("[AdminSettingsModal] \ud560\uc77c \ud3b8\uc9d1 \ud074\ub9ad:",e,"jobId:",t),L&&"function"===typeof L?L(e,t):(te.vF.error("[AdminSettingsModal] handleEditTask \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \ud3b8\uc9d1 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[L]),vt=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;te.vF.log("[AdminSettingsModal] \ud560\uc77c \uc0ad\uc81c \ud074\ub9ad:",e,"jobId:",t),P&&"function"===typeof P?P(e,t):(te.vF.error("[AdminSettingsModal] handleDeleteTask \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \uc0ad\uc81c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[P]),jt=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];te.vF.log("[AdminSettingsModal] \ud560\uc77c \ucd94\uac00 \ud074\ub9ad:",e,"isJobTask:",t),q&&"function"===typeof q?q(e,t):(te.vF.error("[AdminSettingsModal] handleAddTaskClick \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \ucd94\uac00 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[q]),Nt=(0,a.useCallback)(async()=>{if(!J.db)return te.vF.error("loadStudents: Firestore \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."),ke("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958\ub85c \ud559\uc0dd \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),ce([]),void ue(!1);ue(!0),ke("");try{let s=[];if(!n&&!l)return ke("\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \ud559\uc0dd \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),ce([]),void ue(!1);if(!n&&l)try{const e=(0,J.gJ)(J.db,"Class",l,"students");(await(0,J.FX)(e)).forEach(e=>{const t=e.data();s.push({id:e.id,nickname:t.nickname||t.name||"\uc774\ub984 \uc5c6\uc74c",name:t.name||"",email:t.email||"",classCode:l,selectedJobIds:t.selectedJobIds||[],cash:t.money||t.cash||0,lastSalaryDate:t.lastSalaryDate?t.lastSalaryDate.toDate():null,lastGrossSalary:t.lastGrossSalary||0,lastTaxAmount:t.lastTaxAmount||0,lastNetSalary:t.lastNetSalary||0,totalSalaryReceived:t.totalSalaryReceived||0})})}catch(e){}if(0===s.length){const e=(0,J.gJ)(J.db,"users");let t;!n&&l?t=(0,J.P)(e,(0,J._M)("classCode","==",l)):n&&(t=e);(await(0,J.FX)(t)).forEach(e=>{const t=e.data();t.isAdmin||t.isSuperAdmin||s.push({id:e.id,nickname:t.nickname||t.name||"\uc774\ub984 \uc5c6\uc74c",name:t.name||"",email:t.email||"",classCode:t.classCode||"\ubbf8\uc9c0\uc815",selectedJobIds:t.selectedJobIds||[],cash:t.cash||0,lastSalaryDate:t.lastSalaryDate?t.lastSalaryDate.toDate():null,lastGrossSalary:t.lastGrossSalary||0,lastTaxAmount:t.lastTaxAmount||0,lastNetSalary:t.lastNetSalary||0,totalSalaryReceived:t.totalSalaryReceived||0})})}ce(s);try{const e=l?(0,J.EW)(J.db,"settings","salarySettings_".concat(l)):(0,J.EW)(J.db,"settings","salarySettings"),t=await(0,J.I_)(e);if(t.exists()){const e=t.data();fe(e.lastPaidDate?e.lastPaidDate.toDate():null),st({taxRate:e.taxRate||.1,salaryIncreaseRate:e.salaryIncreaseRate||.03})}else fe(null)}catch(t){te.vF.error("\uae09\uc5ec \uc124\uc815 \ub85c\ub4dc \uc624\ub958:",t),fe(null)}ve([]),Ne(!1)}catch(we){te.vF.error("loadStudents: \ud559\uc0dd \ubaa9\ub85d \ub85c\ub4dc \uc624\ub958:",we),ke("\ud559\uc0dd \ubaa9\ub85d\uc744 \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message),ce([])}finally{ue(!1)}},[n,l]),wt=(0,a.useCallback)(async()=>{if(!J.db)return te.vF.error("loadClassMembers: Firestore \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."),ke("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958\ub85c \ud559\uae09 \uad6c\uc131\uc6d0 \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),Z([]),void se(!1);se(!0),ke("");try{const e=(0,J.gJ)(J.db,"users");let t;if(!n&&l)t=(0,J.P)(e,(0,J._M)("classCode","==",l));else{if(!n)return te.vF.warn("\uad00\ub9ac\uc790\uc758 \ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),ke("\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \uad6c\uc131\uc6d0 \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),Z([]),void se(!1);t=e}const s=await(0,J.FX)(t),a=[];s.forEach(e=>{const t=e.data();a.push({id:e.id,name:t.name||t.nickname||"\uc774\ub984 \uc5c6\uc74c",email:t.email,classCode:t.classCode||"\ucf54\ub4dc \uc5c6\uc74c",isAdmin:t.isAdmin||!1,isSuperAdmin:t.isSuperAdmin||!1})}),Z(a),te.vF.log("[AdminSettingsModal] ".concat(a.length,"\uba85\uc758 \uad6c\uc131\uc6d0 \ub85c\ub4dc \uc644\ub8cc"))}catch(we){te.vF.error("loadClassMembers: \ud559\uae09 \uad6c\uc131\uc6d0 \ub85c\ub4dc \uc624\ub958:",we),ke("\ud559\uae09 \uad6c\uc131\uc6d0\uc744 \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message),Z([])}finally{se(!1)}},[n,l]),kt=(0,lt.Qg)(J.Cn,"adminResetUserPassword"),Ct=(0,a.useCallback)(async e=>{if(!s&&!n)return void alert("\uad00\ub9ac\uc790\ub9cc \ube44\ubc00\ubc88\ud638\ub97c \ucd08\uae30\ud654\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.");const t=prompt("\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694. 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");if(!t||t.length<6)alert("\ube44\ubc00\ubc88\ud638\ub294 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");else if(window.confirm("\uc0ac\uc6a9\uc790(ID: ".concat(e,")\uc758 \ube44\ubc00\ubc88\ud638\ub97c \uc815\ub9d0\ub85c \ucd08\uae30\ud654\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))try{se(!0);const s=await kt({userId:e,newPassword:t});if(!s.data.success)throw new Error(s.data.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958");alert(s.data.message)}catch(we){te.vF.error("\ube44\ubc00\ubc88\ud638 \ucd08\uae30\ud654 \uc624\ub958:",we),alert("\ube44\ubc00\ubc88\ud638 \ucd08\uae30\ud654 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(we.message))}finally{se(!1)}},[s,n,kt]),St=(0,a.useCallback)(async(e,t)=>{if(J.db)if(n){if(window.confirm("\uc774 \uc0ac\uc6a9\uc790\uc758 \uad00\ub9ac\uc790 \uad8c\ud55c\uc744 ".concat(t?"\uc81c\uac70":"\ubd80\uc5ec","\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))){se(!0);try{const s=(0,J.EW)(J.db,"users",e);await(0,J.tI)(s,{isAdmin:!t}),Z(s=>s.map(s=>s.id===e?(0,r.A)((0,r.A)({},s),{},{isAdmin:!t}):s)),alert("\uad00\ub9ac\uc790 \uad8c\ud55c\uc774 ".concat(t?"\uc81c\uac70":"\ubd80\uc5ec","\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))}catch(we){te.vF.error("\uad00\ub9ac\uc790 \uad8c\ud55c \ubcc0\uacbd \uc624\ub958:",we),alert("\uad00\ub9ac\uc790 \uad8c\ud55c \ubcc0\uacbd \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{se(!1)}}}else alert("\ucd5c\uace0 \uad00\ub9ac\uc790\ub9cc \uad00\ub9ac\uc790 \uad8c\ud55c\uc744 \ubd80\uc5ec/\ud574\uc81c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.");else alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.")},[n]),At=(0,a.useCallback)(()=>{try{const e=localStorage.getItem("depositProducts"),t=localStorage.getItem("savingProducts"),s=localStorage.getItem("loanProducts");e&&Se(JSON.parse(e)),t&&Ie(JSON.parse(t)),s&&Te(JSON.parse(s))}catch(we){te.vF.error("\uae08\uc735 \uc0c1\ud488 \ub85c\ub4dc \uc624\ub958:",we)}},[]),It=(0,a.useCallback)(()=>{if(!De||""===De.trim())return void We({type:"error",text:"\uc0c1\ud488\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});if(!Fe||isNaN(Fe)||parseInt(Fe)<=0)return void We({type:"error",text:"\uc720\ud6a8\ud55c \uae30\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});if(!_e||isNaN(_e)||parseFloat(_e)<0)return void We({type:"error",text:"\uc720\ud6a8\ud55c \uc774\uc728\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});const e={id:Date.now(),name:De.trim(),period:parseInt(Fe),rate:parseFloat(_e)},t="deposit"===ze?"\uc608\uae08":"saving"===ze?"\uc801\uae08":"\ub300\ucd9c";let s=[],a="";"deposit"===ze?(s=[...Ce,e],Se(s),a="depositProducts"):"saving"===ze?(s=[...Ae,e],Ie(s),a="savingProducts"):"loan"===ze&&(s=[...Ee,e],Te(s),a="loanProducts"),localStorage.setItem(a,JSON.stringify(s)),We({type:"success",text:"".concat(t," \uc0c1\ud488\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}),Me(""),Oe(""),Re(""),setTimeout(()=>We(null),3e3)},[De,Fe,_e,ze,Ce,Ae,Ee]),Et=(0,a.useCallback)((e,t)=>{const s="deposit"===t?"\uc608\uae08":"saving"===t?"\uc801\uae08":"\ub300\ucd9c";if(!window.confirm("\uc774 ".concat(s," \uc0c1\ud488\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))return;let a=[],n="";"deposit"===t?(a=Ce.filter(t=>t.id!==e),Se(a),n="depositProducts"):"saving"===t?(a=Ae.filter(t=>t.id!==e),Ie(a),n="savingProducts"):"loan"===t&&(a=Ee.filter(t=>t.id!==e),Te(a),n="loanProducts"),localStorage.setItem(n,JSON.stringify(a)),We({type:"success",text:"".concat(s," \uc0c1\ud488\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}),setTimeout(()=>We(null),3e3)},[Ce,Ae,Ee]),Ft=(0,a.useCallback)(async function(){if(l)if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&He.current&&Ge)qe(He.current);else try{const e=(0,ee.H9)(J.db,"ClassStock/".concat(l,"/marketStatus/status")),t=await(0,ee.x7)(e);let s;t.exists()?s=t.data():(s={isOpen:!1},await(0,ee.BN)(e,s)),He.current=s,qe(s),Je(!0)}catch(we){te.vF.error("\uc2dc\uc7a5 \uc0c1\ud0dc \uc870\ud68c \uc2e4\ud328:",we),Qe("\uc2dc\uc7a5 \uc0c1\ud0dc\ub97c \ubd88\ub7ec\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},[l,Ge]),Ht=(0,a.useCallback)(async e=>{const t=e?"\uc218\ub3d9 \uac1c\uc7a5":"\uc218\ub3d9 \ud3d0\uc7a5";if(window.confirm("\uc815\ub9d0\ub85c \uc2dc\uc7a5\uc744 '".concat(t,"' \uc0c1\ud0dc\ub85c \ubcc0\uacbd\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))){try{const t={isOpen:e};qe(t),He.current=t;const s=await et({classCode:l,isOpen:e});Qe(s.data.message)}catch(we){te.vF.error("\uc2dc\uc7a5 \uc0c1\ud0dc \ubcc0\uacbd \uc624\ub958:",we),Qe("\uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(we.message)),He.current?qe(He.current):Ft(!0)}setTimeout(()=>Qe(""),5e3)}},[l,et,Ft]),Vt=(0,a.useCallback)(async()=>{if(window.confirm("\ubaa8\ub4e0 \uc8fc\uc2dd \uc815\ubcf4\ub97c \ucd08\uae30\ud654\ud558\uace0 \uae30\ubcf8\uac12\uc73c\ub85c \uc124\uc815\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")){try{const e=(0,J.wP)(J.db);Gt.forEach(t=>{const s=(0,ee.H9)(J.db,"CentralStocks",t.id);e.set(s,t)}),await e.commit(),alert("\uc8fc\uc2dd \uc815\ubcf4\uac00 \uc131\uacf5\uc801\uc73c\ub85c \ucd08\uae30\ud654\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),Qe("\uc8fc\uc2dd \uc815\ubcf4\uac00 \uc131\uacf5\uc801\uc73c\ub85c \ucd08\uae30\ud654\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(we){te.vF.error("\uc8fc\uc2dd \uc815\ubcf4 \ucd08\uae30\ud654 \uc911 \uc624\ub958 \ubc1c\uc0dd:",we),Qe("\ucd08\uae30\ud654 \uc2e4\ud328: ".concat(we.message))}setTimeout(()=>Qe(""),5e3)}},[]),Kt=(0,a.useCallback)(()=>{const e=localStorage.getItem("parkingInterestRate");e&&Ke(parseFloat(e))},[]),Xt=(0,a.useCallback)(()=>{if(!Xe||isNaN(Xe)||parseFloat(Xe)<0)return void $e({type:"error",text:"\uc720\ud6a8\ud55c \uc774\uc790\uc728\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694 (0 \uc774\uc0c1)."});const e=parseFloat(Xe);Ke(e),localStorage.setItem("parkingInterestRate",e.toString()),$e({type:"success",text:"\ud30c\ud0b9 \ud1b5\uc7a5 \uc77c\uc77c \uc774\uc790\uc728\uc774 ".concat(e,"%\ub85c \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}),Ye(""),setTimeout(()=>$e(null),3e3)},[Xe]),Yt=(0,a.useCallback)(async()=>{if(!Q||"function"!==typeof Q)return void alert("\ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const e=H.trim();if(e){X(!0);try{await Q(e)&&V("")}catch(we){te.vF.error("AdminSettingsModal: \ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uc911 \uc624\ub958:",we)}finally{X(!1)}}else alert("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},[H,Q]),Zt=(0,a.useCallback)(async e=>{if(G&&"function"===typeof G){X(!0);try{await G(e)}catch(we){te.vF.error("AdminSettingsModal: \ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uc911 \uc624\ub958:",we)}finally{X(!1)}}else alert("\ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},[G]);(0,a.useEffect)(()=>{o&&(xt(),ke(""),At(),Kt()),o||(V(""),Z([]),ce([]),le(null),oe([]),ne(!1),fe(null),ve([]),Ne(!1),X(!1),se(!1),ue(!1),pe(!1),ke(""),We(null),Qe(""),$e(null))},[o,c,wt,Nt,pt,At,Kt]),(0,a.useEffect)(()=>{o&&"marketControl"===c&&Ft()},[o,c,Ft]);const $t=()=>{if(!be)return"\uc544\uc9c1 \uc9c0\uae09 \uae30\ub85d \uc5c6\uc74c";try{const e=be;return"".concat(e.getFullYear(),"\ub144 ").concat(String(e.getMonth()+1).padStart(2,"0"),"\uc6d4 ").concat(String(e.getDate()).padStart(2,"0"),"\uc77c ").concat(String(e.getHours()).padStart(2,"0"),":").concat(String(e.getMinutes()).padStart(2,"0"))}catch(e){return te.vF.error("formatLastSalaryDate \uc624\ub958:",e),"\ub0a0\uc9dc \ud615\uc2dd \uc624\ub958"}};return o?s||n?(0,z.jsxs)("div",{className:"admin-settings-modal ".concat(o?"show":""),children:[(0,z.jsxs)("div",{className:"admin-settings-content",children:[(0,z.jsxs)("h2",{children:["\uad00\ub9ac\uc790 \uc124\uc815"," ",n&&(0,z.jsx)("span",{className:"super-admin-badge",children:"(\ucd5c\uace0 \uad00\ub9ac\uc790)"})]}),!n&&l&&(0,z.jsxs)("p",{className:"admin-class-info",children:["\uad00\ub9ac \ud559\uae09: ",l]}),(0,z.jsxs)("div",{className:"admin-menu-tabs flex flex-wrap gap-2.5 p-4 rounded-2xl border border-gray-700",style:{background:"linear-gradient(135deg, #16213e 0%, #1a1a2e 100%)"},children:[(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("generalSettings"===c?"active":""),onClick:()=>m("generalSettings"),children:"\uc77c\ubc18 \uc124\uc815"}),(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("taskManagement"===c?"active":""),onClick:()=>m("taskManagement"),children:"\ud560\uc77c \uad00\ub9ac"}),(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("jobSettings"===c?"active":""),onClick:()=>m("jobSettings"),children:"\uc9c1\uc5c5 \uad00\ub9ac"}),(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("studentManagement"===c?"active":""),onClick:()=>{m("studentManagement"),Nt()},children:"\ud559\uc0dd \uad00\ub9ac"}),(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("salarySettings"===c?"active":""),onClick:()=>m("salarySettings"),children:"\uae09\uc5ec \uc124\uc815"}),(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("financialProducts"===c?"active":""),onClick:()=>m("financialProducts"),children:"\uae08\uc735 \uc0c1\ud488"}),(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("marketControl"===c?"active":""),onClick:()=>m("marketControl"),children:"\uc2dc\uc7a5 \uc81c\uc5b4"}),(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("parkingAccount"===c?"active":""),onClick:()=>m("parkingAccount"),children:"\ud30c\ud0b9 \ud1b5\uc7a5"}),(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("memberManagement"===c?"active":""),onClick:()=>{m("memberManagement"),wt()},children:"\ud559\uae09 \uad6c\uc131\uc6d0"}),(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("databaseManagement"===c?"active":""),onClick:()=>m("databaseManagement"),children:"\ub370\uc774\ud130\ubca0\uc774\uc2a4"}),n&&(0,z.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("systemManagement"===c?"active":""),onClick:()=>m("systemManagement"),children:"\uc2dc\uc2a4\ud15c \uad00\ub9ac"})]}),"generalSettings"===c&&(0,z.jsxs)("div",{className:"general-settings-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsxs)("div",{className:"admin-goal-settings section-card",children:[(0,z.jsx)("h3",{children:"\ubaa9\ud45c \ubc0f \ucfe0\ud3f0 \uac00\uce58 \uc124\uc815"}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\ud074\ub798\uc2a4 \ubaa9\ud45c \ucfe0\ud3f0 \uc218:"}),(0,z.jsx)("input",{type:"number",min:"1",value:u||"",onChange:e=>x&&x(e.target.value),className:"admin-input"})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\ucfe0\ud3f0 \uac00\uce58 (\uc6d0):"}),(0,z.jsx)("input",{type:"number",min:"1",value:p||"",onChange:e=>h&&h(e.target.value),className:"admin-input"})]}),(0,z.jsx)("button",{onClick:g,className:"admin-save-button",children:"\uc800\uc7a5"})]})]}),"taskManagement"===c&&(0,z.jsxs)("div",{className:"task-management-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsxs)("div",{className:"admin-tasks-settings section-card",children:[(0,z.jsx)("h3",{children:"\ud560\uc77c \uad00\ub9ac"}),(0,z.jsx)("p",{className:"admin-section-desc",children:"\uc9c1\uc5c5\ubcc4 \ud560\uc77c\uacfc \uacf5\ud1b5 \ud560\uc77c\uc744 \uad00\ub9ac\ud569\ub2c8\ub2e4."}),S?(0,z.jsxs)("div",{className:"add-task-form",children:[(0,z.jsx)("h4",{children:O?"\ud560\uc77c \uc218\uc815":"\uc0c8 \ud560\uc77c \ucd94\uac00"}),(0,z.jsx)("p",{children:B&&b&&W?"\uc9c1\uc5c5: ".concat((null===(t=b.find(e=>e.id===W))||void 0===t?void 0:t.title)||"\uc54c \uc218 \uc5c6\ub294 \uc9c1\uc5c5"):"\uacf5\ud1b5 \ud560\uc77c"}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\ud560\uc77c \uc774\ub984:"}),(0,z.jsx)("input",{type:"text",value:I,onChange:e=>E(e.target.value),placeholder:"\ud560\uc77c \uc774\ub984 \uc785\ub825",className:"admin-input"})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\ubcf4\uc0c1 (\ucfe0\ud3f0):"}),(0,z.jsx)("input",{type:"number",min:"0",value:T,onChange:e=>D(e.target.value),placeholder:"\ucfe0\ud3f0 \ubcf4\uc0c1",className:"admin-input"})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\ucd5c\ub300 \ud074\ub9ad \uc218:"}),(0,z.jsx)("input",{type:"number",min:"1",value:M,onChange:e=>F(e.target.value),placeholder:"\ucd5c\ub300 \ud074\ub9ad \uc218",className:"admin-input"})]}),(0,z.jsxs)("div",{className:"task-form-buttons",children:[(0,z.jsx)("button",{onClick:()=>{te.vF.log("[AdminSettingsModal] \ud560\uc77c \uc800\uc7a5 \ubc84\ud2bc \ud074\ub9ad"),R&&"function"===typeof R?R():(te.vF.error("[AdminSettingsModal] handleSaveTask \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \uc800\uc7a5 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},className:"admin-save-button",children:O?"\uc218\uc815":"\ucd94\uac00"}),(0,z.jsx)("button",{onClick:()=>{A(!1),_(null)},className:"admin-cancel-button",children:"\ucde8\uc18c"})]})]}):(0,z.jsxs)("div",{className:"task-management",children:[(0,z.jsxs)("div",{className:"task-management-buttons",children:[(0,z.jsx)("button",{onClick:()=>{te.vF.log("[AdminSettingsModal] \uacf5\ud1b5 \ud560\uc77c \ucd94\uac00 \ubc84\ud2bc \ud074\ub9ad"),jt(null,!1)},className:"admin-button",children:"\uacf5\ud1b5 \ud560\uc77c \ucd94\uac00"}),(0,z.jsxs)("select",{onChange:e=>{e.target.value&&(te.vF.log("[AdminSettingsModal] \uc9c1\uc5c5\ubcc4 \ud560\uc77c \ucd94\uac00 \uc120\ud0dd:",e.target.value),jt(e.target.value,!0))},className:"job-select",value:"",children:[(0,z.jsx)("option",{value:"",children:"\uc9c1\uc5c5\ubcc4 \ud560\uc77c \ucd94\uac00..."}),Array.isArray(b)&&b.map(e=>(0,z.jsxs)("option",{value:e.id,children:[e.title,"\uc5d0 \ud560\uc77c \ucd94\uac00"]},e.id))]})]}),(0,z.jsxs)("div",{className:"tasks-by-job",children:[(0,z.jsx)("h4",{children:"\uc9c1\uc5c5\ubcc4 \ud560\uc77c"}),Array.isArray(b)&&b.length>0?b.map(e=>(0,z.jsxs)("div",{className:"job-tasks",children:[(0,z.jsx)("h5",{children:e.title}),Array.isArray(e.tasks)&&e.tasks.length>0?(0,z.jsx)("ul",{className:"admin-tasks",children:e.tasks.map(t=>(0,z.jsxs)("li",{className:"admin-task-item",children:[(0,z.jsxs)("div",{className:"task-info",children:[(0,z.jsx)("span",{className:"task-name",children:t.name}),(0,z.jsxs)("span",{className:"task-reward",children:["\ubcf4\uc0c1: ",t.reward||0," \ucfe0\ud3f0"]}),(0,z.jsxs)("span",{className:"task-clicks",children:["\ud074\ub9ad: ",t.clicks||0,"/",t.maxClicks||5]})]}),(0,z.jsxs)("div",{className:"task-actions",children:[(0,z.jsx)("button",{onClick:()=>{te.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \ud560\uc77c \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",t,e.id),yt(t,e.id)},className:"edit-button",children:"\uc218\uc815"}),(0,z.jsx)("button",{onClick:()=>{te.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \ud560\uc77c \uc0ad\uc81c \ubc84\ud2bc \ud074\ub9ad:",t.id,e.id),vt(t.id,e.id)},className:"delete-button",children:"\uc0ad\uc81c"})]})]},t.id))}):(0,z.jsx)("p",{className:"no-items-message",children:"\uc774 \uc9c1\uc5c5\uc5d0 \ub4f1\ub85d\ub41c \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]},e.id)):(0,z.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,z.jsxs)("div",{className:"common-tasks",children:[(0,z.jsx)("h4",{children:"\uacf5\ud1b5 \ud560\uc77c"}),Array.isArray(C)&&C.length>0?(0,z.jsx)("ul",{className:"admin-tasks",children:C.map(e=>(0,z.jsxs)("li",{className:"admin-task-item",children:[(0,z.jsxs)("div",{className:"task-info",children:[(0,z.jsx)("span",{className:"task-name",children:e.name}),(0,z.jsxs)("span",{className:"task-reward",children:["\ubcf4\uc0c1: ",e.reward||0," \ucfe0\ud3f0"]}),(0,z.jsxs)("span",{className:"task-clicks",children:["\ud074\ub9ad: ",e.clicks||0,"/",e.maxClicks||5]})]}),(0,z.jsxs)("div",{className:"task-actions",children:[(0,z.jsx)("button",{onClick:()=>{te.vF.log("[AdminSettingsModal] \uacf5\ud1b5 \ud560\uc77c \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",e),yt(e)},className:"edit-button",children:"\uc218\uc815"}),(0,z.jsx)("button",{onClick:()=>{te.vF.log("[AdminSettingsModal] \uacf5\ud1b5 \ud560\uc77c \uc0ad\uc81c \ubc84\ud2bc \ud074\ub9ad:",e.id),vt(e.id)},className:"delete-button",children:"\uc0ad\uc81c"})]})]},e.id))}):(0,z.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uacf5\ud1b5 \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]})]})]}),"jobSettings"===c&&(0,z.jsxs)("div",{className:"job-settings-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsxs)("div",{className:"admin-jobs-settings section-card",children:[(0,z.jsx)("h3",{children:"\uc9c1\uc5c5 \uad00\ub9ac"}),(0,z.jsxs)("div",{className:"add-job-form",children:[(0,z.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),placeholder:v?"\uc9c1\uc5c5\uba85 \uc218\uc815":"\uc0c8 \uc9c1\uc5c5\uba85 \uc785\ub825",className:"admin-input"}),(0,z.jsx)("button",{onClick:()=>{te.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc800\uc7a5 \ubc84\ud2bc \ud074\ub9ad"),N&&"function"===typeof N?N():(te.vF.error("[AdminSettingsModal] handleSaveJob \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\uc9c1\uc5c5 \uc800\uc7a5 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},className:"admin-save-button",children:v?"\uc218\uc815":"\ucd94\uac00"}),v&&(0,z.jsx)("button",{onClick:()=>{j(null),y("")},className:"admin-cancel-button",children:"\ucde8\uc18c"})]}),(0,z.jsxs)("div",{className:"jobs-list",children:[(0,z.jsx)("h4",{children:"\ub4f1\ub85d\ub41c \uc9c1\uc5c5 \ubaa9\ub85d"}),b&&b.length>0?(0,z.jsx)("ul",{className:"admin-jobs",children:b.map(e=>(0,z.jsxs)("li",{className:"admin-job-item",children:[(0,z.jsx)("span",{className:"job-title",children:e.title}),(0,z.jsxs)("div",{className:"job-actions",children:[(0,z.jsx)("button",{onClick:()=>{te.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",e),bt(e)},className:"edit-button",children:"\uc218\uc815"}),(0,z.jsx)("button",{onClick:()=>{te.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc0ad\uc81c \ubc84\ud2bc \ud074\ub9ad:",e.id),ft(e.id)},className:"delete-button",children:"\uc0ad\uc81c"})]})]},e.id))}):(0,z.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]})]}),"studentManagement"===c&&(0,z.jsxs)("div",{className:"student-management-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsxs)("div",{className:"student-jobs-settings section-card",children:[(0,z.jsx)("h3",{children:"\ud559\uc0dd\uc9c1\uc5c5 \uad00\ub9ac"}),we&&(0,z.jsx)("p",{className:"error-message",children:we}),(0,z.jsx)("p",{className:"admin-section-desc",children:"\ud559\uc0dd\ub4e4\uc5d0\uac8c \uc9c1\uc5c5\uc744 \ubc30\uc815\ud558\uac70\ub098 \uad00\ub9ac\ud569\ub2c8\ub2e4. \uc8fc\uae09\uc740 \uc9c1\uc5c5 \uc218\uc5d0 \ub530\ub77c \ucc28\ub4f1 \uc9c0\uae09\ub429\ub2c8\ub2e4."}),(0,z.jsxs)("div",{className:"salary-management",children:[(0,z.jsxs)("div",{className:"salary-info",children:[(0,z.jsx)("h4",{children:"\uc8fc\uae09 \uc9c0\uae09 \uad00\ub9ac"}),(0,z.jsx)("p",{children:"\uae30\ubcf8 \uc8fc\uae09: 200\ub9cc\uc6d0, \ucd94\uac00 \uc9c1\uc5c5\ub2f9: 50\ub9cc\uc6d0"}),(0,z.jsxs)("p",{children:["\uc138\uc728: ",(100*tt.taxRate).toFixed(1),"%"]}),(0,z.jsxs)("p",{children:["\uc8fc\uae09 \uc778\uc0c1\ub960: ",(100*tt.salaryIncreaseRate).toFixed(1),"% (\ub9e4\uc8fc)"]}),(0,z.jsxs)("p",{children:["\ub9c8\uc9c0\ub9c9 \uc8fc\uae09 \uc9c0\uae09\uc77c: ",$t()]}),(0,z.jsx)("p",{className:"auto-payment-info",children:"\u23f0 \uc790\ub3d9 \uc8fc\uae09 \uc9c0\uae09: \ub9e4\uc8fc \uae08\uc694\uc77c \uc624\uc804 8\uc2dc (\uc11c\ubc84 \uc790\ub3d9 \uc2e4\ud589)"})]}),(0,z.jsxs)("div",{className:"salary-buttons",children:[(0,z.jsx)("button",{className:"admin-button pay-salary-button",onClick:async()=>{var e,t;const s=(null===(e=ct.data)||void 0===e?void 0:e.students)||de,a=(null===(t=mt.data)||void 0===t?void 0:t.settings)||tt;if(s&&0!==s.length){if(window.confirm("\ubaa8\ub4e0 \ud559\uc0dd\ub4e4\uc5d0\uac8c \uc9c1\uc5c5\ubcc4 \uc8fc\uae09\uc744 \uc9c0\uae09\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n(\uc9c1\uc5c5\uc774 \uc788\ub294 \ud559\uc0dd\ub9cc \ud574\ub2f9, \uc138\uae08 ".concat((100*a.taxRate).toFixed(1),"% \uacf5\uc81c)"))){ge(!0);try{const e=await ut.mutateAsync({studentIds:[],payAll:!0});if(e.success){const{summary:t}=e;alert("\uc8fc\uae09 \uc9c0\uae09 \uc644\ub8cc!\n".concat(t.totalStudentsPaid,"\uba85\uc758 \ud559\uc0dd\uc5d0\uac8c \uc9c0\uae09\n\ucd1d \uae09\uc5ec: ").concat((t.totalGrossPaid/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc138\uae08 \uacf5\uc81c: ").concat((t.totalTaxDeducted/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc2e4\uc81c \uc9c0\uae09: ").concat((t.totalNetPaid/1e4).toFixed(0),"\ub9cc\uc6d0"))}else alert(e.message||"\uc8fc\uae09 \uc9c0\uae09\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(we){te.vF.error("[AdminSettingsModal] \uc804\uccb4 \ud559\uc0dd \uc8fc\uae09 \uc9c0\uae09 \uc624\ub958:",we),alert("\uc8fc\uae09 \uc9c0\uae09 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message)}finally{ge(!1)}}}else alert("\ud559\uc0dd \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.")},disabled:he||me,children:he?"\uc8fc\uae09 \uc9c0\uae09 \uc911...":"\uc804\uccb4 \ud559\uc0dd \uc8fc\uae09 \uc9c0\uae09"}),(0,z.jsx)("button",{className:"admin-button pay-selected-salary-button",onClick:async()=>{var e;if(0===ye.length)return void alert("\uc120\ud0dd\ub41c \ud559\uc0dd\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");const t=(null===(e=mt.data)||void 0===e?void 0:e.settings)||tt;if(window.confirm("\uc120\ud0dd\ub41c ".concat(ye.length,"\uba85\uc758 \ud559\uc0dd\uc5d0\uac8c \uc8fc\uae09\uc744 \uc9c0\uae09\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n(\uc138\uae08 ").concat((100*t.taxRate).toFixed(1),"% \uacf5\uc81c \ud6c4 \uc9c0\uae09)"))){ge(!0);try{const e=await ut.mutateAsync({studentIds:ye,payAll:!1});if(e.success){const{summary:t}=e;alert("\uc8fc\uae09 \uc9c0\uae09 \uc644\ub8cc!\n".concat(t.totalStudentsPaid,"\uba85\uc758 \ud559\uc0dd\uc5d0\uac8c \uc9c0\uae09\n\ucd1d \uae09\uc5ec: ").concat((t.totalGrossPaid/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc138\uae08 \uacf5\uc81c: ").concat((t.totalTaxDeducted/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc2e4\uc81c \uc9c0\uae09: ").concat((t.totalNetPaid/1e4).toFixed(0),"\ub9cc\uc6d0")),ve([]),Ne(!1)}else alert(e.message||"\uc8fc\uae09 \uc9c0\uae09\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(we){te.vF.error("[AdminSettingsModal] \uc120\ud0dd\ub41c \ud559\uc0dd \uc8fc\uae09 \uc9c0\uae09 \uc624\ub958:",we),alert("\uc8fc\uae09 \uc9c0\uae09 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message)}finally{ge(!1)}}},disabled:he||me||0===ye.length,children:he?"\uc8fc\uae09 \uc9c0\uae09 \uc911...":"\uc120\ud0dd \ud559\uc0dd(".concat(ye.length,") \uc8fc\uae09 \uc9c0\uae09")})]})]}),(0,z.jsxs)("div",{className:"student-jobs-container",children:[(0,z.jsxs)("div",{className:"student-list-header",children:[(0,z.jsxs)("h4",{children:["\ud559\uc0dd \ubaa9\ub85d"," ",!n&&l&&"(".concat(l," \ud559\uae09)")]}),(0,z.jsx)("button",{onClick:Nt,className:"admin-button",disabled:me,children:me?"\ub85c\ub529 \uc911...":"\ud559\uc0dd \ubaa9\ub85d \uc0c8\ub85c\uace0\uce68"})]}),me?(0,z.jsx)("p",{children:"\ud559\uc0dd \uc815\ubcf4 \ub85c\ub529 \uc911..."}):de.length>0?(0,z.jsx)("div",{className:"members-table-container",children:(0,z.jsxs)("table",{className:"members-table",children:[(0,z.jsx)("thead",{children:(0,z.jsxs)("tr",{children:[(0,z.jsx)("th",{children:(0,z.jsx)("input",{type:"checkbox",checked:je,onChange:()=>{ve(je?[]:de.map(e=>e.id).filter(e=>null!=e)),Ne(!je)},disabled:0===de.length})}),(0,z.jsx)("th",{children:"\ud559\uc0dd \uc774\ub984"}),(0,z.jsx)("th",{children:"\uc774\uba54\uc77c"}),(0,z.jsx)("th",{children:"\ud559\uae09"}),(0,z.jsx)("th",{children:"\ud604\uc7ac \uc9c1\uc5c5"}),(0,z.jsx)("th",{children:"\uc608\uc0c1 \ucd1d\uae09\uc5ec"}),(0,z.jsx)("th",{children:"\uc138\uae08 \uacf5\uc81c"}),(0,z.jsx)("th",{children:"\uc2e4\uae09\uc5ec"}),(0,z.jsx)("th",{children:"\ubcf4\uc720 \ud604\uae08"}),(0,z.jsx)("th",{children:"\ucd5c\uadfc \uc8fc\uae09\uc77c"}),(0,z.jsx)("th",{children:"\uad00\ub9ac"})]})}),(0,z.jsx)("tbody",{children:de.map(e=>{const t=gt(e.selectedJobIds,!0);return(0,z.jsxs)("tr",{className:ye.includes(e.id)?"selected-student-row":"",children:[(0,z.jsx)("td",{children:(0,z.jsx)("input",{type:"checkbox",checked:ye.includes(e.id),onChange:()=>{return t=e.id,void ve(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}})}),(0,z.jsx)("td",{children:e.nickname||e.name||"\uc774\ub984 \uc5c6\uc74c"}),(0,z.jsx)("td",{children:e.email||"-"}),(0,z.jsx)("td",{children:e.classCode||"\ubbf8\uc9c0\uc815"}),(0,z.jsx)("td",{children:Array.isArray(e.selectedJobIds)&&e.selectedJobIds.length>0?e.selectedJobIds.map(e=>{const t=Array.isArray(b)?b.find(t=>t.id===e):null;return t?t.title:null}).filter(Boolean).join(", "):(0,z.jsx)("span",{className:"no-jobs",children:"\uc9c1\uc5c5 \uc5c6\uc74c"})}),(0,z.jsx)("td",{className:"salary-column",children:"".concat((t.gross/1e4).toFixed(0),"\ub9cc\uc6d0")}),(0,z.jsx)("td",{className:"tax-column",children:"".concat((t.tax/1e4).toFixed(0),"\ub9cc\uc6d0")}),(0,z.jsx)("td",{className:"net-salary-column",children:"".concat((t.net/1e4).toFixed(0),"\ub9cc\uc6d0")}),(0,z.jsxs)("td",{className:"cash-column",children:[(e.cash||0).toLocaleString(),"\uc6d0"]}),(0,z.jsx)("td",{children:e.lastSalaryDate?e.lastSalaryDate.toLocaleDateString():"\uc5c6\uc74c"}),(0,z.jsx)("td",{children:(0,z.jsx)("button",{className:"edit-button",onClick:()=>(e=>{le(e),oe(Array.isArray(e.selectedJobIds)?[...e.selectedJobIds]:[]),ne(!0)})(e),children:"\uc9c1\uc5c5 \uc124\uc815"})})]},e.id)})})]})}):(0,z.jsx)("p",{className:"no-items-message",children:n||l?"\ud559\uc0dd \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.":"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."})]})]})]}),"financialProducts"===c&&(0,z.jsxs)("div",{className:"financial-products-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsxs)("div",{className:"financial-products-settings section-card",children:[(0,z.jsx)("h3",{children:"\uae08\uc735 \uc0c1\ud488 \uad00\ub9ac"}),(0,z.jsx)("p",{className:"admin-section-desc",children:"\uc608\uae08, \uc801\uae08, \ub300\ucd9c \uc0c1\ud488\uc744 \ucd94\uac00\ud558\uac70\ub098 \uc0ad\uc81c\ud569\ub2c8\ub2e4."}),(0,z.jsxs)("div",{className:"financial-sub-tabs flex gap-2 mb-4",children:[(0,z.jsx)("button",{className:"sub-tab-button px-4 py-2 rounded-lg cursor-pointer font-semibold ".concat("deposit"===ze?"active":""),onClick:()=>Le("deposit"),style:{border:"deposit"===ze?"2px solid #4f46e5":"1px solid #374151",background:"deposit"===ze?"#4f46e5":"transparent",color:"deposit"===ze?"white":"#9ca3af"},children:"\uc608\uae08 \uc0c1\ud488"}),(0,z.jsx)("button",{className:"sub-tab-button px-4 py-2 rounded-lg cursor-pointer font-semibold ".concat("saving"===ze?"active":""),onClick:()=>Le("saving"),style:{border:"saving"===ze?"2px solid #4f46e5":"1px solid #374151",background:"saving"===ze?"#4f46e5":"transparent",color:"saving"===ze?"white":"#9ca3af"},children:"\uc801\uae08 \uc0c1\ud488"}),(0,z.jsx)("button",{className:"sub-tab-button px-4 py-2 rounded-lg cursor-pointer font-semibold ".concat("loan"===ze?"active":""),onClick:()=>Le("loan"),style:{border:"loan"===ze?"2px solid #4f46e5":"1px solid #374151",background:"loan"===ze?"#4f46e5":"transparent",color:"loan"===ze?"white":"#9ca3af"},children:"\ub300\ucd9c \uc0c1\ud488"})]}),Pe&&(0,z.jsx)("div",{className:"message-box ".concat(Pe.type," p-3 mb-4 rounded-lg text-white"),style:{background:"success"===Pe.type?"#065f46":"#991b1b"},children:Pe.text}),(0,z.jsxs)("div",{className:"add-product-form p-4 rounded-xl mb-4 bg-gray-700/50",children:[(0,z.jsxs)("h4",{className:"mb-3 text-white",children:["deposit"===ze?"\uc608\uae08":"saving"===ze?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488 \ucd94\uac00"]}),(0,z.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[(0,z.jsxs)("div",{children:[(0,z.jsx)("label",{className:"block mb-1 text-gray-400 text-xs",children:"\uc0c1\ud488\uba85"}),(0,z.jsx)("input",{type:"text",value:De,onChange:e=>Me(e.target.value),placeholder:"\uc0c1\ud488\uba85 \uc785\ub825",className:"admin-input w-full"})]}),(0,z.jsxs)("div",{children:[(0,z.jsx)("label",{className:"block mb-1 text-gray-400 text-xs",children:"\uae30\uac04 (\uc77c)"}),(0,z.jsx)("input",{type:"number",value:Fe,onChange:e=>Oe(e.target.value),placeholder:"\uae30\uac04 (\uc77c)",min:"1",className:"admin-input w-full"})]}),(0,z.jsxs)("div",{children:[(0,z.jsx)("label",{className:"block mb-1 text-gray-400 text-xs",children:"\uc774\uc728 (%)"}),(0,z.jsx)("input",{type:"number",value:_e,onChange:e=>Re(e.target.value),placeholder:"\uc774\uc728 (%)",min:"0",step:"0.1",className:"admin-input w-full"})]})]}),(0,z.jsx)("button",{onClick:It,className:"admin-save-button w-full",children:"\uc0c1\ud488 \ucd94\uac00\ud558\uae30"})]}),(0,z.jsxs)("div",{className:"product-list",children:[(0,z.jsxs)("h4",{className:"mb-3 text-white",children:["deposit"===ze?"\uc608\uae08":"saving"===ze?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488 \ubaa9\ub85d"]}),(()=>{const e="deposit"===ze?Ce:"saving"===ze?Ae:Ee;return 0===e.length?(0,z.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,z.jsx)("div",{className:"members-table-container",children:(0,z.jsxs)("table",{className:"members-table",children:[(0,z.jsx)("thead",{children:(0,z.jsxs)("tr",{children:[(0,z.jsx)("th",{children:"\uc0c1\ud488\uba85"}),(0,z.jsx)("th",{children:"\uae30\uac04 (\uc77c)"}),(0,z.jsx)("th",{children:"\uc774\uc728 (%)"}),(0,z.jsx)("th",{children:"\uad00\ub9ac"})]})}),(0,z.jsx)("tbody",{children:e.map(e=>(0,z.jsxs)("tr",{children:[(0,z.jsx)("td",{children:e.name}),(0,z.jsxs)("td",{children:[e.period,"\uc77c"]}),(0,z.jsxs)("td",{children:[e.rate,"%"]}),(0,z.jsx)("td",{children:(0,z.jsx)("button",{onClick:()=>Et(e.id,ze),className:"delete-button",children:"\uc0ad\uc81c"})})]},e.id))})]})})})()]})]})]}),"marketControl"===c&&(0,z.jsxs)("div",{className:"market-control-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsxs)("div",{className:"market-control-settings section-card",children:[(0,z.jsx)("h3",{children:"\uc8fc\uc2dd \uc2dc\uc7a5 \uc81c\uc5b4"}),(0,z.jsx)("p",{className:"admin-section-desc",children:"\uc8fc\uc2dd \uc2dc\uc7a5\uc758 \uac1c\uc7a5/\ud3d0\uc7a5 \uc0c1\ud0dc\ub97c \uc218\ub3d9\uc73c\ub85c \uc81c\uc5b4\ud569\ub2c8\ub2e4."}),(0,z.jsxs)("div",{className:"p-4 rounded-xl mb-4 bg-gray-700/50",children:[(0,z.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,z.jsxs)("p",{className:"text-white",children:["\ud604\uc7ac \uc0c1\ud0dc:"," ",(0,z.jsx)("span",{className:"font-bold px-3 py-1 rounded-2xl",style:{color:Be.isOpen?"#22c55e":"#ef4444",background:Be.isOpen?"rgba(34, 197, 94, 0.2)":"rgba(239, 68, 68, 0.2)"},children:Be.isOpen?"\ud83d\udfe2 \uac1c\uc7a5":"\ud83d\udd34 \ud3d0\uc7a5"})]}),(0,z.jsx)("button",{onClick:()=>Ft(!0),className:"admin-button",disabled:!l,children:"\uc0c8\ub85c\uace0\uce68"})]}),(0,z.jsxs)("div",{className:"flex gap-3 mb-4",children:[(0,z.jsx)("button",{onClick:()=>Ht(!0),disabled:Be.isOpen,className:"admin-save-button flex-1",style:{background:Be.isOpen?"#374151":"#22c55e",cursor:Be.isOpen?"not-allowed":"pointer"},children:"\uc218\ub3d9 \uac1c\uc7a5"}),(0,z.jsx)("button",{onClick:()=>Ht(!1),disabled:!Be.isOpen,className:"admin-cancel-button flex-1",style:{background:Be.isOpen?"#ef4444":"#374151",cursor:Be.isOpen?"pointer":"not-allowed"},children:"\uc218\ub3d9 \ud3d0\uc7a5"})]}),(0,z.jsxs)("p",{className:"text-xs text-gray-400",children:["\ubc84\ud2bc\uc744 \ub204\ub974\uba74 \uc815\ud574\uc9c4 \uc2dc\uac04\uacfc \uc0c1\uad00\uc5c6\uc774 \uc2dc\uc7a5 \uc0c1\ud0dc\uac00 \uc989\uc2dc \ubcc0\uacbd\ub429\ub2c8\ub2e4.",(0,z.jsx)("br",{}),"\uc790\ub3d9 \uac1c\uc7a5/\ud3d0\uc7a5 \uc2dc\uac04(\uc6d4-\uae08, \uc624\uc804 8\uc2dc/\uc624\ud6c4 3\uc2dc)\uc774 \ub418\uba74 \uc790\ub3d9\uc73c\ub85c \uc0c1\ud0dc\uac00 \ubcc0\uacbd\ub429\ub2c8\ub2e4."]})]}),Ue&&(0,z.jsx)("div",{className:"p-3 mb-4 rounded-lg bg-amber-600 text-white text-center",children:Ue}),(0,z.jsxs)("div",{className:"p-4 rounded-xl bg-red-500/10 border border-red-500/30",children:[(0,z.jsx)("h4",{className:"mb-3 text-red-500",children:"\u26a0\ufe0f \uc8fc\uc2dd \uc815\ubcf4 \ucd08\uae30\ud654"}),(0,z.jsx)("p",{className:"text-xs text-gray-400 mb-3",children:"\uc8fc\uc758: \uc774 \ubc84\ud2bc\uc744 \ub204\ub974\uba74 \ubaa8\ub4e0 \uc8fc\uc2dd\uc758 \uac00\uaca9\uacfc \uac70\ub798 \ub0b4\uc5ed\uc774 \uae30\ubcf8\uac12\uc73c\ub85c \ucd08\uae30\ud654\ub429\ub2c8\ub2e4. \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,z.jsx)("button",{onClick:Vt,className:"w-full p-3 rounded-lg bg-orange-600 text-white border-0 cursor-pointer font-semibold",children:"\ubaa8\ub4e0 \uc8fc\uc2dd \uc815\ubcf4 \ucd08\uae30\ud654"})]})]})]}),"parkingAccount"===c&&(0,z.jsxs)("div",{className:"parking-account-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsxs)("div",{className:"parking-account-settings section-card",children:[(0,z.jsx)("h3",{children:"\ud30c\ud0b9 \ud1b5\uc7a5 \uc774\uc790\uc728 \uad00\ub9ac"}),(0,z.jsx)("p",{className:"admin-section-desc",children:"\ud30c\ud0b9 \ud1b5\uc7a5\uc758 \uc77c\uc77c \uc774\uc790\uc728\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."}),Ze&&(0,z.jsx)("div",{className:"p-3 mb-4 rounded-lg text-white",style:{background:"success"===Ze.type?"#065f46":"#991b1b"},children:Ze.text}),(0,z.jsxs)("div",{className:"p-4 rounded-xl mb-4 bg-gray-700/50",children:[(0,z.jsxs)("div",{className:"mb-4",children:[(0,z.jsx)("p",{className:"text-gray-400 text-sm",children:"\ud604\uc7ac \uc77c\uc77c \uc774\uc790\uc728"}),(0,z.jsxs)("p",{className:"text-green-500 text-[32px] font-bold",children:[Ve,"%"]})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{className:"block mb-2 text-gray-400",children:"\uc0c8 \uc77c\uc77c \uc774\uc790\uc728 (%)"}),(0,z.jsx)("input",{type:"number",value:Xe,onChange:e=>Ye(e.target.value),placeholder:"\uc0c8 \uc774\uc790\uc728 \uc785\ub825 (%)",min:"0",step:"0.01",className:"admin-input mb-3"}),(0,z.jsx)("button",{onClick:Xt,className:"admin-save-button w-full",disabled:!Xe||isNaN(Xe)||parseFloat(Xe)<0,children:"\uc774\uc790\uc728 \ubcc0\uacbd"})]}),(0,z.jsx)("p",{className:"text-xs text-gray-400 mt-3",children:"\ud30c\ud0b9 \ud1b5\uc7a5\uc5d0 \uc608\uce58\ub41c \uae08\uc561\uc740 \ub9e4\uc77c \uc124\uc815\ub41c \uc774\uc790\uc728\ub9cc\ud07c \uc774\uc790\uac00 \ubc1c\uc0dd\ud569\ub2c8\ub2e4."})]})]})]}),"memberManagement"===c&&(0,z.jsxs)("div",{className:"member-management-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsxs)("div",{className:"admin-class-members-container section-card",children:[(0,z.jsx)("h3",{children:"\ud559\uae09 \uad6c\uc131\uc6d0 \uad00\ub9ac"}),we&&(0,z.jsx)("p",{className:"error-message",children:we}),(0,z.jsxs)("p",{className:"admin-section-desc",children:["\ud559\uae09 \uad6c\uc131\uc6d0\uc758 \uc815\ubcf4\ub97c \ud655\uc778\ud558\uace0 \uad00\ub9ac\ud569\ub2c8\ub2e4.",n&&" \ucd5c\uace0 \uad00\ub9ac\uc790\ub294 \ubaa8\ub4e0 \ud559\uae09\uc758 \uad6c\uc131\uc6d0\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),$?(0,z.jsx)("p",{children:"\uad6c\uc131\uc6d0 \uc815\ubcf4 \ub85c\ub529 \uc911..."}):Y.length>0?(0,z.jsx)("div",{className:"user-cards-container",children:Y.map(e=>(0,z.jsxs)("div",{className:"user-card",children:[(0,z.jsxs)("div",{className:"user-card-header",children:[(0,z.jsx)("span",{className:"user-card-name",children:e.name}),(0,z.jsx)("span",{className:"user-card-role role-".concat(e.isSuperAdmin?"super":e.isAdmin?"admin":"student"),children:e.isSuperAdmin?"\ucd5c\uace0 \uad00\ub9ac\uc790":e.isAdmin?"\uad00\ub9ac\uc790":"\ud559\uc0dd"})]}),(0,z.jsxs)("div",{className:"user-card-body",children:[(0,z.jsxs)("p",{children:[(0,z.jsx)("strong",{children:"\uc774\uba54\uc77c:"})," ",e.email]}),(0,z.jsxs)("p",{children:[(0,z.jsx)("strong",{children:"\ud559\uae09 \ucf54\ub4dc:"})," ",e.classCode]})]}),n&&(0,z.jsxs)("div",{className:"user-card-actions",children:[!e.isSuperAdmin&&(0,z.jsx)("button",{onClick:()=>St(e.id,e.isAdmin),className:"admin-action-button ".concat(e.isAdmin?"remove-admin-button":"add-admin-button"),disabled:$,children:e.isAdmin?"\uad00\ub9ac\uc790 \ud574\uc81c":"\uad00\ub9ac\uc790 \uc9c0\uc815"}),(0,z.jsx)("button",{onClick:()=>Ct(e.id),className:"admin-action-button reset-password-button",disabled:$,children:"\ube44\ubc00\ubc88\ud638 \ucd08\uae30\ud654"})]})]},e.id))}):(0,z.jsx)("p",{className:"no-members-message",children:n||l?"\ub4f1\ub85d\ub41c \ud559\uae09 \uad6c\uc131\uc6d0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.":"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."}),(0,z.jsx)("div",{className:"refresh-members-section",children:(0,z.jsx)("button",{onClick:wt,className:"admin-button",disabled:$,children:$?"\ub85c\ub529 \uc911...":"\uad6c\uc131\uc6d0 \ubaa9\ub85d \uc0c8\ub85c\uace0\uce68"})})]})]}),"salarySettings"===c&&(0,z.jsxs)("div",{className:"salary-settings-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsxs)("div",{className:"salary-settings section-card",children:[(0,z.jsx)("h3",{children:"\uae09\uc5ec \uc124\uc815"}),(0,z.jsx)("p",{className:"admin-section-desc",children:"\uc138\uc728\uacfc \uc8fc\uae09 \uc778\uc0c1\ub960\uc744 \uc124\uc815\ud569\ub2c8\ub2e4. \uc790\ub3d9 \uc8fc\uae09 \uc9c0\uae09\uc740 \ub9e4\uc8fc \uae08\uc694\uc77c \uc624\uc804 8\uc2dc\uc5d0 \uc2e4\ud589\ub429\ub2c8\ub2e4."}),(0,z.jsxs)("div",{className:"salary-settings-form",children:[(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\uc138\uc728 (%):"}),(0,z.jsx)("input",{type:"number",min:"0",max:"100",step:"0.1",value:at,onChange:e=>nt(e.target.value),className:"admin-input",placeholder:"\uc608: 10 (10%)"}),(0,z.jsx)("small",{className:"form-help",children:"\ud559\uc0dd\ub4e4\uc758 \uc8fc\uae09\uc5d0\uc11c \uacf5\uc81c\ub420 \uc138\uc728\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\uc8fc\uae09 \uc778\uc0c1\ub960 (%):"}),(0,z.jsx)("input",{type:"number",min:"0",max:"100",step:"0.1",value:it,onChange:e=>rt(e.target.value),className:"admin-input",placeholder:"\uc608: 3 (3%)"}),(0,z.jsx)("small",{className:"form-help",children:"\ub9e4\uc8fc \uc790\ub3d9\uc73c\ub85c \uc801\uc6a9\ub420 \uc8fc\uae09 \uc778\uc0c1\ub960\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."})]}),(0,z.jsx)("button",{onClick:ht,className:"admin-save-button",disabled:ot,children:ot?"\uc800\uc7a5 \uc911...":"\uae09\uc5ec \uc124\uc815 \uc800\uc7a5"})]}),(0,z.jsxs)("div",{className:"current-salary-settings",children:[(0,z.jsx)("h4",{children:"\ud604\uc7ac \uae09\uc5ec \uc124\uc815"}),(0,z.jsxs)("div",{className:"settings-display",children:[(0,z.jsxs)("p",{children:["\ud604\uc7ac \uc138\uc728: ",(0,z.jsxs)("strong",{children:[(100*tt.taxRate).toFixed(1),"%"]})]}),(0,z.jsxs)("p",{children:["\ud604\uc7ac \uc8fc\uae09 \uc778\uc0c1\ub960: ",(0,z.jsxs)("strong",{children:[(100*tt.salaryIncreaseRate).toFixed(1),"%"]})]}),(0,z.jsxs)("p",{children:["\ub9c8\uc9c0\ub9c9 \uc790\ub3d9 \uc9c0\uae09\uc77c: ",(0,z.jsx)("strong",{children:$t()})]})]}),(0,z.jsxs)("div",{className:"salary-calculation-example",children:[(0,z.jsx)("h5",{children:"\uc8fc\uae09 \uacc4\uc0b0 \uc608\uc2dc"}),(0,z.jsxs)("p",{children:["\u2022 \uc9c1\uc5c5 1\uac1c: \ucd1d 200\ub9cc\uc6d0 \u2192 \uc138\uae08 ",(2e6*tt.taxRate/1e4).toFixed(0),"\ub9cc\uc6d0 \uacf5\uc81c \u2192 \uc2e4\uae09\uc5ec ",(2e6*(1-tt.taxRate)/1e4).toFixed(0),"\ub9cc\uc6d0"]}),(0,z.jsxs)("p",{children:["\u2022 \uc9c1\uc5c5 2\uac1c: \ucd1d 250\ub9cc\uc6d0 \u2192 \uc138\uae08 ",(25e5*tt.taxRate/1e4).toFixed(0),"\ub9cc\uc6d0 \uacf5\uc81c \u2192 \uc2e4\uae09\uc5ec ",(25e5*(1-tt.taxRate)/1e4).toFixed(0),"\ub9cc\uc6d0"]}),(0,z.jsxs)("p",{children:["\u2022 \uc9c1\uc5c5 3\uac1c: \ucd1d 300\ub9cc\uc6d0 \u2192 \uc138\uae08 ",(3e6*tt.taxRate/1e4).toFixed(0),"\ub9cc\uc6d0 \uacf5\uc81c \u2192 \uc2e4\uae09\uc5ec ",(3e6*(1-tt.taxRate)/1e4).toFixed(0),"\ub9cc\uc6d0"]})]}),(0,z.jsxs)("div",{className:"auto-payment-info",children:[(0,z.jsx)("h5",{children:"\uc790\ub3d9 \uc8fc\uae09 \uc9c0\uae09 \uc2dc\uc2a4\ud15c"}),(0,z.jsx)("p",{children:"\ud83e\udd16 \ub9e4\uc8fc \uae08\uc694\uc77c \uc624\uc804 8\uc2dc\uc5d0 \uc11c\ubc84\uc5d0\uc11c \uc790\ub3d9\uc73c\ub85c \uc8fc\uae09\uc774 \uc9c0\uae09\ub429\ub2c8\ub2e4."}),(0,z.jsx)("p",{children:"\ud83d\udcc8 \ub9e4\uc8fc \uc8fc\uae09 \uc778\uc0c1\ub960\ub9cc\ud07c \uae09\uc5ec\uac00 \uc790\ub3d9\uc73c\ub85c \uc778\uc0c1\ub429\ub2c8\ub2e4."}),(0,z.jsx)("p",{children:"\ud83d\udcb0 \uc138\uae08\uc774 \uc790\ub3d9\uc73c\ub85c \uacf5\uc81c\ub418\uc5b4 \uc2e4\uae09\uc5ec\uac00 \uc9c0\uae09\ub429\ub2c8\ub2e4."}),(0,z.jsx)("p",{children:"\u2699\ufe0f \uad00\ub9ac\uc790\uac00 \ub85c\uadf8\uc778\ud558\uc9c0 \uc54a\uc544\ub3c4 \uc790\ub3d9\uc73c\ub85c \uc2e4\ud589\ub429\ub2c8\ub2e4."})]})]})]})]}),"databaseManagement"===c&&(0,z.jsxs)("div",{className:"database-management-tab",children:[!n&&l&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,z.jsx)("strong",{children:l})]})}),(0,z.jsx)("div",{className:"database-management-container section-card min-h-[500px] max-h-[70vh] overflow-auto",children:(0,z.jsx)(Qt.default,{})}),(0,z.jsxs)("div",{className:"section-card mt-6 p-6 rounded-2xl bg-violet-500/5 border border-violet-500/30",children:[(0,z.jsx)("h3",{className:"text-lg font-bold text-violet-300 mb-3",children:"\uac1c\uc778\uc815\ubcf4 \ubcf4\ud638 \ubb38\uc11c"}),(0,z.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"\ud559\ubd80\ubaa8 \ub3d9\uc758\uc11c \uc591\uc2dd\uacfc \uac1c\uc778\uc815\ubcf4\ucc98\ub9ac\ubc29\uce68\uc744 \ud655\uc778\ud558\uc138\uc694."}),(0,z.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,z.jsx)("a",{href:"/consent-form",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-violet-600 hover:bg-violet-500 text-white rounded-lg transition-colors text-sm font-medium",children:"\ud83d\udcc4 \uac00\uc815\ud1b5\uc2e0\ubb38 (\ub3d9\uc758\uc11c \uc591\uc2dd)"}),(0,z.jsx)("a",{href:"/privacy",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors text-sm font-medium",children:"\ud83d\udd12 \uac1c\uc778\uc815\ubcf4\ucc98\ub9ac\ubc29\uce68"})]})]}),(0,z.jsx)(Jt,{userClassCode:l,isAdmin:s,isSuperAdmin:n})]}),"systemManagement"===c&&(0,z.jsxs)("div",{className:"system-management-tab",children:[n&&(0,z.jsx)("div",{className:"class-info-header",children:(0,z.jsx)("p",{className:"current-class-info",children:"\ud83c\udf10 \uc2dc\uc2a4\ud15c \uc804\uccb4 \uad00\ub9ac (\ucd5c\uace0 \uad00\ub9ac\uc790)"})}),n&&(0,z.jsxs)("div",{className:"admin-class-codes-container section-card",children:[(0,z.jsx)("h3",{children:"\ud559\uae09 \ucf54\ub4dc \uad00\ub9ac"}),we&&(0,z.jsx)("p",{className:"error-message",children:we}),(0,z.jsxs)("div",{className:"add-class-code-form",children:[(0,z.jsx)("input",{type:"text",value:H,onChange:e=>V(e.target.value),placeholder:"\uc0c8 \ud559\uae09 \ucf54\ub4dc \uc785\ub825",disabled:K,className:"admin-input"}),(0,z.jsx)("button",{onClick:Yt,disabled:K||!H.trim(),className:"admin-button",children:K?"\ucd94\uac00 \uc911...":"\ucf54\ub4dc \ucd94\uac00"})]}),(0,z.jsxs)("div",{className:"class-codes-list",children:[(0,z.jsxs)("h4",{children:["\ub4f1\ub85d\ub41c \ud559\uae09 \ucf54\ub4dc \ubaa9\ub85d (",Array.isArray(U)?U.length:0,"\uac1c)"]}),Array.isArray(U)&&U.length>0?(0,z.jsx)("ul",{className:"codes-list",children:U.map(e=>(0,z.jsxs)("li",{className:"code-item",children:[(0,z.jsx)("span",{className:"code-text",children:e}),(0,z.jsx)("button",{onClick:()=>Zt(e),className:"remove-code-button",disabled:K,children:"\uc0ad\uc81c"})]},e))}):(0,z.jsx)("p",{className:"no-codes-message",children:"\ub4f1\ub85d\ub41c \ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]}),(0,z.jsx)(Ut,{isSuperAdmin:n})]}),(0,z.jsx)("div",{className:"admin-settings-footer",children:(0,z.jsx)("button",{onClick:()=>d(!1),className:"admin-close-button",children:"\ub2eb\uae30"})})]}),ae&&ie&&(0,z.jsx)("div",{className:"modal-overlay show",children:(0,z.jsxs)("div",{className:"edit-student-jobs-modal",children:[(0,z.jsxs)("div",{className:"modal-header",children:[(0,z.jsxs)("h3",{children:["\ud559\uc0dd \uc9c1\uc5c5 \uc124\uc815:"," ",ie.nickname||ie.name]}),(0,z.jsx)("button",{className:"close-modal-btn",onClick:()=>ne(!1),children:"\u2715"})]}),(0,z.jsxs)("div",{className:"modal-body",children:[(0,z.jsxs)("p",{children:[(0,z.jsx)("strong",{children:ie.nickname||ie.name}),"\ub2d8\uc758 \uc9c1\uc5c5\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."]}),(0,z.jsxs)("div",{className:"salary-info",children:[(0,z.jsxs)("p",{children:["\ud604\uc7ac \ubcf4\uc720 \ud604\uae08: ",(ie.cash||0).toLocaleString(),"\uc6d0"]}),(()=>{const e=gt(re,!0);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("p",{children:["\uc608\uc0c1 \ucd1d\uae09\uc5ec: ","".concat((e.gross/1e4).toFixed(0),"\ub9cc\uc6d0")]}),(0,z.jsxs)("p",{children:["\uc138\uae08 \uacf5\uc81c: ","".concat((e.tax/1e4).toFixed(0),"\ub9cc\uc6d0")," (",(100*tt.taxRate).toFixed(1),"%)"]}),(0,z.jsxs)("p",{children:["\uc2e4\uae09\uc5ec: ","".concat((e.net/1e4).toFixed(0),"\ub9cc\uc6d0")]})]})})(),(0,z.jsxs)("p",{className:"salary-explanation",children:["(\uae30\ubcf8 200\ub9cc\uc6d0 + \ucd94\uac00 \uc9c1\uc5c5\ub2f9 50\ub9cc\uc6d0, \uc138\uae08 ",(100*tt.taxRate).toFixed(1),"% \uacf5\uc81c)"]})]}),(0,z.jsx)("div",{className:"job-selection-list",children:Array.isArray(b)&&b.filter(e=>!1!==e.active).length>0?b.filter(e=>!1!==e.active).map(e=>(0,z.jsxs)("div",{className:"job-selection-item",children:[(0,z.jsx)("input",{type:"checkbox",id:"job-modal-".concat(e.id),checked:re.includes(e.id),onChange:()=>{return t=e.id,void oe(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}}),(0,z.jsx)("label",{htmlFor:"job-modal-".concat(e.id),children:e.title})]},e.id)):(0,z.jsx)("p",{className:"no-items-message",children:"\uc124\uc815 \uac00\ub2a5\ud55c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})})]}),(0,z.jsxs)("div",{className:"modal-footer",children:[(0,z.jsx)("button",{className:"admin-cancel-button",onClick:()=>ne(!1),children:"\ucde8\uc18c"}),(0,z.jsx)("button",{className:"admin-save-button",onClick:async()=>{if(ie&&J.db){pe(!0);try{const e=(0,J.EW)(J.db,"users",ie.id);await(0,J.tI)(e,{selectedJobIds:re,updatedAt:(0,J.O5)()}),ce(e=>e.map(e=>e.id===ie.id?(0,r.A)((0,r.A)({},e),{},{selectedJobIds:re}):e)),alert("\ud559\uc0dd \uc9c1\uc5c5\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),ne(!1)}catch(we){te.vF.error("\ud559\uc0dd \uc9c1\uc5c5 \uc5c5\ub370\uc774\ud2b8 \uc624\ub958:",we),alert("\ud559\uc0dd \uc9c1\uc5c5 \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message)}finally{pe(!1)}}else alert("\ud559\uc0dd \uc815\ubcf4 \ub610\ub294 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958")},disabled:xe,children:xe?"\uc800\uc7a5 \uc911...":"\uc800\uc7a5"})]})]})})]}):(0,z.jsx)("div",{className:"admin-settings-modal show",children:(0,z.jsxs)("div",{className:"admin-settings-content",children:[(0,z.jsx)("h2",{children:"\uad00\ub9ac\uc790 \uc124\uc815"}),(0,z.jsx)("p",{children:"\uad00\ub9ac\uc790\ub9cc \uc811\uadfc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),(0,z.jsx)("button",{onClick:()=>d(!1),className:"admin-cancel-button",children:"\ub2eb\uae30"})]})}):null};s(813);var Vt=s(6555),Kt=s(4805);(0,lt.Qg)(J.Cn,"manualResetClassTasks");const Xt={JOBS:216e5,TASKS:216e5,SETTINGS:432e5,GOALS:216e5,CLASS_CODES:864e5},Yt=e=>it.Ay.get(e),Zt=(e,t,s)=>it.Ay.set(e,t,s||Xt.TASKS),$t=e=>it.Ay.invalidate(e),es=()=>it.Ay.clearAll();const ts=new class{constructor(){this.pendingWrites=[],this.batchTimeout=null,this.BATCH_DELAY=2e3,this.MAX_BATCH_SIZE=500}addWrite(e){this.pendingWrites.push(e),this.pendingWrites.length>=this.MAX_BATCH_SIZE?this.executeBatch():this.scheduleBatch()}scheduleBatch(){this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.executeBatch()},this.BATCH_DELAY)}async executeBatch(){if(0===this.pendingWrites.length)return;this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null);const e=(0,ee.wP)(J.db),t=[...this.pendingWrites];this.pendingWrites=[];try{t.forEach(t=>{let{type:s,ref:a,data:n}=t;switch(s){case"set":e.set(a,n);break;case"update":e.update(a,n);break;case"delete":e.delete(a)}}),await e.commit(),te.vF.log("\ubc30\uce58 \uc2e4\ud589 \uc644\ub8cc: ".concat(t.length,"\uac1c \uc791\uc5c5"))}catch(s){te.vF.error("\ubc30\uce58 \uc2e4\ud589 \uc2e4\ud328:",s)}}};class ss{constructor(){this.listeners=new Map}addListener(e,t){this.listeners.has(e)&&this.listeners.get(e)(),this.listeners.set(e,t)}removeListener(e){this.listeners.has(e)&&(this.listeners.get(e)(),this.listeners.delete(e))}removeAllListeners(){this.listeners.forEach(e=>e()),this.listeners.clear()}}function as(e){let{availableJobs:t,currentSelectedJobIds:s=[],onConfirmSelection:n,onCancel:i}=e;const[l,r]=(0,a.useState)(Array.isArray(s)?[...s]:[]),o=(0,a.useMemo)(()=>Array.isArray(t)?t.filter(e=>!1!==e.active):[],[t]),d=(0,a.useCallback)(e=>{r(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]);return(0,z.jsxs)("div",{className:"bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg border border-cyan-900/30 p-6 max-w-xl mx-auto my-8",children:[(0,z.jsx)("h4",{className:"text-xl font-semibold text-white text-center mb-2",children:"\uc9c1\uc5c5 \uc120\ud0dd (\ub2e4\uc911 \uc120\ud0dd \uac00\ub2a5)"}),(0,z.jsx)("p",{className:"text-sm text-slate-400 text-center mb-4",children:"'\ub098\uc758 \ud560\uc77c'\uc5d0 \ud45c\uc2dc\ud560 \uc9c1\uc5c5\uc744 \uc120\ud0dd\ud558\uc138\uc694."}),(0,z.jsxs)("div",{className:"flex flex-col gap-3",children:[o.map(e=>(0,z.jsxs)("label",{className:"p-3 rounded-xl border-2 cursor-pointer transition-all flex items-center gap-3 ".concat(l.includes(e.id)?"border-cyan-500 bg-cyan-900/30":"border-cyan-900/20 bg-[#14142380] hover:border-cyan-500/50"),children:[(0,z.jsx)("input",{type:"checkbox",checked:l.includes(e.id),onChange:()=>d(e.id),className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500 cursor-pointer"}),(0,z.jsx)("span",{className:"font-medium ".concat(l.includes(e.id)?"text-cyan-400":"text-slate-300"),children:e.title})]},e.id)),0===o.length&&(0,z.jsx)(Vt.pp,{icon:F.A,title:"\uc120\ud0dd \uac00\ub2a5\ud55c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4",description:"\uad00\ub9ac\uc790\uac00 \uc9c1\uc5c5\uc744 \ub4f1\ub85d\ud558\uba74 \uc5ec\uae30\uc5d0 \ud45c\uc2dc\ub429\ub2c8\ub2e4."})]}),(0,z.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,z.jsx)(Vt.rA,{variant:"secondary",onClick:i,children:"\ucde8\uc18c"}),(0,z.jsx)(Vt.rA,{variant:"primary",onClick:()=>n(l),children:"\uc120\ud0dd \uc644\ub8cc"})]})]})}const ns=function(e){let{adminTabMode:t}=e;(0,n.Zp)();const{user:s,userDoc:l,setUserDoc:o,loading:d,updateUser:c,refreshUserDocument:m,isAdmin:u,isSuperAdmin:x,optimisticUpdate:p}=(0,i.As)(),h=(0,a.useRef)(new ss),g=(0,a.useRef)(0),b=(0,a.useRef)(null),[f,y]=(0,a.useState)(!0),[v,j]=(0,a.useState)("list"),[N,w]=(0,a.useState)(!1),[k,C]=(0,a.useState)("generalSettings"),[S,A]=(0,a.useState)([]),[I,E]=(0,a.useState)([]),[T,O]=(0,a.useState)(null),[_,R]=(0,a.useState)(""),[L,P]=(0,a.useState)(null),[W,B]=(0,a.useState)(null),[q,U]=(0,a.useState)(!1),[Q,G]=(0,a.useState)(!1),[H,V]=(0,a.useState)(""),[X,Y]=(0,a.useState)(""),[Z,$]=(0,a.useState)("5"),[se,ae]=(0,a.useState)(!1),[ne,ie]=(0,a.useState)(1e3),[le,re]=(0,a.useState)(1e3),[oe,de]=(0,a.useState)(String(1e3)),[ce,me]=(0,a.useState)(String(1e3)),[ue,xe]=(0,a.useState)([]);(0,a.useEffect)(()=>{t&&null!==u&&void 0!==u&&u()&&(C(t),w(!0))},[t,u]);const pe=(0,a.useMemo)(()=>null!==l&&void 0!==l&&l.classCode&&null!==u&&void 0!==u&&u()?"".concat(l.classCode,"_goal"):null,[null===l||void 0===l?void 0:l.classCode,u]),he=(0,a.useMemo)(()=>l&&Array.isArray(l.selectedJobIds)?l.selectedJobIds:[],[l]),ge=(0,a.useMemo)(()=>{const e=(null===l||void 0===l?void 0:l.completedJobTasks)||{};return Array.isArray(S)?S.filter(e=>he.includes(e.id)&&!1!==e.active).map(t=>(0,r.A)((0,r.A)({},t),{},{tasks:(t.tasks||[]).map(s=>(0,r.A)((0,r.A)({},s),{},{clicks:e["".concat(t.id,"_").concat(s.id)]||0}))})):[]},[S,he,l]),be=(0,a.useMemo)(()=>{if(!I||!l)return[];const e=l.completedTasks||{};return I.map(t=>(0,r.A)((0,r.A)({},t),{},{clicks:e[t.id]||0}))},[I,l]),fe=(0,a.useCallback)(()=>{try{return(0,ee.H9)((0,ee.rJ)(J.db,"temp")).id}catch(e){return te.vF.error("Error generating ID:",e),Date.now().toString()+Math.random().toString(36).substr(2,9)}},[]),ye=(0,a.useCallback)(async e=>{if(!e)return;const t=async()=>{try{const t=(0,ee.query)((0,ee.rJ)(J.db,"jobs"),(0,ee.where)("classCode","==",e),(0,ee.limit)(50)),s=(await(0,ee.getDocs)(t)).docs.map(e=>(0,r.A)((0,r.A)({id:e.id},e.data()),{},{tasks:(e.data().tasks||[]).map(e=>(0,r.A)((0,r.A)({},e),{},{reward:e.reward||0,clicks:0,maxClicks:e.maxClicks||5})),active:!1!==e.data().active})).sort((e,t)=>{var s,a,n,i;const l=(null===(s=e.updatedAt)||void 0===s||null===(a=s.toMillis)||void 0===a?void 0:a.call(s))||0;return((null===(n=t.updatedAt)||void 0===n||null===(i=n.toMillis)||void 0===i?void 0:i.call(n))||0)-l});A(s),Zt("jobs_".concat(e),s,Xt.JOBS);const a=(0,ee.query)((0,ee.rJ)(J.db,"commonTasks"),(0,ee.where)("classCode","==",e),(0,ee.limit)(50)),n=(await(0,ee.getDocs)(a)).docs.map(e=>(0,r.A)((0,r.A)({id:e.id},e.data()),{},{reward:e.data().reward||0,clicks:e.data().clicks||0,maxClicks:e.data().maxClicks||5})).sort((e,t)=>{var s,a,n,i;const l=(null===(s=e.updatedAt)||void 0===s||null===(a=s.toMillis)||void 0===a?void 0:a.call(s))||0;return((null===(n=t.updatedAt)||void 0===n||null===(i=n.toMillis)||void 0===i?void 0:i.call(n))||0)-l});E(n),Zt("commonTasks_".concat(e),n,Xt.TASKS)}catch(t){te.vF.error("Polling \uc5d0\ub7ec:",t)}};await t();const s=setInterval(t,72e5);h.current.addListener("polling",()=>clearInterval(s))},[]),ve=(0,a.useCallback)(async e=>{const t=Yt("jobs_".concat(e)),s=Yt("commonTasks_".concat(e)),a=Yt("mainSettings");return t&&A(t),s&&E(s),a&&(re(a.couponValue||1e3),de(String(a.couponValue||1e3))),{hasJobsCache:!!t,hasTasksCache:!!s,hasSettingsCache:!!a}},[]),je=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null===l||void 0===l||!l.classCode)return void y(!1);const t=Date.now(),s=l.classCode;if(b.current&&!e)return b.current;if(!e&&t-g.current<72e5)return void y(!1);y(!0);return b.current=(async()=>{try{const a=await ve(s);a.hasJobsCache&&a.hasTasksCache&&y(!1),h.current.listeners.has("jobs")||setTimeout(()=>ye(s),0);const n=[];if(a.hasSettingsCache&&!e||n.push((0,ee.x7)((0,ee.H9)(J.db,"settings","mainSettings")).then(e=>({type:"settings",data:e.exists()?e.data():null}))),!pe||Yt("goal_".concat(pe))&&!e||n.push((0,ee.x7)((0,ee.H9)(J.db,"goals",pe)).then(e=>({type:"goal",data:e.exists()?e.data():null}))),!x()||Yt("classCodes")&&!e||n.push((0,ee.x7)((0,ee.H9)(J.db,"settings","classCodes")).then(e=>({type:"classCodes",data:e.exists()?e.data():null}))),n.length>0){(await Promise.all(n)).forEach(e=>{switch(e.type){case"settings":if(e.data){const t=e.data.couponValue||1e3;re(t),de(String(t)),Zt("mainSettings",e.data,Xt.SETTINGS)}break;case"goal":if(e.data&&e.data.classCode===s){const t=e.data.targetAmount||1e3;ie(t),me(String(t)),Zt("goal_".concat(pe),e.data,Xt.GOALS)}break;case"classCodes":e.data&&(xe(e.data.validCodes||[]),Zt("classCodes",e.data,Xt.CLASS_CODES))}})}g.current=t}catch(a){}finally{y(!1),b.current=null}})(),b.current},[null===l||void 0===l?void 0:l.classCode,pe,x,ye,ve]),Ne=(0,a.useRef)(!1),we=(0,a.useCallback)(async()=>{if(Ne.current)te.vF.log("[Dashboard] \uc774\ubbf8 \uc0c8\ub85c\uace0\uce68 \uc9c4\ud589 \uc911 - \uc911\ubcf5 \uc2e4\ud589 \ubc29\uc9c0");else{Ne.current=!0,te.vF.log("[Dashboard] \uc11c\ubc84 \ub9ac\uc14b \uac10\uc9c0 - \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0c1\ud0dc \uc0c8\ub85c\uace0\uce68");try{m&&await m(),je&&await je(!0);const e=(new Date).toDateString();localStorage.setItem("lastTaskResetDate",e),te.vF.log("[Dashboard] \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0c1\ud0dc \uc0c8\ub85c\uace0\uce68 \uc644\ub8cc")}catch(e){te.vF.error("[Dashboard] \uc0c1\ud0dc \uc0c8\ub85c\uace0\uce68 \uc624\ub958:",e)}finally{Ne.current=!1}}},[m,je]);(0,a.useEffect)(()=>{if(d)return void y(!0);if(!s)return y(!1),A([]),E([]),void h.current.removeAllListeners();null!==l&&void 0!==l&&l.id&&null!==l&&void 0!==l&&l.classCode?je():y(!1);const e=h.current;return()=>{e.removeAllListeners()}},[d,s,null===l||void 0===l?void 0:l.id,null===l||void 0===l?void 0:l.classCode,je]);const ke=(0,a.useRef)(!1),Ce=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(null===l||void 0===l||!l.classCode||!we)return;const e=()=>{const e=(new Date).toDateString(),t=localStorage.getItem("lastTaskResetDate");Ce.current!==e&&(Ce.current=e,t!==e&&we())};ke.current||(ke.current=!0,e());const t=setInterval(()=>{e()},36e5);return()=>{t&&clearInterval(t)}},[null===l||void 0===l?void 0:l.classCode,we]);const Se=(0,a.useCallback)(async()=>{if(!J.db||null===l||void 0===l||!l.classCode)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c.");const e=_.trim();if(e){y(!0);try{if(T){const t=(0,ee.H9)(J.db,"jobs",T.id);ts.addWrite({type:"update",ref:t,data:{title:e,updatedAt:(0,ee.O5)()}}),alert("\uc9c1\uc5c5\uc774 \uc218\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),R(""),O(null),w(!1)}else{const t=fe(),s=(0,ee.H9)(J.db,"jobs",t);ts.addWrite({type:"set",ref:s,data:{title:e,active:!0,tasks:[],createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)(),classCode:l.classCode}}),alert("\uc9c1\uc5c5\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),R("")}$t("jobs_".concat(l.classCode))}catch(t){te.vF.error("handleSaveJob \uc624\ub958:",t),alert("\uc9c1\uc5c5 \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd")}finally{y(!1)}}else alert("\uc9c1\uc5c5 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},[_,T,fe,l]),Ae=(0,a.useCallback)(async e=>{if(J.db){if(window.confirm("\uc815\ub9d0\ub85c \uc774 \uc9c1\uc5c5\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uad00\ub828\ub41c \ud560\uc77c\ub3c4 \ubaa8\ub450 \uc0ad\uc81c\ub429\ub2c8\ub2e4.")){y(!0);try{var t;const a=(0,ee.H9)(J.db,"jobs",e);if(ts.addWrite({type:"delete",ref:a,data:null}),s&&null!==l&&void 0!==l&&null!==(t=l.selectedJobIds)&&void 0!==t&&t.includes(e)){const t=l.selectedJobIds.filter(t=>t!==e);await c({selectedJobIds:t})}(null===T||void 0===T?void 0:T.id)===e&&(R(""),O(null)),w(!1),alert("\uc9c1\uc5c5\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),$t("jobs_".concat(l.classCode))}catch(a){te.vF.error("handleDeleteJob \uc624\ub958:",a),alert("\uc9c1\uc5c5 \uc0ad\uc81c \uc911 \uc624\ub958 \ubc1c\uc0dd")}finally{y(!1)}}}else alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.")},[s,l,T,c]),Ie=(0,a.useCallback)(e=>{e?(O(e),R(e.title),C("jobSettings"),w(!0)):alert("\ud574\ub2f9 \uc9c1\uc5c5\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},[]),Ee=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;U(arguments.length>1&&void 0!==arguments[1]&&arguments[1]),B(e),V(""),Y(""),$("5"),P(null),C("taskManagement"),G(!0),w(!0)},[]),Te=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e?(P(e),V(e.name),Y(String(e.reward||0)),$(String(e.maxClicks||5)),U(!!t),B(t),C("taskManagement"),G(!0),w(!0)):alert("\uc218\uc815\ud560 \ud560\uc77c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},[]),De=(0,a.useCallback)(async()=>{if(!J.db||null===l||void 0===l||!l.classCode)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c.");const e=H.trim(),t=parseInt(X,10),s=parseInt(Z,10);if(!e||isNaN(t)||t<0||isNaN(s)||s<=0)return void alert("\uc785\ub825\uac12\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694. (\uc774\ub984, \ubcf4\uc0c1: 0 \uc774\uc0c1 \uc22b\uc790, \ucd5c\ub300 \ud074\ub9ad: 1 \uc774\uc0c1 \uc22b\uc790)");y(!0);const a={name:e,reward:t,maxClicks:s,clicks:(null===L||void 0===L?void 0:L.clicks)||0};try{if(L){const e=L.id;if(q&&W){const t=(0,ee.H9)(J.db,"jobs",W),s=await(0,ee.x7)(t);if(!s.exists()||s.data().classCode!==l.classCode)throw new Error("\uc9c1\uc5c5 \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uac70\ub098 \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");const n=s.data().tasks||[],i=n.findIndex(t=>t.id===e);if(-1===i)throw new Error("\uc9c1\uc5c5 \ub0b4 \ud560\uc77c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const o=[...n];o[i]=(0,r.A)((0,r.A)({},o[i]),a),ts.addWrite({type:"update",ref:t,data:{tasks:o,updatedAt:(0,ee.O5)()}})}else{const t=(0,ee.H9)(J.db,"commonTasks",e);ts.addWrite({type:"update",ref:t,data:(0,r.A)((0,r.A)({},a),{},{updatedAt:(0,ee.O5)()})})}G(!1),P(null),w(!1),alert("\ud560\uc77c\uc774 \uc218\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}else{const e=fe(),t=(0,r.A)((0,r.A)({},a),{},{id:e,clicks:0});if(q&&W){const e=(0,ee.H9)(J.db,"jobs",W);ts.addWrite({type:"update",ref:e,data:{tasks:(0,ee.hq)(t),updatedAt:(0,ee.O5)()}})}else{const s=(0,ee.H9)(J.db,"commonTasks",e);ts.addWrite({type:"set",ref:s,data:(0,r.A)((0,r.A)({},t),{},{createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)(),classCode:l.classCode})})}V(""),Y(""),$("5"),alert("\ud560\uc77c\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}$t(q?"jobs_".concat(l.classCode):"commonTasks_".concat(l.classCode))}catch(n){te.vF.error("handleSaveTask \uc624\ub958:",n),alert("\ud560\uc77c \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd: "+n.message)}finally{y(!1)}},[H,X,Z,L,q,W,fe,l]),Me=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(J.db){if(window.confirm("\uc815\ub9d0\ub85c \uc774 \ud560\uc77c\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){y(!0);try{if(t){const s=(0,ee.H9)(J.db,"jobs",t),a=await(0,ee.x7)(s);if(!a.exists())throw new Error("\uc9c1\uc5c5 \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const n=(a.data().tasks||[]).filter(t=>t.id!==e);ts.addWrite({type:"update",ref:s,data:{tasks:n,updatedAt:(0,ee.O5)()}})}else{const t=(0,ee.H9)(J.db,"commonTasks",e);ts.addWrite({type:"delete",ref:t,data:null})}(null===L||void 0===L?void 0:L.id)===e&&(G(!1),P(null)),w(!1),alert("\ud560\uc77c\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),$t(t?"jobs_".concat(l.classCode):"commonTasks_".concat(l.classCode))}catch(s){te.vF.error("handleDeleteTask \uc624\ub958:",s),alert("\ud560\uc77c \uc0ad\uc81c \uc911 \uc624\ub958 \ubc1c\uc0dd: "+s.message)}finally{y(!1)}}}else alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.")},[L,l]),Fe=(0,a.useCallback)(()=>{j("selectJob")},[]),Oe=(0,a.useCallback)(async e=>{if(null===s||void 0===s||!s.uid)return void alert("\uc0ac\uc6a9\uc790 \uc815\ubcf4 \uc624\ub958.");const t=Array.isArray(e)?e:[];y(!0);try{await c({selectedJobIds:t})?(o((0,r.A)((0,r.A)({},l),{},{selectedJobIds:t})),j("list"),alert("\uc120\ud0dd\ud55c \uc9c1\uc5c5\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")):alert("\uc120\ud0dd\ud55c \uc9c1\uc5c5 \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd.")}catch(a){te.vF.error("handleConfirmJobSelection \uc624\ub958:",a),alert("\uc120\ud0dd \uc9c1\uc5c5 \uc800\uc7a5 \uc911 \uc608\uc0c1\uce58 \ubabb\ud55c \uc624\ub958 \ubc1c\uc0dd.")}finally{y(!1)}},[s,c]),_e=(0,a.useCallback)(()=>{j("list")},[]),Re=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(se)return;if(null===l||void 0===l||!l.id)return void alert("\uc0ac\uc6a9\uc790 \uc815\ubcf4\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");if(s&&t){var i,d;const s="".concat(t,"_").concat(e),a=(l.completedJobTasks||{})[s]||0,n=null===(i=S.find(e=>e.id===t))||void 0===i||null===(d=i.tasks)||void 0===d?void 0:d.find(t=>t.id===e);if(n&&n.maxClicks>0&&a>=n.maxClicks)return void te.vF.warn("[Dashboard] \uc774\ubbf8 \uc644\ub8cc\ub41c \uc9c1\uc5c5 \ud560\uc77c:",{taskKey:s,currentClicks:a,maxClicks:n.maxClicks})}else if(!s){const t=(l.completedTasks||{})[e]||0,s=null===I||void 0===I?void 0:I.find(t=>t.id===e);if(s&&s.maxClicks>0&&t>=s.maxClicks)return void te.vF.warn("[Dashboard] \uc774\ubbf8 \uc644\ub8cc\ub41c \uacf5\ud1b5 \ud560\uc77c:",{taskId:e,currentClicks:t,maxClicks:s.maxClicks})}ae(!0),te.vF.log("[Dashboard] \ud560\uc77c \uc644\ub8cc \ucc98\ub9ac \uc2dc\uc791:",{taskId:e,jobId:t,isJobTask:s,cardType:a,rewardAmount:n});let c=0,m=0;a&&n&&("cash"===a?c=n:"coupon"===a&&(m=n));const u=(0,r.A)({},l),x=l.cash+c,p=l.coupons+m;o(s&&t?s=>(0,r.A)((0,r.A)({},s),{},{cash:x,coupons:p,completedJobTasks:(0,r.A)((0,r.A)({},s.completedJobTasks||{}),{},{["".concat(t,"_").concat(e)]:((s.completedJobTasks||{})["".concat(t,"_").concat(e)]||0)+1})}):t=>{var s;return(0,r.A)((0,r.A)({},t),{},{cash:x,coupons:p,completedTasks:(0,r.A)((0,r.A)({},t.completedTasks||{}),{},{[e]:((null===(s=t.completedTasks)||void 0===s?void 0:s[e])||0)+1})})});try{const i=(0,lt.Qg)(J.Cn,"completeTask"),l=(await i({taskId:e,jobId:t,isJobTask:s,cardType:a,rewardAmount:n})).data;if(te.vF.log("\u2705 [\ub514\ubc84\uadf8] \uc11c\ubc84\ub85c\ubd80\ud130 \ubc1b\uc740 \uacb0\uacfc:",l),!l.success)throw new Error(l.message||"\uc54c \uc218 \uc5c6\ub294 \uc11c\ubc84 \uc624\ub958");{const e="number"===typeof l.updatedCash?l.updatedCash:x,t="number"===typeof l.updatedCoupons?l.updatedCoupons:p;te.vF.log("\u2705 [\ub514\ubc84\uadf8] \ub099\uad00\uc801 \uc5c5\ub370\uc774\ud2b8: \ud604\uae08 ".concat(x,"\uc6d0, \ucfe0\ud3f0 ").concat(p,"\uac1c \u2192 \uc11c\ubc84 \ud655\uc815: \ud604\uae08 ").concat(e,"\uc6d0, \ucfe0\ud3f0 ").concat(t,"\uac1c")),o(s=>(0,r.A)((0,r.A)({},s),{},{cash:e,coupons:t})),alert(l.message)}}catch(h){te.vF.error("[Dashboard] \ud560\uc77c \uc644\ub8cc \ucc98\ub9ac \uc911 \uc2ec\uac01\ud55c \uc624\ub958:",h),alert("\ud560\uc77c \uc644\ub8cc\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4: ".concat(h.message)),o(u)}finally{ae(!1)}},[se,l,I,S,o]),ze=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generalSettings";me(String(ne)),de(String(le)),C(e),w(!0)},[ne,le]),Le=(0,a.useCallback)(async()=>{if(te.vF.log("--- [DEBUG] EXECUTING handleSaveAdminSettings with LATEST code ---"),!J.db)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.");const e=parseInt(ce,10),t=parseInt(oe,10);if(isNaN(e)||e<=0||isNaN(t)||t<=0)alert("\uc62c\ubc14\ub978 \ubaa9\ud45c \uae08\uc561\uacfc \ucfe0\ud3f0 \uac00\uce58\ub97c \uc785\ub825\ud558\uc138\uc694 (0\ubcf4\ub2e4 \ud070 \uc22b\uc790).");else{y(!0);try{const a=(0,ee.H9)(J.db,"settings","mainSettings"),n=await(0,ee.x7)(a);if(n.exists()&&n.data().couponValue===t||ts.addWrite({type:"set",ref:a,data:{couponValue:t,updatedAt:(0,ee.O5)()}}),pe&&null!==u&&void 0!==u&&u())try{const t=(0,ee.H9)(J.db,"goals",pe);await(0,ee.BN)(t,{targetAmount:e,classCode:l.classCode,updatedAt:(0,ee.O5)()},{merge:!0})}catch(s){te.vF.warn("\ubaa9\ud45c \uc124\uc815 \uad8c\ud55c\uc774 \uc5c6\uc5b4 \ubaa9\ud45c \uae08\uc561 \uc124\uc815\uc744 \uac74\ub108\ub700:",s.code)}re(t),pe&&null!==u&&void 0!==u&&u()&&ie(e),w(!1),alert("\uad00\ub9ac\uc790 \uc124\uc815\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),$t("mainSettings"),pe&&$t("goal_".concat(pe))}catch(a){te.vF.error("\uad00\ub9ac\uc790 \uc124\uc815 \uc800\uc7a5 \uc624\ub958:",a),alert("\uad00\ub9ac\uc790 \uc124\uc815 \uc800\uc7a5 \uc911 \uc624\ub958: "+a.message)}finally{y(!1)}}},[ce,oe,pe,l,u]),Pe=(0,a.useCallback)(async()=>{if(!J.db||null===u||void 0===u||!u())return;const e=Yt("classCodes");if(e)xe(e.validCodes||[]);else try{const e=(0,ee.H9)(J.db,"settings","classCodes"),t=await(0,ee.x7)(e);if(t.exists()){const e=Array.isArray(t.data().validCodes)?t.data().validCodes:[];xe(e),Zt("classCodes",t.data(),Xt.CLASS_CODES)}else ts.addWrite({type:"set",ref:e,data:{validCodes:[],createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)()}}),xe([])}catch(t){te.vF.error("\ud559\uae09 \ucf54\ub4dc \ub85c\ub4dc \uc624\ub958:",t),xe([])}},[u]);(0,a.useEffect)(()=>{null!==u&&void 0!==u&&u()&&Pe()},[u,Pe]);const We=(0,a.useCallback)(async e=>{if(!J.db)return!1;const t=e.trim();if(!t)return alert("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694."),!1;if(ue.includes(t))return alert("\uc774\ubbf8 \ub4f1\ub85d\ub41c \ud559\uae09 \ucf54\ub4dc\uc785\ub2c8\ub2e4."),!1;y(!0);try{const e=(0,ee.H9)(J.db,"settings","classCodes"),a=await(0,ee.x7)(e),n=a.exists()&&a.data().validCodes||[];ts.addWrite({type:"update",ref:e,data:{validCodes:[...n,t],updatedAt:(0,ee.O5)()}});try{const e=await(0,J.Sj)(t);e.success?alert("\ud559\uae09 \ucf54\ub4dc '".concat(t,"'\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4!\n\n\uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc644\ub8cc:\n- \uc9c1\uc5c5 ").concat(e.results.jobs.copied,"\uac1c\n- \uc0c1\uc810 \uc544\uc774\ud15c ").concat(e.results.storeItems.copied,"\uac1c")):alert("\ud559\uae09 \ucf54\ub4dc '".concat(t,"'\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\n\n\u26a0\ufe0f \uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc911 \uc624\ub958: ").concat(e.error,"\n(\ub098\uc911\uc5d0 \uc9c1\uc811 \ucd94\uac00\ud574\uc8fc\uc138\uc694)"))}catch(s){te.vF.error("\uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc624\ub958:",s),alert("\ud559\uae09 \ucf54\ub4dc '".concat(t,"'\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\n\n\u26a0\ufe0f \uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc2e4\ud328\n(\ub098\uc911\uc5d0 \uc9c1\uc811 \ucd94\uac00\ud574\uc8fc\uc138\uc694)"))}return xe(e=>[...e,t]),$t("classCodes"),!0}catch(a){return te.vF.error("\ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uc624\ub958:",a),alert("\ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uc911 \uc624\ub958 \ubc1c\uc0dd"),!1}finally{y(!1)}},[ue]),Be=(0,a.useCallback)(async e=>{if(!J.db)return!1;if(!window.confirm("'".concat(e,"' \ucf54\ub4dc\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))return!1;y(!0);try{const t=(0,ee.H9)(J.db,"settings","classCodes"),s=await(0,ee.x7)(t);if(!s.exists())throw new Error("\ud559\uae09 \ucf54\ub4dc \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const a=(s.data().validCodes||[]).filter(t=>t!==e);return ts.addWrite({type:"update",ref:t,data:{validCodes:a,updatedAt:(0,ee.O5)()}}),alert("\ud559\uae09 \ucf54\ub4dc\uac00 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),xe(t=>t.filter(t=>t!==e)),$t("classCodes"),!0}catch(t){return te.vF.error("\ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uc624\ub958:",t),alert("\ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uc911 \uc624\ub958 \ubc1c\uc0dd: "+t.message),!1}finally{y(!1)}},[]),qe=(0,a.useCallback)(()=>{es(),h.current.removeAllListeners(),null!==l&&void 0!==l&&l.classCode&&ye(l.classCode),je(!0)},[je,null===l||void 0===l?void 0:l.classCode,ye]),Ue=(0,a.useCallback)(async()=>{if(te.vF.log("[Dashboard] \uc218\ub3d9 \ud560\uc77c \ub9ac\uc14b \uc2dc\uc791"),null===l||void 0===l||!l.classCode)return te.vF.error("[Dashboard] \ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc5b4 \ub9ac\uc14b\uc744 \uc911\ub2e8\ud569\ub2c8\ub2e4."),void alert("\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");if(window.confirm("'".concat(l.classCode,"' \ud074\ub798\uc2a4\uc758 \ubaa8\ub4e0 \ud559\uc0dd\ub4e4\uc758 '\uc624\ub298\uc758 \ud560\uc77c' \uc644\ub8cc \uae30\ub85d\uc744 \ucd08\uae30\ud654\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\n\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))){te.vF.log("[Dashboard] ".concat(l.classCode," \ud074\ub798\uc2a4 \ub9ac\uc14b \uc2e4\ud589...")),y(!0);try{const e=(0,lt.Qg)(J.Cn,"manualResetClassTasks"),t=await e({classCode:l.classCode});if(te.vF.log("[Dashboard] \ud074\ub77c\uc6b0\ub4dc \ud568\uc218 \uacb0\uacfc \uc218\uc2e0:",t.data),!t.data.success)throw new Error(t.data.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958");{o(e=>(0,r.A)((0,r.A)({},e),{},{completedTasks:{},completedJobTasks:{}}));const e=(new Date).toDateString();localStorage.setItem("lastTaskResetDate",e),alert("\ub9ac\uc14b \uc131\uacf5!\n".concat(t.data.message)),te.vF.log("[Dashboard] \ub9ac\uc14b \uc131\uacf5: ".concat(t.data.message))}}catch(e){te.vF.error("[Dashboard] \ud560\uc77c \ub9ac\uc14b \uc2e4\ud328:",e),alert("\uc624\ub958: \ud560\uc77c \ub9ac\uc14b\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.\n\n".concat(e.message))}finally{y(!1),te.vF.log("[Dashboard] \uc218\ub3d9 \ud560\uc77c \ub9ac\uc14b \uc885\ub8cc")}}else te.vF.log("[Dashboard] \uc0ac\uc6a9\uc790\uac00 \ub9ac\uc14b\uc744 \ucde8\uc18c\ud588\uc2b5\ub2c8\ub2e4.")},[null===l||void 0===l?void 0:l.classCode,o]);if(d||f)return(0,z.jsx)(Vt.LN,{className:"flex items-center justify-center",children:(0,z.jsx)(Vt.Gu,{message:"\uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})});if(!s)return(0,z.jsx)(Vt.LN,{className:"flex items-center justify-center",children:(0,z.jsx)(Vt.pp,{icon:M.A,title:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4",description:"\ud560\uc77c\uc744 \ud655\uc778\ud558\ub824\uba74 \uba3c\uc800 \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})});if(null===l||void 0===l||!l.id)return(0,z.jsx)(Vt.LN,{className:"flex items-center justify-center",children:(0,z.jsx)(Vt.pp,{icon:M.A,title:"\uc0ac\uc6a9\uc790 \uc815\ubcf4 \ub85c\ub4dc \uc2e4\ud328",description:"\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \uc644\uc804\ud788 \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4. \uc0c8\ub85c\uace0\uce68\ud558\uac70\ub098 \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})});if(!l.classCode)return(0,z.jsx)(Vt.LN,{className:"flex items-center justify-center",children:(0,z.jsx)(Vt.pp,{icon:M.A,title:"\ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c",description:"\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc5ec \ud559\uae09 \ucf54\ub4dc\ub97c \ud560\ub2f9\ubc1b\uc73c\uc138\uc694."})});null===s||void 0===s||s.uid;const Qe=(null===l||void 0===l?void 0:l.name)||(null===l||void 0===l?void 0:l.nickname)||(null===s||void 0===s?void 0:s.displayName)||"\uc0ac\uc6a9\uc790";return(0,z.jsxs)("div",{className:"min-h-full w-full bg-[#0a0a12] px-2 pt-1 pb-0",children:[!t&&(0,z.jsxs)("section",{className:"bg-[#14142380] backdrop-blur-sm rounded-lg px-3 py-1.5 shadow-lg border border-cyan-900/30 flex flex-col md:flex-row md:items-center justify-between gap-1.5 mb-2",children:[(0,z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,z.jsx)("div",{className:"w-7 h-7 bg-cyan-900/30 rounded-md flex items-center justify-center text-cyan-400 shrink-0 border border-cyan-500/30",children:(0,z.jsx)(M.A,{className:"w-4 h-4"})}),(0,z.jsxs)("div",{className:"leading-tight",children:[(0,z.jsx)("h2",{className:"text-sm md:text-base font-bold text-white",children:"\uc624\ub298\uc758 \ud560\uc77c"}),(0,z.jsxs)("p",{className:"text-[11px] text-slate-400",children:[Qe,"\ub2d8, \uc624\ub298\ub3c4 \ud654\uc774\ud305!"]})]})]}),(null===u||void 0===u?void 0:u())&&"list"===v&&!N&&(0,z.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[(0,z.jsx)(Vt.rA,{variant:"primary",icon:D.A,onClick:()=>ze("generalSettings"),size:"sm",children:"\uad00\ub9ac\uc790 \uae30\ub2a5"}),(0,z.jsx)(Vt.rA,{variant:"success",icon:Ve.A,onClick:qe,size:"sm",children:"\uc0c8\ub85c\uace0\uce68"}),(0,z.jsx)(Vt.rA,{variant:"danger",icon:Kt.A,onClick:Ue,size:"sm",title:"\uc774 \ud074\ub798\uc2a4\uc758 \ubaa8\ub4e0 \uc0ac\uc6a9\uc790 \ud560\uc77c\uc744 \ub9ac\uc14b\ud569\ub2c8\ub2e4",children:"\ud560\uc77c \ub9ac\uc14b"})]}),"selectJob"===v&&(0,z.jsx)(Vt.rA,{variant:"ghost",icon:K.A,onClick:_e,children:"\ub4a4\ub85c\uac00\uae30"})]}),"list"===v&&!N&&!t&&(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)("div",{className:"bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg border border-cyan-900/30 overflow-hidden mb-6",children:[(0,z.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-4 md:px-6 py-3 md:py-4 flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,z.jsx)(F.A,{className:"w-5 h-5 text-white"}),(0,z.jsx)("h3",{className:"text-base md:text-lg font-bold text-white",children:"\ub098\uc758 \uc9c1\uc5c5 \ud560\uc77c"})]}),(0,z.jsx)(Vt.rA,{variant:"outline",icon:Ge.A,onClick:Fe,size:"sm",className:"!bg-white/20 !text-white !border-white/30 hover:!bg-white/30",children:"\uc9c1\uc5c5 \ucd94\uac00/\uc120\ud0dd"})]}),(0,z.jsxs)("div",{className:"p-4 md:p-6",children:[(0,z.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ge.length>0?ge.map(e=>(0,z.jsx)(At,{job:e,isAdmin:null===u||void 0===u?void 0:u(),onEditJob:()=>Ie(e),onDeleteJob:()=>Ae(e.id),onAddTask:()=>Ee(e.id,!0),onEarnCoupon:(e,t,s,a,n)=>Re(e,t,s,a,n),onEditTask:t=>Te(t,e.id),onDeleteTask:t=>Me(t,e.id),isHandlingTask:se},e.id)):(0,z.jsx)("div",{className:"col-span-full",children:(0,z.jsx)(Vt.pp,{icon:F.A,title:"\ud45c\uc2dc\ud560 \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4",description:"'\uc9c1\uc5c5 \ucd94\uac00/\uc120\ud0dd' \ubc84\ud2bc\uc744 \ub20c\ub7ec \uc9c1\uc5c5\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.",action:(0,z.jsx)(Vt.rA,{variant:"primary",icon:Ge.A,onClick:Fe,children:"\uc9c1\uc5c5 \uc120\ud0dd\ud558\uae30"})})})}),(0,z.jsxs)("div",{className:"mt-6 rounded-xl overflow-hidden border border-emerald-900/30 bg-[#14142380] backdrop-blur-sm",children:[(0,z.jsxs)("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 px-4 md:px-6 py-3 md:py-4 flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,z.jsx)(M.A,{className:"w-5 h-5 text-white"}),(0,z.jsx)("h3",{className:"text-base md:text-lg font-bold text-white",children:"\uacf5\ud1b5 \ud560\uc77c"})]}),(null===u||void 0===u?void 0:u())&&(0,z.jsx)(Vt.rA,{variant:"outline",icon:Ge.A,onClick:()=>Ee(null,!1),size:"sm",className:"!bg-white/20 !text-white !border-white/30 hover:!bg-white/30",children:"\uacf5\ud1b5 \ud560\uc77c \ucd94\uac00"})]}),(0,z.jsx)("div",{className:"p-4 md:p-6 bg-[#0a0a12]/50",children:(0,z.jsx)(It,{tasks:be,isAdmin:null===u||void 0===u?void 0:u(),onEarnCoupon:(e,t,s,a,n)=>Re(e,t,s,a,n),onEditTask:e=>Te(I.find(t=>t.id===e),null),onDeleteTask:e=>Me(e,null),isHandlingTask:se})})]})]})]})}),"selectJob"===v&&(0,z.jsx)(as,{availableJobs:S,currentSelectedJobIds:he,onConfirmSelection:Oe,onCancel:_e}),(null===u||void 0===u?void 0:u())&&(0,z.jsx)(Ht,{isAdmin:null===u||void 0===u?void 0:u(),isSuperAdmin:null===x||void 0===x?void 0:x(),userClassCode:null===l||void 0===l?void 0:l.classCode,showAdminSettingsModal:N,setShowAdminSettingsModal:w,adminSelectedMenu:k,setAdminSelectedMenu:C,classCodes:ue,onAddClassCode:We,onRemoveClassCode:Be,newGoalAmount:ce,setNewGoalAmount:me,adminCouponValue:oe,setAdminCouponValue:de,handleSaveAdminSettings:Le,jobs:S,adminNewJobTitle:_,setAdminNewJobTitle:R,adminEditingJob:T,setAdminEditingJob:O,handleSaveJob:Se,handleDeleteJob:Ae,handleEditJob:Ie,commonTasks:I,showAddTaskForm:Q,setShowAddTaskForm:G,adminNewTaskName:H,setAdminNewTaskName:V,adminNewTaskReward:X,setAdminNewTaskReward:Y,adminNewTaskMaxClicks:Z,setAdminNewTaskMaxClicks:$,adminEditingTask:L,setAdminEditingTask:P,handleSaveTask:De,handleEditTask:Te,handleDeleteTask:Me,taskFormJobId:W,taskFormIsJobTask:q,handleAddTaskClick:Ee})]})};var is=s(3986),ls=(s(6353),s(262)),rs=s(8164);const os=["id"],ds=e=>{let{stock:t}=e;if(void 0===t||null===t)return null;let s="";s=t<=0||t<=3?"stock-low":t<=5?"stock-medium":"stock-high";const a=t<=0?"\ud488\uc808":"\uc7ac\uace0(".concat(t,"\uac1c)");return(0,z.jsx)("span",{className:"stock-badge ".concat(s),children:a})},cs=()=>{const{user:e,userDoc:t,isAdmin:s}=(0,i.As)()||{user:null,userDoc:null,isAdmin:()=>!1},{items:n,purchaseItem:o,deleteItem:d,updateItem:c,addItem:m,setAdminPriceIncrease:u,adminPriceIncreasePercentage:x}=(0,l.wB)()||{items:[],purchaseItem:null,updateItem:null,deleteItem:null,addItem:null,setAdminPriceIncrease:null,adminPriceIncreasePercentage:10},[p,h]=(0,a.useState)([]),[g,b]=(0,a.useState)(null),[f,y]=(0,a.useState)(!1),[v,j]=(0,a.useState)(null),[N,w]=(0,a.useState)(!1),[k,C]=(0,a.useState)(null),[S,A]=(0,a.useState)(x||10),[I,E]=(0,a.useState)(!1),[T,D]=(0,a.useState)({}),M=s(),F=null===t||void 0===t?void 0:t.classCode;(0,a.useEffect)(()=>{if(n&&Array.isArray(n)){const e=n.map(e=>{var t,s;return(0,r.A)((0,r.A)({},e),{},{initialStock:null!==(t=null!==(s=e.initialStock)&&void 0!==s?s:e.stock)&&void 0!==t?t:10})}).filter(e=>!1!==(null===e||void 0===e?void 0:e.available));h(e);const t={};e.forEach(e=>{t[e.id]=1}),D(t)}else h([])},[n]),(0,a.useEffect)(()=>{A(x||10)},[x]),(0,a.useEffect)(()=>{const e=()=>E(window.innerWidth<=768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const O=(e,t)=>{b({type:e,message:t}),setTimeout(()=>b(null),3e3)},_=s=>{if(s.stock<=0)return"\ud488\uc808";const a=void 0!==(null===t||void 0===t?void 0:t.cash)?t.cash:null===e||void 0===e?void 0:e.cash,n=T[s.id]||1,i=s.price*n;return e&&void 0!==a&&a<i?"\uc794\uc561 \ubd80\uc871":"\uad6c\ub9e4\ud558\uae30"},R=M&&F;return(0,z.jsxs)("div",{className:"page-container ".concat(f&&R?"admin-mode":""),children:[(0,z.jsxs)("div",{className:"page-header-container",children:[(0,z.jsxs)("h2",{className:"page-title",children:[f&&R?"\uad00\ub9ac\uc790 \ud398\uc774\uc9c0":"\uc544\uc774\ud15c \uc0c1\uc810",F&&(0,z.jsxs)("span",{style:{fontSize:"0.7em",marginLeft:"10px",color:"#777"},children:["(\ud559\uae09: ",F,")"]})]}),M&&(0,z.jsx)("button",{onClick:()=>{F?(y(e=>!e),f&&j(null)):O("error","\uad00\ub9ac\uc790\uc758 \ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc5b4 \uad00\ub9ac\uc790 \ud328\ub110\uc744 \uc5f4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},className:"admin-icon-button",title:f?"\uc0c1\uc810 \ubcf4\uae30":"\uad00\ub9ac\uc790 \uae30\ub2a5",children:f&&R?"\ud83d\uded2":"\u2699\ufe0f"})]}),g&&(0,z.jsx)("div",{className:"notification ".concat("success"===g.type?"bg-green-100 text-green-800":"error"===g.type?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:g.message}),N&&R&&(0,z.jsx)("div",{className:"delete-confirm-modal",children:(0,z.jsxs)("div",{className:"delete-confirm-content",children:[(0,z.jsx)("h3",{children:"\uc544\uc774\ud15c \uc0ad\uc81c \ud655\uc778"}),(0,z.jsxs)("p",{children:[(0,z.jsx)("strong",{children:null===k||void 0===k?void 0:k.name})," \uc544\uc774\ud15c\uc744 \uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? ",(0,z.jsx)("br",{}),"\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."]}),(0,z.jsxs)("div",{className:"delete-confirm-buttons",children:[(0,z.jsx)("button",{onClick:async()=>{if(d&&k&&F)try{await d(k.id),O("success","".concat(k.name," \uc0ad\uc81c \uc644\ub8cc"))}catch(e){te.vF.error("\uc544\uc774\ud15c \uc0ad\uc81c \uc911 \uc624\ub958:",e),O("error","\uc544\uc774\ud15c \uc0ad\uc81c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{w(!1),C(null)}else O("error","\uc0ad\uc81c \uae30\ub2a5 \uc624\ub958 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c")},className:"delete-confirm-button",children:"\uc0ad\uc81c"}),(0,z.jsx)("button",{onClick:()=>{w(!1),C(null)},className:"delete-cancel-button",children:"\ucde8\uc18c"})]})]})}),f&&R?(0,z.jsx)("div",{className:"admin-panel-full-container",children:(0,z.jsx)(rs.default,{classCode:F,editingItemFromStore:v,onAddItem:async e=>{if(!m||!F)return O("error","\uc544\uc774\ud15c \ucd94\uac00 \uae30\ub2a5 \uc0ac\uc6a9 \ubd88\uac00 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c"),!1;try{const t=await m(e);return t.success?(O("success","".concat(e.name," \ucd94\uac00 \uc644\ub8cc")),!0):(O("error",t.message||"\uc544\uc774\ud15c \ucd94\uac00 \uc2e4\ud328"),!1)}catch(t){return te.vF.error("\uc544\uc774\ud15c \ucd94\uac00 \uc911 \uc624\ub958:",t),O("error","\uc544\uc774\ud15c \ucd94\uac00 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),!1}},onUpdateItem:async e=>{if(!c||!F)return O("error","\uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 \uae30\ub2a5 \uc0ac\uc6a9 \ubd88\uac00 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c"),!1;try{const{id:t}=e,s=(0,is.A)(e,os);if(!t)return O("error","\uc5c5\ub370\uc774\ud2b8\ud560 \uc544\uc774\ud15c\uc758 ID\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),!1;const a=await c(t,s);return a.success?(O("success","".concat(e.name," \uc5c5\ub370\uc774\ud2b8 \uc644\ub8cc")),!0):(O("error",a.message||"\uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328"),!1)}catch(t){return te.vF.error("\uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958:",t),O("error","\uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),!1}},onClose:()=>{y(!1),j(null)}})}):(0,z.jsxs)(z.Fragment,{children:[!e&&(0,z.jsx)(ls.A,{}),e&&(F?p.length>0?(0,z.jsx)("div",{className:"shop-content",children:(0,z.jsxs)("div",{className:"content-card-section",children:[(0,z.jsx)("h3",{className:"section-title",children:"\ud310\ub9e4 \uc544\uc774\ud15c"}),(0,z.jsx)("div",{className:"items-grid",children:p.map(s=>{var a;return(0,z.jsx)("div",{className:"store-item-card shop-item-card compact-card",children:(0,z.jsxs)("div",{className:"item-content",children:[(0,z.jsxs)("div",{className:"item-header-compact",children:[(0,z.jsx)("h3",{className:"item-name-compact",children:s.name}),(0,z.jsx)(ds,{stock:s.stock})]}),s.description&&s.description.trim()&&(0,z.jsx)("p",{className:"item-description-compact",children:s.description}),(0,z.jsxs)("div",{className:"item-actions-primary ".concat(I?"flex-col":""),children:[(0,z.jsxs)("span",{className:"item-price",children:[(null===(a=s.price)||void 0===a?void 0:a.toLocaleString())||0," \uc6d0"]}),(0,z.jsxs)("div",{className:"quantity-and-buy-container",children:[(0,z.jsx)("input",{type:"number",min:"1",max:s.stock,value:T[s.id]||1,onChange:e=>((e,t)=>{const s=p.find(t=>t.id===e);if(!s)return;let a=parseInt(t,10);(isNaN(a)||a<1)&&(a=1),a>s.stock&&(a=s.stock),D(t=>(0,r.A)((0,r.A)({},t),{},{[e]:a}))})(s.id,e.target.value),className:"quantity-input",disabled:s.stock<=0}),(0,z.jsx)("button",{onClick:()=>(async s=>{if(!s||s.stock<=0)return O("error","\uc7ac\uace0 \uc5c6\uc74c");if(!e||!F)return O("error","\ub85c\uadf8\uc778 \ub610\ub294 \ud559\uae09 \uc815\ubcf4 \ud544\uc694");const a=T[s.id]||1,n=void 0!==(null===t||void 0===t?void 0:t.cash)?t.cash:null===e||void 0===e?void 0:e.cash;if(void 0===n)return O("error","\uc794\uc561 \uc815\ubcf4 \uc624\ub958");if(n<s.price*a)return O("error","\uc794\uc561 \ubd80\uc871");if(!o)return O("error","\uad6c\ub9e4 \uae30\ub2a5 \uc624\ub958");try{const e=await o(s.id,a);e.success?O("success","".concat(s.name," ").concat(a,"\uac1c \uad6c\ub9e4 \uc644\ub8cc!")):O("error",e.message||"\uad6c\ub9e4\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc138\uc694.")}catch(i){te.vF.error("\uad6c\ub9e4 \ucc98\ub9ac \uc911 \uc624\ub958:",i),O("error",i.message||"\uad6c\ub9e4 \uc911 \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}})(s),className:"buy-item-button ".concat(I?"w-full":""),disabled:!e||s.stock<=0||(void 0!==(null===t||void 0===t?void 0:t.cash)?t.cash:null===e||void 0===e?void 0:e.cash)<s.price*(T[s.id]||1),children:_(s)})]})]}),M&&F&&(0,z.jsxs)("div",{className:"item-actions-admin",children:[(0,z.jsxs)("button",{onClick:()=>(e=>{j((0,r.A)({},e)),y(!0)})(s),className:"edit-item-button",title:"\uc544\uc774\ud15c \uc218\uc815",children:["\uc218\uc815",(0,z.jsx)("span",{className:"admin-button-icon",children:"\u270f\ufe0f"})]}),(0,z.jsxs)("button",{onClick:()=>(e=>{C(e),w(!0)})(s),className:"delete-item-button",title:"\uc544\uc774\ud15c \uc0ad\uc81c",children:["\uc0ad\uc81c",(0,z.jsx)("span",{className:"admin-button-icon",children:"\ud83d\uddd1\ufe0f"})]})]})]})},s.id)})})]})}):(0,z.jsxs)("div",{className:"empty-message",style:{padding:"20px",textAlign:"center"},children:[(0,z.jsx)("p",{children:"\ud310\ub9e4 \uc911\uc778 \uc544\uc774\ud15c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),M&&F&&(0,z.jsx)("p",{children:"\uad00\ub9ac\uc790 \uae30\ub2a5\uc744 \ud1b5\ud574 \uc544\uc774\ud15c\uc744 \ucd94\uac00\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})]}):(0,z.jsx)("div",{className:"empty-message",style:{padding:"20px",textAlign:"center",color:"red"},children:"\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc5b4 \uc0c1\uc810 \uae30\ub2a5\uc744 \uc774\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}))]})]})};s(5173);const ms=3e5,us=function(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:ms)-(Date.now()-e);if(t<=0)return"\ub9cc\ub8cc\ub428";const s=Math.floor(t/36e5),a=Math.floor(t%36e5/6e4),n=Math.floor(t%6e4/1e3);let i="";return s>0&&(i+="".concat(s,"\uc2dc\uac04 ")),(a>0||s>0)&&(i+="".concat(a,"\ubd84 ")),i+="".concat(n,"\ucd08 \ub0a8\uc74c"),i.trim()},xs=e=>{let{quantity:t}=e,s="";return s=t>10?"quantity-high":t>5?"quantity-medium":"quantity-low",(0,z.jsxs)("span",{className:"quantity-badge ".concat(s),children:["\xd7",t]})},ps=()=>{const{user:e,userDoc:t,users:s,classmates:o}=(0,i.As)()||{},{userItems:d,useItem:c,listItemForSale:m,refreshData:u,updateLocalUserItems:x}=(0,l.wB)()||{userItems:[],useItem:null,listItemForSale:null,refreshData:null,updateLocalUserItems:null},p=(0,n.Zp)(),[h,g]=(0,a.useState)(null),b=(e,t)=>{g({type:e,message:t}),setTimeout(()=>g(null),3e3)},f=(0,a.useMemo)(()=>{if(!d||0===d.length)return[];const e=new Map;return d.forEach(t=>{if(!t||!t.itemId||"number"!==typeof t.quantity||t.quantity<=0)return;const s=t.itemId;if(e.has(s)){const a=e.get(s);a.totalQuantity+=t.quantity,a.sourceDocs.push(t),t.name&&!a.displayInfo.name&&(a.displayInfo.name=t.name),t.icon&&!a.displayInfo.icon&&(a.displayInfo.icon=t.icon),t.description&&!a.displayInfo.description&&(a.displayInfo.description=t.description)}else e.set(s,{displayInfo:{itemId:t.itemId,name:t.name||"\uc54c \uc218 \uc5c6\ub294 \uc544\uc774\ud15c",icon:t.icon||"\ud83d\udd2e",description:t.description||"",type:t.type||"general",price:t.price||0,durationMs:t.durationMs||ms},totalQuantity:t.quantity,sourceDocs:[t]})}),Array.from(e.values()).sort((e,t)=>e.displayInfo.name.localeCompare(t.displayInfo.name))},[d]),[y,v]=(0,a.useState)(()=>{try{const t=localStorage.getItem("recentlyUsedItems_".concat((null===e||void 0===e?void 0:e.uid)||"guest"));return t?JSON.parse(t):{}}catch(t){return{}}});(0,a.useEffect)(()=>{null!==e&&void 0!==e&&e.uid&&localStorage.setItem("recentlyUsedItems_".concat(e.uid),JSON.stringify(y))},[y,null===e||void 0===e?void 0:e.uid]),(0,a.useEffect)(()=>{const e=setInterval(()=>{v(e=>{let t=!1;const s=(0,r.A)({},e),a=Date.now();return Object.keys(s).forEach(e=>{var n;const i=s[e],l=(null===(n=i.itemDetails)||void 0===n?void 0:n.durationMs)||ms;a-i.usedTimestamp>l&&(delete s[e],t=!0)}),t?s:e})},1e3);return()=>clearInterval(e)},[]);const[j,N]=(0,a.useState)({isOpen:!1,item:null,quantity:1}),[w,k]=(0,a.useState)({isOpen:!1,item:null}),[C,S]=(0,a.useState)(""),[A,I]=(0,a.useState)(1),[E,T]=(0,a.useState)(!1),[D,M]=(0,a.useState)(!1),[F,O]=(0,a.useState)({isOpen:!1,item:null,quantity:1,price:0}),_=()=>{N({isOpen:!1,item:null,quantity:1})},R=()=>{k({isOpen:!1,item:null})},L=()=>{O({isOpen:!1,item:null,quantity:1,price:0})},P=w.isOpen?w.item:null;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"page-container relative",children:[(0,z.jsx)("h2",{className:"page-title",children:"\ub0b4 \uc544\uc774\ud15c \uad00\ub9ac"}),!e&&(0,z.jsx)(ls.A,{}),h&&(0,z.jsx)("div",{className:"notification bg-".concat(h.type,"-100"),children:h.message}),e&&(0,z.jsxs)(z.Fragment,{children:[Object.keys(y).length>0&&(0,z.jsxs)("div",{className:"content-card-section",children:[(0,z.jsx)("h3",{className:"section-title",children:"\uc0ac\uc6a9 \uc911\uc778 \uc544\uc774\ud15c"}),(0,z.jsx)("div",{className:"items-grid",children:Object.entries(y).map(e=>{let[t,s]=e;return(0,z.jsx)("div",{className:"store-item-card active-item-card",children:(0,z.jsxs)("div",{className:"item-content",children:[(0,z.jsxs)("div",{className:"my-item-header",children:[(0,z.jsx)("div",{className:"item-icon-group",children:(0,z.jsx)("div",{className:"item-icon",children:s.itemDetails.icon||"\u2728"})}),(0,z.jsxs)("div",{className:"item-info",children:[(0,z.jsx)("h3",{className:"item-name",children:s.itemDetails.name}),(0,z.jsx)("p",{className:"timer-text",children:us(s.usedTimestamp,s.itemDetails.durationMs)})]})]}),(0,z.jsx)("div",{className:"my-item-actions",children:(0,z.jsx)("button",{className:"stop-using-button",onClick:()=>(e=>{v(t=>{const s=(0,r.A)({},t);return delete s[e],s}),b("info","\uc544\uc774\ud15c \uc0ac\uc6a9\uc744 \uc911\uc9c0\ud588\uc2b5\ub2c8\ub2e4.")})(t),children:"\uc0ac\uc6a9 \uc911\uc9c0"})})]})},t)})})]}),(0,z.jsxs)("div",{className:"content-card-section",children:[(0,z.jsx)("h3",{className:"section-title",children:"\ubcf4\uc720 \uc544\uc774\ud15c"}),f.length>0?(0,z.jsx)("div",{className:"items-grid",children:f.map(t=>(0,z.jsx)("div",{className:"store-item-card compact-myitem-card",children:(0,z.jsxs)("div",{className:"item-content",children:[(0,z.jsxs)("div",{className:"my-item-header-compact",children:[(0,z.jsx)("h3",{className:"my-item-name-compact",children:t.displayInfo.name}),(0,z.jsx)(xs,{quantity:t.totalQuantity})]}),t.displayInfo.description&&t.displayInfo.description.trim()&&(0,z.jsx)("p",{className:"my-item-description-compact",children:t.displayInfo.description}),(0,z.jsxs)("div",{className:"my-item-actions",children:[(0,z.jsx)("button",{className:"use-item-button",onClick:()=>{(t=>{e?!t||t.totalQuantity<=0?b("error","\uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \uc544\uc774\ud15c\uc774 \uc544\ub2d9\ub2c8\ub2e4."):N({isOpen:!0,item:t,quantity:1}):b("error","\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.")})(t)},disabled:D,children:"\uc0ac\uc6a9\ud558\uae30"}),(0,z.jsx)("button",{className:"gift-item-button",onClick:()=>{(t=>{e?o&&0!==o.length?!t||t.totalQuantity<=0?b("error","\uc120\ubb3c\ud560 \uc544\uc774\ud15c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."):(S(""),I(1),k({isOpen:!0,item:t})):b("error","\uc120\ubb3c\ud560 \uce5c\uad6c \ubaa9\ub85d\uc744 \ubd88\ub7ec\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."):b("error","\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.")})(t)},disabled:!o||0===o.length||D,children:D?"\ub3d9\uae30\ud654 \uc911":"\uc120\ubb3c\ud558\uae30"}),(0,z.jsx)("button",{className:"sell-to-market-button",onClick:()=>{(t=>{if(!e)return void b("error","\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.");if(!t||t.totalQuantity<=0)return void b("error","\ud310\ub9e4\ud560 \uc544\uc774\ud15c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!m)return void b("error","\ud310\ub9e4 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const s=t.displayInfo.price?Math.max(1,Math.round(.8*t.displayInfo.price)):100;O({isOpen:!0,item:t,quantity:1,price:s})})(t)},disabled:D,children:"\uc2dc\uc7a5\uc5d0 \ud314\uae30"})]})]})},t.displayInfo.itemId))}):(0,z.jsx)("div",{className:"empty-message",children:(0,z.jsx)("p",{children:"\ubcf4\uc720 \uc911\uc778 \uc544\uc774\ud15c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})})]})]})]}),j.isOpen&&j.item&&(0,z.jsx)("div",{className:"myitems-modal-overlay",onClick:e=>{e.target===e.currentTarget&&_()},children:(0,z.jsxs)("div",{className:"myitems-modal-container",children:[(0,z.jsxs)("div",{className:"myitems-modal-header",children:[(0,z.jsxs)("h3",{children:[j.item.displayInfo.name," \uc0ac\uc6a9\ud558\uae30"]}),(0,z.jsx)("button",{onClick:_,className:"myitems-close-button",children:"\u2715"})]}),(0,z.jsx)("div",{className:"myitems-modal-body",children:(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsxs)("label",{htmlFor:"useQuantity",children:["\uc0ac\uc6a9\ud560 \uc218\ub7c9: (\ucd5c\ub300 ",j.item.totalQuantity,"\uac1c)"]}),(0,z.jsxs)("div",{className:"quantity-controls",children:[(0,z.jsx)("button",{onClick:()=>N(e=>(0,r.A)((0,r.A)({},e),{},{quantity:Math.max(1,e.quantity-1)})),disabled:j.quantity<=1,children:"-"}),(0,z.jsx)("input",{id:"useQuantity",type:"number",min:"1",max:j.item.totalQuantity,value:j.quantity,onChange:e=>N(t=>(0,r.A)((0,r.A)({},t),{},{quantity:Math.max(1,Math.min(t.item.totalQuantity,parseInt(e.target.value)||1))}))}),(0,z.jsx)("button",{onClick:()=>N(e=>(0,r.A)((0,r.A)({},e),{},{quantity:Math.min(e.item.totalQuantity,e.quantity+1)})),disabled:j.quantity>=j.item.totalQuantity,children:"+"})]})]})}),(0,z.jsxs)("div",{className:"myitems-modal-footer",children:[(0,z.jsx)("button",{onClick:_,className:"button-secondary",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{const{item:e,quantity:t}=j;if(!e||!t||t<=0)b("error","\uc0ac\uc6a9\ud560 \uc544\uc774\ud15c \uc815\ubcf4\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");else if(e.totalQuantity<t)b("error","\ubcf4\uc720 \uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");else try{let s=t;const a=[],n=[...e.sourceDocs].sort((e,t)=>e.quantity-t.quantity);for(const e of n){if(s<=0)break;const t=Math.min(e.quantity,s),n=await c(e.id,t);if(a.push(n),!n.success)throw new Error(n.message||"\uc544\uc774\ud15c \uc0ac\uc6a9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4 (".concat(e.id,")"));s-=t}if(s>0)throw new Error("\uc694\uccad\ud55c \uc218\ub7c9\uc744 \ubaa8\ub450 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. (\ubd80\uc871\ud55c \uc218\ub7c9: ".concat(s,")"));b("success","".concat(e.displayInfo.name," ").concat(t,"\uac1c\ub97c \uc0ac\uc6a9\ud588\uc2b5\ub2c8\ub2e4.")),_(),v(t=>(0,r.A)((0,r.A)({},t),{},{[e.displayInfo.itemId]:{usedTimestamp:Date.now(),itemDetails:{name:e.displayInfo.name,icon:e.displayInfo.icon,durationMs:e.displayInfo.durationMs||ms}}}))}catch(s){b("error","\uc544\uc774\ud15c \uc0ac\uc6a9 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(s.message))}},className:"button-primary",children:"\uc0ac\uc6a9\ud558\uae30"})]})]})}),w.isOpen&&P&&(0,z.jsx)("div",{className:"myitems-modal-overlay",onClick:e=>{e.target===e.currentTarget&&R()},children:(0,z.jsxs)("div",{className:"myitems-modal-container",children:[(0,z.jsxs)("div",{className:"myitems-modal-header",children:[(0,z.jsxs)("h3",{children:[P.displayInfo.name||"\uc544\uc774\ud15c"," \uc120\ubb3c\ud558\uae30"]}),(0,z.jsx)("button",{onClick:R,className:"myitems-close-button",children:"\u2715"})]}),(0,z.jsxs)("div",{className:"myitems-modal-body",children:[(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{htmlFor:"giftRecipient",children:"\uc120\ubb3c \ubc1b\uc744 \uce5c\uad6c:"}),(0,z.jsxs)("select",{id:"giftRecipient",value:C,onChange:e=>S(e.target.value),className:"form-select",children:[(0,z.jsx)("option",{value:"",disabled:!0,children:"-- \uce5c\uad6c\ub97c \uc120\ud0dd\ud558\uc138\uc694 --"}),o.map(e=>(0,z.jsxs)("option",{value:e.uid||e.id,children:[e.name," (",e.nickname,")"]},e.uid||e.id))]})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsxs)("label",{htmlFor:"giftQuantity",children:["\uc120\ubb3c\ud560 \uc218\ub7c9: (\ucd5c\ub300 ",P.totalQuantity,"\uac1c)"]}),(0,z.jsxs)("div",{className:"quantity-controls",children:[(0,z.jsx)("button",{onClick:()=>I(e=>Math.max(1,e-1)),disabled:A<=1,children:"-"}),(0,z.jsx)("input",{id:"giftQuantity",type:"number",min:"1",max:P.totalQuantity,value:A,onChange:e=>I(Math.max(1,Math.min(P.totalQuantity,parseInt(e.target.value)||1)))}),(0,z.jsx)("button",{onClick:()=>I(e=>Math.min(P.totalQuantity,e+1)),disabled:A>=P.totalQuantity,children:"+"})]})]})]}),(0,z.jsxs)("div",{className:"myitems-modal-footer",children:[(0,z.jsx)("button",{onClick:R,className:"button-secondary",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{if(E)return;const{item:s}=w;if(!e||!C||!s)return te.vF.error("[MyItems] \uc120\ubb3c \uc815\ubcf4 \uc624\ub958:",{user:!!e,giftRecipientUid:C,group:!!s}),void b("error","\uc120\ubb3c \uc815\ubcf4\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");const a=Number(A)||1;if(a<=0||a>s.totalQuantity)return te.vF.error("[MyItems] \uc120\ubb3c \uc218\ub7c9 \uc624\ub958:",{quantity:a,totalQuantity:s.totalQuantity}),void b("error","\uc120\ubb3c \uc218\ub7c9\uc774 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");const n=o.find(e=>(e.uid||e.id)===C),i=n?n.name:"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790";let l;te.vF.log("[MyItems] \uc120\ubb3c \uc2dc\uc791:",{"\uc544\uc774\ud15c":s.displayInfo.name,"\uc218\ub7c9":a,"\ubcf4\ub0b4\ub294\uc0ac\ub78c":(null===t||void 0===t?void 0:t.name)||e.uid,"\ubc1b\ub294\uc0ac\ub78c":i,"\ubc1b\ub294\uc0ac\ub78cUID":C}),T(!0);try{const t=(0,J.rJ)(J.db,"users",e.uid,"inventory"),n=await(0,J.GG)(t),o=n.docs.map(e=>({id:e.id,itemId:e.data().itemId,name:e.data().name,quantity:e.data().quantity}));te.vF.log("[MyItems] \ud83d\udd0d \uc2e4\uc81c inventory \uceec\ub809\uc158 \uc804\uccb4 \uc870\ud68c:"),te.vF.log("\ucd1d\ubb38\uc11c\uc218:",n.size),te.vF.log("\ubb38\uc11c\ub4e4:",o);const c={};o.forEach(e=>{const t=e.itemId||e.id;c[t]||(c[t]=[]),c[t].push(e.id)}),te.vF.log("[MyItems] itemId\ubcc4 \uadf8\ub8f9:",c);const m=s.sourceDocs.map(e=>e.id);te.vF.log("[MyItems] \uce90\uc2dc\ub41c \ubb38\uc11c ID \ubaa9\ub85d:",m);const p=[];let h=0;for(const s of m){const t=(0,J.EW)(J.db,"users",e.uid,"inventory",s),a=await(0,J.x7)(t);if(a.exists()){const e=a.data();p.push((0,r.A)({id:a.id},e)),h+=e.quantity||0,te.vF.log("[MyItems] \u2705 \ubb38\uc11c \ubc1c\uacac:",{id:a.id,quantity:e.quantity})}else te.vF.warn("[MyItems] \u26a0\ufe0f \ubb38\uc11c \uc5c6\uc74c:",s)}if(te.vF.log("[MyItems] \ubcf4\ub0b4\ub294 \uc0ac\ub78c \uc778\ubca4\ud1a0\ub9ac \uc2e4\uc81c \uc870\ud68c \uc644\ub8cc:",{"\uce90\uc2dc\ubb38\uc11c\uc218":s.sourceDocs.length,"\uc2e4\uc81c\ubb38\uc11c\uc218":p.length,"\uc2e4\uc81c\ucd1d\uc218\ub7c9":h}),0===p.length)throw new Error("\ubcf4\uc720 \uc911\uc778 \uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ud398\uc774\uc9c0\ub97c \uc0c8\ub85c\uace0\uce68\ud574\uc8fc\uc138\uc694.");if(h<a)throw new Error("\uc544\uc774\ud15c \uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(a,", \uc2e4\uc81c \ubcf4\uc720: ").concat(h,")"));const g=(0,J.rJ)(J.db,"users",C,"inventory"),f=(0,J.P)(g,(0,J._M)("itemId","==",s.displayInfo.itemId)),y=await(0,J.GG)(f),v=y.empty?null:y.docs[0].ref;te.vF.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c \uc778\ubca4\ud1a0\ub9ac \uc870\ud68c (\ud2b8\ub79c\uc7ad\uc158 \uc678\ubd80):",{"\uae30\uc874\uc544\uc774\ud15c\uc874\uc7ac":!y.empty,"\ubb38\uc11c\uc218":y.size}),l=[...d];const j=[];let N=a;for(const e of d)if(e.itemId===s.displayInfo.itemId&&N>0){const t=Math.min(e.quantity,N),s=e.quantity-t;s>0&&j.push((0,r.A)((0,r.A)({},e),{},{quantity:s})),N-=t}else j.push(e);x&&x(j),await(0,J.c4)(J.db,async t=>{const n=[];for(const s of p){const a=(0,J.EW)(J.db,"users",e.uid,"inventory",s.id),i=await t.get(a);if(!i.exists())throw te.vF.error("[MyItems] \u274c \ud2b8\ub79c\uc7ad\uc158 \uc911 \uc544\uc774\ud15c \ubb38\uc11c\uac00 \uc0ac\ub77c\uc9d0:",s.id),new Error("\ud2b8\ub79c\uc7ad\uc158 \uc911 \uc544\uc774\ud15c\uc774 \uc0ac\ub77c\uc84c\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");const l=i.data().quantity||0;if(l<=0)throw te.vF.error("[MyItems] \u274c \ud2b8\ub79c\uc7ad\uc158 \uc911 \uc544\uc774\ud15c \uc218\ub7c9\uc774 0:",s.id),new Error("\ud2b8\ub79c\uc7ad\uc158 \uc911 \uc544\uc774\ud15c \uc218\ub7c9\uc774 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");n.push({ref:a,snap:i,quantity:l})}let i=null,l=0;if(v){i=v;const e=await t.get(i);e.exists()?(l=e.data().quantity||0,te.vF.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c \uae30\uc874 \uc544\uc774\ud15c \ubc1c\uacac:",{"\ubb38\uc11cID":i.id,"\ud604\uc7ac\uc218\ub7c9":l})):(te.vF.warn("[MyItems] \u26a0\ufe0f \ubc1b\ub294 \uc0ac\ub78c\uc758 \uae30\uc874 \uc544\uc774\ud15c\uc774 \uc0ac\ub77c\uc9d0, \uc0c8\ub85c \uc0dd\uc131\ud569\ub2c8\ub2e4."),i=null)}else te.vF.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c\uc5d0\uac8c \uc0c8 \uc544\uc774\ud15c \uc0dd\uc131 \uc608\uc815");let r=a,o=0;for(const{ref:e,quantity:s}of n){if(r<=0)break;const a=Math.min(s,r),n=s-a;te.vF.log("[MyItems] \uc544\uc774\ud15c \ucc28\uac10:",{"\ubb38\uc11cID":e.id,"\uae30\uc874\uc218\ub7c9":s,"\ucc28\uac10\uc218\ub7c9":a,"\ub0a8\uc740\uc218\ub7c9":n}),n<=0?t.delete(e):t.update(e,{quantity:n}),r-=a,o+=a}if(o<a)throw te.vF.error("[MyItems] \ucc98\ub9ac\ub41c \uc218\ub7c9 \ubd80\uc871:",{"\uc694\uccad":a,"\ucc98\ub9ac\ub428":o}),new Error("\uc544\uc774\ud15c \uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(a,", \uc2e4\uc81c \ubcf4\uc720: ").concat(o,")"));if(i)te.vF.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c \uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 (\uae30\uc874 \uc544\uc774\ud15c\uc5d0 \ucd94\uac00):",{"\uae30\uc874\uc218\ub7c9":l,"\ucd94\uac00\uc218\ub7c9":o,"\ucd5c\uc885\uc218\ub7c9":l+o}),t.update(i,{quantity:l+o,updatedAt:(0,J.O5)()});else{te.vF.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c \uc544\uc774\ud15c \uc0dd\uc131 (\uc0c8 \uc544\uc774\ud15c):",{"\uc218\ub7c9":o});const e=(0,J.EW)(g);t.set(e,{itemId:s.displayInfo.itemId,name:s.displayInfo.name,icon:s.displayInfo.icon,description:s.displayInfo.description,type:s.displayInfo.type,quantity:o,receivedAt:(0,J.O5)(),updatedAt:(0,J.O5)()})}}),te.vF.log("[MyItems] \u2705 \uc120\ubb3c \ud2b8\ub79c\uc7ad\uc158 \uc644\ub8cc"),b("success","".concat(i,"\ub2d8\uc5d0\uac8c ").concat(s.displayInfo.name," ").concat(a,"\uac1c\ub97c \uc120\ubb3c\ud588\uc2b5\ub2c8\ub2e4.")),R(),setTimeout(()=>{u&&u()},2e3)}catch(c){if(te.vF.error("[MyItems] \uc120\ubb3c\ud558\uae30 \uc2e4\ud328:",c),x&&l&&(te.vF.log("[MyItems] \ub099\uad00\uc801 \uc5c5\ub370\uc774\ud2b8 \ub864\ubc31 - \uc6d0\ub798 \uc0c1\ud0dc\ub85c \ubcf5\uc6d0"),x(l)),b("error","\uc120\ubb3c\ud558\uae30 \uc2e4\ud328: ".concat(c.message)),u){te.vF.log("[MyItems] \ub370\uc774\ud130 \uc0c8\ub85c\uace0\uce68 \uc2dc\uc791");try{const e=u();e&&"function"===typeof e.then&&await e,te.vF.log("[MyItems] \ub370\uc774\ud130 \uc0c8\ub85c\uace0\uce68 \uc644\ub8cc")}catch(m){te.vF.error("[MyItems] \ub370\uc774\ud130 \uc0c8\ub85c\uace0\uce68 \uc2e4\ud328:",m)}}}finally{T(!1)}},className:"button-primary",disabled:E||D,children:E?"\uc120\ubb3c\ud558\ub294 \uc911...":D?"\ub3d9\uae30\ud654 \uc911...":"\uc120\ubb3c\ud558\uae30"})]})]})}),F.isOpen&&F.item&&(0,z.jsx)("div",{className:"myitems-modal-overlay",onClick:e=>{e.target===e.currentTarget&&L()},children:(0,z.jsxs)("div",{className:"myitems-modal-container",children:[(0,z.jsxs)("div",{className:"myitems-modal-header",children:[(0,z.jsxs)("h3",{children:["'",F.item.displayInfo.name,"' \uc2dc\uc7a5\uc5d0 \ud310\ub9e4\ud558\uae30"]}),(0,z.jsx)("button",{onClick:L,className:"myitems-close-button",children:"\u2715"})]}),(0,z.jsxs)("div",{className:"myitems-modal-body",children:[(0,z.jsxs)("div",{className:"item-preview-simple",children:[(0,z.jsx)("span",{className:"item-icon-small",children:F.item.displayInfo.icon}),(0,z.jsxs)("span",{children:[F.item.displayInfo.name," (\ubcf4\uc720: ",F.item.totalQuantity,"\uac1c)"]})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsxs)("label",{htmlFor:"sellToMarketQuantity",children:["\ud310\ub9e4 \uc218\ub7c9 (\ucd5c\ub300: ",F.item.totalQuantity,"\uac1c):"]}),(0,z.jsx)("input",{type:"number",id:"sellToMarketQuantity",value:F.quantity,onChange:e=>(e=>{var t;const s=(null===(t=F.item)||void 0===t?void 0:t.totalQuantity)||1,a=Math.max(1,Math.min(s,parseInt(e)||1));O(e=>(0,r.A)((0,r.A)({},e),{},{quantity:a}))})(e.target.value),min:"1",max:F.item.totalQuantity})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{htmlFor:"sellToMarketPrice",children:"\uac1c\ub2f9 \ud310\ub9e4 \uac00\uaca9 (\uc6d0):"}),(0,z.jsx)("input",{type:"number",id:"sellToMarketPrice",value:F.price,onChange:e=>(e=>{const t=Math.max(1,parseInt(e)||1);O(e=>(0,r.A)((0,r.A)({},e),{},{price:t}))})(e.target.value),min:"1"})]}),(0,z.jsxs)("div",{className:"total-price-preview",children:["\uc608\uc0c1 \ud310\ub9e4 \ucd1d\uc561: ",(0,z.jsxs)("strong",{children:[(F.price*F.quantity).toLocaleString(),"\uc6d0"]})]})]}),(0,z.jsxs)("div",{className:"myitems-modal-footer",children:[(0,z.jsx)("button",{onClick:L,className:"button-secondary",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{const{item:t,quantity:s,price:a}=F;if(t&&s&&a)try{const n=t.sourceDocs.map(e=>e.id),i=[];let l=0;for(const t of n){const s=(0,J.EW)(J.db,"users",e.uid,"inventory",t),a=await(0,J.x7)(s);if(a.exists()){const e=a.data();i.push((0,r.A)({id:a.id},e)),l+=e.quantity||0}}if(te.vF.log("[MyItems] \uc2dc\uc7a5\uc5d0 \ud314\uae30 - \uc2e4\uc81c \uc870\ud68c:",{"\uc694\uccad\uc218\ub7c9":s,"\uc2e4\uc81c\ubcf4\uc720":l,"\ubb38\uc11c\uc218":i.length}),0===i.length)throw new Error("\ud310\ub9e4\ud560 \uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ud398\uc774\uc9c0\ub97c \uc0c8\ub85c\uace0\uce68\ud574\uc8fc\uc138\uc694.");if(l<s)throw new Error("\uc544\uc774\ud15c \uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(s,", \uc2e4\uc81c \ubcf4\uc720: ").concat(l,")"));let o=s;const d=[...i].sort((e,t)=>e.quantity-t.quantity);for(const t of d){if(o<=0)break;const s=Math.min(t.quantity,o),n={};if(void 0===t.description&&(te.vF.warn("[MyItems] \ub204\ub77d\ub41c description \ud544\ub4dc \uc218\uc815: ".concat(t.id)),n.description=""),void 0===t.icon&&(te.vF.warn("[MyItems] \ub204\ub77d\ub41c icon \ud544\ub4dc \uc218\uc815: ".concat(t.id)),n.icon="\ud83d\udd2e"),void 0===t.type&&(te.vF.warn("[MyItems] \ub204\ub77d\ub41c type \ud544\ub4dc \uc218\uc815: ".concat(t.id)),n.type="general"),Object.keys(n).length>0){const s=(0,J.EW)(J.db,"users",e.uid,"inventory",t.id);await(0,J.mZ)(s,n),Object.assign(t,n)}const i=await m({itemId:t.id,quantity:s,price:a});if(!i.success)throw new Error(i.message||"\uc77c\ubd80 \uc544\uc774\ud15c \ud310\ub9e4 \ub4f1\ub85d\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");o-=s}b("success","".concat(t.displayInfo.name," ").concat(s,"\uac1c\ub97c \uc2dc\uc7a5\uc5d0 \ud310\ub9e4 \ub4f1\ub85d\ud588\uc2b5\ub2c8\ub2e4.")),L(),setTimeout(()=>{window.confirm("\uc544\uc774\ud15c \uc2dc\uc7a5\uc73c\ub85c \uc774\ub3d9\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&p("/item-market")},500)}catch(n){te.vF.error("[MyItems] \uc2dc\uc7a5 \ud310\ub9e4 \ub4f1\ub85d \uc2e4\ud328:",n),n.message.includes("\uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6")||n.message.includes("\uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4")?(b("warning","\uc544\uc774\ud15c \uc815\ubcf4\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub370\uc774\ud130\ub97c \ub3d9\uae30\ud654\ud569\ub2c8\ub2e4."),M(!0),u?u().then(()=>{b("success","\ub3d9\uae30\ud654\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."),M(!1)}).catch(e=>{te.vF.error("[MyItems] \ub370\uc774\ud130 \ub3d9\uae30\ud654 \uc2e4\ud328:",e),b("error","\ub370\uc774\ud130 \ub3d9\uae30\ud654\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."),M(!1)}):(b("error","\uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc73c\uba70 \ub370\uc774\ud130\ub97c \uc0c8\ub85c\uace0\uce60 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4: ".concat(n.message)),M(!1))):b("error","\uc2dc\uc7a5 \ud310\ub9e4 \ub4f1\ub85d \uc911 \uc624\ub958: ".concat(n.message))}else b("error","\ud310\ub9e4 \uc815\ubcf4\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.")},className:"button-primary sell-button",disabled:D,children:D?"\ub3d9\uae30\ud654 \uc911...":"\ud310\ub9e4 \ub4f1\ub85d"})]})]})})]})},hs=a.memo(ps);var gs=s(9270);function bs(){const{user:e,userDoc:t,users:s,classmates:n,allClassMembers:l,loading:o,updateUser:d,addCashToUserById:c,deductCash:m,optimisticUpdate:u}=(0,i.As)(),x=null===e||void 0===e?void 0:e.uid,p=(null===t||void 0===t?void 0:t.name)||(null===t||void 0===t?void 0:t.nickname)||(null===e||void 0===e?void 0:e.displayName)||"\uc0ac\uc6a9\uc790",h=null===t||void 0===t?void 0:t.classCode,[g,b]=(0,a.useState)(!0),f=(0,a.useRef)(!1),[y,v]=((0,a.useRef)({}),(0,a.useState)(0)),[j,N]=(0,a.useState)([]),[w,k]=(0,a.useState)([]),[C,S]=(0,a.useState)([]),[A,I]=(0,a.useState)([]),[E,T]=(0,a.useState)(0),[D,M]=(0,a.useState)([]),[F,O]=(0,a.useState)([]),[_,R]=(0,a.useState)(0),L=((0,J.Qg)(J.Cn,"getUserAssetsData"),(0,J.Qg)(J.Cn,"sellCoupon"),(0,J.Qg)(J.Cn,"giftCoupon"),36e5),P=h?"".concat(h,"_goal"):null,[W,B]=(0,a.useState)(1e3),[q,U]=(0,a.useState)(1e3);(0,a.useEffect)(()=>{x&&(async()=>{try{const e=(0,J.H9)(J.db,"settings","mainSettings"),t=await(0,J.x7)(e);if(t.exists()){const e=t.data();e.couponValue&&U(Number(e.couponValue))}}catch(e){te.vF.error("[MyAssets] \ucfe0\ud3f0 \uac00\uce58 \uc124\uc815 \ub85c\ub4dc \uc2e4\ud328:",e)}})()},[x]);const[Q,G]=(0,a.useState)(0),[H,V]=(0,a.useState)(0),[K,X]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)(!1),[$,se]=(0,a.useState)(!1),[ae,ne]=(0,a.useState)(!1),[ie,le]=(0,a.useState)(""),[re,oe]=(0,a.useState)(!1),[de,ce]=(0,a.useState)(""),[me,ue]=(0,a.useState)(""),[xe,pe]=(0,a.useState)(!1),[he,ge]=(0,a.useState)(!1),[be,fe]=(0,a.useState)(""),[ye,ve]=(0,a.useState)(""),[je,Ne]=(0,a.useState)(!1),we=(e,t)=>{try{const s={data:t,timestamp:Date.now()};localStorage.setItem("firestore_cache_".concat(e,"_").concat(x),JSON.stringify(s))}catch(s){}},ke=(0,a.useCallback)(async(e,t)=>{try{const s=(0,J.H9)(J.db,"goals",t),a={classCode:e,targetAmount:1e3,progress:0,donations:[],donationCount:0,title:"".concat(e," \ud559\uae09 \ubaa9\ud45c"),description:"".concat(e," \ud559\uae09\uc758 \ucfe0\ud3f0 \ubaa9\ud45c\uc785\ub2c8\ub2e4."),createdAt:(0,J.O5)(),updatedAt:(0,J.O5)(),createdBy:x};await(0,ee.c4)(J.db,async e=>{const n=await e.get(s);if(n.exists()){const e=n.data();we("goal_".concat(t),e)}else e.set(s,a),we("goal_".concat(t),a)})}catch(s){throw s}},[x]),Ce=(0,a.useCallback)(async()=>{if(!P||!h)return;const e="goal_".concat(P),t=(e=>{try{const t=localStorage.getItem("firestore_cache_".concat(e,"_").concat(x));if(t){const{data:e,timestamp:s}=JSON.parse(t);if(Date.now()-s<L)return e}}catch(t){}return null})(e);if(t){B(Number(t.targetAmount)||1e3),G(Number(t.progress)||0);const e=Array.isArray(t.donations)?t.donations:[];M(e);const s=e.filter(e=>e.userId===x).reduce((e,t)=>e+t.amount,0);return void V(s)}try{const t=(0,J.H9)(J.db,"goals",P),s=await(0,J.x7)(t);if(s.exists()){const t=s.data();B(Number(t.targetAmount)||1e3),G(Number(t.progress)||0);const a=Array.isArray(t.donations)?t.donations.map(e=>{let t;return t=e.timestamp&&e.timestamp.toDate?e.timestamp.toDate().toISOString():e.timestamp&&e.timestamp.seconds?new Date(1e3*e.timestamp.seconds).toISOString():e.timestampISO?e.timestampISO:"string"===typeof e.timestamp?e.timestamp:(new Date).toISOString(),(0,r.A)((0,r.A)({},e),{},{amount:Number(e.amount)||0,timestamp:t,userId:e.userId||"",userName:e.userName||"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790",message:e.message||"",classCode:e.classCode||h})}):[];M(a);const n=a.filter(e=>e.userId===x).reduce((e,t)=>e+t.amount,0);V(n),we(e,t)}else te.vF.log("[MyAssets] \ubaa9\ud45c \ubb38\uc11c\uac00 \uc5c6\uc5b4 \uae30\ubcf8\uac12 \uc0dd\uc131"),await ke(h,P)}catch(s){te.vF.error("[MyAssets] \ubaa9\ud45c \ub370\uc774\ud130 \ub85c\ub4dc \uc2e4\ud328:",s)}},[P,h,x,ke]),Se=(0,a.useCallback)(async()=>{if(x&&J.db)if(f.current)te.vF.log("[MyAssets] \u23f8\ufe0f \uc774\ubbf8 \ub85c\ub529 \uc911\uc774\ubbc0\ub85c \uc911\ubcf5 \uc2e4\ud589 \ubc29\uc9c0");else{f.current=!0,b(!0);try{const s=(0,J.P)((0,J.rJ)(J.db,"classes",h,"realEstateProperties"),(0,J._M)("owner","==",x),(0,ee.limit)(50)),a=(0,J.P)((0,J.rJ)(J.db,"ClassStock",h,"students",x,"realestates"),(0,ee.limit)(50)),n=(0,J.P)((0,J.rJ)(J.db,"realEstate"),(0,J._M)("ownerId","==",x),(0,ee.limit)(50)),[i,l,o]=await Promise.all([(0,J.GG)(s),(0,J.GG)(a),(0,J.GG)(n)]),d=[];i.forEach(e=>d.push((0,r.A)({id:e.id},e.data()))),l.forEach(e=>d.push((0,r.A)({id:e.id},e.data()))),o.forEach(e=>d.push((0,r.A)({id:e.id},e.data())));const c=(0,J.H9)(J.db,"users",x,"financials","parkingAccount"),m=(0,J.rJ)(J.db,"ClassStock",h,"students",x,"parkingAccounts"),[u,p]=await Promise.all([(0,J.x7)(c),(0,J.GG)(m)]);let g=0;u.exists()&&(g+=u.data().balance||0),p.forEach(e=>{g+=e.data().balance||0}),v(g);const b=(0,J.P)((0,J.rJ)(J.db,"users",x,"products"),(0,ee.limit)(50)),f=await(0,J.GG)(b),y=[],j=[],w=[];f.forEach(e=>{var t;const s=(0,r.A)((0,r.A)({id:e.id},e.data()),{},{maturityDate:null!==(t=e.data().maturityDate)&&void 0!==t&&t.toDate?e.data().maturityDate.toDate():e.data().maturityDate});"deposit"===s.type?y.push(s):"savings"===s.type?j.push(s):"loan"===s.type&&w.push(s)}),N(y),k(j),S(w),I(d);let C=[],A=[];try{const e=(0,J.P)((0,J.rJ)(J.db,"activity_logs"),(0,J._M)("classCode","==",h),(0,J._M)("userId","==",x),(0,ee.limit)(50));C=(await(0,J.GG)(e)).docs.map(e=>{const t=e.data(),s=t.description||t.type||"\uac70\ub798 \ub0b4\uc5ed";return{id:e.id,amount:t.amount||0,description:"undefined"===s?"\uac70\ub798 \ub0b4\uc5ed":s,timestamp:t.timestamp,type:t.type,couponAmount:t.couponAmount||0,source:"activity_logs"}}).filter(e=>0!==e.amount||0!==e.couponAmount)}catch(e){te.vF.log("[MyAssets] activity_logs \uc870\ud68c \uc2e4\ud328:",e)}try{const e=(0,J.P)((0,J.rJ)(J.db,"users",x,"transactions"),(0,ee.limit)(50));A=(await(0,J.GG)(e)).docs.map(e=>{const t=e.data(),s=t.description||"\uac70\ub798 \ub0b4\uc5ed";return{id:e.id,amount:t.amount||0,description:s&&"undefined"!==s?s:"\uac70\ub798 \ub0b4\uc5ed",timestamp:t.timestamp||t.createdAt,type:t.type||"transaction",source:"transactions"}}).filter(e=>0!==e.amount)}catch(t){te.vF.log("[MyAssets] transactions \uc870\ud68c \uc2e4\ud328:",t)}const E=[...C,...A];E.sort((e,t)=>{var s,a,n,i;const l=null!==(s=e.timestamp)&&void 0!==s&&s.toDate?e.timestamp.toDate():new Date(1e3*(null===(a=e.timestamp)||void 0===a?void 0:a.seconds)||0);return(null!==(n=t.timestamp)&&void 0!==n&&n.toDate?t.timestamp.toDate():new Date(1e3*(null===(i=t.timestamp)||void 0===i?void 0:i.seconds)||0))-l}),O(E.slice(0,20))}catch(s){te.vF.error("[MyAssets] \ud83d\udea8 \ud074\ub77c\uc774\uc5b8\ud2b8 \uce21 \uc9c1\uc811 \uc870\ud68c \uc2e4\ud328:",s)}finally{b(!1),f.current=!1}}else b(!1)},[x,h]);(0,a.useEffect)(()=>{!o&&e?Se():o||e?o&&b(!0):(b(!1),v(0),S([]),I([]),T(0),V(0),B(1e3),G(0),U(1e3),M([]),O([]))},[o,e]),(0,a.useEffect)(()=>{const e=Number(null===t||void 0===t?void 0:t.cash)||0,s=(Number(null===t||void 0===t?void 0:t.coupons)||0)*Number(q),a=A.reduce((e,t)=>e+(Number(t.price)||0),0),n=j.reduce((e,t)=>e+(Number(t.balance)||0),0),i=w.reduce((e,t)=>e+(Number(t.balance)||0),0),l=C.reduce((e,t)=>e+(Number(t.remainingPrincipal)||Number(t.balance)||0),0),r=e+s+Number(y)+n+i+a-l;T(r)},[null===t||void 0===t?void 0:t.cash,null===t||void 0===t?void 0:t.coupons,q,y,j,w,A,C]),(0,a.useEffect)(()=>{X(Q>=W&&W>0)},[Q,W]),(0,a.useEffect)(()=>{e&&P&&Ce()},[e,P]);const Ae=()=>{const e="myAssets_".concat(x);localStorage.removeItem("firestore_cache_".concat(e,"_").concat(x)),te.vF.log("[MyAssets] \ud83d\udd04 \uce90\uc2dc \uc0ad\uc81c \ubc0f \uac15\uc81c \uc0c8\ub85c\uace0\uce68"),Se()};return o||g?(0,z.jsx)(Na,{}):e?t||o?h||o?(0,z.jsx)("div",{className:"w-full min-h-full",style:{backgroundColor:"#0a0a12"},children:(0,z.jsxs)("div",{className:"w-full px-4 md:px-6 lg:px-8 py-6",children:[(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,z.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",color:"#00fff2",borderBottom:"2px solid rgba(0, 255, 242, 0.2)",paddingBottom:"10px",margin:0,textShadow:"0 0 10px rgba(0, 255, 242, 0.3)"},children:"\ub098\uc758 \uc790\uc0b0 \ud604\ud669 \ud83d\udcb3"}),(0,z.jsx)("button",{onClick:Ae,disabled:g,style:{padding:"8px 16px",backgroundColor:"rgba(0, 255, 242, 0.1)",color:"#00fff2",border:"1px solid rgba(0, 255, 242, 0.3)",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:g?"not-allowed":"pointer",opacity:g?.6:1,transition:"all 0.2s ease"},children:"\ud83d\udd04 \uc0c8\ub85c\uace0\uce68"})]}),(0,z.jsx)(st,{userId:x,onClaim:async e=>{try{const s=(0,J.H9)(J.db,"users",x);await(0,J.BN)(s,{cash:(0,J.GV)(e),updatedAt:(0,J.O5)()},{merge:!0}),await(0,gs.Mx)(J.db,{userId:x,userName:p,classCode:h,type:"\uc77c\uc77c \ucd9c\uc11d \ubcf4\uc0c1",description:"\uc77c\uc77c \ucd9c\uc11d \ubcf4\uc0c1\uc73c\ub85c ".concat(e.toLocaleString(),"\uc6d0 \ud68d\ub4dd"),amount:e,metadata:{rewardType:"daily_streak"}}),u&&u({cash:((null===t||void 0===t?void 0:t.cash)||0)+e}),te.vF.log("Daily reward claimed and added: ".concat(e))}catch(s){te.vF.error("\uc77c\uc77c \ubcf4\uc0c1 \uc9c0\uae09 \uc624\ub958:",s),alert("\ubcf4\uc0c1 \uc9c0\uae09 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")}}}),(()=>{const e=Number(null===t||void 0===t?void 0:t.cash)||0,s=Number(null===t||void 0===t?void 0:t.coupons)||0,a=je?F:F.slice(0,5);return(0,z.jsxs)("div",{style:{padding:"0",background:"transparent",marginBottom:"25px"},children:[(0,z.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"20px",padding:"30px",marginBottom:"20px",boxShadow:"0 10px 30px rgba(102, 126, 234, 0.3)",border:"none"},children:[(0,z.jsx)("div",{style:{marginBottom:"10px"},children:(0,z.jsx)("span",{style:{color:"rgba(255,255,255,0.9)",fontSize:"16px",fontWeight:"500"},children:"\ud83d\udcb0 \ubcf4\uc720 \ud604\uae08"})}),(0,z.jsxs)("div",{style:{fontSize:"42px",fontWeight:"800",color:"#ffffff",letterSpacing:"-1px",marginBottom:"15px",textAlign:"right"},children:[e.toLocaleString()," ",(0,z.jsx)("span",{style:{fontSize:"28px",fontWeight:"600"},children:"\uc6d0"})]}),(0,z.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,z.jsx)("button",{onClick:()=>ge(!0),style:{padding:"14px 28px",backgroundColor:"rgba(255, 255, 255, 0.95)",color:"#667eea",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:"700",cursor:"pointer",boxShadow:"0 4px 15px rgba(0,0,0,0.1)",transition:"all 0.3s ease"},disabled:g||o,onMouseOver:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 20px rgba(0,0,0,0.15)"},onMouseOut:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 15px rgba(0,0,0,0.1)"},children:"\ud83d\udcb8 \uc1a1\uae08\ud558\uae30"})})]}),(0,z.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,z.jsx)("h4",{style:{fontSize:"15px",color:"#e8e8ff",fontWeight:"700",marginBottom:"12px"},children:"\ud83d\udcb3 \ucd5c\uadfc \uc785\ucd9c\uae08 \ub0b4\uc5ed"}),F.length>0?(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:a.map(e=>{let t="\ub0a0\uc9dc \uc5c6\uc74c";try{t=(e=>{try{if(!e)return new Date;if(e instanceof Date)return isNaN(e.getTime())?new Date:e;if(e&&"function"===typeof e.toDate){const t=e.toDate();return isNaN(t.getTime())?new Date:t}if(e&&e.seconds){const t=new Date(1e3*e.seconds);return isNaN(t.getTime())?new Date:t}if("string"===typeof e){const t=new Date(e);return isNaN(t.getTime())?new Date:t}if("number"===typeof e){const t=new Date(e);return isNaN(t.getTime())?new Date:t}return new Date}catch(t){return new Date}})(e.timestamp).toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit"})}catch(i){t="\uc624\ub298"}const s=Number(e.amount)||0,a=e.description,n=a&&"undefined"!==a&&"null"!==a?String(a):"\uac70\ub798 \ub0b4\uc5ed";return(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"14px",color:"#a0a0c0",padding:"14px 16px",backgroundColor:s>0?"rgba(5, 150, 105, 0.1)":"rgba(220, 38, 38, 0.1)",border:s>0?"1px solid rgba(5, 150, 105, 0.3)":"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"10px"},children:[(0,z.jsxs)("span",{style:{flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginRight:"10px",fontWeight:"500",color:"#e8e8ff"},children:[t," \u2022 ",n]}),(0,z.jsxs)("span",{style:{fontWeight:"700",fontSize:"15px",color:s>0?"#34d399":"#f87171",minWidth:"110px",textAlign:"right"},children:[s>0?"+":"",s.toLocaleString(),"\uc6d0"]})]},e.id||Math.random())})}),F.length>5&&(0,z.jsx)("button",{onClick:()=>Ne(!je),style:{width:"100%",marginTop:"12px",padding:"12px",backgroundColor:"rgba(255, 255, 255, 0.05)",color:"#a0a0c0",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"10px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>{e.target.style.backgroundColor="#f3f4f6"},onMouseOut:e=>{e.target.style.backgroundColor="#f9fafb"},children:je?"\u25b2 \uc811\uae30":"\u25bc ".concat(F.length-5,"\uac1c \ub354 \ubcf4\uae30")})]}):(0,z.jsx)("div",{style:{fontSize:"13px",color:"#6b7280",textAlign:"center",padding:"20px",backgroundColor:"rgba(255, 255, 255, 0.03)",borderRadius:"10px",border:"1px dashed rgba(255, 255, 255, 0.1)"},children:"\ucd5c\uadfc \uac70\ub798 \ub0b4\uc5ed\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,z.jsxs)("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",borderRadius:"20px",padding:"25px 30px",marginBottom:"20px",boxShadow:"0 10px 30px rgba(240, 147, 251, 0.3)",border:"none"},children:[(0,z.jsx)("div",{style:{marginBottom:"8px"},children:(0,z.jsx)("span",{style:{color:"rgba(255,255,255,0.9)",fontSize:"16px",fontWeight:"500"},children:"\ud83d\udcca \ucd1d \uc21c\uc790\uc0b0"})}),(0,z.jsxs)("div",{style:{fontSize:"38px",fontWeight:"800",color:"#ffffff",letterSpacing:"-1px",textAlign:"right"},children:[Number(E).toLocaleString()," ",(0,z.jsx)("span",{style:{fontSize:"24px",fontWeight:"600"},children:"\uc6d0"})]}),(0,z.jsx)("p",{style:{marginTop:"8px",fontSize:"12px",color:"rgba(255,255,255,0.8)",margin:"8px 0 0 0"},children:"\ud604\uae08 + \ucfe0\ud3f0\uac00\uce58 + \ud30c\ud0b9\ud1b5\uc7a5 + \uc608\uae08 + \uc801\uae08 + \ubd80\ub3d9\uc0b0 - \ub300\ucd9c"})]}),(0,z.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,z.jsx)("h4",{style:{fontSize:"15px",color:"#e8e8ff",fontWeight:"700",marginBottom:"12px"},children:"\ud83c\udd7f\ufe0f \ud30c\ud0b9\ud1b5\uc7a5"}),(0,z.jsx)("div",{style:{background:"linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)",borderRadius:"14px",padding:"20px",border:"none",boxShadow:"0 4px 15px rgba(6, 182, 212, 0.2)"},children:(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,z.jsx)("span",{style:{color:"rgba(255,255,255,0.9)",fontWeight:"500",fontSize:"14px"},children:"\uc794\uc561"}),(0,z.jsxs)("span",{style:{fontWeight:"800",fontSize:"26px",color:"#ffffff",letterSpacing:"-0.5px",textAlign:"right",display:"block"},children:[Number(y).toLocaleString(),(0,z.jsx)("span",{style:{fontSize:"18px",fontWeight:"600"},children:"\uc6d0"})]})]})}),(0,z.jsx)("p",{style:{marginTop:"10px",fontSize:"12px",color:"#9ca3af",textAlign:"center"},children:"\ud30c\ud0b9\ud1b5\uc7a5 \uba54\ub274\uc5d0\uc11c \uc785\ucd9c\uae08 \ubc0f \uc0c1\ud488 \uac00\uc785 \uac00\ub2a5"})]}),(0,z.jsx)("div",{style:{padding:"25px",background:"rgba(20, 20, 35, 0.4)",borderRadius:"16px",border:"1px solid rgba(0, 255, 242, 0.1)",boxShadow:"0 4px 12px rgba(0,0,0,0.2)"},children:(0,z.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,z.jsx)("h4",{style:{fontSize:"15px",color:"#374151",fontWeight:"700",marginBottom:"12px"},children:"\ud83c\udf9f\ufe0f \ubcf4\uc720 \ucfe0\ud3f0"}),(0,z.jsx)("div",{style:{background:"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)",borderRadius:"14px",padding:"20px",border:"none",boxShadow:"0 4px 15px rgba(251, 191, 36, 0.2)"},children:(0,z.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,z.jsxs)("div",{style:{width:"100%"},children:[(0,z.jsxs)("div",{style:{fontSize:"26px",fontWeight:"800",color:"#ffffff",letterSpacing:"-0.5px",textAlign:"right"},children:[s.toLocaleString()," ",(0,z.jsx)("span",{style:{fontSize:"18px",fontWeight:"600"},children:"\uac1c"})]}),(0,z.jsxs)("div",{style:{fontSize:"12px",color:"rgba(255,255,255,0.85)",fontWeight:"500",marginTop:"4px",textAlign:"right"},children:["1\ucfe0\ud3f0 = ",Number(q).toLocaleString(),"\uc6d0"]})]})})})]})})]})})(),he&&(0,z.jsx)(Et,{showTransferModal:he,setShowTransferModal:ge,recipients:n,transferRecipient:be,setTransferRecipient:fe,transferAmount:ye,setTransferAmount:ve,handleTransfer:async()=>{b(!0);try{if(!t||!x||!J.db||!s||!m||!c)return void alert("\ud544\uc218 \uc815\ubcf4\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");const e=parseInt(ye,10);if(isNaN(e)||e<=0)return void alert("\uc62c\ubc14\ub978 \uc1a1\uae08\uc561\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");if((Number(t.cash)||0)<e)return void alert("\ubcf4\uc720 \ud604\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");const a=s.find(e=>e.id===be);if(!a)return void alert("\uc1a1\uae08 \ub300\uc0c1\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ubaa9\ub85d\uc744 \uc0c8\ub85c\uace0\uce68\ud558\uace0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");if(a.id===x)return void alert("\uc790\uae30 \uc790\uc2e0\uc5d0\uac8c\ub294 \uc1a1\uae08\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const n=a.name||a.nickname||"\uc0ac\uc6a9\uc790";if(await m(e,"".concat(n,"\ub2d8\uc5d0\uac8c \uc1a1\uae08"))){await c(a.id,e,"".concat(p,"\ub2d8\uc73c\ub85c\ubd80\ud130 \uc785\uae08"))?((0,gs.Mx)(J.db,{classCode:h,userId:x,userName:p,type:gs.gI.TRANSFER_SEND,description:"".concat(n,"\ub2d8\uc5d0\uac8c ").concat(e.toLocaleString(),"\uc6d0 \uc1a1\uae08"),amount:-e,metadata:{recipientId:a.id,recipientName:n}}),(0,gs.Mx)(J.db,{classCode:h,userId:a.id,userName:n,type:gs.gI.TRANSFER_RECEIVE,description:"".concat(p,"\ub2d8\uc73c\ub85c\ubd80\ud130 ").concat(e.toLocaleString(),"\uc6d0 \uc785\uae08"),amount:e,metadata:{senderId:x,senderName:p}}),alert("\uc1a1\uae08\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),ge(!1),fe(""),ve("")):(alert("\ubc1b\ub294 \uc0ac\ub78c\uc5d0\uac8c \ud604\uae08\uc744 \uc804\ub2ec\ud558\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \uc1a1\uae08\uc774 \ucde8\uc18c\ub429\ub2c8\ub2e4."),await c(x,e,"\uc1a1\uae08 \uc2e4\ud328\ub85c \uc778\ud55c \ubcf5\uc6d0"))}else alert("\uacc4\uc88c\uc5d0\uc11c \ud604\uae08\uc744 \uc778\ucd9c\ud558\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(e){te.vF.error("!!! \uc1a1\uae08 \ucc98\ub9ac \uc911 \uc608\uae30\uce58 \uc54a\uc740 \uc624\ub958 \ubc1c\uc0dd !!!",e),alert("\uc1a1\uae08 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(e.message)),u&&u({cash:parseInt(ye,10)||0})}finally{b(!1)}},userId:x,userCash:Number(null===t||void 0===t?void 0:t.cash)||0})]})}):(0,z.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh",fontSize:"1.2em",color:"#ef4444"},children:"\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc5ec \ud559\uae09 \ucf54\ub4dc\ub97c \ud560\ub2f9\ubc1b\uc73c\uc138\uc694."}):(0,z.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh",fontSize:"1.2em",color:"#ef4444"},children:"\uc0ac\uc6a9\uc790 \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911\uc785\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4\uc5d0\ub3c4 \uc774 \uba54\uc2dc\uc9c0\uac00 \ubcf4\uc774\uba74 \uc571\uc744 \uc0c8\ub85c\uace0\uce68\ud558\uac70\ub098 \uc7ac\ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."}):(0,z.jsx)(ls.A,{})}const fs=e=>null===e||void 0===e?"0\uc6d0":"".concat(Number(e).toLocaleString(),"\uc6d0"),ys=[{value:"food",label:"\uc74c\uc2dd/\uac04\uc2dd",icon:"\ud83c\udf54"},{value:"craft",label:"\uc218\uacf5\uc608/\ub9cc\ub4e4\uae30",icon:"\ud83c\udfa8"},{value:"digital",label:"\ub514\uc9c0\ud138/IT",icon:"\ud83d\udcbb"},{value:"education",label:"\uad50\uc721/\uacfc\uc678",icon:"\ud83d\udcda"},{value:"entertainment",label:"\uc5d4\ud130\ud14c\uc778\uba3c\ud2b8",icon:"\ud83c\udfae"},{value:"service",label:"\uc11c\ube44\uc2a4/\ub300\ud589",icon:"\ud83d\udee0\ufe0f"},{value:"other",label:"\uae30\ud0c0",icon:"\ud83d\udce6"}],vs=[{value:"product",label:"\uc0c1\ud488",icon:"\ud83d\udce6",description:"\ubb3c\uac74\uc744 \ud310\ub9e4\ud569\ub2c8\ub2e4"},{value:"service",label:"\uc11c\ube44\uc2a4",icon:"\ud83d\udee0\ufe0f",description:"\uc11c\ube44\uc2a4\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4"}],js=e=>{let{isOpen:t,onClose:s,shop:n,onSave:i}=e;const[l,o]=(0,a.useState)({shopName:"",description:"",category:"other"}),[d,c]=(0,a.useState)(!1);(0,a.useEffect)(()=>{o(n?{shopName:n.shopName||"",description:n.description||"",category:n.category||"other"}:{shopName:"",description:"",category:"other"})},[n,t]);return t?(0,z.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,z.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,z.jsxs)("div",{className:"modal-header",children:[(0,z.jsx)("h3",{children:n?"\uc0c1\uc810 \uc218\uc815":"\uc0c8 \uc0c1\uc810 \ub9cc\ub4e4\uae30"}),(0,z.jsx)("button",{className:"close-button",onClick:s,children:"\xd7"})]}),(0,z.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l.shopName.trim()){c(!0);try{await i(l),s()}catch(t){te.vF.error("\uc0c1\uc810 \uc800\uc7a5 \uc624\ub958:",t),alert("\uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{c(!1)}}else alert("\uc0c1\uc810 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!")},className:"modal-content",children:[(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\uc0c1\uc810 \uc774\ub984 *"}),(0,z.jsx)("input",{type:"text",value:l.shopName,onChange:e=>o((0,r.A)((0,r.A)({},l),{},{shopName:e.target.value})),placeholder:"\uc608: \ubbfc\uc218\ub124 \uac04\uc2dd\uac00\uac8c",maxLength:20})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\uc5c5\uc885"}),(0,z.jsx)("select",{value:l.category,onChange:e=>o((0,r.A)((0,r.A)({},l),{},{category:e.target.value})),children:ys.map(e=>(0,z.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\uc0c1\uc810 \uc18c\uac1c"}),(0,z.jsx)("textarea",{value:l.description,onChange:e=>o((0,r.A)((0,r.A)({},l),{},{description:e.target.value})),placeholder:"\uc6b0\ub9ac \uac00\uac8c\ub97c \uc18c\uac1c\ud574\uc8fc\uc138\uc694!",rows:3,maxLength:100})]}),(0,z.jsxs)("div",{className:"modal-footer",children:[(0,z.jsx)("button",{type:"button",onClick:s,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{type:"submit",disabled:d,className:"modal-button confirm",children:d?"\uc800\uc7a5 \uc911...":n?"\uc218\uc815\ud558\uae30":"\ub9cc\ub4e4\uae30"})]})]})]})}):null},Ns=e=>{let{isOpen:t,onClose:s,product:n,shopId:i,onSave:l}=e;const[o,d]=(0,a.useState)({type:"product",name:"",description:"",price:"",stock:""}),[c,m]=(0,a.useState)(!1),u=(0,a.useMemo)(()=>{const e=parseInt(o.price)||0;return Math.round(.1*e)},[o.price]),x=(0,a.useMemo)(()=>(parseInt(o.price)||0)+u,[o.price,u]);(0,a.useEffect)(()=>{var e;n?d({type:n.type||"product",name:n.name||"",description:n.description||"",price:(null===(e=n.price)||void 0===e?void 0:e.toString())||"",stock:n.stock>=0?n.stock.toString():""}):d({type:"product",name:"",description:"",price:"",stock:""})},[n,t]);return t?(0,z.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,z.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,z.jsxs)("div",{className:"modal-header",children:[(0,z.jsx)("h3",{children:n?"\uc0c1\ud488/\uc11c\ube44\uc2a4 \uc218\uc815":"\uc0c8 \uc0c1\ud488/\uc11c\ube44\uc2a4 \ub4f1\ub85d"}),(0,z.jsx)("button",{className:"close-button",onClick:s,children:"\xd7"})]}),(0,z.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o.name.trim())if(!o.price||parseInt(o.price)<=0)alert("\uc62c\ubc14\ub978 \uac00\uaca9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!");else if("product"!==o.type||o.stock&&!(parseInt(o.stock)<=0)){m(!0);try{const e={type:o.type,name:o.name.trim(),description:o.description.trim(),price:parseInt(o.price),taxAmount:u,totalPrice:x,stock:"service"===o.type?-1:parseInt(o.stock)};await l(e),s()}catch(t){te.vF.error("\uc0c1\ud488 \uc800\uc7a5 \uc624\ub958:",t),alert("\uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{m(!1)}}else alert("\uc0c1\ud488\uc758 \uc7ac\uace0 \uc218\ub7c9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!");else alert("\uc0c1\ud488/\uc11c\ube44\uc2a4 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!")},className:"modal-content",children:[(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\uc885\ub958 *"}),(0,z.jsx)("div",{className:"type-selector",children:vs.map(e=>(0,z.jsxs)("button",{type:"button",onClick:()=>d((0,r.A)((0,r.A)({},o),{},{type:e.value})),className:"type-button ".concat(o.type===e.value?"active":""),children:[(0,z.jsx)("span",{className:"type-icon",children:e.icon}),(0,z.jsx)("span",{className:"type-label",children:e.label}),(0,z.jsx)("span",{className:"type-desc",children:e.description})]},e.value))})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsxs)("label",{children:["product"===o.type?"\uc0c1\ud488\uba85":"\uc11c\ube44\uc2a4\uba85"," *"]}),(0,z.jsx)("input",{type:"text",value:o.name,onChange:e=>d((0,r.A)((0,r.A)({},o),{},{name:e.target.value})),placeholder:"product"===o.type?"\uc608: \uc218\uc81c \ucfe0\ud0a4":"\uc608: \uc218\ud559 \uacfc\uc678",maxLength:30})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\uc124\uba85"}),(0,z.jsx)("textarea",{value:o.description,onChange:e=>d((0,r.A)((0,r.A)({},o),{},{description:e.target.value})),placeholder:"\uc0c1\ud488/\uc11c\ube44\uc2a4\uc5d0 \ub300\ud574 \uc124\uba85\ud574\uc8fc\uc138\uc694",rows:2,maxLength:100})]}),(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\uac00\uaca9 (\uc138\uc804) *"}),(0,z.jsxs)("div",{className:"input-with-suffix",children:[(0,z.jsx)("input",{type:"number",value:o.price,onChange:e=>d((0,r.A)((0,r.A)({},o),{},{price:e.target.value})),placeholder:"0",min:"1"}),(0,z.jsx)("span",{className:"suffix",children:"\uc6d0"})]})]}),o.price&&parseInt(o.price)>0&&(0,z.jsxs)("div",{className:"tax-info-box",children:[(0,z.jsxs)("div",{className:"tax-row",children:[(0,z.jsx)("span",{children:"\uc0c1\ud488 \uac00\uaca9"}),(0,z.jsx)("span",{children:fs(parseInt(o.price))})]}),(0,z.jsxs)("div",{className:"tax-row highlight",children:[(0,z.jsx)("span",{children:"+ \ubd80\uac00\uc138 (10%)"}),(0,z.jsxs)("span",{children:["+",fs(u)]})]}),(0,z.jsxs)("div",{className:"tax-row total",children:[(0,z.jsx)("span",{children:"\ud310\ub9e4 \uac00\uaca9"}),(0,z.jsx)("span",{className:"neon-text",children:fs(x)})]}),(0,z.jsx)("p",{className:"tax-notice",children:"\ubd80\uac00\uc138 10%\ub294 \uad6d\uc138\uccad\uc5d0 \uc790\ub3d9 \ub0a9\ubd80\ub429\ub2c8\ub2e4"})]}),"product"===o.type&&(0,z.jsxs)("div",{className:"form-group",children:[(0,z.jsx)("label",{children:"\uc7ac\uace0 \uc218\ub7c9 *"}),(0,z.jsxs)("div",{className:"input-with-suffix",children:[(0,z.jsx)("input",{type:"number",value:o.stock,onChange:e=>d((0,r.A)((0,r.A)({},o),{},{stock:e.target.value})),placeholder:"0",min:"1"}),(0,z.jsx)("span",{className:"suffix",children:"\uac1c"})]})]}),(0,z.jsxs)("div",{className:"modal-footer",children:[(0,z.jsx)("button",{type:"button",onClick:s,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{type:"submit",disabled:c,className:"modal-button confirm",children:c?"\uc800\uc7a5 \uc911...":n?"\uc218\uc815\ud558\uae30":"\ub4f1\ub85d\ud558\uae30"})]})]})]})}):null},ws=e=>{let{isOpen:t,onClose:s,product:n,shop:i,onConfirm:l}=e;const[r,o]=(0,a.useState)(1),[d,c]=(0,a.useState)(!1),m=(0,a.useMemo)(()=>n?n.totalPrice*r:0,[n,r]);if(!t||!n)return null;const u="service"===n.type?10:Math.min(n.stock,10);return(0,z.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,z.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,z.jsxs)("div",{className:"modal-header",children:[(0,z.jsx)("h3",{children:"\uad6c\ub9e4 \ud655\uc778"}),(0,z.jsx)("button",{className:"close-button",onClick:s,children:"\xd7"})]}),(0,z.jsxs)("div",{className:"modal-content",children:[(0,z.jsxs)("div",{className:"purchase-item-info",children:[(0,z.jsx)("div",{className:"item-icon",children:"product"===n.type?"\ud83d\udce6":"\ud83d\udee0\ufe0f"}),(0,z.jsxs)("div",{className:"item-details",children:[(0,z.jsx)("h4",{children:n.name}),(0,z.jsx)("p",{className:"shop-name",children:null===i||void 0===i?void 0:i.shopName}),(0,z.jsxs)("p",{className:"item-price",children:[fs(n.totalPrice)," (\ubd80\uac00\uc138 \ud3ec\ud568)"]})]})]}),(0,z.jsxs)("div",{className:"quantity-selector",children:[(0,z.jsx)("label",{children:"product"===n.type?"\uad6c\ub9e4 \uc218\ub7c9":"\uc774\uc6a9 \ud69f\uc218"}),(0,z.jsxs)("div",{className:"quantity-controls",children:[(0,z.jsx)("button",{onClick:()=>o(Math.max(1,r-1)),className:"quantity-btn",children:"-"}),(0,z.jsx)("span",{className:"quantity-value",children:r}),(0,z.jsx)("button",{onClick:()=>o(Math.min(u,r+1)),className:"quantity-btn",children:"+"}),"product"===n.type&&(0,z.jsxs)("span",{className:"stock-info",children:["(\uc7ac\uace0: ",n.stock,"\uac1c)"]})]})]}),(0,z.jsxs)("div",{className:"total-amount-box",children:[(0,z.jsx)("span",{children:"\ucd1d \uacb0\uc81c \uae08\uc561"}),(0,z.jsx)("span",{className:"total-price neon-text",children:fs(m)})]})]}),(0,z.jsxs)("div",{className:"modal-footer",children:[(0,z.jsx)("button",{onClick:s,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{c(!0);try{await l(r),s()}catch(e){alert(e.message||"\uad6c\ub9e4 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{c(!1)}},disabled:d,className:"modal-button confirm",children:d?"\ucc98\ub9ac \uc911...":"\uad6c\ub9e4\ud558\uae30"})]})]})})},ks=e=>{let{shop:t,onClick:s}=e;const a=ys.find(e=>e.value===t.category);return(0,z.jsxs)("div",{onClick:s,className:"shop-card",children:[(0,z.jsxs)("div",{className:"shop-card-header",children:[(0,z.jsx)("div",{className:"shop-icon",children:(null===a||void 0===a?void 0:a.icon)||"\ud83c\udfea"}),(0,z.jsxs)("div",{className:"shop-info",children:[(0,z.jsx)("h3",{className:"shop-name",children:t.shopName}),(0,z.jsxs)("p",{className:"shop-owner",children:[t.ownerName,"\ub2d8\uc758 \uac00\uac8c"]})]})]}),t.description&&(0,z.jsx)("p",{className:"shop-description",children:t.description}),(0,z.jsxs)("div",{className:"shop-card-footer",children:[(0,z.jsx)("span",{className:"shop-category",children:(null===a||void 0===a?void 0:a.label)||"\uae30\ud0c0"}),(0,z.jsxs)("span",{className:"shop-sales",children:["\ucd1d \ub9e4\ucd9c: ",fs(t.totalSales||0)]})]})]})},Cs=e=>{let{product:t,shop:s,onBuy:a,isOwner:n,onEdit:i,onDelete:l}=e;return(0,z.jsxs)("div",{className:"product-card",children:[(0,z.jsxs)("div",{className:"product-card-header",children:[(0,z.jsx)("div",{className:"product-icon",children:"product"===t.type?"\ud83d\udce6":"\ud83d\udee0\ufe0f"}),(0,z.jsxs)("div",{className:"product-info",children:[(0,z.jsxs)("div",{className:"product-title-row",children:[(0,z.jsx)("h4",{className:"product-name",children:t.name}),(0,z.jsx)("span",{className:"product-type-badge ".concat(t.type),children:"product"===t.type?"\uc0c1\ud488":"\uc11c\ube44\uc2a4"})]}),t.description&&(0,z.jsx)("p",{className:"product-description",children:t.description}),(0,z.jsxs)("div",{className:"product-price-row",children:[(0,z.jsx)("span",{className:"product-price neon-text",children:fs(t.totalPrice)}),(0,z.jsx)("span",{className:"vat-included",children:"(VAT \ud3ec\ud568)"}),"product"===t.type&&(0,z.jsx)("span",{className:"stock-badge ".concat(t.stock>0?"":"soldout"),children:t.stock>0?"\uc7ac\uace0 ".concat(t.stock,"\uac1c"):"\ud488\uc808"})]})]})]}),(0,z.jsx)("div",{className:"product-card-actions",children:n?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("button",{onClick:()=>i(t),className:"action-btn edit",children:"\u270f\ufe0f \uc218\uc815"}),(0,z.jsx)("button",{onClick:()=>l(t),className:"action-btn delete",children:"\ud83d\uddd1\ufe0f \uc0ad\uc81c"})]}):(0,z.jsx)("button",{onClick:()=>a(t,s),disabled:"product"===t.type&&t.stock<=0,className:"action-btn buy",children:"product"===t.type&&t.stock<=0?"\ud488\uc808":"\ud83d\uded2 \uad6c\ub9e4\ud558\uae30"})})]})},Ss=()=>{const{user:e,userDoc:t,refreshUserDocument:s}=(0,i.As)(),[n,l]=(0,a.useState)("browse"),[o,d]=(0,a.useState)([]),[c,m]=(0,a.useState)(null),[u,x]=(0,a.useState)([]),[p,h]=(0,a.useState)(null),[g,b]=(0,a.useState)([]),[f,y]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),[N,w]=(0,a.useState)(null),[k,C]=(0,a.useState)(null),[S,A]=(0,a.useState)(null),[I,E]=(0,a.useState)(!0),[T,D]=(0,a.useState)(!1),[M,F]=(0,a.useState)("all"),[O,_]=(0,a.useState)(""),R=(0,a.useCallback)(async()=>{try{E(!0);const e=(0,ee.rJ)(J.db,"personalShops"),t=(0,ee.query)(e,(0,ee.where)("status","==","active")),s=(await(0,ee.getDocs)(t)).docs.map(e=>(0,r.A)({id:e.id},e.data())).sort((e,t)=>{var s,a,n,i;const l=(null===(s=e.createdAt)||void 0===s||null===(a=s.toDate)||void 0===a?void 0:a.call(s))||new Date(0);return((null===(n=t.createdAt)||void 0===n||null===(i=n.toDate)||void 0===i?void 0:i.call(n))||new Date(0))-l}).slice(0,50);d(s)}catch(e){te.vF.error("\uc0c1\uc810 \ubaa9\ub85d \ub85c\ub4dc \uc624\ub958:",e)}finally{E(!1)}},[]),L=(0,a.useCallback)(async()=>{if(e)try{const t=(0,ee.rJ)(J.db,"personalShops"),s=(0,ee.query)(t,(0,ee.where)("ownerId","==",e.uid),(0,ee.limit)(1)),a=await(0,ee.getDocs)(s);if(!a.empty){const e=(0,r.A)({id:a.docs[0].id},a.docs[0].data());m(e);const t=(0,ee.rJ)(J.db,"shopProducts"),s=(0,ee.query)(t,(0,ee.where)("shopId","==",e.id)),n=(await(0,ee.getDocs)(s)).docs.map(e=>(0,r.A)({id:e.id},e.data())).sort((e,t)=>{var s,a,n,i;const l=(null===(s=e.createdAt)||void 0===s||null===(a=s.toDate)||void 0===a?void 0:a.call(s))||new Date(0);return((null===(n=t.createdAt)||void 0===n||null===(i=n.toDate)||void 0===i?void 0:i.call(n))||new Date(0))-l});x(n)}}catch(t){te.vF.error("\ub0b4 \uc0c1\uc810 \ub85c\ub4dc \uc624\ub958:",t)}},[e]),P=(0,a.useCallback)(async e=>{try{D(!0);const t=(0,ee.rJ)(J.db,"shopProducts"),s=(0,ee.query)(t,(0,ee.where)("shopId","==",e)),a=(await(0,ee.getDocs)(s)).docs.map(e=>(0,r.A)({id:e.id},e.data())).filter(e=>"available"===e.status).sort((e,t)=>{var s,a,n,i;const l=(null===(s=e.createdAt)||void 0===s||null===(a=s.toDate)||void 0===a?void 0:a.call(s))||new Date(0);return((null===(n=t.createdAt)||void 0===n||null===(i=n.toDate)||void 0===i?void 0:i.call(n))||new Date(0))-l});b(a)}catch(t){te.vF.error("\uc0c1\ud488 \ub85c\ub4dc \uc624\ub958:",t)}finally{D(!1)}},[]);(0,a.useEffect)(()=>{R(),L()},[R,L]),(0,a.useEffect)(()=>{p&&P(p.id)},[p,P]);const W=async e=>{window.confirm('"'.concat(e.name,'"\uc744(\ub97c) \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?'))&&(await(0,ee.kd)((0,ee.H9)(J.db,"shopProducts",e.id)),await L())},B=(0,a.useMemo)(()=>o.filter(e=>{if("all"!==M&&e.category!==M)return!1;if(O){const t=O.toLowerCase();return e.shopName.toLowerCase().includes(t)||e.ownerName.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)}return!0}),[o,M,O]);return(0,z.jsxs)("div",{className:"personal-shop-container",children:[(0,z.jsxs)("div",{className:"market-header",children:[(0,z.jsx)("h1",{children:"\uac1c\uc778 \uc0c1\uc810"}),(0,z.jsx)("p",{className:"header-subtitle",children:"\ub098\ub9cc\uc758 \uc0c1\uc810\uc744 \uc5f4\uace0 \uc0c1\ud488/\uc11c\ube44\uc2a4\ub97c \ud310\ub9e4\ud574\ubcf4\uc138\uc694!"})]}),(0,z.jsx)("div",{className:"market-tabs",children:[{id:"browse",label:"\uc0c1\uc810 \ub458\ub7ec\ubcf4\uae30",icon:"\ud83d\udecd\ufe0f"},{id:"myshop",label:"\ub0b4 \uc0c1\uc810",icon:"\ud83c\udfea"},{id:"sales",label:"\ud310\ub9e4 \ub0b4\uc5ed",icon:"\ud83d\udcca"}].map(e=>(0,z.jsxs)("button",{onClick:()=>{l(e.id),h(null)},className:"tab-button ".concat(n===e.id?"active":""),children:[(0,z.jsx)("span",{className:"tab-icon",children:e.icon}),(0,z.jsx)("span",{className:"tab-label",children:e.label})]},e.id))}),(()=>{var e,t,s;switch(n){case"browse":return(0,z.jsx)("div",{className:"tab-content",children:p?(0,z.jsxs)("div",{className:"shop-detail-view",children:[(0,z.jsx)("button",{onClick:()=>{h(null),b([])},className:"back-button",children:"\u2190 \uc0c1\uc810 \ubaa9\ub85d\uc73c\ub85c"}),(0,z.jsxs)("div",{className:"shop-detail-header",children:[(0,z.jsx)("div",{className:"shop-detail-icon",children:(null===(e=ys.find(e=>e.value===p.category))||void 0===e?void 0:e.icon)||"\ud83c\udfea"}),(0,z.jsxs)("div",{className:"shop-detail-info",children:[(0,z.jsx)("h2",{children:p.shopName}),(0,z.jsxs)("p",{className:"owner",children:[p.ownerName,"\ub2d8\uc758 \uac00\uac8c"]}),p.description&&(0,z.jsx)("p",{className:"description",children:p.description})]})]}),(0,z.jsxs)("div",{className:"products-section",children:[(0,z.jsx)("h3",{children:"\ud310\ub9e4 \uc0c1\ud488"}),T?(0,z.jsx)("div",{className:"loading-state",children:"\uc0c1\ud488\uc744 \ubd88\ub7ec\uc624\ub294 \uc911..."}):0===g.length?(0,z.jsxs)("div",{className:"empty-state",children:[(0,z.jsx)("span",{className:"empty-icon",children:"\ud83d\udced"}),(0,z.jsx)("p",{children:"\ub4f1\ub85d\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"})]}):(0,z.jsx)("div",{className:"products-grid",children:g.map(e=>(0,z.jsx)(Cs,{product:e,shop:p,onBuy:(e,t)=>{C(e),A(t)},isOwner:!1},e.id))})]})]}):(0,z.jsxs)("div",{className:"shop-list-view",children:[(0,z.jsxs)("div",{className:"controls-section",children:[(0,z.jsx)("div",{className:"search-box",children:(0,z.jsx)("input",{type:"text",value:O,onChange:e=>_(e.target.value),placeholder:"\uc0c1\uc810 \uac80\uc0c9...",className:"search-input"})}),(0,z.jsxs)("select",{value:M,onChange:e=>F(e.target.value),className:"category-filter",children:[(0,z.jsx)("option",{value:"all",children:"\uc804\uccb4 \uc5c5\uc885"}),ys.map(e=>(0,z.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))]})]}),I?(0,z.jsx)("div",{className:"loading-state",children:"\uc0c1\uc810\uc744 \ubd88\ub7ec\uc624\ub294 \uc911..."}):0===B.length?(0,z.jsxs)("div",{className:"empty-state",children:[(0,z.jsx)("span",{className:"empty-icon",children:"\ud83c\udfea"}),(0,z.jsx)("p",{children:O||"all"!==M?"\uac80\uc0c9 \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4":"\uc544\uc9c1 \ub4f1\ub85d\ub41c \uc0c1\uc810\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"})]}):(0,z.jsx)("div",{className:"shops-grid",children:B.map(e=>(0,z.jsx)(ks,{shop:e,onClick:()=>h(e)},e.id))})]})});case"myshop":return(0,z.jsx)("div",{className:"tab-content",children:c?(0,z.jsxs)("div",{className:"my-shop-view",children:[(0,z.jsxs)("div",{className:"my-shop-header",children:[(0,z.jsxs)("div",{className:"my-shop-info",children:[(0,z.jsx)("div",{className:"my-shop-icon",children:(null===(t=ys.find(e=>e.value===c.category))||void 0===t?void 0:t.icon)||"\ud83c\udfea"}),(0,z.jsxs)("div",{className:"my-shop-details",children:[(0,z.jsx)("h2",{children:c.shopName}),(0,z.jsx)("p",{className:"category",children:null===(s=ys.find(e=>e.value===c.category))||void 0===s?void 0:s.label}),c.description&&(0,z.jsx)("p",{className:"description",children:c.description})]}),(0,z.jsx)("button",{onClick:()=>y(!0),className:"edit-shop-btn",children:"\u270f\ufe0f \uc218\uc815"})]}),(0,z.jsxs)("div",{className:"my-shop-stats",children:[(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\ucd1d \ub9e4\ucd9c"}),(0,z.jsx)("span",{className:"stat-value neon-text",children:fs(c.totalSales||0)})]}),(0,z.jsxs)("div",{className:"stat-item",children:[(0,z.jsx)("span",{className:"stat-label",children:"\ub0a9\ubd80\ud55c \ubd80\uac00\uc138"}),(0,z.jsx)("span",{className:"stat-value",children:fs(c.totalTaxPaid||0)})]})]})]}),(0,z.jsxs)("div",{className:"products-header",children:[(0,z.jsxs)("h3",{children:["\ub0b4 \uc0c1\ud488/\uc11c\ube44\uc2a4 (",u.length,")"]}),(0,z.jsx)("button",{onClick:()=>{w(null),j(!0)},className:"add-product-btn",children:"\u2795 \ub4f1\ub85d\ud558\uae30"})]}),0===u.length?(0,z.jsxs)("div",{className:"empty-state",children:[(0,z.jsx)("span",{className:"empty-icon",children:"\ud83d\udce6"}),(0,z.jsx)("p",{children:"\ub4f1\ub85d\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,z.jsx)("span",{className:"empty-hint",children:"\uc0c1\ud488\uc774\ub098 \uc11c\ube44\uc2a4\ub97c \ub4f1\ub85d\ud574\ubcf4\uc138\uc694!"})]}):(0,z.jsx)("div",{className:"products-grid",children:u.map(e=>(0,z.jsx)(Cs,{product:e,shop:c,isOwner:!0,onEdit:e=>{w(e),j(!0)},onDelete:W},e.id))})]}):(0,z.jsx)("div",{className:"create-shop-view",children:(0,z.jsxs)("div",{className:"create-shop-card",children:[(0,z.jsx)("span",{className:"create-icon",children:"\ud83c\udfea"}),(0,z.jsx)("h2",{children:"\ub098\ub9cc\uc758 \uc0c1\uc810\uc744 \ub9cc\ub4e4\uc5b4\ubcf4\uc138\uc694!"}),(0,z.jsx)("p",{children:"\uc0c1\ud488\uc774\ub098 \uc11c\ube44\uc2a4\ub97c \ud310\ub9e4\ud558\uace0 \uc218\uc775\uc744 \uc62c\ub824\ubcf4\uc138\uc694"}),(0,z.jsx)("button",{onClick:()=>y(!0),className:"create-shop-btn",children:"\ud83c\udfea \uc0c1\uc810 \ub9cc\ub4e4\uae30"})]})})});case"sales":return(0,z.jsx)("div",{className:"tab-content",children:(0,z.jsxs)("div",{className:"empty-state",children:[(0,z.jsx)("span",{className:"empty-icon",children:"\ud83d\udcca"}),(0,z.jsx)("p",{children:"\ud310\ub9e4 \ub0b4\uc5ed \uae30\ub2a5 \uc900\ube44 \uc911..."})]})});default:return null}})(),(0,z.jsx)(js,{isOpen:f,onClose:()=>y(!1),shop:c,onSave:async s=>{e&&(c?await(0,ee.mZ)((0,ee.H9)(J.db,"personalShops",c.id),(0,r.A)((0,r.A)({},s),{},{updatedAt:(0,ee.O5)()})):await(0,ee.addDoc)((0,ee.rJ)(J.db,"personalShops"),(0,r.A)((0,r.A)({},s),{},{ownerId:e.uid,ownerName:(null===t||void 0===t?void 0:t.name)||"\uc775\uba85",status:"active",totalSales:0,totalTaxPaid:0,createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)()})),await L(),await R())}}),(0,z.jsx)(Ns,{isOpen:v,onClose:()=>{j(!1),w(null)},product:N,shopId:null===c||void 0===c?void 0:c.id,onSave:async t=>{c&&(N?await(0,ee.mZ)((0,ee.H9)(J.db,"shopProducts",N.id),(0,r.A)((0,r.A)({},t),{},{updatedAt:(0,ee.O5)()})):await(0,ee.addDoc)((0,ee.rJ)(J.db,"shopProducts"),(0,r.A)((0,r.A)({},t),{},{shopId:c.id,ownerId:e.uid,status:"available",soldCount:0,createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)()})),w(null),await L())}}),(0,z.jsx)(ws,{isOpen:!!k,onClose:()=>{C(null),A(null)},product:k,shop:S,onConfirm:async a=>{if(!e||!k||!S)throw new Error("\uad6c\ub9e4 \uc815\ubcf4\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");const n=k.totalPrice*a,i=k.taxAmount*a,l=k.price*a;if(((null===t||void 0===t?void 0:t.cash)||0)<n)throw new Error("\uc794\uc561\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4!");if(S.ownerId===e.uid)throw new Error("\ubcf8\uc778 \uc0c1\uc810\uc5d0\uc11c\ub294 \uad6c\ub9e4\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4!");await(0,ee.c4)(J.db,async s=>{const r=(0,ee.H9)(J.db,"users",e.uid);s.update(r,{balance:(0,ee.GV)(-n)});const o=(0,ee.H9)(J.db,"users",S.ownerId);s.update(o,{balance:(0,ee.GV)(l)});const d=(0,ee.H9)(J.db,"nationalTax","treasury");s.update(d,{totalVAT:(0,ee.GV)(i),totalTaxCollected:(0,ee.GV)(i)});const c=(0,ee.H9)(J.db,"personalShops",S.id);s.update(c,{totalSales:(0,ee.GV)(l),totalTaxPaid:(0,ee.GV)(i)});const m=(0,ee.H9)(J.db,"shopProducts",k.id),u={soldCount:(0,ee.GV)(a)};"product"===k.type&&(u.stock=(0,ee.GV)(-a),k.stock-a<=0&&(u.status="soldout")),s.update(m,u);const x=(0,ee.rJ)(J.db,"activities");s.set((0,ee.H9)(x),{type:"shop_purchase",buyerId:e.uid,buyerName:(null===t||void 0===t?void 0:t.name)||"\uc775\uba85",sellerId:S.ownerId,sellerName:S.ownerName,shopId:S.id,shopName:S.shopName,productId:k.id,productName:k.name,productType:k.type,quantity:a,unitPrice:k.totalPrice,totalAmount:n,taxAmount:i,timestamp:(0,ee.O5)()})}),s&&await s(),p&&await P(p.id),C(null),A(null),alert("\uad6c\ub9e4\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4!")}})]})};var As=s(4776),Is=s(1662),Es=s(6648),Ts=s(6794),Ds=s(773),Ms=s(3242);const Fs=async e=>{if(!e)return null;try{const t=(0,J.rJ)(J.db,"users"),s=(0,J.P)(t,(0,J._M)("classCode","==",e),(0,J._M)("isAdmin","==",!0),(0,J.AB)(1)),a=await(0,J.GG)(s);if(!a.empty){const e=a.docs[0];return(0,r.A)({id:e.id},e.data())}return null}catch(t){return te.vF.error("\uc120\uc0dd\ub2d8 \uacc4\uc815 \uc870\ud68c \uc624\ub958:",t),null}},Os={container:{fontFamily:"sans-serif",backgroundColor:"transparent",padding:"32px",minHeight:"auto"},message:e=>({padding:"16px 20px",borderRadius:"12px",marginBottom:"28px",textAlign:"center",fontSize:"16px",fontWeight:"500",color:"error"===e?"#f87171":"#34d399",backgroundColor:"error"===e?"rgba(239, 68, 68, 0.1)":"rgba(16, 185, 129, 0.1)",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid ".concat("error"===e?"rgba(239, 68, 68, 0.3)":"rgba(16, 185, 129, 0.3)")}),grid:{display:"grid",gap:"28px",maxWidth:"1200px",margin:"0 auto"},card:{backgroundColor:"rgba(20, 20, 35, 0.6)",boxShadow:"0 6px 20px rgba(0, 0, 0, 0.2)",borderRadius:"16px",padding:"32px",border:"1px solid rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)"},cardHeader:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"24px",paddingBottom:"20px",borderBottom:"2px solid rgba(255, 255, 255, 0.05)"},cardTitle:{fontSize:"26px",fontWeight:"bold",color:"#fff",letterSpacing:"-0.5px",textShadow:"0 0 10px rgba(0, 255, 242, 0.3)"},tabContainer:{display:"flex",borderBottom:"2px solid rgba(255, 255, 255, 0.1)",marginBottom:"20px",gap:"8px"},tabButton:e=>({padding:"12px 24px",border:"none",background:e?"rgba(99, 102, 241, 0.2)":"none",cursor:"pointer",fontSize:"17px",fontWeight:e?"700":"500",color:e?"#00fff2":"#94a3b8",borderBottom:"3px solid ".concat(e?"#00fff2":"transparent"),marginBottom:"-2px",borderRadius:"8px 8px 0 0",transition:"all 0.2s ease",textShadow:e?"0 0 5px rgba(0, 255, 242, 0.3)":"none"}),button:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"primary";return{backgroundColor:"primary"===t?"rgba(3, 105, 161, 0.8)":"danger"===t?"rgba(220, 38, 38, 0.8)":"success"===t?"rgba(5, 150, 105, 0.8)":"#4b5563",color:"white",padding:"12px 20px",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)",cursor:e?"not-allowed":"pointer",opacity:e?.5:1,fontSize:"15px",fontWeight:"600",boxShadow:e?"none":"0 4px 12px rgba(0,0,0,0.3)",transition:"all 0.2s ease",":hover":!e&&{transform:"translateY(-2px)",boxShadow:"0 6px 16px rgba(0,0,0,0.4)",filter:"brightness(1.1)"}}},noProduct:{textAlign:"center",color:"#94a3b8",padding:"32px 0",fontSize:"16px",fontStyle:"italic"},input:{width:"100%",padding:"14px 16px",backgroundColor:"rgba(0, 0, 0, 0.2)",border:"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"10px",marginBottom:"16px",fontSize:"16px",color:"white",transition:"border-color 0.2s ease",":focus":{outline:"none",borderColor:"#00fff2",boxShadow:"0 0 0 2px rgba(0, 255, 242, 0.1)"}},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(8px)"},modalContent:{background:"#1a1a2e",padding:"32px",borderRadius:"16px",width:"90%",maxWidth:"450px",position:"relative",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.6)",border:"1px solid rgba(255, 255, 255, 0.1)",color:"#e2e8f0"},modalTitle:{fontSize:"24px",fontWeight:"bold",marginBottom:"20px",color:"#fff",textShadow:"0 0 10px rgba(0, 255, 242, 0.3)"},modalCloseBtn:{position:"absolute",top:"20px",right:"20px",background:"none",border:"none",cursor:"pointer",color:"#94a3b8",transition:"color 0.2s ease",":hover":{color:"#fff"}}},_s=e=>"number"===typeof e?Math.round(e).toLocaleString():"0",Rs=(e,t,s)=>{if(e<=0||!t||s<=0)return{interest:0,total:e};const a=e*Math.pow(1+t/100,s),n=a-e;return{interest:Math.round(n),total:Math.round(a)}},zs=(e,t)=>Math.round(e*(t/100)),Ls={parking:(0,z.jsx)(d.A,{size:28,style:{color:"#0369a1"}}),deposits:(0,z.jsx)(k.A,{size:28,style:{color:"#059669"}}),savings:(0,z.jsx)(Ds.A,{size:28,style:{color:"#7c3aed"}}),loans:(0,z.jsx)(Ms.A,{size:28,style:{color:"#dc2626"}})},Ps=e=>{let{product:t,onCancel:s,onMaturity:a}=e;const n=t.maturityDate&&new Date>=t.maturityDate,i=t.maturityDate?Math.max(0,(0,Is.c)(t.maturityDate,new Date)):0,{interest:l,total:o}=(t.rate,Rs(t.balance,t.rate,t.termInDays)),d=zs(t.balance,t.rate);return(0,z.jsxs)("div",{style:{padding:"20px",border:"2px solid ".concat(n?"rgba(16, 185, 129, 0.5)":"rgba(255, 255, 255, 0.1)"),borderRadius:"12px",marginBottom:"16px",background:n?"rgba(16, 185, 129, 0.1)":"rgba(0, 0, 0, 0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:[(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{style:{fontWeight:"700",fontSize:"18px",color:"#e2e8f0",marginBottom:"4px"},children:t.name}),n&&(0,z.jsx)("span",{style:{backgroundColor:"#10b981",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"600"},children:"\ub9cc\uae30"})]}),(0,z.jsxs)("span",{style:{fontSize:"20px",fontWeight:"700",color:"#00fff2"},children:[_s(t.balance),"\uc6d0"]})]}),(0,z.jsxs)("div",{style:{fontSize:"15px",color:"#94a3b8",marginTop:"16px",display:"grid",gap:"10px",backgroundColor:"rgba(0, 0, 0, 0.2)",padding:"16px",borderRadius:"8px"},children:[(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,z.jsx)("span",{style:{fontWeight:"500"},children:"\uae08\ub9ac (\uc77c):"}),(0,z.jsxs)("span",{style:{fontWeight:"700",color:"#00fff2"},children:[t.rate,"%"]})]}),(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,z.jsx)("span",{style:{fontWeight:"500"},children:"\uc77c\uc77c \uc774\uc790:"}),(0,z.jsxs)("span",{style:{fontWeight:"700",color:"#34d399"},children:["+",_s(d),"\uc6d0/\uc77c"]})]}),t.maturityDate&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,z.jsx)("span",{style:{fontWeight:"500"},children:"\ub9cc\uae30\uc77c:"}),(0,z.jsx)("span",{style:{fontWeight:"600",color:"#e2e8f0"},children:(0,Es.GP)(t.maturityDate,"yyyy-MM-dd")})]}),!n&&(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,z.jsx)("span",{style:{fontWeight:"500"},children:"\ub0a8\uc740 \uae30\uac04:"}),(0,z.jsxs)("span",{style:{fontWeight:"600",color:"#00fff2"},children:[i,"\uc77c"]})]})]})]}),(0,z.jsx)("div",{style:{borderTop:"1px dashed rgba(255, 255, 255, 0.1)",margin:"16px 0"}}),(0,z.jsxs)("div",{style:{fontSize:"15px",color:"#e2e8f0",display:"grid",gap:"10px",backgroundColor:"rgba(0, 255, 242, 0.05)",padding:"16px",borderRadius:"8px",border:"1px solid rgba(0, 255, 242, 0.1)"},children:[(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,z.jsx)("span",{style:{fontWeight:"600"},children:"\ub9cc\uae30 \uc2dc \uc774\uc790 (\uc138\uc804):"}),(0,z.jsxs)("span",{style:{fontWeight:"700",color:"#34d399",fontSize:"17px"},children:["+",_s(l),"\uc6d0"]})]}),(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"17px"},children:[(0,z.jsx)("span",{style:{fontWeight:"700"},children:"\ub9cc\uae30 \uc2dc \ucd1d\uc561:"}),(0,z.jsxs)("span",{style:{fontWeight:"700",color:"#00fff2"},children:[_s(o),"\uc6d0"]})]})]}),(0,z.jsx)("div",{style:{marginTop:"20px",textAlign:"right"},children:n?(0,z.jsxs)("button",{onClick:a,style:(0,r.A)((0,r.A)({},Os.button(!1,"success")),{},{padding:"10px 20px",fontSize:"15px"}),children:["\ub9cc\uae30 \uc218\ub839 (",_s(o),"\uc6d0)"]}):(0,z.jsx)("button",{onClick:s,style:(0,r.A)((0,r.A)({},Os.button(!1,"danger")),{},{padding:"10px 20px",fontSize:"15px"}),children:"loan"===t.type?"\ub300\ucd9c \uc0c1\ud658":"\uc911\ub3c4 \ud574\uc9c0"})})]})},Ws=e=>{let{product:t,onSubscribe:s}=e;const a=t.dailyRate,{interest:n}=Rs(1e5,a,t.termInDays);return(0,z.jsxs)("div",{style:{padding:"20px",border:"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(0, 0, 0, 0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s ease"},children:[(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{style:{fontWeight:"700",fontSize:"18px",color:"#e2e8f0",marginBottom:"8px"},children:t.name}),(0,z.jsxs)("div",{style:{fontSize:"15px",color:"#94a3b8",marginBottom:"6px"},children:[(0,z.jsxs)("strong",{style:{color:"#00fff2"},children:["\uc77c ",t.dailyRate,"%"]})," (\uae30\uac04: ",t.termInDays,"\uc77c)"]}),(0,z.jsxs)("div",{style:{fontSize:"14px",color:"#34d399",fontWeight:"600"},children:[(0,z.jsx)(y.A,{size:14,style:{display:"inline",marginRight:"4px"}}),"10\ub9cc\uc6d0 \uac00\uc785 \uc2dc \uc608\uc0c1 \uc774\uc790: +",_s(n),"\uc6d0"]})]}),(0,z.jsx)("button",{onClick:s,style:(0,r.A)((0,r.A)({},Os.button(!1)),{},{padding:"12px 24px",fontSize:"16px"}),children:"\uac00\uc785"})]})},Bs=e=>{let{title:t,icon:s,subscribedProducts:n,availableProducts:i,onSubscribe:l,onCancel:r,onMaturity:o}=e;const[d,c]=(0,a.useState)("subscribed");return(0,z.jsxs)("div",{style:Os.card,children:[(0,z.jsxs)("div",{style:Os.cardHeader,children:[s,(0,z.jsx)("h2",{style:Os.cardTitle,children:t})]}),(0,z.jsxs)("div",{style:Os.tabContainer,children:[(0,z.jsx)("button",{onClick:()=>c("subscribed"),style:Os.tabButton("subscribed"===d),children:"\uac00\uc785\ud55c \uc0c1\ud488"}),(0,z.jsx)("button",{onClick:()=>c("available"),style:Os.tabButton("available"===d),children:"\uac00\uc785 \uac00\ub2a5\ud55c \uc0c1\ud488"})]}),(0,z.jsxs)("div",{children:["subscribed"===d&&(n.length>0?n.map(e=>(0,z.jsx)(Ps,{product:e,onCancel:()=>r(e),onMaturity:()=>o(e)},e.id)):(0,z.jsx)("p",{style:Os.noProduct,children:"\uac00\uc785\ud55c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})),"available"===d&&(i.length>0?i.map(e=>(0,z.jsx)(Ws,{product:e,onSubscribe:()=>l(e)},e.id)):(0,z.jsx)("p",{style:Os.noProduct,children:"\uac00\uc785 \uac00\ub2a5\ud55c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}))]})]})},qs=e=>{let{isOpen:t,onClose:s,product:n,onConfirm:i,isProcessing:l}=e;const[o,d]=(0,a.useState)("");if(!t||!n)return null;const c=parseFloat(o),m=n.dailyRate,{interest:u,total:x}=!isNaN(c)&&c>0?Rs(c,m,n.termInDays):{interest:0,total:0};return(0,z.jsx)("div",{style:Os.modalOverlay,onClick:s,children:(0,z.jsxs)("div",{style:Os.modalContent,onClick:e=>e.stopPropagation(),children:[(0,z.jsx)("button",{onClick:s,style:Os.modalCloseBtn,children:(0,z.jsx)(_.A,{size:24})}),(0,z.jsxs)("h3",{style:Os.modalTitle,children:[n.name," \uac00\uc785"]}),(0,z.jsxs)("div",{style:{marginBottom:"20px",padding:"16px",backgroundColor:"rgba(0, 255, 242, 0.05)",borderRadius:"10px",border:"1px solid rgba(0, 255, 242, 0.2)"},children:[(0,z.jsxs)("div",{style:{fontSize:"15px",color:"#94a3b8",marginBottom:"8px"},children:[(0,z.jsx)("strong",{style:{color:"#00fff2"},children:"\uae08\ub9ac:"})," \uc77c ",n.dailyRate,"% (\uc77c\ubcf5\ub9ac)"]}),(0,z.jsxs)("div",{style:{fontSize:"15px",color:"#94a3b8"},children:[(0,z.jsx)("strong",{style:{color:"#00fff2"},children:"\uae30\uac04:"})," ",n.termInDays,"\uc77c"]})]}),(0,z.jsx)("p",{style:{marginBottom:"12px",fontSize:"16px",fontWeight:"600",color:"#e2e8f0"},children:"\uac00\uc785 \uae08\uc561\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694"}),(0,z.jsx)("input",{type:"number",value:o,onChange:e=>d(e.target.value),style:Os.input,placeholder:"".concat(_s(n.minAmount||0),"\uc6d0 \uc774\uc0c1"),autoFocus:!0}),c>0&&(0,z.jsxs)("div",{style:{marginBottom:"20px",padding:"16px",backgroundColor:"rgba(16, 185, 129, 0.1)",borderRadius:"10px",border:"1px solid rgba(16, 185, 129, 0.3)"},children:[(0,z.jsxs)("div",{style:{fontSize:"15px",color:"#34d399",marginBottom:"6px"},children:["\uc608\uc0c1 \ub9cc\uae30 \uc774\uc790: ",(0,z.jsxs)("strong",{children:["+",_s(u),"\uc6d0"]})]}),(0,z.jsxs)("div",{style:{fontSize:"16px",color:"#34d399",fontWeight:"700"},children:["\ub9cc\uae30 \uc2dc \ucd1d\uc561: ",_s(x),"\uc6d0"]})]}),(0,z.jsx)("button",{onClick:()=>{i(o),d("")},disabled:l||!o,style:(0,r.A)((0,r.A)({},Os.button(l||!o)),{},{width:"100%",fontSize:"17px",padding:"16px"}),children:l?"\ucc98\ub9ac \uc911...":"\uac00\uc785\ud558\uae30"})]})})},Us=e=>{let{balance:t,dailyInterest:s,onDeposit:n,onWithdraw:i,isProcessing:l,userCash:o}=e;const[c,m]=(0,a.useState)("");return(0,z.jsxs)("div",{style:(0,r.A)((0,r.A)({},Os.card),{},{background:"linear-gradient(135deg, rgba(6, 78, 117, 0.85) 0%, rgba(20, 40, 60, 0.9) 100%)",color:"white",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",border:"1px solid rgba(0, 180, 216, 0.25)"}),children:[(0,z.jsxs)("div",{style:(0,r.A)((0,r.A)({},Os.cardHeader),{},{borderBottom:"2px solid rgba(0, 180, 216, 0.2)"}),children:[(0,z.jsx)(d.A,{size:32,style:{color:"#67e8f9"}}),(0,z.jsx)("h2",{style:(0,r.A)((0,r.A)({},Os.cardTitle),{},{color:"#e0f7fa"}),children:"\ud30c\ud0b9\ud1b5\uc7a5"})]}),(0,z.jsxs)("div",{style:{backgroundColor:"rgba(0, 180, 216, 0.15)",padding:"12px 16px",borderRadius:"10px",marginBottom:"16px",backdropFilter:"blur(10px)",display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid rgba(0, 180, 216, 0.2)"},children:[(0,z.jsx)("span",{style:{fontSize:"16px",fontWeight:"500",color:"#94a3b8"},children:"\ubcf4\uc720 \ud604\uae08"}),(0,z.jsxs)("span",{style:{fontSize:"20px",fontWeight:"700",color:"#e0f7fa"},children:[_s(o||0),"\uc6d0"]})]}),(0,z.jsxs)("div",{style:{fontSize:"42px",fontWeight:"bold",color:"#e0f7fa",marginBottom:"8px"},children:[_s(t),"\uc6d0"]}),(0,z.jsx)("p",{style:{fontSize:"16px",color:"rgba(224, 247, 250, 0.8)",marginBottom:"16px",fontWeight:"500"},children:"\ub9e4\uc77c \uc774\uc790\uac00 \uc790\ub3d9 \uc9c0\uae09\ub418\ub294 \uc790\uc720 \uc785\ucd9c\uae08 \ud1b5\uc7a5"}),(0,z.jsxs)("div",{style:{backgroundColor:"rgba(0, 180, 216, 0.12)",padding:"16px",borderRadius:"10px",marginBottom:"24px",backdropFilter:"blur(10px)",border:"1px solid rgba(0, 180, 216, 0.2)"},children:[(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[(0,z.jsx)(y.A,{size:20,style:{color:"#67e8f9"}}),(0,z.jsx)("span",{style:{fontSize:"15px",fontWeight:"600",color:"#94a3b8"},children:"\uc77c\uc77c \uc774\uc790 \uc218\uc775"})]}),(0,z.jsxs)("div",{style:{fontSize:"28px",fontWeight:"700",color:"#67e8f9"},children:["+",_s(s),"\uc6d0/\uc77c"]}),(0,z.jsx)("div",{style:{fontSize:"14px",marginTop:"6px",color:"rgba(148, 163, 184, 0.9)"},children:"(\uc77c 1% \ubcf5\ub9ac \uae30\uc900)"})]}),(0,z.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,z.jsx)("input",{type:"number",value:c,onChange:e=>m(e.target.value),placeholder:"\uae08\uc561 \uc785\ub825",style:(0,r.A)((0,r.A)({},Os.input),{},{marginBottom:0,fontSize:"17px",flex:1,backgroundColor:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(0, 180, 216, 0.3)"}),disabled:l}),(0,z.jsx)("button",{onClick:()=>{n(c),m("")},disabled:l,style:(0,r.A)((0,r.A)({},Os.button(l,"success")),{},{fontSize:"17px",padding:"14px 24px"}),children:"\uc785\uae08"}),(0,z.jsx)("button",{onClick:()=>{i(c),m("")},disabled:l,style:(0,r.A)((0,r.A)({},Os.button(l)),{},{backgroundColor:"rgba(100, 116, 139, 0.5)",color:"white",fontSize:"17px",padding:"14px 24px"}),children:"\ucd9c\uae08"})]})]})},Qs=e=>{let{auth:t={},depositProducts:s=[],installmentProducts:n=[],loanProducts:i=[],activeView:l="parking",onViewChange:o,onLoadUserProducts:d,allUserProducts:c=[],onDeleteUserProduct:m}=e;const{user:u,userDoc:x,loading:p,refreshUserDocument:h,isAdmin:g,addCash:b,deductCash:f}=t,y=null===u||void 0===u?void 0:u.uid,[v,j]=(0,a.useState)(!1),[N,w]=(0,a.useState)(null),[k,C]=(0,a.useState)(""),[S,A]=(0,a.useState)(0),[I,E]=(0,a.useState)(0),[T,D]=(0,a.useState)([]),[M,F]=(0,a.useState)([]),[O,_]=(0,a.useState)([]),[R,L]=(0,a.useState)({isOpen:!1,product:null,type:""}),[P,W]=(0,a.useState)((null===x||void 0===x?void 0:x.cash)||0),B=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;w(e),C(t),s&&setTimeout(()=>w(null),s)},q=(0,a.useCallback)(async()=>{if(y){j(!0);try{const t=(0,J.H9)(J.db,"users",y,"financials","parkingAccount"),a=s.length>0?s[0]:null;if(a){const s=await(0,J.x7)(t);if(s.exists()){var e;const n=s.data(),i=null===(e=n.lastInterestDate)||void 0===e?void 0:e.toDate();if(!i||!(0,Ts.c)(i)){const e=i?(0,Is.c)(new Date,i):1;if(e>0){const s=a.dailyRate||.0027,{interest:i}=Rs(n.balance||0,s,e);i>0&&(await(0,J.mZ)(t,{balance:(0,J.GV)(i),lastInterestDate:(0,J.O5)()}),B("\ud30c\ud0b9\ud1b5\uc7a5 \uc774\uc790 ".concat(_s(i),"\uc6d0\uc774 \uc9c0\uae09\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),"success"))}}}else await(0,J.BN)(t,{balance:0,lastInterestDate:(0,J.O5)()})}const n=await(0,J.x7)(t);if(n.exists()){const e=n.data().balance||0;A(e);const t=zs(e,1);E(t)}const i=(0,J.rJ)(J.db,"users",y,"products"),l=await(0,J.GG)(i),o=[],d=[],c=[];l.forEach(e=>{var t;const s=(0,r.A)((0,r.A)({id:e.id},e.data()),{},{maturityDate:null!==(t=e.data().maturityDate)&&void 0!==t&&t.toDate?e.data().maturityDate.toDate():e.data().maturityDate});"deposit"===s.type?o.push(s):"savings"===s.type?d.push(s):"loan"===s.type&&c.push(s)}),D(o),F(d),_(c)}catch(t){te.vF.error("\ub370\uc774\ud130 \ub85c\ub4dc \uc624\ub958:",t),B("\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.","error")}finally{j(!1)}}},[y,s]);(0,a.useEffect)(()=>{!p&&y&&q()},[y,p,q]),(0,a.useEffect)(()=>{void 0!==(null===x||void 0===x?void 0:x.cash)&&(W(x.cash),te.vF.log("[ParkingAccount] currentCash \uc5c5\ub370\uc774\ud2b8:",x.cash))},[null===x||void 0===x?void 0:x.cash]);const U=(e,t)=>L({isOpen:!0,product:e,type:t}),Q=()=>L({isOpen:!1,product:null,type:""}),G=async e=>{te.vF.log("--- handleMaturity \uc2dc\uc791 ---"),te.vF.log("\ucc98\ub9ac\ud560 \uc0c1\ud488:",e);const{id:t,name:s,type:a,balance:n,termInDays:i,rate:l,teacherId:r}=e,o="loan"===a;if(!y)return B("\uc0ac\uc6a9\uc790 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694.","error"),void te.vF.error("handleMaturity: userId\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const d=l,{total:c,interest:m}=Rs(n,d,i);te.vF.log("\uacc4\uc0b0 \uacb0\uacfc: \uc6d0\uae08=".concat(n,", \uc774\uc790=").concat(m,", \ucd1d\uc561=").concat(c));const u=o?"\ub300\ucd9c \ub9cc\uae30 \uc0c1\ud658: \uc6d0\uae08 ".concat(_s(n),"\uc6d0 + \uc774\uc790 ").concat(_s(m),"\uc6d0 = ").concat(_s(c),"\uc6d0\uc744 \uc0c1\ud658\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"):"\ub9cc\uae30 \uc218\ub839: \uc6d0\uae08 ".concat(_s(n),"\uc6d0 + \uc774\uc790 ").concat(_s(m),"\uc6d0 = ").concat(_s(c),"\uc6d0\uc744 \uc218\ub839\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?");if(!window.confirm(u))return void te.vF.log("\uc0ac\uc6a9\uc790\uac00 \ub9cc\uae30 \ucc98\ub9ac\ub97c \ucde8\uc18c\ud588\uc2b5\ub2c8\ub2e4.");j(!0),te.vF.log("\ub9cc\uae30 \ucc98\ub9ac \uc2dc\uc791...");let p=r;if(!p){const e=await Fs(null===x||void 0===x?void 0:x.classCode);if(!e)return B("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.","error"),void j(!1);p=e.id}te.vF.log("\uc120\uc0dd\ub2d8 \uacc4\uc815 ID:",p);try{const e=(0,J.H9)(J.db,"users",y,"products",String(t));te.vF.log("Firestore \ubb38\uc11c \ucc38\uc870:",e.path),await(0,J.c4)(J.db,async t=>{var s,a,n,i;te.vF.log("\ud2b8\ub79c\uc7ad\uc158 \uc2dc\uc791");const l=(0,J.H9)(J.db,"users",y),r=(0,J.H9)(J.db,"users",p),d=await t.get(l),m=await t.get(r);if(!d.exists())throw new Error("\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!m.exists())throw new Error("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const u=null!==(s=null===(a=d.data())||void 0===a?void 0:a.cash)&&void 0!==s?s:0,x=null!==(n=null===(i=m.data())||void 0===i?void 0:i.cash)&&void 0!==n?n:0;if(o){if(u<c)throw new Error("\uc0c1\ud658\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(_s(c),"\uc6d0, \ubcf4\uc720: ").concat(_s(u),"\uc6d0)"));t.update(l,{cash:(0,J.GV)(-c)}),t.update(r,{cash:(0,J.GV)(c)}),te.vF.log("\ub300\ucd9c \uc0c1\ud658: \ud559\uc0dd -".concat(c,", \uc120\uc0dd\ub2d8 +").concat(c))}else{if(x<c)throw new Error("\uc740\ud589(\uc120\uc0dd\ub2d8)\uc5d0 \uc9c0\uae09\ud560 \uc790\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(_s(c),"\uc6d0)"));t.update(l,{cash:(0,J.GV)(c)}),t.update(r,{cash:(0,J.GV)(-c)}),te.vF.log("\ub9cc\uae30 \uc218\ub839: \ud559\uc0dd +".concat(c,", \uc120\uc0dd\ub2d8 -").concat(c))}t.delete(e),te.vF.log("\uc0c1\ud488 \ubb38\uc11c \uc0ad\uc81c \uc608\uc57d"),te.vF.log("\ud2b8\ub79c\uc7ad\uc158 \ucee4\ubc0b \uc2dc\ub3c4")}),te.vF.log("\ud2b8\ub79c\uc7ad\uc158 \uc131\uacf5");const i=o?"\ub300\ucd9c \uc0c1\ud658 \uc644\ub8cc: ".concat(_s(c),"\uc6d0 (\uc120\uc0dd\ub2d8 \uacc4\uc815\uc73c\ub85c \uc774\uccb4)"):"\ub9cc\uae30 \uc218\ub839 \uc644\ub8cc: ".concat(_s(c),"\uc6d0 (\uc120\uc0dd\ub2d8 \uacc4\uc815\uc5d0\uc11c \uc9c0\uae09)");B(i,"success");const l=o?gs.gI.LOAN_REPAY:gs.gI.DEPOSIT_MATURITY;(0,gs.Mx)(J.db,{classCode:null===x||void 0===x?void 0:x.classCode,userId:y,userName:(null===x||void 0===x?void 0:x.name)||"\uc0ac\uc6a9\uc790",type:l,description:o?"\ub300\ucd9c \ub9cc\uae30 \uc0c1\ud658: ".concat(s," (\uc6d0\uae08: ").concat(_s(n),", \uc774\uc790: ").concat(_s(m),") - \uc120\uc0dd\ub2d8 \uacc4\uc815\uc73c\ub85c"):"".concat(s," \ub9cc\uae30 \uc218\ub839 (\uc6d0\uae08: ").concat(_s(n),", \uc774\uc790: ").concat(_s(m),") - \uc120\uc0dd\ub2d8 \uacc4\uc815\uc5d0\uc11c"),amount:o?-c:c,metadata:{productName:s,productType:a,principal:n,interest:m,total:c,teacherId:p}}),h&&(te.vF.log("userDoc \uac31\uc2e0 \uc2dc\uc791"),h().then(()=>{te.vF.log("[ParkingAccount] \ub9cc\uae30 \ucc98\ub9ac \ud6c4 userDoc \uac31\uc2e0 \uc644\ub8cc")})),te.vF.log("\uc804\uccb4 \ub370\uc774\ud130 \ub2e4\uc2dc \ub85c\ub4dc"),await q()}catch(g){te.vF.error("\ub9cc\uae30 \ucc98\ub9ac \uc911 \uc624\ub958 \ubc1c\uc0dd:",g),B("\ucc98\ub9ac \uc624\ub958: ".concat(g.message),"error"),void 0!==(null===x||void 0===x?void 0:x.cash)&&(te.vF.log("\uc624\ub958 \ubc1c\uc0dd\uc73c\ub85c \ud604\uae08 \ub864\ubc31:",x.cash),W(x.cash))}finally{j(!1),te.vF.log("--- handleMaturity \uc885\ub8cc ---")}},H=async e=>{te.vF.log("--- handleCancelEarly \uc2dc\uc791 ---"),te.vF.log("\uc911\ub3c4 \ud574\uc9c0\ud560 \uc0c1\ud488:",e);const{id:t,name:s,type:a,balance:n}=e,i="loan"===a;if(!y)return B("\uc0ac\uc6a9\uc790 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694.","error"),void te.vF.error("handleCancelEarly: userId\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const l=i?"\ub300\ucd9c\uae08 ".concat(_s(n),"\uc6d0\uc744 \uc0c1\ud658\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"):"'".concat(s,"'\uc744(\ub97c) \uc911\ub3c4 \ud574\uc9c0\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? (\uc774\uc790 \uc5c6\uc774 \uc6d0\uae08\ub9cc \ubc18\ud658\ub429\ub2c8\ub2e4)");if(!window.confirm(l))return void te.vF.log("\uc0ac\uc6a9\uc790\uac00 \uc911\ub3c4 \ud574\uc9c0\ub97c \ucde8\uc18c\ud588\uc2b5\ub2c8\ub2e4.");j(!0),te.vF.log("\uc911\ub3c4 \ud574\uc9c0 \ucc98\ub9ac \uc2dc\uc791...");let r=e.teacherId;if(!r){const e=await Fs(null===x||void 0===x?void 0:x.classCode);if(!e)return B("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.","error"),void j(!1);r=e.id}te.vF.log("\uc120\uc0dd\ub2d8 \uacc4\uc815 ID:",r);const o={deposit:[...T],savings:[...M],loan:[...O]},d=P,c=i?-n:n;W(e=>e+c),"deposit"===a?D(e=>e.filter(e=>e.id!==t)):"savings"===a?F(e=>e.filter(e=>e.id!==t)):"loan"===a&&_(e=>e.filter(e=>e.id!==t));try{const e=(0,J.H9)(J.db,"users",y,"products",String(t));te.vF.log("Firestore \ubb38\uc11c \ucc38\uc870:",e.path),await(0,J.c4)(J.db,async t=>{var s,a,l,o;te.vF.log("\ud2b8\ub79c\uc7ad\uc158 \uc2dc\uc791");const d=(0,J.H9)(J.db,"users",y),c=(0,J.H9)(J.db,"users",r),m=await t.get(d),u=await t.get(c);if(!m.exists())throw new Error("\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!u.exists())throw new Error("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const x=null!==(s=null===(a=m.data())||void 0===a?void 0:a.cash)&&void 0!==s?s:0,p=null!==(l=null===(o=u.data())||void 0===o?void 0:o.cash)&&void 0!==l?l:0;if(te.vF.log("\ud604\uc7ac \ubcf4\uc720 \ud604\uae08 (DB): ".concat(x,", \uc120\uc0dd\ub2d8 \ubcf4\uc720 \ud604\uae08: ").concat(p)),i){if(x<n)throw new Error("\ub300\ucd9c\uae08\uc744 \uc0c1\ud658\ud558\uae30\uc5d0 \ud604\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");t.update(d,{cash:(0,J.GV)(-n)}),t.update(c,{cash:(0,J.GV)(n)}),te.vF.log("\ub300\ucd9c \uc911\ub3c4 \uc0c1\ud658: \ud559\uc0dd -".concat(n,", \uc120\uc0dd\ub2d8 +").concat(n))}else{if(p<n)throw new Error("\uc740\ud589(\uc120\uc0dd\ub2d8)\uc5d0 \uc9c0\uae09\ud560 \uc790\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(_s(n),"\uc6d0)"));t.update(d,{cash:(0,J.GV)(n)}),t.update(c,{cash:(0,J.GV)(-n)}),te.vF.log("\uc911\ub3c4 \ud574\uc9c0: \ud559\uc0dd +".concat(n,", \uc120\uc0dd\ub2d8 -").concat(n))}t.delete(e),te.vF.log("\uc0c1\ud488 \ubb38\uc11c \uc0ad\uc81c \uc608\uc57d"),te.vF.log("\ud2b8\ub79c\uc7ad\uc158 \ucee4\ubc0b \uc2dc\ub3c4")}),te.vF.log("\ud2b8\ub79c\uc7ad\uc158 \uc131\uacf5");const l=i?"\ub300\ucd9c \uc0c1\ud658 \uc644\ub8cc: ".concat(_s(n),"\uc6d0 (\uc120\uc0dd\ub2d8 \uacc4\uc815\uc73c\ub85c \uc774\uccb4)"):"\uc911\ub3c4 \ud574\uc9c0 \uc644\ub8cc: \uc6d0\uae08 ".concat(_s(n),"\uc6d0 \ubc18\ud658 (\uc120\uc0dd\ub2d8 \uacc4\uc815\uc5d0\uc11c \uc9c0\uae09)");B(l,"success");const o=i?gs.gI.LOAN_REPAY:gs.gI.DEPOSIT_WITHDRAW;(0,gs.Mx)(J.db,{classCode:null===x||void 0===x?void 0:x.classCode,userId:y,userName:(null===x||void 0===x?void 0:x.name)||"\uc0ac\uc6a9\uc790",type:o,description:i?"\ub300\ucd9c \uc911\ub3c4 \uc0c1\ud658: ".concat(s," (").concat(_s(n),"\uc6d0) - \uc120\uc0dd\ub2d8 \uacc4\uc815\uc73c\ub85c"):"\uc911\ub3c4 \ud574\uc9c0: ".concat(s," (\uc6d0\uae08 ").concat(_s(n),"\uc6d0) - \uc120\uc0dd\ub2d8 \uacc4\uc815\uc5d0\uc11c"),amount:c,metadata:{productName:s,productType:a,principal:n,isEarlyCancellation:!0,teacherId:r}}),h&&(te.vF.log("userDoc \uac31\uc2e0 \uc2dc\uc791"),h()),await q()}catch(m){te.vF.error("\uc911\ub3c4 \ud574\uc9c0 \ucc98\ub9ac \uc911 \uc624\ub958 \ubc1c\uc0dd:",m),B("\ucc98\ub9ac \uc624\ub958: ".concat(m.message),"error"),D(o.deposit),F(o.savings),_(o.loan),W(d)}finally{j(!1),te.vF.log("--- handleCancelEarly \uc885\ub8cc ---")}},V=async e=>{if(g()){if(window.confirm("\uc815\ub9d0\ub85c \uc774 \uc0c1\ud488(".concat(e.name,")\uc744 \uac15\uc81c\ub85c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))){j(!0);try{const t=(0,J.H9)(J.db,"users",e.userId,"products",e.id);await(0,J.kd)(t),B("\uc0c1\ud488\uc774 \uac15\uc81c\ub85c \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.","success"),q()}catch(t){te.vF.error("\uad00\ub9ac\uc790 \uc0c1\ud488 \uc0ad\uc81c \uc911 \uc624\ub958:",t),B("\uc0ad\uc81c \ucc98\ub9ac \uc624\ub958: ".concat(t.message),"error")}finally{j(!1)}}}else B("\uad00\ub9ac\uc790 \uad8c\ud55c\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.","error")};return p?(0,z.jsx)("div",{style:Os.container,children:"\uae08\uc735 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911\uc785\ub2c8\ub2e4..."}):u?(0,z.jsxs)("div",{style:Os.container,children:[(0,z.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"24px",borderBottom:"2px solid rgba(255, 255, 255, 0.1)",paddingBottom:"0",position:"relative"},children:[(0,z.jsx)("button",{onClick:()=>o&&o("parking"),style:{padding:"12px 24px",border:"none",background:"parking"===l?"rgba(0, 255, 242, 0.1)":"none",cursor:"pointer",fontSize:"17px",fontWeight:"parking"===l?"700":"500",color:"parking"===l?"#00fff2":"#94a3b8",borderBottom:"3px solid ".concat("parking"===l?"#00fff2":"transparent"),marginBottom:"-2px",borderRadius:"8px 8px 0 0",transition:"all 0.2s ease"},children:"\ub098\uc758 \uae08\uc735 \ud604\ud669"}),g&&g()&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("button",{onClick:()=>o&&o("admin"),style:{padding:"12px 24px",border:"none",background:"admin"===l?"rgba(0, 255, 242, 0.1)":"none",cursor:"pointer",fontSize:"17px",fontWeight:"admin"===l?"700":"500",color:"admin"===l?"#00fff2":"#94a3b8",borderBottom:"3px solid ".concat("admin"===l?"#00fff2":"transparent"),marginBottom:"-2px",borderRadius:"8px 8px 0 0",transition:"all 0.2s ease"},children:"\uc0c1\ud488 \uad00\ub9ac"}),(0,z.jsx)("button",{onClick:()=>{o&&o("userProducts"),d&&d()},style:{padding:"12px 24px",border:"none",background:"userProducts"===l?"rgba(0, 255, 242, 0.1)":"none",cursor:"pointer",fontSize:"17px",fontWeight:"userProducts"===l?"700":"500",color:"userProducts"===l?"#00fff2":"#94a3b8",borderBottom:"3px solid ".concat("userProducts"===l?"#00fff2":"transparent"),marginBottom:"-2px",borderRadius:"8px 8px 0 0",transition:"all 0.2s ease"},children:"\uc720\uc800 \uc0c1\ud488 \uc870\ud68c"})]})]}),N&&(0,z.jsx)("div",{style:Os.message(k),children:N}),"userProducts"===l&&g&&g()&&(0,z.jsxs)("div",{style:{backgroundColor:"rgba(20, 20, 35, 0.6)",borderRadius:"16px",padding:"32px",boxShadow:"0 6px 20px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.05)"},children:[(0,z.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"16px",color:"#fff"},children:"\uc720\uc800\ubcc4 \uac00\uc785 \uc0c1\ud488 \uc870\ud68c \ubc0f \uad00\ub9ac"}),(0,z.jsx)("p",{style:{fontSize:"14px",color:"#94a3b8",marginBottom:"20px"},children:"\ud074\ub798\uc2a4 \ub0b4 \ubaa8\ub4e0 \uc720\uc800\uc758 \uac00\uc785 \uc0c1\ud488\uc744 \uc870\ud68c\ud558\uace0 \ud544\uc694\uc2dc \uac15\uc81c \uc0ad\uc81c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),0===c.length?(0,z.jsx)("p",{style:{textAlign:"center",padding:"40px",color:"#94a3b8"},children:"\uac00\uc785\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,z.jsxs)("div",{style:{overflowX:"auto"},children:[(0,z.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,z.jsx)("thead",{children:(0,z.jsxs)("tr",{style:{backgroundColor:"rgba(255, 255, 255, 0.05)",borderBottom:"2px solid rgba(255, 255, 255, 0.1)"},children:[(0,z.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uc0ac\uc6a9\uc790"}),(0,z.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uc0c1\ud488\uba85"}),(0,z.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uc885\ub958"}),(0,z.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uc794\uc561/\uae08\uc561"}),(0,z.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uae08\ub9ac(\uc77c)"}),(0,z.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uae30\uac04(\uc77c)"}),(0,z.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\ub9cc\uae30\uc77c"}),(0,z.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uad00\ub9ac"})]})}),(0,z.jsx)("tbody",{children:c.map((e,t)=>{const s="deposit"===e.type?"\uc608\uae08":"savings"===e.type?"\uc801\uae08":"loan"===e.type?"\ub300\ucd9c":"\uae30\ud0c0";return(0,z.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255, 255, 255, 0.05)"},children:[(0,z.jsx)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:e.userName}),(0,z.jsx)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:e.name}),(0,z.jsx)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:s}),(0,z.jsxs)("td",{style:{padding:"12px",fontSize:"14px",color:"#00fff2"},children:[(0,Le.bL)(e.balance||0),"\uc6d0"]}),(0,z.jsxs)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:[e.rate,"%"]}),(0,z.jsxs)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:[e.termInDays,"\uc77c"]}),(0,z.jsx)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:e.maturityDate?new Date(e.maturityDate).toLocaleDateString("ko-KR"):"-"}),(0,z.jsx)("td",{style:{padding:"12px"},children:(0,z.jsx)("button",{onClick:()=>m&&m(e),style:(0,r.A)((0,r.A)({},Os.button(!1,"danger")),{},{fontSize:"12px",padding:"6px 12px"}),children:"\uc0ad\uc81c"})})]},"".concat(e.userId,"-").concat(e.id,"-").concat(t))})})]}),(0,z.jsxs)("div",{style:{marginTop:"20px",textAlign:"right",color:"#94a3b8",fontSize:"14px"},children:["\ucd1d ",c.length,"\uac1c\uc758 \uc0c1\ud488"]})]})]}),"parking"===l&&(0,z.jsxs)("div",{style:Os.grid,children:[(0,z.jsx)(Us,{balance:S,dailyInterest:I,onDeposit:async e=>{const t=parseFloat(e);if(isNaN(t)||t<=0)return B("\uc720\ud6a8\ud55c \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694.","error");j(!0);const s=S,a=P;A(e=>e+t);try{if(!await f(t,"\ud30c\ud0b9\ud1b5\uc7a5 \uc785\uae08: ".concat(_s(t),"\uc6d0")))throw new Error("\ubcf4\uc720 \ud604\uae08 \ucc28\uac10\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");await(0,J.c4)(J.db,async e=>{const s=(0,J.H9)(J.db,"users",y,"financials","parkingAccount");(await e.get(s)).exists()?e.update(s,{balance:(0,J.GV)(t)}):e.set(s,{balance:t,lastInterestDate:(0,J.O5)()})}),B("".concat(_s(t),"\uc6d0 \uc785\uae08 \uc644\ub8cc."),"success"),(0,gs.Mx)(J.db,{classCode:null===x||void 0===x?void 0:x.classCode,userId:y,userName:(null===x||void 0===x?void 0:x.name)||"\uc0ac\uc6a9\uc790",type:gs.gI.PARKING_DEPOSIT,description:"\ud30c\ud0b9\ud1b5\uc7a5 \uc785\uae08 ".concat(_s(t),"\uc6d0"),amount:-t,metadata:{parkingBalance:S+t}}),await q()}catch(n){B("\ucc98\ub9ac \uc624\ub958: ".concat(n.message),"error"),A(s),W(a)}finally{j(!1)}},onWithdraw:async e=>{const t=parseFloat(e);if(isNaN(t)||t<=0)return B("\uc720\ud6a8\ud55c \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694.","error");j(!0);const s=S,a=P;A(e=>e-t);try{await(0,J.c4)(J.db,async e=>{var s,a;const n=(0,J.H9)(J.db,"users",y,"financials","parkingAccount");if((null!==(s=null===(a=(await e.get(n)).data())||void 0===a?void 0:a.balance)&&void 0!==s?s:0)<t)throw new Error("\ud30c\ud0b9\ud1b5\uc7a5 \uc794\uc561\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");e.update(n,{balance:(0,J.GV)(-t)})});if(!await b(t,"\ud30c\ud0b9\ud1b5\uc7a5 \ucd9c\uae08: ".concat(_s(t),"\uc6d0")))throw new Error("\ubcf4\uc720 \ud604\uae08 \ucd94\uac00\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");B("".concat(_s(t),"\uc6d0 \ucd9c\uae08 \uc644\ub8cc."),"success"),(0,gs.Mx)(J.db,{classCode:null===x||void 0===x?void 0:x.classCode,userId:y,userName:(null===x||void 0===x?void 0:x.name)||"\uc0ac\uc6a9\uc790",type:gs.gI.PARKING_WITHDRAW,description:"\ud30c\ud0b9\ud1b5\uc7a5 \ucd9c\uae08 ".concat(_s(t),"\uc6d0"),amount:t,metadata:{parkingBalance:S-t}}),await q()}catch(n){B("\ucc98\ub9ac \uc624\ub958: ".concat(n.message),"error"),A(s),W(a)}finally{j(!1)}},isProcessing:v,userCash:P}),(0,z.jsx)(Bs,{title:"\uc608\uae08",icon:Ls.deposits,subscribedProducts:T,availableProducts:s,onSubscribe:e=>U(e,"deposits"),onCancel:H,onMaturity:G,isAdmin:g(),onAdminDelete:V}),(0,z.jsx)(Bs,{title:"\uc801\uae08",icon:Ls.savings,subscribedProducts:M,availableProducts:n,onSubscribe:e=>U(e,"savings"),onCancel:H,onMaturity:G,isAdmin:g(),onAdminDelete:V}),(0,z.jsx)(Bs,{title:"\ub300\ucd9c",icon:Ls.loans,subscribedProducts:O,availableProducts:i,onSubscribe:e=>U(e,"loans"),onCancel:H,onMaturity:G,isAdmin:g(),onAdminDelete:V})]}),(0,z.jsx)(qs,{isOpen:R.isOpen,onClose:Q,product:R.product,onConfirm:async e=>{te.vF.log("--- handleSubscribe \uc2dc\uc791 ---");const t=parseFloat(e),{product:s,type:a}=R;if(te.vF.log("\uac00\uc785\ud560 \uc0c1\ud488:",s),te.vF.log("\uac00\uc785 \uc720\ud615: ".concat(a,", \uac00\uc785 \uae08\uc561: ").concat(t)),isNaN(t)||t<=0)return te.vF.error("\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \uae08\uc561:",e),B("\uc720\ud6a8\ud55c \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694.","error");if(s.minAmount&&t<s.minAmount)return te.vF.error("\ucd5c\uc18c \uac00\uc785 \uae08\uc561 \ubbf8\ub2ec: ".concat(t," < ").concat(s.minAmount)),B("\ucd5c\uc18c \uac00\uc785 \uae08\uc561\uc740 ".concat(_s(s.minAmount),"\uc6d0\uc785\ub2c8\ub2e4."),"error");if(s.maxAmount&&t>s.maxAmount)return te.vF.error("\ucd5c\ub300 \uac00\uc785 \ud55c\ub3c4 \ucd08\uacfc: ".concat(t," > ").concat(s.maxAmount)),B("\ucd5c\ub300 \uac00\uc785 \ud55c\ub3c4\ub294 ".concat(_s(s.maxAmount),"\uc6d0\uc785\ub2c8\ub2e4."),"error");j(!0),Q();const n=await Fs(null===x||void 0===x?void 0:x.classCode);if(!n)return B("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694.","error"),void j(!1);te.vF.log("\uc120\uc0dd\ub2d8 \uacc4\uc815:",n.name,n.id);const i="temp_".concat(Date.now()),l=new Date(Date.now()+24*s.termInDays*60*60*1e3),r={id:i,name:s.name,termInDays:s.termInDays,rate:s.dailyRate,balance:t,startDate:new Date,maturityDate:l,type:"deposits"===a?"deposit":"savings"===a?"savings":"loan",isOptimistic:!0};"deposit"===r.type?D(e=>[...e,r]):"savings"===r.type?F(e=>[...e,r]):"loan"===r.type&&_(e=>[...e,r]);const o="loans"===a?t:-t;W(e=>e+o);try{await(0,J.c4)(J.db,async e=>{var i,r,o,d;const c=(0,J.H9)(J.db,"users",y),m=(0,J.H9)(J.db,"users",n.id),u=await e.get(c),x=await e.get(m);if(!u.exists())throw new Error("\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!x.exists())throw new Error("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const p=null!==(i=null===(r=u.data())||void 0===r?void 0:r.cash)&&void 0!==i?i:0,h=null!==(o=null===(d=x.data())||void 0===d?void 0:d.cash)&&void 0!==o?o:0;if("loans"!==a&&p<t)throw new Error("\ubcf4\uc720 \ud604\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");if("loans"===a&&h<t)throw new Error("\uc740\ud589(\uc120\uc0dd\ub2d8)\uc5d0 \ub300\ucd9c \uac00\ub2a5\ud55c \uc790\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");const g={name:s.name,termInDays:s.termInDays,rate:s.dailyRate,balance:t,startDate:(0,J.O5)(),maturityDate:l,type:"deposits"===a?"deposit":"savings"===a?"savings":"loan",teacherId:n.id,teacherName:n.name||"\uc120\uc0dd\ub2d8"},b=(0,J.H9)((0,J.rJ)(J.db,"users",y,"products"));e.set(b,g),"loans"===a?(e.update(c,{cash:(0,J.GV)(t)}),e.update(m,{cash:(0,J.GV)(-t)})):(e.update(c,{cash:(0,J.GV)(-t)}),e.update(m,{cash:(0,J.GV)(t)}))});const e="loans"===a?"\ub300\ucd9c":"\uac00\uc785";B("".concat(s.name," ").concat(e,"\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. (\uc120\uc0dd\ub2d8 \uacc4\uc815\uacfc \uc5f0\ub3d9)"),"success");const i="deposits"===a||"savings"===a?gs.gI.DEPOSIT_CREATE:gs.gI.LOAN_CREATE;(0,gs.Mx)(J.db,{classCode:null===x||void 0===x?void 0:x.classCode,userId:y,userName:(null===x||void 0===x?void 0:x.name)||"\uc0ac\uc6a9\uc790",type:i,description:"".concat(s.name," ").concat("loans"===a?"\ub300\ucd9c":"\uac00\uc785"," (").concat(_s(t),"\uc6d0) - \uc120\uc0dd\ub2d8 \uacc4\uc815 \uc5f0\ub3d9"),amount:o,metadata:{productName:s.name,productType:a,termInDays:s.termInDays,dailyRate:s.dailyRate,maturityDate:l.toISOString(),teacherId:n.id,teacherName:n.name}}),await q(),h&&h()}catch(d){te.vF.error("\uac00\uc785 \ucc98\ub9ac \uc911 \uc624\ub958 \ubc1c\uc0dd:",d),B("\ucc98\ub9ac \uc624\ub958: ".concat(d.message),"error"),"deposit"===r.type?D(e=>e.filter(e=>e.id!==i)):"savings"===r.type?F(e=>e.filter(e=>e.id!==i)):"loan"===r.type&&_(e=>e.filter(e=>e.id!==i)),W(e=>e-o)}finally{j(!1)}},isProcessing:v})]}):(0,z.jsx)("div",{style:Os.container,children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})},Gs=e=>Array.isArray(e)?e.map(e=>({id:e.id,name:e.name,dailyRate:void 0===e.dailyRate||isNaN(e.dailyRate)?0:parseFloat(e.dailyRate),termInDays:void 0===e.termInDays||isNaN(e.termInDays)?1:parseInt(e.termInDays),minAmount:void 0===e.minAmount||isNaN(e.minAmount)?0:parseInt(e.minAmount),maxAmount:void 0===e.maxAmount||isNaN(e.maxAmount)?0:parseInt(e.maxAmount)})):(te.vF.error("convertAdminProductsToAccountFormat: \uc785\ub825\uac12\uc774 \ubc30\uc5f4\uc774 \uc544\ub2d9\ub2c8\ub2e4.",e),[]),Js=()=>{var e,t,s,l,o;const d=(0,i.As)(),c=(0,n.Zp)(),[m,u]=(0,a.useState)(null),[x,p]=(0,a.useState)(""),[h,g]=(0,a.useState)("parking"),[b,f]=(0,a.useState)(!1),[y,v]=(0,a.useState)([]),[j,N]=(0,a.useState)([]),[w,C]=(0,a.useState)([]),[S,A]=(0,a.useState)([]),I=async()=>{var e,t,s;if(null!==d&&void 0!==d&&null!==(e=d.userDoc)&&void 0!==e&&e.classCode&&(null!==(t=d.userDoc)&&void 0!==t&&t.isAdmin||"admin"===(null===(s=d.userDoc)||void 0===s?void 0:s.role))){f(!0);try{const e=(0,ee.query)((0,ee.rJ)(J.db,"users"),(0,ee.where)("classCode","==",d.userDoc.classCode)),t=await(0,ee.getDocs)(e),s={};t.forEach(e=>{s[e.id]=(0,r.A)({id:e.id,name:e.data().name||e.data().nickname||"\uc54c \uc218 \uc5c6\uc74c"},e.data())});const a=[],n=Object.keys(s).map(async e=>{const t=(0,ee.rJ)(J.db,"users",e,"products");return(await(0,ee.getDocs)(t)).docs.map(t=>{var a;const n=t.data();return(0,r.A)((0,r.A)({firestoreId:t.id,userId:e,userName:s[e].name},n),{},{maturityDate:null!==(a=n.maturityDate)&&void 0!==a&&a.toDate?n.maturityDate.toDate():n.maturityDate})})});(await Promise.all(n)).forEach(e=>{a.push(...e)}),A(a),te.vF.log("\uc720\uc800 \uc0c1\ud488 \ub85c\ub4dc \uc644\ub8cc:",a)}catch(a){te.vF.error("\uc720\uc800 \uc0c1\ud488 \ub85c\ub4dc \uc911 \uc624\ub958:",a),u("\uc720\uc800 \uc0c1\ud488 \ub85c\ub4dc \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),p("error")}finally{f(!1)}}},[E,T]=(0,a.useState)([]),[D,M]=(0,a.useState)([]),[F,O]=(0,a.useState)([]);(0,a.useEffect)(()=>{var e;d&&!d.loading&&d.user&&null!==(e=d.userDoc)&&void 0!==e&&e.classCode?(async()=>{var e;const t=null===d||void 0===d||null===(e=d.userDoc)||void 0===e?void 0:e.classCode;if(t&&"\ubbf8\uc9c0\uc815"!==t){f(!0);try{const e=await(0,J.jy)(t,!0,"Banking");e.deposits?v(e.deposits):v([]),e.savings?N(e.savings):N([]),e.loans?C(e.loans):C([])}catch(s){te.vF.error("\ubc45\ud0b9 \uc0c1\ud488 \ub85c\ub4dc \uc911 \uc624\ub958:",s),u("\ub370\uc774\ud130 \ub85c\ub529 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),p("error")}finally{f(!1)}}else te.vF.warn("[Banking] \uc720\ud6a8\ud55c \ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc5b4 \ubc45\ud0b9 \uc0c1\ud488\uc744 \ub85c\ub4dc\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.")})():!d||d.loading||d.user||(setParkingSavingsProducts([]),N([]),C([]))},[null===d||void 0===d?void 0:d.user,null===d||void 0===d?void 0:d.loading,null===d||void 0===d||null===(e=d.userDoc)||void 0===e?void 0:e.classCode]),(0,a.useEffect)(()=>{T(Gs(y)),M(Gs(j)),O(Gs(w))},[y,j,w]);const _=(e,t,s,a)=>{let n,i;switch(e){case"deposits":n=y,i=v;break;case"installments":n=j,i=N;break;case"loans":n=w,i=C;break;default:return}i(n.map((e,n)=>{if(n===t){const t=(0,r.A)({},e);if("termInDays"===s||"minAmount"===s||"maxAmount"===s){const e=parseInt(a);t[s]=isNaN(e)||e<("termInDays"===s?1:0)?"termInDays"===s?1:0:e}else if("dailyRate"===s){const e=parseFloat(a);t.dailyRate=isNaN(e)||e<0?0:e}else"name"===s&&(t[s]=a);return t}return e}))},R=async e=>{var t;if(null===d||void 0===d||null===(t=d.userDoc)||void 0===t||!t.classCode)return u("\ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc5b4 \uc800\uc7a5\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),void p("error");f(!0);try{let t,s;switch(e){case"deposits":t=y,s="deposits";break;case"installments":t=j,s="savings";break;case"loans":t=w,s="loans";break;default:return}await(0,J.OP)(d.userDoc.classCode,s,t),u("".concat("deposits"===e?"\uc608\uae08":"installments"===e?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")),p("success"),setTimeout(()=>{u(null),p("")},3e3)}catch(s){te.vF.error("".concat(e," \uc0c1\ud488 \uc800\uc7a5 \uc911 \uc624\ub958:"),s),u("\uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),p("error")}finally{f(!1)}},L=e=>{const t={id:Date.now(),name:"\uc0c8 ".concat("deposits"===e?"\uc608\uae08":"installments"===e?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488"),dailyRate:.01,termInDays:365,minAmount:"loans"===e?0:1e5,maxAmount:"loans"===e?1e6:0};switch(e){case"deposits":v([...y,t]);break;case"installments":N([...j,t]);break;case"loans":C([...w,t])}},P=async(e,t)=>{var s;if(b)return;let a,n;switch(e){case"deposits":a=y,n=v;break;case"installments":a=j,n=N;break;case"loans":a=w,n=C;break;default:return}const i=a.filter((e,s)=>s!==t);if(n(i),null!==d&&void 0!==d&&null!==(s=d.userDoc)&&void 0!==s&&s.classCode){f(!0);try{const t="deposits"===e?"deposits":"installments"===e?"savings":"loans";await(0,J.OP)(d.userDoc.classCode,t,i),u("\uc0c1\ud488\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),p("info"),setTimeout(()=>{u(null),p("")},2e3)}catch(l){te.vF.error("\uc0c1\ud488 \uc0ad\uc81c \uc911 \uc624\ub958:",l),u("\uc0ad\uc81c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),p("error"),n(a)}finally{f(!1)}}};return d.loading?(0,z.jsx)(Na,{}):(0,z.jsxs)(Vt.LN,{children:[b&&(0,z.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,z.jsx)(Na,{})}),(0,z.jsxs)("div",{className:"px-4 py-6 sm:px-6",children:[(0,z.jsx)(Vt.zY,{title:"\ud1b5\ud569 \uae08\uc735 \uad00\ub9ac",subtitle:"\uc608\uae08, \uc801\uae08, \ub300\ucd9c \uc0c1\ud488\uc744 \uad00\ub9ac\ud558\uc138\uc694",icon:k.A,backButton:(0,z.jsx)(Vt.rA,{variant:"ghost",icon:K.A,onClick:()=>c(-1),children:"\ub4a4\ub85c\uac00\uae30"})}),m&&(0,z.jsx)("div",{className:"mb-4 p-4 rounded-xl ".concat("error"===x?"bg-red-900/40 text-red-200 border border-red-800/50":"success"===x?"bg-emerald-900/40 text-emerald-200 border border-emerald-800/50":"bg-blue-900/40 text-blue-200 border border-blue-800/50"),children:m}),(0,z.jsxs)("div",{className:"admin"===h?"content-box":"",children:[("parking"===h||"userProducts"===h)&&(0,z.jsx)(Qs,{auth:d,depositProducts:E,installmentProducts:D,loanProducts:F,activeView:h,onViewChange:g,onLoadUserProducts:I,allUserProducts:S,onDeleteUserProduct:async e=>{var t,s;if(te.vF.log("\uc0ad\uc81c \uc2dc\ub3c4:",e),!(null!==(t=d.userDoc)&&void 0!==t&&t.isAdmin||"admin"===(null===(s=d.userDoc)||void 0===s?void 0:s.role)))return te.vF.log("\uad00\ub9ac\uc790 \uad8c\ud55c \uc5c6\uc74c"),void alert("\uad00\ub9ac\uc790 \uad8c\ud55c\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.");if(window.confirm("'".concat(e.userName,"'\ub2d8\uc758 '").concat(e.name,"' \uc0c1\ud488\uc744 \uac15\uc81c\ub85c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))){f(!0);try{const t=e.firestoreId||String(e.id);te.vF.log("\uc0ad\uc81c \uacbd\ub85c:","users/".concat(e.userId,"/products/").concat(t)),te.vF.log("\uc0ac\uc6a9\ud560 \ubb38\uc11c ID:",t);const s=(0,ee.H9)(J.db,"users",e.userId,"products",t);te.vF.log("\uc0ad\uc81c \uc2dc\uc791..."),await(0,ee.kd)(s),te.vF.log("\uc0ad\uc81c \uc644\ub8cc"),u("\uc0c1\ud488\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),p("success"),te.vF.log("\ubaa9\ub85d \uc0c8\ub85c\uace0\uce68 \uc2dc\uc791..."),await I(),te.vF.log("\ubaa9\ub85d \uc0c8\ub85c\uace0\uce68 \uc644\ub8cc"),setTimeout(()=>{u(null),p("")},3e3)}catch(a){te.vF.error("\uc0c1\ud488 \uc0ad\uc81c \uc911 \uc624\ub958:",a),u("\uc0ad\uc81c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(a.message)),p("error")}finally{f(!1)}}else te.vF.log("\uc0ac\uc6a9\uc790\uac00 \uc0ad\uc81c \ucde8\uc18c")},isLoading:b}),"admin"===h&&d.user&&((null===(t=d.userDoc)||void 0===t?void 0:t.isAdmin)||"admin"===(null===(s=d.userDoc)||void 0===s?void 0:s.role))&&(0,z.jsxs)("div",{children:[(0,z.jsx)("h2",{className:"admin-header",children:"\uad00\ub9ac\uc790 - \uae08\uc735 \uc0c1\ud488 \uad00\ub9ac (\uc77c \ubcf5\ub9ac \uae30\uc900)"}),(0,z.jsxs)("div",{className:"admin-section",children:[(0,z.jsx)("h3",{children:"\ud30c\ud0b9 \uc608\uae08 \uc0c1\ud488"}),(0,z.jsx)("p",{className:"admin-info-text",children:"\uc77c \uc774\uc728(%)\uacfc \uae30\uac04(\uc77c)\uc744 \uc785\ub825\ud569\ub2c8\ub2e4. \ubcc0\uacbd \ud6c4 '\uc800\uc7a5' \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694."}),(0,z.jsxs)("table",{className:"admin-table",children:[(0,z.jsx)("thead",{children:(0,z.jsxs)("tr",{children:[(0,z.jsx)("th",{style:{width:"25%"},children:"\uc0c1\ud488\uba85"}),(0,z.jsx)("th",{style:{width:"15%"},children:"\uae30\uac04(\uc77c)"}),(0,z.jsx)("th",{style:{width:"18%"},children:"\uc77c \uc774\uc728(%)"}),(0,z.jsx)("th",{style:{width:"18%"},children:"\ucd5c\uc18c\uae08\uc561(\uc6d0)"}),(0,z.jsx)("th",{style:{width:"12%"},children:"\uad00\ub9ac"})]})}),(0,z.jsx)("tbody",{children:y.map((e,t)=>(0,z.jsxs)("tr",{children:[(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"text",value:e.name||"",onChange:e=>_("deposits",t,"name",e.target.value),className:"admin-input",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"number",min:"1",value:e.termInDays||0,onChange:e=>_("deposits",t,"termInDays",e.target.value),className:"admin-input",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"number",step:"0.001",min:"0",value:e.dailyRate||0,onChange:e=>_("deposits",t,"dailyRate",e.target.value),className:"admin-input",placeholder:"\uc608: 0.01",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"number",min:"0",value:e.minAmount||0,onChange:e=>_("deposits",t,"minAmount",e.target.value),className:"admin-input",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("button",{onClick:()=>P("deposits",t),className:"admin-button-small delete-button ".concat(b?"disabled-button":""),disabled:b,children:"\uc0ad\uc81c"})})]},e.id))})]}),(0,z.jsxs)("div",{className:"admin-action-buttons",children:[(0,z.jsx)("button",{onClick:()=>L("deposits"),className:"admin-button-small add-button ".concat(b?"disabled-button":""),disabled:b,children:"\ucd94\uac00"}),(0,z.jsx)("button",{onClick:()=>R("deposits"),className:"admin-button-small save-button ".concat(b?"disabled-button":""),disabled:b,children:"\uc608\uae08 \uc0c1\ud488 \uc800\uc7a5"})]})]}),(0,z.jsxs)("div",{className:"admin-section",children:[(0,z.jsx)("h3",{children:"\ud30c\ud0b9 \uc801\uae08 \uc0c1\ud488"}),(0,z.jsx)("p",{className:"admin-info-text",children:"\uc77c \uc774\uc728(%)\uacfc \uae30\uac04(\uc77c)\uc744 \uc785\ub825\ud569\ub2c8\ub2e4. \ubcc0\uacbd \ud6c4 '\uc800\uc7a5' \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694."}),(0,z.jsxs)("table",{className:"admin-table",children:[(0,z.jsx)("thead",{children:(0,z.jsxs)("tr",{children:[(0,z.jsx)("th",{style:{width:"25%"},children:"\uc0c1\ud488\uba85"}),(0,z.jsx)("th",{style:{width:"15%"},children:"\uae30\uac04(\uc77c)"}),(0,z.jsx)("th",{style:{width:"18%"},children:"\uc77c \uc774\uc728(%)"}),(0,z.jsx)("th",{style:{width:"18%"},children:"\ucd5c\uc18c \uc6d4\ub0a9\uc785(\uc6d0)"}),(0,z.jsx)("th",{style:{width:"12%"},children:"\uad00\ub9ac"})]})}),(0,z.jsx)("tbody",{children:j.map((e,t)=>(0,z.jsxs)("tr",{children:[(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"text",value:e.name||"",onChange:e=>_("installments",t,"name",e.target.value),className:"admin-input",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"number",min:"1",value:e.termInDays||0,onChange:e=>_("installments",t,"termInDays",e.target.value),className:"admin-input",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"number",step:"0.001",min:"0",value:e.dailyRate||0,onChange:e=>_("installments",t,"dailyRate",e.target.value),className:"admin-input",placeholder:"\uc608: 0.011",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"number",min:"0",value:e.minAmount||0,onChange:e=>_("installments",t,"minAmount",e.target.value),className:"admin-input",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("button",{onClick:()=>P("installments",t),className:"admin-button-small delete-button ".concat(b?"disabled-button":""),disabled:b,children:"\uc0ad\uc81c"})})]},e.id))})]}),(0,z.jsxs)("div",{className:"admin-action-buttons",children:[(0,z.jsx)("button",{onClick:()=>L("installments"),className:"admin-button-small add-button ".concat(b?"disabled-button":""),disabled:b,children:"\ucd94\uac00"}),(0,z.jsx)("button",{onClick:()=>R("installments"),className:"admin-button-small save-button ".concat(b?"disabled-button":""),disabled:b,children:"\uc801\uae08 \uc0c1\ud488 \uc800\uc7a5"})]})]}),(0,z.jsxs)("div",{className:"admin-section",style:{borderBottom:"none"},children:[(0,z.jsx)("h3",{children:"\ud30c\ud0b9 \ub300\ucd9c \uc0c1\ud488"}),(0,z.jsx)("p",{className:"admin-info-text",children:"\uc77c \uc774\uc728(%)\uacfc \uae30\uac04(\uc77c)\uc744 \uc785\ub825\ud569\ub2c8\ub2e4. \ubcc0\uacbd \ud6c4 '\uc800\uc7a5' \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694."}),(0,z.jsxs)("table",{className:"admin-table",children:[(0,z.jsx)("thead",{children:(0,z.jsxs)("tr",{children:[(0,z.jsx)("th",{style:{width:"25%"},children:"\uc0c1\ud488\uba85"}),(0,z.jsx)("th",{style:{width:"15%"},children:"\uae30\uac04(\uc77c)"}),(0,z.jsx)("th",{style:{width:"18%"},children:"\uc77c \uc774\uc728(%)"}),(0,z.jsx)("th",{style:{width:"18%"},children:"\ucd5c\ub300 \ub300\ucd9c\uc561(\uc6d0)"}),(0,z.jsx)("th",{style:{width:"12%"},children:"\uad00\ub9ac"})]})}),(0,z.jsx)("tbody",{children:w.map((e,t)=>(0,z.jsxs)("tr",{children:[(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"text",value:e.name||"",onChange:e=>_("loans",t,"name",e.target.value),className:"admin-input",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"number",min:"1",value:e.termInDays||0,onChange:e=>_("loans",t,"termInDays",e.target.value),className:"admin-input",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"number",step:"0.001",min:"0",value:e.dailyRate||0,onChange:e=>_("loans",t,"dailyRate",e.target.value),className:"admin-input",placeholder:"\uc608: 0.05",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("input",{type:"number",min:"0",value:e.maxAmount||0,onChange:e=>_("loans",t,"maxAmount",e.target.value),className:"admin-input",disabled:b,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,z.jsx)("td",{className:"admin-td",children:(0,z.jsx)("button",{onClick:()=>P("loans",t),className:"admin-button-small delete-button ".concat(b?"disabled-button":""),disabled:b,children:"\uc0ad\uc81c"})})]},e.id))})]}),(0,z.jsxs)("div",{className:"admin-action-buttons",children:[(0,z.jsx)("button",{onClick:()=>L("loans"),className:"admin-button-small add-button ".concat(b?"disabled-button":""),disabled:b,children:"\ucd94\uac00"}),(0,z.jsx)("button",{onClick:()=>R("loans"),className:"admin-button-small save-button ".concat(b?"disabled-button":""),disabled:b,children:"\ub300\ucd9c \uc0c1\ud488 \uc800\uc7a5"})]})]})]}),"admin"===h&&!(d.user&&(null!==(l=d.userDoc)&&void 0!==l&&l.isAdmin||"admin"===(null===(o=d.userDoc)||void 0===o?void 0:o.role)))&&(0,z.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300 p-4 rounded-xl border border-yellow-200 dark:border-yellow-800",children:"\uad00\ub9ac\uc790 \uad8c\ud55c\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})]})]})]})};var Hs=s(458);function Vs(e){let{isOpen:t,onClose:s,userId:n,onSave:i}=e;const[l,o]=(0,a.useState)(Se),[d,c]=(0,a.useState)("skinTone"),[m,u]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{if(t&&n){const e=Ae(n);o(e),u(!1)}},[t,n]),!t)return null;const x=Ie(d);return(0,z.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-[2000] p-2.5",style:{backgroundColor:"rgba(0, 0, 0, 0.85)"},onClick:s,children:(0,z.jsxs)("div",{className:"rounded-2xl p-5 w-full max-w-[600px] max-h-[90vh] overflow-y-auto",style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",border:"2px solid #a78bfa40",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)"},onClick:e=>e.stopPropagation(),children:[(0,z.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,z.jsxs)("h2",{className:"m-0 text-xl font-bold flex items-center gap-2.5",style:{color:"#e8e8ff"},children:[(0,z.jsx)("span",{className:"text-2xl",children:"\ud83d\udc64"}),"\uc544\ubc14\ud0c0 \uafb8\ubbf8\uae30"]}),(0,z.jsx)("button",{onClick:s,className:"bg-transparent border-none text-2xl cursor-pointer",style:{color:"#9ca3af"},children:"\u2715"})]}),(0,z.jsx)("div",{className:"flex justify-center mb-4 p-4 rounded-2xl",style:{background:"linear-gradient(135deg, #11182750 0%, #1f293750 100%)",border:"1px solid #374151"},children:(0,z.jsxs)("div",{className:"relative",children:[(0,z.jsx)(Me,{config:l,size:150},JSON.stringify(l)),(0,z.jsx)("button",{onClick:()=>{const e={};Te.forEach(t=>{const s=Ie(t.id);if(s.length>0){const a=Math.floor(Math.random()*s.length);e[t.id]=s[a].id}}),o(e),u(!0)},className:"absolute -bottom-2.5 -right-2.5 w-10 h-10 rounded-full border-none text-xl cursor-pointer flex items-center justify-center",style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",boxShadow:"0 4px 12px rgba(245, 158, 11, 0.4)"},title:"\ub79c\ub364 \uc0dd\uc131",children:"\ud83c\udfb2"})]})}),(0,z.jsx)("div",{className:"flex gap-1.5 overflow-x-auto overflow-y-hidden pb-3 mb-3",style:{WebkitOverflowScrolling:"touch",scrollbarWidth:"thin",msOverflowStyle:"auto"},children:Te.map(e=>(0,z.jsxs)("button",{onClick:()=>c(e.id),className:"px-3 py-2 rounded-xl text-xs font-semibold cursor-pointer whitespace-nowrap flex items-center gap-1.5 transition-all min-w-fit",style:{border:d===e.id?"2px solid #a78bfa":"2px solid transparent",background:d===e.id?"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)":"#374151",color:d===e.id?"#fff":"#9ca3af"},children:[(0,z.jsx)("span",{className:"w-3.5 h-3.5 rounded-full flex-shrink-0",style:{backgroundColor:e.icon,border:"2px solid rgba(255,255,255,0.3)"}}),(0,z.jsx)("span",{children:e.name})]},e.id))}),(0,z.jsx)("div",{className:"grid gap-2 max-h-[200px] overflow-y-auto p-2 rounded-xl mb-4",style:{gridTemplateColumns:"repeat(auto-fill, minmax(70px, 1fr))",background:"#11182750"},children:x.map(e=>{const t=l[d]===e.id,s="hairstyle"===d&&!Ee(e.id,l.faceShape);return(0,z.jsxs)("button",{onClick:()=>!s&&(e=>{const t=(0,r.A)((0,r.A)({},l),{},{[d]:e});"faceShape"===d&&(Ee(l.hairstyle,e)||(t.hairstyle="short")),o(t),u(!0)})(e.id),disabled:s,className:"p-3 rounded-xl flex flex-col items-center gap-1.5 min-w-[70px] transition-all",style:{border:t?"3px solid #a78bfa":"2px solid #374151",background:t?"linear-gradient(135deg, #a78bfa20 0%, #8b5cf620 100%)":"#1f2937",cursor:s?"not-allowed":"pointer",opacity:s?.4:1},children:[e.color&&(0,z.jsx)("div",{className:"w-7 h-7 rounded-full",style:{backgroundColor:e.color,border:"2px solid rgba(255,255,255,0.3)",boxShadow:t?"0 0 10px ".concat(e.color):"none"}}),e.gradient&&(0,z.jsx)("div",{className:"w-7 h-7 rounded-full",style:{background:"linear-gradient(135deg, ".concat(e.gradient.join(", "),")"),border:"2px solid rgba(255,255,255,0.3)"}}),"faceShape"===d&&e.path&&(0,z.jsx)("div",{className:"w-9 h-9",children:(0,z.jsx)("svg",{viewBox:"0 0 100 100",width:"36",height:"36",children:(0,z.jsx)("path",{d:e.path,fill:"#F5DEB3",stroke:t?"#a78bfa":"#666",strokeWidth:"2"})})}),e.icon&&"faceShape"!==d&&(0,z.jsx)("div",{className:"w-7 h-7 flex items-center justify-center text-2xl",children:e.icon}),!e.color&&!e.gradient&&!e.path&&!e.icon&&(0,z.jsx)("div",{className:"w-7 h-7 flex items-center justify-center text-xl",style:{color:"#e8e8ff"},children:"none"===e.id?"\u274c":"\u2713"}),(0,z.jsx)("span",{className:"text-xs text-center",style:{color:t?"#a78bfa":"#9ca3af",fontWeight:t?"600":"400"},children:e.name}),s&&(0,z.jsx)("span",{className:"text-[9px]",style:{color:"#ef4444"},children:"\ube44\ud638\ud658"})]},e.id)})}),(0,z.jsxs)("div",{className:"flex gap-2.5 justify-end",children:[(0,z.jsx)("button",{onClick:()=>{o((0,r.A)({},Se)),u(!0)},className:"px-5 py-2.5 rounded-xl bg-transparent text-sm cursor-pointer",style:{border:"1px solid #374151",color:"#9ca3af"},children:"\ucd08\uae30\ud654"}),(0,z.jsx)("button",{onClick:()=>{!function(e,t){try{return localStorage.setItem("avatar_".concat(e),JSON.stringify(t)),window.dispatchEvent(new CustomEvent("avatarChanged",{detail:{userId:e,config:t}})),!0}catch(s){return!1}}(n,l),u(!1),i&&i(l),s()},disabled:!m,className:"px-6 py-2.5 rounded-xl border-none text-sm font-semibold",style:{background:m?"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)":"#374151",color:m?"#fff":"#6b7280",cursor:m?"pointer":"not-allowed",boxShadow:m?"0 4px 15px rgba(139, 92, 246, 0.4)":"none"},children:"\uc800\uc7a5\ud558\uae30"})]})]})})}function Ks(){var e;const{user:t,userDoc:s,logout:n}=(0,i.As)(),l=null===t||void 0===t?void 0:t.uid,r=(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.nickname)||(null===t||void 0===t?void 0:t.displayName)||"\uc0ac\uc6a9\uc790",[o,d]=(0,a.useState)(!1),[c,m]=(0,a.useState)(null),[u,x]=(0,a.useState)([]),[p,h]=(0,a.useState)(!1),[g,b]=(0,a.useState)(!1),[f,y]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(""),[C,S]=(0,a.useState)(""),[A,I]=(0,a.useState)(""),[E,T]=(0,a.useState)(""),[M,F]=(0,a.useState)(""),[O,_]=(0,a.useState)(""),[L,P]=(0,a.useState)(!1),[W,B]=(0,a.useState)(""),q=(Number(null===s||void 0===s?void 0:s.cash)||0)+(Number(null===s||void 0===s?void 0:s.stockValue)||0)+(Number(null===s||void 0===s?void 0:s.realEstateValue)||0)+(Number(null===s||void 0===s?void 0:s.itemValue)||0),U=Oe(q);(0,a.useEffect)(()=>{l&&(m(Ae(l)),x(ze(l)))},[l]);const Q=()=>{k(""),S(""),I(""),T(""),F(""),_(""),B(""),P(!1)},G={legendary:0,epic:1,rare:2,common:3},H=[...u].sort((e,t)=>{const s=Re(e.id),a=Re(t.id);return(G[null===s||void 0===s?void 0:s.rarity]||99)-(G[null===a||void 0===a?void 0:a.rarity]||99)}),K=H.length>0?Re(H[0].id):null;return t?(0,z.jsxs)("div",{className:"w-full min-h-full",style:{backgroundColor:"#0a0a12"},children:[(0,z.jsxs)("div",{className:"w-full max-w-4xl mx-auto px-4 md:px-6 py-6",children:[(0,z.jsx)("h1",{style:{fontSize:"28px",fontWeight:"800",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",marginBottom:"24px"},children:"\ub0b4 \ud504\ub85c\ud544"}),(0,z.jsx)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"24px",padding:"32px",marginBottom:"24px",border:"2px solid #374151",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.4)"},children:(0,z.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"24px"},children:[(0,z.jsxs)("div",{style:{position:"relative"},children:[(0,z.jsx)(Me,{config:c,size:180}),(0,z.jsx)("button",{onClick:()=>d(!0),style:{position:"absolute",bottom:"5px",right:"5px",width:"44px",height:"44px",borderRadius:"50%",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",border:"3px solid #1a1a2e",fontSize:"18px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 15px rgba(167, 139, 250, 0.4)"},title:"\uc544\ubc14\ud0c0 \uc218\uc815",children:"\u270f\ufe0f"})]}),(0,z.jsxs)("div",{style:{textAlign:"center"},children:[(0,z.jsx)("h2",{style:{fontSize:"24px",fontWeight:"700",color:"#e8e8ff",marginBottom:"8px"},children:r}),(0,z.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"8px 16px",background:"linear-gradient(135deg, ".concat(U.color,"20 0%, ").concat(U.color,"10 100%)"),border:"2px solid ".concat(U.color),borderRadius:"20px",marginBottom:"12px"},children:[(0,z.jsx)("span",{style:{fontSize:"20px"},children:U.icon}),(0,z.jsxs)("span",{style:{color:U.color,fontWeight:"700",fontSize:"14px"},children:["Lv.",U.level," ",U.title]})]}),K&&(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"8px"},children:[(0,z.jsx)("span",{style:{fontSize:"18px"},children:K.icon}),(0,z.jsx)("span",{style:{color:"legendary"===K.rarity?"#f59e0b":"epic"===K.rarity?"#a78bfa":"rare"===K.rarity?"#3b82f6":"#9ca3af",fontWeight:"600",fontSize:"13px"},children:K.name})]}),(0,z.jsx)("div",{style:{marginTop:"12px"},children:(0,z.jsx)(at,{userId:l})})]})]})}),(0,z.jsxs)("div",{style:{background:"linear-gradient(145deg, #1e1e3f 0%, #16213e 100%)",borderRadius:"20px",padding:"24px",marginBottom:"24px",border:"2px solid #374151"},children:[(0,z.jsxs)("h3",{style:{color:"#a78bfa",fontSize:"18px",fontWeight:"700",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,z.jsx)("span",{children:"\ud83d\udcca"})," \ub808\ubca8 \uc9c4\ud589\ub3c4"]}),(0,z.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,z.jsxs)("span",{style:{color:"#9ca3af",fontSize:"14px"},children:[U.icon," Lv.",U.level," ",U.title]}),(0,z.jsxs)("span",{style:{color:"#e8e8ff",fontSize:"14px",fontWeight:"600"},children:[U.progress.toFixed(1),"%"]})]}),(0,z.jsx)("div",{style:{height:"12px",background:"#374151",borderRadius:"6px",overflow:"hidden"},children:(0,z.jsx)("div",{style:{width:"".concat(U.progress,"%"),height:"100%",background:"linear-gradient(90deg, ".concat(U.color," 0%, ").concat(U.color,"99 100%)"),borderRadius:"6px",transition:"width 0.5s ease"}})}),(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px",fontSize:"12px",color:"#6b7280"},children:[(0,z.jsxs)("span",{children:["\ud604\uc7ac: ",(0,Le.bL)(q)]}),U.level<Fe.length-1&&(0,z.jsxs)("span",{children:["\ub2e4\uc74c: ",(0,Le.bL)((null===(e=Fe[U.level+1])||void 0===e?void 0:e.minAssets)||0)]})]})]})]}),(0,z.jsxs)("div",{style:{background:"linear-gradient(145deg, #1e1e3f 0%, #16213e 100%)",borderRadius:"20px",padding:"24px",marginBottom:"24px",border:"2px solid #374151"},children:[(0,z.jsxs)("h3",{style:{color:"#a78bfa",fontSize:"18px",fontWeight:"700",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,z.jsx)("span",{children:"\ud83c\udfc6"})," \ud68d\ub4dd\ud55c \uc5c5\uc801 (",u.length,"\uac1c)"]}),0===u.length?(0,z.jsx)("div",{style:{textAlign:"center",padding:"32px",color:"#6b7280"},children:"\uc544\uc9c1 \ud68d\ub4dd\ud55c \uc5c5\uc801\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,z.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"12px"},children:H.map(e=>{const t=Re(e.id);if(!t)return null;const s={legendary:{bg:"#f59e0b20",border:"#f59e0b",text:"#f59e0b"},epic:{bg:"#a78bfa20",border:"#a78bfa",text:"#a78bfa"},rare:{bg:"#3b82f620",border:"#3b82f6",text:"#3b82f6"},common:{bg:"#6b728020",border:"#6b7280",text:"#9ca3af"}},a=s[t.rarity]||s.common;return(0,z.jsxs)("div",{style:{background:a.bg,border:"2px solid ".concat(a.border),borderRadius:"12px",padding:"16px",textAlign:"center",transition:"all 0.2s"},children:[(0,z.jsx)("div",{style:{fontSize:"32px",marginBottom:"8px"},children:t.icon}),(0,z.jsx)("div",{style:{color:a.text,fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:t.name}),(0,z.jsx)("div",{style:{color:"#6b7280",fontSize:"10px"},children:new Date(e.unlockedAt).toLocaleDateString()})]},e.id)})})]}),(0,z.jsx)(nt,{}),(0,z.jsxs)("div",{style:{background:"linear-gradient(145deg, #1e1e3f 0%, #16213e 100%)",borderRadius:"20px",padding:"24px",marginBottom:"24px",border:"2px solid #374151"},children:[(0,z.jsxs)("h3",{style:{color:"#a78bfa",fontSize:"18px",fontWeight:"700",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,z.jsx)(D.A,{size:20})," \uacc4\uc815 \uc124\uc815"]}),(0,z.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,z.jsx)("div",{style:{padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",marginBottom:"8px"},children:(0,z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,z.jsx)("span",{style:{color:"#9ca3af",fontSize:"14px"},children:"\ud604\uc7ac \ud559\uae09 \ucf54\ub4dc"}),(0,z.jsx)("span",{style:{color:"#e8e8ff",fontSize:"16px",fontWeight:"600"},children:(null===s||void 0===s?void 0:s.classCode)||"\uc5c6\uc74c"})]})}),(0,z.jsxs)("button",{onClick:()=>{h(!0),B("")},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",cursor:"pointer",transition:"all 0.2s"},children:[(0,z.jsx)(X.A,{size:20,style:{color:"#a78bfa"}}),(0,z.jsx)("span",{style:{color:"#e8e8ff",fontSize:"14px",flex:1,textAlign:"left"},children:"\ub2c9\ub124\uc784 \ubcc0\uacbd"}),(0,z.jsx)(V.A,{size:18,style:{color:"#6b7280"}})]}),(0,z.jsxs)("button",{onClick:()=>{b(!0),B("")},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",cursor:"pointer",transition:"all 0.2s"},children:[(0,z.jsx)(Y.A,{size:20,style:{color:"#a78bfa"}}),(0,z.jsx)("span",{style:{color:"#e8e8ff",fontSize:"14px",flex:1,textAlign:"left"},children:"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"}),(0,z.jsx)(V.A,{size:18,style:{color:"#6b7280"}})]}),(0,z.jsxs)("button",{onClick:()=>{y(!0),B("")},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",cursor:"pointer",transition:"all 0.2s"},children:[(0,z.jsx)(w.A,{size:20,style:{color:"#a78bfa"}}),(0,z.jsx)("span",{style:{color:"#e8e8ff",fontSize:"14px",flex:1,textAlign:"left"},children:"\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd"}),(0,z.jsx)(V.A,{size:18,style:{color:"#6b7280"}})]}),(0,z.jsxs)("button",{onClick:n,style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",cursor:"pointer",transition:"all 0.2s",marginTop:"8px"},children:[(0,z.jsx)(R.A,{size:20,style:{color:"#9ca3af"}}),(0,z.jsx)("span",{style:{color:"#e8e8ff",fontSize:"14px",flex:1,textAlign:"left"},children:"\ub85c\uadf8\uc544\uc6c3"}),(0,z.jsx)(V.A,{size:18,style:{color:"#6b7280"}})]}),(0,z.jsxs)("button",{onClick:()=>{j(!0),B("")},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"rgba(239, 68, 68, 0.1)",borderRadius:"12px",border:"1px solid rgba(239, 68, 68, 0.3)",cursor:"pointer",transition:"all 0.2s"},children:[(0,z.jsx)(Z.A,{size:20,style:{color:"#ef4444"}}),(0,z.jsx)("span",{style:{color:"#ef4444",fontSize:"14px",flex:1,textAlign:"left"},children:"\uacc4\uc815 \uc0ad\uc81c"}),(0,z.jsx)(V.A,{size:18,style:{color:"#ef4444"}})]})]})]})]}),(0,z.jsx)(Vs,{isOpen:o,onClose:()=>d(!1),userId:l,onSave:e=>{m(e)}}),p&&(0,z.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{h(!1),Q()},children:(0,z.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",borderRadius:"20px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid #374151"},onClick:e=>e.stopPropagation(),children:[(0,z.jsx)("h3",{style:{color:"#e8e8ff",fontSize:"18px",fontWeight:"700",marginBottom:"20px"},children:"\ub2c9\ub124\uc784 \ubcc0\uacbd"}),(0,z.jsx)("input",{type:"text",value:N,onChange:e=>k(e.target.value),placeholder:"\uc0c8 \ub2c9\ub124\uc784 (2~10\uc790)",maxLength:10,style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"12px"}}),W&&(0,z.jsx)("p",{style:{color:"#ef4444",fontSize:"13px",marginBottom:"12px"},children:W}),(0,z.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,z.jsx)("button",{onClick:()=>{h(!1),Q()},style:{flex:1,padding:"12px",background:"#374151",border:"none",borderRadius:"10px",color:"#e8e8ff",fontSize:"14px",cursor:"pointer"},children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{if(N.trim())if(N.length<2||N.length>10)B("\ub2c9\ub124\uc784\uc740 2~10\uc790 \uc0ac\uc774\uc5ec\uc57c \ud569\ub2c8\ub2e4.");else{P(!0);try{const e=(0,ee.H9)(J.db,"users",l);await(0,ee.mZ)(e,{nickname:N.trim()}),alert("\ub2c9\ub124\uc784\uc774 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),h(!1),Q()}catch(e){B("\ub2c9\ub124\uc784 \ubcc0\uacbd\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}finally{P(!1)}}else B("\ub2c9\ub124\uc784\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:L,style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",border:"none",borderRadius:"10px",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:L?"not-allowed":"pointer",opacity:L?.7:1},children:L?"\ubcc0\uacbd \uc911...":"\ubcc0\uacbd"})]})]})}),g&&(0,z.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{b(!1),Q()},children:(0,z.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",borderRadius:"20px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid #374151"},onClick:e=>e.stopPropagation(),children:[(0,z.jsx)("h3",{style:{color:"#e8e8ff",fontSize:"18px",fontWeight:"700",marginBottom:"20px"},children:"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"}),(0,z.jsx)("input",{type:"password",value:C,onChange:e=>S(e.target.value),placeholder:"\ud604\uc7ac \ube44\ubc00\ubc88\ud638",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"10px"}}),(0,z.jsx)("input",{type:"password",value:A,onChange:e=>I(e.target.value),placeholder:"\uc0c8 \ube44\ubc00\ubc88\ud638 (6\uc790 \uc774\uc0c1)",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"10px"}}),(0,z.jsx)("input",{type:"password",value:E,onChange:e=>T(e.target.value),placeholder:"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"12px"}}),W&&(0,z.jsx)("p",{style:{color:"#ef4444",fontSize:"13px",marginBottom:"12px"},children:W}),(0,z.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,z.jsx)("button",{onClick:()=>{b(!1),Q()},style:{flex:1,padding:"12px",background:"#374151",border:"none",borderRadius:"10px",color:"#e8e8ff",fontSize:"14px",cursor:"pointer"},children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{if(C&&A&&E)if(A.length<6)B("\uc0c8 \ube44\ubc00\ubc88\ud638\ub294 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");else if(A===E){P(!0);try{const e=Hs.IX.credential(t.email,C);await(0,Hs.kZ)(t,e),await(0,Hs.f3)(t,A),alert("\ube44\ubc00\ubc88\ud638\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),b(!1),Q()}catch(e){"auth/wrong-password"===e.code?B("\ud604\uc7ac \ube44\ubc00\ubc88\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."):B("\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}finally{P(!1)}}else B("\uc0c8 \ube44\ubc00\ubc88\ud638\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");else B("\ubaa8\ub4e0 \ud544\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:L,style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",border:"none",borderRadius:"10px",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:L?"not-allowed":"pointer",opacity:L?.7:1},children:L?"\ubcc0\uacbd \uc911...":"\ubcc0\uacbd"})]})]})}),f&&(0,z.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{y(!1),Q()},children:(0,z.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",borderRadius:"20px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid #374151"},onClick:e=>e.stopPropagation(),children:[(0,z.jsx)("h3",{style:{color:"#e8e8ff",fontSize:"18px",fontWeight:"700",marginBottom:"20px"},children:"\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd"}),(0,z.jsxs)("p",{style:{color:"#9ca3af",fontSize:"13px",marginBottom:"16px"},children:["\ud604\uc7ac \ud559\uae09: ",(0,z.jsx)("span",{style:{color:"#a78bfa",fontWeight:"600"},children:(null===s||void 0===s?void 0:s.classCode)||"\uc5c6\uc74c"})]}),(0,z.jsx)("input",{type:"text",value:M,onChange:e=>F(e.target.value.toUpperCase()),placeholder:"\uc0c8 \ud559\uae09 \ucf54\ub4dc",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"12px",textTransform:"uppercase"}}),W&&(0,z.jsx)("p",{style:{color:"#ef4444",fontSize:"13px",marginBottom:"12px"},children:W}),(0,z.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,z.jsx)("button",{onClick:()=>{y(!1),Q()},style:{flex:1,padding:"12px",background:"#374151",border:"none",borderRadius:"10px",color:"#e8e8ff",fontSize:"14px",cursor:"pointer"},children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{if(M.trim()){P(!0);try{if(!await(0,J.JK)(M.trim()))return B("\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud559\uae09 \ucf54\ub4dc\uc785\ub2c8\ub2e4."),void P(!1);const e=(0,ee.H9)(J.db,"users",l);await(0,ee.mZ)(e,{classCode:M.trim()}),alert("\ud559\uae09 \ucf54\ub4dc\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),y(!1),Q()}catch(e){B("\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}finally{P(!1)}}else B("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:L,style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",border:"none",borderRadius:"10px",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:L?"not-allowed":"pointer",opacity:L?.7:1},children:L?"\ubcc0\uacbd \uc911...":"\ubcc0\uacbd"})]})]})}),v&&(0,z.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{j(!1),Q()},children:(0,z.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",borderRadius:"20px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid #ef4444"},onClick:e=>e.stopPropagation(),children:[(0,z.jsx)("h3",{style:{color:"#ef4444",fontSize:"18px",fontWeight:"700",marginBottom:"16px"},children:"\u26a0\ufe0f \uacc4\uc815 \uc0ad\uc81c"}),(0,z.jsxs)("p",{style:{color:"#9ca3af",fontSize:"13px",marginBottom:"16px",lineHeight:1.6},children:["\uacc4\uc815\uc744 \uc0ad\uc81c\ud558\uba74 \ubaa8\ub4e0 \ub370\uc774\ud130\uac00 \uc601\uad6c\uc801\uc73c\ub85c \uc0ad\uc81c\ub418\uba70 \ubcf5\uad6c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\ub824\uba74 \uc544\ub798\uc5d0 ",(0,z.jsx)("span",{style:{color:"#ef4444",fontWeight:"600"},children:"'\uacc4\uc815\uc0ad\uc81c'"}),"\ub97c \uc785\ub825\ud558\uc138\uc694."]}),(0,z.jsx)("input",{type:"text",value:O,onChange:e=>_(e.target.value),placeholder:"\uacc4\uc815\uc0ad\uc81c",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #ef4444",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"12px"}}),W&&(0,z.jsx)("p",{style:{color:"#ef4444",fontSize:"13px",marginBottom:"12px"},children:W}),(0,z.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,z.jsx)("button",{onClick:()=>{j(!1),Q()},style:{flex:1,padding:"12px",background:"#374151",border:"none",borderRadius:"10px",color:"#e8e8ff",fontSize:"14px",cursor:"pointer"},children:"\ucde8\uc18c"}),(0,z.jsx)("button",{onClick:async()=>{if("\uacc4\uc815\uc0ad\uc81c"===O){P(!0);try{const e=(0,ee.H9)(J.db,"users",l);await(0,ee.kd)(e),await(0,Hs.hG)(t),alert("\uacc4\uc815\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(e){"auth/requires-recent-login"===e.code?B("\ubcf4\uc548\uc744 \uc704\ud574 \ub2e4\uc2dc \ub85c\uadf8\uc778 \ud6c4 \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):B("\uacc4\uc815 \uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}finally{P(!1)}}else B("'\uacc4\uc815\uc0ad\uc81c'\ub97c \uc815\ud655\ud788 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:L||"\uacc4\uc815\uc0ad\uc81c"!==O,style:{flex:1,padding:"12px",background:"\uacc4\uc815\uc0ad\uc81c"===O?"#ef4444":"#374151",border:"none",borderRadius:"10px",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:L||"\uacc4\uc815\uc0ad\uc81c"!==O?"not-allowed":"pointer",opacity:L||"\uacc4\uc815\uc0ad\uc81c"!==O?.5:1},children:L?"\uc0ad\uc81c \uc911...":"\uc0ad\uc81c"})]})]})})]}):(0,z.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,z.jsx)("p",{className:"text-gray-400",children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})})}const Xs=(0,a.lazy)(()=>s.e(393).then(s.bind(s,7393))),Ys=(0,a.lazy)(()=>s.e(757).then(s.bind(s,6757))),Zs=(0,a.lazy)(()=>s.e(864).then(s.bind(s,3864))),$s=(0,a.lazy)(()=>Promise.resolve().then(s.bind(s,8164))),ea=(0,a.lazy)(()=>s.e(175).then(s.bind(s,7175))),ta=(0,a.lazy)(()=>s.e(920).then(s.bind(s,7920))),sa=(0,a.lazy)(()=>Promise.resolve().then(s.bind(s,5967))),aa=(0,a.lazy)(()=>s.e(896).then(s.bind(s,2896))),na=(0,a.lazy)(()=>s.e(716).then(s.bind(s,716))),ia=(0,a.lazy)(()=>s.e(765).then(s.bind(s,3765))),la=(0,a.lazy)(()=>s.e(813).then(s.bind(s,2813))),ra=(0,a.lazy)(()=>s.e(327).then(s.bind(s,9327))),oa=(0,a.lazy)(()=>s.e(665).then(s.bind(s,4665))),da=(0,a.lazy)(()=>s.e(610).then(s.bind(s,7610))),ca=(0,a.lazy)(()=>s.e(231).then(s.bind(s,2231))),ma=(0,a.lazy)(()=>s.e(398).then(s.bind(s,4398))),ua=(0,a.lazy)(()=>s.e(785).then(s.bind(s,5785))),xa=(0,a.lazy)(()=>s.e(613).then(s.bind(s,5613))),pa=(0,a.lazy)(()=>s.e(317).then(s.bind(s,5317))),ha=(0,a.lazy)(()=>s.e(512).then(s.bind(s,7512))),ga=(0,a.lazy)(()=>s.e(44).then(s.bind(s,8044))),ba=(0,a.lazy)(()=>s.e(5).then(s.bind(s,7005))),fa=(0,a.lazy)(()=>s.e(289).then(s.bind(s,8289))),ya=(0,a.lazy)(()=>s.e(358).then(s.bind(s,4358))),va=(0,a.lazy)(()=>s.e(510).then(s.bind(s,4510))),ja=["/learning-games/omok","/learning-games/science","/learning-games/typing","/auction","/court","/national-assembly","/music-room"],Na=e=>{let{message:t="\ub85c\ub529 \uc911..."}=e;return(0,z.jsx)(Ye.Cg,{message:t})},wa=e=>{let{children:t}=e;const{user:s,loading:a}=(0,i.As)(),l=(0,n.zy)();return a?(0,z.jsx)(Na,{}):s?t:(0,z.jsx)(n.C5,{to:"/login",state:{from:l},replace:!0})},ka=e=>{let{children:t}=e;const{user:s,userDoc:a,loading:l}=(0,i.As)(),r=(0,n.zy)();if(l)return(0,z.jsx)(Na,{});if(!s)return(0,z.jsx)(n.C5,{to:"/login",state:{from:r},replace:!0});return(null===a||void 0===a?void 0:a.isAdmin)||"admin"===(null===a||void 0===a?void 0:a.role)||(null===a||void 0===a?void 0:a.isSuperAdmin)?t:(0,z.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0})},Ca=e=>{let{children:t}=e;const{user:s,userDoc:a,loading:l}=(0,i.As)(),r=(0,n.zy)();if(l)return(0,z.jsx)(Na,{});if(!s)return(0,z.jsx)(n.C5,{to:"/login",state:{from:r},replace:!0});return(null===a||void 0===a?void 0:a.isTeacher)||(null===a||void 0===a?void 0:a.isAdmin)||(null===a||void 0===a?void 0:a.isSuperAdmin)?t:(0,z.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0})},Sa=e=>{let{children:t}=e;const{user:s,userDoc:a,loading:l}=(0,i.As)(),r=(0,n.zy)();return l?(0,z.jsx)(Na,{}):s?null!==a&&void 0!==a&&a.isSuperAdmin?t:(0,z.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0}):(0,z.jsx)(n.C5,{to:"/login",state:{from:r},replace:!0})};function Aa(){const e=(0,n.Zp)(),t=(0,n.zy)(),{user:s,userDoc:r,loading:o,logout:d}=(0,i.As)(),[c,m]=(0,a.useState)(!1),[u,x]=(0,a.useState)(!1),[p,h]=(0,a.useState)(window.innerWidth<768),[g,b]=(0,a.useState)(!1),[f,y]=(0,a.useState)(!1),{updateAvailable:v,updateServiceWorker:j,isOnline:N}=Xe();(0,a.useEffect)(()=>{if(null!==r&&void 0!==r&&r.uid&&"student"===(null===r||void 0===r?void 0:r.role)){if(et(r.uid).canClaim){const e=setTimeout(()=>{y(!0)},500);return()=>clearTimeout(e)}}},[null===r||void 0===r?void 0:r.uid,null===r||void 0===r?void 0:r.role]);const w=(0,a.useCallback)(async e=>{if(null!==r&&void 0!==r&&r.uid&&e)try{const t=(0,ee.H9)(J.db,"users",r.uid);await(0,ee.mZ)(t,{cash:(0,ee.GV)(e)}),it.Ay.invalidate("user_".concat(r.uid)),setTimeout(()=>y(!1),3e3)}catch(t){te.vF.error("\ucd9c\uc11d \ubcf4\uc0c1 \uc9c0\uae09 \uc2e4\ud328:",t)}},[null===r||void 0===r?void 0:r.uid]);(0,a.useEffect)(()=>{const e=document.createElement("link");return e.href="https://fonts.googleapis.com/css2?family=Jua&display=swap",e.rel="stylesheet",document.head.appendChild(e),()=>{document.head.contains(e)&&document.head.removeChild(e)}},[]),(0,a.useEffect)(()=>{ja.some(e=>t.pathname.startsWith(e))&&!p&&x(!0)},[t.pathname,p]),(0,a.useEffect)(()=>{const e=()=>{const e=window.innerWidth<768;h(e),e&&m(!1)};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]);const k=(0,a.useCallback)(()=>{m(e=>!e)},[]),C=(0,a.useCallback)(()=>{m(!1)},[]),S=(0,a.useCallback)(()=>{x(e=>!e)},[]);if(!o&&!s)return(0,z.jsx)(n.C5,{to:"/login",state:{from:t},replace:!0});if(o||s&&!r)return(0,z.jsx)(Na,{});if("/login"===t.pathname)return s?(0,z.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0}):(0,z.jsx)(As.default,{});if(!r.classCode)return(0,z.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:(0,z.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl p-8 max-w-sm w-full text-center",children:[(0,z.jsx)("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-4 text-3xl",children:"\u26a0\ufe0f"}),(0,z.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \ud544\uc694\ud569\ub2c8\ub2e4"}),(0,z.jsx)("p",{className:"text-gray-500 mb-6",children:"\uc120\uc0dd\ub2d8\uaed8 \ud559\uae09 \ucf54\ub4dc\ub97c \ubc1b\uc544 \uc785\ub825\ud574\uc8fc\uc138\uc694."}),(0,z.jsx)("button",{onClick:()=>d(),className:"px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-semibold transition-colors",children:"\ub85c\uadf8\uc544\uc6c3"})]})});const A=null===r||void 0===r?void 0:r.classCode;return(0,z.jsx)(l.px,{children:(0,z.jsxs)("div",{className:"min-h-screen bg-[#0a0a12] text-gray-100 font-sans selection:bg-indigo-500/30 selection:text-indigo-200 flex",children:[(0,z.jsx)(G,{isOpen:c,onClose:C,isCollapsed:u}),(0,z.jsxs)("main",{className:"flex-1 min-w-0 md:min-h-screen relative bg-[#0a0a12] overflow-visible",children:[(0,z.jsx)(Be,{toggleSidebar:k,isMobile:p,isSidebarCollapsed:u,onToggleSidebarCollapse:S}),(0,z.jsx)("div",{className:"w-full pb-20 md:pb-4",children:(0,z.jsx)(a.Suspense,{fallback:(0,z.jsx)(Na,{message:"\ud398\uc774\uc9c0 \ub85c\ub529 \uc911..."}),children:(0,z.jsxs)(n.BV,{children:[(0,z.jsx)(n.qh,{path:"/dashboard/tasks",element:(0,z.jsx)(wa,{children:(0,z.jsx)(ns,{})})}),(0,z.jsx)(n.qh,{path:"/my-assets",element:(0,z.jsx)(wa,{children:(0,z.jsx)(bs,{})})}),(0,z.jsx)(n.qh,{path:"/my-profile",element:(0,z.jsx)(wa,{children:(0,z.jsx)(Ks,{})})}),(0,z.jsx)(n.qh,{path:"/coupon-goal",element:(0,z.jsx)(wa,{children:(0,z.jsx)(va,{})})}),(0,z.jsx)(n.qh,{path:"/learning-games/omok",element:(0,z.jsx)(wa,{children:(0,z.jsx)(Xs,{})})}),(0,z.jsx)(n.qh,{path:"/learning-games/typing",element:(0,z.jsx)(wa,{children:(0,z.jsx)(Zs,{})})}),(0,z.jsx)(n.qh,{path:"/learning-games/science",element:(0,z.jsx)(wa,{children:(0,z.jsx)(Ys,{})})}),(0,z.jsx)(n.qh,{path:"/item-shop",element:(0,z.jsx)(wa,{children:(0,z.jsx)(cs,{})})}),(0,z.jsx)(n.qh,{path:"/my-items",element:(0,z.jsx)(wa,{children:(0,z.jsx)(hs,{})})}),(0,z.jsx)(n.qh,{path:"/item-market",element:(0,z.jsx)(wa,{children:(0,z.jsx)(Ss,{})})}),(0,z.jsx)(n.qh,{path:"/personal-shop",element:(0,z.jsx)(wa,{children:(0,z.jsx)(Ss,{})})}),(0,z.jsx)(n.qh,{path:"/banking",element:(0,z.jsx)(wa,{children:(0,z.jsx)(Js,{})})}),(0,z.jsx)(n.qh,{path:"/stock-trading",element:(0,z.jsx)(wa,{children:(0,z.jsx)(ma,{})})}),(0,z.jsx)(n.qh,{path:"/auction",element:(0,z.jsx)(wa,{children:(0,z.jsx)(ba,{})})}),(0,z.jsx)(n.qh,{path:"/real-estate",element:(0,z.jsx)(wa,{children:(0,z.jsx)(ua,{})})}),(0,z.jsx)(n.qh,{path:"/government",element:(0,z.jsx)(wa,{children:(0,z.jsx)(pa,{})})}),(0,z.jsx)(n.qh,{path:"/national-assembly",element:(0,z.jsx)(wa,{children:(0,z.jsx)(xa,{})})}),(0,z.jsx)(n.qh,{path:"/court",element:(0,z.jsx)(wa,{children:(0,z.jsx)(ha,{})})}),(0,z.jsx)(n.qh,{path:"/police",element:(0,z.jsx)(wa,{children:(0,z.jsx)(ga,{})})}),(0,z.jsx)(n.qh,{path:"/learning-board",element:(0,z.jsx)(wa,{children:(0,z.jsx)(ra,{})})}),(0,z.jsx)(n.qh,{path:"/learning-board/music-request",element:(0,z.jsx)(wa,{children:(0,z.jsx)(oa,{user:s})})}),(0,z.jsx)(n.qh,{path:"/music-room/:roomId",element:(0,z.jsx)(wa,{children:(0,z.jsx)(da,{user:s})})}),(0,z.jsx)(n.qh,{path:"/student-request/:roomId",element:(0,z.jsx)(ca,{})}),(0,z.jsx)(n.qh,{path:"/admin/app-settings",element:(0,z.jsx)(ka,{children:(0,z.jsx)(ns,{adminTabMode:"generalSettings"})})}),(0,z.jsx)(n.qh,{path:"/admin/task-management",element:(0,z.jsx)(ka,{children:(0,z.jsx)(ns,{adminTabMode:"taskManagement"})})}),(0,z.jsx)(n.qh,{path:"/admin/job-settings",element:(0,z.jsx)(ka,{children:(0,z.jsx)(ns,{adminTabMode:"jobSettings"})})}),(0,z.jsx)(n.qh,{path:"/admin/salary-settings",element:(0,z.jsx)(ka,{children:(0,z.jsx)(ns,{adminTabMode:"salarySettings"})})}),(0,z.jsx)(n.qh,{path:"/admin/class-members",element:(0,z.jsx)(ka,{children:(0,z.jsx)(ns,{adminTabMode:"memberManagement"})})}),(0,z.jsx)(n.qh,{path:"/admin/app-management",element:(0,z.jsx)(ka,{children:(0,z.jsx)(ns,{adminTabMode:"appManagement"})})}),(0,z.jsx)(n.qh,{path:"/admin/coupon-transfer",element:(0,z.jsx)(ka,{children:(0,z.jsx)(ya,{})})}),(0,z.jsx)(n.qh,{path:"/admin/money-transfer",element:(0,z.jsx)(ka,{children:(0,z.jsx)(fa,{})})}),(0,z.jsx)(n.qh,{path:"/admin/activity-log",element:(0,z.jsx)(ka,{children:(0,z.jsx)(sa,{})})}),(0,z.jsx)(n.qh,{path:"/admin/items",element:(0,z.jsx)(ka,{children:(0,z.jsx)($s,{})})}),(0,z.jsx)(n.qh,{path:"/admin/page",element:(0,z.jsx)(ka,{children:(0,z.jsx)(ea,{})})}),(0,z.jsx)(n.qh,{path:"/admin-panel",element:(0,z.jsx)(ka,{children:(0,z.jsx)(ta,{onClose:()=>e(-1),classCode:A})})}),(0,z.jsx)(n.qh,{path:"/admin/students",element:(0,z.jsx)(Ca,{children:(0,z.jsx)(ia,{})})}),(0,z.jsx)(n.qh,{path:"/super-admin",element:(0,z.jsx)(Sa,{children:(0,z.jsx)(la,{})})}),(0,z.jsx)(n.qh,{path:"/super-admin/*",element:(0,z.jsx)(Sa,{children:(0,z.jsx)(la,{})})}),(0,z.jsx)(n.qh,{path:"/doctor",element:(0,z.jsx)(wa,{children:(0,z.jsx)(aa,{})})}),(0,z.jsx)(n.qh,{path:"/recover-donations",element:(0,z.jsx)(wa,{children:(0,z.jsx)(na,{})})}),(0,z.jsx)(n.qh,{path:"/",element:(0,z.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0})}),(0,z.jsx)(n.qh,{path:"*",element:(0,z.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0})})]})})}),(0,z.jsx)("footer",{className:"hidden md:block py-8 text-center text-sm text-gray-400 font-medium",children:"\xa9 2025 \uc54c\ucc2c Corp. All rights reserved."})]}),(0,z.jsx)(Ue,{}),(0,z.jsx)(He,{}),v&&!g&&(0,z.jsx)(Ke,{onUpdate:j,onDismiss:()=>b(!0)}),!N&&(0,z.jsxs)("div",{className:"fixed top-0 left-0 right-0 bg-amber-500 text-white text-center py-2 text-sm font-medium z-50 flex items-center justify-center gap-2",children:[(0,z.jsx)(Ze.A,{size:16}),"\uc624\ud504\ub77c\uc778 \uc0c1\ud0dc\uc785\ub2c8\ub2e4. \uc77c\ubd80 \uae30\ub2a5\uc774 \uc81c\ud55c\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),f&&(null===r||void 0===r?void 0:r.uid)&&(0,z.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-5",style:{background:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",zIndex:9999,animation:"fadeIn 0.3s ease-out"},onClick:()=>y(!1),children:(0,z.jsxs)("div",{className:"w-full max-w-[400px]",style:{animation:"slideUp 0.3s ease-out"},onClick:e=>e.stopPropagation(),children:[(0,z.jsx)("div",{className:"text-right mb-2",children:(0,z.jsx)("button",{onClick:()=>y(!1),className:"w-8 h-8 rounded-full border-none cursor-pointer text-lg text-white flex items-center justify-center ml-auto",style:{background:"rgba(255,255,255,0.2)"},children:"\u2715"})}),(0,z.jsx)(st,{userId:r.uid,onClaim:w}),(0,z.jsx)("div",{className:"text-center mt-3 text-[13px]",style:{color:"rgba(255,255,255,0.6)"},children:"\ubc30\uacbd\uc744 \ud130\uce58\ud558\uba74 \ub2eb\ud799\ub2c8\ub2e4"})]})}),(0,z.jsx)("style",{children:"\n        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }\n        .font-jua { font-family: 'Jua', sans-serif; }\n        @keyframes slide-up {\n          from { transform: translateY(100%); opacity: 0; }\n          to { transform: translateY(0); opacity: 1; }\n        }\n        .animate-slide-up { animation: slide-up 0.3s ease-out; }\n        @keyframes spin-slow {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        .animate-spin-slow { animation: spin-slow 2s linear infinite; }\n      "})]})})}}}]);
//# sourceMappingURL=306.85fc68b7.chunk.js.map