"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[306],{262:(e,t,s)=>{s.d(t,{A:()=>n});s(5043),s(5173);var a=s(579);const n=()=>(0,a.jsxs)("div",{className:"login-warning",children:[(0,a.jsx)("h3",{children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4"}),(0,a.jsx)("p",{children:"\uc544\uc774\ud15c\uc744 \uad6c\ub9e4\ud558\uac70\ub098 \uc0ac\uc6a9\ud558\ub824\uba74 \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})]})},577:(e,t,s)=>{s.d(t,{nm:()=>l,v5:()=>n});var a=s(5043);const n={REALTIME:6e5,NORMAL:18e5,LOW:36e5,MANUAL:null};let i=[],o=!1;const l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{interval:s=n.NORMAL,enabled:l=!0,deps:r=[]}=t,[d,c]=(0,a.useState)(null),[p,u]=(0,a.useState)(!0),[m,x]=(0,a.useState)(null),h=(0,a.useRef)(null),g=(0,a.useRef)(!0),f=(0,a.useRef)(e);(0,a.useEffect)(()=>{f.current=e},[e]);const b=(0,a.useCallback)(async()=>{if(l)try{x(null);const e=await f.current();g.current&&(c(e),u(!1))}catch(e){console.error("[usePolling] \ub370\uc774\ud130 \uc870\ud68c \uc624\ub958:",e),g.current&&(x(e),u(!1))}else u(!1)},[l]),y=(0,a.useCallback)(()=>(u(!0),b()),[b]);return(0,a.useEffect)(()=>{if(g.current=!0,h.current&&(clearInterval(h.current),h.current=null),l&&s!==n.MANUAL)return i.push(b),(async()=>{if(!o&&0!==i.length){for(o=!0;i.length>0;){const e=i.shift();await e(),await new Promise(e=>setTimeout(e,100))}o=!1}})(),s&&s>0&&(h.current=setInterval(b,s)),()=>{g.current=!1,h.current&&(clearInterval(h.current),h.current=null)};u(!1)},[b,s,l,...r]),{data:d,loading:p,error:m,refetch:y}}},783:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(5043),n=s(579);const i={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},o={backgroundColor:"white",padding:"20px",borderRadius:"8px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},l=(0,a.memo)(function(e){let{showSellCouponModal:t,setShowSellCouponModal:s,currentCoupons:l=0,couponValue:r=1e3,sellAmount:d="",setSellAmount:c,SellCoupon:p}=e;const[u,m]=(0,a.useState)(!1),[x,h]=(0,a.useState)("");if(!t)return null;const g=()=>{c(""),h(""),s(!1)},f=!d||isNaN(parseInt(d))||parseInt(d)<=0||parseInt(d)>l;return(0,n.jsx)("div",{style:i,onClick:g,children:(0,n.jsxs)("div",{style:o,onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"15px",color:"#1f2937"},children:"\ucfe0\ud3f0 \ud310\ub9e4\ud558\uae30"}),(0,n.jsx)("p",{style:{marginBottom:"10px",fontSize:"14px",color:"#4b5563"},children:"\ucfe0\ud3f0\uc744 \ud310\ub9e4\ud558\uace0 \ud604\uae08\uc73c\ub85c \uad50\ud658\ud558\uc138\uc694."}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px",padding:"10px",backgroundColor:"#f9fafb",borderRadius:"6px",fontSize:"15px"},children:[(0,n.jsx)("span",{children:"\ud604\uc7ac \ubcf4\uc720 \ucfe0\ud3f0:"}),(0,n.jsx)("strong",{children:l.toLocaleString()})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px",padding:"10px",backgroundColor:"#f9fafb",borderRadius:"6px",fontSize:"15px",color:"#4f46e5"},children:[(0,n.jsx)("span",{children:"1\ucfe0\ud3f0 \ud310\ub9e4\uac00:"}),(0,n.jsxs)("strong",{children:[r.toLocaleString(),"\uc6d0"]})]}),(0,n.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=parseInt(d);if(h(""),!t||isNaN(t)||t<=0)h("\uc720\ud6a8\ud55c \ucfe0\ud3f0 \uc218\ub7c9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");else if(t>l)h("\ubcf4\uc720\ud55c \ucfe0\ud3f0\ubcf4\ub2e4 \ub9ce\uc740 \uc218\ub7c9\uc744 \ud310\ub9e4\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");else{if("function"!==typeof p)return h("\ud310\ub9e4 \ucc98\ub9ac \ud568\uc218\uac00 \uc62c\ubc14\ub974\uac8c \uc804\ub2ec\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),void console.error("SellCoupon prop is not a function:",p);m(!0);try{await p()}catch(s){console.error("\ud310\ub9e4 \ucc98\ub9ac \uc911 \uc608\uc0c1\uce58 \ubabb\ud55c \uc624\ub958:",s),h(s.message||"\ud310\ub9e4 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")}finally{m(!1)}}},children:[(0,n.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,n.jsx)("label",{htmlFor:"sellAmount",style:{display:"block",marginBottom:"5px",fontWeight:"500",color:"#374151"},children:"\ud310\ub9e4\ud560 \ucfe0\ud3f0 \uc218:"}),(0,n.jsx)("input",{id:"sellAmount",type:"number",value:d,onChange:e=>c(e.target.value),min:"1",max:l,style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",outline:"none"},disabled:u,required:!0})]}),x&&(0,n.jsx)("div",{style:{backgroundColor:"#fee2e2",border:"1px solid #fecaca",borderRadius:"6px",padding:"12px 15px",marginBottom:"15px",color:"#b91c1c",fontSize:"14px"},children:(0,n.jsxs)("p",{style:{margin:0},children:["\u26a0\ufe0f ",x]})}),(0,n.jsx)("div",{style:{marginBottom:"20px",padding:"10px 15px",backgroundColor:"#eef2ff",borderRadius:"6px",borderLeft:"4px solid #4f46e5"},children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"16px",fontWeight:"600",color:"#1f2937"},children:[(0,n.jsx)("span",{children:"\uc608\uc0c1 \uc218\ub839\uc561:"}),(0,n.jsxs)("span",{style:{color:"#4f46e5"},children:[(()=>{const e=parseInt(d);return!isNaN(e)&&e>0?e*r:0})().toLocaleString(),"\uc6d0"]})]})}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[(0,n.jsx)("button",{type:"button",onClick:g,style:{padding:"8px 16px",backgroundColor:"#f3f4f6",color:"#4b5563",border:"none",borderRadius:"6px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.2s ease"},disabled:u,children:"\ucde8\uc18c"}),(0,n.jsx)("button",{type:"submit",style:{padding:"8px 16px",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:f||u?"not-allowed":"pointer",opacity:f||u?.6:1,transition:"background-color 0.2s ease, opacity 0.2s ease"},disabled:f||u,children:u?"\ucc98\ub9ac \uc911...":"\ud310\ub9e4\ud558\uae30"})]})]})]})})})},813:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(5043),n=s(579);const i=(0,a.memo)(function(e){let{showGiftCouponModal:t,setShowGiftCouponModal:s,recipients:a,giftRecipient:i,setGiftRecipient:o,giftAmount:l,setGiftAmount:r,handleGiftCoupon:d,currentCoupons:c,userId:p}=e;if(!t)return null;const u=null!==a&&void 0!==a?a:[],m=()=>{s(!1),"function"===typeof r?r(""):console.error("setGiftAmount prop is not a function!",r),"function"===typeof o?o(""):console.error("setGiftRecipient prop is not a function!",o)};return(0,n.jsx)("div",{className:"modal-backdrop",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},onClick:m,children:(0,n.jsxs)("div",{className:"gift-coupon-modal",style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"400px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.1)"},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{style:{marginTop:0,color:"#374151"},children:"\ucfe0\ud3f0 \uc120\ubb3c\ud558\uae30"}),(0,n.jsx)("div",{style:{marginBottom:"16px",color:"#6b7280"},children:(0,n.jsxs)("p",{children:["\ud604\uc7ac \ubcf4\uc720 \ucfe0\ud3f0: ",(0,n.jsxs)("strong",{children:[c,"\uac1c"]})]})}),(0,n.jsxs)("div",{className:"form-group",style:{marginBottom:"16px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#4b5563"},children:"\ubc1b\ub294 \uc0ac\ub78c"}),(0,n.jsxs)("select",{value:i,onChange:e=>"function"===typeof o?o(e.target.value):console.error("setGiftRecipient is not a function"),style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},children:[(0,n.jsx)("option",{value:"",children:"\ubc1b\ub294 \ubd84\uc744 \uc120\ud0dd\ud558\uc138\uc694"}),u.filter(e=>e.id!==p).map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.name," (",e.id,")"]},e.id))]})]}),(0,n.jsxs)("div",{className:"form-group",style:{marginBottom:"24px"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#4b5563"},children:"\uc120\ubb3c\ud560 \ucfe0\ud3f0 \uc218\ub7c9"}),(0,n.jsx)("input",{type:"number",value:l,onChange:e=>"function"===typeof r?r(e.target.value):console.error("setGiftAmount is not a function"),placeholder:"\uc120\ubb3c\ud560 \ucfe0\ud3f0 \uc218\ub7c9\uc744 \uc785\ub825\ud558\uc138\uc694",style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},max:c,min:"1"})]}),(0,n.jsxs)("div",{className:"modal-actions",style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[(0,n.jsx)("button",{className:"cancel-button",onClick:m,style:{padding:"8px 16px",backgroundColor:"#f3f4f6",color:"#4b5563",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"\ucde8\uc18c"}),(0,n.jsx)("button",{className:"confirm-button",onClick:d,disabled:!i||!l||parseInt(l)<=0||parseInt(l)>c,style:{padding:"8px 16px",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:!i||!l||parseInt(l)<=0||parseInt(l)>c?"not-allowed":"pointer",opacity:!i||!l||parseInt(l)<=0||parseInt(l)>c?.7:1},children:"\uc120\ubb3c\ud558\uae30"})]})]})})})},3057:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(4919),n=s(5043),i=s(5016),o=s(579);const l=(0,n.memo)(function(e){var t;let{showDonationHistoryModal:s,setShowDonationHistoryModal:l,students:r=[],classCode:d,donations:c=[]}=e;const{user:p,userDoc:u}=(0,i.As)(),m=null===p||void 0===p?void 0:p.uid,x=(null===u||void 0===u?void 0:u.classCode)||d,[h,g]=(0,n.useState)([]),[f,b]=(0,n.useState)(!0),[y,j]=(0,n.useState)(null),[v,w]=(0,n.useState)(0),N={display:s?"flex":"none",position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},C={table:{width:"100%",borderCollapse:"collapse",fontSize:"14px",borderRadius:"8px",overflow:"hidden",border:"1px solid #e5e7eb"},thead:{backgroundColor:"#f3f4f6"},th:{padding:"12px 16px",textAlign:"left",fontWeight:"600",color:"#374151",borderBottom:"1px solid #d1d5db",position:"sticky",top:0,backgroundColor:"#f3f4f6",zIndex:1},td:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",color:"#4b5563"},tr:{transition:"background-color 0.2s"},emptyContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"40px 20px",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px dashed #d1d5db",textAlign:"center",color:"#6b7280"},emptyIcon:{fontSize:"36px",marginBottom:"16px",color:"#9ca3af"}};(0,n.useEffect)(()=>{if(s){(()=>{if(b(!0),j(null),g([]),w(0),console.log("[DonationHistoryModal] \ub370\uc774\ud130 \ucc98\ub9ac \uc2dc\uc791:",{userClassCode:x,studentsCount:r.length,donationsCount:c.length,students:r.map(e=>({id:e.id||e.uid,name:e.name||e.nickname,classCode:e.classCode})),donations:c}),!x)return j("\ud559\uae09 \uc815\ubcf4\ub97c \ud655\uc778\ud560 \uc218 \uc5c6\uc5b4 \uae30\ubd80 \ub0b4\uc5ed\uc744 \ucc98\ub9ac\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),void b(!1);try{const e=c||[],t=Array.isArray(r)?r:[],s={};let a=0;e.forEach(e=>{const t=Number(e.amount)||0,n=e.userId,i=e.userName||e.name||"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790";n&&(s[n]||(s[n]={amount:0,name:i}),s[n].amount+=t,i&&"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790"!==i&&(s[n].name=i)),a+=t}),w(a),console.log("[DonationHistoryModal] \uae30\ubd80 \uc9d1\uacc4:",{donationsByStudent:s,totalAmount:a,uniqueDonors:Object.keys(s).length});const n=new Set;t.forEach(e=>{const t=e.id||e.uid||e.userId;t&&n.add(t)}),Object.keys(s).forEach(e=>{n.add(e)});const i=new Map;t.forEach(e=>{const t=e.id||e.uid||e.userId,s=e.name||e.nickname||"\uc54c \uc218 \uc5c6\ub294 \ud559\uc0dd";t&&i.set(t,s)}),Object.keys(s).forEach(e=>{i.has(e)&&"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790"===s[e].name||i.set(e,s[e].name)});const o=Array.from(n).map(e=>{var t;return{id:e,name:i.get(e)||"\uc54c \uc218 \uc5c6\ub294 \ud559\uc0dd",cumulativeAmount:(null===(t=s[e])||void 0===t?void 0:t.amount)||0,isCurrentUser:m&&e===m}}).sort((e,t)=>e.name.localeCompare(t.name,"ko"));console.log("[DonationHistoryModal] \ucd5c\uc885 \ud559\uc0dd \ubaa9\ub85d:",{totalStudents:o.length,studentsWithDonations:o.filter(e=>e.cumulativeAmount>0).length,summary:o}),g(o)}catch(e){console.error("[DonationHistoryModal] \uae30\ubd80 \ub0b4\uc5ed \ucc98\ub9ac \uc911 \uc624\ub958:",e),j("\uae30\ubd80 \ub0b4\uc5ed\uc744 \ucc98\ub9ac\ud558\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{b(!1)}})()}},[s,r,m,x,c]);const k=()=>{l(!1)},S=e=>"number"!==typeof e||isNaN(e)?"0":e.toLocaleString(),A=(null===(t=h.find(e=>e.isCurrentUser))||void 0===t?void 0:t.cumulativeAmount)||0;return(0,o.jsx)("div",{style:N,onClick:k,children:(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",width:"100%",maxWidth:"600px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f9fafb"},children:[(0,o.jsxs)("h3",{style:{margin:0,fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:["\uc6b0\ub9ac \ud559\uae09 \uae30\ubd80 \ud604\ud669",x&&(0,o.jsx)("span",{style:{marginLeft:"8px",fontSize:"14px",backgroundColor:"#dbeafe",color:"#1e40af",padding:"4px 8px",borderRadius:"12px",fontWeight:"500"},children:x})]}),(0,o.jsx)("button",{onClick:k,style:{background:"none",border:"none",cursor:"pointer",fontSize:"20px",color:"#9ca3af",padding:"0",lineHeight:"1"},"aria-label":"\ub2eb\uae30",children:"\xd7"})]}),(0,o.jsxs)("div",{style:{padding:"20px",overflowY:"auto",maxHeight:"calc(85vh - 120px)"},children:[(0,o.jsxs)("div",{style:{backgroundColor:"#eef2ff",padding:"12px 15px",borderRadius:"8px",marginBottom:"20px",border:"1px solid #c7d2fe"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,o.jsx)("span",{style:{fontSize:"14px",fontWeight:"500",color:"#4338ca"},children:"\ub0b4 \ub204\uc801 \uae30\ubd80\uc561"}),(0,o.jsxs)("span",{style:{fontSize:"16px",fontWeight:"600",color:"#4f46e5"},children:[S(A)," \ucfe0\ud3f0"]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)("span",{style:{fontSize:"14px",fontWeight:"500",color:"#4338ca"},children:"\uc6b0\ub9ac \ud559\uae09 \ucd1d \uae30\ubd80\uc561"}),(0,o.jsxs)("span",{style:{fontSize:"16px",fontWeight:"600",color:"#4f46e5"},children:[S(v)," \ucfe0\ud3f0"]})]})]}),f?(0,o.jsx)("div",{style:{textAlign:"center",padding:"40px 0",color:"#6b7280"},children:"\uae30\ubd80 \ud604\ud669\uc744 \ubd88\ub7ec\uc624\ub294 \uc911..."}):y?(0,o.jsx)("div",{style:{color:"#ef4444",textAlign:"center",padding:"40px 0"},children:y}):(0,o.jsx)(o.Fragment,{children:h.length>0?(0,o.jsxs)("table",{style:C.table,children:[(0,o.jsx)("thead",{style:C.thead,children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:C.th,children:"\ud559\uc0dd \uc774\ub984"}),(0,o.jsx)("th",{style:(0,a.A)((0,a.A)({},C.th),{},{width:"150px",textAlign:"right"}),children:"\ub204\uc801 \uae30\ubd80 \ucfe0\ud3f0"})]})}),(0,o.jsx)("tbody",{children:h.map((e,t)=>(0,o.jsxs)("tr",{style:(0,a.A)((0,a.A)({},C.tr),{},{backgroundColor:e.isCurrentUser?"#e0e7ff":t%2===0?"#f9fafb":"#ffffff"}),onMouseOver:t=>{e.isCurrentUser||(t.currentTarget.style.backgroundColor="#eef2ff")},onMouseOut:s=>{e.isCurrentUser||(s.currentTarget.style.backgroundColor=t%2===0?"#f9fafb":"#ffffff")},children:[(0,o.jsxs)("td",{style:C.td,children:[e.name,e.isCurrentUser&&(0,o.jsx)("span",{style:{marginLeft:"8px",fontSize:"12px",backgroundColor:"#dbeafe",color:"#1e40af",padding:"2px 6px",borderRadius:"10px",fontWeight:"600",verticalAlign:"middle"},children:"\ub098"})]}),(0,o.jsxs)("td",{style:(0,a.A)((0,a.A)({},C.td),{},{textAlign:"right",color:e.cumulativeAmount>0?"#4f46e5":"#6b7280",fontWeight:e.cumulativeAmount>0?"600":"normal"}),children:[S(e.cumulativeAmount)," \ucfe0\ud3f0"]})]},e.id||t))})]}):(0,o.jsxs)("div",{style:C.emptyContainer,children:[(0,o.jsx)("div",{style:C.emptyIcon,children:"\ud83d\udc65"}),(0,o.jsx)("p",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"500"},children:"\ud559\uae09 \ud559\uc0dd \uc815\ubcf4\ub97c \ubd88\ub7ec\uc62c \uc218 \uc5c6\uac70\ub098 \ub4f1\ub85d\ub41c \ud559\uc0dd\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,o.jsx)("p",{style:{margin:0,fontSize:"14px"},children:"\uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc5ec \ud559\uae09 \uc124\uc815\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694."})]})})]}),(0,o.jsx)("div",{style:{padding:"16px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end"},children:(0,o.jsx)("button",{onClick:k,style:{padding:"8px 16px",backgroundColor:"#e5e7eb",color:"#374151",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",transition:"background-color 0.2s, color 0.2s"},onMouseOver:e=>{e.target.style.backgroundColor="#d1d5db",e.target.style.color="#1f2937"},onMouseOut:e=>{e.target.style.backgroundColor="#e5e7eb",e.target.style.color="#374151"},children:"\ub2eb\uae30"})})]})})})},5226:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(5043),n=s(579);const i=(0,a.memo)(function(e){let{showDonateModal:t,setShowDonateModal:s,currentCoupons:i,onDonate:o,classCode:l}=e;const[r,d]=(0,a.useState)(""),[c,p]=(0,a.useState)(""),[u,m]=(0,a.useState)(!1),x=()=>{u||(s(!1),d(""),p(""))};return t?(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:x,children:(0,n.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",width:"100%",maxWidth:"500px",overflow:"hidden"},onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f9fafb"},children:[(0,n.jsxs)("h3",{style:{margin:0,fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:["\ucfe0\ud3f0 \uae30\ubd80\ud558\uae30",l&&(0,n.jsx)("span",{style:{marginLeft:"8px",fontSize:"14px",backgroundColor:"#dbeafe",color:"#1e40af",padding:"4px 8px",borderRadius:"12px",fontWeight:"500"},children:l})]}),(0,n.jsx)("button",{onClick:x,disabled:u,style:{background:"none",border:"none",cursor:u?"not-allowed":"pointer",fontSize:"20px",color:"#9ca3af",padding:"0",lineHeight:"1"},"aria-label":"\ub2eb\uae30",children:"\xd7"})]}),(0,n.jsxs)("div",{style:{padding:"20px"},children:[(0,n.jsx)("div",{style:{marginBottom:"20px"},children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#eef2ff",padding:"12px 16px",borderRadius:"8px",border:"1px solid #c7d2fe"},children:[(0,n.jsx)("span",{style:{fontSize:"14px",fontWeight:"500",color:"#4338ca"},children:"\ud604\uc7ac \ubcf4\uc720 \ucfe0\ud3f0"}),(0,n.jsxs)("span",{style:{fontSize:"16px",fontWeight:"600",color:"#4f46e5"},children:[i.toLocaleString()," \uac1c"]})]})}),(0,n.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,n.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"6px"},children:"\uae30\ubd80\ud560 \ucfe0\ud3f0 \uc218\ub7c9"}),(0,n.jsx)("input",{type:"number",min:"1",max:i,value:r,onChange:e=>d(e.target.value),disabled:u,style:{width:"100%",padding:"12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"16px",backgroundColor:u?"#f9fafb":"white",cursor:u?"not-allowed":"text"},placeholder:"\uae30\ubd80\ud560 \ucfe0\ud3f0 \uc218\ub7c9\uc744 \uc785\ub825\ud558\uc138\uc694"})]}),(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,n.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"6px"},children:"\uae30\ubd80 \uba54\uc2dc\uc9c0 (\uc120\ud0dd\uc0ac\ud56d)"}),(0,n.jsx)("textarea",{value:c,onChange:e=>p(e.target.value),disabled:u,style:{width:"100%",padding:"12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",resize:"vertical",minHeight:"80px",backgroundColor:u?"#f9fafb":"white",cursor:u?"not-allowed":"text"},placeholder:"\uae30\ubd80\uc640 \ud568\uaed8 \uc804\ud560 \uba54\uc2dc\uc9c0\ub97c \uc785\ub825\ud558\uc138\uc694"})]}),r&&!isNaN(parseInt(r,10))&&(0,n.jsx)("div",{style:{backgroundColor:"#f0fdf4",padding:"12px 16px",borderRadius:"8px",border:"1px solid #bbf7d0",marginBottom:"20px"},children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)("span",{style:{fontSize:"14px",fontWeight:"500",color:"#15803d"},children:"\uae30\ubd80 \uc608\uc815 \ucfe0\ud3f0"}),(0,n.jsxs)("span",{style:{fontSize:"16px",fontWeight:"600",color:"#16a34a"},children:[parseInt(r,10).toLocaleString()," \uac1c"]})]})})]}),(0,n.jsxs)("div",{style:{padding:"16px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[(0,n.jsx)("button",{onClick:x,disabled:u,style:{padding:"8px 16px",backgroundColor:"#e5e7eb",color:"#374151",border:"none",borderRadius:"6px",cursor:u?"not-allowed":"pointer",fontWeight:"500",opacity:u?.6:1},children:"\ucde8\uc18c"}),(0,n.jsx)("button",{onClick:async()=>{const e=parseInt(r,10);if(isNaN(e)||e<=0)alert("\uc62c\ubc14\ub978 \ucfe0\ud3f0 \uc218\ub7c9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");else if(e>i)alert("\ubcf4\uc720 \ucfe0\ud3f0\ubcf4\ub2e4 \ub9ce\uc774 \uae30\ubd80\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");else{m(!0);try{await o(e,c)&&(d(""),p(""),s(!1))}catch(t){console.error("[DonateCouponModal] \uae30\ubd80 \ucc98\ub9ac \uc911 \uc624\ub958:",t),alert("\uae30\ubd80 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{m(!1)}}},disabled:u||!r||isNaN(parseInt(r,10))||parseInt(r,10)<=0||parseInt(r,10)>i,style:{padding:"8px 16px",backgroundColor:u||!r||isNaN(parseInt(r,10))||parseInt(r,10)<=0||parseInt(r,10)>i?"#9ca3af":"#4f46e5",color:"white",border:"none",borderRadius:"6px",cursor:u||!r||isNaN(parseInt(r,10))||parseInt(r,10)<=0||parseInt(r,10)>i?"not-allowed":"pointer",fontWeight:"500"},children:u?"\uae30\ubd80 \uc911...":"\uae30\ubd80\ud558\uae30"})]})]})}):null})},5967:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var a=s(5043),n=s(5016),i=s(4919),o=s(5010),l=s(5472);const r=e=>e||null,d=new Map,c=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return"".concat(e,"_").concat(t,"_").concat(JSON.stringify(s))},p=e=>{const t=d.get(e);if(!t)return null;return Date.now()-t.timestamp>9e5?(d.delete(e),null):t.data},u=(e,t)=>{d.set(e,{data:t,timestamp:Date.now()})},m=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{userId:s,type:a,startDate:n,endDate:d,limitCount:m=50,lastDoc:x=null}=t;try{const x=c(e,"activity_logs",t),h=p(x);if(h)return console.log("[AdminDatabaseService] \uce90\uc2dc\ub41c \ud65c\ub3d9 \ub85c\uadf8 \uc0ac\uc6a9"),h;console.log("[AdminDatabaseService] \ud65c\ub3d9 \ub85c\uadf8 \uc11c\ubc84 \uc0ac\uc774\ub4dc \ud544\ud130\ub9c1 \uc870\ud68c:",{classCode:e,userId:s,type:a,limitCount:m});const g=[(0,l.where)("classCode","==",e)];if(s&&g.push((0,l.where)("userId","==",s)),n){const e=n instanceof Date?l.Dc.fromDate(n):n;g.push((0,l.where)("timestamp",">=",e))}if(d){const e=d instanceof Date?l.Dc.fromDate(d):d;g.push((0,l.where)("timestamp","<=",e))}const f=a&&!n&&!d;f&&g.push((0,l.where)("type","==",r(a))),g.push((0,l.orderBy)("timestamp","desc")),g.push((0,l.AB)(m+1));const b=(0,l.query)((0,l.rJ)(o.db,"activity_logs"),...g),y=await(0,l.getDocs)(b);let j=[];if(y.forEach(e=>{var t;const s=e.data();j.push((0,i.A)((0,i.A)({id:e.id},s),{},{timestamp:(null===(t=s.timestamp)||void 0===t?void 0:t.toDate())||new Date}))}),a&&!f){const e=r(a);j=j.filter(t=>t.type===e)}const v=j.length>m,w=j.slice(0,m),N=w.length>0?w[w.length-1].id:null;console.log("[AdminDatabaseService] \ud65c\ub3d9 \ub85c\uadf8 \uc870\ud68c \uc644\ub8cc: ".concat(w.length,"\uac1c (\uc11c\ubc84 \ud544\ud130\ub9c1)"));const C={logs:w,hasMore:v,lastDoc:N};return u(x,C),C}catch(h){throw console.error("[AdminDatabaseService] \ud65c\ub3d9 \ub85c\uadf8 \uc870\ud68c \uc624\ub958:",h),h}};var x=s(579);const h=()=>{const{userDoc:e,allClassMembers:t}=(0,n.As)(),[s,r]=(0,a.useState)("all"),[c,p]=(0,a.useState)([]),[u,h]=(0,a.useState)(!1),[g,f]=(0,a.useState)(null),[b,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null),[w,N]=(0,a.useState)(""),[C,k]=(0,a.useState)(""),[S,A]=(0,a.useState)("all"),I=null===e||void 0===e?void 0:e.classCode,E=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(I&&"\ubbf8\uc9c0\uc815"!==I){h(!0),f(null);try{const n="all"!==S||""!==C.trim(),r={userId:"all"!==s?s:null,limitCount:n?100:10,lastDoc:e?null:a,useCache:!e},d=await m(I,r);if(0===d.logs.length&&t.length>0&&e){const e="all"!==s?[s]:t.map(e=>e.id||e.uid),a=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const{limitCount:s=100}=t;if(console.log("[AdminDatabaseService] transactions \uceec\ub809\uc158 \uc870\ud68c \uc2dc\uc791:",{userIdsCount:e.length}),0===e.length)return console.warn("[AdminDatabaseService] userIds\uac00 \ube44\uc5b4\uc788\uc74c"),[];const a=[];for(let t=0;t<e.length;t+=10)a.push(e.slice(t,t+10));const n=[];for(const e of a){let t=(0,l.query)((0,l.rJ)(o.db,"transactions"),(0,l.where)("userId","in",e),(0,l.orderBy)("timestamp","desc"),(0,l.AB)(s));(await(0,l.getDocs)(t)).forEach(e=>{var t;const s=e.data();n.push((0,i.A)((0,i.A)({id:e.id},s),{},{timestamp:(null===(t=s.timestamp)||void 0===t?void 0:t.toDate())||new Date}))})}return console.log("[AdminDatabaseService] transactions \uc870\ud68c \uc644\ub8cc: ".concat(n.length,"\uac1c")),n}catch(g){return console.error("[AdminDatabaseService] transactions \uc870\ud68c \uc624\ub958:",g),[]}}(e,{limitCount:100});a.length>0&&(d.logs=(e=>e.map(e=>{let t="CASH_INCOME",s=e.description||"\uac70\ub798";return e.description&&(e.description.includes("\ucfe0\ud3f0")&&e.description.includes("\ud68d\ub4dd")?t="COUPON_EARN":e.description.includes("\ucfe0\ud3f0")&&e.description.includes("\uc0ac\uc6a9")?t="COUPON_USE":e.description.includes("\uc544\uc774\ud15c")&&e.description.includes("\uad6c\ub9e4")?t="ITEM_PURCHASE":e.description.includes("\uc544\uc774\ud15c")&&e.description.includes("\uc0ac\uc6a9")?t="ITEM_USE":e.description.includes("\uc544\uc774\ud15c")&&(e.description.includes("\ud310\ub9e4")||e.description.includes("\ub4f1\ub85d"))?t="ITEM_SELL":e.description.includes("\uc1a1\uae08")?t=e.amount>0?"CASH_TRANSFER_RECEIVE":"CASH_TRANSFER_SEND":"expense"===e.type&&(t="CASH_EXPENSE")),{id:e.id,userId:e.userId,userName:e.userName||"\uc54c \uc218 \uc5c6\uc74c",type:t,description:s,timestamp:e.timestamp,metadata:(0,i.A)({amount:e.amount,category:e.category},e.metadata)}}))(a),d.hasMore=!1)}p(e?d.logs:e=>[...e,...d.logs]),y(d.hasMore),v(d.lastDoc)}catch(n){console.error("[AdminDatabase] \ub370\uc774\ud130 \ub85c\ub4dc \uc624\ub958:",n),f("\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{h(!1)}}else f("\ud559\uae09\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.")},[I,s,t,S,C]);(0,a.useEffect)(()=>{p([]),v(null),y(!1),E(!0,null)},[s,I]),(0,a.useEffect)(()=>{c.length>0&&(p([]),v(null),y(!1),E(!0,null))},[S,C]);const T=()=>{!u&&b&&E(!1,j)},M=e=>{if(!e)return"text-gray-600";const t=e.toString().toLowerCase();return t.includes("\ucfe0\ud3f0")&&(t.includes("\ud68d\ub4dd")||t.includes("\uc9c0\uae09"))?"text-green-600":t.includes("\ucfe0\ud3f0")&&(t.includes("\uc0ac\uc6a9")||t.includes("\ud68c\uc218"))?"text-red-600":"COUPON_EARN"===e||"COUPON_GIVE"===e||"COUPON_TRANSFER_RECEIVE"===e||"ADMIN_COUPON_GIVE"===e?"text-green-600":"COUPON_USE"===e||"COUPON_TAKE"===e||"COUPON_TRANSFER_SEND"===e||"ADMIN_COUPON_TAKE"===e?"text-red-600":t.includes("\uc544\uc774\ud15c")&&t.includes("\uad6c\ub9e4")?"text-blue-600":t.includes("\uc544\uc774\ud15c")&&t.includes("\uc0ac\uc6a9")?"text-orange-600":t.includes("\uc544\uc774\ud15c")&&(t.includes("\ud310\ub9e4")||t.includes("\ub4f1\ub85d"))?"text-purple-600":"ITEM_PURCHASE"===e||"ITEM_MARKET_BUY"===e?"text-blue-600":"ITEM_USE"===e?"text-orange-600":"ITEM_SELL"===e||"ITEM_MARKET_LIST"===e?"text-purple-600":t.includes("\uc9c0\uae09")||t.includes("\uc785\uae08")||t.includes("\uc218\uc2e0")?"text-green-600":t.includes("\ud68c\uc218")||t.includes("\ucd9c\uae08")||t.includes("\uc1a1\uae08")?"text-red-600":"ADMIN_CASH_SEND"===e||"CASH_TRANSFER_RECEIVE"===e||"CASH_DEPOSIT"===e||"\ud604\uae08 \uc785\uae08"===e?"text-green-600":"ADMIN_CASH_TAKE"===e||"CASH_TRANSFER_SEND"===e||"CASH_WITHDRAW"===e||"\ud604\uae08 \ucd9c\uae08"===e?"text-red-600":t.includes("\ub9e4\uc218")?"text-blue-600":t.includes("\ub9e4\ub3c4")?"text-indigo-600":t.includes("\uac70\ub798\uc138")||t.includes("\uc138\uae08")?"text-yellow-600":"STOCK_BUY"===e?"text-blue-600":"STOCK_SELL"===e?"text-indigo-600":"STOCK_TAX"===e||"TAX_PAYMENT"===e?"text-yellow-600":"GAME_WIN"===e?"text-green-600":"GAME_LOSE"===e?"text-red-600":"text-gray-600"},D=e=>{if(!e)return"-";return(e instanceof Date?e:new Date(e)).toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},R=c.filter(e=>{if(C){var t,s,a;const n=C.toLowerCase();if(!((null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(n))||(null===(s=e.userName)||void 0===s?void 0:s.toLowerCase().includes(n))||(null===(a=e.type)||void 0===a?void 0:a.toLowerCase().includes(n))))return!1}if("all"!==S){var n,i;const t=(null===(n=e.type)||void 0===n?void 0:n.toString())||"",s=(null===(i=e.description)||void 0===i?void 0:i.toString())||"";if("coupon"===S){if(!(["\ucfe0\ud3f0 \ud68d\ub4dd","\ucfe0\ud3f0 \uc0ac\uc6a9","\ucfe0\ud3f0 \uc9c0\uae09","\ucfe0\ud3f0 \ud68c\uc218","\ucfe0\ud3f0 \uc1a1\uae08","\ucfe0\ud3f0 \uc218\uc2e0","\ucfe0\ud3f0 \uae30\ubd80","\ucfe0\ud3f0 \ud310\ub9e4","COUPON_EARN","COUPON_USE","COUPON_GIVE","COUPON_TAKE","COUPON_TRANSFER_SEND","COUPON_TRANSFER_RECEIVE","COUPON_DONATE","COUPON_SELL"].some(e=>t===e)||t.includes("\ucfe0\ud3f0")||s.includes("\ucfe0\ud3f0")))return!1}else if("item"===S){if(!(["\uc544\uc774\ud15c \uad6c\ub9e4","\uc544\uc774\ud15c \uc0ac\uc6a9","\uc544\uc774\ud15c \ud310\ub9e4","\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d","\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4","\uc544\uc774\ud15c \ud68d\ub4dd","\uc544\uc774\ud15c \uc774\ub3d9","ITEM_PURCHASE","ITEM_USE","ITEM_SELL","ITEM_MARKET_LIST","ITEM_MARKET_BUY","ITEM_OBTAIN","ITEM_MOVE"].some(e=>t===e)||t.includes("\uc544\uc774\ud15c")||s.includes("\uc544\uc774\ud15c")))return!1}else if("cash"===S){if(!(t.includes("CASH")||t.includes("\uc1a1\uae08")||t.includes("\uc785\uae08")||t.includes("\ucd9c\uae08")||t.includes("ADMIN_CASH")||t.includes("TRANSFER")||t.includes("\ud604\uae08")))return!1}else if("stock"===S){if(!(t.includes("STOCK")||t.includes("\uc8fc\uc2dd")||t.includes("\uac70\ub798\uc138")||t.includes("TAX")))return!1}else if("game"===S){if(!(t.includes("GAME")||t.includes("\uac8c\uc784")))return!1}}return!0});return(0,x.jsxs)("div",{className:"admin-database p-6",children:[(0,x.jsxs)("div",{className:"mb-6",children:[(0,x.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"\ud559\uae09 \ub370\uc774\ud130\ubca0\uc774\uc2a4"}),(0,x.jsx)("p",{className:"text-gray-600",children:"\ud559\uae09 \ud559\uc0dd\ub4e4\uc758 \ubaa8\ub4e0 \ud65c\ub3d9 \ub0b4\uc5ed\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})]}),(0,x.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm mb-6",children:[(0,x.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,x.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\ud559\uc0dd \uc120\ud0dd"}),(0,x.jsxs)("select",{value:s,onChange:e=>r(e.target.value),className:"w-full p-2 border rounded-md",children:[(0,x.jsx)("option",{value:"all",children:"\uc804\uccb4 \ud559\uc0dd"}),t&&t.map(e=>(0,x.jsx)("option",{value:e.id||e.id,children:e.name||e.nickname||"\uc774\ub984 \uc5c6\uc74c"},e.id||e.uid))]})]}),(0,x.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\ud65c\ub3d9 \ud0c0\uc785"}),(0,x.jsxs)("select",{value:S,onChange:e=>A(e.target.value),className:"w-full p-2 border rounded-md",children:[(0,x.jsx)("option",{value:"all",children:"\uc804\uccb4 \ud65c\ub3d9"}),(0,x.jsx)("option",{value:"coupon",children:"\ucfe0\ud3f0 \uad00\ub828"}),(0,x.jsx)("option",{value:"item",children:"\uc544\uc774\ud15c \uad00\ub828"}),(0,x.jsx)("option",{value:"cash",children:"\ud604\uae08 \uad00\ub828"}),(0,x.jsx)("option",{value:"stock",children:"\uc8fc\uc2dd \uad00\ub828"}),(0,x.jsx)("option",{value:"game",children:"\uac8c\uc784 \uad00\ub828"})]})]}),(0,x.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\uac80\uc0c9"}),(0,x.jsx)("input",{type:"text",value:C,onChange:e=>k(e.target.value),placeholder:"\ud559\uc0dd\uba85, \ud65c\ub3d9 \ub0b4\uc6a9 \uac80\uc0c9...",className:"w-full p-2 border rounded-md"})]}),(0,x.jsxs)("div",{className:"flex items-end gap-2",children:[(0,x.jsx)("button",{onClick:()=>{(e=>{const t=[];d.forEach((s,a)=>{a.startsWith(e)&&t.push(a)}),t.forEach(e=>d.delete(e)),console.log("[AdminDatabaseService] ".concat(e," \ud559\uae09 \uce90\uc2dc \ucd08\uae30\ud654 \uc644\ub8cc"))})(I),p([]),v(null),y(!1),N(""),E(!0,null)},disabled:u,className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 disabled:bg-gray-300",children:"\uc0c8\ub85c\uace0\uce68"}),(0,x.jsx)("button",{onClick:async()=>{N("\uc870\ud68c \uc911...");try{let e=[];const t={},s={};c.forEach(e=>{const a=e.type||"undefined";t[a]=(t[a]||0)+1,s[a]||(s[a]={description:e.description,userName:e.userName,timestamp:e.timestamp})}),e.push("=== \ud604\uc7ac \ub85c\ub4dc\ub41c \ub370\uc774\ud130 \ud0c0\uc785 \ubd84\ud3ec ==="),e.push("\ucd1d ".concat(c.length,"\uac1c\uc758 \ub85c\uadf8")),e.push(""),Object.entries(t).sort((e,t)=>t[1]-e[1]).forEach(t=>{let[a,n]=t;e.push("".concat(a,": ").concat(n,"\uac1c")),s[a]&&e.push("  \uc608\uc2dc: ".concat(s[a].description)),(a.includes("COUPON")||a.includes("\ucfe0\ud3f0")||a.includes("ITEM")||a.includes("\uc544\uc774\ud15c"))&&e.push("  \u2b50 \ucfe0\ud3f0/\uc544\uc774\ud15c \uad00\ub828 \ud0c0\uc785 \ubc1c\uacac!")}),e.push(""),e.push("=== \ud544\ud130\ubcc4 \ub9e4\uce6d \uacb0\uacfc ===");const a={coupon:e=>{var t,s;const a=(null===(t=e.type)||void 0===t?void 0:t.toString())||"",n=(null===(s=e.description)||void 0===s?void 0:s.toString())||"";return["\ucfe0\ud3f0 \ud68d\ub4dd","\ucfe0\ud3f0 \uc0ac\uc6a9","\ucfe0\ud3f0 \uc9c0\uae09","\ucfe0\ud3f0 \ud68c\uc218","\ucfe0\ud3f0 \uc1a1\uae08","\ucfe0\ud3f0 \uc218\uc2e0","\ucfe0\ud3f0 \uae30\ubd80","\ucfe0\ud3f0 \ud310\ub9e4","COUPON_EARN","COUPON_USE","COUPON_GIVE","COUPON_TAKE","COUPON_TRANSFER_SEND","COUPON_TRANSFER_RECEIVE","COUPON_DONATE","COUPON_SELL"].some(e=>a===e)||a.includes("\ucfe0\ud3f0")||n.includes("\ucfe0\ud3f0")},item:e=>{var t,s;const a=(null===(t=e.type)||void 0===t?void 0:t.toString())||"",n=(null===(s=e.description)||void 0===s?void 0:s.toString())||"";return["\uc544\uc774\ud15c \uad6c\ub9e4","\uc544\uc774\ud15c \uc0ac\uc6a9","\uc544\uc774\ud15c \ud310\ub9e4","\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d","\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4","\uc544\uc774\ud15c \ud68d\ub4dd","\uc544\uc774\ud15c \uc774\ub3d9","ITEM_PURCHASE","ITEM_USE","ITEM_SELL","ITEM_MARKET_LIST","ITEM_MARKET_BUY","ITEM_OBTAIN","ITEM_MOVE"].some(e=>a===e)||a.includes("\uc544\uc774\ud15c")||n.includes("\uc544\uc774\ud15c")},cash:e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("CASH")||s.includes("\uc1a1\uae08")||s.includes("\uc785\uae08")||s.includes("\ucd9c\uae08")||s.includes("ADMIN_CASH")||s.includes("TRANSFER")||s.includes("\ud604\uae08")},stock:e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("STOCK")||s.includes("\uc8fc\uc2dd")||s.includes("\uac70\ub798\uc138")||s.includes("TAX")},game:e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("GAME")||s.includes("\uac8c\uc784")}};Object.entries(a).forEach(t=>{let[s,a]=t;const n=c.filter(e=>a(e));e.push("".concat(s,": ").concat(n.length,"\uac1c"));const i=new Set(n.map(e=>e.type));i.size>0&&e.push("  \ub9e4\uce6d\ub41c \ud0c0\uc785: ".concat(Array.from(i).join(", ")))});const n=e.join("\n");N(n)}catch(g){console.error("[AdminDatabase DEBUG] \uc624\ub958:",g),N("\uc624\ub958: ".concat(g.message))}},className:"px-4 py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600",children:"\ub514\ubc84\uadf8"})]})]}),w&&(0,x.jsxs)("div",{className:"mt-4 p-4 bg-gray-100 rounded-md",children:[(0,x.jsx)("h4",{className:"font-semibold mb-2",children:"\ub514\ubc84\uadf8 \uc815\ubcf4:"}),(0,x.jsx)("pre",{className:"text-xs whitespace-pre-wrap",children:w})]})]}),c.length>0&&(()=>{const e=c.filter(e=>{var t,s;const a=(null===(t=e.type)||void 0===t?void 0:t.toString())||"",n=(null===(s=e.description)||void 0===s?void 0:s.toString())||"";return["\ucfe0\ud3f0 \ud68d\ub4dd","\ucfe0\ud3f0 \uc0ac\uc6a9","\ucfe0\ud3f0 \uc9c0\uae09","\ucfe0\ud3f0 \ud68c\uc218","\ucfe0\ud3f0 \uc1a1\uae08","\ucfe0\ud3f0 \uc218\uc2e0","\ucfe0\ud3f0 \uae30\ubd80","\ucfe0\ud3f0 \ud310\ub9e4","COUPON_EARN","COUPON_USE","COUPON_GIVE","COUPON_TAKE","COUPON_TRANSFER_SEND","COUPON_TRANSFER_RECEIVE","COUPON_DONATE","COUPON_SELL"].some(e=>a===e)||a.includes("\ucfe0\ud3f0")||n.includes("\ucfe0\ud3f0")}).length,t=c.filter(e=>{var t,s;const a=(null===(t=e.type)||void 0===t?void 0:t.toString())||"",n=(null===(s=e.description)||void 0===s?void 0:s.toString())||"";return["\uc544\uc774\ud15c \uad6c\ub9e4","\uc544\uc774\ud15c \uc0ac\uc6a9","\uc544\uc774\ud15c \ud310\ub9e4","\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d","\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4","\uc544\uc774\ud15c \ud68d\ub4dd","\uc544\uc774\ud15c \uc774\ub3d9","ITEM_PURCHASE","ITEM_USE","ITEM_SELL","ITEM_MARKET_LIST","ITEM_MARKET_BUY","ITEM_OBTAIN","ITEM_MOVE"].some(e=>a===e)||a.includes("\uc544\uc774\ud15c")||n.includes("\uc544\uc774\ud15c")}).length,s=c.filter(e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("CASH")||s.includes("\uc1a1\uae08")||s.includes("\uc785\uae08")||s.includes("\ucd9c\uae08")||s.includes("ADMIN_CASH")||s.includes("TRANSFER")}).length,a=c.filter(e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("STOCK")||s.includes("\uc8fc\uc2dd")||s.includes("\uac70\ub798\uc138")||s.includes("TAX")}).length,n=c.filter(e=>{var t;const s=(null===(t=e.type)||void 0===t?void 0:t.toString())||"";return s.includes("GAME")||s.includes("\uac8c\uc784")}).length;return(0,x.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm mb-6",children:[(0,x.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"\ud65c\ub3d9 \ud1b5\uacc4 (\ud074\ub9ad\ud558\uc5ec \ud544\ud130)"}),(0,x.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,x.jsxs)("div",{className:"bg-blue-50 p-3 rounded cursor-pointer hover:shadow-md transition-shadow",onClick:()=>A("all"),children:[(0,x.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\uc804\uccb4 \ud65c\ub3d9"}),(0,x.jsx)("div",{className:"text-xl font-bold text-blue-600",children:c.length})]}),(0,x.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(e>0?"bg-green-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>e>0&&A("coupon"),title:0===e?"\uc544\uc9c1 \ucfe0\ud3f0 \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \ucfe0\ud3f0 \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,x.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\ucfe0\ud3f0 \uad00\ub828"}),(0,x.jsx)("div",{className:"text-xl font-bold ".concat(e>0?"text-green-600":"text-gray-400"),children:e})]}),(0,x.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(t>0?"bg-purple-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>t>0&&A("item"),title:0===t?"\uc544\uc9c1 \uc544\uc774\ud15c \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \uc544\uc774\ud15c \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,x.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\uc544\uc774\ud15c \uad00\ub828"}),(0,x.jsx)("div",{className:"text-xl font-bold ".concat(t>0?"text-purple-600":"text-gray-400"),children:t})]}),(0,x.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(s>0?"bg-yellow-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>s>0&&A("cash"),title:0===s?"\uc544\uc9c1 \ud604\uae08 \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \ud604\uae08 \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,x.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\ud604\uae08 \uad00\ub828"}),(0,x.jsx)("div",{className:"text-xl font-bold ".concat(s>0?"text-yellow-600":"text-gray-400"),children:s})]}),(0,x.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(a>0?"bg-indigo-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>a>0&&A("stock"),title:0===a?"\uc544\uc9c1 \uc8fc\uc2dd \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \uc8fc\uc2dd \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,x.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\uc8fc\uc2dd \uad00\ub828"}),(0,x.jsx)("div",{className:"text-xl font-bold ".concat(a>0?"text-indigo-600":"text-gray-400"),children:a})]}),(0,x.jsxs)("div",{className:"p-3 rounded transition-shadow ".concat(n>0?"bg-red-50 cursor-pointer hover:shadow-md":"bg-gray-100 cursor-not-allowed opacity-50"),onClick:()=>n>0&&A("game"),title:0===n?"\uc544\uc9c1 \uac8c\uc784 \uad00\ub828 \ud65c\ub3d9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud074\ub9ad\ud558\uc5ec \uac8c\uc784 \uad00\ub828 \ud65c\ub3d9\ub9cc \ubcf4\uae30",children:[(0,x.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"\uac8c\uc784 \uad00\ub828"}),(0,x.jsx)("div",{className:"text-xl font-bold ".concat(n>0?"text-red-600":"text-gray-400"),children:n})]})]})]})})(),(0,x.jsxs)("div",{className:"mb-6",children:[(0,x.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"\uc804\uccb4 \ud65c\ub3d9 \ub0b4\uc5ed"}),(0,x.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"\uc2dc\uac04\uc21c\uc73c\ub85c \uc815\ub82c\ub41c \ubaa8\ub4e0 \ud65c\ub3d9\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})]}),g&&(0,x.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:g}),u&&0===c.length&&(0,x.jsxs)("div",{className:"text-center py-12",children:[(0,x.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,x.jsx)("p",{className:"mt-4 text-gray-600",children:"\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})]}),!u||c.length>0?(0,x.jsx)("div",{children:0===R.length?(0,x.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,x.jsx)("p",{className:"text-lg mb-2",children:C?"\uac80\uc0c9 \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.":"\ud65c\ub3d9 \ub0b4\uc5ed\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,x.jsxs)("p",{className:"text-sm",children:["\uc804\uccb4 \ub370\uc774\ud130: ",c.length,"\uac1c"]})]}):(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"text-sm text-gray-600 mb-4",children:["\ucd1d ",R.length,"\uac1c\uc758 \ud65c\ub3d9 (\uac80\uc0c9: ",c.length,"\uac1c \uc911)"]}),R.map((e,t)=>{return(0,x.jsx)("div",{className:"bg-white border-2 border-gray-300 rounded-lg p-4 hover:shadow-lg transition-shadow",children:(0,x.jsx)("div",{className:"flex justify-between items-start",children:(0,x.jsxs)("div",{className:"flex-1",children:[(0,x.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,x.jsx)("span",{className:"font-bold text-base ".concat(M(e.type)),children:(s=e.type,{"\ucfe0\ud3f0 \ud68d\ub4dd":"\ucfe0\ud3f0 \ud68d\ub4dd","\ucfe0\ud3f0 \uc0ac\uc6a9":"\ucfe0\ud3f0 \uc0ac\uc6a9","\ucfe0\ud3f0 \uc9c0\uae09":"\ucfe0\ud3f0 \uc9c0\uae09","\ucfe0\ud3f0 \ud68c\uc218":"\ucfe0\ud3f0 \ud68c\uc218","\uc544\uc774\ud15c \uad6c\ub9e4":"\uc544\uc774\ud15c \uad6c\ub9e4","\uc544\uc774\ud15c \uc0ac\uc6a9":"\uc544\uc774\ud15c \uc0ac\uc6a9","\uc544\uc774\ud15c \ud310\ub9e4":"\uc544\uc774\ud15c \ud310\ub9e4","\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d":"\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d","\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4":"\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4","\uc8fc\uc2dd \ub9e4\uc218":"\uc8fc\uc2dd \ub9e4\uc218","\uc8fc\uc2dd \ub9e4\ub3c4":"\uc8fc\uc2dd \ub9e4\ub3c4","\uc8fc\uc2dd \uac70\ub798\uc138":"\uc8fc\uc2dd \uac70\ub798\uc138","\uac70\ub798\uc138":"\uc8fc\uc2dd \uac70\ub798\uc138","\uc1a1\uae08":"\uc1a1\uae08","\uc1a1\uae08 \uc218\uc2e0":"\uc1a1\uae08 \uc218\uc2e0","\ub3c8 \uc1a1\uae08":"\uc1a1\uae08","\ub3c8 \ucd9c\uae08":"\ucd9c\uae08","\ub3c8 \uc785\uae08":"\uc785\uae08","\ud604\uae08 \ucd9c\uae08":"\ucd9c\uae08","\ud604\uae08 \uc785\uae08":"\uc785\uae08",COUPON_EARN:"\ucfe0\ud3f0 \ud68d\ub4dd",COUPON_USE:"\ucfe0\ud3f0 \uc0ac\uc6a9",COUPON_GIVE:"\ucfe0\ud3f0 \uc9c0\uae09",COUPON_TAKE:"\ucfe0\ud3f0 \ud68c\uc218",COUPON_TRANSFER_SEND:"\ucfe0\ud3f0 \uc1a1\uae08",COUPON_TRANSFER_RECEIVE:"\ucfe0\ud3f0 \uc218\uc2e0",ITEM_PURCHASE:"\uc544\uc774\ud15c \uad6c\ub9e4",ITEM_USE:"\uc544\uc774\ud15c \uc0ac\uc6a9",ITEM_SELL:"\uc544\uc774\ud15c \ud310\ub9e4",ITEM_MARKET_LIST:"\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d",ITEM_MARKET_BUY:"\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4",CASH_TRANSFER_SEND:"\uc1a1\uae08",CASH_TRANSFER_RECEIVE:"\uc1a1\uae08 \uc218\uc2e0",CASH_WITHDRAW:"\ucd9c\uae08",CASH_DEPOSIT:"\uc785\uae08",STOCK_BUY:"\uc8fc\uc2dd \ub9e4\uc218",STOCK_SELL:"\uc8fc\uc2dd \ub9e4\ub3c4",STOCK_TAX:"\uc8fc\uc2dd \uac70\ub798\uc138",TAX_PAYMENT:"\uc8fc\uc2dd \uac70\ub798\uc138",ADMIN_CASH_SEND:"\uad00\ub9ac\uc790 \uc9c0\uae09",ADMIN_CASH_TAKE:"\uad00\ub9ac\uc790 \ud68c\uc218",ADMIN_COUPON_GIVE:"\uad00\ub9ac\uc790 \ucfe0\ud3f0 \uc9c0\uae09",ADMIN_COUPON_TAKE:"\uad00\ub9ac\uc790 \ucfe0\ud3f0 \ud68c\uc218",TASK_COMPLETE:"\uacfc\uc81c \uc644\ub8cc",GAME_WIN:"\uac8c\uc784 \uc2b9\ub9ac",GAME_LOSE:"\uac8c\uc784 \ud328\ubc30"}[s]||s)}),(0,x.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.userName||"\uc54c \uc218 \uc5c6\uc74c"}),(0,x.jsx)("span",{className:"text-xs text-gray-500",children:D(e.timestamp)})]}),(0,x.jsx)("p",{className:"text-gray-800 text-sm mb-2 font-medium",children:e.description||"\uc124\uba85 \uc5c6\uc74c"}),e.metadata&&Object.keys(e.metadata).length>0&&(0,x.jsxs)("div",{className:"bg-gray-50 p-3 rounded text-sm text-gray-700 border border-gray-200",children:[e.metadata.activity&&(0,x.jsxs)("div",{className:"mb-1",children:[(0,x.jsx)("strong",{children:"\ud65c\ub3d9:"})," ",e.metadata.activity]}),e.metadata.reason&&(0,x.jsxs)("div",{className:"mb-1",children:[(0,x.jsx)("strong",{children:"\uc0ac\uc720:"})," ",e.metadata.reason]}),e.metadata.itemName&&(0,x.jsxs)("div",{className:"mb-1",children:[(0,x.jsx)("strong",{children:"\uc544\uc774\ud15c:"})," ",e.metadata.itemName]}),e.metadata.quantity&&(0,x.jsxs)("div",{className:"mb-1",children:[(0,x.jsx)("strong",{children:"\uc218\ub7c9:"})," ",e.metadata.quantity]}),void 0!==e.metadata.amount&&(0,x.jsxs)("div",{className:"mb-1",children:[(0,x.jsx)("strong",{children:"\uae08\uc561:"})," ",e.metadata.amount.toLocaleString(),"\uc6d0"]}),void 0!==e.metadata.couponAmount&&(0,x.jsxs)("div",{className:"mb-1",children:[(0,x.jsx)("strong",{children:"\ucfe0\ud3f0:"})," ",e.metadata.couponAmount,"\uac1c"]})]})]})})},e.id||t);var s}),b&&(0,x.jsx)("div",{className:"text-center py-4",children:(0,x.jsx)("button",{onClick:T,disabled:u,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300",children:u?"\ub85c\ub529 \uc911...":"\ub354\ubcf4\uae30"})})]})}):null]})}},6353:()=>{},6555:(e,t,s)=>{s.d(t,{Gu:()=>l,LN:()=>i,pp:()=>r,rA:()=>d,zY:()=>o});s(5043);var a=s(2024),n=(s(5881),s(579));const i=e=>{let{children:t,className:s=""}=e;return(0,n.jsx)("div",{className:"min-h-full w-full bg-[#0a0a12] ".concat(s),children:(0,n.jsx)("div",{className:"w-full max-w-none px-2 md:px-3 lg:px-4 py-1 md:py-2",children:t})})},o=e=>{let{title:t,subtitle:s,icon:a,badge:i,action:o,backButton:l,className:r=""}=e;return(0,n.jsxs)("section",{className:"bg-[#14142380] backdrop-blur-sm rounded-lg px-3 py-1.5 md:px-4 md:py-2 shadow-lg border border-cyan-900/30 flex flex-col md:flex-row md:items-center justify-between gap-1.5 md:gap-2 mb-2 md:mb-3 ".concat(r),children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[l,a&&(0,n.jsx)("div",{className:"w-9 h-9 md:w-10 md:h-10 bg-cyan-900/30 rounded-lg flex items-center justify-center text-cyan-400 shrink-0 shadow-sm border border-cyan-500/30",children:(0,n.jsx)(a,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("h2",{className:"text-lg md:text-xl font-bold text-white tracking-tight",children:t}),i]}),s&&(0,n.jsx)("p",{className:"text-xs md:text-sm text-slate-400 font-medium",children:s})]})]}),o&&(0,n.jsx)("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 md:ml-auto",children:o})]})},l=e=>{let{message:t="\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."}=e;return null},r=e=>{let{icon:t,title:s,description:a,action:i}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[t&&(0,n.jsx)("div",{className:"w-16 h-16 rounded-full bg-[#14142380] shadow-lg flex items-center justify-center mb-4 border border-cyan-900/30",children:(0,n.jsx)(t,{className:"w-8 h-8 text-slate-400"})}),s&&(0,n.jsx)("h3",{className:"text-lg font-bold text-slate-300 mb-2",children:s}),a&&(0,n.jsx)("p",{className:"text-slate-500 font-medium mb-6 max-w-md",children:a}),i]})},d=e=>{let{children:t,icon:s,variant:i="primary",size:o="md",loading:l=!1,disabled:r=!1,onClick:d,className:c="",title:p}=e;return(0,n.jsxs)("button",{onClick:d,disabled:r||l,title:p,className:"inline-flex items-center justify-center gap-2 font-bold rounded-xl transition-all duration-200 active:scale-95 whitespace-nowrap focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ".concat({primary:"bg-cyan-500 text-slate-900 hover:bg-cyan-400 ring-1 ring-cyan-400 shadow-cyan-500/30",secondary:"bg-slate-800 hover:bg-slate-700 text-slate-200",outline:"bg-transparent text-slate-300 ring-1 ring-slate-600 hover:bg-slate-800 hover:ring-slate-500 shadow-sm","outline-green":"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm","outline-red":"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm",danger:"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm",success:"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm",ghost:"text-slate-400 hover:bg-slate-800 hover:text-white",indigo:"bg-purple-900/30 text-purple-400 hover:bg-purple-900/50"}[i]," ").concat({sm:"px-4 py-2 text-sm",md:"px-5 py-2.5 text-sm",lg:"px-6 py-3 text-base"}[o]," ").concat(c),children:[l?(0,n.jsx)(a.A,{className:"w-4 h-4 animate-spin"}):s?(0,n.jsx)(s,{className:"w-4 h-4"}):null,t]})}},8164:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var a=s(4919),n=s(5043),i=s(579);const o={"\uc74c\uc2dd":["\ud83c\udf55","\ud83c\udf54","\ud83c\udf5f","\ud83c\udf2d","\ud83e\udd50","\ud83e\udd56","\ud83e\uddc0","\ud83c\udf56","\ud83c\udf57","\ud83e\udd53","\ud83c\udf73","\ud83e\udd5e"],"\uc74c\ub8cc":["\u2615","\ud83c\udf75","\ud83e\uddc3","\ud83e\udd64","\ud83e\uddcb","\ud83c\udf7a","\ud83c\udf77","\ud83e\udd5b","\ud83c\udf79","\ud83c\udf78","\ud83c\udf7e","\ud83e\uddc9"],"\uacfc\uc77c":["\ud83c\udf4e","\ud83c\udf4a","\ud83c\udf4b","\ud83c\udf4c","\ud83c\udf49","\ud83c\udf47","\ud83c\udf53","\ud83e\uded0","\ud83c\udf48","\ud83c\udf52","\ud83c\udf51","\ud83e\udd6d"],"\ucc44\uc18c":["\ud83e\udd66","\ud83e\udd6c","\ud83e\udd52","\ud83c\udf3d","\ud83e\udd55","\ud83e\uded1","\ud83c\udf36\ufe0f","\ud83e\udd54","\ud83c\udf60","\ud83e\uddc4","\ud83e\uddc5","\ud83c\udf44"],"\ub514\uc800\ud2b8":["\ud83c\udf70","\ud83c\udf82","\ud83e\uddc1","\ud83e\udd67","\ud83c\udf6e","\ud83c\udf6d","\ud83c\udf6c","\ud83c\udf6b","\ud83c\udf69","\ud83c\udf6a","\ud83c\udf66","\ud83e\uddca"],"\ubb34\uae30":["\u2694\ufe0f","\ud83d\udde1\ufe0f","\ud83c\udff9","\ud83d\udee1\ufe0f","\ud83e\ude93","\ud83d\udd2b","\ud83d\udca3","\ud83e\udde8","\ud83e\ude83","\ud83e\udd4a","\ud83c\udfaf","\ud83c\udfcf"],"\ub9c8\ubc95":["\u2728","\ud83d\udcab","\u2b50","\ud83c\udf1f","\ud83d\udca5","\u26a1","\ud83d\udd25","\u2744\ufe0f","\ud83d\udca7","\ud83c\udf0a","\ud83c\udf2a\ufe0f","\u2604\ufe0f"],"\ubcf4\ubb3c":["\ud83d\udc8e","\ud83d\udc8d","\ud83d\udc51","\ud83c\udfc6","\ud83c\udf81","\ud83d\udcb0","\ud83d\udcb5","\ud83e\ude99","\ud83d\udd2e","\ud83d\udcff","\ud83d\udddd\ufe0f","\ud83c\udf96\ufe0f"],"\ub3c4\uad6c":["\ud83d\udd28","\ud83e\ude9b","\ud83d\udd27","\ud83e\ude9a","\u26cf\ufe0f","\ud83e\ude9d","\ud83e\uddf2","\ud83d\udd29","\u2699\ufe0f","\ud83d\udddc\ufe0f","\u2696\ufe0f","\ud83d\udd26"],"\uc758\ub8cc":["\ud83d\udc8a","\ud83d\udc89","\ud83e\ude79","\ud83e\ude7a","\ud83e\uddea","\ud83e\uddeb","\ud83e\ude78","\ud83e\udda0","\ud83e\uddec","\ud83d\udd2c","\u2697\ufe0f","\ud83c\udf21\ufe0f"],"\uc790\uc5f0":["\ud83c\udf38","\ud83c\udf3a","\ud83c\udf3b","\ud83c\udf39","\ud83c\udf37","\ud83c\udf31","\ud83c\udf3f","\ud83c\udf40","\ud83c\udf8b","\ud83c\udf8d","\ud83c\udf3e","\ud83c\udf34"],"\ud2b9\ubcc4":["\ud83c\udfaa","\ud83c\udfa8","\ud83c\udfad","\ud83c\udfaa","\ud83c\udfaf","\ud83c\udfb2","\ud83c\udfb0","\ud83e\udde9","\ud83e\ude84","\ud83d\udd14","\ud83d\udcef","\ud83e\udd41"],"\uc2e0\uaddc":["\ud83c\udd95","\u2705","\u274c","\u2753","\u2757","\ud83d\udcaf","\ud83d\udd36","\ud83d\udd37","\ud83d\udd38","\ud83d\udd39","\u2660\ufe0f","\u2663\ufe0f"]},l={container:{padding:"20px",maxWidth:"1000px",margin:"0 auto",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},card:{backgroundColor:"#ffffff",borderRadius:"16px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",padding:"30px",marginBottom:"20px"},header:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"30px",borderRadius:"16px 16px 0 0",marginBottom:"0"},title:{fontSize:"28px",fontWeight:"bold",marginBottom:"8px"},subtitle:{opacity:"0.9",fontSize:"14px"},tabs:{display:"flex",borderBottom:"2px solid #e5e7eb",backgroundColor:"#f9fafb",marginTop:"-4px"},tab:{flex:1,padding:"16px",backgroundColor:"transparent",border:"none",fontSize:"16px",fontWeight:"600",color:"#6b7280",cursor:"pointer",transition:"all 0.3s ease",borderBottom:"3px solid transparent"},activeTab:{color:"#667eea",backgroundColor:"white",borderBottom:"3px solid #667eea"},disabledTab:{opacity:"0.5",cursor:"not-allowed"},formSection:{backgroundColor:"#f9fafb",padding:"20px",borderRadius:"12px",marginBottom:"20px"},formTitle:{fontSize:"20px",fontWeight:"700",color:"#374151",marginBottom:"20px"},inputGroup:{marginBottom:"20px"},label:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},input:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",transition:"border-color 0.3s ease",boxSizing:"border-box"},textarea:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",minHeight:"100px",resize:"vertical",boxSizing:"border-box"},gridTwo:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"20px"},iconSelector:{backgroundColor:"white",padding:"20px",borderRadius:"12px",border:"2px solid #e5e7eb"},selectedIcon:{fontSize:"48px",width:"80px",height:"80px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",borderRadius:"12px",marginBottom:"16px"},button:{padding:"12px 24px",borderRadius:"8px",border:"none",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease"},primaryButton:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},secondaryButton:{backgroundColor:"white",color:"#374151",border:"2px solid #e5e7eb"},iconGrid:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"8px",marginTop:"16px"},iconButton:{fontSize:"28px",padding:"8px",border:"2px solid transparent",borderRadius:"8px",backgroundColor:"#f9fafb",cursor:"pointer",transition:"all 0.2s ease"},categoryButtons:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"16px"},categoryButton:{padding:"8px 16px",borderRadius:"8px",border:"2px solid #e5e7eb",backgroundColor:"white",fontSize:"13px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},activeCategoryButton:{backgroundColor:"#667eea",color:"white",borderColor:"#667eea"},priceIncreaseSection:{backgroundColor:"#fef3c7",border:"2px solid #fcd34d",padding:"20px",borderRadius:"12px",marginBottom:"20px"},helpText:{fontSize:"13px",color:"#6b7280",marginTop:"8px",lineHeight:"1.5"},checkboxWrapper:{display:"flex",alignItems:"center",gap:"12px"},checkbox:{width:"20px",height:"20px",cursor:"pointer"},buttonGroup:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"30px",paddingTop:"20px",borderTop:"2px solid #e5e7eb"}},r=e=>{let{classCode:t,editingItemFromStore:s,onAddItem:r,onUpdateItem:d,onClose:c}=e;const[p,u]=(0,n.useState)("addItem"),[m,x]=(0,n.useState)(!1),[h,g]=(0,n.useState)("\ub9c8\ubc95"),[f,b]=(0,n.useState)({name:"",description:"",price:"",stock:"",initialStock:"",icon:"\u2728",available:!0,priceIncreasePercentage:"10"});(0,n.useEffect)(()=>{s?(b((0,a.A)((0,a.A)({},s),{},{priceIncreasePercentage:s.priceIncreasePercentage||"10"})),u("editItem")):b({name:"",description:"",price:"",stock:"",initialStock:"",icon:"\u2728",available:!0,priceIncreasePercentage:"10"})},[s]);const y=e=>{const{name:t,value:s,type:n,checked:i}=e.target;b(e=>(0,a.A)((0,a.A)({},e),{},{[t]:"checkbox"===n?i:s}))},j=e=>{u(e),s&&c(),"addItem"===e&&b({name:"",description:"",price:"",stock:"",initialStock:"",icon:"\u2728",available:!0,priceIncreasePercentage:"10"})};return(0,i.jsx)("div",{style:l.container,children:(0,i.jsxs)("div",{style:l.card,children:[(0,i.jsxs)("div",{style:l.header,children:[(0,i.jsx)("h2",{style:l.title,children:"\ud83c\udfea \uc0c1\uc810 \uad00\ub9ac \uc2dc\uc2a4\ud15c"}),(0,i.jsx)("p",{style:l.subtitle,children:"\uc544\uc774\ud15c\uc744 \ucd94\uac00\ud558\uace0 \uad00\ub9ac\ud558\uc138\uc694"})]}),(0,i.jsxs)("div",{style:l.tabs,children:[(0,i.jsx)("button",{style:(0,a.A)((0,a.A)({},l.tab),"addItem"===p?l.activeTab:{}),onClick:()=>j("addItem"),children:"\u2795 \uc544\uc774\ud15c \ucd94\uac00"}),(0,i.jsx)("button",{style:(0,a.A)((0,a.A)((0,a.A)({},l.tab),"editItem"===p?l.activeTab:{}),s?{}:l.disabledTab),disabled:!s,onClick:()=>u("editItem"),children:"\u270f\ufe0f \uc544\uc774\ud15c \uc218\uc815"})]}),(0,i.jsx)("div",{style:{padding:"30px"},children:("addItem"===p||"editItem"===p)&&(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const s=!(!f||!f.id);if(!f.name||!f.price||!f.stock||isNaN(f.price)||isNaN(f.stock)||parseInt(f.price,10)<0||parseInt(f.stock,10)<0)return void alert("\uc0c1\ud488\uba85, \uac00\uaca9, \uc7ac\uace0\ub97c \uc62c\ubc14\ub974\uac8c (0 \uc774\uc0c1 \uc22b\uc790) \uc785\ub825\ud574\uc8fc\uc138\uc694.");const n=(0,a.A)((0,a.A)({},f),{},{price:parseInt(f.price,10),stock:parseInt(f.stock,10),initialStock:f.initialStock?parseInt(f.initialStock,10):parseInt(f.stock,10),priceIncreasePercentage:parseFloat(f.priceIncreasePercentage)||0,classCode:t});let i=!1;i=s?await d(n):await r(n),i&&(s||(b({name:"",description:"",price:"",stock:"",initialStock:"",icon:"\u2728",available:!0,priceIncreasePercentage:"10"}),u("addItem")))},children:[(0,i.jsxs)("div",{style:l.formSection,children:[(0,i.jsx)("h3",{style:l.formTitle,children:"editItem"===p?"\uc544\uc774\ud15c \uc815\ubcf4 \uc218\uc815":"\uc0c8 \uc544\uc774\ud15c \ub9cc\ub4e4\uae30"}),(0,i.jsxs)("div",{style:l.iconSelector,children:[(0,i.jsx)("label",{style:l.label,children:"\uc544\uc774\ud15c \uc544\uc774\ucf58"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,i.jsx)("div",{style:l.selectedIcon,children:f.icon}),(0,i.jsx)("button",{type:"button",onClick:()=>x(!m),style:(0,a.A)((0,a.A)({},l.button),l.primaryButton),children:"\uc544\uc774\ucf58 \uc120\ud0dd"})]}),m&&(0,i.jsxs)("div",{style:{marginTop:"20px",padding:"16px",backgroundColor:"#f9fafb",borderRadius:"8px",width:"100%",boxSizing:"border-box",maxHeight:"400px",overflowY:"auto"},children:[(0,i.jsx)("div",{style:l.categoryButtons,children:Object.keys(o).map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>g(e),style:(0,a.A)((0,a.A)({},l.categoryButton),h===e?l.activeCategoryButton:{}),children:e},e))}),(0,i.jsx)("div",{style:l.iconGrid,children:o[h].map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{b(t=>(0,a.A)((0,a.A)({},t),{},{icon:e})),x(!1)})(e),style:l.iconButton,onMouseEnter:e=>{e.target.style.backgroundColor="#e5e7eb",e.target.style.transform="scale(1.1)"},onMouseLeave:e=>{e.target.style.backgroundColor="#f9fafb",e.target.style.transform="scale(1)"},children:e},e))})]})]}),(0,i.jsxs)("div",{style:l.gridTwo,children:[(0,i.jsxs)("div",{style:l.inputGroup,children:[(0,i.jsxs)("label",{style:l.label,children:["\uc0c1\ud488\uba85 ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("input",{name:"name",value:f.name,onChange:y,placeholder:"\uc608: \ub9c8\ubc95\uc758 \ubb3c\uc57d",required:!0,style:l.input})]}),(0,i.jsxs)("div",{style:l.inputGroup,children:[(0,i.jsxs)("label",{style:l.label,children:["\uae30\ubcf8 \uac00\uaca9 (\uc6d0) ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("input",{name:"price",type:"number",value:f.price,onChange:y,placeholder:"\uc608: 1000",required:!0,min:"0",style:l.input})]}),(0,i.jsxs)("div",{style:l.inputGroup,children:[(0,i.jsxs)("label",{style:l.label,children:["\ud604\uc7ac \uc7ac\uace0 ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("input",{name:"stock",type:"number",value:f.stock,onChange:y,placeholder:"\uc608: 10",required:!0,min:"0",style:l.input})]}),(0,i.jsxs)("div",{style:l.inputGroup,children:[(0,i.jsx)("label",{style:l.label,children:"\ucd08\uae30 \uc7ac\uace0 (\uc790\ub3d9 \ubcf4\ucda9 \uae30\uc900)"}),(0,i.jsx)("input",{name:"initialStock",type:"number",value:f.initialStock,onChange:y,placeholder:"\ubbf8\uc785\ub825\uc2dc \ud604\uc7ac \uc7ac\uace0\uc640 \ub3d9\uc77c",min:"0",style:l.input})]})]}),(0,i.jsxs)("div",{style:l.priceIncreaseSection,children:[(0,i.jsx)("label",{style:l.label,children:"\uc790\ub3d9 \uc7ac\uace0 \ubcf4\ucda9 \uc2dc \uac00\uaca9 \uc0c1\uc2b9\ub960 (%)"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,i.jsx)("input",{name:"priceIncreasePercentage",type:"number",value:f.priceIncreasePercentage,onChange:y,placeholder:"10",min:"0",max:"100",step:"0.5",style:(0,a.A)((0,a.A)({},l.input),{},{width:"120px"})}),(0,i.jsx)("span",{style:{fontSize:"16px",color:"#374151"},children:"%"})]}),(0,i.jsxs)("p",{style:l.helpText,children:["\ud83d\udca1 \uc7ac\uace0\uac00 0\uc774 \ub418\uc5b4 \uc790\ub3d9\uc73c\ub85c \ucd08\uae30 \uc7ac\uace0\ub9cc\ud07c \ubcf4\ucda9\ub420 \ub54c\ub9c8\ub2e4 \uac00\uaca9\uc774 \uc124\uc815\ud55c \ube44\uc728\ub9cc\ud07c \uc0c1\uc2b9\ud569\ub2c8\ub2e4.",(0,i.jsx)("br",{}),"\uc608: 10% \uc124\uc815 \uc2dc, 1000\uc6d0 \u2192 1100\uc6d0 \u2192 1210\uc6d0 \uc21c\uc73c\ub85c \uc0c1\uc2b9"]})]}),(0,i.jsxs)("div",{style:l.inputGroup,children:[(0,i.jsx)("label",{style:l.label,children:"\uc0c1\ud488 \uc124\uba85"}),(0,i.jsx)("textarea",{name:"description",value:f.description,onChange:y,placeholder:"\uc544\uc774\ud15c\uc5d0 \ub300\ud55c \uc790\uc138\ud55c \uc124\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",style:l.textarea})]})]}),(0,i.jsxs)("div",{style:l.buttonGroup,children:[(0,i.jsxs)("div",{style:l.checkboxWrapper,children:[(0,i.jsx)("input",{type:"checkbox",name:"available",checked:f.available,onChange:y,style:l.checkbox}),(0,i.jsx)("label",{style:{fontSize:"16px",fontWeight:"500"},children:f.available?"\ud83d\udfe2 \ud310\ub9e4\uc911":"\ud83d\udd34 \ud310\ub9e4\uc911\uc9c0"})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px"},children:["editItem"===p&&(0,i.jsx)("button",{type:"button",onClick:()=>j("addItem"),style:(0,a.A)((0,a.A)({},l.button),l.secondaryButton),children:"\ucde8\uc18c"}),(0,i.jsx)("button",{type:"submit",style:(0,a.A)((0,a.A)({},l.button),l.primaryButton),children:"editItem"===p?"\u2705 \uc218\uc815 \uc644\ub8cc":"\u2795 \uc544\uc774\ud15c \ucd94\uac00"})]})]})]})})]})})}},8343:(e,t,s)=>{s.d(t,{FR:()=>a,bL:()=>n});const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(null===e||void 0===e||""===e)return"0"+t;let s=e;if("string"===typeof s&&(s=s.replace(/[,\uc6d0\uac1c]/g,"").trim(),s=parseFloat(s),isNaN(s)))return"0"+t;if(0===s)return"0"+t;const a=s<0,n=[{value:1e20,name:"\ub2e8"},{value:1e16,name:"\uacbd"},{value:1e12,name:"\uc870"},{value:1e8,name:"\uc5b5"},{value:1e4,name:"\ub9cc"}],i=[];let o=Math.abs(s);for(const{value:r,name:d}of n)if(o>=r){const e=Math.floor(o/r);i.push("".concat(e).concat(d)),o%=r}o>0&&(o%1!==0?i.push(o.toLocaleString("ko-KR",{maximumFractionDigits:2})):i.push(Math.floor(o)));let l=i.join(" ");return t&&(l+=t),a&&(l="-"+l),l},n=e=>a(e,"\uc6d0")},8719:(e,t,s)=>{s.d(t,{px:()=>u,wB:()=>p});var a=s(4919),n=s(5043),i=s(5016),o=s(5010),l=s(577),r=s(9270),d=s(579);const c=(0,n.createContext)(null),p=()=>{const e=(0,n.useContext)(c);return e||(console.warn("useItems: ItemContext \ubc94\uc704 \ubc16\uc5d0\uc11c \uc0ac\uc6a9\ub428"),{items:[],userItems:[],marketListings:[],marketOffers:[],loading:!0,error:null,addItem:async()=>({success:!1,message:"Context not available"}),purchaseItem:async()=>({success:!1,message:"Context not available"}),updateItem:async()=>({success:!1,message:"Context not available"}),deleteItem:async()=>({success:!1,message:"Context not available"}),useItem:async()=>({success:!1,message:"Context not available"}),updateUserItemQuantity:async()=>({success:!1,message:"Context not available"}),listItemForSale:async()=>({success:!1,message:"Context not available"}),buyMarketItem:async()=>({success:!1,message:"Context not available"}),cancelSale:async()=>({success:!1,message:"Context not available"}),makeOffer:async()=>({success:!1,message:"Context not available"}),respondToOffer:async()=>({success:!1,message:"Context not available"}),adminCancelSale:async()=>({success:!1,message:"Context not available"}),adminDeleteItem:async()=>({success:!1,message:"Context not available"}),refreshData:async()=>{}})},u=e=>{let{children:t}=e;const{user:s,userDoc:p,isAdmin:u,loading:m,deductCash:x,addCash:h,optimisticUpdate:g}=(0,i.As)()||{},f=null===s||void 0===s?void 0:s.uid,b=null===p||void 0===p?void 0:p.classCode,[y,j]=(0,n.useState)([]),[v,w]=(0,n.useState)([]),[N,C]=(0,n.useState)([]),[k,S]=(0,n.useState)([]),[A,I]=(0,n.useState)(!0),[E,T]=(0,n.useState)(null),M=m||A,D=(0,n.useMemo)(()=>(0,o.Qg)(o.Cn,"getItemContextData"),[]),R=(0,n.useMemo)(()=>({addStoreItem:(0,o.Qg)(o.Cn,"addStoreItem"),updateStoreItem:(0,o.Qg)(o.Cn,"updateStoreItem"),deleteStoreItem:(0,o.Qg)(o.Cn,"deleteStoreItem"),purchaseStoreItem:(0,o.Qg)(o.Cn,"purchaseStoreItem"),useUserItem:(0,o.Qg)(o.Cn,"useUserItem"),updateUserItemQuantity:(0,o.Qg)(o.Cn,"updateUserItemQuantity"),listUserItemForSale:(0,o.Qg)(o.Cn,"listUserItemForSale"),buyMarketItem:(0,o.Qg)(o.Cn,"buyMarketItem"),cancelMarketSale:(0,o.Qg)(o.Cn,"cancelMarketSale"),makeOffer:(0,o.Qg)(o.Cn,"makeOffer"),respondToOffer:(0,o.Qg)(o.Cn,"respondToOffer"),adminCancelSale:(0,o.Qg)(o.Cn,"adminCancelSale"),adminDeleteItem:(0,o.Qg)(o.Cn,"adminDeleteItem")}),[]),z=(0,n.useCallback)(async()=>{if(f&&b){I(!0);try{const e=await D();if(!e.data.success)throw new Error(e.data.message||"\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");{const{storeItems:t,userItems:s,marketListings:a,marketOffers:n}=e.data.data;j(t||[]),w(s||[]),C(a||[]),S(n||[]),T(null)}}catch(e){console.error("[ItemContext] \ub370\uc774\ud130 \ub85c\ub4dc \uc624\ub958:",e),T(e)}finally{I(!1)}}else I(!1)},[f,b,D]);(0,l.nm)(z,{interval:18e5,enabled:!m&&!!f&&!!b,deps:[m,f,b]});const O=(0,n.useCallback)(()=>z(),[z]),_=(0,n.useCallback)(e=>{console.log("[ItemContext] \ub85c\uceec userItems \uc5c5\ub370\uc774\ud2b8:",null===e||void 0===e?void 0:e.length,"\uac1c"),w(e)},[]),L=(0,n.useCallback)(async e=>{if(!u())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};const t="temp_".concat(Date.now()),n=(0,a.A)((0,a.A)({},e),{},{id:t});j(e=>[...e,n]);try{const t=await(null===s||void 0===s?void 0:s.getIdToken());if(!t)throw new Error("\uc778\uc99d \ud1a0\ud070\uc744 \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const a="https://asia-northeast3-inconomysu-class.cloudfunctions.net/addStoreItem",n=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({data:{newItemData:e}})});if(!n.ok){const e=await n.text();throw new Error(e||"\uc11c\ubc84 \uc624\ub958: ".concat(n.status))}const i=await n.json();if(i.data.success)return await O(),{success:!0};throw new Error(i.data.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}catch(E){return j(e=>e.filter(e=>e.id!==t)),{success:!1,message:E.message}}},[u,s,O]),W=(0,n.useCallback)(async(e,t)=>{if(!u())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};try{return await R.updateStoreItem({itemId:e,updatesToApply:t}),O(),{success:!0}}catch(E){return"not-found"===E.code?{success:!1,message:"\uc544\uc774\ud15c \uc218\uc815 \ud568\uc218(updateStoreItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[u,R,O]),B=(0,n.useCallback)(async e=>{if(!u())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};try{return await R.deleteStoreItem({itemId:e}),O(),{success:!0}}catch(E){return"not-found"===E.code?{success:!1,message:"\uc544\uc774\ud15c \uc0ad\uc81c \ud568\uc218(deleteStoreItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[u,R,O]),P=(0,n.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};const s=y.find(t=>t.id===e);if(!s)return{success:!1,message:"\uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};const n=s.price*t;g&&g({cash:-n});const i={id:"temp-".concat(Date.now(),"-").concat(Math.random()),itemId:s.id,name:s.name,icon:s.icon||"\ud83d\udd2e",description:s.description||"",type:s.type||"general",quantity:t,price:s.price,durationMs:s.durationMs||3e5,purchasedAt:new Date};console.log("[ItemContext] \ub099\uad00\uc801 \uc5c5\ub370\uc774\ud2b8: Store \uc544\uc774\ud15c \ucd94\uac00",i);const l=[...v],d=s.stock,c=s.price;w(e=>{const s=e.findIndex(e=>e.itemId===i.itemId);if(s>=0){const n=[...e];return n[s]=(0,a.A)((0,a.A)({},n[s]),{},{quantity:n[s].quantity+t}),n}return[...e,i]});try{const i=await R.purchaseStoreItem({itemId:e,quantity:t});if(i.data.success){const{restocked:l,newStock:u,newPrice:m}=i.data;return console.log("[ItemContext] \uad6c\ub9e4 \uc131\uacf5:",{itemId:e,quantity:t,restocked:l,newStock:u,newPrice:m,oldPrice:c,oldStock:d}),(0,r.Mx)(o.db,{classCode:b,userId:f,userName:(null===p||void 0===p?void 0:p.name)||"\uc0ac\uc6a9\uc790",type:r.gI.ITEM_PURCHASE,description:"".concat(s.name," ").concat(t,"\uac1c \uad6c\ub9e4 (").concat(n.toLocaleString(),"\uc6d0)"),amount:-n,metadata:{itemId:e,itemName:s.name,quantity:t,pricePerItem:s.price,totalPrice:n}}),void 0!==s.stock&&j(t=>t.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),{},{stock:u,price:m}):t)),console.log("[ItemContext] \uad6c\ub9e4 \uc131\uacf5, \uc11c\ubc84 \ub370\uc774\ud130\ub85c \ub3d9\uae30\ud654"),O(),{success:!0,restocked:l,newStock:u,newPrice:m}}throw console.warn("[ItemContext] \uad6c\ub9e4 \uc2e4\ud328, \ub864\ubc31 \uc218\ud589"),g&&g({cash:n}),w(l),new Error(i.data.message||"\uad6c\ub9e4\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(E){return console.error("[ItemContext] \uad6c\ub9e4 \uc5d0\ub7ec, \ub864\ubc31 \uc218\ud589:",E),g&&g({cash:n}),w(l),O(),"not-found"===E.code?{success:!1,message:"\uc544\uc774\ud15c \uad6c\ub9e4 \ud568\uc218(purchaseStoreItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[f,R,O,y,v,g]),F=(0,n.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};const s=v.find(t=>t.id===e||t.itemId===e),a=(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.itemName)||"\uc544\uc774\ud15c";try{return await R.useUserItem({itemId:e,quantityToUse:t,sourceCollection:"inventory"}),(0,r.Mx)(o.db,{classCode:b,userId:f,userName:(null===p||void 0===p?void 0:p.name)||"\uc0ac\uc6a9\uc790",type:r.gI.ITEM_USE,description:"".concat(a," ").concat(t,"\uac1c \uc0ac\uc6a9"),metadata:{itemId:e,itemName:a,quantity:t}}),O(),{success:!0}}catch(E){return O(),"not-found"===E.code?{success:!1,message:"\uc544\uc774\ud15c \uc0ac\uc6a9 \ud568\uc218(useUserItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[f,v,b,p,R,O]),q=(0,n.useCallback)(async e=>{let{itemId:t,quantity:s,price:a}=e;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};const n=v.find(e=>e.id===t||e.itemId===t),i=(null===n||void 0===n?void 0:n.name)||(null===n||void 0===n?void 0:n.itemName)||"\uc544\uc774\ud15c";try{return await R.listUserItemForSale({inventoryItemId:t,quantity:s,price:a,sourceCollection:"inventory"}),(0,r.Mx)(o.db,{classCode:b,userId:f,userName:(null===p||void 0===p?void 0:p.name)||"\uc0ac\uc6a9\uc790",type:r.gI.ITEM_MARKET_LIST,description:"".concat(i," ").concat(s,"\uac1c \uc2dc\uc7a5 \ub4f1\ub85d (").concat(a.toLocaleString(),"\uc6d0)"),metadata:{itemId:t,itemName:i,quantity:s,price:a}}),O(),{success:!0}}catch(E){return O(),"not-found"===E.code?{success:!1,message:"\uc544\uc774\ud15c \ud310\ub9e4 \ub4f1\ub85d \ud568\uc218(listUserItemForSale)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[f,R,O]),U=(0,n.useCallback)(async e=>{if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};const t=N.find(t=>t.id===e);if(!t)return{success:!1,message:"\ud310\ub9e4 \ubaa9\ub85d\uc5d0\uc11c \uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."};const s=t.price||t.totalPrice||0;if(!await x(s,"".concat(t.itemName," \uad6c\ub9e4")))return{success:!1,message:"\ud604\uae08 \ucc28\uac10\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."};const n={id:"temp-".concat(Date.now(),"-").concat(Math.random()),itemId:t.itemId||t.id,name:t.itemName,icon:t.icon||"\ud83d\udd2e",description:t.description||"",type:t.category||t.itemType||"general",quantity:t.quantity||1,purchasedAt:new Date};console.log("[ItemContext] \ub099\uad00\uc801 \uc5c5\ub370\uc774\ud2b8: \uc544\uc774\ud15c \ucd94\uac00",n);const i=[...v],l=[...N];w(e=>{const t=e.findIndex(e=>e.itemId===n.itemId);if(t>=0){const s=[...e];return s[t]=(0,a.A)((0,a.A)({},s[t]),{},{quantity:s[t].quantity+n.quantity}),s}return[...e,n]}),C(t=>t.filter(t=>t.id!==e));try{const a=await R.buyMarketItem({listingId:e});if(a.data.success)return console.log("[ItemContext] \uad6c\ub9e4 \uc131\uacf5, \uc11c\ubc84 \ub370\uc774\ud130\ub85c \ub3d9\uae30\ud654"),(0,r.Mx)(o.db,{classCode:b,userId:f,userName:(null===p||void 0===p?void 0:p.name)||"\uc0ac\uc6a9\uc790",type:r.gI.ITEM_MARKET_BUY,description:"".concat(t.itemName," ").concat(t.quantity||1,"\uac1c \uc2dc\uc7a5 \uad6c\ub9e4 (").concat(s.toLocaleString(),"\uc6d0)"),amount:-s,metadata:{listingId:e,itemName:t.itemName,quantity:t.quantity||1,sellerId:t.sellerId,sellerName:t.sellerName,price:s}}),O(),{success:!0};throw console.warn("[ItemContext] \uad6c\ub9e4 \uc2e4\ud328, \ub864\ubc31 \uc218\ud589"),await h(s,"".concat(t.itemName," \uad6c\ub9e4 \uc2e4\ud328 (\ub864\ubc31)")),w(i),C(l),new Error(a.data.message||"\uad6c\ub9e4\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(E){return console.error("[ItemContext] \uad6c\ub9e4 \uc5d0\ub7ec, \ub864\ubc31 \uc218\ud589:",E),await h(s,"".concat(t.itemName," \uad6c\ub9e4 \uc2e4\ud328 (\ub864\ubc31)")),w(i),C(l),"not-found"===E.code?{success:!1,message:"\uad6c\ub9e4 \ucc98\ub9ac \ud568\uc218(buyMarketItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[f,R,O,N,v,x,h]),Q=(0,n.useCallback)(async e=>{if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};try{return await R.cancelMarketSale({listingId:e}),O(),{success:!0}}catch(E){return O(),"not-found"===E.code?{success:!1,message:"\ud310\ub9e4 \ucde8\uc18c \ud568\uc218(cancelMarketSale)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[f,R,O]),H=(0,n.useCallback)(async e=>{let{listingId:t,offerPrice:s,quantity:a=1}=e;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};try{const e=await R.makeOffer({listingId:t,offerPrice:s,quantity:a});return O(),{success:!0,offerId:e.data.offerId}}catch(E){return O(),"not-found"===E.code?{success:!1,message:"\uac00\uaca9 \uc81c\uc548 \ud568\uc218(makeOffer)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[f,R,O]),G=(0,n.useCallback)(async e=>{let{offerId:t,response:s}=e;if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};try{return await R.respondToOffer({offerId:t,response:s}),O(),{success:!0}}catch(E){return O(),"not-found"===E.code?{success:!1,message:"\uc81c\uc548 \uc751\ub2f5 \ud568\uc218(respondToOffer)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[f,R,O]),J=(0,n.useCallback)(async e=>{if(!u())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};try{return await R.adminCancelSale({listingId:e}),O(),{success:!0}}catch(E){return O(),"not-found"===E.code?{success:!1,message:"\uad00\ub9ac\uc790 \ud310\ub9e4 \ucde8\uc18c \ud568\uc218(adminCancelSale)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[u,R,O]),V=(0,n.useCallback)(async e=>{if(!u())return{success:!1,message:"\uad00\ub9ac\uc790 \uad8c\ud55c \ud544\uc694"};try{return await R.adminDeleteItem({listingId:e}),O(),{success:!0}}catch(E){return O(),"not-found"===E.code?{success:!1,message:"\uad00\ub9ac\uc790 \uc544\uc774\ud15c \uc0ad\uc81c \ud568\uc218(adminDeleteItem)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[u,R,O]),K=(0,n.useCallback)(async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inventory";if(!f)return{success:!1,message:"\ub85c\uadf8\uc778 \ud544\uc694"};try{const a=await R.updateUserItemQuantity({itemId:e,quantityChange:t,sourceCollection:s});if(a.data.success)return O(),{success:!0};throw new Error(a.data.message||"\uc544\uc774\ud15c \uc218\ub7c9 \uc5c5\ub370\uc774\ud2b8\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(E){return O(),"not-found"===E.code?{success:!1,message:"\uc544\uc774\ud15c \uc218\ub7c9 \uc5c5\ub370\uc774\ud2b8 \ud568\uc218(updateUserItemQuantity)\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}:{success:!1,message:E.message}}},[f,R,O]),X=(0,n.useMemo)(()=>({items:y,userItems:v,marketListings:N,marketOffers:k,loading:M,error:E,addItem:L,updateItem:W,deleteItem:B,purchaseItem:P,useItem:F,updateUserItemQuantity:K,listItemForSale:q,buyMarketItem:U,cancelSale:Q,makeOffer:H,respondToOffer:G,adminCancelSale:J,adminDeleteItem:V,refreshData:O,updateLocalUserItems:_}),[y,v,N,k,M,E,L,W,B,P,F,K,q,U,Q,H,G,J,V,O,_]);return(0,d.jsx)(c.Provider,{value:X,children:t})}},9270:(e,t,s)=>{s.d(t,{Mx:()=>l,gI:()=>o});var a=s(4919),n=s(5472),i=s(5010);const o={CASH_INCOME:"\ud604\uae08 \uc785\uae08",CASH_EXPENSE:"\ud604\uae08 \ucd9c\uae08",TRANSFER_SEND:"\uc1a1\uae08 \ubc1c\uc1a1",TRANSFER_RECEIVE:"\uc1a1\uae08 \uc218\uc2e0",STOCK_BUY:"\uc8fc\uc2dd \ub9e4\uc218",STOCK_SELL:"\uc8fc\uc2dd \ub9e4\ub3c4",ITEM_PURCHASE:"\uc544\uc774\ud15c \uad6c\ub9e4",ITEM_SELL:"\uc544\uc774\ud15c \ud310\ub9e4",ITEM_USE:"\uc544\uc774\ud15c \uc0ac\uc6a9",ITEM_MARKET_LIST:"\uc544\uc774\ud15c \uc2dc\uc7a5 \ub4f1\ub85d",ITEM_MARKET_BUY:"\uc544\uc774\ud15c \uc2dc\uc7a5 \uad6c\ub9e4",DEPOSIT_CREATE:"\uc608\uae08 \uac00\uc785",DEPOSIT_WITHDRAW:"\uc608\uae08 \ucd9c\uae08",DEPOSIT_MATURITY:"\uc608\uae08 \ub9cc\uae30",LOAN_CREATE:"\ub300\ucd9c \uc2e4\ud589",LOAN_REPAY:"\ub300\ucd9c \uc0c1\ud658",PARKING_DEPOSIT:"\ud30c\ud0b9\ud1b5\uc7a5 \uc785\uae08",PARKING_WITHDRAW:"\ud30c\ud0b9\ud1b5\uc7a5 \ucd9c\uae08",PARKING_INTEREST:"\ud30c\ud0b9\ud1b5\uc7a5 \uc774\uc790",COUPON_EARN:"\ucfe0\ud3f0 \ud68d\ub4dd",COUPON_USE:"\ucfe0\ud3f0 \uc0ac\uc6a9",COUPON_GIVE:"\ucfe0\ud3f0 \uc9c0\uae09",COUPON_DONATE:"\ucfe0\ud3f0 \uae30\ubd80",COUPON_GIFT_SEND:"\ucfe0\ud3f0 \uc120\ubb3c",COUPON_GIFT_RECEIVE:"\ucfe0\ud3f0 \uc218\uc2e0",GAME_WIN:"\uac8c\uc784 \uc2b9\ub9ac",GAME_LOSE:"\uac8c\uc784 \ud328\ubc30",GAME_REWARD:"\uac8c\uc784 \ubcf4\uc0c1",GAME_BET:"\uac8c\uc784 \ubca0\ud305",AUCTION_BID:"\uacbd\ub9e4 \uc785\ucc30",AUCTION_WIN:"\uacbd\ub9e4 \ub099\ucc30",AUCTION_SOLD:"\uacbd\ub9e4 \ud310\ub9e4",AUCTION_REFUND:"\uacbd\ub9e4 \ud658\ubd88",REALESTATE_BUY:"\ubd80\ub3d9\uc0b0 \uad6c\ub9e4",REALESTATE_SELL:"\ubd80\ub3d9\uc0b0 \ud310\ub9e4",REALESTATE_RENT:"\uc784\ub300\ub8cc \uc218\uc785",TAX_PAYMENT:"\uc138\uae08 \ub0a9\ubd80",FINE_PAYMENT:"\ubc8c\uae08 \ub0a9\ubd80",SALARY_RECEIVE:"\uae09\uc5ec \uc218\ub839",ADMIN_GIVE:"\uad00\ub9ac\uc790 \uc9c0\uae09",ADMIN_TAKE:"\uad00\ub9ac\uc790 \ud68c\uc218"};async function l(e,t){let{classCode:s,userId:o,userName:l,type:r,description:d,amount:c=0,couponAmount:p=0,metadata:u={}}=t;if(!s||!o||!r)return console.warn("[logActivity] \ud544\uc218 \ud30c\ub77c\ubbf8\ud130 \ub204\ub77d:",{classCode:s,userId:o,type:r}),{success:!1,error:"\ud544\uc218 \ud30c\ub77c\ubbf8\ud130 \ub204\ub77d"};const m=e||i.db;try{const e=(0,n.rJ)(m,"activity_logs"),t={classCode:s,userId:o,userName:l||"\uc54c \uc218 \uc5c6\uc74c",type:r,description:d||r,amount:c||0,couponAmount:p||0,metadata:(0,a.A)((0,a.A)({},u),{},{timestamp:(new Date).toISOString()}),timestamp:(0,n.O5)(),createdAt:(0,n.O5)()},i=await(0,n.addDoc)(e,t);return console.log("[logActivity] \ud65c\ub3d9 \ub85c\uadf8 \uae30\ub85d:",r,d),{success:!0,logId:i.id}}catch(x){return console.error("[logActivity] \ub85c\uadf8 \uae30\ub85d \uc2e4\ud328:",x),{success:!1,error:x.message}}}},9306:(e,t,s)=>{s.r(t),s.d(t,{AlchanLoading:()=>wa,default:()=>Aa});var a=s(5043),n=s(3216),i=s(5016),o=s(8719),l=s(4919),r=s(4379),d=s(2029),c=s(3165),p=s(5326),u=s(9868),m=s(4473),x=s(2629),h=s(1990),g=s(2171),f=s(6511),b=s(7095),y=s(7300),j=s(6790),v=s(7033),w=s(830),N=s(3639),C=s(920),k=s(7118),S=s(8012),A=s(2489),I=s(1680),E=s(2626),T=s(9829),M=s(7365),D=s(9809),R=s(3190),z=s(2382),O=s(614),_=s(9493),L=s(579);const W=e=>{let{className:t,style:s}=e;return(0,L.jsxs)("svg",{className:t,style:s,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,L.jsxs)("defs",{children:[(0,L.jsxs)("linearGradient",{id:"iconGradient",x1:"0",y1:"0",x2:"100",y2:"100",gradientUnits:"userSpaceOnUse",children:[(0,L.jsx)("stop",{offset:"0%",stopColor:"#7C3AED"}),(0,L.jsx)("stop",{offset:"100%",stopColor:"#4F46E5"})]}),(0,L.jsxs)("filter",{id:"glow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[(0,L.jsx)("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),(0,L.jsxs)("feMerge",{children:[(0,L.jsx)("feMergeNode",{in:"coloredBlur"}),(0,L.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})]}),(0,L.jsx)("rect",{x:"5",y:"5",width:"90",height:"90",rx:"22",fill:"url(#iconGradient)"}),(0,L.jsx)("path",{d:"M28 52 L42 66 L72 36",stroke:"white",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#glow)"}),(0,L.jsx)("path",{d:"M75 25 L77 30 L82 30 L78 34 L79 39 L75 36 L71 39 L72 34 L68 30 L73 30 Z",fill:"#FFD700",stroke:"#B45309",strokeWidth:"1"})]})},B=[{id:"todayTasks",label:"\uc54c\ucc2c \uc624\ub298\uc758 \ud560\uc77c",icon:r.A,path:"/dashboard/tasks",category:"main"},{id:"myAssets",label:"\uc54c\ucc2c \ub098\uc758 \uc790\uc0b0",icon:d.A,path:"/my-assets",category:"main"},{id:"couponGoal",label:"\uc54c\ucc2c \ucfe0\ud3f0 \ubaa9\ud45c",icon:c.A,path:"/coupon-goal",category:"main"},{id:"gamesCategory",label:"\uc54c\ucc2c \ud559\uc2b5 \uac8c\uc784",icon:p.A,isCategory:!0,category:"play"},{id:"omokGame",label:"\uc624\ubaa9",icon:u.A,path:"/learning-games/omok",parentId:"gamesCategory"},{id:"typingGame",label:"\ud0c0\uc790\uc5f0\uc2b5",icon:m.A,path:"/learning-games/typing",parentId:"gamesCategory"},{id:"chessGame",label:"\uccb4\uc2a4 \uac8c\uc784",icon:x.A,path:"/learning-games/science",parentId:"gamesCategory"},{id:"itemsCategory",label:"\uc54c\ucc2c \uc544\uc774\ud15c",icon:h.A,isCategory:!0,category:"economy"},{id:"myItems",label:"\ub0b4 \uc544\uc774\ud15c",icon:g.A,path:"/my-items",parentId:"itemsCategory"},{id:"itemStore",label:"\uc544\uc774\ud15c \uc0c1\uc810",icon:f.A,path:"/item-shop",parentId:"itemsCategory"},{id:"personalShop",label:"\uac1c\uc778 \uc0c1\uc810",icon:b.A,path:"/personal-shop",parentId:"itemsCategory"},{id:"financeCategory",label:"\uc54c\ucc2c \uae08\uc735",icon:y.A,isCategory:!0,category:"economy"},{id:"banking",label:"\uc740\ud589",icon:j.A,path:"/banking",parentId:"financeCategory"},{id:"stockTrading",label:"\uc8fc\uc2dd \uac70\ub798\uc18c",icon:v.A,path:"/stock-trading",parentId:"financeCategory"},{id:"auction",label:"\uacbd\ub9e4\uc7a5",icon:w.A,path:"/auction",parentId:"financeCategory"},{id:"realEstate",label:"\ubd80\ub3d9\uc0b0",icon:N.A,path:"/real-estate",parentId:"financeCategory"},{id:"publicCategory",label:"\uc54c\ucc2c \uacf5\uacf5\uae30\uad00",icon:C.A,isCategory:!0,category:"society"},{id:"government",label:"\uc815\ubd80",icon:C.A,path:"/government",parentId:"publicCategory"},{id:"nationalAssembly",label:"\uad6d\ud68c",icon:k.A,path:"/national-assembly",parentId:"publicCategory"},{id:"court",label:"\ubc95\uc6d0",icon:S.A,path:"/court",parentId:"publicCategory"},{id:"policeStation",label:"\uacbd\ucc30\uc11c",icon:A.A,path:"/police",parentId:"publicCategory"},{id:"boardCategory",label:"\uc54c\ucc2c \uac8c\uc2dc\ud310",icon:I.A,isCategory:!0,category:"community"},{id:"learningBoard",label:"\ud559\uc2b5 \uac8c\uc2dc\ud310",icon:E.A,path:"/learning-board",parentId:"boardCategory"},{id:"musicRequest",label:"\uc74c\uc545 \uc2e0\uccad",icon:T.A,path:"/learning-board/music-request",parentId:"boardCategory"},{id:"adminCategory",label:"\uc54c\ucc2c \uad00\ub9ac\uc790",icon:M.A,isCategory:!0,category:"admin",adminOnly:!0},{id:"adminUserGroup",label:"\ud83d\udc65 \ud559\uc0dd \uad00\ub9ac",icon:k.A,isSubGroup:!0,parentId:"adminCategory",adminOnly:!0},{id:"studentManagement",label:"\ud559\uc0dd \ubaa9\ub85d",icon:k.A,path:"/admin/students",parentId:"adminCategory",adminOnly:!0},{id:"classMemberManagement",label:"\ud559\uae09 \uad6c\uc131\uc6d0",icon:k.A,path:"/admin/class-members",parentId:"adminCategory",adminOnly:!0},{id:"adminAssetGroup",label:"\ud83d\udcb0 \uc790\uc0b0 \uad00\ub9ac",icon:j.A,isSubGroup:!0,parentId:"adminCategory",adminOnly:!0},{id:"moneyTransfer",label:"\ub3c8 \ubcf4\ub0b4\uae30/\uac00\uc838\uc624\uae30",icon:j.A,path:"/admin/money-transfer",parentId:"adminCategory",adminOnly:!0},{id:"couponTransfer",label:"\ucfe0\ud3f0 \ubcf4\ub0b4\uae30/\uac00\uc838\uc624\uae30",icon:c.A,path:"/admin/coupon-transfer",parentId:"adminCategory",adminOnly:!0},{id:"adminSettingsGroup",label:"\u2699\ufe0f \ud559\uae09 \uc124\uc815",icon:M.A,isSubGroup:!0,parentId:"adminCategory",adminOnly:!0},{id:"adminAppSettings",label:"\ubaa9\ud45c/\ucfe0\ud3f0 \uc124\uc815",icon:c.A,path:"/admin/app-settings",parentId:"adminCategory",adminOnly:!0},{id:"taskManagement",label:"\ud560\uc77c \uad00\ub9ac",icon:D.A,path:"/admin/task-management",parentId:"adminCategory",adminOnly:!0},{id:"jobManagement",label:"\uc9c1\uc5c5 \uad00\ub9ac",icon:R.A,path:"/admin/job-settings",parentId:"adminCategory",adminOnly:!0},{id:"salarySettings",label:"\uae09\uc5ec \uc124\uc815",icon:j.A,path:"/admin/salary-settings",parentId:"adminCategory",adminOnly:!0},{id:"adminSystemGroup",label:"\ud83d\udd27 \uc2dc\uc2a4\ud15c",icon:M.A,isSubGroup:!0,parentId:"adminCategory",adminOnly:!0},{id:"activityLog",label:"\ub370\uc774\ud130\ubca0\uc774\uc2a4",icon:I.A,path:"/admin/activity-log",parentId:"adminCategory",adminOnly:!0},{id:"adminPage",label:"\uad00\ub9ac\uc790 \uc81c\uc5b4\ud310",icon:M.A,path:"/admin/page",parentId:"adminCategory",adminOnly:!0},{id:"superAdminCategory",label:"\uc571 \uad00\ub9ac\uc790",icon:A.A,isCategory:!0,category:"superadmin",superAdminOnly:!0},{id:"superAdminDashboard",label:"\uc571 \uad00\ub9ac \ub300\uc2dc\ubcf4\ub4dc",icon:A.A,path:"/super-admin",parentId:"superAdminCategory",superAdminOnly:!0}],P={main:"\uba54\uc778",play:"\uac8c\uc784",economy:"\uacbd\uc81c",society:"\uc0ac\ud68c",community:"\ucee4\ubba4\ub2c8\ud2f0",admin:"\uad00\ub9ac",superadmin:"\uc571 \uad00\ub9ac"},F=e=>{let{title:t,children:s}=e;return(0,L.jsxs)("div",{className:"mb-6",children:[(0,L.jsx)("h3",{className:"px-4 text-[11px] font-bold text-slate-500 uppercase tracking-wider mb-2",children:t}),(0,L.jsx)("ul",{className:"space-y-1",children:s})]})},q=e=>{let{icon:t,label:s,active:a,hasSubmenu:n,onClick:i}=e;return(0,L.jsx)("li",{children:(0,L.jsxs)("button",{onClick:i,className:"w-full flex items-center justify-between px-4 py-2.5 rounded-xl transition-all duration-200 group ".concat(a?"bg-indigo-500/20 text-indigo-400 font-bold shadow-sm border border-indigo-500/30":"text-slate-400 hover:bg-white/5 hover:text-slate-200"),children:[(0,L.jsxs)("div",{className:"flex items-center gap-3",children:[(0,L.jsx)(t,{className:"w-[18px] h-[18px] ".concat(a?"text-indigo-400":"text-slate-500 group-hover:text-slate-300")}),(0,L.jsx)("span",{className:"text-sm",children:s})]}),n&&(0,L.jsx)(z.A,{className:"w-3.5 h-3.5 text-slate-400"})]})})},U=e=>{let{icon:t,label:s,active:a,onClick:n}=e;return(0,L.jsxs)("button",{onClick:n,className:"w-full flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg transition-colors ".concat(a?"text-indigo-400 bg-indigo-500/20 shadow-[0_0_10px_rgba(99,102,241,0.2)]":"text-slate-500 hover:text-slate-200 hover:bg-white/5"),children:[(0,L.jsx)(t,{className:"w-3.5 h-3.5"}),s]})},Q=e=>{let{category:t,children:s,isExpanded:a,onToggle:n,hasActiveChild:i}=e;const o=t.icon;return(0,L.jsxs)("div",{className:"mb-1",children:[(0,L.jsxs)("button",{onClick:n,className:"w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group ".concat(i?"bg-indigo-500/10 text-indigo-400 border border-indigo-500/20":"text-slate-400 hover:bg-white/5 hover:text-slate-200"),children:[(0,L.jsx)(o,{className:"w-[18px] h-[18px] transition-colors flex-shrink-0 ".concat(i?"text-indigo-400":"text-slate-500 group-hover:text-slate-300")}),(0,L.jsx)("span",{className:"flex-1 text-left",children:t.label}),(0,L.jsx)(z.A,{className:"w-3.5 h-3.5 transition-transform duration-300 opacity-50 flex-shrink-0 ".concat(a?"rotate-180":"")})]}),(0,L.jsx)("div",{className:"overflow-hidden transition-all duration-300 ".concat(a?"max-h-96 opacity-100":"max-h-0 opacity-0"),children:(0,L.jsx)("div",{className:"pl-4 mt-2 space-y-1 border-l-2 border-slate-700 ml-4",children:s})})]})};function H(e){let{isOpen:t,onClose:s,isCollapsed:o=!1}=e;const r=(0,n.zy)(),d=(0,n.Zp)(),{userDoc:c,logout:p}=(0,i.As)(),[u,m]=(0,a.useState)({}),[x,h]=(0,a.useState)(window.innerWidth<768);(0,a.useEffect)(()=>{const e=()=>h(window.innerWidth<768);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const g=(0,a.useCallback)(e=>{m(t=>(0,l.A)((0,l.A)({},t),{},{[e]:!t[e]}))},[]),f=(0,a.useCallback)(e=>!!e&&(r.pathname===e||r.pathname.startsWith("".concat(e,"/"))),[r.pathname]),b=(0,a.useCallback)(e=>B.some(t=>t.parentId===e&&f(t.path)),[f]),y=(0,a.useCallback)(e=>{e.path&&(d(e.path),x&&(null===s||void 0===s||s()))},[d,x,s]),j=(0,a.useCallback)(async()=>{p&&(await p(),d("/login"))},[p,d]),v=(null===c||void 0===c?void 0:c.isAdmin)||(null===c||void 0===c?void 0:c.isSuperAdmin),w=null===c||void 0===c?void 0:c.isSuperAdmin;let N="\ud559\uc0dd";null!==c&&void 0!==c&&c.isSuperAdmin?N="\uc571 \uad00\ub9ac\uc790":null!==c&&void 0!==c&&c.isAdmin&&(N="\uad50\uc0ac");const C=(null===c||void 0===c?void 0:c.name)||(null===c||void 0===c?void 0:c.nickname)||"\uc0ac\uc6a9\uc790",k=e=>{const t=B.filter(t=>t.category===e&&(!(t.adminOnly&&!v)&&!(t.superAdminOnly&&!w)));return 0===t.length?null:(0,L.jsx)(F,{title:P[e],children:t.map(e=>{if(e.isCategory){const t=B.filter(t=>t.parentId===e.id&&(!(t.adminOnly&&!v)&&!(t.superAdminOnly&&!w)));return 0===t.length?null:(0,L.jsx)(Q,{category:e,isExpanded:u[e.id]||b(e.id),onToggle:()=>g(e.id),hasActiveChild:b(e.id),children:t.map(e=>e.isSubGroup?(0,L.jsx)("div",{className:"mt-3 mb-1 first:mt-0",children:(0,L.jsx)("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider px-2",children:e.label})},e.id):(0,L.jsx)(U,{icon:e.icon,label:e.label,active:f(e.path),onClick:()=>y(e)},e.id))},e.id)}return e.parentId?null:(0,L.jsx)(q,{icon:e.icon,label:e.label,active:f(e.path),onClick:()=>y(e)},e.id)})},e)};return o&&!x?(0,L.jsxs)("aside",{className:"hidden md:flex flex-col w-20 bg-[#141423] border-r border-[#00fff2]/10 h-screen sticky top-0 left-0 z-50 shadow-xl transition-all duration-300",children:[(0,L.jsx)("div",{style:{height:"64px",minHeight:"64px",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #4f46e5, #7c3aed, #4f46e5)"},children:(0,L.jsx)("div",{style:{padding:"4px",background:"rgba(255,255,255,0.1)",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:(0,L.jsx)(W,{style:{width:"32px",height:"32px"}})})}),(0,L.jsx)("nav",{className:"flex-1 overflow-y-auto py-4 px-2 space-y-2",children:B.filter(e=>!e.parentId&&!e.isCategory).map(e=>{if(e.adminOnly&&!v)return null;if(e.superAdminOnly&&!w)return null;const t=e.icon,s=f(e.path);return(0,L.jsx)("button",{onClick:()=>y(e),title:e.label,className:"w-14 h-14 mx-auto rounded-2xl flex items-center justify-center transition-all duration-200 ".concat(s?"bg-gradient-to-br from-indigo-600 to-violet-700 text-white shadow-lg shadow-indigo-500/40 border-none":"bg-[#1a1a2e] border border-slate-700/50 text-slate-400 hover:bg-indigo-900/30 hover:text-indigo-400 hover:border-indigo-500/30"),children:(0,L.jsx)(t,{size:24})},e.id)})}),(0,L.jsx)("div",{className:"p-4 border-t border-slate-800 bg-[#0a0a12]/50",children:(0,L.jsx)("div",{className:"w-10 h-10 mx-auto rounded-full bg-gradient-to-tr from-blue-500 to-indigo-500 flex items-center justify-center text-white font-bold",children:C.charAt(0)})})]}):(0,L.jsxs)(L.Fragment,{children:[x&&t&&(0,L.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-40 md:hidden",onClick:s}),(0,L.jsxs)("aside",{className:"\n          fixed inset-y-0 left-0 z-50 w-72 bg-[#141423] border-r border-[#00fff2]/10 shadow-[0_4px_20px_rgba(0,0,0,0.5)] transform transition-transform duration-300 ease-in-out\n          ".concat(x?t?"translate-x-0":"-translate-x-full":"relative translate-x-0","\n          lg:relative lg:translate-x-0 lg:w-72 flex flex-col shrink-0\n        "),children:[(0,L.jsxs)("div",{style:{height:"72px",minHeight:"72px",margin:"12px",display:"flex",alignItems:"center",alignItems:"center",background:"linear-gradient(135deg, rgba(10, 10, 18, 0.95), rgba(20, 20, 35, 0.95))",border:"1px solid rgba(0, 255, 242, 0.2)",boxShadow:"0 0 15px rgba(0, 255, 242, 0.1)"},children:[(0,L.jsx)("div",{style:{position:"absolute",top:"-20px",right:"-20px",width:"80px",height:"80px",background:"rgba(255,255,255,0.1)",borderRadius:"50%"}}),(0,L.jsx)("div",{style:{position:"absolute",bottom:"-30px",left:"-10px",width:"60px",height:"60px",background:"rgba(255,255,255,0.08)",borderRadius:"50%"}}),(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"14px",padding:"0 18px",width:"100%",position:"relative",zIndex:10},children:[(0,L.jsx)("div",{style:{padding:"6px",background:"rgba(255,255,255,0.05)",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",border:"1px solid rgba(255,255,255,0.1)"},children:(0,L.jsx)(W,{style:{width:"36px",height:"36px"}})}),(0,L.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,L.jsx)("span",{style:{fontSize:"22px",fontWeight:"900",color:"#00fff2",fontFamily:"'Jua', sans-serif",lineHeight:"1.1",textShadow:"0 0 10px rgba(0, 255, 242, 0.5)"},children:"\uc54c\ucc2c"}),(0,L.jsx)("span",{style:{fontSize:"11px",fontWeight:"bold",color:"rgba(232, 232, 255, 0.7)",letterSpacing:"0.2em",lineHeight:"1.1",marginTop:"3px"},children:"ALCHAN"})]})]}),x&&(0,L.jsx)("button",{onClick:s,style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",padding:"6px",borderRadius:"50%",background:"rgba(255,255,255,0.2)",border:"none",color:"white",cursor:"pointer"},children:(0,L.jsx)(O.A,{size:18})})]}),(0,L.jsxs)("nav",{className:"flex-1 overflow-y-auto py-6 px-4 space-y-8 scrollbar-hide",children:[k("main"),k("play"),k("economy"),k("society"),k("community"),k("admin"),k("superadmin")]}),(0,L.jsx)("div",{className:"p-4 border-t border-slate-800 bg-[#0a0a12]/50",children:(0,L.jsxs)("div",{onClick:j,className:"flex items-center gap-3 p-3 rounded-xl bg-[#141423] shadow-sm border border-slate-700 hover:shadow-md hover:border-indigo-500/50 transition-all cursor-pointer group",children:[(0,L.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-tr from-blue-500 to-indigo-500 flex items-center justify-center text-white font-bold",children:C.charAt(0)}),(0,L.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,L.jsx)("p",{className:"text-sm font-bold text-slate-200 truncate",children:C}),(0,L.jsx)("p",{className:"text-xs text-slate-500 truncate",children:N})]}),(0,L.jsx)(_.A,{className:"w-4 h-4 text-slate-400 group-hover:text-red-500 transition-colors"})]})})]})]})}var G=s(5010),J=s(3946),V=s(8326),K=s(9463),X=s(4459),Y=s(7737),Z=s(9855),$=s(3005),ee=s(5472),te=s(6099),se=s(6210);te.A,d.A,c.A,b.A,p.A,y.A,k.A,se.A;var ae=s(8393),ne=s(7940),ie=s(2300),oe=s(9233),le=s(3677),re=s(7666),de=s(6963);const ce=function(e){let{isOpen:t,onClose:s}=e;const{isDarkMode:n,toggleDarkMode:o,fontSize:l,setFontSize:r}=(0,$.DP)(),{resetTutorial:d}=function(){const{user:e}=(0,i.As)(),[t,s]=(0,a.useState)(!1),[n,o]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{null!==e&&void 0!==e&&e.uid?(async()=>{try{const t=(0,ee.H9)(G.db,"users",e.uid,"settings","tutorial"),a=await(0,ee.x7)(t);a.exists()&&a.data().completed||s(!0)}catch(t){console.error("\ud29c\ud1a0\ub9ac\uc5bc \uccb4\ud06c \uc624\ub958:",t)}finally{o(!1)}})():o(!1)},[null===e||void 0===e?void 0:e.uid]),{showTutorial:t,loading:n,completeTutorial:(0,a.useCallback)(async()=>{if(null!==e&&void 0!==e&&e.uid)try{const t=(0,ee.H9)(G.db,"users",e.uid,"settings","tutorial");await(0,ee.BN)(t,{completed:!0,completedAt:(0,ee.O5)()}),s(!1)}catch(t){console.error("\ud29c\ud1a0\ub9ac\uc5bc \uc644\ub8cc \uc800\uc7a5 \uc624\ub958:",t)}},[null===e||void 0===e?void 0:e.uid]),skipTutorial:(0,a.useCallback)(async()=>{if(null!==e&&void 0!==e&&e.uid)try{const t=(0,ee.H9)(G.db,"users",e.uid,"settings","tutorial");await(0,ee.BN)(t,{completed:!0,skipped:!0,skippedAt:(0,ee.O5)()}),s(!1)}catch(t){console.error("\ud29c\ud1a0\ub9ac\uc5bc \uc2a4\ud0b5 \uc800\uc7a5 \uc624\ub958:",t)}},[null===e||void 0===e?void 0:e.uid]),resetTutorial:(0,a.useCallback)(async()=>{if(null!==e&&void 0!==e&&e.uid)try{const t=(0,ee.H9)(G.db,"users",e.uid,"settings","tutorial");await(0,ee.BN)(t,{completed:!1}),s(!0)}catch(t){console.error("\ud29c\ud1a0\ub9ac\uc5bc \ub9ac\uc14b \uc624\ub958:",t)}},[null===e||void 0===e?void 0:e.uid])}}(),[c,p]=(0,a.useState)("false"!==localStorage.getItem("alchan-notifications")),[u,m]=(0,a.useState)("false"!==localStorage.getItem("alchan-sounds"));return t?(0,L.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,L.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-3xl w-full max-w-md max-h-[90vh] overflow-hidden shadow-2xl",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-gray-700",children:[(0,L.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"\uc124\uc815"}),(0,L.jsx)("button",{onClick:s,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:(0,L.jsx)(O.A,{size:20,className:"text-gray-500"})})]}),(0,L.jsxs)("div",{className:"overflow-y-auto p-4 space-y-6",children:[(0,L.jsxs)("section",{children:[(0,L.jsx)("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"\ud654\uba74"}),(0,L.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-2xl p-4 space-y-4",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"flex items-center gap-3",children:[n?(0,L.jsx)(ae.A,{size:20,className:"text-indigo-500"}):(0,L.jsx)(ne.A,{size:20,className:"text-amber-500"}),(0,L.jsxs)("div",{children:[(0,L.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\ub2e4\ud06c \ubaa8\ub4dc"}),(0,L.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc5b4\ub450\uc6b4 \ud654\uba74\uc73c\ub85c \ub208\uc758 \ud53c\ub85c\ub97c \uc904\uc5ec\uc694"})]})]}),(0,L.jsx)("button",{onClick:o,className:"w-12 h-7 rounded-full transition-colors relative ".concat(n?"bg-indigo-500":"bg-gray-300"),children:(0,L.jsx)("div",{className:"absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform ".concat(n?"left-6":"left-1")})})]}),(0,L.jsxs)("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-600",children:[(0,L.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,L.jsx)(ie.A,{size:20,className:"text-blue-500"}),(0,L.jsxs)("div",{children:[(0,L.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\uae00\uaf34 \ud06c\uae30"}),(0,L.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc77d\uae30 \ud3b8\ud55c \ud06c\uae30\ub97c \uc120\ud0dd\ud558\uc138\uc694"})]})]}),(0,L.jsx)("div",{className:"grid grid-cols-4 gap-2",children:Object.entries($.$N).map(e=>{let[t,{label:s}]=e;return(0,L.jsx)("button",{onClick:()=>r(t),className:"py-2 rounded-xl text-sm font-medium transition-all ".concat(l===t?"bg-indigo-500 text-white":"bg-white dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-500"),children:s},t)})})]})]})]}),(0,L.jsxs)("section",{children:[(0,L.jsx)("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"\uc54c\ub9bc"}),(0,L.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-2xl divide-y divide-gray-200 dark:divide-gray-600",children:[(0,L.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,L.jsxs)("div",{className:"flex items-center gap-3",children:[(0,L.jsx)(oe.A,{size:20,className:"text-green-500"}),(0,L.jsxs)("div",{children:[(0,L.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\ud478\uc2dc \uc54c\ub9bc"}),(0,L.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc0c8 \uc18c\uc2dd\uc744 \uc54c\ub824\ub4dc\ub824\uc694"})]})]}),(0,L.jsx)("button",{onClick:()=>{const e=!c;p(e),localStorage.setItem("alchan-notifications",String(e))},className:"w-12 h-7 rounded-full transition-colors relative ".concat(c?"bg-green-500":"bg-gray-300"),children:(0,L.jsx)("div",{className:"absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform ".concat(c?"left-6":"left-1")})})]}),(0,L.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,L.jsxs)("div",{className:"flex items-center gap-3",children:[(0,L.jsx)(le.A,{size:20,className:"text-purple-500"}),(0,L.jsxs)("div",{children:[(0,L.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\uc18c\ub9ac"}),(0,L.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc54c\ub9bc\uc74c\uacfc \ud6a8\uacfc\uc74c"})]})]}),(0,L.jsx)("button",{onClick:()=>{const e=!u;m(e),localStorage.setItem("alchan-sounds",String(e))},className:"w-12 h-7 rounded-full transition-colors relative ".concat(u?"bg-purple-500":"bg-gray-300"),children:(0,L.jsx)("div",{className:"absolute top-1 w-5 h-5 bg-white rounded-full shadow transition-transform ".concat(u?"left-6":"left-1")})})]})]})]}),(0,L.jsxs)("section",{children:[(0,L.jsx)("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"\uae30\ud0c0"}),(0,L.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-2xl divide-y divide-gray-200 dark:divide-gray-600",children:[(0,L.jsxs)("button",{onClick:()=>{window.confirm("\ud29c\ud1a0\ub9ac\uc5bc\uc744 \ub2e4\uc2dc \ubcf4\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(d(),s())},className:"flex items-center justify-between p-4 w-full hover:bg-gray-100 dark:hover:bg-gray-600/50 transition-colors",children:[(0,L.jsxs)("div",{className:"flex items-center gap-3",children:[(0,L.jsx)(re.A,{size:20,className:"text-amber-500"}),(0,L.jsxs)("div",{className:"text-left",children:[(0,L.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\ud29c\ud1a0\ub9ac\uc5bc \ub2e4\uc2dc \ubcf4\uae30"}),(0,L.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\uc0ac\uc6a9\ubc95\uc744 \ub2e4\uc2dc \ubc30\uc6cc\uc694"})]})]}),(0,L.jsx)(V.A,{size:20,className:"text-gray-400"})]}),(0,L.jsx)("div",{className:"p-4",children:(0,L.jsxs)("div",{className:"flex items-center gap-3",children:[(0,L.jsx)(de.A,{size:20,className:"text-gray-400"}),(0,L.jsxs)("div",{children:[(0,L.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"\uc571 \ubc84\uc804"}),(0,L.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"v1.0.0"})]})]})})]})]})]}),(0,L.jsx)("div",{className:"p-4 border-t border-gray-100 dark:border-gray-700",children:(0,L.jsx)("button",{onClick:s,className:"w-full py-3 bg-indigo-500 hover:bg-indigo-600 text-white rounded-xl font-semibold transition-colors",children:"\uc644\ub8cc"})})]})}):null},pe=[{id:"fair",name:"\ubc1d\uc740 \ud53c\ubd80",color:"#FFE4C4"},{id:"light",name:"\uc5f0\ud55c \ud53c\ubd80",color:"#F5DEB3"},{id:"medium",name:"\uc911\uac04 \ud53c\ubd80",color:"#DEB887"},{id:"tan",name:"\uadf8\uc744\ub9b0 \ud53c\ubd80",color:"#D2A679"},{id:"dark",name:"\uc5b4\ub450\uc6b4 \ud53c\ubd80",color:"#8B7355"}],ue=[{id:"round",name:"\ub465\uadfc\ud615",icon:"\ud83d\udd35",path:"M50,10 C82,10 90,32 90,55 C90,78 78,90 50,90 C22,90 10,78 10,55 C10,32 18,10 50,10"},{id:"oval",name:"\uacc4\ub780\ud615",icon:"\ud83e\udd5a",path:"M50,8 C78,8 88,28 88,52 C88,80 72,92 50,92 C28,92 12,80 12,52 C12,28 22,8 50,8"},{id:"square",name:"\uac01\uc9c4\ud615",icon:"\ud83d\udfe7",path:"M50,10 C85,10 90,30 90,55 C90,80 82,90 50,90 C18,90 10,80 10,55 C10,30 15,10 50,10"},{id:"heart",name:"\ud558\ud2b8\ud615",icon:"\ud83d\udc9c",path:"M50,10 C80,10 90,30 90,52 C90,78 70,90 50,92 C30,90 10,78 10,52 C10,30 20,10 50,10"},{id:"long",name:"\uae34\ud615",icon:"\ud83d\udccf",path:"M50,5 C72,5 80,25 80,50 C80,82 65,95 50,95 C35,95 20,82 20,50 C20,25 28,5 50,5"}],me=[{id:"normal",name:"\uae30\ubcf8",leftX:35,rightX:65,y:45,size:6},{id:"big",name:"\ud070 \ub208",leftX:35,rightX:65,y:45,size:8},{id:"small",name:"\uc791\uc740 \ub208",leftX:35,rightX:65,y:45,size:4},{id:"almond",name:"\uc544\ubaac\ub4dc\ud615",leftX:35,rightX:65,y:45,size:6,shape:"almond"},{id:"round",name:"\ub3d9\uadf8\ub780 \ub208",leftX:35,rightX:65,y:45,size:7,shape:"round"}],xe=[{id:"black",name:"\uac80\uc740\uc0c9",color:"#1a1a1a"},{id:"brown",name:"\uac08\uc0c9",color:"#654321"},{id:"hazel",name:"\ud5e4\uc774\uc990",color:"#8E7618"},{id:"blue",name:"\ud30c\ub780\uc0c9",color:"#1E90FF"},{id:"green",name:"\ucd08\ub85d\uc0c9",color:"#228B22"},{id:"gray",name:"\ud68c\uc0c9",color:"#696969"}],he=[{id:"smile",name:"\ubbf8\uc18c",path:"M35,65 Q50,75 65,65",stroke:!0},{id:"grin",name:"\ud65c\uc9dd \uc6c3\uc74c",path:"M30,62 Q50,80 70,62",stroke:!0},{id:"neutral",name:"\ubb34\ud45c\uc815",path:"M38,65 L62,65",stroke:!0},{id:"small_smile",name:"\uc791\uc740 \ubbf8\uc18c",path:"M40,65 Q50,70 60,65",stroke:!0},{id:"open",name:"\ubc8c\ub9b0 \uc785",path:"M35,63 Q50,75 65,63 Q50,80 35,63",fill:!0}],ge=["round","oval","square","heart","long"],fe=[{id:"none",name:"\ubbfc\uba38\ub9ac",paths:[],compatibleFaces:ge},{id:"short",name:"\uc9e7\uc740 \uba38\ub9ac",paths:["M15,28 Q15,8 50,5 Q85,8 85,28 Q85,18 50,15 Q15,18 15,28 Z"],compatibleFaces:ge},{id:"medium",name:"\uc911\uac04 \uba38\ub9ac",paths:["M8,50 Q5,15 50,2 Q95,15 92,50 L88,48 Q88,20 50,12 Q12,20 12,48 Z"],bangsPath:"M20,22 Q35,32 50,30 Q65,32 80,22 L80,12 Q65,22 50,20 Q35,22 20,12 Z",compatibleFaces:ge},{id:"long",name:"\uae34 \uba38\ub9ac",paths:["M3,95 Q-2,40 50,0 Q102,40 97,95 L92,90 Q92,35 50,10 Q8,35 8,90 Z"],bangsPath:"M15,25 Q30,38 50,35 Q70,38 85,25 L85,10 Q70,25 50,22 Q30,25 15,10 Z",compatibleFaces:ge},{id:"bob",name:"\ub2e8\ubc1c",paths:["M5,70 L5,30 Q5,5 50,2 Q95,5 95,30 L95,70 Q95,75 90,75 L85,55 Q85,20 50,12 Q15,20 15,55 L10,75 Q5,75 5,70 Z"],bangsPath:"M15,30 L20,18 Q35,30 50,28 Q65,30 80,18 L85,30 Q70,38 50,35 Q30,38 15,30 Z",compatibleFaces:ge},{id:"ponytail",name:"\ud3ec\ub2c8\ud14c\uc77c",paths:["M15,35 Q12,12 50,5 Q88,12 85,35 Q85,22 50,15 Q15,22 15,35 Z","M75,15 Q95,10 100,25 Q105,50 95,75 Q90,85 82,70 Q88,50 85,30 Q82,20 75,15 Z"],compatibleFaces:ge},{id:"twintail",name:"\ud2b8\uc708\ud14c\uc77c",paths:["M18,35 Q15,12 50,5 Q85,12 82,35 Q82,22 50,15 Q18,22 18,35 Z","M12,35 Q0,40 -5,55 Q-8,80 5,90 Q12,85 8,65 Q5,50 12,35 Z","M88,35 Q100,40 105,55 Q108,80 95,90 Q88,85 92,65 Q95,50 88,35 Z"],compatibleFaces:ge},{id:"curly",name:"\uacf1\uc2ac\uba38\ub9ac",paths:["M0,55 Q-5,25 50,0 Q105,25 100,55 Q100,35 50,12 Q0,35 0,55 Z","M5,40 Q-2,50 5,60 Q-2,70 5,75 Q12,65 8,55 Q12,45 5,40 Z","M95,40 Q102,50 95,60 Q102,70 95,75 Q88,65 92,55 Q88,45 95,40 Z"],compatibleFaces:ge},{id:"mohawk",name:"\ubaa8\ud788\uce78",paths:["M35,25 L40,-5 L45,-15 L50,-20 L55,-15 L60,-5 L65,25 Q60,20 50,18 Q40,20 35,25 Z"],compatibleFaces:ge}],be=[{id:"black",name:"\uac80\uc740\uc0c9",color:"#1a1a1a"},{id:"dark_brown",name:"\uc9c4\ud55c \uac08\uc0c9",color:"#3d2314"},{id:"brown",name:"\uac08\uc0c9",color:"#6b4423"},{id:"light_brown",name:"\ubc1d\uc740 \uac08\uc0c9",color:"#a0522d"},{id:"blonde",name:"\uae08\ubc1c",color:"#f4d03f"},{id:"red",name:"\ube68\uac04\uc0c9",color:"#c0392b"},{id:"orange",name:"\uc8fc\ud669\uc0c9",color:"#e67e22"},{id:"pink",name:"\ud551\ud06c",color:"#ff69b4"},{id:"purple",name:"\ubcf4\ub77c\uc0c9",color:"#9b59b6"},{id:"blue",name:"\ud30c\ub780\uc0c9",color:"#3498db"},{id:"green",name:"\ucd08\ub85d\uc0c9",color:"#27ae60"},{id:"gray",name:"\ud68c\uc0c9",color:"#7f8c8d"},{id:"white",name:"\ud770\uc0c9",color:"#ecf0f1"},{id:"rainbow",name:"\ubb34\uc9c0\uac1c",gradient:["#ff0000","#ff7f00","#ffff00","#00ff00","#0000ff","#8b00ff"]}],ye=[{id:"none",name:"\uc5c6\uc74c",color:null},{id:"tshirt",name:"\ud2f0\uc154\uce20",baseColor:"#3498db",path:"M20,95 L15,120 L85,120 L80,95 Q78,88 65,88 L58,92 L42,92 L35,88 Q22,88 20,95",sleeves:"M20,95 L8,105 L15,110 L22,100 M80,95 L92,105 L85,110 L78,100"},{id:"suit",name:"\uc815\uc7a5",baseColor:"#2c3e50",path:"M18,95 L15,120 L85,120 L82,95 Q80,88 65,88 L58,92 L42,92 L35,88 Q20,88 18,95",tie:!0,lapels:!0},{id:"hoodie",name:"\ud6c4\ub4dc\ud2f0",baseColor:"#e74c3c",path:"M15,95 L12,120 L88,120 L85,95 Q82,86 65,86 L58,90 L42,90 L35,86 Q18,86 15,95",hood:!0,pocket:!0},{id:"dress",name:"\uc6d0\ud53c\uc2a4",baseColor:"#9b59b6",path:"M28,92 L22,125 L78,125 L72,92 Q70,88 60,88 L55,92 L45,92 L40,88 Q30,88 28,92"},{id:"uniform",name:"\uad50\ubcf5",baseColor:"#34495e",path:"M20,95 L18,120 L82,120 L80,95 Q78,88 65,88 L58,92 L42,92 L35,88 Q22,88 20,95",collar:!0,buttons:!0}],je=[{id:"blue",name:"\ud30c\ub780\uc0c9",color:"#3498db"},{id:"red",name:"\ube68\uac04\uc0c9",color:"#e74c3c"},{id:"green",name:"\ucd08\ub85d\uc0c9",color:"#27ae60"},{id:"purple",name:"\ubcf4\ub77c\uc0c9",color:"#9b59b6"},{id:"yellow",name:"\ub178\ub780\uc0c9",color:"#f1c40f"},{id:"orange",name:"\uc8fc\ud669\uc0c9",color:"#e67e22"},{id:"pink",name:"\ud551\ud06c",color:"#ff69b4"},{id:"black",name:"\uac80\uc740\uc0c9",color:"#2c3e50"},{id:"white",name:"\ud770\uc0c9",color:"#ecf0f1"},{id:"navy",name:"\ub124\uc774\ube44",color:"#2c3e50"}],ve=[{id:"none",name:"\uc5c6\uc74c"},{id:"glasses",name:"\uc548\uacbd",path:"M25,43 L28,43 A8,8 0 1,1 42,43 L58,43 A8,8 0 1,1 72,43 L75,43",color:"#1a1a1a"},{id:"sunglasses",name:"\uc120\uae00\ub77c\uc2a4",path:"M22,40 L25,40 C25,40 25,50 35,50 C45,50 45,40 45,40 L55,40 C55,40 55,50 65,50 C75,50 75,40 75,40 L78,40",color:"#1a1a1a",fill:!0},{id:"earrings",name:"\uadc0\uac78\uc774",type:"earrings",color:"#f1c40f"},{id:"necklace",name:"\ubaa9\uac78\uc774",path:"M35,88 Q50,95 65,88",color:"#f1c40f"},{id:"hat",name:"\ubaa8\uc790",path:"M15,15 L85,15 L85,5 Q50,-5 15,5 Z",color:"#e74c3c"},{id:"crown",name:"\uc655\uad00",type:"crown",color:"#f1c40f"},{id:"headband",name:"\uba38\ub9ac\ub760",path:"M12,25 Q50,18 88,25",color:"#ff69b4"},{id:"bow",name:"\ub9ac\ubcf8",type:"bow",color:"#ff69b4"},{id:"mask",name:"\ub9c8\uc2a4\ud06c",path:"M25,55 Q50,70 75,55 L75,65 Q50,80 25,65 Z",color:"#ffffff"}],we=[{id:"none",name:"\uc5c6\uc74c",color:"transparent"},{id:"sky_blue",name:"\ud558\ub298\uc0c9",color:"#87CEEB"},{id:"sunset",name:"\uc11d\uc591",gradient:["#ff7e5f","#feb47b"]},{id:"night",name:"\ubc24\ud558\ub298",gradient:["#0f0c29","#302b63","#24243e"]},{id:"forest",name:"\uc232",gradient:["#134e5e","#71b280"]},{id:"ocean",name:"\ubc14\ub2e4",gradient:["#2193b0","#6dd5ed"]},{id:"pink",name:"\ud551\ud06c",gradient:["#ee9ca7","#ffdde1"]},{id:"purple",name:"\ubcf4\ub77c",gradient:["#667eea","#764ba2"]},{id:"gold",name:"\uace8\ub4dc",gradient:["#f7971e","#ffd200"]},{id:"rainbow",name:"\ubb34\uc9c0\uac1c",gradient:["#ff0000","#ff7f00","#ffff00","#00ff00","#0000ff","#8b00ff"]},{id:"galaxy",name:"\uc740\ud558\uc218",gradient:["#0f0c29","#302b63","#24243e"],stars:!0}],Ne=[{id:"none",name:"\uc5c6\uc74c",style:null},{id:"simple",name:"\ub2e8\uc21c",color:"#ffffff",width:3},{id:"gold",name:"\uace8\ub4dc",color:"#f1c40f",width:4,glow:!0},{id:"silver",name:"\uc2e4\ubc84",color:"#bdc3c7",width:4,glow:!0},{id:"bronze",name:"\ube0c\ub860\uc988",color:"#cd7f32",width:4,glow:!0},{id:"rainbow",name:"\ubb34\uc9c0\uac1c",gradient:["#ff0000","#ff7f00","#ffff00","#00ff00","#0000ff","#8b00ff"],width:4,animated:!0},{id:"neon_blue",name:"\ub124\uc628 \ube14\ub8e8",color:"#00fff2",width:3,glow:!0,glowColor:"#00fff2"},{id:"neon_pink",name:"\ub124\uc628 \ud551\ud06c",color:"#ff69b4",width:3,glow:!0,glowColor:"#ff69b4"},{id:"fire",name:"\ubd88\uaf43",gradient:["#ff4500","#ff6347","#ffa500"],width:4,animated:!0},{id:"ice",name:"\uc5bc\uc74c",gradient:["#00bfff","#87ceeb","#e0ffff"],width:4,glow:!0}],Ce=[{id:"normal",name:"\uae30\ubcf8",eyeMod:null,mouthMod:null},{id:"happy",name:"\ud589\ubcf5",eyeMod:"happy",mouthMod:"grin"},{id:"sad",name:"\uc2ac\ud514",eyeMod:"sad",mouthMod:"sad"},{id:"angry",name:"\ud654\ub0a8",eyeMod:"angry",mouthMod:"angry"},{id:"surprised",name:"\ub180\ub78c",eyeMod:"wide",mouthMod:"open"},{id:"wink",name:"\uc719\ud06c",eyeMod:"wink",mouthMod:"smile"},{id:"love",name:"\uc0ac\ub791",eyeMod:"hearts",mouthMod:"smile"},{id:"cool",name:"\uba4b\uc9d0",eyeMod:"sunglasses",mouthMod:"smirk"}],ke={skinTone:"light",faceShape:"oval",eyeStyle:"normal",eyeColor:"brown",mouthStyle:"smile",hairstyle:"short",hairColor:"black",outfit:"tshirt",outfitColor:"blue",accessory:"none",background:"sky_blue",border:"simple",expression:"normal"};function Se(e){try{const t=localStorage.getItem("avatar_".concat(e));if(t)return(0,l.A)((0,l.A)({},ke),JSON.parse(t))}catch(t){}return(0,l.A)({},ke)}function Ae(e){switch(e){case"skinTone":return pe;case"faceShape":return ue;case"eyeStyle":return me;case"eyeColor":return xe;case"mouthStyle":return he;case"hairstyle":return fe;case"hairColor":return be;case"outfit":return ye;case"outfitColor":return je;case"accessory":return ve;case"background":return we;case"border":return Ne;case"expression":return Ce;default:return[]}}function Ie(e,t){const s=fe.find(t=>t.id===e);return!s||s.compatibleFaces.includes(t)}const Ee=[{id:"skinTone",name:"\ud53c\ubd80",icon:"#FFE4C4"},{id:"faceShape",name:"\uc5bc\uad74",icon:"#F5DEB3"},{id:"eyeStyle",name:"\ub208",icon:"#1E90FF"},{id:"eyeColor",name:"\ub208\uc0c9",icon:"#654321"},{id:"mouthStyle",name:"\uc785",icon:"#e74c3c"},{id:"hairstyle",name:"\ud5e4\uc5b4",icon:"#3d2314"},{id:"hairColor",name:"\uba38\ub9ac\uc0c9",icon:"#1a1a1a"},{id:"outfit",name:"\uc758\uc0c1",icon:"#3498db"},{id:"outfitColor",name:"\uc758\uc0c1\uc0c9",icon:"#e74c3c"},{id:"accessory",name:"\uc545\uc138",icon:"#f1c40f"},{id:"background",name:"\ubc30\uacbd",icon:"#87CEEB"},{id:"border",name:"\ud14c\ub450\ub9ac",icon:"#a78bfa"}];function Te(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if(!e||"none"===e||"transparent"===e)return e;let s=parseInt(e.slice(1,3),16),a=parseInt(e.slice(3,5),16),n=parseInt(e.slice(5,7),16);return s=Math.max(0,Math.floor(s*(100-t)/100)),a=Math.max(0,Math.floor(a*(100-t)/100)),n=Math.max(0,Math.floor(n*(100-t)/100)),"#".concat(s.toString(16).padStart(2,"0")).concat(a.toString(16).padStart(2,"0")).concat(n.toString(16).padStart(2,"0"))}function Me(e){let{config:t={},size:s=100,showBorder:a=!0,onClick:n}=e;const i=(0,l.A)((0,l.A)({},ke),t),o=pe.find(e=>e.id===i.skinTone)||pe[1],r=ue.find(e=>e.id===i.faceShape)||ue[1],d=me.find(e=>e.id===i.eyeStyle)||me[0],c=xe.find(e=>e.id===i.eyeColor)||xe[1],p=he.find(e=>e.id===i.mouthStyle)||he[0],u=fe.find(e=>e.id===i.hairstyle)||fe[1],m=be.find(e=>e.id===i.hairColor)||be[0],x=ye.find(e=>e.id===i.outfit)||ye[1],h=je.find(e=>e.id===i.outfitColor)||je[0],g=ve.find(e=>e.id===i.accessory),f=we.find(e=>e.id===i.background)||we[0],b=Ne.find(e=>e.id===i.border),y=Te(o.color,12),j=b&&"none"!==b.id&&a?{stroke:b.gradient?"url(#border-gradient-".concat(b.id,")"):b.color,strokeWidth:b.width||3,filter:b.glow?"drop-shadow(0 0 ".concat(2*b.width,"px ").concat(b.glowColor||b.color,")"):void 0}:null,v=()=>null!==m&&void 0!==m&&m.gradient?"url(#hair-rainbow)":(null===m||void 0===m?void 0:m.color)||"#1a1a1a";return(0,L.jsxs)("svg",{width:s,height:s,viewBox:"-15 ".concat(-25," 130 ").concat(150),onClick:n,style:{cursor:n?"pointer":"default",overflow:"visible"},preserveAspectRatio:"xMidYMid meet",children:[(0,L.jsxs)("defs",{children:[(null===f||void 0===f?void 0:f.gradient)&&(0,L.jsx)("linearGradient",{id:"bg-gradient-".concat(f.id),x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:f.gradient.map((e,t)=>(0,L.jsx)("stop",{offset:"".concat(t/(f.gradient.length-1)*100,"%"),stopColor:e},t))}),(null===b||void 0===b?void 0:b.gradient)&&(0,L.jsx)("linearGradient",{id:"border-gradient-".concat(b.id),x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:b.gradient.map((e,t)=>(0,L.jsx)("stop",{offset:"".concat(t/(b.gradient.length-1)*100,"%"),stopColor:e},t))}),(null===m||void 0===m?void 0:m.gradient)&&(0,L.jsx)("linearGradient",{id:"hair-rainbow",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:m.gradient.map((e,t)=>(0,L.jsx)("stop",{offset:"".concat(t/(m.gradient.length-1)*100,"%"),stopColor:e},t))}),(0,L.jsx)("filter",{id:"shadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:(0,L.jsx)("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.3"})}),(0,L.jsx)("clipPath",{id:"face-clip",children:(0,L.jsx)("path",{d:r.path})})]}),f&&"none"!==f.id&&(0,L.jsx)("rect",{x:"-15",y:-25,width:"130",height:150,fill:f&&"none"!==f.id?f.gradient?"url(#bg-gradient-".concat(f.id,")"):f.color:"#1a1a2e",rx:"10"}),(null===f||void 0===f?void 0:f.stars)&&(0,L.jsxs)("g",{children:[(0,L.jsx)("circle",{cx:"15",cy:"10",r:"1.5",fill:"white",opacity:"0.9"}),(0,L.jsx)("circle",{cx:"85",cy:"15",r:"2",fill:"white",opacity:"0.8"}),(0,L.jsx)("circle",{cx:"45",cy:"-5",r:"1.2",fill:"white",opacity:"0.9"}),(0,L.jsx)("circle",{cx:"70",cy:"0",r:"1.5",fill:"white",opacity:"0.7"}),(0,L.jsx)("circle",{cx:"25",cy:"20",r:"1",fill:"white",opacity:"0.8"}),(0,L.jsx)("circle",{cx:"95",cy:"25",r:"1.2",fill:"white",opacity:"0.7"}),(0,L.jsx)("circle",{cx:"5",cy:"30",r:"1.5",fill:"white",opacity:"0.6"}),(0,L.jsx)("circle",{cx:"60",cy:"100",r:"1",fill:"white",opacity:"0.9"}),(0,L.jsx)("circle",{cx:"30",cy:"110",r:"1.2",fill:"white",opacity:"0.7"})]}),(0,L.jsx)("rect",{x:"42",y:"85",width:"16",height:"12",fill:o.color}),x&&"none"!==x.id&&(0,L.jsxs)("g",{children:[(0,L.jsx)("path",{d:x.path,fill:(null===h||void 0===h?void 0:h.color)||x.baseColor}),x.collar&&(0,L.jsx)("g",{children:(0,L.jsx)("path",{d:"M40,95 L50,103 L60,95",stroke:"#ffffff",strokeWidth:"3",fill:"none"})}),x.buttons&&(0,L.jsxs)("g",{children:[(0,L.jsx)("circle",{cx:"50",cy:"103",r:"2",fill:"#f1c40f"}),(0,L.jsx)("circle",{cx:"50",cy:"110",r:"2",fill:"#f1c40f"})]}),x.tie&&(0,L.jsxs)("g",{children:[(0,L.jsx)("path",{d:"M47,95 L50,98 L53,95",fill:"#c0392b"}),(0,L.jsx)("path",{d:"M48,98 L50,118 L52,98 Z",fill:"#e74c3c"})]}),x.hood&&(0,L.jsx)("path",{d:"M25,92 Q22,80 35,75 L65,75 Q78,80 75,92",fill:Te((null===h||void 0===h?void 0:h.color)||x.baseColor,15)})]}),(0,L.jsxs)("g",{children:[(()=>{const e={round:{leftX:7,rightX:93,y:50},oval:{leftX:9,rightX:91,y:48},square:{leftX:7,rightX:93,y:50},heart:{leftX:7,rightX:93,y:48},long:{leftX:17,rightX:83,y:50}},t=e[r.id]||e.round;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("ellipse",{cx:t.leftX,cy:t.y,rx:"5",ry:"8",fill:o.color}),(0,L.jsx)("ellipse",{cx:t.leftX+1,cy:t.y,rx:"2",ry:"4",fill:Te(o.color,12)}),(0,L.jsx)("ellipse",{cx:t.rightX,cy:t.y,rx:"5",ry:"8",fill:o.color}),(0,L.jsx)("ellipse",{cx:t.rightX-1,cy:t.y,rx:"2",ry:"4",fill:Te(o.color,12)})]})})(),(0,L.jsx)("path",{d:r.path,fill:o.color}),(0,L.jsx)("ellipse",{cx:"30",cy:"60",rx:"8",ry:"5",fill:"#ffb6c1",opacity:"0.3"}),(0,L.jsx)("ellipse",{cx:"70",cy:"60",rx:"8",ry:"5",fill:"#ffb6c1",opacity:"0.3"})]}),(0,L.jsxs)("g",{children:[(0,L.jsx)("ellipse",{cx:d.leftX,cy:d.y,rx:d.size,ry:.75*d.size,fill:"white"}),(0,L.jsx)("circle",{cx:d.leftX,cy:d.y,r:.55*d.size,fill:c.color}),(0,L.jsx)("circle",{cx:d.leftX-1,cy:d.y-1,r:.22*d.size,fill:"white"}),(0,L.jsx)("ellipse",{cx:d.rightX,cy:d.y,rx:d.size,ry:.75*d.size,fill:"white"}),(0,L.jsx)("circle",{cx:d.rightX,cy:d.y,r:.55*d.size,fill:c.color}),(0,L.jsx)("circle",{cx:d.rightX-1,cy:d.y-1,r:.22*d.size,fill:"white"}),(0,L.jsx)("path",{d:"M".concat(d.leftX-7,",").concat(d.y-11," Q").concat(d.leftX,",").concat(d.y-14," ").concat(d.leftX+7,",").concat(d.y-11),stroke:null!==m&&void 0!==m&&m.gradient?"#1a1a1a":(null===m||void 0===m?void 0:m.color)||"#1a1a1a",strokeWidth:"2.5",fill:"none",strokeLinecap:"round"}),(0,L.jsx)("path",{d:"M".concat(d.rightX-7,",").concat(d.y-11," Q").concat(d.rightX,",").concat(d.y-14," ").concat(d.rightX+7,",").concat(d.y-11),stroke:null!==m&&void 0!==m&&m.gradient?"#1a1a1a":(null===m||void 0===m?void 0:m.color)||"#1a1a1a",strokeWidth:"2.5",fill:"none",strokeLinecap:"round"})]}),(0,L.jsx)("path",{d:"M48,53 L50,60 L52,53",stroke:y,strokeWidth:"2.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),(0,L.jsx)("path",{d:p.path,stroke:p.stroke?"#c0392b":"none",strokeWidth:"2.5",fill:p.fill?"#c0392b":"none",strokeLinecap:"round"}),u&&"none"!==u.id&&(0,L.jsxs)("g",{children:[u.paths&&u.paths[0]&&(0,L.jsx)("path",{d:u.paths[0],fill:v(),stroke:"#1a1a1a"===(null===m||void 0===m?void 0:m.color)?"#333":"none",strokeWidth:"1"}),u.paths&&u.paths.slice(1).map((e,t)=>(0,L.jsx)("path",{d:e,fill:v(),stroke:"#1a1a1a"===(null===m||void 0===m?void 0:m.color)?"#333":"none",strokeWidth:"1"},"hair-".concat(t))),u.bangsPath&&(0,L.jsx)("path",{d:u.bangsPath,fill:v(),stroke:"#1a1a1a"===(null===m||void 0===m?void 0:m.color)?"#333":"none",strokeWidth:"1"})]}),g&&"none"!==g.id&&(0,L.jsxs)("g",{children:["glasses"===g.id&&(0,L.jsxs)("g",{children:[(0,L.jsx)("circle",{cx:"35",cy:"45",r:"10",fill:"none",stroke:"#1a1a1a",strokeWidth:"2"}),(0,L.jsx)("circle",{cx:"65",cy:"45",r:"10",fill:"none",stroke:"#1a1a1a",strokeWidth:"2"}),(0,L.jsx)("path",{d:"M45,45 Q50,42 55,45",fill:"none",stroke:"#1a1a1a",strokeWidth:"2"}),(0,L.jsx)("path",{d:"M25,45 L10,42",stroke:"#1a1a1a",strokeWidth:"2"}),(0,L.jsx)("path",{d:"M75,45 L90,42",stroke:"#1a1a1a",strokeWidth:"2"})]}),"sunglasses"===g.id&&(0,L.jsxs)("g",{children:[(0,L.jsx)("ellipse",{cx:"35",cy:"45",rx:"12",ry:"8",fill:"#1a1a1a"}),(0,L.jsx)("ellipse",{cx:"65",cy:"45",rx:"12",ry:"8",fill:"#1a1a1a"}),(0,L.jsx)("path",{d:"M47,45 Q50,42 53,45",fill:"none",stroke:"#1a1a1a",strokeWidth:"2"}),(0,L.jsx)("path",{d:"M23,45 L8,42",stroke:"#1a1a1a",strokeWidth:"2"}),(0,L.jsx)("path",{d:"M77,45 L92,42",stroke:"#1a1a1a",strokeWidth:"2"}),(0,L.jsx)("ellipse",{cx:"32",cy:"43",rx:"3",ry:"2",fill:"white",opacity:"0.3"}),(0,L.jsx)("ellipse",{cx:"62",cy:"43",rx:"3",ry:"2",fill:"white",opacity:"0.3"})]}),"earrings"===g.id&&(0,L.jsxs)("g",{children:[(0,L.jsx)("circle",{cx:"6",cy:"58",r:"4",fill:"#f1c40f"}),(0,L.jsx)("circle",{cx:"94",cy:"58",r:"4",fill:"#f1c40f"}),(0,L.jsx)("circle",{cx:"5",cy:"56",r:"1",fill:"white",opacity:"0.6"}),(0,L.jsx)("circle",{cx:"93",cy:"56",r:"1",fill:"white",opacity:"0.6"})]}),"necklace"===g.id&&(0,L.jsxs)("g",{children:[(0,L.jsx)("path",{d:"M30,88 Q50,95 70,88",fill:"none",stroke:"#f1c40f",strokeWidth:"2"}),(0,L.jsx)("circle",{cx:"50",cy:"94",r:"4",fill:"#f1c40f"}),(0,L.jsx)("circle",{cx:"49",cy:"92",r:"1",fill:"white",opacity:"0.5"})]}),"hat"===g.id&&(0,L.jsxs)("g",{children:[(0,L.jsx)("ellipse",{cx:"50",cy:"8",rx:"45",ry:"8",fill:"#e74c3c"}),(0,L.jsx)("path",{d:"M15,8 Q15,-15 50,-18 Q85,-15 85,8",fill:"#e74c3c"}),(0,L.jsx)("rect",{x:"15",y:"5",width:"70",height:"5",fill:"#c0392b"})]}),"crown"===g.id&&(0,L.jsxs)("g",{children:[(0,L.jsx)("path",{d:"M18,12 L22,0 L32,-12 L42,5 L50,-15 L58,5 L68,-12 L78,0 L82,12 Z",fill:"#f1c40f",stroke:"#d4ac0d",strokeWidth:"1"}),(0,L.jsx)("circle",{cx:"32",cy:"-2",r:"4",fill:"#e74c3c"}),(0,L.jsx)("circle",{cx:"50",cy:"-5",r:"5",fill:"#3498db"}),(0,L.jsx)("circle",{cx:"68",cy:"-2",r:"4",fill:"#2ecc71"}),(0,L.jsx)("circle",{cx:"31",cy:"-4",r:"1.5",fill:"white",opacity:"0.5"}),(0,L.jsx)("circle",{cx:"49",cy:"-7",r:"2",fill:"white",opacity:"0.5"}),(0,L.jsx)("circle",{cx:"67",cy:"-4",r:"1.5",fill:"white",opacity:"0.5"})]}),"headband"===g.id&&(0,L.jsx)("path",{d:"M10,22 Q50,15 90,22",fill:"none",stroke:"#ff69b4",strokeWidth:"4"}),"bow"===g.id&&(0,L.jsxs)("g",{transform:"translate(78, 15)",children:[(0,L.jsx)("ellipse",{cx:"-10",cy:"0",rx:"10",ry:"6",fill:"#ff69b4"}),(0,L.jsx)("ellipse",{cx:"10",cy:"0",rx:"10",ry:"6",fill:"#ff69b4"}),(0,L.jsx)("circle",{cx:"0",cy:"0",r:"5",fill:"#e91e8c"})]}),"mask"===g.id&&(0,L.jsxs)("g",{children:[(0,L.jsx)("path",{d:"M20,55 Q50,72 80,55 L80,70 Q50,88 20,70 Z",fill:"#ffffff",stroke:"#e0e0e0",strokeWidth:"1"}),(0,L.jsx)("path",{d:"M35,62 L65,62",stroke:"#e0e0e0",strokeWidth:"1"})]})]}),j&&a&&(0,L.jsx)("rect",{x:"-13",y:-23,width:"126",height:146,fill:"none",stroke:j.stroke,strokeWidth:j.strokeWidth,rx:"12",style:{filter:j.filter}})]})}const De=[{level:0,minAssets:0,title:"\uacbd\uc81c \uc785\ubb38\uc790",icon:"\ud83c\udf31",color:"#6b7280",badge:"\ud83c\udfc5",description:"\uacbd\uc81c \uc5ec\uc815\uc758 \uc2dc\uc791"},{level:1,minAssets:1e7,title:"\ucc9c\ub9cc\uc7a5\uc790",icon:"\ud83d\udcb0",color:"#22c55e",badge:"\ud83e\udd49",description:"\uccab \ucc9c\ub9cc\uc6d0 \ub2ec\uc131!"},{level:2,minAssets:5e7,title:"\uc624\ucc9c\ub9cc \ud074\ub7fd",icon:"\ud83d\udcb5",color:"#84cc16",badge:"\ud83e\udd48",description:"\ubc18\uc5b5 \ub3cc\ud30c!"},{level:3,minAssets:1e8,title:"\uc5b5\ub300 \uc790\uc0b0\uac00",icon:"\ud83d\udc8e",color:"#eab308",badge:"\ud83e\udd47",description:"\uc5b5\ub300 \uc790\uc0b0 \ubcf4\uc720\uc790"},{level:4,minAssets:2e8,title:"\uc790\uc0b0 \uad00\ub9ac\uc0ac",icon:"\ud83d\udcca",color:"#f97316",badge:"\ud83c\udfc6",description:"2\uc5b5 \uc790\uc0b0 \ub2ec\uc131"},{level:5,minAssets:3e8,title:"\ud22c\uc790 \uc804\ubb38\uac00",icon:"\ud83d\udcc8",color:"#ef4444",badge:"\ud83d\udcab",description:"3\uc5b5 \uace0\uc9c0 \uc810\ub839"},{level:6,minAssets:5e8,title:"\ubd80\ub3d9\uc0b0 \uc655",icon:"\ud83c\udfe2",color:"#ec4899",badge:"\u2b50",description:"5\uc5b5 \uc790\uc0b0\uac00"},{level:7,minAssets:1e9,title:"10\uc5b5 \ud074\ub7fd",icon:"\ud83d\udc51",color:"#a855f7",badge:"\ud83c\udf1f",description:"10\uc5b5 \ub3cc\ud30c! \uc9c4\uc815\ud55c \ubd80\uc790"},{level:8,minAssets:5e9,title:"\uacbd\uc81c \uac70\ubb3c",icon:"\ud83e\udd81",color:"#8b5cf6",badge:"\ud83d\udc8e",description:"50\uc5b5 \uc790\uc0b0\uc758 \uac70\ubb3c"},{level:9,minAssets:1e10,title:"100\uc5b5 \uc7ac\ubc8c",icon:"\ud83d\udc09",color:"#6366f1",badge:"\ud83d\udc51",description:"100\uc5b5! \uc7ac\ubc8c\uc758 \ubc18\uc5f4"},{level:10,minAssets:5e10,title:"\uacbd\uc81c \ud669\uc81c",icon:"\ud83c\udff0",color:"#3b82f6",badge:"\ud83c\udfef",description:"500\uc5b5 \uacbd\uc81c \ud669\uc81c"},{level:11,minAssets:1e11,title:"\ucc9c\uc5b5 \ud0c0\uc774\ucfe4",icon:"\ud83c\udf0d",color:"#0ea5e9",badge:"\ud83c\udf0d",description:"1000\uc5b5! \uae00\ub85c\ubc8c \ud0c0\uc774\ucfe4"},{level:12,minAssets:1e12,title:"\uc54c\ucc2c \uc804\uc124",icon:"\ud83c\udf0c",color:"#00fff2",badge:"\ud83c\udf0c",description:"1\uc870 \ub2ec\uc131! \uc804\uc124\uc774 \ub418\ub2e4"}];function Re(e){const t=Number(e)||0;let s=De[0];for(let o=De.length-1;o>=0;o--)if(t>=De[o].minAssets){s=De[o];break}const a=De.findIndex(e=>e.level===s.level+1),n=-1!==a?De[a]:null;let i=100;if(n){const e=s.minAssets,a=n.minAssets;i=Math.min(100,Math.floor((t-e)/(a-e)*100))}return{level:s.level,title:s.title,icon:s.icon,color:s.color,badge:s.badge,description:s.description,progress:i,nextLevel:n,currentAssets:t,assetsToNextLevel:n?n.minAssets-t:0}}const ze={FIRST_THOUSAND:{id:"first_thousand",name:"\uccab \ucc9c \uc6d0",description:"1,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83e\ude99",category:"wealth",condition:e=>e.totalAssets>=1e3,rarity:"common",points:10},FIRST_TEN_THOUSAND:{id:"first_ten_thousand",name:"\ub9cc \uc6d0\uc758 \uae30\uc068",description:"10,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83d\udcb5",category:"wealth",condition:e=>e.totalAssets>=1e4,rarity:"common",points:25},HUNDRED_THOUSAND:{id:"hundred_thousand",name:"10\ub9cc \uc6d0 \ud074\ub7fd",description:"100,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83d\udcb0",category:"wealth",condition:e=>e.totalAssets>=1e5,rarity:"uncommon",points:50},MILLIONAIRE:{id:"millionaire",name:"\ubc31\ub9cc\uc7a5\uc790",description:"1,000,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83e\udd11",category:"wealth",condition:e=>e.totalAssets>=1e6,rarity:"rare",points:100},MULTI_MILLIONAIRE:{id:"multi_millionaire",name:"\ucc9c\ub9cc\uc7a5\uc790",description:"10,000,000\uc6d0 \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83d\udc8e",category:"wealth",condition:e=>e.totalAssets>=1e7,rarity:"legendary",points:500},COUPON_COLLECTOR:{id:"coupon_collector",name:"\ucfe0\ud3f0 \uc218\uc9d1\uac00",description:"\ucfe0\ud3f0 10\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udf9f\ufe0f",category:"coupon",condition:e=>e.coupons>=10,rarity:"common",points:15},COUPON_MASTER:{id:"coupon_master",name:"\ucfe0\ud3f0 \ub9c8\uc2a4\ud130",description:"\ucfe0\ud3f0 50\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udfab",category:"coupon",condition:e=>e.coupons>=50,rarity:"uncommon",points:40},COUPON_HOARDER:{id:"coupon_hoarder",name:"\ucfe0\ud3f0 \ubd80\uc790",description:"\ucfe0\ud3f0 100\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udff7\ufe0f",category:"coupon",condition:e=>e.coupons>=100,rarity:"rare",points:80},FIRST_TRADE:{id:"first_trade",name:"\uccab \uac70\ub798",description:"\uccab \ubc88\uc9f8 \uac70\ub798 \uc644\ub8cc\ud558\uae30",icon:"\ud83e\udd1d",category:"trading",condition:e=>e.totalTransactions>=1,rarity:"common",points:10},ACTIVE_TRADER:{id:"active_trader",name:"\ud65c\ubc1c\ud55c \uac70\ub798\uc790",description:"10\ud68c \uc774\uc0c1 \uac70\ub798\ud558\uae30",icon:"\ud83d\udcca",category:"trading",condition:e=>e.totalTransactions>=10,rarity:"common",points:25},TRADING_EXPERT:{id:"trading_expert",name:"\uac70\ub798 \uc804\ubb38\uac00",description:"50\ud68c \uc774\uc0c1 \uac70\ub798\ud558\uae30",icon:"\ud83d\udcc8",category:"trading",condition:e=>e.totalTransactions>=50,rarity:"uncommon",points:50},GENEROUS_HEART:{id:"generous_heart",name:"\ub530\ub73b\ud55c \ub9c8\uc74c",description:"\ud559\uae09 \ubaa9\ud45c\uc5d0 \ucc98\uc74c\uc73c\ub85c \uae30\ubd80\ud558\uae30",icon:"\u2764\ufe0f",category:"donation",condition:e=>e.totalDonations>=1,rarity:"common",points:20},PHILANTHROPIST:{id:"philanthropist",name:"\uc790\uc120\uac00",description:"\ucd1d 10\uac1c \uc774\uc0c1 \uae30\ubd80\ud558\uae30",icon:"\ud83c\udf81",category:"donation",condition:e=>e.totalDonations>=10,rarity:"uncommon",points:50},DONATION_KING:{id:"donation_king",name:"\uae30\ubd80\uc655",description:"\ucd1d 100\uac1c \uc774\uc0c1 \uae30\ubd80\ud558\uae30",icon:"\ud83d\udc51",category:"donation",condition:e=>e.totalDonations>=100,rarity:"rare",points:150},SAVER_BEGINNER:{id:"saver_beginner",name:"\uc800\ucd95\uc758 \uc2dc\uc791",description:"\uccab \uc608\uae08 \ub610\ub294 \uc801\uae08 \uac00\uc785\ud558\uae30",icon:"\ud83c\udfe6",category:"saving",condition:e=>e.savingProducts>=1,rarity:"common",points:15},SMART_SAVER:{id:"smart_saver",name:"\ub611\ub611\ud55c \uc800\ucd95\ub7ec",description:"\uc608\uae08/\uc801\uae08 3\uac1c \uc774\uc0c1 \uac00\uc785\ud558\uae30",icon:"\ud83d\udcb3",category:"saving",condition:e=>e.savingProducts>=3,rarity:"uncommon",points:40},FIRST_PROPERTY:{id:"first_property",name:"\uccab \ubd80\ub3d9\uc0b0",description:"\uccab \ubc88\uc9f8 \ubd80\ub3d9\uc0b0 \uad6c\ub9e4\ud558\uae30",icon:"\ud83c\udfe0",category:"realestate",condition:e=>e.properties>=1,rarity:"common",points:30},REAL_ESTATE_INVESTOR:{id:"real_estate_investor",name:"\ubd80\ub3d9\uc0b0 \ud22c\uc790\uc790",description:"\ubd80\ub3d9\uc0b0 3\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udfe2",category:"realestate",condition:e=>e.properties>=3,rarity:"uncommon",points:70},PROPERTY_TYCOON:{id:"property_tycoon",name:"\ubd80\ub3d9\uc0b0 \uc7ac\ubc8c",description:"\ubd80\ub3d9\uc0b0 5\uac1c \uc774\uc0c1 \ubcf4\uc720\ud558\uae30",icon:"\ud83c\udff0",category:"realestate",condition:e=>e.properties>=5,rarity:"rare",points:150},PERFECT_ATTENDANCE:{id:"perfect_attendance",name:"\uac1c\uadfc\uc0c1",description:"7\uc77c \uc5f0\uc18d \uc811\uc18d\ud558\uae30",icon:"\ud83d\udcc5",category:"special",condition:e=>e.loginStreak>=7,rarity:"uncommon",points:100},MONTHLY_STREAK:{id:"monthly_streak",name:"\ud55c \ub2ec \ucd9c\uc11d\uc655",description:"30\uc77c \uc5f0\uc18d \uc811\uc18d\ud558\uae30",icon:"\ud83d\uddd3\ufe0f",category:"special",condition:e=>e.loginStreak>=30,rarity:"rare",points:300},EARLY_BIRD:{id:"early_bird",name:"\uc5bc\ub9ac\ubc84\ub4dc",description:"\uc11c\ube44\uc2a4 \ucd08\uae30 \uc0ac\uc6a9\uc790",icon:"\ud83d\udc26",category:"special",condition:()=>!1,rarity:"legendary",points:200}};function Oe(e){return Object.values(ze).find(t=>t.id===e)||null}function _e(e){if(!e)return[];try{const t="alchan_achievements_".concat(e),s=localStorage.getItem(t);return s?JSON.parse(s):[]}catch(t){return console.error("\uc5c5\uc801 \ub370\uc774\ud130 \ub85c\ub4dc \uc2e4\ud328:",t),[]}}var Le=s(8343);const We=e=>(0,Le.FR)(e,""),Be=e=>{let{isOpen:t,onClose:s,title:a,children:n}=e;return t?(0,L.jsx)("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",onClick:s,children:(0,L.jsxs)("div",{className:"bg-[#1a1a2e] rounded-2xl shadow-2xl w-full max-w-md overflow-hidden border border-slate-700",onClick:e=>e.stopPropagation(),children:[(0,L.jsxs)("div",{className:"px-6 py-5 border-b border-slate-700 bg-gradient-to-r from-[#141423] to-indigo-900/20 flex items-center justify-between",children:[(0,L.jsx)("h3",{className:"text-lg font-bold text-white",children:a}),(0,L.jsx)("button",{onClick:s,className:"w-8 h-8 rounded-lg bg-slate-800 hover:bg-slate-700 flex items-center justify-center text-slate-400 transition-colors",children:(0,L.jsx)(O.A,{size:18})})]}),(0,L.jsx)("div",{className:"p-6",children:n})]})}):null},Pe=(0,a.memo)(e=>{let{toggleSidebar:t,isMobile:s,isSidebarCollapsed:o,onToggleSidebarCollapse:l}=e;const d=(0,n.Zp)(),{user:c,userDoc:p,logout:u,updateUser:m,changePassword:x,deleteCurrentUserAccount:h,loginWithEmailPassword:g}=(0,i.As)(),[f,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1),v=(0,a.useRef)(null),[w,C]=(0,a.useState)(null),[k,S]=(0,a.useState)(!1),[A,I]=(0,a.useState)(""),[E,T]=(0,a.useState)(""),[D,R]=(0,a.useState)(""),[z,O]=(0,a.useState)(""),[W,B]=(0,a.useState)(""),[P,F]=(0,a.useState)(""),[q,U]=(0,a.useState)(!1),[Q,H]=(0,a.useState)(""),[$,ee]=(0,a.useState)(""),[te,se]=(0,a.useState)(!1),ae=(null===p||void 0===p?void 0:p.isAdmin)||"admin"===(null===p||void 0===p?void 0:p.role)||(null===p||void 0===p?void 0:p.isSuperAdmin),ne=(null===p||void 0===p?void 0:p.name)||(null===p||void 0===p?void 0:p.nickname)||(null===c||void 0===c?void 0:c.displayName)||"\uc0ac\uc6a9\uc790";let ie="\ud559\uc0dd";null!==p&&void 0!==p&&p.isSuperAdmin?ie="\uc571 \uad00\ub9ac\uc790":null!==p&&void 0!==p&&p.isAdmin&&(ie="\uad50\uc0ac");const[oe,le]=(0,a.useState)(null);(0,a.useEffect)(()=>{null!==c&&void 0!==c&&c.uid&&le(Se(c.uid));const e=e=>{e.detail.userId===(null===c||void 0===c?void 0:c.uid)&&le(e.detail.config)};return window.addEventListener("avatarChanged",e),()=>window.removeEventListener("avatarChanged",e)},[null===c||void 0===c?void 0:c.uid]);const re=(0,a.useMemo)(()=>Re((Number(null===p||void 0===p?void 0:p.cash)||0)+(Number(null===p||void 0===p?void 0:p.stockValue)||0)+(Number(null===p||void 0===p?void 0:p.realEstateValue)||0)+(Number(null===p||void 0===p?void 0:p.itemValue)||0)),[null===p||void 0===p?void 0:p.cash,null===p||void 0===p?void 0:p.stockValue,null===p||void 0===p?void 0:p.realEstateValue,null===p||void 0===p?void 0:p.itemValue]),de=(0,a.useMemo)(()=>{if(null===c||void 0===c||!c.uid)return null;const e=_e(c.uid);if(0===e.length)return null;const t={legendary:0,epic:1,rare:2,common:3},s=[...e].sort((e,s)=>{const a=Oe(e.id),n=Oe(s.id);return(t[null===a||void 0===a?void 0:a.rarity]||99)-(t[null===n||void 0===n?void 0:n.rarity]||99)});return Oe(s[0].id)},[null===c||void 0===c?void 0:c.uid]);(0,a.useEffect)(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&b(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const pe=()=>{C(null),T(""),F(""),U(!1),ee(""),se(!1),R(""),O(""),B("")};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("header",{className:"md:hidden sticky top-0 z-30 bg-[#141423] border-b border-[#00fff2]/10",children:[(0,L.jsxs)("div",{className:"h-14 px-3 flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("button",{onClick:t,className:"p-1.5 rounded-lg hover:bg-white/5 transition-colors",children:(0,L.jsx)(r.A,{size:22,className:"text-white"})}),(0,L.jsxs)("h2",{className:"text-sm font-bold text-white whitespace-nowrap",children:["\uc624\ub298\ub3c4 ",(0,L.jsx)("span",{className:"text-[#00fff2]",children:"\uc54c\ucc2c"})," \ud558\ub8e8!"]})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsxs)("div",{onClick:()=>d("/my-profile"),className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg cursor-pointer",style:{background:"rgba(167, 139, 250, 0.2)"},children:[(0,L.jsx)("span",{style:{fontSize:"14px"},children:(null===re||void 0===re?void 0:re.icon)||"\ud83c\udf1f"}),(0,L.jsxs)("div",{className:"flex flex-col leading-none",children:[(0,L.jsx)("span",{style:{fontSize:"9px",color:"#9ca3af"},children:"LEVEL"}),(0,L.jsx)("span",{style:{fontSize:"12px",fontWeight:"700",color:(null===re||void 0===re?void 0:re.color)||"#a78bfa"},children:(null===re||void 0===re?void 0:re.level)||1})]}),de&&(0,L.jsx)("span",{style:{fontSize:"14px",marginLeft:"2px"},children:de.icon})]}),(0,L.jsx)("div",{onClick:()=>b(!f),className:"cursor-pointer",children:(0,L.jsx)(Me,{config:oe,size:40,showBorder:!0})})]})]}),(0,L.jsxs)("div",{className:"px-4 pb-3 flex gap-3",children:[(0,L.jsxs)("div",{className:"flex-1 flex items-center gap-2 px-3 py-2 bg-emerald-900/10 rounded-xl border border-emerald-500/20",children:[(0,L.jsx)("div",{className:"w-8 h-8 rounded-lg bg-emerald-600 text-white flex items-center justify-center shadow-sm flex-shrink-0",children:(0,L.jsx)("span",{className:"font-bold text-xs",children:"\u20a9"})}),(0,L.jsxs)("div",{className:"min-w-0",children:[(0,L.jsx)("p",{className:"text-[9px] text-emerald-400 font-bold uppercase tracking-wider leading-none",children:"\ud604\uae08"}),(0,L.jsxs)("p",{className:"text-sm font-bold text-white truncate",children:[We((null===p||void 0===p?void 0:p.cash)||0),"\uc6d0"]})]})]}),(0,L.jsxs)("div",{className:"flex-1 flex items-center gap-2 px-3 py-2 bg-rose-900/10 rounded-xl border border-rose-500/20",children:[(0,L.jsx)("div",{className:"w-8 h-8 rounded-lg bg-rose-600 text-white flex items-center justify-center shadow-sm flex-shrink-0",children:(0,L.jsx)(J.A,{size:14})}),(0,L.jsxs)("div",{className:"min-w-0",children:[(0,L.jsx)("p",{className:"text-[9px] text-rose-400 font-bold uppercase tracking-wider leading-none",children:"\ucfe0\ud3f0"}),(0,L.jsxs)("p",{className:"text-sm font-bold text-white truncate",children:[(null===p||void 0===p?void 0:p.coupons)||0,"\uac1c"]})]})]})]})]}),(0,L.jsxs)("header",{className:"hidden md:flex items-center justify-between bg-[#141423] border-b border-[#00fff2]/10 shadow-sm z-10",style:{height:"64px",minHeight:"64px",maxHeight:"64px",padding:"0 16px"},children:[(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,L.jsx)("button",{onClick:l,style:{padding:"8px",borderRadius:"8px",border:"1px solid rgba(0, 255, 242, 0.1)",background:"rgba(255, 255, 255, 0.05)",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:o?(0,L.jsx)(V.A,{size:16}):(0,L.jsx)(K.A,{size:16})}),(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{style:{fontSize:"15px",fontWeight:"bold",color:"white",whiteSpace:"nowrap",lineHeight:"1.2"},children:["\uc624\ub298\ub3c4 ",(0,L.jsx)("span",{style:{color:"#00fff2",fontFamily:"'Jua', sans-serif"},children:"\uc54c\ucc2c"})," \ud558\ub8e8! \ud83d\udc4b"]}),(0,L.jsxs)("div",{style:{fontSize:"12px",color:"#94a3b8",whiteSpace:"nowrap",lineHeight:"1.2"},children:[ne,"\ub2d8 \ud658\uc601\ud569\ub2c8\ub2e4"]})]})]}),(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 12px",background:"rgba(16, 185, 129, 0.1)",borderRadius:"8px",color:"#34d399"},children:[(0,L.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"#10b981",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"12px"},children:"\u20a9"}),(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{style:{fontSize:"10px",fontWeight:"600",opacity:.7,lineHeight:"1.2"},children:"\ud604\uae08"}),(0,L.jsxs)("div",{style:{fontSize:"13px",fontWeight:"bold",whiteSpace:"nowrap",lineHeight:"1.2"},children:[We((null===p||void 0===p?void 0:p.cash)||0),"\uc6d0"]})]})]}),(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 12px",background:"rgba(244, 63, 94, 0.1)",borderRadius:"8px",color:"#fb7185"},children:[(0,L.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"#f43f5e",color:"white",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,L.jsx)(J.A,{size:14})}),(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{style:{fontSize:"10px",fontWeight:"600",opacity:.7,lineHeight:"1.2"},children:"\ucfe0\ud3f0"}),(0,L.jsxs)("div",{style:{fontSize:"13px",fontWeight:"bold",whiteSpace:"nowrap",lineHeight:"1.2"},children:[(null===p||void 0===p?void 0:p.coupons)||0,"\uac1c"]})]})]}),(0,L.jsxs)("div",{onClick:()=>d("/my-profile"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 12px",background:"rgba(167, 139, 250, 0.1)",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>e.currentTarget.style.background="rgba(167, 139, 250, 0.2)",onMouseLeave:e=>e.currentTarget.style.background="rgba(167, 139, 250, 0.1)",children:[(0,L.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",borderRadius:"6px",background:(null===re||void 0===re?void 0:re.color)||"#a78bfa",fontSize:"14px"},children:(null===re||void 0===re?void 0:re.icon)||"\ud83c\udf1f"}),(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{style:{fontSize:"10px",fontWeight:"600",color:(null===re||void 0===re?void 0:re.color)||"#a78bfa",lineHeight:"1.2"},children:["Lv.",(null===re||void 0===re?void 0:re.level)||1]}),(0,L.jsx)("div",{style:{fontSize:"11px",fontWeight:"bold",color:"#e8e8ff",whiteSpace:"nowrap",lineHeight:"1.2"},children:(null===re||void 0===re?void 0:re.title)||"\uc0c8\uc2f9"})]}),de&&(0,L.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginLeft:"4px",padding:"2px 6px",background:"legendary"===de.rarity?"rgba(245, 158, 11, 0.2)":"epic"===de.rarity?"rgba(167, 139, 250, 0.2)":"rare"===de.rarity?"rgba(59, 130, 246, 0.2)":"rgba(107, 114, 128, 0.2)",borderRadius:"4px"},children:(0,L.jsx)("span",{style:{fontSize:"12px"},children:de.icon})})]}),(0,L.jsxs)("div",{style:{position:"relative"},ref:v,children:[(0,L.jsxs)("button",{onClick:()=>b(!f),style:{display:"flex",alignItems:"center",gap:"8px",paddingLeft:"12px",borderLeft:"1px solid rgba(255, 255, 255, 0.1)",background:"transparent",border:"none",cursor:"pointer"},children:[(0,L.jsxs)("div",{style:{textAlign:"right"},children:[(0,L.jsx)("div",{style:{fontSize:"13px",fontWeight:"bold",color:"white",whiteSpace:"nowrap",lineHeight:"1.2"},children:ne}),(0,L.jsx)("div",{style:{fontSize:"11px",color:"#818cf8",fontWeight:"500",whiteSpace:"nowrap",lineHeight:"1.2"},children:ie})]}),(0,L.jsx)("div",{onClick:e=>{e.stopPropagation(),d("/my-profile")},style:{cursor:"pointer"},children:(0,L.jsx)(Me,{config:oe,size:40,showBorder:!0})})]}),f&&(0,L.jsxs)("div",{className:"absolute top-full right-0 mt-2 w-72 bg-[#1a1a2e] rounded-2xl shadow-2xl border border-slate-700 overflow-hidden z-50",children:[(0,L.jsxs)("div",{className:"px-5 py-4 bg-gradient-to-r from-[#141423] to-indigo-900/20 border-b border-slate-700",children:[(0,L.jsx)("p",{className:"font-bold text-white",children:ne}),(0,L.jsxs)("p",{className:"text-sm text-slate-400 flex items-center gap-2 mt-1",children:[ae&&(0,L.jsx)("span",{className:"text-indigo-400 font-semibold",children:"\uad00\ub9ac\uc790"}),(null===p||void 0===p?void 0:p.classCode)&&(0,L.jsxs)("span",{children:["\ud559\uae09: ",p.classCode]})]})]}),(0,L.jsxs)("div",{className:"md:hidden px-5 py-4 bg-[#141423]/50 border-b border-slate-700",children:[(0,L.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,L.jsx)("span",{className:"text-sm text-slate-400",children:"\ud604\uae08"}),(0,L.jsxs)("span",{className:"font-bold text-emerald-400",children:[We((null===p||void 0===p?void 0:p.cash)||0),"\uc6d0"]})]}),(0,L.jsxs)("div",{className:"flex justify-between items-center",children:[(0,L.jsx)("span",{className:"text-sm text-slate-400",children:"\ucfe0\ud3f0"}),(0,L.jsxs)("span",{className:"font-bold text-rose-400",children:[(null===p||void 0===p?void 0:p.coupons)||0,"\uac1c"]})]})]}),(0,L.jsxs)("div",{className:"p-2",children:[(0,L.jsxs)("button",{onClick:()=>{d("/my-profile"),b(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-white hover:bg-indigo-600/20 transition-colors bg-indigo-500/10 border border-indigo-500/30 mb-2",children:[(0,L.jsx)(X.A,{size:18,className:"text-indigo-400"}),"\ub0b4 \ud504\ub85c\ud544",(0,L.jsxs)("span",{className:"ml-auto text-xs text-indigo-400",children:["Lv.",(null===re||void 0===re?void 0:re.level)||0]})]}),(0,L.jsx)("div",{className:"h-px bg-slate-700 my-2"}),(0,L.jsxs)("button",{onClick:()=>{I((null===p||void 0===p?void 0:p.name)||(null===p||void 0===p?void 0:p.nickname)||""),C("nickname"),b(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,L.jsx)(X.A,{size:18,className:"text-slate-500"}),"\ub2c9\ub124\uc784 \ubcc0\uacbd"]}),(0,L.jsxs)("button",{onClick:()=>{C("password"),b(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,L.jsx)(Y.A,{size:18,className:"text-slate-500"}),"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"]}),(0,L.jsxs)("button",{onClick:()=>{H((null===p||void 0===p?void 0:p.classCode)||""),C("classCode"),b(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,L.jsx)(N.A,{size:18,className:"text-slate-500"}),"\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd"]}),(0,L.jsxs)("button",{onClick:()=>{S(!0),b(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,L.jsx)(M.A,{size:18,className:"text-slate-500"}),"\uc124\uc815"]}),(0,L.jsx)("div",{className:"h-px bg-slate-700 my-2"}),(0,L.jsxs)("button",{onClick:async()=>{b(!1);if("\uacc4\uc815\uc0ad\uc81c"===window.prompt("\uc815\ub9d0\ub85c \uacc4\uc815\uc744 \uc0ad\uc81c\ud558\uc2dc\ub824\uba74 '\uacc4\uc815\uc0ad\uc81c'\ub77c\uace0 \uc785\ub825\ud574\uc8fc\uc138\uc694.")){const t=window.prompt("\ud604\uc7ac \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.");if(t)try{await g(c.email,t,!0),await h(),alert("\uacc4\uc815\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(e){alert("\uc0ad\uc81c \uc624\ub958: ".concat(e.message))}}},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-red-400 hover:bg-red-900/10 transition-colors",children:[(0,L.jsx)(Z.A,{size:18}),"\uacc4\uc815 \uc0ad\uc81c"]}),(0,L.jsx)("div",{className:"h-px bg-slate-700 my-2"}),(0,L.jsxs)("button",{onClick:async()=>{u&&(await u(),d("/login")),b(!1)},className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-300 hover:bg-white/5 transition-colors",children:[(0,L.jsx)(_.A,{size:18,className:"text-slate-500"}),"\ub85c\uadf8\uc544\uc6c3"]})]})]})]})]})]}),(0,L.jsx)(Be,{isOpen:"nickname"===w,onClose:pe,title:"\ub2c9\ub124\uc784 \ubcc0\uacbd",children:(0,L.jsxs)("div",{className:"space-y-4",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\uc0c8 \ub2c9\ub124\uc784"}),(0,L.jsx)("input",{type:"text",value:A,onChange:e=>I(e.target.value),placeholder:"2-12\uc790",maxLength:12,className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors",autoFocus:!0})]}),E&&(0,L.jsx)("p",{className:"text-sm text-red-400 bg-red-900/10 p-3 rounded-xl",children:E}),(0,L.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,L.jsx)("button",{onClick:pe,className:"flex-1 py-3 border border-slate-700 rounded-xl text-sm font-semibold text-slate-300 hover:bg-slate-800 transition-colors",children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{const e=A.trim();if(!e)return T("\ub2c9\ub124\uc784\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");if(e.length<2)return T("\ub2c9\ub124\uc784\uc740 \ucd5c\uc18c 2\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");if(e.length>12)return T("\ub2c9\ub124\uc784\uc740 \ucd5c\ub300 12\uc790\uae4c\uc9c0 \uac00\ub2a5\ud569\ub2c8\ub2e4.");j(!0);try{await m({name:e})?(alert("\ub2c9\ub124\uc784\uc774 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),pe()):T("\ubcc0\uacbd\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(t){T("\uc624\ub958: ".concat(t.message))}j(!1)},disabled:y,className:"flex-1 py-3 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-xl text-sm font-semibold shadow-lg shadow-indigo-500/30 hover:from-indigo-700 hover:to-violet-700 transition-all disabled:opacity-50",children:y?"\uc800\uc7a5 \uc911...":"\uc800\uc7a5"})]})]})}),(0,L.jsx)(Be,{isOpen:"password"===w,onClose:pe,title:"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd",children:(0,L.jsxs)("div",{className:"space-y-4",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\ud604\uc7ac \ube44\ubc00\ubc88\ud638"}),(0,L.jsx)("input",{type:"password",value:D,onChange:e=>R(e.target.value),className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors"})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\uc0c8 \ube44\ubc00\ubc88\ud638"}),(0,L.jsx)("input",{type:"password",value:z,onChange:e=>O(e.target.value),className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors"})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\ube44\ubc00\ubc88\ud638 \ud655\uc778"}),(0,L.jsx)("input",{type:"password",value:W,onChange:e=>B(e.target.value),className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors"})]}),P&&(0,L.jsx)("p",{className:"text-sm text-red-400 bg-red-900/10 p-3 rounded-xl",children:P}),q&&(0,L.jsx)("p",{className:"text-sm text-green-400 bg-green-900/10 p-3 rounded-xl",children:"\ube44\ubc00\ubc88\ud638\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4!"}),(0,L.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,L.jsx)("button",{onClick:pe,className:"flex-1 py-3 border border-slate-700 rounded-xl text-sm font-semibold text-slate-300 hover:bg-slate-800 transition-colors",children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{if(!D||!z||!W)return F("\ubaa8\ub4e0 \ud544\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.");if(z.length<6)return F("\uc0c8 \ube44\ubc00\ubc88\ud638\ub294 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");if(z!==W)return F("\ube44\ubc00\ubc88\ud638\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");j(!0);try{await g(c.email,D,!0),await x(z),U(!0),setTimeout(pe,2e3)}catch(e){"auth/wrong-password"===e.code||"auth/invalid-credential"===e.code?F("\ud604\uc7ac \ube44\ubc00\ubc88\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."):F("\uc624\ub958: ".concat(e.message))}j(!1)},disabled:y||q,className:"flex-1 py-3 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-xl text-sm font-semibold shadow-lg shadow-indigo-500/30 hover:from-indigo-700 hover:to-violet-700 transition-all disabled:opacity-50",children:y?"\ubcc0\uacbd \uc911...":"\ubcc0\uacbd"})]})]})}),(0,L.jsx)(Be,{isOpen:"classCode"===w,onClose:pe,title:"\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd",children:(0,L.jsxs)("div",{className:"space-y-4",children:[(null===p||void 0===p?void 0:p.classCode)&&(0,L.jsxs)("p",{className:"text-sm text-slate-400 bg-slate-800/50 p-3 rounded-xl",children:["\ud604\uc7ac \ud559\uae09 \ucf54\ub4dc: ",(0,L.jsx)("strong",{className:"text-white",children:p.classCode})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"\uc0c8 \ud559\uae09 \ucf54\ub4dc"}),(0,L.jsx)("input",{type:"text",value:Q,onChange:e=>H(e.target.value.replace(/[^a-zA-Z0-9]/g,"").toUpperCase()),placeholder:"\uc601\ubb38\uc790\uc640 \uc22b\uc790\ub9cc",maxLength:20,className:"w-full px-4 py-3 border-2 border-slate-700 bg-[#141423] text-white rounded-xl text-sm focus:outline-none focus:border-indigo-500 transition-colors",autoFocus:!0}),(0,L.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"\uc601\ubb38\uc790\uc640 \uc22b\uc790\ub9cc \uc785\ub825 \uac00\ub2a5\ud569\ub2c8\ub2e4."})]}),$&&(0,L.jsx)("p",{className:"text-sm text-red-400 bg-red-900/10 p-3 rounded-xl",children:$}),te&&(0,L.jsx)("p",{className:"text-sm text-green-400 bg-green-900/10 p-3 rounded-xl",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4!"}),(0,L.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,L.jsx)("button",{onClick:pe,className:"flex-1 py-3 border border-slate-700 rounded-xl text-sm font-semibold text-slate-300 hover:bg-slate-800 transition-colors",children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{const e=Q.trim().toUpperCase();if(!e)return ee("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.");j(!0);try{if(!await(0,G.JK)(e))return ee("'".concat(e,"'\ub294 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud559\uae09 \ucf54\ub4dc\uc785\ub2c8\ub2e4.")),void j(!1);await m({classCode:e})?(se(!0),setTimeout(()=>{alert("\ud559\uae09 \ucf54\ub4dc\uac00 '".concat(e,"'\ub85c \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4!")),pe()},1e3)):ee("\uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(t){ee("\uc624\ub958: ".concat(t.message))}j(!1)},disabled:y,className:"flex-1 py-3 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-xl text-sm font-semibold shadow-lg shadow-indigo-500/30 hover:from-indigo-700 hover:to-violet-700 transition-all disabled:opacity-50",children:y?"\uc800\uc7a5 \uc911...":"\uc800\uc7a5"})]})]})}),(0,L.jsx)(ce,{isOpen:k,onClose:()=>S(!1)})]})});const Fe=[{id:"home",icon:s(3658).A,label:"\ud648",path:"/dashboard/tasks"},{id:"assets",icon:d.A,label:"\uc790\uc0b0",path:"/my-assets"},{id:"game",icon:p.A,label:"\uac8c\uc784",paths:["/learning-games"]},{id:"community",icon:k.A,label:"\ucee4\ubba4\ub2c8\ud2f0",path:"/learning-board"}];function qe(){const e=(0,n.zy)(),t=(0,n.Zp)(),s=(0,a.useCallback)(t=>t.paths?t.paths.some(t=>e.pathname.startsWith(t)):e.pathname===t.path||e.pathname.startsWith(t.path+"/"),[e.pathname]),i=(0,a.useCallback)(e=>{e.paths?t(e.paths[0]+"/omok"):t(e.path)},[t]);return(0,L.jsx)("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-md border-t border-gray-100/50 pb-safe pt-2 px-6 shadow-[0_-4px_20px_rgba(0,0,0,0.03)] z-50",children:(0,L.jsx)("div",{className:"flex justify-between items-center max-w-md mx-auto",children:Fe.map(e=>{const t=s(e),a=e.icon;return(0,L.jsxs)("button",{onClick:()=>i(e),className:"flex flex-col items-center gap-1 p-2 min-w-[64px] transition-all duration-300 ".concat(t?"text-indigo-600 -translate-y-1":"text-gray-400"),children:[(0,L.jsx)(a,{size:24,strokeWidth:t?2.5:2,className:t?"drop-shadow-md":""}),(0,L.jsx)("span",{className:"text-[10px] font-medium ".concat(t?"opacity-100":"opacity-70"),children:e.label})]},e.id)})})})}var Ue=s(441),Qe=s(1360),He=s(7104);function Ge(){const[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1),[l,r]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(o(e),window.matchMedia("(display-mode: standalone)").matches)return void r(!0);const s=localStorage.getItem("pwa-install-dismissed");if(s){const e=parseInt(s,10);if(Date.now()-e<6048e5)return}const a=e=>{e.preventDefault(),t(e),setTimeout(()=>n(!0),2e3)};return window.addEventListener("beforeinstallprompt",a),e&&!window.matchMedia("(display-mode: standalone)").matches&&setTimeout(()=>n(!0),3e3),window.addEventListener("appinstalled",()=>{r(!0),n(!1),t(null)}),()=>{window.removeEventListener("beforeinstallprompt",a)}},[]);const d=()=>{n(!1),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return l||!s?null:(0,L.jsx)("div",{className:"fixed bottom-20 md:bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-50 animate-slide-up",children:(0,L.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden",children:[(0,L.jsxs)("div",{className:"bg-gradient-to-r from-indigo-500 to-violet-600 px-4 py-3 flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2 text-white",children:[(0,L.jsx)(de.A,{size:20}),(0,L.jsx)("span",{className:"font-semibold",children:"\uc571 \uc124\uce58\ud558\uae30"})]}),(0,L.jsx)("button",{onClick:d,className:"text-white/80 hover:text-white transition-colors",children:(0,L.jsx)(O.A,{size:20})})]}),(0,L.jsxs)("div",{className:"p-4",children:[(0,L.jsxs)("div",{className:"flex items-start gap-4",children:[(0,L.jsx)("div",{className:"w-14 h-14 bg-gradient-to-tr from-indigo-500 to-violet-600 rounded-2xl flex items-center justify-center flex-shrink-0 shadow-lg shadow-indigo-200/50",children:(0,L.jsx)("span",{className:"text-white text-2xl",children:"\u2728"})}),(0,L.jsxs)("div",{className:"flex-1",children:[(0,L.jsx)("h3",{className:"font-bold text-gray-900 mb-1",children:"\uc54c\ucc2c \uc571\uc744 \uc124\uce58\ud558\uc138\uc694!"}),(0,L.jsx)("p",{className:"text-sm text-gray-500 leading-relaxed",children:"\ud648 \ud654\uba74\uc5d0 \ucd94\uac00\ud558\uba74 \ub354 \ube60\ub974\uac8c \uc811\uc18d\ud558\uace0, \uc624\ud504\ub77c\uc778\uc5d0\uc11c\ub3c4 \uc77c\ubd80 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc5b4\uc694."})]})]}),i?(0,L.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-xl",children:[(0,L.jsx)("p",{className:"text-sm text-gray-600 mb-2 font-medium",children:"iOS\uc5d0\uc11c \uc124\uce58\ud558\uae30:"}),(0,L.jsxs)("div",{className:"space-y-2",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,L.jsx)(Ue.A,{size:16,className:"text-indigo-500"}),(0,L.jsx)("span",{children:"1. \ud558\ub2e8\uc758 \uacf5\uc720 \ubc84\ud2bc \ud0ed"})]}),(0,L.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,L.jsx)(Qe.A,{size:16,className:"text-indigo-500"}),(0,L.jsx)("span",{children:'2. "\ud648 \ud654\uba74\uc5d0 \ucd94\uac00" \uc120\ud0dd'})]})]})]}):(0,L.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,L.jsx)("button",{onClick:d,className:"flex-1 px-4 py-2.5 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-xl font-medium transition-colors",children:"\ub098\uc911\uc5d0"}),(0,L.jsxs)("button",{onClick:async()=>{if(!e)return;e.prompt();const{outcome:s}=await e.userChoice;"accepted"===s?console.log("PWA \uc124\uce58 \uc218\ub77d"):console.log("PWA \uc124\uce58 \uac70\uc808"),t(null),n(!1)},className:"flex-1 px-4 py-2.5 text-white bg-gradient-to-r from-indigo-500 to-violet-600 hover:from-indigo-600 hover:to-violet-700 rounded-xl font-medium transition-all flex items-center justify-center gap-2 shadow-lg shadow-indigo-200/50",children:[(0,L.jsx)(He.A,{size:18}),"\uc124\uce58\ud558\uae30"]})]})]}),(0,L.jsx)("div",{className:"px-4 py-2 bg-gray-50 border-t border-gray-100",children:(0,L.jsx)("p",{className:"text-xs text-gray-400 text-center",children:"\uc124\uce58\ud574\ub3c4 \uc800\uc7a5\uacf5\uac04\uc744 \uac70\uc758 \ucc28\uc9c0\ud558\uc9c0 \uc54a\uc544\uc694"})})]})})}var Je=s(516);function Ve(e){let{onUpdate:t,onDismiss:s}=e;return(0,L.jsx)("div",{className:"fixed top-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-50 animate-slide-up",children:(0,L.jsx)("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl shadow-2xl p-4 text-white",children:(0,L.jsxs)("div",{className:"flex items-start gap-3",children:[(0,L.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0",children:(0,L.jsx)(Je.A,{size:20,className:"animate-spin-slow"})}),(0,L.jsxs)("div",{className:"flex-1",children:[(0,L.jsx)("h3",{className:"font-bold mb-1",children:"\uc0c8 \ubc84\uc804\uc774 \uc788\uc5b4\uc694!"}),(0,L.jsx)("p",{className:"text-sm text-white/80 mb-3",children:"\ub354 \ub098\uc740 \uc54c\ucc2c\uc744 \uc704\ud574 \uc5c5\ub370\uc774\ud2b8\ub97c \uc801\uc6a9\ud574\uc8fc\uc138\uc694."}),(0,L.jsxs)("div",{className:"flex gap-2",children:[(0,L.jsx)("button",{onClick:s,className:"px-3 py-1.5 text-sm bg-white/20 hover:bg-white/30 rounded-lg transition-colors",children:"\ub098\uc911\uc5d0"}),(0,L.jsxs)("button",{onClick:t,className:"px-3 py-1.5 text-sm bg-white text-emerald-600 font-semibold rounded-lg hover:bg-white/90 transition-colors flex items-center gap-1",children:[(0,L.jsx)(Je.A,{size:14}),"\uc9c0\uae08 \uc5c5\ub370\uc774\ud2b8"]})]})]}),(0,L.jsx)("button",{onClick:s,className:"text-white/60 hover:text-white transition-colors",children:(0,L.jsx)(O.A,{size:18})})]})})})}function Ke(){const[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(navigator.onLine);(0,a.useEffect)(()=>{const e=()=>o(!0),t=()=>o(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),"serviceWorker"in navigator&&c(),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]);const[r,d]=(0,a.useState)(null);(0,a.useEffect)(()=>()=>{r&&clearInterval(r)},[r]);const c=async()=>{try{const e=await navigator.serviceWorker.register("/sw.js",{scope:"/"});t(e),console.log("[PWA] \uc11c\ube44\uc2a4 \uc6cc\ucee4 \ub4f1\ub85d \uc131\uacf5:",e.scope),e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{if("installed"===t.state&&navigator.serviceWorker.controller){const e=sessionStorage.getItem("alchan_updated");if(e&&Date.now()-parseInt(e)<3e5)return void console.log("[PWA] \ucd5c\uadfc \uc5c5\ub370\uc774\ud2b8\ub428 - \uc54c\ub9bc \uc0dd\ub7b5");console.log("[PWA] \uc0c8 \ubc84\uc804 \uc0ac\uc6a9 \uac00\ub2a5"),n(!0)}})});const s=setInterval(()=>{e.update()},36e5);d(s)}catch(e){console.error("[PWA] \uc11c\ube44\uc2a4 \uc6cc\ucee4 \ub4f1\ub85d \uc2e4\ud328:",e)}},p=(0,a.useCallback)(()=>{n(!1),sessionStorage.setItem("alchan_updated",Date.now().toString()),e&&e.waiting?(navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("[PWA] \uc0c8 \uc11c\ube44\uc2a4 \uc6cc\ucee4 \ud65c\uc131\ud654\ub428 - \uc0c8\ub85c\uace0\uce68"),window.location.reload()}),e.waiting.postMessage({type:"SKIP_WAITING"})):(console.log("[PWA] \ub300\uae30 \uc911\uc778 \uc11c\ube44\uc2a4 \uc6cc\ucee4 \uc5c6\uc74c - \uac15\uc81c \uc0c8\ub85c\uace0\uce68"),window.location.reload())},[e]),u=(0,a.useCallback)(async()=>{if(!("Notification"in window))return console.log("[PWA] \uc774 \ube0c\ub77c\uc6b0\uc800\ub294 \uc54c\ub9bc\uc744 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."),!1;if("granted"===Notification.permission)return!0;if("denied"!==Notification.permission){return"granted"===await Notification.requestPermission()}return!1},[]),m=(0,a.useCallback)(async function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await u()&&e&&e.showNotification(t,(0,l.A)({icon:"/icons/icon-192x192.png",badge:"/icons/icon-72x72.png",vibrate:[100,50,100]},s))},[e,u]);return{registration:e,updateAvailable:s,updateServiceWorker:p,isOnline:i,requestNotificationPermission:u,showNotification:m}}var Xe=s(5881),Ye=s(2861),Ze=s(2395),$e=s(7950);const et=(0,a.memo)(function(e){let{task:t,onEarnCoupon:s,isJobTask:n,isAdmin:i,onEditTask:o,onDeleteTask:r,taskId:d,jobId:c=null}=e;const[p,u]=(0,a.useState)(!1),[m,x]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)(null),[y,j]=(0,a.useState)(null),[v,w]=(0,a.useState)(!1),N=e=>{v||y||(console.log("[TaskItem] \uce74\ub4dc \uc120\ud0dd:",{cardType:e,taskId:d,jobId:c,isJobTask:n}),j(e),w(!0),setTimeout(()=>{const a="cash"===e?f.cash:f.coupon,i="cash"===e?"".concat(a.toLocaleString(),"\uc6d0"):"".concat(a,"\uac1c");console.log("[TaskItem] onEarnCoupon \ud638\ucd9c \uc900\ube44:",{taskId:d,jobId:c,isJobTask:n,cardType:e,reward:a}),"function"===typeof s&&s(d||t.id,c,n,e,a),g(!1),x("".concat("cash"===e?"\ud83d\udcb0 \ud604\uae08":"\ud83c\udfab \ucfe0\ud3f0"," ").concat(i," \ud68d\ub4dd! \ud83d\ude0a")),u(!0),w(!1)},800))};(0,a.useEffect)(()=>{let e;return p&&(e=setTimeout(()=>{u(!1),x("")},2e3)),()=>clearTimeout(e)},[p]);const C=t&&t.maxClicks>0&&t.clicks>=t.maxClicks;if(!t)return null;const k=window.innerWidth<=768,S={backgroundColor:C?"rgba(20, 20, 35, 0.4)":"rgba(30, 30, 50, 0.6)",borderRadius:"8px",cursor:C?"default":"pointer",transition:"all 0.2s ease",border:"1px solid ".concat(C?"rgba(100, 116, 139, 0.1)":"rgba(0, 255, 242, 0.15)"),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",position:"relative",opacity:C?.6:1,padding:k?"8px 10px":"12px",marginBottom:"8px",boxShadow:C?"none":"0 4px 12px rgba(0, 0, 0, 0.1)",gap:k?"6px":"8px"},A={display:"flex",alignItems:"center",gap:k?"6px":"10px",flexGrow:1,minWidth:0,overflow:"hidden"},I={color:C?"#64748b":"#e8e8ff",fontWeight:"600",fontSize:k?"12px":"16px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",lineHeight:"1.4",flex:1,minWidth:0},E={display:"flex",alignItems:"center",gap:k?"4px":"8px",flexShrink:0},T={backgroundColor:n?"rgba(79, 70, 229, 0.3)":"rgba(16, 185, 129, 0.3)",color:n?"#818cf8":"#34d399",border:n?"1px solid rgba(99, 102, 241, 0.5)":"1px solid rgba(52, 211, 153, 0.5)",padding:k?"3px 6px":"4px 10px",borderRadius:"10px",fontSize:k?"10px":"13px",fontWeight:"500",whiteSpace:"nowrap"};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{style:S,onClick:C?null:()=>{if(console.log("[TaskItem] handleInternalClick \ud638\ucd9c\ub428:",{taskName:null===t||void 0===t?void 0:t.name,isJobTask:n,taskId:d,jobId:c}),!t||"number"!==typeof t.clicks||"number"!==typeof t.maxClicks)return void console.error("Invalid task prop:",t);if(t.maxClicks>0&&t.clicks>=t.maxClicks)return;console.log("[TaskItem] \uce74\ub4dc \ubaa8\ub2ec \uc5f4\uae30");const e=(()=>{const e=e=>{const t=e.reduce((e,t)=>e+t.weight,0);let s=Math.random()*t;for(const a of e)if(s-=a.weight,s<=0)return a.amount;return e[e.length-1].amount};return{cash:e([{amount:5e4,weight:5},{amount:3e4,weight:10},{amount:2e4,weight:15},{amount:1e4,weight:20},{amount:5e3,weight:18},{amount:3e3,weight:12},{amount:1e3,weight:10},{amount:500,weight:7},{amount:100,weight:3}]),coupon:e([{amount:20,weight:10},{amount:10,weight:20},{amount:5,weight:20},{amount:3,weight:20},{amount:1,weight:30}])}})();b(e),j(null),w(!1),g(!0)},children:[(0,L.jsx)("div",{style:A,children:(0,L.jsx)("span",{style:I,title:t.name,children:t.name})}),(0,L.jsxs)("div",{style:E,children:[(0,L.jsx)("span",{style:T,children:"\ud83c\udf81 \ub79c\ub364\ubcf4\uc0c1"}),i&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("button",{onClick:e=>{e.stopPropagation(),o()},style:tt,"aria-label":"\ud560\uc77c \uc218\uc815",children:"\u270f\ufe0f"}),(0,L.jsx)("button",{onClick:e=>{e.stopPropagation(),r()},style:tt,"aria-label":"\ud560\uc77c \uc0ad\uc81c",children:"\ud83d\uddd1\ufe0f"})]})]}),p&&(0,L.jsxs)("div",{style:st,children:[m,(0,L.jsx)("div",{style:at})]})]}),(()=>{if(!h||!f)return null;const e=(0,l.A)((0,l.A)({},it),{},{padding:k?"20px":"40px",width:k?"95%":"90%"}),t=(0,l.A)((0,l.A)({},ot),{},{fontSize:k?"20px":"28px",marginBottom:k?"8px":"10px"}),s=(0,l.A)((0,l.A)({},lt),{},{fontSize:k?"13px":"16px",marginBottom:k?"20px":"30px"}),a=(0,l.A)((0,l.A)({},rt),{},{gap:k?"15px":"20px"}),n=(0,l.A)((0,l.A)({},dt),{},{width:k?"140px":"200px",height:k?"200px":"280px"}),i=(0,l.A)((0,l.A)({},ht),{},{fontSize:k?"50px":"80px",marginBottom:k?"10px":"20px"}),o=(0,l.A)((0,l.A)({},gt),{},{fontSize:k?"18px":"24px"}),r=(0,l.A)((0,l.A)({},ft),{},{fontSize:k?"24px":"36px"}),d=(0,l.A)((0,l.A)({},bt),{},{fontSize:k?"14px":"18px"});return(0,$e.createPortal)((0,L.jsx)("div",{style:nt,onClick:()=>g(!1),children:(0,L.jsxs)("div",{style:e,onClick:e=>e.stopPropagation(),children:[(0,L.jsx)("h3",{style:t,children:"\ud83c\udf81 \ubcf4\uc0c1 \uc120\ud0dd"}),(0,L.jsx)("p",{style:s,children:"\ub450 \uac1c\uc758 \uce74\ub4dc \uc911 \ud558\ub098\ub97c \uc120\ud0dd\ud558\uc138\uc694!"}),(0,L.jsxs)("div",{style:a,children:[(0,L.jsx)("div",{style:(0,l.A)((0,l.A)({},n),"cash"===y&&ct),onClick:()=>!y&&N("cash"),children:(0,L.jsxs)("div",{style:(0,l.A)((0,l.A)({},pt),{},{transform:"cash"===y?"rotateY(180deg)":"rotateY(0deg)"}),children:[(0,L.jsxs)("div",{style:ut,children:[(0,L.jsx)("div",{style:i,children:"\ud83d\udcb0"}),(0,L.jsx)("div",{style:o,children:"\ud604\uae08"})]}),(0,L.jsxs)("div",{style:(0,l.A)((0,l.A)({},mt),"cash"===y&&xt),children:[(0,L.jsxs)("div",{style:r,children:[f.cash.toLocaleString(),"\uc6d0"]}),(0,L.jsx)("div",{style:d,children:"\ud83d\udcb0 \ud604\uae08 \ud68d\ub4dd!"})]})]})}),(0,L.jsx)("div",{style:(0,l.A)((0,l.A)({},n),"coupon"===y&&ct),onClick:()=>!y&&N("coupon"),children:(0,L.jsxs)("div",{style:(0,l.A)((0,l.A)({},pt),{},{transform:"coupon"===y?"rotateY(180deg)":"rotateY(0deg)"}),children:[(0,L.jsxs)("div",{style:ut,children:[(0,L.jsx)("div",{style:i,children:"\ud83c\udfab"}),(0,L.jsx)("div",{style:o,children:"\ucfe0\ud3f0"})]}),(0,L.jsxs)("div",{style:(0,l.A)((0,l.A)({},mt),"coupon"===y&&xt),children:[(0,L.jsxs)("div",{style:r,children:[f.coupon,"\uac1c"]}),(0,L.jsx)("div",{style:d,children:"\ud83c\udfab \ucfe0\ud3f0 \ud68d\ub4dd!"})]})]})})]})]})}),document.body)})()]})}),tt={background:"none",border:"none",cursor:"pointer",padding:"4px",fontSize:"16px",color:"#94a3b8",display:"flex",alignItems:"center",justifyContent:"center"},st={position:"absolute",bottom:"calc(100% + 8px)",left:"50%",transform:"translateX(-50%)",backgroundColor:"rgba(0, 0, 0, 0.75)",color:"white",padding:"5px 10px",borderRadius:"6px",fontSize:"12px",fontWeight:"500",whiteSpace:"nowrap",zIndex:10,pointerEvents:"none",boxShadow:"0 2px 5px rgba(0,0,0,0.2)"},at={content:'""',position:"absolute",top:"100%",left:"50%",marginLeft:"-5px",borderWidth:"5px",borderStyle:"solid",borderColor:"rgba(0, 0, 0, 0.75) transparent transparent transparent"},nt={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,animation:"fadeIn 0.3s ease"},it={backgroundColor:"#1a1a2e",border:"1px solid rgba(0, 255, 242, 0.3)",borderRadius:"20px",padding:"40px",maxWidth:"600px",width:"90%",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",animation:"zoomIn 0.3s ease"},ot={fontSize:"28px",fontWeight:"bold",textAlign:"center",marginBottom:"10px",color:"#ffffff",textShadow:"0 0 10px rgba(0, 255, 242, 0.5)"},lt={fontSize:"16px",textAlign:"center",color:"#a0a0c0",marginBottom:"30px"},rt={display:"flex",gap:"20px",justifyContent:"center",flexWrap:"wrap"},dt={width:"200px",height:"280px",perspective:"1000px",cursor:"pointer",transition:"transform 0.2s ease"},ct={transform:"scale(1.05)"},pt={position:"relative",width:"100%",height:"100%",transition:"transform 0.8s",transformStyle:"preserve-3d"},ut={position:"absolute",width:"100%",height:"100%",backfaceVisibility:"hidden",backgroundColor:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"15px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.2)",border:"3px solid #fff"},mt={position:"absolute",width:"100%",height:"100%",backfaceVisibility:"hidden",backgroundColor:"#fff",borderRadius:"15px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.2)",border:"3px solid #667eea",transform:"rotateY(180deg)",opacity:0,transition:"opacity 0.3s ease 0.4s"},xt={opacity:1},ht={fontSize:"80px",marginBottom:"20px"},gt={fontSize:"24px",fontWeight:"bold",color:"white"},ft={fontSize:"36px",fontWeight:"bold",color:"#667eea",marginBottom:"10px"},bt={fontSize:"18px",color:"#666"},yt=(0,a.memo)(function(e){let{job:t,isAdmin:s,onEditJob:a,onDeleteJob:n,onAddTask:i,onEditTask:o,onDeleteTask:l,onEarnCoupon:r,addJobTaskButtonStyle:d}=e;if(!t)return null;const c=window.innerWidth<=768;return(0,L.jsxs)("div",{style:{backgroundColor:"rgba(20, 20, 35, 0.6)",borderRadius:"10px",border:"1px solid rgba(0, 255, 242, 0.2)",overflow:"hidden",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.3)",marginBottom:"15px",backdropFilter:"blur(5px)",display:"flex",flexDirection:"column",height:"100%"},children:[(0,L.jsxs)("div",{className:"job-header-container",style:{background:"linear-gradient(135deg, rgba(79, 70, 229, 0.2) 0%, rgba(99, 102, 241, 0.2) 100%)",padding:c?"12px 14px":"14px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid rgba(0, 255, 242, 0.2)"},children:[(0,L.jsx)("div",{className:"job-title-text",style:{fontWeight:"700",fontSize:c?"15px":"18px",textShadow:"0 1px 3px rgba(0,0,0,0.2)",letterSpacing:"-0.01em",color:"#e8e8ff",textShadow:"0 0 10px rgba(0, 255, 242, 0.3)"},children:t.title}),s&&(0,L.jsxs)("div",{children:[(0,L.jsx)("button",{onClick:()=>a(t.id),style:{background:"none",border:"none",cursor:"pointer",color:"rgba(255, 255, 255, 0.7)",marginRight:"8px",padding:"0"},"aria-label":"".concat(t.title," \uc9c1\uc5c5 \uc218\uc815"),children:"\u270f\ufe0f"}),(0,L.jsx)("button",{onClick:()=>n(t.id),style:{background:"none",border:"none",cursor:"pointer",color:"rgba(255, 255, 255, 0.7)",padding:"0"},"aria-label":"".concat(t.title," \uc9c1\uc5c5 \uc0ad\uc81c"),children:"\ud83d\uddd1\ufe0f"})]})]}),(0,L.jsx)("div",{style:{padding:c?"8px":"10px",flexGrow:1,overflowY:"auto"},children:t.tasks&&t.tasks.length>0?t.tasks.map(e=>(0,L.jsx)(et,{task:e,taskId:e.id,jobId:t.id,onEarnCoupon:r,onEditTask:()=>o(e.id,t.id),onDeleteTask:()=>l(e.id,t.id),isAdmin:s,isJobTask:!0},e.id)):(0,L.jsx)("p",{style:{fontSize:"13px",color:"#9999bb",textAlign:"center",margin:"10px 0"},children:"\ub4f1\ub85d\ub41c \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})}),s&&(0,L.jsx)("div",{style:{padding:c?"8px":"10px",borderTop:"1px solid rgba(0, 255, 242, 0.1)"},children:(0,L.jsx)("button",{onClick:i,style:d||{width:"100%",padding:c?"6px":"8px",backgroundColor:"rgba(0, 255, 242, 0.1)",border:"1px solid rgba(0, 255, 242, 0.3)",color:"#00fff2",borderRadius:"6px",cursor:"pointer",fontSize:c?"12px":"13px",fontWeight:"500",marginTop:"0",transition:"all 0.2s ease"},children:"+ \uc774 \uc9c1\uc5c5\uc5d0 \ud560\uc77c \ucd94\uac00"})})]},t.id)});function jt(e){let{tasks:t,isAdmin:s,onEditTask:a,onDeleteTask:n,onEarnCoupon:i}=e;if(!Array.isArray(t)||0===t.length)return(0,L.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#6b7280"},children:s?"\ub4f1\ub85d\ub41c \uacf5\ud1b5 \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790 \uc124\uc815\uc5d0\uc11c \ucd94\uac00\ud574\uc8fc\uc138\uc694.":"\ud604\uc7ac \uc218\ud589\ud560 \uc218 \uc788\ub294 \uacf5\ud1b5 \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."});const o="undefined"!==typeof window&&window.innerWidth<=768;return(0,L.jsx)("div",{style:{display:"grid",gridTemplateColumns:o?"1fr":"repeat(2, 1fr)",gap:o?"8px":"10px"},children:t.map(e=>(0,L.jsx)(et,{task:e,taskId:e.id,onEarnCoupon:i,onEditTask:()=>a(e.id),onDeleteTask:()=>n(e.id),isAdmin:s,isJobTask:!1},e.id))})}const vt=(0,a.memo)(function(e){let{showTransferModal:t,setShowTransferModal:s,recipients:a=[],transferRecipient:n,setTransferRecipient:i,transferAmount:o,setTransferAmount:r,handleTransfer:d,userId:c,userCash:p=0}=e;const u={display:t?"flex":"none",position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},m={width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",outline:"none",transition:"border-color 0.2s"},x=(0,l.A)((0,l.A)({},m),{},{cursor:"pointer",backgroundColor:"white"}),h={display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#374151"},g={padding:"10px 20px",borderRadius:"6px",border:"none",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},f=(0,l.A)((0,l.A)({},g),{},{backgroundColor:"#4f46e5",color:"white"}),b=(0,l.A)((0,l.A)({},g),{},{backgroundColor:"#e5e7eb",color:"#374151",marginRight:"10px"}),y=a.filter(e=>e&&e.id&&e.id!==c).sort((e,t)=>{const s=e.name||e.nickname||"\uc0ac\uc6a9\uc790 ".concat(e.id.substring(0,6)),a=t.name||t.nickname||"\uc0ac\uc6a9\uc790 ".concat(t.id.substring(0,6));return s.localeCompare(a,"ko")});return(0,L.jsx)("div",{style:u,onClick:()=>s(!1),children:(0,L.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"30px",maxWidth:"450px",width:"100%",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",position:"relative"},onClick:e=>e.stopPropagation(),children:[(0,L.jsx)("button",{onClick:()=>s(!1),style:{position:"absolute",top:"15px",right:"15px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6b7280",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"\ub2eb\uae30",children:"\xd7"}),(0,L.jsx)("h2",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"25px",color:"#1f2937"},children:"\ud83d\udcb8 \uc1a1\uae08\ud558\uae30"}),(0,L.jsx)("div",{style:{backgroundColor:"#f3f4f6",borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:(0,L.jsxs)("p",{style:{fontSize:"14px",color:"#4b5563",margin:"0"},children:["\ud604\uc7ac \ubcf4\uc720 \ud604\uae08: ",(0,L.jsxs)("strong",{style:{color:"#1f2937"},children:[p.toLocaleString(),"\uc6d0"]})]})}),(0,L.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d()},children:[(0,L.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,L.jsx)("label",{style:h,children:"\ubc1b\ub294 \uc0ac\ub78c"}),(0,L.jsxs)("select",{value:n,onChange:e=>i(e.target.value),style:x,required:!0,children:[(0,L.jsx)("option",{value:"",children:"\ubc1b\ub294 \ubd84\uc744 \uc120\ud0dd\ud558\uc138\uc694"}),y.length>0?y.map(e=>(0,L.jsx)("option",{value:e.id,children:e.name||e.nickname||"\uc0ac\uc6a9\uc790 ".concat(e.id.substring(0,6))},e.id)):(0,L.jsx)("option",{value:"",disabled:!0,children:"\uc1a1\uae08 \uac00\ub2a5\ud55c \ud559\uae09 \uce5c\uad6c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4"})]}),0===y.length&&(0,L.jsx)("p",{style:{marginTop:"8px",fontSize:"12px",color:"#ef4444"},children:"\u26a0\ufe0f \uac19\uc740 \ud559\uae09\uc758 \ub2e4\ub978 \uc0ac\uc6a9\uc790\uac00 \uc5c6\uac70\ub098 \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911\uc785\ub2c8\ub2e4."})]}),(0,L.jsxs)("div",{style:{marginBottom:"25px"},children:[(0,L.jsx)("label",{style:h,children:"\uc1a1\uae08 \uae08\uc561"}),(0,L.jsx)("input",{type:"number",value:o,onChange:e=>r(e.target.value),placeholder:"\uc1a1\uae08\ud560 \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694",style:m,min:"1",max:p,required:!0}),o&&parseInt(o)>p&&(0,L.jsx)("p",{style:{marginTop:"8px",fontSize:"12px",color:"#ef4444"},children:"\ubcf4\uc720 \ud604\uae08\ubcf4\ub2e4 \ub9ce\uc740 \uae08\uc561\uc740 \uc1a1\uae08\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",paddingTop:"10px",borderTop:"1px solid #e5e7eb"},children:[(0,L.jsx)("button",{type:"button",onClick:()=>s(!1),style:b,onMouseOver:e=>{e.target.style.backgroundColor="#d1d5db"},onMouseOut:e=>{e.target.style.backgroundColor="#e5e7eb"},children:"\ucde8\uc18c"}),(0,L.jsx)("button",{type:"submit",style:f,disabled:!n||!o||parseInt(o)>p||0===y.length,onMouseOver:e=>{e.target.disabled||(e.target.style.backgroundColor="#4338ca")},onMouseOut:e=>{e.target.disabled||(e.target.style.backgroundColor="#4f46e5")},children:"\uc1a1\uae08"})]})]})]})})}),wt=vt;s(5226),s(3057),s(783);var Nt=s(7029),Ct=s(3248),kt=s(7097);const St=e=>{const t=(0,Ze.Qg)(G.Cn,e);return async s=>{try{const e=await t(s);if(e.data.success)return e.data;throw new Error(e.data.message||"\ud568\uc218 \uc2e4\ud589 \uc2e4\ud328")}catch(a){throw console.error("".concat(e," \uc624\ub958:"),a),a}}},At={getAdminSettingsData:St("getAdminSettingsData"),batchPaySalaries:St("batchPaySalaries"),getItemContextData:St("getItemContextData")},It=(e,t)=>["adminSettings",e,t],Et=e=>["students",e],Tt=e=>["salarySettings",e],Mt=()=>["systemManagement"],Dt=()=>navigator.onLine&&!document.hidden,Rt=(e,t)=>{try{localStorage.setItem("backup_".concat(e),JSON.stringify({data:t,timestamp:Date.now()}))}catch(s){console.warn("\ub85c\uceec \ubc31\uc5c5 \uc800\uc7a5 \uc2e4\ud328:",s)}},zt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e4;try{const s=localStorage.getItem("backup_".concat(e));if(s){const e=JSON.parse(s);if(Date.now()-e.timestamp<t)return e.data}}catch(s){console.warn("\ub85c\uceec \ubc31\uc5c5 \ub85c\ub4dc \uc2e4\ud328:",s)}return null},Ot=e=>{try{localStorage.removeItem("backup_".concat(e))}catch(t){console.warn("\ub85c\uceec \ubc31\uc5c5 \uc0ad\uc81c \uc2e4\ud328:",t)}},_t=e=>{let{isSuperAdmin:t}=e;const[s,n]=(0,a.useState)(null),[i,o]=(0,a.useState)(!1),[l,r]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1),[p,u]=(0,a.useState)(null),[m,x]=(0,a.useState)(0),h=(0,Ze.Qg)(G.Cn,"getSystemStatus"),g=(0,Ze.Qg)(G.Cn,"resolveSystemAlert"),f=(0,a.useCallback)(async()=>{if(t){o(!0),r(null);try{const e=await h();if(!e.data.success)throw new Error(e.data.message||"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc \uc870\ud68c \uc2e4\ud328");n(e.data.data),u(new Date),x(0)}catch(e){console.error("[SystemMonitoring] \uc0c1\ud0dc \uc870\ud68c \uc624\ub958:",e),r(e.message||"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc\ub97c \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),x(e=>e+1),m>=2&&(c(!1),console.warn("[SystemMonitoring] \uc5f0\uc18d \uc5d0\ub7ec \ubc1c\uc0dd\uc73c\ub85c \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\uc744 \uc911\uc9c0\ud569\ub2c8\ub2e4."))}finally{o(!1)}}},[t,h,m]),b=(0,a.useCallback)(async e=>{if(window.confirm("\uc774 \uacbd\uace0\ub97c \ud574\uacb0 \ucc98\ub9ac\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))try{(await g({alertId:e})).data.success&&(alert("\uacbd\uace0\uac00 \ud574\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),f())}catch(t){console.error("[SystemMonitoring] \uacbd\uace0 \ud574\uacb0 \uc624\ub958:",t),alert("\uacbd\uace0 \ud574\uacb0 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(t.message))}},[g,f]);return(0,a.useEffect)(()=>{t&&f()},[t,f]),(0,a.useEffect)(()=>{if(!d||!t)return;const e=setInterval(()=>{f()},12e4);return()=>clearInterval(e)},[d,t,f]),(0,a.useEffect)(()=>{d&&x(0)},[d]),t?(0,L.jsxs)("div",{className:"system-monitoring section-card",children:[(0,L.jsxs)("div",{className:"monitoring-header",children:[(0,L.jsx)("h3",{children:"\ud83d\udda5\ufe0f \uc11c\ubc84 \uc0c1\ud0dc \ubaa8\ub2c8\ud130\ub9c1"}),(0,L.jsxs)("div",{className:"monitoring-controls",children:[(0,L.jsxs)("label",{className:"auto-refresh-toggle",children:[(0,L.jsx)("input",{type:"checkbox",checked:d,onChange:e=>c(e.target.checked)}),(0,L.jsx)("span",{children:"\uc790\ub3d9 \uc0c8\ub85c\uace0\uce68 (30\ucd08)"})]}),(0,L.jsx)("button",{onClick:f,disabled:i,className:"refresh-button",children:i?"\u23f3 \uc870\ud68c \uc911...":"\ud83d\udd04 \uc0c8\ub85c\uace0\uce68"})]})]}),p&&(0,L.jsxs)("p",{className:"last-update",children:["\ub9c8\uc9c0\ub9c9 \uc5c5\ub370\uc774\ud2b8: ",p.toLocaleTimeString("ko-KR")]}),l&&(0,L.jsxs)("div",{className:"error-message",children:[(0,L.jsxs)("p",{children:["\u274c ",l]}),m>=3&&(0,L.jsx)("p",{style:{marginTop:"8px",fontSize:"14px"},children:"\u26a0\ufe0f \uc5f0\uc18d \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud558\uc5ec \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\uc774 \uc911\uc9c0\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc218\ub3d9\uc73c\ub85c \uc0c8\ub85c\uace0\uce68\ud558\uac70\ub098 \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\uc744 \ub2e4\uc2dc \ud65c\uc131\ud654\ud574\uc8fc\uc138\uc694."})]}),s&&(0,L.jsxs)(L.Fragment,{children:[s.message&&(0,L.jsx)("div",{className:"info-message",style:{padding:"12px",background:"#e3f2fd",border:"1px solid #90caf9",borderRadius:"4px",marginBottom:"15px",color:"#1976d2"},children:(0,L.jsxs)("p",{style:{margin:0},children:["\u2139\ufe0f ",s.message]})}),(0,L.jsxs)("div",{className:"system-health-card",children:[(0,L.jsx)("h4",{children:"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc"}),(0,L.jsxs)("div",{className:"health-indicator health-".concat(s.health),children:[(0,L.jsx)("span",{className:"health-icon",children:"healthy"===s.health?"\u2705":"warning"===s.health?"\u26a0\ufe0f":"\ud83d\udea8"}),(0,L.jsx)("span",{className:"health-text",children:"healthy"===s.health?"\uc815\uc0c1":"warning"===s.health?"\uc8fc\uc758":"\uc704\ud5d8"})]}),(0,L.jsx)("div",{className:"stats-grid",children:(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\uc804\uccb4 \uc0ac\uc6a9\uc790"}),(0,L.jsx)("span",{className:"stat-value",children:s.totalUsers})]})})]}),(0,L.jsxs)("div",{className:"stats-card",children:[(0,L.jsx)("h4",{children:"\ucd5c\uadfc 1\ubd84 \ud1b5\uacc4"}),(0,L.jsxs)("div",{className:"stats-grid",children:[(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\uc77d\uae30 \uc791\uc5c5"}),(0,L.jsx)("span",{className:"stat-value",children:s.stats.lastMinute.reads.toLocaleString()})]}),(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\uc4f0\uae30 \uc791\uc5c5"}),(0,L.jsx)("span",{className:"stat-value",children:s.stats.lastMinute.writes.toLocaleString()})]}),(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\uc5d0\ub7ec \uc218"}),(0,L.jsx)("span",{className:"stat-value",children:s.stats.lastMinute.errors})]}),(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\uc5d0\ub7ec\uc728"}),(0,L.jsxs)("span",{className:"stat-value",children:[(100*s.stats.lastMinute.errorRate).toFixed(2),"%"]})]}),(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\ud3c9\uade0 \uc751\ub2f5 \uc2dc\uac04"}),(0,L.jsxs)("span",{className:"stat-value",children:[s.stats.lastMinute.avgResponseTime.toFixed(0),"ms"]})]})]})]}),s.anomalies&&s.anomalies.length>0&&(0,L.jsxs)("div",{className:"anomalies-card",children:[(0,L.jsx)("h4",{children:"\u26a0\ufe0f \ube44\uc815\uc0c1 \ud328\ud134 \uac10\uc9c0"}),(0,L.jsx)("div",{className:"anomalies-list",children:s.anomalies.map((e,t)=>(0,L.jsxs)("div",{className:"anomaly-item anomaly-".concat(e.severity),children:[(0,L.jsxs)("div",{className:"anomaly-header",children:[(0,L.jsx)("span",{className:"anomaly-severity",children:"critical"===e.severity?"\ud83d\udea8 \uc2ec\uac01":"error"===e.severity?"\u274c \uc624\ub958":"\u26a0\ufe0f \uacbd\uace0"}),(0,L.jsx)("span",{className:"anomaly-type",children:e.type})]}),(0,L.jsx)("p",{className:"anomaly-message",children:e.message})]},t))})]}),s.alerts&&s.alerts.length>0&&(0,L.jsxs)("div",{className:"alerts-card",children:[(0,L.jsxs)("h4",{children:["\ud83d\udd14 \ud65c\uc131 \uacbd\uace0 (",s.alerts.length,")"]}),(0,L.jsx)("div",{className:"alerts-list",children:s.alerts.map(e=>{var t,s;const a=null!==(t=e.timestamp)&&void 0!==t&&t.toDate?e.timestamp.toDate():new Date(1e3*(null===(s=e.timestamp)||void 0===s?void 0:s.seconds)||Date.now());return(0,L.jsxs)("div",{className:"alert-item alert-".concat(e.severity),children:[(0,L.jsxs)("div",{className:"alert-header",children:[(0,L.jsx)("span",{className:"alert-time",children:a.toLocaleString("ko-KR")}),(0,L.jsx)("button",{onClick:()=>b(e.id),className:"resolve-alert-button",children:"\ud574\uacb0"})]}),(0,L.jsx)("p",{className:"alert-message",children:e.message})]},e.id)})})]}),s.errorLogs&&s.errorLogs.length>0&&(0,L.jsxs)("div",{className:"error-logs-card",children:[(0,L.jsx)("h4",{children:"\ud83d\udcdd \ucd5c\uadfc \uc5d0\ub7ec \ub85c\uadf8 (1\uc2dc\uac04)"}),(0,L.jsx)("div",{className:"error-logs-list",children:s.errorLogs.slice(0,10).map(e=>{var t,s;const a=null!==(t=e.timestamp)&&void 0!==t&&t.toDate?e.timestamp.toDate():new Date(1e3*(null===(s=e.timestamp)||void 0===s?void 0:s.seconds)||Date.now());return(0,L.jsxs)("div",{className:"error-log-item",children:[(0,L.jsx)("span",{className:"log-time",children:a.toLocaleTimeString("ko-KR")}),(0,L.jsx)("span",{className:"log-message",children:e.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958"})]},e.id)})})]}),(0,L.jsxs)("div",{className:"stats-card",children:[(0,L.jsx)("h4",{children:"\ucd5c\uadfc 5\ubd84 \ud1b5\uacc4"}),(0,L.jsxs)("div",{className:"stats-grid",children:[(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\ucd1d \uc77d\uae30 \uc791\uc5c5"}),(0,L.jsx)("span",{className:"stat-value",children:s.stats.last5Minutes.reads.toLocaleString()})]}),(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\ucd1d \uc4f0\uae30 \uc791\uc5c5"}),(0,L.jsx)("span",{className:"stat-value",children:s.stats.last5Minutes.writes.toLocaleString()})]}),(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\ucd1d \uc5d0\ub7ec"}),(0,L.jsx)("span",{className:"stat-value",children:s.stats.last5Minutes.errors})]})]})]})]}),!s&&!i&&!l&&(0,L.jsx)("div",{className:"no-data-message",children:(0,L.jsx)("p",{children:"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub824\uba74 \uc0c8\ub85c\uace0\uce68 \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694."})})]}):(0,L.jsxs)("div",{className:"system-monitoring section-card",children:[(0,L.jsx)("h3",{children:"\ud83d\udd12 \uc11c\ubc84 \uc0c1\ud0dc \ubaa8\ub2c8\ud130\ub9c1"}),(0,L.jsx)("p",{className:"admin-section-desc",children:"\ucd5c\uace0 \uad00\ub9ac\uc790\ub9cc \uc811\uadfc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})]})};var Lt=s(5967);const Wt=[{id:"KP",name:"\ucf54\ub529 \ud30c\ud2b8\ub108",price:1e4,history:[{price:1e4,timestamp:new Date}]},{id:"SS",name:"\uc0bc\uc131\uc804\uc790",price:8e4,history:[{price:8e4,timestamp:new Date}]},{id:"LG",name:"LG\uc5d0\ub108\uc9c0\uc194\ub8e8\uc158",price:35e4,history:[{price:35e4,timestamp:new Date}]},{id:"SK",name:"SK\ud558\uc774\ub2c9\uc2a4",price:23e4,history:[{price:23e4,timestamp:new Date}]}],Bt=e=>{var t;let{isAdmin:s,isSuperAdmin:n,userClassCode:o,showAdminSettingsModal:r,setShowAdminSettingsModal:d,adminSelectedMenu:c,setAdminSelectedMenu:p,newGoalAmount:u,setNewGoalAmount:m,adminCouponValue:x,setAdminCouponValue:h,handleSaveAdminSettings:g,jobs:f,adminNewJobTitle:b,setAdminNewJobTitle:y,adminEditingJob:j,setAdminEditingJob:v,handleSaveJob:w,handleDeleteJob:N,handleEditJob:C,commonTasks:k,showAddTaskForm:S,setShowAddTaskForm:A,adminNewTaskName:I,setAdminNewTaskName:E,adminNewTaskReward:T,setAdminNewTaskReward:M,adminNewTaskMaxClicks:D,setAdminNewTaskMaxClicks:R,adminEditingTask:z,setAdminEditingTask:O,handleSaveTask:_,handleEditTask:W,handleDeleteTask:B,taskFormJobId:P,taskFormIsJobTask:F,handleAddTaskClick:q,classCodes:U=[],onAddClassCode:Q,onRemoveClassCode:H}=e;const[J,V]=(0,a.useState)(""),[K,X]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)([]),[$,te]=(0,a.useState)(!1),[se,ae]=(0,a.useState)(!1),[ne,ie]=(0,a.useState)(null),[oe,le]=(0,a.useState)([]),[re,de]=(0,a.useState)([]),[ce,pe]=(0,a.useState)(!1),[ue,me]=(0,a.useState)(!1),[xe,he]=(0,a.useState)(!1),[ge,fe]=(0,a.useState)(null),[be,ye]=(0,a.useState)([]),[je,ve]=(0,a.useState)(!1),[we,Ne]=(0,a.useState)(""),[Ce,ke]=(0,a.useState)([]),[Se,Ae]=(0,a.useState)([]),[Ie,Ee]=(0,a.useState)([]),[Te,Me]=(0,a.useState)(""),[De,Re]=(0,a.useState)(""),[ze,Oe]=(0,a.useState)(""),[_e,Le]=(0,a.useState)("deposit"),[We,Be]=(0,a.useState)(null),[Pe,Fe]=(0,a.useState)({isOpen:!1}),[qe,Ue]=(0,a.useState)(""),[Qe,He]=(0,a.useState)(!1),Ge=(0,a.useRef)(null),[Je,Ve]=(0,a.useState)(.1),[Ke,Xe]=(0,a.useState)(""),[Ye,$e]=(0,a.useState)(null),et=(0,Ze.Qg)(G.Cn,"toggleMarketManually"),[tt,st]=(0,a.useState)({taxRate:.1,salaryIncreaseRate:.03}),[at,nt]=(0,a.useState)("10"),[it,ot]=(0,a.useState)("3"),[lt,rt]=(0,a.useState)(!1),dt=(()=>{const{userDoc:e,isAdmin:t,isSuperAdmin:s}=(0,i.As)(),a=null===e||void 0===e?void 0:e.classCode;return(0,Nt.I)({queryKey:Et(a),queryFn:async()=>(await At.getAdminSettingsData({tab:"studentManagement"})).data,enabled:!(null===t||void 0===t||!t()||!a),staleTime:18e4,cacheTime:48e4})})(),ct=(()=>{const{userDoc:e,isAdmin:t}=(0,i.As)(),s=null===e||void 0===e?void 0:e.classCode;return(0,Nt.I)({queryKey:Tt(s),queryFn:async()=>(await At.getAdminSettingsData({tab:"salarySettings"})).data,enabled:!(null===t||void 0===t||!t()||!s),staleTime:6e5,cacheTime:9e5})})(),pt=((()=>{const{isSuperAdmin:e}=(0,i.As)();(0,Nt.I)({queryKey:Mt(),queryFn:async()=>(await At.getAdminSettingsData({tab:"systemManagement"})).data,enabled:!(null===e||void 0===e||!e()),staleTime:9e5,cacheTime:12e5})})(),(e=>{const{userDoc:t,isAdmin:s}=(0,i.As)(),a=null===t||void 0===t?void 0:t.classCode;(0,Nt.I)({queryKey:It(a,e),queryFn:async()=>{const t="admin_".concat(a,"_").concat(e),s=zt(t,3e4);if(s&&!navigator.onLine)return s;const n=await At.getAdminSettingsData({tab:e});return Rt(t,n),n},enabled:!!(null!==s&&void 0!==s&&s()&&a&&e),staleTime:3e5,cacheTime:6e5,retry:(e,t)=>"permission-denied"!==(null===t||void 0===t?void 0:t.code)&&e<2,refetchInterval:!!Dt()&&3e5})})("generalSettings"),(()=>{const e=(0,Ct.jE)(),{userDoc:t}=(0,i.As)(),s=null===t||void 0===t?void 0:t.classCode;return(0,kt.n)({mutationFn:async e=>{let{studentIds:t,payAll:s}=e;return await At.batchPaySalaries({studentIds:t,payAll:s})},onSuccess:()=>{e.invalidateQueries({queryKey:Et(s)}),e.invalidateQueries({queryKey:Tt(s)}),Ot("admin_".concat(s,"_studentManagement")),Ot("admin_".concat(s,"_salarySettings"))},onError:e=>{console.error("\uae09\uc5ec \uc9c0\uae09 \uc2e4\ud328:",e)}})})()),{preloadAdminData:ut}=(()=>{const e=(0,Ct.jE)(),{userDoc:t,isAdmin:s}=(0,i.As)(),a=null===t||void 0===t?void 0:t.classCode;return{preloadAdminData:async()=>{if(null===s||void 0===s||!s()||!a)return;const t=["generalSettings","studentManagement","salarySettings"].map(t=>e.prefetchQuery({queryKey:It(a,t),queryFn:async()=>await At.getAdminSettingsData({tab:t}),staleTime:3e5}));await Promise.allSettled(t)}}})(),mt=(0,a.useCallback)(async()=>{if(G.db)try{const e=o?(0,G.EW)(G.db,"settings","salarySettings_".concat(o)):(0,G.EW)(G.db,"settings","salarySettings"),t=await(0,G.I_)(e);if(t.exists()){const e=t.data(),s={taxRate:e.taxRate||.1,salaryIncreaseRate:e.salaryIncreaseRate||.03};st(s),nt(String((100*s.taxRate).toFixed(1))),ot(String((100*s.salaryIncreaseRate).toFixed(1))),e.lastPaidDate&&fe(e.lastPaidDate.toDate())}else await(0,G.iv)(e,{taxRate:.1,salaryIncreaseRate:.03,lastPaidDate:null,classCode:o||null,createdAt:(0,G.O5)(),updatedAt:(0,G.O5)()})}catch(we){console.error("\uae09\uc5ec \uc124\uc815 \ub85c\ub4dc \uc624\ub958:",we)}},[G.db,o]),xt=(0,a.useCallback)(async()=>{if(!G.db)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.");const e=parseFloat(at),t=parseFloat(it);if(isNaN(e)||e<0||e>100)alert("\uc138\uc728\uc740 0~100 \uc0ac\uc774\uc758 \uc22b\uc790\uc5ec\uc57c \ud569\ub2c8\ub2e4.");else if(isNaN(t)||t<0||t>100)alert("\uc8fc\uae09 \uc778\uc0c1\ub960\uc740 0~100 \uc0ac\uc774\uc758 \uc22b\uc790\uc5ec\uc57c \ud569\ub2c8\ub2e4.");else{rt(!0);try{const s=o?(0,G.EW)(G.db,"settings","salarySettings_".concat(o)):(0,G.EW)(G.db,"settings","salarySettings"),a={taxRate:e/100,salaryIncreaseRate:t/100,classCode:o||null,updatedAt:(0,G.O5)()};await(0,G.tI)(s,a),st({taxRate:a.taxRate,salaryIncreaseRate:a.salaryIncreaseRate}),alert("\uae09\uc5ec \uc124\uc815\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(we){console.error("\uae09\uc5ec \uc124\uc815 \uc800\uc7a5 \uc624\ub958:",we),alert("\uae09\uc5ec \uc124\uc815 \uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message)}finally{rt(!1)}}},[G.db,o]),ht=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Array.isArray(e)||0===e.length)return{gross:0,tax:0,net:0};const s=2e6+5e5*Math.max(0,e.length-1);if(!t)return s;const a=Math.floor(s*tt.taxRate);return{gross:s,tax:a,net:s-a}},[tt.taxRate]),gt=(0,a.useCallback)(e=>{console.log("[AdminSettingsModal] \uc9c1\uc5c5 \ud3b8\uc9d1 \ud074\ub9ad:",e),C&&"function"===typeof C?C(e):(console.error("[AdminSettingsModal] handleEditJob \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\uc9c1\uc5c5 \ud3b8\uc9d1 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[C]),ft=(0,a.useCallback)(e=>{console.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc0ad\uc81c \ud074\ub9ad:",e),N&&"function"===typeof N?N(e):(console.error("[AdminSettingsModal] handleDeleteJob \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\uc9c1\uc5c5 \uc0ad\uc81c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[N]),bt=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("[AdminSettingsModal] \ud560\uc77c \ud3b8\uc9d1 \ud074\ub9ad:",e,"jobId:",t),W&&"function"===typeof W?W(e,t):(console.error("[AdminSettingsModal] handleEditTask \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \ud3b8\uc9d1 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[W]),yt=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("[AdminSettingsModal] \ud560\uc77c \uc0ad\uc81c \ud074\ub9ad:",e,"jobId:",t),B&&"function"===typeof B?B(e,t):(console.error("[AdminSettingsModal] handleDeleteTask \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \uc0ad\uc81c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[B]),jt=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("[AdminSettingsModal] \ud560\uc77c \ucd94\uac00 \ud074\ub9ad:",e,"isJobTask:",t),q&&"function"===typeof q?q(e,t):(console.error("[AdminSettingsModal] handleAddTaskClick \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \ucd94\uac00 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[q]),vt=(0,a.useCallback)(async()=>{if(!G.db)return console.error("loadStudents: Firestore \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."),Ne("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958\ub85c \ud559\uc0dd \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),de([]),void pe(!1);pe(!0),Ne("");try{let s=[];if(!n&&!o)return Ne("\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \ud559\uc0dd \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),de([]),void pe(!1);if(!n&&o)try{const e=(0,G.gJ)(G.db,"Class",o,"students");(await(0,G.FX)(e)).forEach(e=>{const t=e.data();s.push({id:e.id,nickname:t.nickname||t.name||"\uc774\ub984 \uc5c6\uc74c",name:t.name||"",email:t.email||"",classCode:o,selectedJobIds:t.selectedJobIds||[],cash:t.money||t.cash||0,lastSalaryDate:t.lastSalaryDate?t.lastSalaryDate.toDate():null,lastGrossSalary:t.lastGrossSalary||0,lastTaxAmount:t.lastTaxAmount||0,lastNetSalary:t.lastNetSalary||0,totalSalaryReceived:t.totalSalaryReceived||0})})}catch(e){}if(0===s.length){const e=(0,G.gJ)(G.db,"users");let t;!n&&o?t=(0,G.P)(e,(0,G._M)("classCode","==",o)):n&&(t=e);(await(0,G.FX)(t)).forEach(e=>{const t=e.data();t.isAdmin||t.isSuperAdmin||s.push({id:e.id,nickname:t.nickname||t.name||"\uc774\ub984 \uc5c6\uc74c",name:t.name||"",email:t.email||"",classCode:t.classCode||"\ubbf8\uc9c0\uc815",selectedJobIds:t.selectedJobIds||[],cash:t.cash||0,lastSalaryDate:t.lastSalaryDate?t.lastSalaryDate.toDate():null,lastGrossSalary:t.lastGrossSalary||0,lastTaxAmount:t.lastTaxAmount||0,lastNetSalary:t.lastNetSalary||0,totalSalaryReceived:t.totalSalaryReceived||0})})}de(s);try{const e=o?(0,G.EW)(G.db,"settings","salarySettings_".concat(o)):(0,G.EW)(G.db,"settings","salarySettings"),t=await(0,G.I_)(e);if(t.exists()){const e=t.data();fe(e.lastPaidDate?e.lastPaidDate.toDate():null),st({taxRate:e.taxRate||.1,salaryIncreaseRate:e.salaryIncreaseRate||.03})}else fe(null)}catch(t){console.error("\uae09\uc5ec \uc124\uc815 \ub85c\ub4dc \uc624\ub958:",t),fe(null)}ye([]),ve(!1)}catch(we){console.error("loadStudents: \ud559\uc0dd \ubaa9\ub85d \ub85c\ub4dc \uc624\ub958:",we),Ne("\ud559\uc0dd \ubaa9\ub85d\uc744 \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message),de([])}finally{pe(!1)}},[G.db,n,o]),wt=(0,a.useCallback)(async()=>{if(!G.db)return console.error("loadClassMembers: Firestore \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."),Ne("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958\ub85c \ud559\uae09 \uad6c\uc131\uc6d0 \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),Z([]),void te(!1);te(!0),Ne("");try{const e=(0,G.gJ)(G.db,"users");let t;if(!n&&o)t=(0,G.P)(e,(0,G._M)("classCode","==",o));else{if(!n)return console.warn("\uad00\ub9ac\uc790\uc758 \ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),Ne("\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \uad6c\uc131\uc6d0 \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),Z([]),void te(!1);t=e}const s=await(0,G.FX)(t),a=[];s.forEach(e=>{const t=e.data();a.push({id:e.id,name:t.name||t.nickname||"\uc774\ub984 \uc5c6\uc74c",email:t.email,classCode:t.classCode||"\ucf54\ub4dc \uc5c6\uc74c",isAdmin:t.isAdmin||!1,isSuperAdmin:t.isSuperAdmin||!1})}),Z(a),console.log("[AdminSettingsModal] ".concat(a.length,"\uba85\uc758 \uad6c\uc131\uc6d0 \ub85c\ub4dc \uc644\ub8cc"))}catch(we){console.error("loadClassMembers: \ud559\uae09 \uad6c\uc131\uc6d0 \ub85c\ub4dc \uc624\ub958:",we),Ne("\ud559\uae09 \uad6c\uc131\uc6d0\uc744 \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message),Z([])}finally{te(!1)}},[G.db,n,o]),St=(0,Ze.Qg)(G.Cn,"adminResetUserPassword"),Bt=(0,a.useCallback)(async e=>{if(!s&&!n)return void alert("\uad00\ub9ac\uc790\ub9cc \ube44\ubc00\ubc88\ud638\ub97c \ucd08\uae30\ud654\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.");const t=prompt("\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694. 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");if(!t||t.length<6)alert("\ube44\ubc00\ubc88\ud638\ub294 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");else if(window.confirm("\uc0ac\uc6a9\uc790(ID: ".concat(e,")\uc758 \ube44\ubc00\ubc88\ud638\ub97c \uc815\ub9d0\ub85c \ucd08\uae30\ud654\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))try{te(!0);const s=await St({userId:e,newPassword:t});if(!s.data.success)throw new Error(s.data.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958");alert(s.data.message)}catch(we){console.error("\ube44\ubc00\ubc88\ud638 \ucd08\uae30\ud654 \uc624\ub958:",we),alert("\ube44\ubc00\ubc88\ud638 \ucd08\uae30\ud654 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(we.message))}finally{te(!1)}},[s,n,St]),Pt=(0,a.useCallback)(async(e,t)=>{if(G.db)if(n){if(window.confirm("\uc774 \uc0ac\uc6a9\uc790\uc758 \uad00\ub9ac\uc790 \uad8c\ud55c\uc744 ".concat(t?"\uc81c\uac70":"\ubd80\uc5ec","\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))){te(!0);try{const s=(0,G.EW)(G.db,"users",e);await(0,G.tI)(s,{isAdmin:!t}),Z(s=>s.map(s=>s.id===e?(0,l.A)((0,l.A)({},s),{},{isAdmin:!t}):s)),alert("\uad00\ub9ac\uc790 \uad8c\ud55c\uc774 ".concat(t?"\uc81c\uac70":"\ubd80\uc5ec","\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))}catch(we){console.error("\uad00\ub9ac\uc790 \uad8c\ud55c \ubcc0\uacbd \uc624\ub958:",we),alert("\uad00\ub9ac\uc790 \uad8c\ud55c \ubcc0\uacbd \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{te(!1)}}}else alert("\ucd5c\uace0 \uad00\ub9ac\uc790\ub9cc \uad00\ub9ac\uc790 \uad8c\ud55c\uc744 \ubd80\uc5ec/\ud574\uc81c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.");else alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.")},[G.db,n]),Ft=(0,a.useCallback)(()=>{try{const e=localStorage.getItem("depositProducts"),t=localStorage.getItem("savingProducts"),s=localStorage.getItem("loanProducts");e&&ke(JSON.parse(e)),t&&Ae(JSON.parse(t)),s&&Ee(JSON.parse(s))}catch(we){console.error("\uae08\uc735 \uc0c1\ud488 \ub85c\ub4dc \uc624\ub958:",we)}},[]),qt=(0,a.useCallback)(()=>{if(!Te||""===Te.trim())return void Be({type:"error",text:"\uc0c1\ud488\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});if(!De||isNaN(De)||parseInt(De)<=0)return void Be({type:"error",text:"\uc720\ud6a8\ud55c \uae30\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});if(!ze||isNaN(ze)||parseFloat(ze)<0)return void Be({type:"error",text:"\uc720\ud6a8\ud55c \uc774\uc728\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});const e={id:Date.now(),name:Te.trim(),period:parseInt(De),rate:parseFloat(ze)},t="deposit"===_e?"\uc608\uae08":"saving"===_e?"\uc801\uae08":"\ub300\ucd9c";let s=[],a="";"deposit"===_e?(s=[...Ce,e],ke(s),a="depositProducts"):"saving"===_e?(s=[...Se,e],Ae(s),a="savingProducts"):"loan"===_e&&(s=[...Ie,e],Ee(s),a="loanProducts"),localStorage.setItem(a,JSON.stringify(s)),Be({type:"success",text:"".concat(t," \uc0c1\ud488\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}),Me(""),Re(""),Oe(""),setTimeout(()=>Be(null),3e3)},[Te,De,ze,_e,Ce,Se,Ie]),Ut=(0,a.useCallback)((e,t)=>{const s="deposit"===t?"\uc608\uae08":"saving"===t?"\uc801\uae08":"\ub300\ucd9c";if(!window.confirm("\uc774 ".concat(s," \uc0c1\ud488\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))return;let a=[],n="";"deposit"===t?(a=Ce.filter(t=>t.id!==e),ke(a),n="depositProducts"):"saving"===t?(a=Se.filter(t=>t.id!==e),Ae(a),n="savingProducts"):"loan"===t&&(a=Ie.filter(t=>t.id!==e),Ee(a),n="loanProducts"),localStorage.setItem(n,JSON.stringify(a)),Be({type:"success",text:"".concat(s," \uc0c1\ud488\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}),setTimeout(()=>Be(null),3e3)},[Ce,Se,Ie]),Qt=(0,a.useCallback)(async function(){if(o)if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&Ge.current&&Qe)Fe(Ge.current);else try{const e=(0,ee.H9)(G.db,"ClassStock/".concat(o,"/marketStatus/status")),t=await(0,ee.x7)(e);let s;t.exists()?s=t.data():(s={isOpen:!1},await(0,ee.BN)(e,s)),Ge.current=s,Fe(s),He(!0)}catch(we){console.error("\uc2dc\uc7a5 \uc0c1\ud0dc \uc870\ud68c \uc2e4\ud328:",we),Ue("\uc2dc\uc7a5 \uc0c1\ud0dc\ub97c \ubd88\ub7ec\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},[o,Qe]),Ht=(0,a.useCallback)(async e=>{const t=e?"\uc218\ub3d9 \uac1c\uc7a5":"\uc218\ub3d9 \ud3d0\uc7a5";if(window.confirm("\uc815\ub9d0\ub85c \uc2dc\uc7a5\uc744 '".concat(t,"' \uc0c1\ud0dc\ub85c \ubcc0\uacbd\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))){try{const t={isOpen:e};Fe(t),Ge.current=t;const s=await et({classCode:o,isOpen:e});Ue(s.data.message)}catch(we){console.error("\uc2dc\uc7a5 \uc0c1\ud0dc \ubcc0\uacbd \uc624\ub958:",we),Ue("\uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(we.message)),Ge.current?Fe(Ge.current):Qt(!0)}setTimeout(()=>Ue(""),5e3)}},[o,et,Qt]),Gt=(0,a.useCallback)(async()=>{if(window.confirm("\ubaa8\ub4e0 \uc8fc\uc2dd \uc815\ubcf4\ub97c \ucd08\uae30\ud654\ud558\uace0 \uae30\ubcf8\uac12\uc73c\ub85c \uc124\uc815\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")){try{const e=(0,G.wP)(G.db);Wt.forEach(t=>{const s=(0,ee.H9)(G.db,"CentralStocks",t.id);e.set(s,t)}),await e.commit(),alert("\uc8fc\uc2dd \uc815\ubcf4\uac00 \uc131\uacf5\uc801\uc73c\ub85c \ucd08\uae30\ud654\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),Ue("\uc8fc\uc2dd \uc815\ubcf4\uac00 \uc131\uacf5\uc801\uc73c\ub85c \ucd08\uae30\ud654\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(we){console.error("\uc8fc\uc2dd \uc815\ubcf4 \ucd08\uae30\ud654 \uc911 \uc624\ub958 \ubc1c\uc0dd:",we),Ue("\ucd08\uae30\ud654 \uc2e4\ud328: ".concat(we.message))}setTimeout(()=>Ue(""),5e3)}},[]),Jt=(0,a.useCallback)(()=>{const e=localStorage.getItem("parkingInterestRate");e&&Ve(parseFloat(e))},[]),Vt=(0,a.useCallback)(()=>{if(!Ke||isNaN(Ke)||parseFloat(Ke)<0)return void $e({type:"error",text:"\uc720\ud6a8\ud55c \uc774\uc790\uc728\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694 (0 \uc774\uc0c1)."});const e=parseFloat(Ke);Ve(e),localStorage.setItem("parkingInterestRate",e.toString()),$e({type:"success",text:"\ud30c\ud0b9 \ud1b5\uc7a5 \uc77c\uc77c \uc774\uc790\uc728\uc774 ".concat(e,"%\ub85c \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}),Xe(""),setTimeout(()=>$e(null),3e3)},[Ke]),Kt=(0,a.useCallback)(async()=>{if(!Q||"function"!==typeof Q)return void alert("\ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const e=J.trim();if(e){X(!0);try{await Q(e)&&V("")}catch(we){console.error("AdminSettingsModal: \ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uc911 \uc624\ub958:",we)}finally{X(!1)}}else alert("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},[J,Q]),Xt=(0,a.useCallback)(async e=>{if(H&&"function"===typeof H){X(!0);try{await H(e)}catch(we){console.error("AdminSettingsModal: \ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uc911 \uc624\ub958:",we)}finally{X(!1)}}else alert("\ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},[H]);(0,a.useEffect)(()=>{r&&(ut(),Ne(""),Ft(),Jt()),r||(V(""),Z([]),de([]),ie(null),le([]),ae(!1),fe(null),ye([]),ve(!1),X(!1),te(!1),pe(!1),me(!1),Ne(""),Be(null),Ue(""),$e(null))},[r,c,wt,vt,mt,Ft,Jt]),(0,a.useEffect)(()=>{r&&"marketControl"===c&&Qt()},[r,c,Qt]);const Yt=()=>{if(!ge)return"\uc544\uc9c1 \uc9c0\uae09 \uae30\ub85d \uc5c6\uc74c";try{const e=ge;return"".concat(e.getFullYear(),"\ub144 ").concat(String(e.getMonth()+1).padStart(2,"0"),"\uc6d4 ").concat(String(e.getDate()).padStart(2,"0"),"\uc77c ").concat(String(e.getHours()).padStart(2,"0"),":").concat(String(e.getMinutes()).padStart(2,"0"))}catch(e){return console.error("formatLastSalaryDate \uc624\ub958:",e),"\ub0a0\uc9dc \ud615\uc2dd \uc624\ub958"}};return r?s||n?(0,L.jsxs)("div",{className:"admin-settings-modal ".concat(r?"show":""),children:[(0,L.jsxs)("div",{className:"admin-settings-content",children:[(0,L.jsxs)("h2",{children:["\uad00\ub9ac\uc790 \uc124\uc815"," ",n&&(0,L.jsx)("span",{className:"super-admin-badge",children:"(\ucd5c\uace0 \uad00\ub9ac\uc790)"})]}),!n&&o&&(0,L.jsxs)("p",{className:"admin-class-info",children:["\uad00\ub9ac \ud559\uae09: ",o]}),(0,L.jsxs)("div",{className:"admin-menu-tabs",style:{display:"flex",flexWrap:"wrap",gap:"10px",padding:"16px",background:"linear-gradient(135deg, #16213e 0%, #1a1a2e 100%)",borderRadius:"16px",border:"1px solid #374151"},children:[(0,L.jsx)("button",{className:"generalSettings"===c?"active":"",onClick:()=>p("generalSettings"),style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\uc77c\ubc18 \uc124\uc815"}),(0,L.jsx)("button",{className:"taskManagement"===c?"active":"",onClick:()=>p("taskManagement"),style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\ud560\uc77c \uad00\ub9ac"}),(0,L.jsx)("button",{className:"jobSettings"===c?"active":"",onClick:()=>p("jobSettings"),style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\uc9c1\uc5c5 \uad00\ub9ac"}),(0,L.jsx)("button",{className:"studentManagement"===c?"active":"",onClick:()=>{p("studentManagement"),vt()},style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\ud559\uc0dd \uad00\ub9ac"}),(0,L.jsx)("button",{className:"salarySettings"===c?"active":"",onClick:()=>p("salarySettings"),style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\uae09\uc5ec \uc124\uc815"}),(0,L.jsx)("button",{className:"financialProducts"===c?"active":"",onClick:()=>p("financialProducts"),style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\uae08\uc735 \uc0c1\ud488"}),(0,L.jsx)("button",{className:"marketControl"===c?"active":"",onClick:()=>p("marketControl"),style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\uc2dc\uc7a5 \uc81c\uc5b4"}),(0,L.jsx)("button",{className:"parkingAccount"===c?"active":"",onClick:()=>p("parkingAccount"),style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\ud30c\ud0b9 \ud1b5\uc7a5"}),(0,L.jsx)("button",{className:"memberManagement"===c?"active":"",onClick:()=>{p("memberManagement"),wt()},style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\ud559\uae09 \uad6c\uc131\uc6d0"}),(0,L.jsx)("button",{className:"databaseManagement"===c?"active":"",onClick:()=>p("databaseManagement"),style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\ub370\uc774\ud130\ubca0\uc774\uc2a4"}),n&&(0,L.jsx)("button",{className:"systemManagement"===c?"active":"",onClick:()=>p("systemManagement"),style:{padding:"10px 16px",borderRadius:"16px",fontSize:"13px",whiteSpace:"nowrap"},children:"\uc2dc\uc2a4\ud15c \uad00\ub9ac"})]}),"generalSettings"===c&&(0,L.jsxs)("div",{className:"general-settings-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsxs)("div",{className:"admin-goal-settings section-card",children:[(0,L.jsx)("h3",{children:"\ubaa9\ud45c \ubc0f \ucfe0\ud3f0 \uac00\uce58 \uc124\uc815"}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\ud074\ub798\uc2a4 \ubaa9\ud45c \ucfe0\ud3f0 \uc218:"}),(0,L.jsx)("input",{type:"number",min:"1",value:u||"",onChange:e=>m&&m(e.target.value),className:"admin-input"})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\ucfe0\ud3f0 \uac00\uce58 (\uc6d0):"}),(0,L.jsx)("input",{type:"number",min:"1",value:x||"",onChange:e=>h&&h(e.target.value),className:"admin-input"})]}),(0,L.jsx)("button",{onClick:g,className:"admin-save-button",children:"\uc800\uc7a5"})]})]}),"taskManagement"===c&&(0,L.jsxs)("div",{className:"task-management-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsxs)("div",{className:"admin-tasks-settings section-card",children:[(0,L.jsx)("h3",{children:"\ud560\uc77c \uad00\ub9ac"}),(0,L.jsx)("p",{className:"admin-section-desc",children:"\uc9c1\uc5c5\ubcc4 \ud560\uc77c\uacfc \uacf5\ud1b5 \ud560\uc77c\uc744 \uad00\ub9ac\ud569\ub2c8\ub2e4."}),S?(0,L.jsxs)("div",{className:"add-task-form",children:[(0,L.jsx)("h4",{children:z?"\ud560\uc77c \uc218\uc815":"\uc0c8 \ud560\uc77c \ucd94\uac00"}),(0,L.jsx)("p",{children:F&&f&&P?"\uc9c1\uc5c5: ".concat((null===(t=f.find(e=>e.id===P))||void 0===t?void 0:t.title)||"\uc54c \uc218 \uc5c6\ub294 \uc9c1\uc5c5"):"\uacf5\ud1b5 \ud560\uc77c"}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\ud560\uc77c \uc774\ub984:"}),(0,L.jsx)("input",{type:"text",value:I,onChange:e=>E(e.target.value),placeholder:"\ud560\uc77c \uc774\ub984 \uc785\ub825",className:"admin-input"})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\ubcf4\uc0c1 (\ucfe0\ud3f0):"}),(0,L.jsx)("input",{type:"number",min:"0",value:T,onChange:e=>M(e.target.value),placeholder:"\ucfe0\ud3f0 \ubcf4\uc0c1",className:"admin-input"})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\ucd5c\ub300 \ud074\ub9ad \uc218:"}),(0,L.jsx)("input",{type:"number",min:"1",value:D,onChange:e=>R(e.target.value),placeholder:"\ucd5c\ub300 \ud074\ub9ad \uc218",className:"admin-input"})]}),(0,L.jsxs)("div",{className:"task-form-buttons",children:[(0,L.jsx)("button",{onClick:()=>{console.log("[AdminSettingsModal] \ud560\uc77c \uc800\uc7a5 \ubc84\ud2bc \ud074\ub9ad"),_&&"function"===typeof _?_():(console.error("[AdminSettingsModal] handleSaveTask \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \uc800\uc7a5 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},className:"admin-save-button",children:z?"\uc218\uc815":"\ucd94\uac00"}),(0,L.jsx)("button",{onClick:()=>{A(!1),O(null)},className:"admin-cancel-button",children:"\ucde8\uc18c"})]})]}):(0,L.jsxs)("div",{className:"task-management",children:[(0,L.jsxs)("div",{className:"task-management-buttons",children:[(0,L.jsx)("button",{onClick:()=>{console.log("[AdminSettingsModal] \uacf5\ud1b5 \ud560\uc77c \ucd94\uac00 \ubc84\ud2bc \ud074\ub9ad"),jt(null,!1)},className:"admin-button",children:"\uacf5\ud1b5 \ud560\uc77c \ucd94\uac00"}),(0,L.jsxs)("select",{onChange:e=>{e.target.value&&(console.log("[AdminSettingsModal] \uc9c1\uc5c5\ubcc4 \ud560\uc77c \ucd94\uac00 \uc120\ud0dd:",e.target.value),jt(e.target.value,!0))},className:"job-select",value:"",children:[(0,L.jsx)("option",{value:"",children:"\uc9c1\uc5c5\ubcc4 \ud560\uc77c \ucd94\uac00..."}),Array.isArray(f)&&f.map(e=>(0,L.jsxs)("option",{value:e.id,children:[e.title,"\uc5d0 \ud560\uc77c \ucd94\uac00"]},e.id))]})]}),(0,L.jsxs)("div",{className:"tasks-by-job",children:[(0,L.jsx)("h4",{children:"\uc9c1\uc5c5\ubcc4 \ud560\uc77c"}),Array.isArray(f)&&f.length>0?f.map(e=>(0,L.jsxs)("div",{className:"job-tasks",children:[(0,L.jsx)("h5",{children:e.title}),Array.isArray(e.tasks)&&e.tasks.length>0?(0,L.jsx)("ul",{className:"admin-tasks",children:e.tasks.map(t=>(0,L.jsxs)("li",{className:"admin-task-item",children:[(0,L.jsxs)("div",{className:"task-info",children:[(0,L.jsx)("span",{className:"task-name",children:t.name}),(0,L.jsxs)("span",{className:"task-reward",children:["\ubcf4\uc0c1: ",t.reward||0," \ucfe0\ud3f0"]}),(0,L.jsxs)("span",{className:"task-clicks",children:["\ud074\ub9ad: ",t.clicks||0,"/",t.maxClicks||5]})]}),(0,L.jsxs)("div",{className:"task-actions",children:[(0,L.jsx)("button",{onClick:()=>{console.log("[AdminSettingsModal] \uc9c1\uc5c5 \ud560\uc77c \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",t,e.id),bt(t,e.id)},className:"edit-button",children:"\uc218\uc815"}),(0,L.jsx)("button",{onClick:()=>{console.log("[AdminSettingsModal] \uc9c1\uc5c5 \ud560\uc77c \uc0ad\uc81c \ubc84\ud2bc \ud074\ub9ad:",t.id,e.id),yt(t.id,e.id)},className:"delete-button",children:"\uc0ad\uc81c"})]})]},t.id))}):(0,L.jsx)("p",{className:"no-items-message",children:"\uc774 \uc9c1\uc5c5\uc5d0 \ub4f1\ub85d\ub41c \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]},e.id)):(0,L.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,L.jsxs)("div",{className:"common-tasks",children:[(0,L.jsx)("h4",{children:"\uacf5\ud1b5 \ud560\uc77c"}),Array.isArray(k)&&k.length>0?(0,L.jsx)("ul",{className:"admin-tasks",children:k.map(e=>(0,L.jsxs)("li",{className:"admin-task-item",children:[(0,L.jsxs)("div",{className:"task-info",children:[(0,L.jsx)("span",{className:"task-name",children:e.name}),(0,L.jsxs)("span",{className:"task-reward",children:["\ubcf4\uc0c1: ",e.reward||0," \ucfe0\ud3f0"]}),(0,L.jsxs)("span",{className:"task-clicks",children:["\ud074\ub9ad: ",e.clicks||0,"/",e.maxClicks||5]})]}),(0,L.jsxs)("div",{className:"task-actions",children:[(0,L.jsx)("button",{onClick:()=>{console.log("[AdminSettingsModal] \uacf5\ud1b5 \ud560\uc77c \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",e),bt(e)},className:"edit-button",children:"\uc218\uc815"}),(0,L.jsx)("button",{onClick:()=>{console.log("[AdminSettingsModal] \uacf5\ud1b5 \ud560\uc77c \uc0ad\uc81c \ubc84\ud2bc \ud074\ub9ad:",e.id),yt(e.id)},className:"delete-button",children:"\uc0ad\uc81c"})]})]},e.id))}):(0,L.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uacf5\ud1b5 \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]})]})]}),"jobSettings"===c&&(0,L.jsxs)("div",{className:"job-settings-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsxs)("div",{className:"admin-jobs-settings section-card",children:[(0,L.jsx)("h3",{children:"\uc9c1\uc5c5 \uad00\ub9ac"}),(0,L.jsxs)("div",{className:"add-job-form",children:[(0,L.jsx)("input",{type:"text",value:b,onChange:e=>y(e.target.value),placeholder:j?"\uc9c1\uc5c5\uba85 \uc218\uc815":"\uc0c8 \uc9c1\uc5c5\uba85 \uc785\ub825",className:"admin-input"}),(0,L.jsx)("button",{onClick:()=>{console.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc800\uc7a5 \ubc84\ud2bc \ud074\ub9ad"),w&&"function"===typeof w?w():(console.error("[AdminSettingsModal] handleSaveJob \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\uc9c1\uc5c5 \uc800\uc7a5 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},className:"admin-save-button",children:j?"\uc218\uc815":"\ucd94\uac00"}),j&&(0,L.jsx)("button",{onClick:()=>{v(null),y("")},className:"admin-cancel-button",children:"\ucde8\uc18c"})]}),(0,L.jsxs)("div",{className:"jobs-list",children:[(0,L.jsx)("h4",{children:"\ub4f1\ub85d\ub41c \uc9c1\uc5c5 \ubaa9\ub85d"}),f&&f.length>0?(0,L.jsx)("ul",{className:"admin-jobs",children:f.map(e=>(0,L.jsxs)("li",{className:"admin-job-item",children:[(0,L.jsx)("span",{className:"job-title",children:e.title}),(0,L.jsxs)("div",{className:"job-actions",children:[(0,L.jsx)("button",{onClick:()=>{console.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",e),gt(e)},className:"edit-button",children:"\uc218\uc815"}),(0,L.jsx)("button",{onClick:()=>{console.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc0ad\uc81c \ubc84\ud2bc \ud074\ub9ad:",e.id),ft(e.id)},className:"delete-button",children:"\uc0ad\uc81c"})]})]},e.id))}):(0,L.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]})]}),"studentManagement"===c&&(0,L.jsxs)("div",{className:"student-management-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsxs)("div",{className:"student-jobs-settings section-card",children:[(0,L.jsx)("h3",{children:"\ud559\uc0dd\uc9c1\uc5c5 \uad00\ub9ac"}),we&&(0,L.jsx)("p",{className:"error-message",children:we}),(0,L.jsx)("p",{className:"admin-section-desc",children:"\ud559\uc0dd\ub4e4\uc5d0\uac8c \uc9c1\uc5c5\uc744 \ubc30\uc815\ud558\uac70\ub098 \uad00\ub9ac\ud569\ub2c8\ub2e4. \uc8fc\uae09\uc740 \uc9c1\uc5c5 \uc218\uc5d0 \ub530\ub77c \ucc28\ub4f1 \uc9c0\uae09\ub429\ub2c8\ub2e4."}),(0,L.jsxs)("div",{className:"salary-management",children:[(0,L.jsxs)("div",{className:"salary-info",children:[(0,L.jsx)("h4",{children:"\uc8fc\uae09 \uc9c0\uae09 \uad00\ub9ac"}),(0,L.jsx)("p",{children:"\uae30\ubcf8 \uc8fc\uae09: 200\ub9cc\uc6d0, \ucd94\uac00 \uc9c1\uc5c5\ub2f9: 50\ub9cc\uc6d0"}),(0,L.jsxs)("p",{children:["\uc138\uc728: ",(100*tt.taxRate).toFixed(1),"%"]}),(0,L.jsxs)("p",{children:["\uc8fc\uae09 \uc778\uc0c1\ub960: ",(100*tt.salaryIncreaseRate).toFixed(1),"% (\ub9e4\uc8fc)"]}),(0,L.jsxs)("p",{children:["\ub9c8\uc9c0\ub9c9 \uc8fc\uae09 \uc9c0\uae09\uc77c: ",Yt()]}),(0,L.jsx)("p",{className:"auto-payment-info",children:"\u23f0 \uc790\ub3d9 \uc8fc\uae09 \uc9c0\uae09: \ub9e4\uc8fc \uae08\uc694\uc77c \uc624\uc804 8\uc2dc (\uc11c\ubc84 \uc790\ub3d9 \uc2e4\ud589)"})]}),(0,L.jsxs)("div",{className:"salary-buttons",children:[(0,L.jsx)("button",{className:"admin-button pay-salary-button",onClick:async()=>{var e,t;const s=(null===(e=dt.data)||void 0===e?void 0:e.students)||re,a=(null===(t=ct.data)||void 0===t?void 0:t.settings)||tt;if(s&&0!==s.length){if(window.confirm("\ubaa8\ub4e0 \ud559\uc0dd\ub4e4\uc5d0\uac8c \uc9c1\uc5c5\ubcc4 \uc8fc\uae09\uc744 \uc9c0\uae09\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n(\uc9c1\uc5c5\uc774 \uc788\ub294 \ud559\uc0dd\ub9cc \ud574\ub2f9, \uc138\uae08 ".concat((100*a.taxRate).toFixed(1),"% \uacf5\uc81c)"))){he(!0);try{const e=await pt.mutateAsync({studentIds:[],payAll:!0});if(e.success){const{summary:t}=e;alert("\uc8fc\uae09 \uc9c0\uae09 \uc644\ub8cc!\n".concat(t.totalStudentsPaid,"\uba85\uc758 \ud559\uc0dd\uc5d0\uac8c \uc9c0\uae09\n\ucd1d \uae09\uc5ec: ").concat((t.totalGrossPaid/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc138\uae08 \uacf5\uc81c: ").concat((t.totalTaxDeducted/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc2e4\uc81c \uc9c0\uae09: ").concat((t.totalNetPaid/1e4).toFixed(0),"\ub9cc\uc6d0"))}else alert(e.message||"\uc8fc\uae09 \uc9c0\uae09\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(we){console.error("[AdminSettingsModal] \uc804\uccb4 \ud559\uc0dd \uc8fc\uae09 \uc9c0\uae09 \uc624\ub958:",we),alert("\uc8fc\uae09 \uc9c0\uae09 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message)}finally{he(!1)}}}else alert("\ud559\uc0dd \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.")},disabled:xe||ce,children:xe?"\uc8fc\uae09 \uc9c0\uae09 \uc911...":"\uc804\uccb4 \ud559\uc0dd \uc8fc\uae09 \uc9c0\uae09"}),(0,L.jsx)("button",{className:"admin-button pay-selected-salary-button",onClick:async()=>{var e;if(0===be.length)return void alert("\uc120\ud0dd\ub41c \ud559\uc0dd\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");const t=(null===(e=ct.data)||void 0===e?void 0:e.settings)||tt;if(window.confirm("\uc120\ud0dd\ub41c ".concat(be.length,"\uba85\uc758 \ud559\uc0dd\uc5d0\uac8c \uc8fc\uae09\uc744 \uc9c0\uae09\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n(\uc138\uae08 ").concat((100*t.taxRate).toFixed(1),"% \uacf5\uc81c \ud6c4 \uc9c0\uae09)"))){he(!0);try{const e=await pt.mutateAsync({studentIds:be,payAll:!1});if(e.success){const{summary:t}=e;alert("\uc8fc\uae09 \uc9c0\uae09 \uc644\ub8cc!\n".concat(t.totalStudentsPaid,"\uba85\uc758 \ud559\uc0dd\uc5d0\uac8c \uc9c0\uae09\n\ucd1d \uae09\uc5ec: ").concat((t.totalGrossPaid/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc138\uae08 \uacf5\uc81c: ").concat((t.totalTaxDeducted/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc2e4\uc81c \uc9c0\uae09: ").concat((t.totalNetPaid/1e4).toFixed(0),"\ub9cc\uc6d0")),ye([]),ve(!1)}else alert(e.message||"\uc8fc\uae09 \uc9c0\uae09\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(we){console.error("[AdminSettingsModal] \uc120\ud0dd\ub41c \ud559\uc0dd \uc8fc\uae09 \uc9c0\uae09 \uc624\ub958:",we),alert("\uc8fc\uae09 \uc9c0\uae09 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message)}finally{he(!1)}}},disabled:xe||ce||0===be.length,children:xe?"\uc8fc\uae09 \uc9c0\uae09 \uc911...":"\uc120\ud0dd \ud559\uc0dd(".concat(be.length,") \uc8fc\uae09 \uc9c0\uae09")})]})]}),(0,L.jsxs)("div",{className:"student-jobs-container",children:[(0,L.jsxs)("div",{className:"student-list-header",children:[(0,L.jsxs)("h4",{children:["\ud559\uc0dd \ubaa9\ub85d"," ",!n&&o&&"(".concat(o," \ud559\uae09)")]}),(0,L.jsx)("button",{onClick:vt,className:"admin-button",disabled:ce,children:ce?"\ub85c\ub529 \uc911...":"\ud559\uc0dd \ubaa9\ub85d \uc0c8\ub85c\uace0\uce68"})]}),ce?(0,L.jsx)("p",{children:"\ud559\uc0dd \uc815\ubcf4 \ub85c\ub529 \uc911..."}):re.length>0?(0,L.jsx)("div",{className:"members-table-container",children:(0,L.jsxs)("table",{className:"members-table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:(0,L.jsx)("input",{type:"checkbox",checked:je,onChange:()=>{ye(je?[]:re.map(e=>e.id).filter(e=>null!=e)),ve(!je)},disabled:0===re.length})}),(0,L.jsx)("th",{children:"\ud559\uc0dd \uc774\ub984"}),(0,L.jsx)("th",{children:"\uc774\uba54\uc77c"}),(0,L.jsx)("th",{children:"\ud559\uae09"}),(0,L.jsx)("th",{children:"\ud604\uc7ac \uc9c1\uc5c5"}),(0,L.jsx)("th",{children:"\uc608\uc0c1 \ucd1d\uae09\uc5ec"}),(0,L.jsx)("th",{children:"\uc138\uae08 \uacf5\uc81c"}),(0,L.jsx)("th",{children:"\uc2e4\uae09\uc5ec"}),(0,L.jsx)("th",{children:"\ubcf4\uc720 \ud604\uae08"}),(0,L.jsx)("th",{children:"\ucd5c\uadfc \uc8fc\uae09\uc77c"}),(0,L.jsx)("th",{children:"\uad00\ub9ac"})]})}),(0,L.jsx)("tbody",{children:re.map(e=>{const t=ht(e.selectedJobIds,!0);return(0,L.jsxs)("tr",{className:be.includes(e.id)?"selected-student-row":"",children:[(0,L.jsx)("td",{children:(0,L.jsx)("input",{type:"checkbox",checked:be.includes(e.id),onChange:()=>{return t=e.id,void ye(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}})}),(0,L.jsx)("td",{children:e.nickname||e.name||"\uc774\ub984 \uc5c6\uc74c"}),(0,L.jsx)("td",{children:e.email||"-"}),(0,L.jsx)("td",{children:e.classCode||"\ubbf8\uc9c0\uc815"}),(0,L.jsx)("td",{children:Array.isArray(e.selectedJobIds)&&e.selectedJobIds.length>0?e.selectedJobIds.map(e=>{const t=Array.isArray(f)?f.find(t=>t.id===e):null;return t?t.title:null}).filter(Boolean).join(", "):(0,L.jsx)("span",{className:"no-jobs",children:"\uc9c1\uc5c5 \uc5c6\uc74c"})}),(0,L.jsx)("td",{className:"salary-column",children:"".concat((t.gross/1e4).toFixed(0),"\ub9cc\uc6d0")}),(0,L.jsx)("td",{className:"tax-column",children:"".concat((t.tax/1e4).toFixed(0),"\ub9cc\uc6d0")}),(0,L.jsx)("td",{className:"net-salary-column",children:"".concat((t.net/1e4).toFixed(0),"\ub9cc\uc6d0")}),(0,L.jsxs)("td",{className:"cash-column",children:[(e.cash||0).toLocaleString(),"\uc6d0"]}),(0,L.jsx)("td",{children:e.lastSalaryDate?e.lastSalaryDate.toLocaleDateString():"\uc5c6\uc74c"}),(0,L.jsx)("td",{children:(0,L.jsx)("button",{className:"edit-button",onClick:()=>(e=>{ie(e),le(Array.isArray(e.selectedJobIds)?[...e.selectedJobIds]:[]),ae(!0)})(e),children:"\uc9c1\uc5c5 \uc124\uc815"})})]},e.id)})})]})}):(0,L.jsx)("p",{className:"no-items-message",children:n||o?"\ud559\uc0dd \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.":"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."})]})]})]}),"financialProducts"===c&&(0,L.jsxs)("div",{className:"financial-products-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsxs)("div",{className:"financial-products-settings section-card",children:[(0,L.jsx)("h3",{children:"\uae08\uc735 \uc0c1\ud488 \uad00\ub9ac"}),(0,L.jsx)("p",{className:"admin-section-desc",children:"\uc608\uae08, \uc801\uae08, \ub300\ucd9c \uc0c1\ud488\uc744 \ucd94\uac00\ud558\uac70\ub098 \uc0ad\uc81c\ud569\ub2c8\ub2e4."}),(0,L.jsxs)("div",{className:"financial-sub-tabs",style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[(0,L.jsx)("button",{className:"sub-tab-button ".concat("deposit"===_e?"active":""),onClick:()=>Le("deposit"),style:{padding:"8px 16px",borderRadius:"8px",border:"deposit"===_e?"2px solid #4f46e5":"1px solid #374151",background:"deposit"===_e?"#4f46e5":"transparent",color:"deposit"===_e?"white":"#9ca3af",cursor:"pointer",fontWeight:"600"},children:"\uc608\uae08 \uc0c1\ud488"}),(0,L.jsx)("button",{className:"sub-tab-button ".concat("saving"===_e?"active":""),onClick:()=>Le("saving"),style:{padding:"8px 16px",borderRadius:"8px",border:"saving"===_e?"2px solid #4f46e5":"1px solid #374151",background:"saving"===_e?"#4f46e5":"transparent",color:"saving"===_e?"white":"#9ca3af",cursor:"pointer",fontWeight:"600"},children:"\uc801\uae08 \uc0c1\ud488"}),(0,L.jsx)("button",{className:"sub-tab-button ".concat("loan"===_e?"active":""),onClick:()=>Le("loan"),style:{padding:"8px 16px",borderRadius:"8px",border:"loan"===_e?"2px solid #4f46e5":"1px solid #374151",background:"loan"===_e?"#4f46e5":"transparent",color:"loan"===_e?"white":"#9ca3af",cursor:"pointer",fontWeight:"600"},children:"\ub300\ucd9c \uc0c1\ud488"})]}),We&&(0,L.jsx)("div",{className:"message-box ".concat(We.type),style:{padding:"12px",marginBottom:"16px",borderRadius:"8px",background:"success"===We.type?"#065f46":"#991b1b",color:"white"},children:We.text}),(0,L.jsxs)("div",{className:"add-product-form",style:{padding:"16px",background:"rgba(55, 65, 81, 0.5)",borderRadius:"12px",marginBottom:"16px"},children:[(0,L.jsxs)("h4",{style:{marginBottom:"12px",color:"white"},children:["deposit"===_e?"\uc608\uae08":"saving"===_e?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488 \ucd94\uac00"]}),(0,L.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{style:{display:"block",marginBottom:"4px",color:"#9ca3af",fontSize:"12px"},children:"\uc0c1\ud488\uba85"}),(0,L.jsx)("input",{type:"text",value:Te,onChange:e=>Me(e.target.value),placeholder:"\uc0c1\ud488\uba85 \uc785\ub825",className:"admin-input",style:{width:"100%"}})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{style:{display:"block",marginBottom:"4px",color:"#9ca3af",fontSize:"12px"},children:"\uae30\uac04 (\uc77c)"}),(0,L.jsx)("input",{type:"number",value:De,onChange:e=>Re(e.target.value),placeholder:"\uae30\uac04 (\uc77c)",min:"1",className:"admin-input",style:{width:"100%"}})]}),(0,L.jsxs)("div",{children:[(0,L.jsx)("label",{style:{display:"block",marginBottom:"4px",color:"#9ca3af",fontSize:"12px"},children:"\uc774\uc728 (%)"}),(0,L.jsx)("input",{type:"number",value:ze,onChange:e=>Oe(e.target.value),placeholder:"\uc774\uc728 (%)",min:"0",step:"0.1",className:"admin-input",style:{width:"100%"}})]})]}),(0,L.jsx)("button",{onClick:qt,className:"admin-save-button",style:{width:"100%"},children:"\uc0c1\ud488 \ucd94\uac00\ud558\uae30"})]}),(0,L.jsxs)("div",{className:"product-list",children:[(0,L.jsxs)("h4",{style:{marginBottom:"12px",color:"white"},children:["deposit"===_e?"\uc608\uae08":"saving"===_e?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488 \ubaa9\ub85d"]}),(()=>{const e="deposit"===_e?Ce:"saving"===_e?Se:Ie;return 0===e.length?(0,L.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,L.jsx)("div",{className:"members-table-container",children:(0,L.jsxs)("table",{className:"members-table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"\uc0c1\ud488\uba85"}),(0,L.jsx)("th",{children:"\uae30\uac04 (\uc77c)"}),(0,L.jsx)("th",{children:"\uc774\uc728 (%)"}),(0,L.jsx)("th",{children:"\uad00\ub9ac"})]})}),(0,L.jsx)("tbody",{children:e.map(e=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:e.name}),(0,L.jsxs)("td",{children:[e.period,"\uc77c"]}),(0,L.jsxs)("td",{children:[e.rate,"%"]}),(0,L.jsx)("td",{children:(0,L.jsx)("button",{onClick:()=>Ut(e.id,_e),className:"delete-button",children:"\uc0ad\uc81c"})})]},e.id))})]})})})()]})]})]}),"marketControl"===c&&(0,L.jsxs)("div",{className:"market-control-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsxs)("div",{className:"market-control-settings section-card",children:[(0,L.jsx)("h3",{children:"\uc8fc\uc2dd \uc2dc\uc7a5 \uc81c\uc5b4"}),(0,L.jsx)("p",{className:"admin-section-desc",children:"\uc8fc\uc2dd \uc2dc\uc7a5\uc758 \uac1c\uc7a5/\ud3d0\uc7a5 \uc0c1\ud0dc\ub97c \uc218\ub3d9\uc73c\ub85c \uc81c\uc5b4\ud569\ub2c8\ub2e4."}),(0,L.jsxs)("div",{style:{padding:"16px",background:"rgba(55, 65, 81, 0.5)",borderRadius:"12px",marginBottom:"16px"},children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,L.jsxs)("p",{style:{color:"white"},children:["\ud604\uc7ac \uc0c1\ud0dc:"," ",(0,L.jsx)("span",{style:{fontWeight:"bold",color:Pe.isOpen?"#22c55e":"#ef4444",padding:"4px 12px",borderRadius:"16px",background:Pe.isOpen?"rgba(34, 197, 94, 0.2)":"rgba(239, 68, 68, 0.2)"},children:Pe.isOpen?"\ud83d\udfe2 \uac1c\uc7a5":"\ud83d\udd34 \ud3d0\uc7a5"})]}),(0,L.jsx)("button",{onClick:()=>Qt(!0),className:"admin-button",disabled:!o,children:"\uc0c8\ub85c\uace0\uce68"})]}),(0,L.jsxs)("div",{style:{display:"flex",gap:"12px",marginBottom:"16px"},children:[(0,L.jsx)("button",{onClick:()=>Ht(!0),disabled:Pe.isOpen,className:"admin-save-button",style:{flex:1,background:Pe.isOpen?"#374151":"#22c55e",cursor:Pe.isOpen?"not-allowed":"pointer"},children:"\uc218\ub3d9 \uac1c\uc7a5"}),(0,L.jsx)("button",{onClick:()=>Ht(!1),disabled:!Pe.isOpen,className:"admin-cancel-button",style:{flex:1,background:Pe.isOpen?"#ef4444":"#374151",cursor:Pe.isOpen?"pointer":"not-allowed"},children:"\uc218\ub3d9 \ud3d0\uc7a5"})]}),(0,L.jsxs)("p",{style:{fontSize:"12px",color:"#9ca3af"},children:["\ubc84\ud2bc\uc744 \ub204\ub974\uba74 \uc815\ud574\uc9c4 \uc2dc\uac04\uacfc \uc0c1\uad00\uc5c6\uc774 \uc2dc\uc7a5 \uc0c1\ud0dc\uac00 \uc989\uc2dc \ubcc0\uacbd\ub429\ub2c8\ub2e4.",(0,L.jsx)("br",{}),"\uc790\ub3d9 \uac1c\uc7a5/\ud3d0\uc7a5 \uc2dc\uac04(\uc6d4-\uae08, \uc624\uc804 8\uc2dc/\uc624\ud6c4 3\uc2dc)\uc774 \ub418\uba74 \uc790\ub3d9\uc73c\ub85c \uc0c1\ud0dc\uac00 \ubcc0\uacbd\ub429\ub2c8\ub2e4."]})]}),qe&&(0,L.jsx)("div",{style:{padding:"12px",marginBottom:"16px",borderRadius:"8px",background:"#d97706",color:"white",textAlign:"center"},children:qe}),(0,L.jsxs)("div",{style:{padding:"16px",background:"rgba(239, 68, 68, 0.1)",borderRadius:"12px",border:"1px solid rgba(239, 68, 68, 0.3)"},children:[(0,L.jsx)("h4",{style:{marginBottom:"12px",color:"#ef4444"},children:"\u26a0\ufe0f \uc8fc\uc2dd \uc815\ubcf4 \ucd08\uae30\ud654"}),(0,L.jsx)("p",{style:{fontSize:"12px",color:"#9ca3af",marginBottom:"12px"},children:"\uc8fc\uc758: \uc774 \ubc84\ud2bc\uc744 \ub204\ub974\uba74 \ubaa8\ub4e0 \uc8fc\uc2dd\uc758 \uac00\uaca9\uacfc \uac70\ub798 \ub0b4\uc5ed\uc774 \uae30\ubcf8\uac12\uc73c\ub85c \ucd08\uae30\ud654\ub429\ub2c8\ub2e4. \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,L.jsx)("button",{onClick:Gt,style:{width:"100%",padding:"12px",borderRadius:"8px",background:"#ea580c",color:"white",border:"none",cursor:"pointer",fontWeight:"600"},children:"\ubaa8\ub4e0 \uc8fc\uc2dd \uc815\ubcf4 \ucd08\uae30\ud654"})]})]})]}),"parkingAccount"===c&&(0,L.jsxs)("div",{className:"parking-account-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsxs)("div",{className:"parking-account-settings section-card",children:[(0,L.jsx)("h3",{children:"\ud30c\ud0b9 \ud1b5\uc7a5 \uc774\uc790\uc728 \uad00\ub9ac"}),(0,L.jsx)("p",{className:"admin-section-desc",children:"\ud30c\ud0b9 \ud1b5\uc7a5\uc758 \uc77c\uc77c \uc774\uc790\uc728\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."}),Ye&&(0,L.jsx)("div",{style:{padding:"12px",marginBottom:"16px",borderRadius:"8px",background:"success"===Ye.type?"#065f46":"#991b1b",color:"white"},children:Ye.text}),(0,L.jsxs)("div",{style:{padding:"16px",background:"rgba(55, 65, 81, 0.5)",borderRadius:"12px",marginBottom:"16px"},children:[(0,L.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,L.jsx)("p",{style:{color:"#9ca3af",fontSize:"14px"},children:"\ud604\uc7ac \uc77c\uc77c \uc774\uc790\uc728"}),(0,L.jsxs)("p",{style:{color:"#22c55e",fontSize:"32px",fontWeight:"bold"},children:[Je,"%"]})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{style:{display:"block",marginBottom:"8px",color:"#9ca3af"},children:"\uc0c8 \uc77c\uc77c \uc774\uc790\uc728 (%)"}),(0,L.jsx)("input",{type:"number",value:Ke,onChange:e=>Xe(e.target.value),placeholder:"\uc0c8 \uc774\uc790\uc728 \uc785\ub825 (%)",min:"0",step:"0.01",className:"admin-input",style:{marginBottom:"12px"}}),(0,L.jsx)("button",{onClick:Vt,className:"admin-save-button",disabled:!Ke||isNaN(Ke)||parseFloat(Ke)<0,style:{width:"100%"},children:"\uc774\uc790\uc728 \ubcc0\uacbd"})]}),(0,L.jsx)("p",{style:{fontSize:"12px",color:"#9ca3af",marginTop:"12px"},children:"\ud30c\ud0b9 \ud1b5\uc7a5\uc5d0 \uc608\uce58\ub41c \uae08\uc561\uc740 \ub9e4\uc77c \uc124\uc815\ub41c \uc774\uc790\uc728\ub9cc\ud07c \uc774\uc790\uac00 \ubc1c\uc0dd\ud569\ub2c8\ub2e4."})]})]})]}),"memberManagement"===c&&(0,L.jsxs)("div",{className:"member-management-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsxs)("div",{className:"admin-class-members-container section-card",children:[(0,L.jsx)("h3",{children:"\ud559\uae09 \uad6c\uc131\uc6d0 \uad00\ub9ac"}),we&&(0,L.jsx)("p",{className:"error-message",children:we}),(0,L.jsxs)("p",{className:"admin-section-desc",children:["\ud559\uae09 \uad6c\uc131\uc6d0\uc758 \uc815\ubcf4\ub97c \ud655\uc778\ud558\uace0 \uad00\ub9ac\ud569\ub2c8\ub2e4.",n&&" \ucd5c\uace0 \uad00\ub9ac\uc790\ub294 \ubaa8\ub4e0 \ud559\uae09\uc758 \uad6c\uc131\uc6d0\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),$?(0,L.jsx)("p",{children:"\uad6c\uc131\uc6d0 \uc815\ubcf4 \ub85c\ub529 \uc911..."}):Y.length>0?(0,L.jsx)("div",{className:"user-cards-container",children:Y.map(e=>(0,L.jsxs)("div",{className:"user-card",children:[(0,L.jsxs)("div",{className:"user-card-header",children:[(0,L.jsx)("span",{className:"user-card-name",children:e.name}),(0,L.jsx)("span",{className:"user-card-role role-".concat(e.isSuperAdmin?"super":e.isAdmin?"admin":"student"),children:e.isSuperAdmin?"\ucd5c\uace0 \uad00\ub9ac\uc790":e.isAdmin?"\uad00\ub9ac\uc790":"\ud559\uc0dd"})]}),(0,L.jsxs)("div",{className:"user-card-body",children:[(0,L.jsxs)("p",{children:[(0,L.jsx)("strong",{children:"\uc774\uba54\uc77c:"})," ",e.email]}),(0,L.jsxs)("p",{children:[(0,L.jsx)("strong",{children:"\ud559\uae09 \ucf54\ub4dc:"})," ",e.classCode]})]}),n&&(0,L.jsxs)("div",{className:"user-card-actions",children:[!e.isSuperAdmin&&(0,L.jsx)("button",{onClick:()=>Pt(e.id,e.isAdmin),className:"admin-action-button ".concat(e.isAdmin?"remove-admin-button":"add-admin-button"),disabled:$,children:e.isAdmin?"\uad00\ub9ac\uc790 \ud574\uc81c":"\uad00\ub9ac\uc790 \uc9c0\uc815"}),(0,L.jsx)("button",{onClick:()=>Bt(e.id),className:"admin-action-button reset-password-button",disabled:$,children:"\ube44\ubc00\ubc88\ud638 \ucd08\uae30\ud654"})]})]},e.id))}):(0,L.jsx)("p",{className:"no-members-message",children:n||o?"\ub4f1\ub85d\ub41c \ud559\uae09 \uad6c\uc131\uc6d0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.":"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."}),(0,L.jsx)("div",{className:"refresh-members-section",children:(0,L.jsx)("button",{onClick:wt,className:"admin-button",disabled:$,children:$?"\ub85c\ub529 \uc911...":"\uad6c\uc131\uc6d0 \ubaa9\ub85d \uc0c8\ub85c\uace0\uce68"})})]})]}),"salarySettings"===c&&(0,L.jsxs)("div",{className:"salary-settings-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsxs)("div",{className:"salary-settings section-card",children:[(0,L.jsx)("h3",{children:"\uae09\uc5ec \uc124\uc815"}),(0,L.jsx)("p",{className:"admin-section-desc",children:"\uc138\uc728\uacfc \uc8fc\uae09 \uc778\uc0c1\ub960\uc744 \uc124\uc815\ud569\ub2c8\ub2e4. \uc790\ub3d9 \uc8fc\uae09 \uc9c0\uae09\uc740 \ub9e4\uc8fc \uae08\uc694\uc77c \uc624\uc804 8\uc2dc\uc5d0 \uc2e4\ud589\ub429\ub2c8\ub2e4."}),(0,L.jsxs)("div",{className:"salary-settings-form",children:[(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\uc138\uc728 (%):"}),(0,L.jsx)("input",{type:"number",min:"0",max:"100",step:"0.1",value:at,onChange:e=>nt(e.target.value),className:"admin-input",placeholder:"\uc608: 10 (10%)"}),(0,L.jsx)("small",{className:"form-help",children:"\ud559\uc0dd\ub4e4\uc758 \uc8fc\uae09\uc5d0\uc11c \uacf5\uc81c\ub420 \uc138\uc728\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\uc8fc\uae09 \uc778\uc0c1\ub960 (%):"}),(0,L.jsx)("input",{type:"number",min:"0",max:"100",step:"0.1",value:it,onChange:e=>ot(e.target.value),className:"admin-input",placeholder:"\uc608: 3 (3%)"}),(0,L.jsx)("small",{className:"form-help",children:"\ub9e4\uc8fc \uc790\ub3d9\uc73c\ub85c \uc801\uc6a9\ub420 \uc8fc\uae09 \uc778\uc0c1\ub960\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."})]}),(0,L.jsx)("button",{onClick:xt,className:"admin-save-button",disabled:lt,children:lt?"\uc800\uc7a5 \uc911...":"\uae09\uc5ec \uc124\uc815 \uc800\uc7a5"})]}),(0,L.jsxs)("div",{className:"current-salary-settings",children:[(0,L.jsx)("h4",{children:"\ud604\uc7ac \uae09\uc5ec \uc124\uc815"}),(0,L.jsxs)("div",{className:"settings-display",children:[(0,L.jsxs)("p",{children:["\ud604\uc7ac \uc138\uc728: ",(0,L.jsxs)("strong",{children:[(100*tt.taxRate).toFixed(1),"%"]})]}),(0,L.jsxs)("p",{children:["\ud604\uc7ac \uc8fc\uae09 \uc778\uc0c1\ub960: ",(0,L.jsxs)("strong",{children:[(100*tt.salaryIncreaseRate).toFixed(1),"%"]})]}),(0,L.jsxs)("p",{children:["\ub9c8\uc9c0\ub9c9 \uc790\ub3d9 \uc9c0\uae09\uc77c: ",(0,L.jsx)("strong",{children:Yt()})]})]}),(0,L.jsxs)("div",{className:"salary-calculation-example",children:[(0,L.jsx)("h5",{children:"\uc8fc\uae09 \uacc4\uc0b0 \uc608\uc2dc"}),(0,L.jsxs)("p",{children:["\u2022 \uc9c1\uc5c5 1\uac1c: \ucd1d 200\ub9cc\uc6d0 \u2192 \uc138\uae08 ",(2e6*tt.taxRate/1e4).toFixed(0),"\ub9cc\uc6d0 \uacf5\uc81c \u2192 \uc2e4\uae09\uc5ec ",(2e6*(1-tt.taxRate)/1e4).toFixed(0),"\ub9cc\uc6d0"]}),(0,L.jsxs)("p",{children:["\u2022 \uc9c1\uc5c5 2\uac1c: \ucd1d 250\ub9cc\uc6d0 \u2192 \uc138\uae08 ",(25e5*tt.taxRate/1e4).toFixed(0),"\ub9cc\uc6d0 \uacf5\uc81c \u2192 \uc2e4\uae09\uc5ec ",(25e5*(1-tt.taxRate)/1e4).toFixed(0),"\ub9cc\uc6d0"]}),(0,L.jsxs)("p",{children:["\u2022 \uc9c1\uc5c5 3\uac1c: \ucd1d 300\ub9cc\uc6d0 \u2192 \uc138\uae08 ",(3e6*tt.taxRate/1e4).toFixed(0),"\ub9cc\uc6d0 \uacf5\uc81c \u2192 \uc2e4\uae09\uc5ec ",(3e6*(1-tt.taxRate)/1e4).toFixed(0),"\ub9cc\uc6d0"]})]}),(0,L.jsxs)("div",{className:"auto-payment-info",children:[(0,L.jsx)("h5",{children:"\uc790\ub3d9 \uc8fc\uae09 \uc9c0\uae09 \uc2dc\uc2a4\ud15c"}),(0,L.jsx)("p",{children:"\ud83e\udd16 \ub9e4\uc8fc \uae08\uc694\uc77c \uc624\uc804 8\uc2dc\uc5d0 \uc11c\ubc84\uc5d0\uc11c \uc790\ub3d9\uc73c\ub85c \uc8fc\uae09\uc774 \uc9c0\uae09\ub429\ub2c8\ub2e4."}),(0,L.jsx)("p",{children:"\ud83d\udcc8 \ub9e4\uc8fc \uc8fc\uae09 \uc778\uc0c1\ub960\ub9cc\ud07c \uae09\uc5ec\uac00 \uc790\ub3d9\uc73c\ub85c \uc778\uc0c1\ub429\ub2c8\ub2e4."}),(0,L.jsx)("p",{children:"\ud83d\udcb0 \uc138\uae08\uc774 \uc790\ub3d9\uc73c\ub85c \uacf5\uc81c\ub418\uc5b4 \uc2e4\uae09\uc5ec\uac00 \uc9c0\uae09\ub429\ub2c8\ub2e4."}),(0,L.jsx)("p",{children:"\u2699\ufe0f \uad00\ub9ac\uc790\uac00 \ub85c\uadf8\uc778\ud558\uc9c0 \uc54a\uc544\ub3c4 \uc790\ub3d9\uc73c\ub85c \uc2e4\ud589\ub429\ub2c8\ub2e4."})]})]})]})]}),"databaseManagement"===c&&(0,L.jsxs)("div",{className:"database-management-tab",children:[!n&&o&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,L.jsx)("strong",{children:o})]})}),(0,L.jsx)("div",{className:"database-management-container section-card",style:{minHeight:"500px",maxHeight:"70vh",overflow:"auto"},children:(0,L.jsx)(Lt.default,{})})]}),"systemManagement"===c&&(0,L.jsxs)("div",{className:"system-management-tab",children:[n&&(0,L.jsx)("div",{className:"class-info-header",children:(0,L.jsx)("p",{className:"current-class-info",children:"\ud83c\udf10 \uc2dc\uc2a4\ud15c \uc804\uccb4 \uad00\ub9ac (\ucd5c\uace0 \uad00\ub9ac\uc790)"})}),n&&(0,L.jsxs)("div",{className:"admin-class-codes-container section-card",children:[(0,L.jsx)("h3",{children:"\ud559\uae09 \ucf54\ub4dc \uad00\ub9ac"}),we&&(0,L.jsx)("p",{className:"error-message",children:we}),(0,L.jsxs)("div",{className:"add-class-code-form",children:[(0,L.jsx)("input",{type:"text",value:J,onChange:e=>V(e.target.value),placeholder:"\uc0c8 \ud559\uae09 \ucf54\ub4dc \uc785\ub825",disabled:K,className:"admin-input"}),(0,L.jsx)("button",{onClick:Kt,disabled:K||!J.trim(),className:"admin-button",children:K?"\ucd94\uac00 \uc911...":"\ucf54\ub4dc \ucd94\uac00"})]}),(0,L.jsxs)("div",{className:"class-codes-list",children:[(0,L.jsxs)("h4",{children:["\ub4f1\ub85d\ub41c \ud559\uae09 \ucf54\ub4dc \ubaa9\ub85d (",Array.isArray(U)?U.length:0,"\uac1c)"]}),Array.isArray(U)&&U.length>0?(0,L.jsx)("ul",{className:"codes-list",children:U.map(e=>(0,L.jsxs)("li",{className:"code-item",children:[(0,L.jsx)("span",{className:"code-text",children:e}),(0,L.jsx)("button",{onClick:()=>Xt(e),className:"remove-code-button",disabled:K,children:"\uc0ad\uc81c"})]},e))}):(0,L.jsx)("p",{className:"no-codes-message",children:"\ub4f1\ub85d\ub41c \ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]}),(0,L.jsx)(_t,{isSuperAdmin:n})]}),(0,L.jsx)("div",{className:"admin-settings-footer",children:(0,L.jsx)("button",{onClick:()=>d(!1),className:"admin-close-button",children:"\ub2eb\uae30"})})]}),se&&ne&&(0,L.jsx)("div",{className:"modal-overlay show",children:(0,L.jsxs)("div",{className:"edit-student-jobs-modal",children:[(0,L.jsxs)("div",{className:"modal-header",children:[(0,L.jsxs)("h3",{children:["\ud559\uc0dd \uc9c1\uc5c5 \uc124\uc815:"," ",ne.nickname||ne.name]}),(0,L.jsx)("button",{className:"close-modal-btn",onClick:()=>ae(!1),children:"\u2715"})]}),(0,L.jsxs)("div",{className:"modal-body",children:[(0,L.jsxs)("p",{children:[(0,L.jsx)("strong",{children:ne.nickname||ne.name}),"\ub2d8\uc758 \uc9c1\uc5c5\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."]}),(0,L.jsxs)("div",{className:"salary-info",children:[(0,L.jsxs)("p",{children:["\ud604\uc7ac \ubcf4\uc720 \ud604\uae08: ",(ne.cash||0).toLocaleString(),"\uc6d0"]}),(()=>{const e=ht(oe,!0);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("p",{children:["\uc608\uc0c1 \ucd1d\uae09\uc5ec: ","".concat((e.gross/1e4).toFixed(0),"\ub9cc\uc6d0")]}),(0,L.jsxs)("p",{children:["\uc138\uae08 \uacf5\uc81c: ","".concat((e.tax/1e4).toFixed(0),"\ub9cc\uc6d0")," (",(100*tt.taxRate).toFixed(1),"%)"]}),(0,L.jsxs)("p",{children:["\uc2e4\uae09\uc5ec: ","".concat((e.net/1e4).toFixed(0),"\ub9cc\uc6d0")]})]})})(),(0,L.jsxs)("p",{className:"salary-explanation",children:["(\uae30\ubcf8 200\ub9cc\uc6d0 + \ucd94\uac00 \uc9c1\uc5c5\ub2f9 50\ub9cc\uc6d0, \uc138\uae08 ",(100*tt.taxRate).toFixed(1),"% \uacf5\uc81c)"]})]}),(0,L.jsx)("div",{className:"job-selection-list",children:Array.isArray(f)&&f.filter(e=>!1!==e.active).length>0?f.filter(e=>!1!==e.active).map(e=>(0,L.jsxs)("div",{className:"job-selection-item",children:[(0,L.jsx)("input",{type:"checkbox",id:"job-modal-".concat(e.id),checked:oe.includes(e.id),onChange:()=>{return t=e.id,void le(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}}),(0,L.jsx)("label",{htmlFor:"job-modal-".concat(e.id),children:e.title})]},e.id)):(0,L.jsx)("p",{className:"no-items-message",children:"\uc124\uc815 \uac00\ub2a5\ud55c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})})]}),(0,L.jsxs)("div",{className:"modal-footer",children:[(0,L.jsx)("button",{className:"admin-cancel-button",onClick:()=>ae(!1),children:"\ucde8\uc18c"}),(0,L.jsx)("button",{className:"admin-save-button",onClick:async()=>{if(ne&&G.db){me(!0);try{const e=(0,G.EW)(G.db,"users",ne.id);await(0,G.tI)(e,{selectedJobIds:oe,updatedAt:(0,G.O5)()}),de(e=>e.map(e=>e.id===ne.id?(0,l.A)((0,l.A)({},e),{},{selectedJobIds:oe}):e)),alert("\ud559\uc0dd \uc9c1\uc5c5\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),ae(!1)}catch(we){console.error("\ud559\uc0dd \uc9c1\uc5c5 \uc5c5\ub370\uc774\ud2b8 \uc624\ub958:",we),alert("\ud559\uc0dd \uc9c1\uc5c5 \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+we.message)}finally{me(!1)}}else alert("\ud559\uc0dd \uc815\ubcf4 \ub610\ub294 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958")},disabled:ue,children:ue?"\uc800\uc7a5 \uc911...":"\uc800\uc7a5"})]})]})})]}):(0,L.jsx)("div",{className:"admin-settings-modal show",children:(0,L.jsxs)("div",{className:"admin-settings-content",children:[(0,L.jsx)("h2",{children:"\uad00\ub9ac\uc790 \uc124\uc815"}),(0,L.jsx)("p",{children:"\uad00\ub9ac\uc790\ub9cc \uc811\uadfc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),(0,L.jsx)("button",{onClick:()=>d(!1),className:"admin-cancel-button",children:"\ub2eb\uae30"})]})}):null};s(813);var Pt=s(6555),Ft=s(4891),qt=s(4805);const Ut=[{day:1,reward:1e4,icon:"\ud83c\udf81",label:"1\uc77c\ucc28"},{day:2,reward:15e3,icon:"\ud83c\udf81",label:"2\uc77c\ucc28"},{day:3,reward:2e4,icon:"\ud83c\udf81",label:"3\uc77c\ucc28"},{day:4,reward:3e4,icon:"\ud83c\udf81",label:"4\uc77c\ucc28"},{day:5,reward:4e4,icon:"\ud83c\udf81",label:"5\uc77c\ucc28"},{day:6,reward:5e4,icon:"\ud83c\udf81",label:"6\uc77c\ucc28"},{day:7,reward:6e4,icon:"\ud83c\udf89",label:"7\uc77c\ucc28"},{day:8,reward:7e4,icon:"\ud83c\udf89",label:"8\uc77c\ucc28"},{day:9,reward:85e3,icon:"\ud83c\udf89",label:"9\uc77c\ucc28"},{day:10,reward:1e5,icon:"\ud83c\udfc6",label:"10\uc77c\ucc28!"}],Qt=1e5;function Ht(e){const t="dailyStreak_".concat(e),s=(new Date).toDateString();try{const e=localStorage.getItem(t);if(e){const t=JSON.parse(e),a=new Date(t.lastLogin).toDateString(),n=new Date(Date.now()-864e5).toDateString();return a===s?(0,l.A)((0,l.A)({},t),{},{isNewDay:!1,canClaim:!1}):a===n?{streak:t.streak,lastLogin:t.lastLogin,totalClaimed:t.totalClaimed||0,isNewDay:!0,canClaim:!0}:{streak:0,lastLogin:null,totalClaimed:t.totalClaimed||0,isNewDay:!0,canClaim:!0,streakBroken:!0}}return{streak:0,lastLogin:null,totalClaimed:0,isNewDay:!0,canClaim:!0}}catch(a){return{streak:0,lastLogin:null,totalClaimed:0,isNewDay:!0,canClaim:!0}}}function Gt(e){var t;return e<=10?(null===(t=Ut[e-1])||void 0===t?void 0:t.reward)||1e4:Qt}function Jt(e){var t;let{userId:s,onClaim:n}=e;const[i,o]=(0,a.useState)(null),[l,r]=(0,a.useState)(!1),[d,c]=(0,a.useState)(null),[p,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(s){const e=Ht(s);o(e),u(e.canClaim)}},[s]);if(!p||!i)return null;const m=i.streak+1,x=Gt(m),h=m>=10;return(0,L.jsx)("div",{style:{background:l?"linear-gradient(135deg, #10b981 0%, #059669 100%)":h?"linear-gradient(135deg, #f59e0b 0%, #ea580c 100%)":"linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%)",borderRadius:"16px",padding:"20px",marginBottom:"20px",boxShadow:l?"0 4px 20px rgba(16, 185, 129, 0.4)":h?"0 4px 20px rgba(245, 158, 11, 0.4)":"0 4px 20px rgba(139, 92, 246, 0.4)",animation:"slideDown 0.3s ease-out",border:"2px solid rgba(255,255,255,0.2)"},children:l?(0,L.jsxs)("div",{style:{textAlign:"center",padding:"10px 0"},children:[(0,L.jsx)("div",{style:{fontSize:"48px",marginBottom:"12px",animation:"bounce 0.5s ease"},children:(null===d||void 0===d?void 0:d.icon)||"\ud83c\udf89"}),(0,L.jsxs)("div",{style:{color:"#fff",fontSize:"28px",fontWeight:"800",marginBottom:"8px"},children:["+",null===d||void 0===d||null===(t=d.reward)||void 0===t?void 0:t.toLocaleString(),"\uc6d0"]}),(0,L.jsxs)("div",{style:{color:"rgba(255,255,255,0.9)",fontSize:"16px",fontWeight:"600"},children:["\ud83d\udd25 ",null===d||void 0===d?void 0:d.newStreak,"\uc77c \uc5f0\uc18d \ucd9c\uc11d!"]}),(null===d||void 0===d?void 0:d.isMilestone)&&(0,L.jsx)("div",{style:{marginTop:"10px",padding:"8px 16px",background:"rgba(255,255,255,0.2)",borderRadius:"20px",display:"inline-block",fontSize:"14px",color:"#fff"},children:"\ud83c\udfc6 \ucd95\ud558\ud569\ub2c8\ub2e4! \ub9c8\uc77c\uc2a4\ud1a4 \ub2ec\uc131!"})]}):(0,L.jsxs)(L.Fragment,{children:[i.streakBroken&&(0,L.jsx)("div",{style:{background:"rgba(0,0,0,0.2)",padding:"8px 12px",borderRadius:"8px",marginBottom:"12px",fontSize:"13px",color:"rgba(255,255,255,0.9)"},children:"\ud83d\ude22 \uc5f0\uc18d \ucd9c\uc11d\uc774 \ub04a\uc5b4\uc84c\uc5b4\uc694. \ub2e4\uc2dc 1\uc77c\ucc28\ubd80\ud130 \uc2dc\uc791!"}),(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"6px"},children:[(0,L.jsx)("span",{style:{fontSize:"32px"},children:h?"\ud83c\udfc6":"\ud83c\udf81"}),(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{style:{color:"#fff",fontSize:"18px",fontWeight:"700"},children:[m,"\uc77c\ucc28 \ucd9c\uc11d \ubcf4\uc0c1"]}),m>=10&&(0,L.jsxs)("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.8)",marginTop:"2px"},children:["\ud83d\udd25 ",m,"\uc77c \uc5f0\uc18d \ucd9c\uc11d \uc911!"]})]})]}),(0,L.jsxs)("div",{style:{color:"rgba(255,255,255,0.95)",fontSize:"24px",fontWeight:"800",marginTop:"4px"},children:["+",x.toLocaleString(),"\uc6d0"]})]}),(0,L.jsx)("button",{onClick:()=>{const e=function(e){const t="dailyStreak_".concat(e),s=(new Date).toISOString(),a=Ht(e);if(!a.canClaim)return{success:!1,message:"\uc624\ub298 \uc774\ubbf8 \ubcf4\uc0c1\uc744 \ubc1b\uc558\uc2b5\ub2c8\ub2e4."};const n=a.streak+1,i=Gt(n),o=n>=10?"\ud83c\udfc6":n>=7?"\ud83c\udf89":"\ud83c\udf81",l={streak:n,lastLogin:s,totalClaimed:(a.totalClaimed||0)+i};return localStorage.setItem(t,JSON.stringify(l)),{success:!0,reward:i,newStreak:n,icon:o,message:"".concat(n,"\uc77c\ucc28 \ucd9c\uc11d \ubcf4\uc0c1: ").concat(i.toLocaleString(),"\uc6d0!"),isMilestone:10===n||n%30===0}}(s);c(e),r(!0),e.success&&n&&n(e.reward),setTimeout(()=>{u(!1)},5e3)},style:{background:"rgba(255,255,255,0.95)",border:"none",color:h?"#ea580c":"#6366f1",padding:"14px 28px",borderRadius:"14px",fontSize:"16px",fontWeight:"700",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:"\ubc1b\uae30! \ud83c\udf89"})]}),(0,L.jsxs)("div",{style:{marginTop:"16px"},children:[(0,L.jsx)("div",{style:{display:"flex",justifyContent:"space-between",gap:"4px"},children:Ut.map((e,t)=>(0,L.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,L.jsx)("div",{style:{width:"100%",height:"8px",borderRadius:"4px",background:t<i.streak?"rgba(255,255,255,0.9)":t===i.streak?"rgba(255,255,255,0.5)":"rgba(255,255,255,0.2)",marginBottom:"4px"}}),(0===t||4===t||9===t)&&(0,L.jsxs)("span",{style:{fontSize:"9px",color:"rgba(255,255,255,0.7)"},children:[t+1,"\uc77c"]})]},e.day))}),m>10&&(0,L.jsx)("div",{style:{textAlign:"center",marginTop:"8px",fontSize:"12px",color:"rgba(255,255,255,0.8)"},children:"\u2728 10\uc77c \uc774\uc0c1 \uc5f0\uc18d \ucd9c\uc11d \uc2dc \ub9e4\uc77c 10\ub9cc\uc6d0!"})]})]})})}function Vt(e){let{userId:t}=e;const[s,n]=(0,a.useState)({streak:0});(0,a.useEffect)(()=>{if(t){const e=Ht(t);n(e)}},[t]);const i=s.streak||0;return 0===i?null:(0,L.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 12px",background:i>=10?"linear-gradient(135deg, #f59e0b20 0%, #ea580c20 100%)":"linear-gradient(135deg, #8b5cf620 0%, #6366f120 100%)",border:"1px solid ".concat(i>=10?"#f59e0b40":"#8b5cf640"),borderRadius:"14px",fontSize:"13px",color:i>=10?"#f59e0b":"#a78bfa",fontWeight:"600"},children:[(0,L.jsx)("span",{children:"\ud83d\udd25"}),(0,L.jsxs)("span",{children:[i,"\uc77c \uc5f0\uc18d"]}),i>=10&&(0,L.jsx)("span",{children:"\ud83c\udfc6"})]})}function Kt(){return(0,L.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"16px",padding:"16px",border:"2px solid #8b5cf640"},children:[(0,L.jsx)("h4",{style:{color:"#e8e8ff",fontSize:"15px",fontWeight:"700",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:"\ud83c\udf81 \uc77c\uc77c \ucd9c\uc11d \ubcf4\uc0c1 \uc548\ub0b4"}),(0,L.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[Ut.map(e=>(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:10===e.day?"#f59e0b15":"transparent",borderRadius:"8px",border:10===e.day?"1px solid #f59e0b30":"none"},children:[(0,L.jsxs)("span",{style:{color:10===e.day?"#f59e0b":"#9ca3af",fontSize:"13px"},children:[e.icon," ",e.label]}),(0,L.jsxs)("span",{style:{color:10===e.day?"#f59e0b":"#e8e8ff",fontWeight:10===e.day?"700":"500",fontSize:10===e.day?"15px":"13px"},children:[e.reward.toLocaleString(),"\uc6d0"]})]},e.day)),(0,L.jsx)("div",{style:{marginTop:"8px",padding:"10px",background:"#f59e0b15",borderRadius:"10px",border:"1px solid #f59e0b30",textAlign:"center"},children:(0,L.jsx)("span",{style:{color:"#f59e0b",fontSize:"13px",fontWeight:"600"},children:"\ud83c\udfc6 10\uc77c \uc774\ud6c4: \ub9e4\uc77c 100,000\uc6d0!"})})]})]})}(0,Ze.Qg)(G.Cn,"manualResetClassTasks");const Xt={JOBS:216e5,TASKS:216e5,SETTINGS:432e5,GOALS:216e5,CLASS_CODES:864e5},Yt=e=>Ft.Ay.get(e),Zt=(e,t,s)=>Ft.Ay.set(e,t,s||Xt.TASKS),$t=e=>Ft.Ay.invalidate(e),es=()=>Ft.Ay.clearAll();const ts=new class{constructor(){this.pendingWrites=[],this.batchTimeout=null,this.BATCH_DELAY=2e3,this.MAX_BATCH_SIZE=500}addWrite(e){this.pendingWrites.push(e),this.pendingWrites.length>=this.MAX_BATCH_SIZE?this.executeBatch():this.scheduleBatch()}scheduleBatch(){this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.executeBatch()},this.BATCH_DELAY)}async executeBatch(){if(0===this.pendingWrites.length)return;this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null);const e=(0,ee.wP)(G.db),t=[...this.pendingWrites];this.pendingWrites=[];try{t.forEach(t=>{let{type:s,ref:a,data:n}=t;switch(s){case"set":e.set(a,n);break;case"update":e.update(a,n);break;case"delete":e.delete(a)}}),await e.commit(),console.log("\ubc30\uce58 \uc2e4\ud589 \uc644\ub8cc: ".concat(t.length,"\uac1c \uc791\uc5c5"))}catch(s){console.error("\ubc30\uce58 \uc2e4\ud589 \uc2e4\ud328:",s)}}};class ss{constructor(){this.listeners=new Map}addListener(e,t){this.listeners.has(e)&&this.listeners.get(e)(),this.listeners.set(e,t)}removeListener(e){this.listeners.has(e)&&(this.listeners.get(e)(),this.listeners.delete(e))}removeAllListeners(){this.listeners.forEach(e=>e()),this.listeners.clear()}}function as(e){let{availableJobs:t,currentSelectedJobIds:s=[],onConfirmSelection:n,onCancel:i}=e;const[o,l]=(0,a.useState)(Array.isArray(s)?[...s]:[]),r=(0,a.useMemo)(()=>Array.isArray(t)?t.filter(e=>!1!==e.active):[],[t]),d=(0,a.useCallback)(e=>{l(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]);return(0,L.jsxs)("div",{className:"bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg border border-cyan-900/30 p-6 max-w-xl mx-auto my-8",children:[(0,L.jsx)("h4",{className:"text-xl font-semibold text-white text-center mb-2",children:"\uc9c1\uc5c5 \uc120\ud0dd (\ub2e4\uc911 \uc120\ud0dd \uac00\ub2a5)"}),(0,L.jsx)("p",{className:"text-sm text-slate-400 text-center mb-4",children:"'\ub098\uc758 \ud560\uc77c'\uc5d0 \ud45c\uc2dc\ud560 \uc9c1\uc5c5\uc744 \uc120\ud0dd\ud558\uc138\uc694."}),(0,L.jsxs)("div",{className:"flex flex-col gap-3",children:[r.map(e=>(0,L.jsxs)("label",{className:"p-3 rounded-xl border-2 cursor-pointer transition-all flex items-center gap-3 ".concat(o.includes(e.id)?"border-cyan-500 bg-cyan-900/30":"border-cyan-900/20 bg-[#14142380] hover:border-cyan-500/50"),children:[(0,L.jsx)("input",{type:"checkbox",checked:o.includes(e.id),onChange:()=>d(e.id),className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500 cursor-pointer"}),(0,L.jsx)("span",{className:"font-medium ".concat(o.includes(e.id)?"text-cyan-400":"text-slate-300"),children:e.title})]},e.id)),0===r.length&&(0,L.jsx)(Pt.pp,{icon:R.A,title:"\uc120\ud0dd \uac00\ub2a5\ud55c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4",description:"\uad00\ub9ac\uc790\uac00 \uc9c1\uc5c5\uc744 \ub4f1\ub85d\ud558\uba74 \uc5ec\uae30\uc5d0 \ud45c\uc2dc\ub429\ub2c8\ub2e4."})]}),(0,L.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,L.jsx)(Pt.rA,{variant:"secondary",onClick:i,children:"\ucde8\uc18c"}),(0,L.jsx)(Pt.rA,{variant:"primary",onClick:()=>n(o),children:"\uc120\ud0dd \uc644\ub8cc"})]})]})}const ns=function(e){let{adminTabMode:t}=e;(0,n.Zp)();const{user:s,userDoc:o,setUserDoc:r,loading:d,updateUser:c,refreshUserDocument:p,isAdmin:u,isSuperAdmin:m,optimisticUpdate:x}=(0,i.As)(),h=(0,a.useRef)(new ss),g=(0,a.useRef)(0),f=(0,a.useRef)(null),[b,y]=(0,a.useState)(!0),[j,v]=(0,a.useState)("list"),[w,N]=(0,a.useState)(!1),[C,k]=(0,a.useState)("generalSettings"),[S,A]=(0,a.useState)([]),[I,E]=(0,a.useState)([]),[T,z]=(0,a.useState)(null),[O,_]=(0,a.useState)(""),[W,B]=(0,a.useState)(null),[P,F]=(0,a.useState)(null),[q,U]=(0,a.useState)(!1),[Q,H]=(0,a.useState)(!1),[J,V]=(0,a.useState)(!1),[X,Y]=(0,a.useState)(""),[Z,$]=(0,a.useState)(""),[te,se]=(0,a.useState)("5"),[ae,ne]=(0,a.useState)(!1),[ie,oe]=(0,a.useState)(1e3),[le,re]=(0,a.useState)(1e3),[de,ce]=(0,a.useState)(String(1e3)),[pe,ue]=(0,a.useState)(String(1e3)),[me,xe]=(0,a.useState)([]);(0,a.useEffect)(()=>{t&&null!==u&&void 0!==u&&u()&&(k(t),N(!0))},[t,u]),(0,a.useEffect)(()=>{if(null!==o&&void 0!==o&&o.uid&&"student"===(null===o||void 0===o?void 0:o.role)){if(Ht(o.uid).canClaim){const e=setTimeout(()=>{V(!0)},500);return()=>clearTimeout(e)}}},[null===o||void 0===o?void 0:o.uid,null===o||void 0===o?void 0:o.role]);const he=(0,a.useCallback)(async e=>{if(null!==o&&void 0!==o&&o.uid&&e)try{const t=(0,ee.H9)(G.db,"users",o.uid);await(0,ee.mZ)(t,{cash:(0,ee.GV)(e)}),Ft.Ay.invalidate("user_".concat(o.uid)),setTimeout(()=>{V(!1)},3e3)}catch(t){console.error("\ucd9c\uc11d \ubcf4\uc0c1 \uc9c0\uae09 \uc2e4\ud328:",t)}},[null===o||void 0===o?void 0:o.uid]),ge=(0,a.useMemo)(()=>null!==o&&void 0!==o&&o.classCode&&null!==u&&void 0!==u&&u()?"".concat(o.classCode,"_goal"):null,[null===o||void 0===o?void 0:o.classCode,u]),fe=(0,a.useMemo)(()=>o&&Array.isArray(o.selectedJobIds)?o.selectedJobIds:[],[o]),be=(0,a.useMemo)(()=>{const e=(null===o||void 0===o?void 0:o.completedJobTasks)||{};return Array.isArray(S)?S.filter(e=>fe.includes(e.id)&&!1!==e.active).map(t=>(0,l.A)((0,l.A)({},t),{},{tasks:(t.tasks||[]).map(s=>(0,l.A)((0,l.A)({},s),{},{clicks:e["".concat(t.id,"_").concat(s.id)]||0}))})):[]},[S,fe,o]),ye=(0,a.useMemo)(()=>{if(!I||!o)return[];const e=o.completedTasks||{};return I.map(t=>(0,l.A)((0,l.A)({},t),{},{clicks:e[t.id]||0}))},[I,o]),je=(0,a.useCallback)(()=>{try{return(0,ee.H9)((0,ee.rJ)(G.db,"temp")).id}catch(e){return console.error("Error generating ID:",e),Date.now().toString()+Math.random().toString(36).substr(2,9)}},[]),ve=(0,a.useCallback)(async e=>{if(!e)return;const t=async()=>{try{const t=(0,ee.query)((0,ee.rJ)(G.db,"jobs"),(0,ee.where)("classCode","==",e),(0,ee.AB)(50)),s=(await(0,ee.getDocs)(t)).docs.map(e=>(0,l.A)((0,l.A)({id:e.id},e.data()),{},{tasks:(e.data().tasks||[]).map(e=>(0,l.A)((0,l.A)({},e),{},{reward:e.reward||0,clicks:0,maxClicks:e.maxClicks||5})),active:!1!==e.data().active})).sort((e,t)=>{var s,a,n,i;const o=(null===(s=e.updatedAt)||void 0===s||null===(a=s.toMillis)||void 0===a?void 0:a.call(s))||0;return((null===(n=t.updatedAt)||void 0===n||null===(i=n.toMillis)||void 0===i?void 0:i.call(n))||0)-o});A(s),Zt("jobs_".concat(e),s,Xt.JOBS);const a=(0,ee.query)((0,ee.rJ)(G.db,"commonTasks"),(0,ee.where)("classCode","==",e),(0,ee.AB)(50)),n=(await(0,ee.getDocs)(a)).docs.map(e=>(0,l.A)((0,l.A)({id:e.id},e.data()),{},{reward:e.data().reward||0,clicks:e.data().clicks||0,maxClicks:e.data().maxClicks||5})).sort((e,t)=>{var s,a,n,i;const o=(null===(s=e.updatedAt)||void 0===s||null===(a=s.toMillis)||void 0===a?void 0:a.call(s))||0;return((null===(n=t.updatedAt)||void 0===n||null===(i=n.toMillis)||void 0===i?void 0:i.call(n))||0)-o});E(n),Zt("commonTasks_".concat(e),n,Xt.TASKS)}catch(t){console.error("Polling \uc5d0\ub7ec:",t)}};await t();const s=setInterval(t,72e5);h.current.addListener("polling",()=>clearInterval(s))},[]),we=(0,a.useCallback)(async e=>{const t=Yt("jobs_".concat(e)),s=Yt("commonTasks_".concat(e)),a=Yt("mainSettings");return t&&A(t),s&&E(s),a&&(re(a.couponValue||1e3),ce(String(a.couponValue||1e3))),{hasJobsCache:!!t,hasTasksCache:!!s,hasSettingsCache:!!a}},[]),Ne=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null===o||void 0===o||!o.classCode)return void y(!1);const t=Date.now(),s=o.classCode;if(f.current&&!e)return f.current;if(!e&&t-g.current<72e5)return void y(!1);y(!0);return f.current=(async()=>{try{const a=await we(s);a.hasJobsCache&&a.hasTasksCache&&y(!1),h.current.listeners.has("jobs")||setTimeout(()=>ve(s),0);const n=[];if(a.hasSettingsCache&&!e||n.push((0,ee.x7)((0,ee.H9)(G.db,"settings","mainSettings")).then(e=>({type:"settings",data:e.exists()?e.data():null}))),!ge||Yt("goal_".concat(ge))&&!e||n.push((0,ee.x7)((0,ee.H9)(G.db,"goals",ge)).then(e=>({type:"goal",data:e.exists()?e.data():null}))),!m()||Yt("classCodes")&&!e||n.push((0,ee.x7)((0,ee.H9)(G.db,"settings","classCodes")).then(e=>({type:"classCodes",data:e.exists()?e.data():null}))),n.length>0){(await Promise.all(n)).forEach(e=>{switch(e.type){case"settings":if(e.data){const t=e.data.couponValue||1e3;re(t),ce(String(t)),Zt("mainSettings",e.data,Xt.SETTINGS)}break;case"goal":if(e.data&&e.data.classCode===s){const t=e.data.targetAmount||1e3;oe(t),ue(String(t)),Zt("goal_".concat(ge),e.data,Xt.GOALS)}break;case"classCodes":e.data&&(xe(e.data.validCodes||[]),Zt("classCodes",e.data,Xt.CLASS_CODES))}})}g.current=t}catch(a){}finally{y(!1),f.current=null}})(),f.current},[null===o||void 0===o?void 0:o.classCode,ge,m,ve,we]),Ce=(0,a.useRef)(!1),ke=(0,a.useCallback)(async()=>{if(Ce.current)console.log("[Dashboard] \uc774\ubbf8 \uc0c8\ub85c\uace0\uce68 \uc9c4\ud589 \uc911 - \uc911\ubcf5 \uc2e4\ud589 \ubc29\uc9c0");else{Ce.current=!0,console.log("[Dashboard] \uc11c\ubc84 \ub9ac\uc14b \uac10\uc9c0 - \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0c1\ud0dc \uc0c8\ub85c\uace0\uce68");try{p&&await p(),Ne&&await Ne(!0);const e=(new Date).toDateString();localStorage.setItem("lastTaskResetDate",e),console.log("[Dashboard] \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0c1\ud0dc \uc0c8\ub85c\uace0\uce68 \uc644\ub8cc")}catch(e){console.error("[Dashboard] \uc0c1\ud0dc \uc0c8\ub85c\uace0\uce68 \uc624\ub958:",e)}finally{Ce.current=!1}}},[p,Ne]);(0,a.useEffect)(()=>{if(!d)return s?(null!==o&&void 0!==o&&o.id&&null!==o&&void 0!==o&&o.classCode?Ne():y(!1),()=>{h.current.removeAllListeners()}):(y(!1),A([]),E([]),void h.current.removeAllListeners());y(!0)},[d,s,null===o||void 0===o?void 0:o.id,null===o||void 0===o?void 0:o.classCode,Ne]);const Se=(0,a.useRef)(!1),Ae=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(null===o||void 0===o||!o.classCode||!ke)return;const e=()=>{const e=(new Date).toDateString(),t=localStorage.getItem("lastTaskResetDate");Ae.current!==e&&(Ae.current=e,t!==e&&ke())};Se.current||(Se.current=!0,e());const t=setInterval(()=>{e()},36e5);return()=>{t&&clearInterval(t)}},[null===o||void 0===o?void 0:o.classCode,ke]);const Ie=(0,a.useCallback)(async()=>{if(!G.db||null===o||void 0===o||!o.classCode)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c.");const e=O.trim();if(e){y(!0);try{if(T){const t=(0,ee.H9)(G.db,"jobs",T.id);ts.addWrite({type:"update",ref:t,data:{title:e,updatedAt:(0,ee.O5)()}}),alert("\uc9c1\uc5c5\uc774 \uc218\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),_(""),z(null),N(!1)}else{const t=je(),s=(0,ee.H9)(G.db,"jobs",t);ts.addWrite({type:"set",ref:s,data:{title:e,active:!0,tasks:[],createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)(),classCode:o.classCode}}),alert("\uc9c1\uc5c5\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),_("")}$t("jobs_".concat(o.classCode))}catch(t){console.error("handleSaveJob \uc624\ub958:",t),alert("\uc9c1\uc5c5 \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd")}finally{y(!1)}}else alert("\uc9c1\uc5c5 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},[O,T,je,o]),Ee=(0,a.useCallback)(async e=>{if(G.db){if(window.confirm("\uc815\ub9d0\ub85c \uc774 \uc9c1\uc5c5\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uad00\ub828\ub41c \ud560\uc77c\ub3c4 \ubaa8\ub450 \uc0ad\uc81c\ub429\ub2c8\ub2e4.")){y(!0);try{var t;const a=(0,ee.H9)(G.db,"jobs",e);if(ts.addWrite({type:"delete",ref:a,data:null}),s&&null!==o&&void 0!==o&&null!==(t=o.selectedJobIds)&&void 0!==t&&t.includes(e)){const t=o.selectedJobIds.filter(t=>t!==e);await c({selectedJobIds:t})}(null===T||void 0===T?void 0:T.id)===e&&(_(""),z(null)),N(!1),alert("\uc9c1\uc5c5\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),$t("jobs_".concat(o.classCode))}catch(a){console.error("handleDeleteJob \uc624\ub958:",a),alert("\uc9c1\uc5c5 \uc0ad\uc81c \uc911 \uc624\ub958 \ubc1c\uc0dd")}finally{y(!1)}}}else alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.")},[s,o,T,c]),Te=(0,a.useCallback)(e=>{e?(z(e),_(e.title),k("jobSettings"),N(!0)):alert("\ud574\ub2f9 \uc9c1\uc5c5\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},[]),Me=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;U(arguments.length>1&&void 0!==arguments[1]&&arguments[1]),F(e),Y(""),$(""),se("5"),B(null),k("taskManagement"),H(!0),N(!0)},[]),De=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e?(B(e),Y(e.name),$(String(e.reward||0)),se(String(e.maxClicks||5)),U(!!t),F(t),k("taskManagement"),H(!0),N(!0)):alert("\uc218\uc815\ud560 \ud560\uc77c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},[]),Re=(0,a.useCallback)(async()=>{if(!G.db||null===o||void 0===o||!o.classCode)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c.");const e=X.trim(),t=parseInt(Z,10),s=parseInt(te,10);if(!e||isNaN(t)||t<0||isNaN(s)||s<=0)return void alert("\uc785\ub825\uac12\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694. (\uc774\ub984, \ubcf4\uc0c1: 0 \uc774\uc0c1 \uc22b\uc790, \ucd5c\ub300 \ud074\ub9ad: 1 \uc774\uc0c1 \uc22b\uc790)");y(!0);const a={name:e,reward:t,maxClicks:s,clicks:(null===W||void 0===W?void 0:W.clicks)||0};try{if(W){const e=W.id;if(q&&P){const t=(0,ee.H9)(G.db,"jobs",P),s=await(0,ee.x7)(t);if(!s.exists()||s.data().classCode!==o.classCode)throw new Error("\uc9c1\uc5c5 \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uac70\ub098 \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");const n=s.data().tasks||[],i=n.findIndex(t=>t.id===e);if(-1===i)throw new Error("\uc9c1\uc5c5 \ub0b4 \ud560\uc77c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const r=[...n];r[i]=(0,l.A)((0,l.A)({},r[i]),a),ts.addWrite({type:"update",ref:t,data:{tasks:r,updatedAt:(0,ee.O5)()}})}else{const t=(0,ee.H9)(G.db,"commonTasks",e);ts.addWrite({type:"update",ref:t,data:(0,l.A)((0,l.A)({},a),{},{updatedAt:(0,ee.O5)()})})}H(!1),B(null),N(!1),alert("\ud560\uc77c\uc774 \uc218\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}else{const e=je(),t=(0,l.A)((0,l.A)({},a),{},{id:e,clicks:0});if(q&&P){const e=(0,ee.H9)(G.db,"jobs",P);ts.addWrite({type:"update",ref:e,data:{tasks:(0,ee.hq)(t),updatedAt:(0,ee.O5)()}})}else{const s=(0,ee.H9)(G.db,"commonTasks",e);ts.addWrite({type:"set",ref:s,data:(0,l.A)((0,l.A)({},t),{},{createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)(),classCode:o.classCode})})}Y(""),$(""),se("5"),alert("\ud560\uc77c\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}$t(q?"jobs_".concat(o.classCode):"commonTasks_".concat(o.classCode))}catch(n){console.error("handleSaveTask \uc624\ub958:",n),alert("\ud560\uc77c \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd: "+n.message)}finally{y(!1)}},[X,Z,te,W,q,P,je,o]),ze=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(G.db){if(window.confirm("\uc815\ub9d0\ub85c \uc774 \ud560\uc77c\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){y(!0);try{if(t){const s=(0,ee.H9)(G.db,"jobs",t),a=await(0,ee.x7)(s);if(!a.exists())throw new Error("\uc9c1\uc5c5 \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const n=(a.data().tasks||[]).filter(t=>t.id!==e);ts.addWrite({type:"update",ref:s,data:{tasks:n,updatedAt:(0,ee.O5)()}})}else{const t=(0,ee.H9)(G.db,"commonTasks",e);ts.addWrite({type:"delete",ref:t,data:null})}(null===W||void 0===W?void 0:W.id)===e&&(H(!1),B(null)),N(!1),alert("\ud560\uc77c\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),$t(t?"jobs_".concat(o.classCode):"commonTasks_".concat(o.classCode))}catch(s){console.error("handleDeleteTask \uc624\ub958:",s),alert("\ud560\uc77c \uc0ad\uc81c \uc911 \uc624\ub958 \ubc1c\uc0dd: "+s.message)}finally{y(!1)}}}else alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.")},[W,o]),Oe=(0,a.useCallback)(()=>{v("selectJob")},[]),_e=(0,a.useCallback)(async e=>{if(null===s||void 0===s||!s.uid)return void alert("\uc0ac\uc6a9\uc790 \uc815\ubcf4 \uc624\ub958.");const t=Array.isArray(e)?e:[];y(!0);try{await c({selectedJobIds:t})?(r((0,l.A)((0,l.A)({},o),{},{selectedJobIds:t})),v("list"),alert("\uc120\ud0dd\ud55c \uc9c1\uc5c5\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")):alert("\uc120\ud0dd\ud55c \uc9c1\uc5c5 \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd.")}catch(a){console.error("handleConfirmJobSelection \uc624\ub958:",a),alert("\uc120\ud0dd \uc9c1\uc5c5 \uc800\uc7a5 \uc911 \uc608\uc0c1\uce58 \ubabb\ud55c \uc624\ub958 \ubc1c\uc0dd.")}finally{y(!1)}},[s,c]),Le=(0,a.useCallback)(()=>{v("list")},[]),We=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(ae)return;if(null===o||void 0===o||!o.id)return void alert("\uc0ac\uc6a9\uc790 \uc815\ubcf4\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");if(s&&t){var i,d;const s="".concat(t,"_").concat(e),a=(o.completedJobTasks||{})[s]||0,n=null===(i=S.find(e=>e.id===t))||void 0===i||null===(d=i.tasks)||void 0===d?void 0:d.find(t=>t.id===e);if(n&&n.maxClicks>0&&a>=n.maxClicks)return void console.warn("[Dashboard] \uc774\ubbf8 \uc644\ub8cc\ub41c \uc9c1\uc5c5 \ud560\uc77c:",{taskKey:s,currentClicks:a,maxClicks:n.maxClicks})}else if(!s){const t=(o.completedTasks||{})[e]||0,s=null===I||void 0===I?void 0:I.find(t=>t.id===e);if(s&&s.maxClicks>0&&t>=s.maxClicks)return void console.warn("[Dashboard] \uc774\ubbf8 \uc644\ub8cc\ub41c \uacf5\ud1b5 \ud560\uc77c:",{taskId:e,currentClicks:t,maxClicks:s.maxClicks})}ne(!0),console.log("[Dashboard] \ud560\uc77c \uc644\ub8cc \ucc98\ub9ac \uc2dc\uc791:",{taskId:e,jobId:t,isJobTask:s,cardType:a,rewardAmount:n});let c=0,p=0;a&&n&&("cash"===a?c=n:"coupon"===a&&(p=n));const u=(0,l.A)({},o),m=o.cash+c,x=o.coupons+p;r(s&&t?s=>(0,l.A)((0,l.A)({},s),{},{cash:m,coupons:x,completedJobTasks:(0,l.A)((0,l.A)({},s.completedJobTasks||{}),{},{["".concat(t,"_").concat(e)]:((s.completedJobTasks||{})["".concat(t,"_").concat(e)]||0)+1})}):t=>{var s;return(0,l.A)((0,l.A)({},t),{},{cash:m,coupons:x,completedTasks:(0,l.A)((0,l.A)({},t.completedTasks||{}),{},{[e]:((null===(s=t.completedTasks)||void 0===s?void 0:s[e])||0)+1})})});try{const i=(0,Ze.Qg)(G.Cn,"completeTask"),o=(await i({taskId:e,jobId:t,isJobTask:s,cardType:a,rewardAmount:n})).data;if(console.log("\u2705 [\ub514\ubc84\uadf8] \uc11c\ubc84\ub85c\ubd80\ud130 \ubc1b\uc740 \uacb0\uacfc:",o),!o.success)throw new Error(o.message||"\uc54c \uc218 \uc5c6\ub294 \uc11c\ubc84 \uc624\ub958");{const e="number"===typeof o.updatedCash?o.updatedCash:m,t="number"===typeof o.updatedCoupons?o.updatedCoupons:x;console.log("\u2705 [\ub514\ubc84\uadf8] \ub099\uad00\uc801 \uc5c5\ub370\uc774\ud2b8: \ud604\uae08 ".concat(m,"\uc6d0, \ucfe0\ud3f0 ").concat(x,"\uac1c \u2192 \uc11c\ubc84 \ud655\uc815: \ud604\uae08 ").concat(e,"\uc6d0, \ucfe0\ud3f0 ").concat(t,"\uac1c")),r(s=>(0,l.A)((0,l.A)({},s),{},{cash:e,coupons:t})),alert(o.message)}}catch(h){console.error("[Dashboard] \ud560\uc77c \uc644\ub8cc \ucc98\ub9ac \uc911 \uc2ec\uac01\ud55c \uc624\ub958:",h),alert("\ud560\uc77c \uc644\ub8cc\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4: ".concat(h.message)),r(u)}finally{ne(!1)}},[ae,o,I,S,r]),Be=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generalSettings";ue(String(ie)),ce(String(le)),k(e),N(!0)},[ie,le]),Pe=(0,a.useCallback)(async()=>{if(console.log("--- [DEBUG] EXECUTING handleSaveAdminSettings with LATEST code ---"),!G.db)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.");const e=parseInt(pe,10),t=parseInt(de,10);if(isNaN(e)||e<=0||isNaN(t)||t<=0)alert("\uc62c\ubc14\ub978 \ubaa9\ud45c \uae08\uc561\uacfc \ucfe0\ud3f0 \uac00\uce58\ub97c \uc785\ub825\ud558\uc138\uc694 (0\ubcf4\ub2e4 \ud070 \uc22b\uc790).");else{y(!0);try{const a=(0,ee.H9)(G.db,"settings","mainSettings"),n=await(0,ee.x7)(a);if(n.exists()&&n.data().couponValue===t||ts.addWrite({type:"set",ref:a,data:{couponValue:t,updatedAt:(0,ee.O5)()}}),ge&&null!==u&&void 0!==u&&u())try{const t=(0,ee.H9)(G.db,"goals",ge);await(0,ee.BN)(t,{targetAmount:e,classCode:o.classCode,updatedAt:(0,ee.O5)()},{merge:!0})}catch(s){console.warn("\ubaa9\ud45c \uc124\uc815 \uad8c\ud55c\uc774 \uc5c6\uc5b4 \ubaa9\ud45c \uae08\uc561 \uc124\uc815\uc744 \uac74\ub108\ub700:",s.code)}re(t),ge&&null!==u&&void 0!==u&&u()&&oe(e),N(!1),alert("\uad00\ub9ac\uc790 \uc124\uc815\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),$t("mainSettings"),ge&&$t("goal_".concat(ge))}catch(a){console.error("\uad00\ub9ac\uc790 \uc124\uc815 \uc800\uc7a5 \uc624\ub958:",a),alert("\uad00\ub9ac\uc790 \uc124\uc815 \uc800\uc7a5 \uc911 \uc624\ub958: "+a.message)}finally{y(!1)}}},[pe,de,ge,o,u]),Fe=(0,a.useCallback)(async()=>{if(!G.db||null===u||void 0===u||!u())return;const e=Yt("classCodes");if(e)xe(e.validCodes||[]);else try{const e=(0,ee.H9)(G.db,"settings","classCodes"),t=await(0,ee.x7)(e);if(t.exists()){const e=Array.isArray(t.data().validCodes)?t.data().validCodes:[];xe(e),Zt("classCodes",t.data(),Xt.CLASS_CODES)}else ts.addWrite({type:"set",ref:e,data:{validCodes:[],createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)()}}),xe([])}catch(t){console.error("\ud559\uae09 \ucf54\ub4dc \ub85c\ub4dc \uc624\ub958:",t),xe([])}},[u]);(0,a.useEffect)(()=>{null!==u&&void 0!==u&&u()&&Fe()},[u,Fe]);const qe=(0,a.useCallback)(async e=>{if(!G.db)return!1;const t=e.trim();if(!t)return alert("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694."),!1;if(me.includes(t))return alert("\uc774\ubbf8 \ub4f1\ub85d\ub41c \ud559\uae09 \ucf54\ub4dc\uc785\ub2c8\ub2e4."),!1;y(!0);try{const e=(0,ee.H9)(G.db,"settings","classCodes"),a=await(0,ee.x7)(e),n=a.exists()&&a.data().validCodes||[];ts.addWrite({type:"update",ref:e,data:{validCodes:[...n,t],updatedAt:(0,ee.O5)()}});try{const e=await(0,G.Sj)(t);e.success?alert("\ud559\uae09 \ucf54\ub4dc '".concat(t,"'\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4!\n\n\uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc644\ub8cc:\n- \uc9c1\uc5c5 ").concat(e.results.jobs.copied,"\uac1c\n- \uc0c1\uc810 \uc544\uc774\ud15c ").concat(e.results.storeItems.copied,"\uac1c")):alert("\ud559\uae09 \ucf54\ub4dc '".concat(t,"'\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\n\n\u26a0\ufe0f \uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc911 \uc624\ub958: ").concat(e.error,"\n(\ub098\uc911\uc5d0 \uc9c1\uc811 \ucd94\uac00\ud574\uc8fc\uc138\uc694)"))}catch(s){console.error("\uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc624\ub958:",s),alert("\ud559\uae09 \ucf54\ub4dc '".concat(t,"'\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\n\n\u26a0\ufe0f \uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc2e4\ud328\n(\ub098\uc911\uc5d0 \uc9c1\uc811 \ucd94\uac00\ud574\uc8fc\uc138\uc694)"))}return xe(e=>[...e,t]),$t("classCodes"),!0}catch(a){return console.error("\ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uc624\ub958:",a),alert("\ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uc911 \uc624\ub958 \ubc1c\uc0dd"),!1}finally{y(!1)}},[me]),Ue=(0,a.useCallback)(async e=>{if(!G.db)return!1;if(!window.confirm("'".concat(e,"' \ucf54\ub4dc\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))return!1;y(!0);try{const t=(0,ee.H9)(G.db,"settings","classCodes"),s=await(0,ee.x7)(t);if(!s.exists())throw new Error("\ud559\uae09 \ucf54\ub4dc \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const a=(s.data().validCodes||[]).filter(t=>t!==e);return ts.addWrite({type:"update",ref:t,data:{validCodes:a,updatedAt:(0,ee.O5)()}}),alert("\ud559\uae09 \ucf54\ub4dc\uac00 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),xe(t=>t.filter(t=>t!==e)),$t("classCodes"),!0}catch(t){return console.error("\ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uc624\ub958:",t),alert("\ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uc911 \uc624\ub958 \ubc1c\uc0dd: "+t.message),!1}finally{y(!1)}},[]),He=(0,a.useCallback)(()=>{es(),h.current.removeAllListeners(),null!==o&&void 0!==o&&o.classCode&&ve(o.classCode),Ne(!0)},[Ne,null===o||void 0===o?void 0:o.classCode,ve]),Ge=(0,a.useCallback)(async()=>{if(console.log("[Dashboard] \uc218\ub3d9 \ud560\uc77c \ub9ac\uc14b \uc2dc\uc791"),null===o||void 0===o||!o.classCode)return console.error("[Dashboard] \ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc5b4 \ub9ac\uc14b\uc744 \uc911\ub2e8\ud569\ub2c8\ub2e4."),void alert("\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");if(window.confirm("'".concat(o.classCode,"' \ud074\ub798\uc2a4\uc758 \ubaa8\ub4e0 \ud559\uc0dd\ub4e4\uc758 '\uc624\ub298\uc758 \ud560\uc77c' \uc644\ub8cc \uae30\ub85d\uc744 \ucd08\uae30\ud654\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\n\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))){console.log("[Dashboard] ".concat(o.classCode," \ud074\ub798\uc2a4 \ub9ac\uc14b \uc2e4\ud589...")),y(!0);try{const e=(0,Ze.Qg)(G.Cn,"manualResetClassTasks"),t=await e({classCode:o.classCode});if(console.log("[Dashboard] \ud074\ub77c\uc6b0\ub4dc \ud568\uc218 \uacb0\uacfc \uc218\uc2e0:",t.data),!t.data.success)throw new Error(t.data.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958");{r(e=>(0,l.A)((0,l.A)({},e),{},{completedTasks:{},completedJobTasks:{}}));const e=(new Date).toDateString();localStorage.setItem("lastTaskResetDate",e),alert("\ub9ac\uc14b \uc131\uacf5!\n".concat(t.data.message)),console.log("[Dashboard] \ub9ac\uc14b \uc131\uacf5: ".concat(t.data.message))}}catch(e){console.error("[Dashboard] \ud560\uc77c \ub9ac\uc14b \uc2e4\ud328:",e),alert("\uc624\ub958: \ud560\uc77c \ub9ac\uc14b\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.\n\n".concat(e.message))}finally{y(!1),console.log("[Dashboard] \uc218\ub3d9 \ud560\uc77c \ub9ac\uc14b \uc885\ub8cc")}}else console.log("[Dashboard] \uc0ac\uc6a9\uc790\uac00 \ub9ac\uc14b\uc744 \ucde8\uc18c\ud588\uc2b5\ub2c8\ub2e4.")},[null===o||void 0===o?void 0:o.classCode,r,A]);if(d||b)return(0,L.jsx)(Pt.LN,{className:"flex items-center justify-center",children:(0,L.jsx)(Pt.Gu,{message:"\uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})});if(!s)return(0,L.jsx)(Pt.LN,{className:"flex items-center justify-center",children:(0,L.jsx)(Pt.pp,{icon:D.A,title:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4",description:"\ud560\uc77c\uc744 \ud655\uc778\ud558\ub824\uba74 \uba3c\uc800 \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})});if(null===o||void 0===o||!o.id)return(0,L.jsx)(Pt.LN,{className:"flex items-center justify-center",children:(0,L.jsx)(Pt.pp,{icon:D.A,title:"\uc0ac\uc6a9\uc790 \uc815\ubcf4 \ub85c\ub4dc \uc2e4\ud328",description:"\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \uc644\uc804\ud788 \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4. \uc0c8\ub85c\uace0\uce68\ud558\uac70\ub098 \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})});if(!o.classCode)return(0,L.jsx)(Pt.LN,{className:"flex items-center justify-center",children:(0,L.jsx)(Pt.pp,{icon:D.A,title:"\ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c",description:"\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc5ec \ud559\uae09 \ucf54\ub4dc\ub97c \ud560\ub2f9\ubc1b\uc73c\uc138\uc694."})});null===s||void 0===s||s.uid;const Ve=(null===o||void 0===o?void 0:o.name)||(null===o||void 0===o?void 0:o.nickname)||(null===s||void 0===s?void 0:s.displayName)||"\uc0ac\uc6a9\uc790";return(0,L.jsxs)("div",{className:"min-h-full w-full bg-[#0a0a12] px-2 pt-1 pb-0",children:[!t&&(0,L.jsxs)("section",{className:"bg-[#14142380] backdrop-blur-sm rounded-lg px-3 py-1.5 shadow-lg border border-cyan-900/30 flex flex-col md:flex-row md:items-center justify-between gap-1.5 mb-2",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)("div",{className:"w-7 h-7 bg-cyan-900/30 rounded-md flex items-center justify-center text-cyan-400 shrink-0 border border-cyan-500/30",children:(0,L.jsx)(D.A,{className:"w-4 h-4"})}),(0,L.jsxs)("div",{className:"leading-tight",children:[(0,L.jsx)("h2",{className:"text-sm md:text-base font-bold text-white",children:"\uc624\ub298\uc758 \ud560\uc77c"}),(0,L.jsxs)("p",{className:"text-[11px] text-slate-400",children:[Ve,"\ub2d8, \uc624\ub298\ub3c4 \ud654\uc774\ud305!"]})]})]}),(null===u||void 0===u?void 0:u())&&"list"===j&&!w&&(0,L.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[(0,L.jsx)(Pt.rA,{variant:"primary",icon:M.A,onClick:()=>Be("generalSettings"),size:"sm",children:"\uad00\ub9ac\uc790 \uae30\ub2a5"}),(0,L.jsx)(Pt.rA,{variant:"success",icon:Je.A,onClick:He,size:"sm",children:"\uc0c8\ub85c\uace0\uce68"}),(0,L.jsx)(Pt.rA,{variant:"danger",icon:qt.A,onClick:Ge,size:"sm",title:"\uc774 \ud074\ub798\uc2a4\uc758 \ubaa8\ub4e0 \uc0ac\uc6a9\uc790 \ud560\uc77c\uc744 \ub9ac\uc14b\ud569\ub2c8\ub2e4",children:"\ud560\uc77c \ub9ac\uc14b"})]}),"selectJob"===j&&(0,L.jsx)(Pt.rA,{variant:"ghost",icon:K.A,onClick:Le,children:"\ub4a4\ub85c\uac00\uae30"})]}),"list"===j&&!w&&!t&&(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)("div",{className:"bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg border border-cyan-900/30 overflow-hidden mb-6",children:[(0,L.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-4 md:px-6 py-3 md:py-4 flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(R.A,{className:"w-5 h-5 text-white"}),(0,L.jsx)("h3",{className:"text-base md:text-lg font-bold text-white",children:"\ub098\uc758 \uc9c1\uc5c5 \ud560\uc77c"})]}),(0,L.jsx)(Pt.rA,{variant:"outline",icon:Qe.A,onClick:Oe,size:"sm",className:"!bg-white/20 !text-white !border-white/30 hover:!bg-white/30",children:"\uc9c1\uc5c5 \ucd94\uac00/\uc120\ud0dd"})]}),(0,L.jsxs)("div",{className:"p-4 md:p-6",children:[(0,L.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:be.length>0?be.map(e=>(0,L.jsx)(yt,{job:e,isAdmin:null===u||void 0===u?void 0:u(),onEditJob:()=>Te(e),onDeleteJob:()=>Ee(e.id),onAddTask:()=>Me(e.id,!0),onEarnCoupon:(e,t,s,a,n)=>We(e,t,s,a,n),onEditTask:t=>De(t,e.id),onDeleteTask:t=>ze(t,e.id),isHandlingTask:ae},e.id)):(0,L.jsx)("div",{className:"col-span-full",children:(0,L.jsx)(Pt.pp,{icon:R.A,title:"\ud45c\uc2dc\ud560 \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4",description:"'\uc9c1\uc5c5 \ucd94\uac00/\uc120\ud0dd' \ubc84\ud2bc\uc744 \ub20c\ub7ec \uc9c1\uc5c5\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.",action:(0,L.jsx)(Pt.rA,{variant:"primary",icon:Qe.A,onClick:Oe,children:"\uc9c1\uc5c5 \uc120\ud0dd\ud558\uae30"})})})}),(0,L.jsxs)("div",{className:"mt-6 rounded-xl overflow-hidden border border-emerald-900/30 bg-[#14142380] backdrop-blur-sm",children:[(0,L.jsxs)("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 px-4 md:px-6 py-3 md:py-4 flex items-center justify-between",children:[(0,L.jsxs)("div",{className:"flex items-center gap-2",children:[(0,L.jsx)(D.A,{className:"w-5 h-5 text-white"}),(0,L.jsx)("h3",{className:"text-base md:text-lg font-bold text-white",children:"\uacf5\ud1b5 \ud560\uc77c"})]}),(null===u||void 0===u?void 0:u())&&(0,L.jsx)(Pt.rA,{variant:"outline",icon:Qe.A,onClick:()=>Me(null,!1),size:"sm",className:"!bg-white/20 !text-white !border-white/30 hover:!bg-white/30",children:"\uacf5\ud1b5 \ud560\uc77c \ucd94\uac00"})]}),(0,L.jsx)("div",{className:"p-4 md:p-6 bg-[#0a0a12]/50",children:(0,L.jsx)(jt,{tasks:ye,isAdmin:null===u||void 0===u?void 0:u(),onEarnCoupon:(e,t,s,a,n)=>We(e,t,s,a,n),onEditTask:e=>De(I.find(t=>t.id===e),null),onDeleteTask:e=>ze(e,null),isHandlingTask:ae})})]})]})]})}),"selectJob"===j&&(0,L.jsx)(as,{availableJobs:S,currentSelectedJobIds:fe,onConfirmSelection:_e,onCancel:Le}),(null===u||void 0===u?void 0:u())&&(0,L.jsx)(Bt,{isAdmin:null===u||void 0===u?void 0:u(),isSuperAdmin:null===m||void 0===m?void 0:m(),userClassCode:null===o||void 0===o?void 0:o.classCode,showAdminSettingsModal:w,setShowAdminSettingsModal:N,adminSelectedMenu:C,setAdminSelectedMenu:k,classCodes:me,onAddClassCode:qe,onRemoveClassCode:Ue,newGoalAmount:pe,setNewGoalAmount:ue,adminCouponValue:de,setAdminCouponValue:ce,handleSaveAdminSettings:Pe,jobs:S,adminNewJobTitle:O,setAdminNewJobTitle:_,adminEditingJob:T,setAdminEditingJob:z,handleSaveJob:Ie,handleDeleteJob:Ee,handleEditJob:Te,commonTasks:I,showAddTaskForm:Q,setShowAddTaskForm:H,adminNewTaskName:X,setAdminNewTaskName:Y,adminNewTaskReward:Z,setAdminNewTaskReward:$,adminNewTaskMaxClicks:te,setAdminNewTaskMaxClicks:se,adminEditingTask:W,setAdminEditingTask:B,handleSaveTask:Re,handleEditTask:De,handleDeleteTask:ze,taskFormJobId:P,taskFormIsJobTask:q,handleAddTaskClick:Me}),J&&(null===o||void 0===o?void 0:o.uid)&&(0,L.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"20px",animation:"fadeIn 0.3s ease-out"},onClick:()=>V(!1),children:(0,L.jsxs)("div",{style:{width:"100%",maxWidth:"400px",animation:"slideUp 0.3s ease-out"},onClick:e=>e.stopPropagation(),children:[(0,L.jsx)("div",{style:{textAlign:"right",marginBottom:"8px"},children:(0,L.jsx)("button",{onClick:()=>V(!1),style:{background:"rgba(255,255,255,0.2)",border:"none",color:"#fff",width:"32px",height:"32px",borderRadius:"50%",cursor:"pointer",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center"},children:"\u2715"})}),(0,L.jsx)(Jt,{userId:o.uid,onClaim:he}),(0,L.jsx)("div",{style:{textAlign:"center",marginTop:"12px",color:"rgba(255,255,255,0.6)",fontSize:"13px"},children:"\ubc30\uacbd\uc744 \ud130\uce58\ud558\uba74 \ub2eb\ud799\ub2c8\ub2e4"})]})})]})};var is=s(9222),os=(s(6353),s(262)),ls=s(8164);const rs=["id"],ds=e=>{let{stock:t}=e;if(void 0===t||null===t)return null;let s="";s=t<=0||t<=3?"stock-low":t<=5?"stock-medium":"stock-high";const a=t<=0?"\ud488\uc808":"\uc7ac\uace0(".concat(t,"\uac1c)");return(0,L.jsx)("span",{className:"stock-badge ".concat(s),children:a})},cs=()=>{const{user:e,userDoc:t,isAdmin:s}=(0,i.As)()||{user:null,userDoc:null,isAdmin:()=>!1},{items:n,purchaseItem:r,deleteItem:d,updateItem:c,addItem:p,setAdminPriceIncrease:u,adminPriceIncreasePercentage:m}=(0,o.wB)()||{items:[],purchaseItem:null,updateItem:null,deleteItem:null,addItem:null,setAdminPriceIncrease:null,adminPriceIncreasePercentage:10},[x,h]=(0,a.useState)([]),[g,f]=(0,a.useState)(null),[b,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null),[w,N]=(0,a.useState)(!1),[C,k]=(0,a.useState)(null),[S,A]=(0,a.useState)(m||10),[I,E]=(0,a.useState)(!1),[T,M]=(0,a.useState)({}),D=s(),R=null===t||void 0===t?void 0:t.classCode;(0,a.useEffect)(()=>{if(n&&Array.isArray(n)){const e=n.map(e=>{var t,s;return(0,l.A)((0,l.A)({},e),{},{initialStock:null!==(t=null!==(s=e.initialStock)&&void 0!==s?s:e.stock)&&void 0!==t?t:10})}).filter(e=>!1!==(null===e||void 0===e?void 0:e.available));h(e);const t={};e.forEach(e=>{t[e.id]=1}),M(t)}else h([])},[n]),(0,a.useEffect)(()=>{A(m||10)},[m]),(0,a.useEffect)(()=>{const e=()=>E(window.innerWidth<=768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const z=(e,t)=>{f({type:e,message:t}),setTimeout(()=>f(null),3e3)},O=s=>{if(s.stock<=0)return"\ud488\uc808";const a=void 0!==(null===t||void 0===t?void 0:t.cash)?t.cash:null===e||void 0===e?void 0:e.cash,n=T[s.id]||1,i=s.price*n;return e&&void 0!==a&&a<i?"\uc794\uc561 \ubd80\uc871":"\uad6c\ub9e4\ud558\uae30"},_=D&&R;return(0,L.jsxs)("div",{className:"page-container ".concat(b&&_?"admin-mode":""),children:[(0,L.jsxs)("div",{className:"page-header-container",children:[(0,L.jsxs)("h2",{className:"page-title",children:[b&&_?"\uad00\ub9ac\uc790 \ud398\uc774\uc9c0":"\uc544\uc774\ud15c \uc0c1\uc810",R&&(0,L.jsxs)("span",{style:{fontSize:"0.7em",marginLeft:"10px",color:"#777"},children:["(\ud559\uae09: ",R,")"]})]}),D&&(0,L.jsx)("button",{onClick:()=>{R?(y(e=>!e),b&&v(null)):z("error","\uad00\ub9ac\uc790\uc758 \ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc5b4 \uad00\ub9ac\uc790 \ud328\ub110\uc744 \uc5f4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},className:"admin-icon-button",title:b?"\uc0c1\uc810 \ubcf4\uae30":"\uad00\ub9ac\uc790 \uae30\ub2a5",children:b&&_?"\ud83d\uded2":"\u2699\ufe0f"})]}),g&&(0,L.jsx)("div",{className:"notification ".concat("success"===g.type?"bg-green-100 text-green-800":"error"===g.type?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:g.message}),w&&_&&(0,L.jsx)("div",{className:"delete-confirm-modal",children:(0,L.jsxs)("div",{className:"delete-confirm-content",children:[(0,L.jsx)("h3",{children:"\uc544\uc774\ud15c \uc0ad\uc81c \ud655\uc778"}),(0,L.jsxs)("p",{children:[(0,L.jsx)("strong",{children:null===C||void 0===C?void 0:C.name})," \uc544\uc774\ud15c\uc744 \uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? ",(0,L.jsx)("br",{}),"\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."]}),(0,L.jsxs)("div",{className:"delete-confirm-buttons",children:[(0,L.jsx)("button",{onClick:async()=>{if(d&&C&&R)try{await d(C.id),z("success","".concat(C.name," \uc0ad\uc81c \uc644\ub8cc"))}catch(e){console.error("\uc544\uc774\ud15c \uc0ad\uc81c \uc911 \uc624\ub958:",e),z("error","\uc544\uc774\ud15c \uc0ad\uc81c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{N(!1),k(null)}else z("error","\uc0ad\uc81c \uae30\ub2a5 \uc624\ub958 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c")},className:"delete-confirm-button",children:"\uc0ad\uc81c"}),(0,L.jsx)("button",{onClick:()=>{N(!1),k(null)},className:"delete-cancel-button",children:"\ucde8\uc18c"})]})]})}),b&&_?(0,L.jsx)("div",{className:"admin-panel-full-container",children:(0,L.jsx)(ls.default,{classCode:R,editingItemFromStore:j,onAddItem:async e=>{if(!p||!R)return z("error","\uc544\uc774\ud15c \ucd94\uac00 \uae30\ub2a5 \uc0ac\uc6a9 \ubd88\uac00 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c"),!1;try{const t=await p(e);return t.success?(z("success","".concat(e.name," \ucd94\uac00 \uc644\ub8cc")),!0):(z("error",t.message||"\uc544\uc774\ud15c \ucd94\uac00 \uc2e4\ud328"),!1)}catch(t){return console.error("\uc544\uc774\ud15c \ucd94\uac00 \uc911 \uc624\ub958:",t),z("error","\uc544\uc774\ud15c \ucd94\uac00 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),!1}},onUpdateItem:async e=>{if(!c||!R)return z("error","\uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 \uae30\ub2a5 \uc0ac\uc6a9 \ubd88\uac00 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c"),!1;try{const{id:t}=e,s=(0,is.A)(e,rs);if(!t)return z("error","\uc5c5\ub370\uc774\ud2b8\ud560 \uc544\uc774\ud15c\uc758 ID\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),!1;const a=await c(t,s);return a.success?(z("success","".concat(e.name," \uc5c5\ub370\uc774\ud2b8 \uc644\ub8cc")),!0):(z("error",a.message||"\uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328"),!1)}catch(t){return console.error("\uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958:",t),z("error","\uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),!1}},onClose:()=>{y(!1),v(null)}})}):(0,L.jsxs)(L.Fragment,{children:[!e&&(0,L.jsx)(os.A,{}),e&&(R?x.length>0?(0,L.jsx)("div",{className:"shop-content",children:(0,L.jsxs)("div",{className:"content-card-section",children:[(0,L.jsx)("h3",{className:"section-title",children:"\ud310\ub9e4 \uc544\uc774\ud15c"}),(0,L.jsx)("div",{className:"items-grid",children:x.map(s=>{var a;return(0,L.jsx)("div",{className:"store-item-card shop-item-card compact-card",children:(0,L.jsxs)("div",{className:"item-content",children:[(0,L.jsxs)("div",{className:"item-header-compact",children:[(0,L.jsx)("h3",{className:"item-name-compact",children:s.name}),(0,L.jsx)(ds,{stock:s.stock})]}),s.description&&s.description.trim()&&(0,L.jsx)("p",{className:"item-description-compact",children:s.description}),(0,L.jsxs)("div",{className:"item-actions-primary ".concat(I?"flex-col":""),children:[(0,L.jsxs)("span",{className:"item-price",children:[(null===(a=s.price)||void 0===a?void 0:a.toLocaleString())||0," \uc6d0"]}),(0,L.jsxs)("div",{className:"quantity-and-buy-container",children:[(0,L.jsx)("input",{type:"number",min:"1",max:s.stock,value:T[s.id]||1,onChange:e=>((e,t)=>{const s=x.find(t=>t.id===e);if(!s)return;let a=parseInt(t,10);(isNaN(a)||a<1)&&(a=1),a>s.stock&&(a=s.stock),M(t=>(0,l.A)((0,l.A)({},t),{},{[e]:a}))})(s.id,e.target.value),className:"quantity-input",disabled:s.stock<=0}),(0,L.jsx)("button",{onClick:()=>(async s=>{if(!s||s.stock<=0)return z("error","\uc7ac\uace0 \uc5c6\uc74c");if(!e||!R)return z("error","\ub85c\uadf8\uc778 \ub610\ub294 \ud559\uae09 \uc815\ubcf4 \ud544\uc694");const a=T[s.id]||1,n=void 0!==(null===t||void 0===t?void 0:t.cash)?t.cash:null===e||void 0===e?void 0:e.cash;if(void 0===n)return z("error","\uc794\uc561 \uc815\ubcf4 \uc624\ub958");if(n<s.price*a)return z("error","\uc794\uc561 \ubd80\uc871");if(!r)return z("error","\uad6c\ub9e4 \uae30\ub2a5 \uc624\ub958");try{const e=await r(s.id,a);e.success?z("success","".concat(s.name," ").concat(a,"\uac1c \uad6c\ub9e4 \uc644\ub8cc!")):z("error",e.message||"\uad6c\ub9e4\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc138\uc694.")}catch(i){console.error("\uad6c\ub9e4 \ucc98\ub9ac \uc911 \uc624\ub958:",i),z("error",i.message||"\uad6c\ub9e4 \uc911 \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}})(s),className:"buy-item-button ".concat(I?"w-full":""),disabled:!e||s.stock<=0||(void 0!==(null===t||void 0===t?void 0:t.cash)?t.cash:null===e||void 0===e?void 0:e.cash)<s.price*(T[s.id]||1),children:O(s)})]})]}),D&&R&&(0,L.jsxs)("div",{className:"item-actions-admin",children:[(0,L.jsxs)("button",{onClick:()=>(e=>{v((0,l.A)({},e)),y(!0)})(s),className:"edit-item-button",title:"\uc544\uc774\ud15c \uc218\uc815",children:["\uc218\uc815",(0,L.jsx)("span",{className:"admin-button-icon",children:"\u270f\ufe0f"})]}),(0,L.jsxs)("button",{onClick:()=>(e=>{k(e),N(!0)})(s),className:"delete-item-button",title:"\uc544\uc774\ud15c \uc0ad\uc81c",children:["\uc0ad\uc81c",(0,L.jsx)("span",{className:"admin-button-icon",children:"\ud83d\uddd1\ufe0f"})]})]})]})},s.id)})})]})}):(0,L.jsxs)("div",{className:"empty-message",style:{padding:"20px",textAlign:"center"},children:[(0,L.jsx)("p",{children:"\ud310\ub9e4 \uc911\uc778 \uc544\uc774\ud15c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),D&&R&&(0,L.jsx)("p",{children:"\uad00\ub9ac\uc790 \uae30\ub2a5\uc744 \ud1b5\ud574 \uc544\uc774\ud15c\uc744 \ucd94\uac00\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})]}):(0,L.jsx)("div",{className:"empty-message",style:{padding:"20px",textAlign:"center",color:"red"},children:"\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc5b4 \uc0c1\uc810 \uae30\ub2a5\uc744 \uc774\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."}))]})]})};s(5173);const ps=3e5,us=function(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:ps)-(Date.now()-e);if(t<=0)return"\ub9cc\ub8cc\ub428";const s=Math.floor(t/36e5),a=Math.floor(t%36e5/6e4),n=Math.floor(t%6e4/1e3);let i="";return s>0&&(i+="".concat(s,"\uc2dc\uac04 ")),(a>0||s>0)&&(i+="".concat(a,"\ubd84 ")),i+="".concat(n,"\ucd08 \ub0a8\uc74c"),i.trim()},ms=e=>{let{quantity:t}=e,s="";return s=t>10?"quantity-high":t>5?"quantity-medium":"quantity-low",(0,L.jsxs)("span",{className:"quantity-badge ".concat(s),children:["\xd7",t]})},xs=()=>{const{user:e,userDoc:t,users:s,classmates:r}=(0,i.As)()||{},{userItems:d,useItem:c,listItemForSale:p,refreshData:u,updateLocalUserItems:m}=(0,o.wB)()||{userItems:[],useItem:null,listItemForSale:null,refreshData:null,updateLocalUserItems:null},x=(0,n.Zp)(),[h,g]=(0,a.useState)(null),f=(e,t)=>{g({type:e,message:t}),setTimeout(()=>g(null),3e3)},b=(0,a.useMemo)(()=>{if(!d||0===d.length)return[];const e=new Map;return d.forEach(t=>{if(!t||!t.itemId||"number"!==typeof t.quantity||t.quantity<=0)return;const s=t.itemId;if(e.has(s)){const a=e.get(s);a.totalQuantity+=t.quantity,a.sourceDocs.push(t),t.name&&!a.displayInfo.name&&(a.displayInfo.name=t.name),t.icon&&!a.displayInfo.icon&&(a.displayInfo.icon=t.icon),t.description&&!a.displayInfo.description&&(a.displayInfo.description=t.description)}else e.set(s,{displayInfo:{itemId:t.itemId,name:t.name||"\uc54c \uc218 \uc5c6\ub294 \uc544\uc774\ud15c",icon:t.icon||"\ud83d\udd2e",description:t.description||"",type:t.type||"general",price:t.price||0,durationMs:t.durationMs||ps},totalQuantity:t.quantity,sourceDocs:[t]})}),Array.from(e.values()).sort((e,t)=>e.displayInfo.name.localeCompare(t.displayInfo.name))},[d]),[y,j]=(0,a.useState)(()=>{try{const t=localStorage.getItem("recentlyUsedItems_".concat((null===e||void 0===e?void 0:e.uid)||"guest"));return t?JSON.parse(t):{}}catch(t){return{}}});(0,a.useEffect)(()=>{null!==e&&void 0!==e&&e.uid&&localStorage.setItem("recentlyUsedItems_".concat(e.uid),JSON.stringify(y))},[y,null===e||void 0===e?void 0:e.uid]),(0,a.useEffect)(()=>{const e=setInterval(()=>{j(e=>{let t=!1;const s=(0,l.A)({},e),a=Date.now();return Object.keys(s).forEach(e=>{var n;const i=s[e],o=(null===(n=i.itemDetails)||void 0===n?void 0:n.durationMs)||ps;a-i.usedTimestamp>o&&(delete s[e],t=!0)}),t?s:e})},1e3);return()=>clearInterval(e)},[]);const[v,w]=(0,a.useState)({isOpen:!1,item:null,quantity:1}),[N,C]=(0,a.useState)({isOpen:!1,item:null}),[k,S]=(0,a.useState)(""),[A,I]=(0,a.useState)(1),[E,T]=(0,a.useState)(!1),[M,D]=(0,a.useState)(!1),[R,z]=(0,a.useState)({isOpen:!1,item:null,quantity:1,price:0}),O=()=>{w({isOpen:!1,item:null,quantity:1})},_=()=>{C({isOpen:!1,item:null})},W=()=>{z({isOpen:!1,item:null,quantity:1,price:0})},B=N.isOpen?N.item:null;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"page-container relative",children:[(0,L.jsx)("h2",{className:"page-title",children:"\ub0b4 \uc544\uc774\ud15c \uad00\ub9ac"}),!e&&(0,L.jsx)(os.A,{}),h&&(0,L.jsx)("div",{className:"notification bg-".concat(h.type,"-100"),children:h.message}),e&&(0,L.jsxs)(L.Fragment,{children:[Object.keys(y).length>0&&(0,L.jsxs)("div",{className:"content-card-section",children:[(0,L.jsx)("h3",{className:"section-title",children:"\uc0ac\uc6a9 \uc911\uc778 \uc544\uc774\ud15c"}),(0,L.jsx)("div",{className:"items-grid",children:Object.entries(y).map(e=>{let[t,s]=e;return(0,L.jsx)("div",{className:"store-item-card active-item-card",children:(0,L.jsxs)("div",{className:"item-content",children:[(0,L.jsxs)("div",{className:"my-item-header",children:[(0,L.jsx)("div",{className:"item-icon-group",children:(0,L.jsx)("div",{className:"item-icon",children:s.itemDetails.icon||"\u2728"})}),(0,L.jsxs)("div",{className:"item-info",children:[(0,L.jsx)("h3",{className:"item-name",children:s.itemDetails.name}),(0,L.jsx)("p",{className:"timer-text",children:us(s.usedTimestamp,s.itemDetails.durationMs)})]})]}),(0,L.jsx)("div",{className:"my-item-actions",children:(0,L.jsx)("button",{className:"stop-using-button",onClick:()=>(e=>{j(t=>{const s=(0,l.A)({},t);return delete s[e],s}),f("info","\uc544\uc774\ud15c \uc0ac\uc6a9\uc744 \uc911\uc9c0\ud588\uc2b5\ub2c8\ub2e4.")})(t),children:"\uc0ac\uc6a9 \uc911\uc9c0"})})]})},t)})})]}),(0,L.jsxs)("div",{className:"content-card-section",children:[(0,L.jsx)("h3",{className:"section-title",children:"\ubcf4\uc720 \uc544\uc774\ud15c"}),b.length>0?(0,L.jsx)("div",{className:"items-grid",children:b.map(t=>(0,L.jsx)("div",{className:"store-item-card compact-myitem-card",children:(0,L.jsxs)("div",{className:"item-content",children:[(0,L.jsxs)("div",{className:"my-item-header-compact",children:[(0,L.jsx)("h3",{className:"my-item-name-compact",children:t.displayInfo.name}),(0,L.jsx)(ms,{quantity:t.totalQuantity})]}),t.displayInfo.description&&t.displayInfo.description.trim()&&(0,L.jsx)("p",{className:"my-item-description-compact",children:t.displayInfo.description}),(0,L.jsxs)("div",{className:"my-item-actions",children:[(0,L.jsx)("button",{className:"use-item-button",onClick:()=>{(t=>{e?!t||t.totalQuantity<=0?f("error","\uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \uc544\uc774\ud15c\uc774 \uc544\ub2d9\ub2c8\ub2e4."):w({isOpen:!0,item:t,quantity:1}):f("error","\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.")})(t)},disabled:M,children:"\uc0ac\uc6a9\ud558\uae30"}),(0,L.jsx)("button",{className:"gift-item-button",onClick:()=>{(t=>{e?r&&0!==r.length?!t||t.totalQuantity<=0?f("error","\uc120\ubb3c\ud560 \uc544\uc774\ud15c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."):(S(""),I(1),C({isOpen:!0,item:t})):f("error","\uc120\ubb3c\ud560 \uce5c\uad6c \ubaa9\ub85d\uc744 \ubd88\ub7ec\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."):f("error","\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.")})(t)},disabled:!r||0===r.length||M,children:M?"\ub3d9\uae30\ud654 \uc911":"\uc120\ubb3c\ud558\uae30"}),(0,L.jsx)("button",{className:"sell-to-market-button",onClick:()=>{(t=>{if(!e)return void f("error","\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.");if(!t||t.totalQuantity<=0)return void f("error","\ud310\ub9e4\ud560 \uc544\uc774\ud15c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!p)return void f("error","\ud310\ub9e4 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const s=t.displayInfo.price?Math.max(1,Math.round(.8*t.displayInfo.price)):100;z({isOpen:!0,item:t,quantity:1,price:s})})(t)},disabled:M,children:"\uc2dc\uc7a5\uc5d0 \ud314\uae30"})]})]})},t.displayInfo.itemId))}):(0,L.jsx)("div",{className:"empty-message",children:(0,L.jsx)("p",{children:"\ubcf4\uc720 \uc911\uc778 \uc544\uc774\ud15c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})})]})]})]}),v.isOpen&&v.item&&(0,L.jsx)("div",{className:"myitems-modal-overlay",onClick:e=>{e.target===e.currentTarget&&O()},children:(0,L.jsxs)("div",{className:"myitems-modal-container",children:[(0,L.jsxs)("div",{className:"myitems-modal-header",children:[(0,L.jsxs)("h3",{children:[v.item.displayInfo.name," \uc0ac\uc6a9\ud558\uae30"]}),(0,L.jsx)("button",{onClick:O,className:"myitems-close-button",children:"\u2715"})]}),(0,L.jsx)("div",{className:"myitems-modal-body",children:(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsxs)("label",{htmlFor:"useQuantity",children:["\uc0ac\uc6a9\ud560 \uc218\ub7c9: (\ucd5c\ub300 ",v.item.totalQuantity,"\uac1c)"]}),(0,L.jsxs)("div",{className:"quantity-controls",children:[(0,L.jsx)("button",{onClick:()=>w(e=>(0,l.A)((0,l.A)({},e),{},{quantity:Math.max(1,e.quantity-1)})),disabled:v.quantity<=1,children:"-"}),(0,L.jsx)("input",{id:"useQuantity",type:"number",min:"1",max:v.item.totalQuantity,value:v.quantity,onChange:e=>w(t=>(0,l.A)((0,l.A)({},t),{},{quantity:Math.max(1,Math.min(t.item.totalQuantity,parseInt(e.target.value)||1))}))}),(0,L.jsx)("button",{onClick:()=>w(e=>(0,l.A)((0,l.A)({},e),{},{quantity:Math.min(e.item.totalQuantity,e.quantity+1)})),disabled:v.quantity>=v.item.totalQuantity,children:"+"})]})]})}),(0,L.jsxs)("div",{className:"myitems-modal-footer",children:[(0,L.jsx)("button",{onClick:O,className:"button-secondary",children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{const{item:e,quantity:t}=v;if(!e||!t||t<=0)f("error","\uc0ac\uc6a9\ud560 \uc544\uc774\ud15c \uc815\ubcf4\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");else if(e.totalQuantity<t)f("error","\ubcf4\uc720 \uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");else try{let s=t;const a=[],n=[...e.sourceDocs].sort((e,t)=>e.quantity-t.quantity);for(const e of n){if(s<=0)break;const t=Math.min(e.quantity,s),n=await c(e.id,t);if(a.push(n),!n.success)throw new Error(n.message||"\uc544\uc774\ud15c \uc0ac\uc6a9\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4 (".concat(e.id,")"));s-=t}if(s>0)throw new Error("\uc694\uccad\ud55c \uc218\ub7c9\uc744 \ubaa8\ub450 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. (\ubd80\uc871\ud55c \uc218\ub7c9: ".concat(s,")"));f("success","".concat(e.displayInfo.name," ").concat(t,"\uac1c\ub97c \uc0ac\uc6a9\ud588\uc2b5\ub2c8\ub2e4.")),O(),j(t=>(0,l.A)((0,l.A)({},t),{},{[e.displayInfo.itemId]:{usedTimestamp:Date.now(),itemDetails:{name:e.displayInfo.name,icon:e.displayInfo.icon,durationMs:e.displayInfo.durationMs||ps}}}))}catch(s){f("error","\uc544\uc774\ud15c \uc0ac\uc6a9 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(s.message))}},className:"button-primary",children:"\uc0ac\uc6a9\ud558\uae30"})]})]})}),N.isOpen&&B&&(0,L.jsx)("div",{className:"myitems-modal-overlay",onClick:e=>{e.target===e.currentTarget&&_()},children:(0,L.jsxs)("div",{className:"myitems-modal-container",children:[(0,L.jsxs)("div",{className:"myitems-modal-header",children:[(0,L.jsxs)("h3",{children:[B.displayInfo.name||"\uc544\uc774\ud15c"," \uc120\ubb3c\ud558\uae30"]}),(0,L.jsx)("button",{onClick:_,className:"myitems-close-button",children:"\u2715"})]}),(0,L.jsxs)("div",{className:"myitems-modal-body",children:[(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{htmlFor:"giftRecipient",children:"\uc120\ubb3c \ubc1b\uc744 \uce5c\uad6c:"}),(0,L.jsxs)("select",{id:"giftRecipient",value:k,onChange:e=>S(e.target.value),className:"form-select",children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"-- \uce5c\uad6c\ub97c \uc120\ud0dd\ud558\uc138\uc694 --"}),r.map(e=>(0,L.jsxs)("option",{value:e.uid||e.id,children:[e.name," (",e.nickname,")"]},e.uid||e.id))]})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsxs)("label",{htmlFor:"giftQuantity",children:["\uc120\ubb3c\ud560 \uc218\ub7c9: (\ucd5c\ub300 ",B.totalQuantity,"\uac1c)"]}),(0,L.jsxs)("div",{className:"quantity-controls",children:[(0,L.jsx)("button",{onClick:()=>I(e=>Math.max(1,e-1)),disabled:A<=1,children:"-"}),(0,L.jsx)("input",{id:"giftQuantity",type:"number",min:"1",max:B.totalQuantity,value:A,onChange:e=>I(Math.max(1,Math.min(B.totalQuantity,parseInt(e.target.value)||1)))}),(0,L.jsx)("button",{onClick:()=>I(e=>Math.min(B.totalQuantity,e+1)),disabled:A>=B.totalQuantity,children:"+"})]})]})]}),(0,L.jsxs)("div",{className:"myitems-modal-footer",children:[(0,L.jsx)("button",{onClick:_,className:"button-secondary",children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{if(E)return;const{item:s}=N;if(!e||!k||!s)return console.error("[MyItems] \uc120\ubb3c \uc815\ubcf4 \uc624\ub958:",{user:!!e,giftRecipientUid:k,group:!!s}),void f("error","\uc120\ubb3c \uc815\ubcf4\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");const a=Number(A)||1;if(a<=0||a>s.totalQuantity)return console.error("[MyItems] \uc120\ubb3c \uc218\ub7c9 \uc624\ub958:",{quantity:a,totalQuantity:s.totalQuantity}),void f("error","\uc120\ubb3c \uc218\ub7c9\uc774 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");const n=r.find(e=>(e.uid||e.id)===k),i=n?n.name:"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790";let o;console.log("[MyItems] \uc120\ubb3c \uc2dc\uc791:",{"\uc544\uc774\ud15c":s.displayInfo.name,"\uc218\ub7c9":a,"\ubcf4\ub0b4\ub294\uc0ac\ub78c":(null===t||void 0===t?void 0:t.name)||e.uid,"\ubc1b\ub294\uc0ac\ub78c":i,"\ubc1b\ub294\uc0ac\ub78cUID":k}),T(!0);try{const t=(0,G.rJ)(G.db,"users",e.uid,"inventory"),n=await(0,G.GG)(t),r=n.docs.map(e=>({id:e.id,itemId:e.data().itemId,name:e.data().name,quantity:e.data().quantity}));console.log("[MyItems] \ud83d\udd0d \uc2e4\uc81c inventory \uceec\ub809\uc158 \uc804\uccb4 \uc870\ud68c:"),console.log("\ucd1d\ubb38\uc11c\uc218:",n.size),console.log("\ubb38\uc11c\ub4e4:",r);const c={};r.forEach(e=>{const t=e.itemId||e.id;c[t]||(c[t]=[]),c[t].push(e.id)}),console.log("[MyItems] itemId\ubcc4 \uadf8\ub8f9:",c);const p=s.sourceDocs.map(e=>e.id);console.log("[MyItems] \uce90\uc2dc\ub41c \ubb38\uc11c ID \ubaa9\ub85d:",p);const x=[];let h=0;for(const s of p){const t=(0,G.EW)(G.db,"users",e.uid,"inventory",s),a=await(0,G.x7)(t);if(a.exists()){const e=a.data();x.push((0,l.A)({id:a.id},e)),h+=e.quantity||0,console.log("[MyItems] \u2705 \ubb38\uc11c \ubc1c\uacac:",{id:a.id,quantity:e.quantity})}else console.warn("[MyItems] \u26a0\ufe0f \ubb38\uc11c \uc5c6\uc74c:",s)}if(console.log("[MyItems] \ubcf4\ub0b4\ub294 \uc0ac\ub78c \uc778\ubca4\ud1a0\ub9ac \uc2e4\uc81c \uc870\ud68c \uc644\ub8cc:",{"\uce90\uc2dc\ubb38\uc11c\uc218":s.sourceDocs.length,"\uc2e4\uc81c\ubb38\uc11c\uc218":x.length,"\uc2e4\uc81c\ucd1d\uc218\ub7c9":h}),0===x.length)throw new Error("\ubcf4\uc720 \uc911\uc778 \uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ud398\uc774\uc9c0\ub97c \uc0c8\ub85c\uace0\uce68\ud574\uc8fc\uc138\uc694.");if(h<a)throw new Error("\uc544\uc774\ud15c \uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(a,", \uc2e4\uc81c \ubcf4\uc720: ").concat(h,")"));const g=(0,G.rJ)(G.db,"users",k,"inventory"),b=(0,G.P)(g,(0,G._M)("itemId","==",s.displayInfo.itemId)),y=await(0,G.GG)(b),j=y.empty?null:y.docs[0].ref;console.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c \uc778\ubca4\ud1a0\ub9ac \uc870\ud68c (\ud2b8\ub79c\uc7ad\uc158 \uc678\ubd80):",{"\uae30\uc874\uc544\uc774\ud15c\uc874\uc7ac":!y.empty,"\ubb38\uc11c\uc218":y.size}),o=[...d];const v=[];let w=a;for(const e of d)if(e.itemId===s.displayInfo.itemId&&w>0){const t=Math.min(e.quantity,w),s=e.quantity-t;s>0&&v.push((0,l.A)((0,l.A)({},e),{},{quantity:s})),w-=t}else v.push(e);m&&m(v),await(0,G.c4)(G.db,async t=>{const n=[];for(const s of x){const a=(0,G.EW)(G.db,"users",e.uid,"inventory",s.id),i=await t.get(a);if(!i.exists())throw console.error("[MyItems] \u274c \ud2b8\ub79c\uc7ad\uc158 \uc911 \uc544\uc774\ud15c \ubb38\uc11c\uac00 \uc0ac\ub77c\uc9d0:",s.id),new Error("\ud2b8\ub79c\uc7ad\uc158 \uc911 \uc544\uc774\ud15c\uc774 \uc0ac\ub77c\uc84c\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");const o=i.data().quantity||0;if(o<=0)throw console.error("[MyItems] \u274c \ud2b8\ub79c\uc7ad\uc158 \uc911 \uc544\uc774\ud15c \uc218\ub7c9\uc774 0:",s.id),new Error("\ud2b8\ub79c\uc7ad\uc158 \uc911 \uc544\uc774\ud15c \uc218\ub7c9\uc774 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");n.push({ref:a,snap:i,quantity:o})}let i=null,o=0;if(j){i=j;const e=await t.get(i);e.exists()?(o=e.data().quantity||0,console.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c \uae30\uc874 \uc544\uc774\ud15c \ubc1c\uacac:",{"\ubb38\uc11cID":i.id,"\ud604\uc7ac\uc218\ub7c9":o})):(console.warn("[MyItems] \u26a0\ufe0f \ubc1b\ub294 \uc0ac\ub78c\uc758 \uae30\uc874 \uc544\uc774\ud15c\uc774 \uc0ac\ub77c\uc9d0, \uc0c8\ub85c \uc0dd\uc131\ud569\ub2c8\ub2e4."),i=null)}else console.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c\uc5d0\uac8c \uc0c8 \uc544\uc774\ud15c \uc0dd\uc131 \uc608\uc815");let l=a,r=0;for(const{ref:e,quantity:s}of n){if(l<=0)break;const a=Math.min(s,l),n=s-a;console.log("[MyItems] \uc544\uc774\ud15c \ucc28\uac10:",{"\ubb38\uc11cID":e.id,"\uae30\uc874\uc218\ub7c9":s,"\ucc28\uac10\uc218\ub7c9":a,"\ub0a8\uc740\uc218\ub7c9":n}),n<=0?t.delete(e):t.update(e,{quantity:n}),l-=a,r+=a}if(r<a)throw console.error("[MyItems] \ucc98\ub9ac\ub41c \uc218\ub7c9 \ubd80\uc871:",{"\uc694\uccad":a,"\ucc98\ub9ac\ub428":r}),new Error("\uc544\uc774\ud15c \uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(a,", \uc2e4\uc81c \ubcf4\uc720: ").concat(r,")"));if(i)console.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c \uc544\uc774\ud15c \uc5c5\ub370\uc774\ud2b8 (\uae30\uc874 \uc544\uc774\ud15c\uc5d0 \ucd94\uac00):",{"\uae30\uc874\uc218\ub7c9":o,"\ucd94\uac00\uc218\ub7c9":r,"\ucd5c\uc885\uc218\ub7c9":o+r}),t.update(i,{quantity:o+r,updatedAt:(0,G.O5)()});else{console.log("[MyItems] \ubc1b\ub294 \uc0ac\ub78c \uc544\uc774\ud15c \uc0dd\uc131 (\uc0c8 \uc544\uc774\ud15c):",{"\uc218\ub7c9":r});const e=(0,G.EW)(g);t.set(e,{itemId:s.displayInfo.itemId,name:s.displayInfo.name,icon:s.displayInfo.icon,description:s.displayInfo.description,type:s.displayInfo.type,quantity:r,receivedAt:(0,G.O5)(),updatedAt:(0,G.O5)()})}}),console.log("[MyItems] \u2705 \uc120\ubb3c \ud2b8\ub79c\uc7ad\uc158 \uc644\ub8cc"),f("success","".concat(i,"\ub2d8\uc5d0\uac8c ").concat(s.displayInfo.name," ").concat(a,"\uac1c\ub97c \uc120\ubb3c\ud588\uc2b5\ub2c8\ub2e4.")),_(),setTimeout(()=>{u&&u()},2e3)}catch(c){if(console.error("[MyItems] \uc120\ubb3c\ud558\uae30 \uc2e4\ud328:",c),m&&o&&(console.log("[MyItems] \ub099\uad00\uc801 \uc5c5\ub370\uc774\ud2b8 \ub864\ubc31 - \uc6d0\ub798 \uc0c1\ud0dc\ub85c \ubcf5\uc6d0"),m(o)),f("error","\uc120\ubb3c\ud558\uae30 \uc2e4\ud328: ".concat(c.message)),u){console.log("[MyItems] \ub370\uc774\ud130 \uc0c8\ub85c\uace0\uce68 \uc2dc\uc791");try{const e=u();e&&"function"===typeof e.then&&await e,console.log("[MyItems] \ub370\uc774\ud130 \uc0c8\ub85c\uace0\uce68 \uc644\ub8cc")}catch(p){console.error("[MyItems] \ub370\uc774\ud130 \uc0c8\ub85c\uace0\uce68 \uc2e4\ud328:",p)}}}finally{T(!1)}},className:"button-primary",disabled:E||M,children:E?"\uc120\ubb3c\ud558\ub294 \uc911...":M?"\ub3d9\uae30\ud654 \uc911...":"\uc120\ubb3c\ud558\uae30"})]})]})}),R.isOpen&&R.item&&(0,L.jsx)("div",{className:"myitems-modal-overlay",onClick:e=>{e.target===e.currentTarget&&W()},children:(0,L.jsxs)("div",{className:"myitems-modal-container",children:[(0,L.jsxs)("div",{className:"myitems-modal-header",children:[(0,L.jsxs)("h3",{children:["'",R.item.displayInfo.name,"' \uc2dc\uc7a5\uc5d0 \ud310\ub9e4\ud558\uae30"]}),(0,L.jsx)("button",{onClick:W,className:"myitems-close-button",children:"\u2715"})]}),(0,L.jsxs)("div",{className:"myitems-modal-body",children:[(0,L.jsxs)("div",{className:"item-preview-simple",children:[(0,L.jsx)("span",{className:"item-icon-small",children:R.item.displayInfo.icon}),(0,L.jsxs)("span",{children:[R.item.displayInfo.name," (\ubcf4\uc720: ",R.item.totalQuantity,"\uac1c)"]})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsxs)("label",{htmlFor:"sellToMarketQuantity",children:["\ud310\ub9e4 \uc218\ub7c9 (\ucd5c\ub300: ",R.item.totalQuantity,"\uac1c):"]}),(0,L.jsx)("input",{type:"number",id:"sellToMarketQuantity",value:R.quantity,onChange:e=>(e=>{var t;const s=(null===(t=R.item)||void 0===t?void 0:t.totalQuantity)||1,a=Math.max(1,Math.min(s,parseInt(e)||1));z(e=>(0,l.A)((0,l.A)({},e),{},{quantity:a}))})(e.target.value),min:"1",max:R.item.totalQuantity})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{htmlFor:"sellToMarketPrice",children:"\uac1c\ub2f9 \ud310\ub9e4 \uac00\uaca9 (\uc6d0):"}),(0,L.jsx)("input",{type:"number",id:"sellToMarketPrice",value:R.price,onChange:e=>(e=>{const t=Math.max(1,parseInt(e)||1);z(e=>(0,l.A)((0,l.A)({},e),{},{price:t}))})(e.target.value),min:"1"})]}),(0,L.jsxs)("div",{className:"total-price-preview",children:["\uc608\uc0c1 \ud310\ub9e4 \ucd1d\uc561: ",(0,L.jsxs)("strong",{children:[(R.price*R.quantity).toLocaleString(),"\uc6d0"]})]})]}),(0,L.jsxs)("div",{className:"myitems-modal-footer",children:[(0,L.jsx)("button",{onClick:W,className:"button-secondary",children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{const{item:t,quantity:s,price:a}=R;if(t&&s&&a)try{const n=t.sourceDocs.map(e=>e.id),i=[];let o=0;for(const t of n){const s=(0,G.EW)(G.db,"users",e.uid,"inventory",t),a=await(0,G.x7)(s);if(a.exists()){const e=a.data();i.push((0,l.A)({id:a.id},e)),o+=e.quantity||0}}if(console.log("[MyItems] \uc2dc\uc7a5\uc5d0 \ud314\uae30 - \uc2e4\uc81c \uc870\ud68c:",{"\uc694\uccad\uc218\ub7c9":s,"\uc2e4\uc81c\ubcf4\uc720":o,"\ubb38\uc11c\uc218":i.length}),0===i.length)throw new Error("\ud310\ub9e4\ud560 \uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ud398\uc774\uc9c0\ub97c \uc0c8\ub85c\uace0\uce68\ud574\uc8fc\uc138\uc694.");if(o<s)throw new Error("\uc544\uc774\ud15c \uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(s,", \uc2e4\uc81c \ubcf4\uc720: ").concat(o,")"));let r=s;const d=[...i].sort((e,t)=>e.quantity-t.quantity);for(const t of d){if(r<=0)break;const s=Math.min(t.quantity,r),n={};if(void 0===t.description&&(console.warn("[MyItems] \ub204\ub77d\ub41c description \ud544\ub4dc \uc218\uc815: ".concat(t.id)),n.description=""),void 0===t.icon&&(console.warn("[MyItems] \ub204\ub77d\ub41c icon \ud544\ub4dc \uc218\uc815: ".concat(t.id)),n.icon="\ud83d\udd2e"),void 0===t.type&&(console.warn("[MyItems] \ub204\ub77d\ub41c type \ud544\ub4dc \uc218\uc815: ".concat(t.id)),n.type="general"),Object.keys(n).length>0){const s=(0,G.EW)(G.db,"users",e.uid,"inventory",t.id);await(0,G.mZ)(s,n),Object.assign(t,n)}const i=await p({itemId:t.id,quantity:s,price:a});if(!i.success)throw new Error(i.message||"\uc77c\ubd80 \uc544\uc774\ud15c \ud310\ub9e4 \ub4f1\ub85d\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");r-=s}f("success","".concat(t.displayInfo.name," ").concat(s,"\uac1c\ub97c \uc2dc\uc7a5\uc5d0 \ud310\ub9e4 \ub4f1\ub85d\ud588\uc2b5\ub2c8\ub2e4.")),W(),setTimeout(()=>{window.confirm("\uc544\uc774\ud15c \uc2dc\uc7a5\uc73c\ub85c \uc774\ub3d9\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&x("/item-market")},500)}catch(n){console.error("[MyItems] \uc2dc\uc7a5 \ud310\ub9e4 \ub4f1\ub85d \uc2e4\ud328:",n),n.message.includes("\uc544\uc774\ud15c\uc744 \ucc3e\uc744 \uc218 \uc5c6")||n.message.includes("\uc218\ub7c9\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4")?(f("warning","\uc544\uc774\ud15c \uc815\ubcf4\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub370\uc774\ud130\ub97c \ub3d9\uae30\ud654\ud569\ub2c8\ub2e4."),D(!0),u?u().then(()=>{f("success","\ub3d9\uae30\ud654\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."),D(!1)}).catch(e=>{console.error("[MyItems] \ub370\uc774\ud130 \ub3d9\uae30\ud654 \uc2e4\ud328:",e),f("error","\ub370\uc774\ud130 \ub3d9\uae30\ud654\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."),D(!1)}):(f("error","\uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc73c\uba70 \ub370\uc774\ud130\ub97c \uc0c8\ub85c\uace0\uce60 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4: ".concat(n.message)),D(!1))):f("error","\uc2dc\uc7a5 \ud310\ub9e4 \ub4f1\ub85d \uc911 \uc624\ub958: ".concat(n.message))}else f("error","\ud310\ub9e4 \uc815\ubcf4\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.")},className:"button-primary sell-button",disabled:M,children:M?"\ub3d9\uae30\ud654 \uc911...":"\ud310\ub9e4 \ub4f1\ub85d"})]})]})})]})},hs=a.memo(xs);var gs=s(9270);function fs(){const{user:e,userDoc:t,users:s,classmates:n,allClassMembers:o,loading:r,updateUser:d,addCashToUserById:c,deductCash:p,optimisticUpdate:u}=(0,i.As)(),m=null===e||void 0===e?void 0:e.uid,x=(null===t||void 0===t?void 0:t.name)||(null===t||void 0===t?void 0:t.nickname)||(null===e||void 0===e?void 0:e.displayName)||"\uc0ac\uc6a9\uc790",h=null===t||void 0===t?void 0:t.classCode,[g,f]=(0,a.useState)(!0),b=(0,a.useRef)(!1),[y,j]=((0,a.useRef)({}),(0,a.useState)(0)),[v,w]=(0,a.useState)([]),[N,C]=(0,a.useState)([]),[k,S]=(0,a.useState)([]),[A,I]=(0,a.useState)([]),[E,T]=(0,a.useState)(0),[M,D]=(0,a.useState)([]),[R,z]=(0,a.useState)([]),[O,_]=(0,a.useState)(0),W=((0,G.Qg)(G.Cn,"getUserAssetsData"),(0,G.Qg)(G.Cn,"sellCoupon"),(0,G.Qg)(G.Cn,"giftCoupon"),36e5),B=h?"".concat(h,"_goal"):null,[P,F]=(0,a.useState)(1e3),[q,U]=(0,a.useState)(1e3);(0,a.useEffect)(()=>{m&&(async()=>{try{const e=(0,G.H9)(G.db,"settings","mainSettings"),t=await(0,G.x7)(e);if(t.exists()){const e=t.data();e.couponValue&&U(Number(e.couponValue))}}catch(e){console.error("[MyAssets] \ucfe0\ud3f0 \uac00\uce58 \uc124\uc815 \ub85c\ub4dc \uc2e4\ud328:",e)}})()},[m]);const[Q,H]=(0,a.useState)(0),[J,V]=(0,a.useState)(0),[K,X]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)(!1),[$,te]=(0,a.useState)(!1),[se,ae]=(0,a.useState)(!1),[ne,ie]=(0,a.useState)(""),[oe,le]=(0,a.useState)(!1),[re,de]=(0,a.useState)(""),[ce,pe]=(0,a.useState)(""),[ue,me]=(0,a.useState)(!1),[xe,he]=(0,a.useState)(!1),[ge,fe]=(0,a.useState)(""),[be,ye]=(0,a.useState)(""),[je,ve]=(0,a.useState)(!1),we=e=>{try{const t=localStorage.getItem("firestore_cache_".concat(e,"_").concat(m));if(t){const{data:e,timestamp:s}=JSON.parse(t);if(Date.now()-s<W)return e}}catch(t){}return null},Ne=(e,t)=>{try{const s={data:t,timestamp:Date.now()};localStorage.setItem("firestore_cache_".concat(e,"_").concat(m),JSON.stringify(s))}catch(s){}},Ce=(0,a.useCallback)(async(e,t)=>{try{const s=(0,G.H9)(G.db,"goals",t),a={classCode:e,targetAmount:1e3,progress:0,donations:[],donationCount:0,title:"".concat(e," \ud559\uae09 \ubaa9\ud45c"),description:"".concat(e," \ud559\uae09\uc758 \ucfe0\ud3f0 \ubaa9\ud45c\uc785\ub2c8\ub2e4."),createdAt:(0,G.O5)(),updatedAt:(0,G.O5)(),createdBy:m};await(0,ee.c4)(G.db,async e=>{const n=await e.get(s);if(n.exists()){const e=n.data();Ne("goal_".concat(t),e)}else e.set(s,a),Ne("goal_".concat(t),a)})}catch(s){throw s}},[m]),ke=(0,a.useCallback)(async()=>{if(!B||!h)return;const e="goal_".concat(B),t=we(e);if(t){F(Number(t.targetAmount)||1e3),H(Number(t.progress)||0);const e=Array.isArray(t.donations)?t.donations:[];D(e);const s=e.filter(e=>e.userId===m).reduce((e,t)=>e+t.amount,0);return void V(s)}try{const t=(0,G.H9)(G.db,"goals",B),s=await(0,G.x7)(t);if(s.exists()){const t=s.data();F(Number(t.targetAmount)||1e3),H(Number(t.progress)||0);const a=Array.isArray(t.donations)?t.donations.map(e=>{let t;return t=e.timestamp&&e.timestamp.toDate?e.timestamp.toDate().toISOString():e.timestamp&&e.timestamp.seconds?new Date(1e3*e.timestamp.seconds).toISOString():e.timestampISO?e.timestampISO:"string"===typeof e.timestamp?e.timestamp:(new Date).toISOString(),(0,l.A)((0,l.A)({},e),{},{amount:Number(e.amount)||0,timestamp:t,userId:e.userId||"",userName:e.userName||"\uc54c \uc218 \uc5c6\ub294 \uc0ac\uc6a9\uc790",message:e.message||"",classCode:e.classCode||h})}):[];D(a);const n=a.filter(e=>e.userId===m).reduce((e,t)=>e+t.amount,0);V(n),Ne(e,t)}else console.log("[MyAssets] \ubaa9\ud45c \ubb38\uc11c\uac00 \uc5c6\uc5b4 \uae30\ubcf8\uac12 \uc0dd\uc131"),await Ce(h,B)}catch(s){console.error("[MyAssets] \ubaa9\ud45c \ub370\uc774\ud130 \ub85c\ub4dc \uc2e4\ud328:",s)}},[B,h,m,Ce,we,Ne]),Se=(0,a.useCallback)(async()=>{if(m&&G.db)if(b.current)console.log("[MyAssets] \u23f8\ufe0f \uc774\ubbf8 \ub85c\ub529 \uc911\uc774\ubbc0\ub85c \uc911\ubcf5 \uc2e4\ud589 \ubc29\uc9c0");else{b.current=!0,f(!0);try{const s=(0,G.P)((0,G.rJ)(G.db,"classes",h,"realEstateProperties"),(0,G._M)("owner","==",m),(0,ee.AB)(50)),a=(0,G.P)((0,G.rJ)(G.db,"ClassStock",h,"students",m,"realestates"),(0,ee.AB)(50)),n=(0,G.P)((0,G.rJ)(G.db,"realEstate"),(0,G._M)("ownerId","==",m),(0,ee.AB)(50)),[i,o,r]=await Promise.all([(0,G.GG)(s),(0,G.GG)(a),(0,G.GG)(n)]),d=[];i.forEach(e=>d.push((0,l.A)({id:e.id},e.data()))),o.forEach(e=>d.push((0,l.A)({id:e.id},e.data()))),r.forEach(e=>d.push((0,l.A)({id:e.id},e.data())));const c=(0,G.H9)(G.db,"users",m,"financials","parkingAccount"),p=(0,G.rJ)(G.db,"ClassStock",h,"students",m,"parkingAccounts"),[u,x]=await Promise.all([(0,G.x7)(c),(0,G.GG)(p)]);let g=0;u.exists()&&(g+=u.data().balance||0),x.forEach(e=>{g+=e.data().balance||0}),j(g);const f=(0,G.P)((0,G.rJ)(G.db,"users",m,"products"),(0,ee.AB)(50)),b=await(0,G.GG)(f),y=[],v=[],N=[];b.forEach(e=>{var t;const s=(0,l.A)((0,l.A)({id:e.id},e.data()),{},{maturityDate:null!==(t=e.data().maturityDate)&&void 0!==t&&t.toDate?e.data().maturityDate.toDate():e.data().maturityDate});"deposit"===s.type?y.push(s):"savings"===s.type?v.push(s):"loan"===s.type&&N.push(s)}),w(y),C(v),S(N),I(d);let k=[],A=[];try{const e=(0,G.P)((0,G.rJ)(G.db,"activity_logs"),(0,G._M)("classCode","==",h),(0,G._M)("userId","==",m),(0,ee.AB)(30));k=(await(0,G.GG)(e)).docs.map(e=>{const t=e.data();return{id:e.id,amount:t.amount||0,description:t.description||t.type||"\uac70\ub798 \ub0b4\uc5ed",timestamp:t.timestamp,type:t.type,couponAmount:t.couponAmount||0,source:"activity_logs"}}).filter(e=>0!==e.amount||0!==e.couponAmount)}catch(e){console.log("[MyAssets] activity_logs \uc870\ud68c \uc2e4\ud328:",e)}try{const e=(0,G.P)((0,G.rJ)(G.db,"users",m,"transactions"),(0,ee.AB)(30));A=(await(0,G.GG)(e)).docs.map(e=>{const t=e.data();return{id:e.id,amount:t.amount||0,description:t.description||"\uac70\ub798 \ub0b4\uc5ed",timestamp:t.timestamp||t.createdAt,type:t.type||"transaction",source:"transactions"}}).filter(e=>0!==e.amount)}catch(t){console.log("[MyAssets] transactions \uc870\ud68c \uc2e4\ud328:",t)}const E=[...k,...A];E.sort((e,t)=>{var s,a,n,i;const o=null!==(s=e.timestamp)&&void 0!==s&&s.toDate?e.timestamp.toDate():new Date(1e3*(null===(a=e.timestamp)||void 0===a?void 0:a.seconds)||0);return(null!==(n=t.timestamp)&&void 0!==n&&n.toDate?t.timestamp.toDate():new Date(1e3*(null===(i=t.timestamp)||void 0===i?void 0:i.seconds)||0))-o}),z(E.slice(0,20))}catch(s){console.error("[MyAssets] \ud83d\udea8 \ud074\ub77c\uc774\uc5b8\ud2b8 \uce21 \uc9c1\uc811 \uc870\ud68c \uc2e4\ud328:",s)}finally{f(!1),b.current=!1}}else f(!1)},[m,h]);(0,a.useEffect)(()=>{!r&&e?Se():r||e?r&&f(!0):(f(!1),j(0),S([]),I([]),T(0),V(0),F(1e3),H(0),U(1e3),D([]),z([]))},[r,e]),(0,a.useEffect)(()=>{const e=Number(null===t||void 0===t?void 0:t.cash)||0,s=(Number(null===t||void 0===t?void 0:t.coupons)||0)*Number(q),a=A.reduce((e,t)=>e+(Number(t.price)||0),0),n=v.reduce((e,t)=>e+(Number(t.balance)||0),0),i=N.reduce((e,t)=>e+(Number(t.balance)||0),0),o=k.reduce((e,t)=>e+(Number(t.remainingPrincipal)||Number(t.balance)||0),0),l=e+s+Number(y)+n+i+a-o;T(l)},[null===t||void 0===t?void 0:t.cash,null===t||void 0===t?void 0:t.coupons,q,y,v,N,A,k]),(0,a.useEffect)(()=>{X(Q>=P&&P>0)},[Q,P]),(0,a.useEffect)(()=>{e&&B&&ke()},[e,B]);const Ae=()=>{const e="myAssets_".concat(m);localStorage.removeItem("firestore_cache_".concat(e,"_").concat(m)),console.log("[MyAssets] \ud83d\udd04 \uce90\uc2dc \uc0ad\uc81c \ubc0f \uac15\uc81c \uc0c8\ub85c\uace0\uce68"),Se()};return r||g?(0,L.jsx)(wa,{}):e?t||r?h||r?(0,L.jsx)("div",{className:"w-full min-h-full",style:{backgroundColor:"#0a0a12"},children:(0,L.jsxs)("div",{className:"w-full px-4 md:px-6 lg:px-8 py-6",children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,L.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",color:"#00fff2",borderBottom:"2px solid rgba(0, 255, 242, 0.2)",paddingBottom:"10px",margin:0,textShadow:"0 0 10px rgba(0, 255, 242, 0.3)"},children:"\ub098\uc758 \uc790\uc0b0 \ud604\ud669 \ud83d\udcb3"}),(0,L.jsx)("button",{onClick:Ae,disabled:g,style:{padding:"8px 16px",backgroundColor:"rgba(0, 255, 242, 0.1)",color:"#00fff2",border:"1px solid rgba(0, 255, 242, 0.3)",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:g?"not-allowed":"pointer",opacity:g?.6:1,transition:"all 0.2s ease"},children:"\ud83d\udd04 \uc0c8\ub85c\uace0\uce68"})]}),(0,L.jsx)(Jt,{userId:m,onClaim:async e=>{try{const s=(0,G.H9)(G.db,"users",m);await(0,G.BN)(s,{cash:(0,G.GV)(e),updatedAt:(0,G.O5)()},{merge:!0}),await(0,gs.Mx)(G.db,{userId:m,userName:x,classCode:h,type:"\uc77c\uc77c \ucd9c\uc11d \ubcf4\uc0c1",description:"\uc77c\uc77c \ucd9c\uc11d \ubcf4\uc0c1\uc73c\ub85c ".concat(e.toLocaleString(),"\uc6d0 \ud68d\ub4dd"),amount:e,metadata:{rewardType:"daily_streak"}}),u&&u({cash:((null===t||void 0===t?void 0:t.cash)||0)+e}),console.log("Daily reward claimed and added: ".concat(e))}catch(s){console.error("\uc77c\uc77c \ubcf4\uc0c1 \uc9c0\uae09 \uc624\ub958:",s),alert("\ubcf4\uc0c1 \uc9c0\uae09 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")}}}),(()=>{const e=Number(null===t||void 0===t?void 0:t.cash)||0,s=Number(null===t||void 0===t?void 0:t.coupons)||0,a=je?R:R.slice(0,5);return(0,L.jsxs)("div",{style:{padding:"0",background:"transparent",marginBottom:"25px"},children:[(0,L.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"20px",padding:"30px",marginBottom:"20px",boxShadow:"0 10px 30px rgba(102, 126, 234, 0.3)",border:"none"},children:[(0,L.jsx)("div",{style:{marginBottom:"10px"},children:(0,L.jsx)("span",{style:{color:"rgba(255,255,255,0.9)",fontSize:"16px",fontWeight:"500"},children:"\ud83d\udcb0 \ubcf4\uc720 \ud604\uae08"})}),(0,L.jsxs)("div",{style:{fontSize:"42px",fontWeight:"800",color:"#ffffff",letterSpacing:"-1px",marginBottom:"15px",textAlign:"right"},children:[e.toLocaleString()," ",(0,L.jsx)("span",{style:{fontSize:"28px",fontWeight:"600"},children:"\uc6d0"})]}),(0,L.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,L.jsx)("button",{onClick:()=>he(!0),style:{padding:"14px 28px",backgroundColor:"rgba(255, 255, 255, 0.95)",color:"#667eea",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:"700",cursor:"pointer",boxShadow:"0 4px 15px rgba(0,0,0,0.1)",transition:"all 0.3s ease"},disabled:g||r,onMouseOver:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 20px rgba(0,0,0,0.15)"},onMouseOut:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 15px rgba(0,0,0,0.1)"},children:"\ud83d\udcb8 \uc1a1\uae08\ud558\uae30"})})]}),(0,L.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,L.jsx)("h4",{style:{fontSize:"15px",color:"#e8e8ff",fontWeight:"700",marginBottom:"12px"},children:"\ud83d\udcb3 \ucd5c\uadfc \uc785\ucd9c\uae08 \ub0b4\uc5ed"}),R.length>0?(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:a.map(e=>{let t="\ub0a0\uc9dc \uc5c6\uc74c";try{t=(e=>{try{if(!e)return new Date;if(e instanceof Date)return isNaN(e.getTime())?new Date:e;if(e&&"function"===typeof e.toDate){const t=e.toDate();return isNaN(t.getTime())?new Date:t}if(e&&e.seconds){const t=new Date(1e3*e.seconds);return isNaN(t.getTime())?new Date:t}if("string"===typeof e){const t=new Date(e);return isNaN(t.getTime())?new Date:t}if("number"===typeof e){const t=new Date(e);return isNaN(t.getTime())?new Date:t}return new Date}catch(t){return new Date}})(e.timestamp).toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit"})}catch(n){t="\uc624\ub298"}const s=Number(e.amount)||0,a=String(e.description)||"\ub0b4\uc5ed \uc5c6\uc74c";return(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"14px",color:"#a0a0c0",padding:"14px 16px",backgroundColor:s>0?"rgba(5, 150, 105, 0.1)":"rgba(220, 38, 38, 0.1)",border:s>0?"1px solid rgba(5, 150, 105, 0.3)":"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"10px"},children:[(0,L.jsxs)("span",{style:{flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginRight:"10px",fontWeight:"500",color:"#e8e8ff"},children:[t," \u2022 ",a]}),(0,L.jsxs)("span",{style:{fontWeight:"700",fontSize:"15px",color:s>0?"#34d399":"#f87171",minWidth:"110px",textAlign:"right"},children:[s>0?"+":"",s.toLocaleString(),"\uc6d0"]})]},e.id||Math.random())})}),R.length>5&&(0,L.jsx)("button",{onClick:()=>ve(!je),style:{width:"100%",marginTop:"12px",padding:"12px",backgroundColor:"rgba(255, 255, 255, 0.05)",color:"#a0a0c0",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"10px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>{e.target.style.backgroundColor="#f3f4f6"},onMouseOut:e=>{e.target.style.backgroundColor="#f9fafb"},children:je?"\u25b2 \uc811\uae30":"\u25bc ".concat(R.length-5,"\uac1c \ub354 \ubcf4\uae30")})]}):(0,L.jsx)("div",{style:{fontSize:"13px",color:"#6b7280",textAlign:"center",padding:"20px",backgroundColor:"rgba(255, 255, 255, 0.03)",borderRadius:"10px",border:"1px dashed rgba(255, 255, 255, 0.1)"},children:"\ucd5c\uadfc \uac70\ub798 \ub0b4\uc5ed\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,L.jsxs)("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",borderRadius:"20px",padding:"25px 30px",marginBottom:"20px",boxShadow:"0 10px 30px rgba(240, 147, 251, 0.3)",border:"none"},children:[(0,L.jsx)("div",{style:{marginBottom:"8px"},children:(0,L.jsx)("span",{style:{color:"rgba(255,255,255,0.9)",fontSize:"16px",fontWeight:"500"},children:"\ud83d\udcca \ucd1d \uc21c\uc790\uc0b0"})}),(0,L.jsxs)("div",{style:{fontSize:"38px",fontWeight:"800",color:"#ffffff",letterSpacing:"-1px",textAlign:"right"},children:[Number(E).toLocaleString()," ",(0,L.jsx)("span",{style:{fontSize:"24px",fontWeight:"600"},children:"\uc6d0"})]}),(0,L.jsx)("p",{style:{marginTop:"8px",fontSize:"12px",color:"rgba(255,255,255,0.8)",margin:"8px 0 0 0"},children:"\ud604\uae08 + \ucfe0\ud3f0\uac00\uce58 + \ud30c\ud0b9\ud1b5\uc7a5 + \uc608\uae08 + \uc801\uae08 + \ubd80\ub3d9\uc0b0 - \ub300\ucd9c"})]}),(0,L.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,L.jsx)("h4",{style:{fontSize:"15px",color:"#e8e8ff",fontWeight:"700",marginBottom:"12px"},children:"\ud83c\udd7f\ufe0f \ud30c\ud0b9\ud1b5\uc7a5"}),(0,L.jsx)("div",{style:{background:"linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)",borderRadius:"14px",padding:"20px",border:"none",boxShadow:"0 4px 15px rgba(6, 182, 212, 0.2)"},children:(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsx)("span",{style:{color:"rgba(255,255,255,0.9)",fontWeight:"500",fontSize:"14px"},children:"\uc794\uc561"}),(0,L.jsxs)("span",{style:{fontWeight:"800",fontSize:"26px",color:"#ffffff",letterSpacing:"-0.5px",textAlign:"right",display:"block"},children:[Number(y).toLocaleString(),(0,L.jsx)("span",{style:{fontSize:"18px",fontWeight:"600"},children:"\uc6d0"})]})]})}),(0,L.jsx)("p",{style:{marginTop:"10px",fontSize:"12px",color:"#9ca3af",textAlign:"center"},children:"\ud30c\ud0b9\ud1b5\uc7a5 \uba54\ub274\uc5d0\uc11c \uc785\ucd9c\uae08 \ubc0f \uc0c1\ud488 \uac00\uc785 \uac00\ub2a5"})]}),(0,L.jsx)("div",{style:{padding:"25px",background:"rgba(20, 20, 35, 0.4)",borderRadius:"16px",border:"1px solid rgba(0, 255, 242, 0.1)",boxShadow:"0 4px 12px rgba(0,0,0,0.2)"},children:(0,L.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,L.jsx)("h4",{style:{fontSize:"15px",color:"#374151",fontWeight:"700",marginBottom:"12px"},children:"\ud83c\udf9f\ufe0f \ubcf4\uc720 \ucfe0\ud3f0"}),(0,L.jsx)("div",{style:{background:"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)",borderRadius:"14px",padding:"20px",border:"none",boxShadow:"0 4px 15px rgba(251, 191, 36, 0.2)"},children:(0,L.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,L.jsxs)("div",{style:{width:"100%"},children:[(0,L.jsxs)("div",{style:{fontSize:"26px",fontWeight:"800",color:"#ffffff",letterSpacing:"-0.5px",textAlign:"right"},children:[s.toLocaleString()," ",(0,L.jsx)("span",{style:{fontSize:"18px",fontWeight:"600"},children:"\uac1c"})]}),(0,L.jsxs)("div",{style:{fontSize:"12px",color:"rgba(255,255,255,0.85)",fontWeight:"500",marginTop:"4px",textAlign:"right"},children:["1\ucfe0\ud3f0 = ",Number(q).toLocaleString(),"\uc6d0"]})]})})})]})})]})})(),xe&&(0,L.jsx)(wt,{showTransferModal:xe,setShowTransferModal:he,recipients:n,transferRecipient:ge,setTransferRecipient:fe,transferAmount:be,setTransferAmount:ye,handleTransfer:async()=>{f(!0);try{if(!t||!m||!G.db||!s||!p||!c)return void alert("\ud544\uc218 \uc815\ubcf4\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");const e=parseInt(be,10);if(isNaN(e)||e<=0)return void alert("\uc62c\ubc14\ub978 \uc1a1\uae08\uc561\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");if((Number(t.cash)||0)<e)return void alert("\ubcf4\uc720 \ud604\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");const a=s.find(e=>e.id===ge);if(!a)return void alert("\uc1a1\uae08 \ub300\uc0c1\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ubaa9\ub85d\uc744 \uc0c8\ub85c\uace0\uce68\ud558\uace0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");if(a.id===m)return void alert("\uc790\uae30 \uc790\uc2e0\uc5d0\uac8c\ub294 \uc1a1\uae08\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const n=a.name||a.nickname||"\uc0ac\uc6a9\uc790";if(await p(e,"".concat(n,"\ub2d8\uc5d0\uac8c \uc1a1\uae08"))){await c(a.id,e,"".concat(x,"\ub2d8\uc73c\ub85c\ubd80\ud130 \uc785\uae08"))?((0,gs.Mx)(G.db,{classCode:h,userId:m,userName:x,type:gs.gI.TRANSFER_SEND,description:"".concat(n,"\ub2d8\uc5d0\uac8c ").concat(e.toLocaleString(),"\uc6d0 \uc1a1\uae08"),amount:-e,metadata:{recipientId:a.id,recipientName:n}}),(0,gs.Mx)(G.db,{classCode:h,userId:a.id,userName:n,type:gs.gI.TRANSFER_RECEIVE,description:"".concat(x,"\ub2d8\uc73c\ub85c\ubd80\ud130 ").concat(e.toLocaleString(),"\uc6d0 \uc785\uae08"),amount:e,metadata:{senderId:m,senderName:x}}),alert("\uc1a1\uae08\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),he(!1),fe(""),ye("")):(alert("\ubc1b\ub294 \uc0ac\ub78c\uc5d0\uac8c \ud604\uae08\uc744 \uc804\ub2ec\ud558\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \uc1a1\uae08\uc774 \ucde8\uc18c\ub429\ub2c8\ub2e4."),await c(m,e,"\uc1a1\uae08 \uc2e4\ud328\ub85c \uc778\ud55c \ubcf5\uc6d0"))}else alert("\uacc4\uc88c\uc5d0\uc11c \ud604\uae08\uc744 \uc778\ucd9c\ud558\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(e){console.error("!!! \uc1a1\uae08 \ucc98\ub9ac \uc911 \uc608\uae30\uce58 \uc54a\uc740 \uc624\ub958 \ubc1c\uc0dd !!!",e),alert("\uc1a1\uae08 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(e.message)),u&&u({cash:parseInt(be,10)||0})}finally{f(!1)}},userId:m,userCash:Number(null===t||void 0===t?void 0:t.cash)||0})]})}):(0,L.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh",fontSize:"1.2em",color:"#ef4444"},children:"\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc5ec \ud559\uae09 \ucf54\ub4dc\ub97c \ud560\ub2f9\ubc1b\uc73c\uc138\uc694."}):(0,L.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh",fontSize:"1.2em",color:"#ef4444"},children:"\uc0ac\uc6a9\uc790 \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911\uc785\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4\uc5d0\ub3c4 \uc774 \uba54\uc2dc\uc9c0\uac00 \ubcf4\uc774\uba74 \uc571\uc744 \uc0c8\ub85c\uace0\uce68\ud558\uac70\ub098 \uc7ac\ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."}):(0,L.jsx)(os.A,{})}const bs=e=>null===e||void 0===e?"0\uc6d0":"".concat(Number(e).toLocaleString(),"\uc6d0"),ys=[{value:"food",label:"\uc74c\uc2dd/\uac04\uc2dd",icon:"\ud83c\udf54"},{value:"craft",label:"\uc218\uacf5\uc608/\ub9cc\ub4e4\uae30",icon:"\ud83c\udfa8"},{value:"digital",label:"\ub514\uc9c0\ud138/IT",icon:"\ud83d\udcbb"},{value:"education",label:"\uad50\uc721/\uacfc\uc678",icon:"\ud83d\udcda"},{value:"entertainment",label:"\uc5d4\ud130\ud14c\uc778\uba3c\ud2b8",icon:"\ud83c\udfae"},{value:"service",label:"\uc11c\ube44\uc2a4/\ub300\ud589",icon:"\ud83d\udee0\ufe0f"},{value:"other",label:"\uae30\ud0c0",icon:"\ud83d\udce6"}],js=[{value:"product",label:"\uc0c1\ud488",icon:"\ud83d\udce6",description:"\ubb3c\uac74\uc744 \ud310\ub9e4\ud569\ub2c8\ub2e4"},{value:"service",label:"\uc11c\ube44\uc2a4",icon:"\ud83d\udee0\ufe0f",description:"\uc11c\ube44\uc2a4\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4"}],vs=e=>{let{isOpen:t,onClose:s,shop:n,onSave:i}=e;const[o,r]=(0,a.useState)({shopName:"",description:"",category:"other"}),[d,c]=(0,a.useState)(!1);(0,a.useEffect)(()=>{r(n?{shopName:n.shopName||"",description:n.description||"",category:n.category||"other"}:{shopName:"",description:"",category:"other"})},[n,t]);return t?(0,L.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,L.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,L.jsxs)("div",{className:"modal-header",children:[(0,L.jsx)("h3",{children:n?"\uc0c1\uc810 \uc218\uc815":"\uc0c8 \uc0c1\uc810 \ub9cc\ub4e4\uae30"}),(0,L.jsx)("button",{className:"close-button",onClick:s,children:"\xd7"})]}),(0,L.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o.shopName.trim()){c(!0);try{await i(o),s()}catch(t){console.error("\uc0c1\uc810 \uc800\uc7a5 \uc624\ub958:",t),alert("\uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{c(!1)}}else alert("\uc0c1\uc810 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!")},className:"modal-content",children:[(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\uc0c1\uc810 \uc774\ub984 *"}),(0,L.jsx)("input",{type:"text",value:o.shopName,onChange:e=>r((0,l.A)((0,l.A)({},o),{},{shopName:e.target.value})),placeholder:"\uc608: \ubbfc\uc218\ub124 \uac04\uc2dd\uac00\uac8c",maxLength:20})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\uc5c5\uc885"}),(0,L.jsx)("select",{value:o.category,onChange:e=>r((0,l.A)((0,l.A)({},o),{},{category:e.target.value})),children:ys.map(e=>(0,L.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\uc0c1\uc810 \uc18c\uac1c"}),(0,L.jsx)("textarea",{value:o.description,onChange:e=>r((0,l.A)((0,l.A)({},o),{},{description:e.target.value})),placeholder:"\uc6b0\ub9ac \uac00\uac8c\ub97c \uc18c\uac1c\ud574\uc8fc\uc138\uc694!",rows:3,maxLength:100})]}),(0,L.jsxs)("div",{className:"modal-footer",children:[(0,L.jsx)("button",{type:"button",onClick:s,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,L.jsx)("button",{type:"submit",disabled:d,className:"modal-button confirm",children:d?"\uc800\uc7a5 \uc911...":n?"\uc218\uc815\ud558\uae30":"\ub9cc\ub4e4\uae30"})]})]})]})}):null},ws=e=>{let{isOpen:t,onClose:s,product:n,shopId:i,onSave:o}=e;const[r,d]=(0,a.useState)({type:"product",name:"",description:"",price:"",stock:""}),[c,p]=(0,a.useState)(!1),u=(0,a.useMemo)(()=>{const e=parseInt(r.price)||0;return Math.round(.1*e)},[r.price]),m=(0,a.useMemo)(()=>(parseInt(r.price)||0)+u,[r.price,u]);(0,a.useEffect)(()=>{var e;n?d({type:n.type||"product",name:n.name||"",description:n.description||"",price:(null===(e=n.price)||void 0===e?void 0:e.toString())||"",stock:n.stock>=0?n.stock.toString():""}):d({type:"product",name:"",description:"",price:"",stock:""})},[n,t]);return t?(0,L.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,L.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,L.jsxs)("div",{className:"modal-header",children:[(0,L.jsx)("h3",{children:n?"\uc0c1\ud488/\uc11c\ube44\uc2a4 \uc218\uc815":"\uc0c8 \uc0c1\ud488/\uc11c\ube44\uc2a4 \ub4f1\ub85d"}),(0,L.jsx)("button",{className:"close-button",onClick:s,children:"\xd7"})]}),(0,L.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),r.name.trim())if(!r.price||parseInt(r.price)<=0)alert("\uc62c\ubc14\ub978 \uac00\uaca9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!");else if("product"!==r.type||r.stock&&!(parseInt(r.stock)<=0)){p(!0);try{const e={type:r.type,name:r.name.trim(),description:r.description.trim(),price:parseInt(r.price),taxAmount:u,totalPrice:m,stock:"service"===r.type?-1:parseInt(r.stock)};await o(e),s()}catch(t){console.error("\uc0c1\ud488 \uc800\uc7a5 \uc624\ub958:",t),alert("\uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{p(!1)}}else alert("\uc0c1\ud488\uc758 \uc7ac\uace0 \uc218\ub7c9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!");else alert("\uc0c1\ud488/\uc11c\ube44\uc2a4 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!")},className:"modal-content",children:[(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\uc885\ub958 *"}),(0,L.jsx)("div",{className:"type-selector",children:js.map(e=>(0,L.jsxs)("button",{type:"button",onClick:()=>d((0,l.A)((0,l.A)({},r),{},{type:e.value})),className:"type-button ".concat(r.type===e.value?"active":""),children:[(0,L.jsx)("span",{className:"type-icon",children:e.icon}),(0,L.jsx)("span",{className:"type-label",children:e.label}),(0,L.jsx)("span",{className:"type-desc",children:e.description})]},e.value))})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsxs)("label",{children:["product"===r.type?"\uc0c1\ud488\uba85":"\uc11c\ube44\uc2a4\uba85"," *"]}),(0,L.jsx)("input",{type:"text",value:r.name,onChange:e=>d((0,l.A)((0,l.A)({},r),{},{name:e.target.value})),placeholder:"product"===r.type?"\uc608: \uc218\uc81c \ucfe0\ud0a4":"\uc608: \uc218\ud559 \uacfc\uc678",maxLength:30})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\uc124\uba85"}),(0,L.jsx)("textarea",{value:r.description,onChange:e=>d((0,l.A)((0,l.A)({},r),{},{description:e.target.value})),placeholder:"\uc0c1\ud488/\uc11c\ube44\uc2a4\uc5d0 \ub300\ud574 \uc124\uba85\ud574\uc8fc\uc138\uc694",rows:2,maxLength:100})]}),(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\uac00\uaca9 (\uc138\uc804) *"}),(0,L.jsxs)("div",{className:"input-with-suffix",children:[(0,L.jsx)("input",{type:"number",value:r.price,onChange:e=>d((0,l.A)((0,l.A)({},r),{},{price:e.target.value})),placeholder:"0",min:"1"}),(0,L.jsx)("span",{className:"suffix",children:"\uc6d0"})]})]}),r.price&&parseInt(r.price)>0&&(0,L.jsxs)("div",{className:"tax-info-box",children:[(0,L.jsxs)("div",{className:"tax-row",children:[(0,L.jsx)("span",{children:"\uc0c1\ud488 \uac00\uaca9"}),(0,L.jsx)("span",{children:bs(parseInt(r.price))})]}),(0,L.jsxs)("div",{className:"tax-row highlight",children:[(0,L.jsx)("span",{children:"+ \ubd80\uac00\uc138 (10%)"}),(0,L.jsxs)("span",{children:["+",bs(u)]})]}),(0,L.jsxs)("div",{className:"tax-row total",children:[(0,L.jsx)("span",{children:"\ud310\ub9e4 \uac00\uaca9"}),(0,L.jsx)("span",{className:"neon-text",children:bs(m)})]}),(0,L.jsx)("p",{className:"tax-notice",children:"\ubd80\uac00\uc138 10%\ub294 \uad6d\uc138\uccad\uc5d0 \uc790\ub3d9 \ub0a9\ubd80\ub429\ub2c8\ub2e4"})]}),"product"===r.type&&(0,L.jsxs)("div",{className:"form-group",children:[(0,L.jsx)("label",{children:"\uc7ac\uace0 \uc218\ub7c9 *"}),(0,L.jsxs)("div",{className:"input-with-suffix",children:[(0,L.jsx)("input",{type:"number",value:r.stock,onChange:e=>d((0,l.A)((0,l.A)({},r),{},{stock:e.target.value})),placeholder:"0",min:"1"}),(0,L.jsx)("span",{className:"suffix",children:"\uac1c"})]})]}),(0,L.jsxs)("div",{className:"modal-footer",children:[(0,L.jsx)("button",{type:"button",onClick:s,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,L.jsx)("button",{type:"submit",disabled:c,className:"modal-button confirm",children:c?"\uc800\uc7a5 \uc911...":n?"\uc218\uc815\ud558\uae30":"\ub4f1\ub85d\ud558\uae30"})]})]})]})}):null},Ns=e=>{let{isOpen:t,onClose:s,product:n,shop:i,onConfirm:o}=e;const[l,r]=(0,a.useState)(1),[d,c]=(0,a.useState)(!1),p=(0,a.useMemo)(()=>n?n.totalPrice*l:0,[n,l]);if(!t||!n)return null;const u="service"===n.type?10:Math.min(n.stock,10);return(0,L.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,L.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,L.jsxs)("div",{className:"modal-header",children:[(0,L.jsx)("h3",{children:"\uad6c\ub9e4 \ud655\uc778"}),(0,L.jsx)("button",{className:"close-button",onClick:s,children:"\xd7"})]}),(0,L.jsxs)("div",{className:"modal-content",children:[(0,L.jsxs)("div",{className:"purchase-item-info",children:[(0,L.jsx)("div",{className:"item-icon",children:"product"===n.type?"\ud83d\udce6":"\ud83d\udee0\ufe0f"}),(0,L.jsxs)("div",{className:"item-details",children:[(0,L.jsx)("h4",{children:n.name}),(0,L.jsx)("p",{className:"shop-name",children:null===i||void 0===i?void 0:i.shopName}),(0,L.jsxs)("p",{className:"item-price",children:[bs(n.totalPrice)," (\ubd80\uac00\uc138 \ud3ec\ud568)"]})]})]}),(0,L.jsxs)("div",{className:"quantity-selector",children:[(0,L.jsx)("label",{children:"product"===n.type?"\uad6c\ub9e4 \uc218\ub7c9":"\uc774\uc6a9 \ud69f\uc218"}),(0,L.jsxs)("div",{className:"quantity-controls",children:[(0,L.jsx)("button",{onClick:()=>r(Math.max(1,l-1)),className:"quantity-btn",children:"-"}),(0,L.jsx)("span",{className:"quantity-value",children:l}),(0,L.jsx)("button",{onClick:()=>r(Math.min(u,l+1)),className:"quantity-btn",children:"+"}),"product"===n.type&&(0,L.jsxs)("span",{className:"stock-info",children:["(\uc7ac\uace0: ",n.stock,"\uac1c)"]})]})]}),(0,L.jsxs)("div",{className:"total-amount-box",children:[(0,L.jsx)("span",{children:"\ucd1d \uacb0\uc81c \uae08\uc561"}),(0,L.jsx)("span",{className:"total-price neon-text",children:bs(p)})]})]}),(0,L.jsxs)("div",{className:"modal-footer",children:[(0,L.jsx)("button",{onClick:s,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{c(!0);try{await o(l),s()}catch(e){alert(e.message||"\uad6c\ub9e4 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{c(!1)}},disabled:d,className:"modal-button confirm",children:d?"\ucc98\ub9ac \uc911...":"\uad6c\ub9e4\ud558\uae30"})]})]})})},Cs=e=>{let{shop:t,onClick:s}=e;const a=ys.find(e=>e.value===t.category);return(0,L.jsxs)("div",{onClick:s,className:"shop-card",children:[(0,L.jsxs)("div",{className:"shop-card-header",children:[(0,L.jsx)("div",{className:"shop-icon",children:(null===a||void 0===a?void 0:a.icon)||"\ud83c\udfea"}),(0,L.jsxs)("div",{className:"shop-info",children:[(0,L.jsx)("h3",{className:"shop-name",children:t.shopName}),(0,L.jsxs)("p",{className:"shop-owner",children:[t.ownerName,"\ub2d8\uc758 \uac00\uac8c"]})]})]}),t.description&&(0,L.jsx)("p",{className:"shop-description",children:t.description}),(0,L.jsxs)("div",{className:"shop-card-footer",children:[(0,L.jsx)("span",{className:"shop-category",children:(null===a||void 0===a?void 0:a.label)||"\uae30\ud0c0"}),(0,L.jsxs)("span",{className:"shop-sales",children:["\ucd1d \ub9e4\ucd9c: ",bs(t.totalSales||0)]})]})]})},ks=e=>{let{product:t,shop:s,onBuy:a,isOwner:n,onEdit:i,onDelete:o}=e;return(0,L.jsxs)("div",{className:"product-card",children:[(0,L.jsxs)("div",{className:"product-card-header",children:[(0,L.jsx)("div",{className:"product-icon",children:"product"===t.type?"\ud83d\udce6":"\ud83d\udee0\ufe0f"}),(0,L.jsxs)("div",{className:"product-info",children:[(0,L.jsxs)("div",{className:"product-title-row",children:[(0,L.jsx)("h4",{className:"product-name",children:t.name}),(0,L.jsx)("span",{className:"product-type-badge ".concat(t.type),children:"product"===t.type?"\uc0c1\ud488":"\uc11c\ube44\uc2a4"})]}),t.description&&(0,L.jsx)("p",{className:"product-description",children:t.description}),(0,L.jsxs)("div",{className:"product-price-row",children:[(0,L.jsx)("span",{className:"product-price neon-text",children:bs(t.totalPrice)}),(0,L.jsx)("span",{className:"vat-included",children:"(VAT \ud3ec\ud568)"}),"product"===t.type&&(0,L.jsx)("span",{className:"stock-badge ".concat(t.stock>0?"":"soldout"),children:t.stock>0?"\uc7ac\uace0 ".concat(t.stock,"\uac1c"):"\ud488\uc808"})]})]})]}),(0,L.jsx)("div",{className:"product-card-actions",children:n?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("button",{onClick:()=>i(t),className:"action-btn edit",children:"\u270f\ufe0f \uc218\uc815"}),(0,L.jsx)("button",{onClick:()=>o(t),className:"action-btn delete",children:"\ud83d\uddd1\ufe0f \uc0ad\uc81c"})]}):(0,L.jsx)("button",{onClick:()=>a(t,s),disabled:"product"===t.type&&t.stock<=0,className:"action-btn buy",children:"product"===t.type&&t.stock<=0?"\ud488\uc808":"\ud83d\uded2 \uad6c\ub9e4\ud558\uae30"})})]})},Ss=()=>{const{currentUser:e,userProfile:t,refreshBalance:s}=(0,i.As)(),[n,o]=(0,a.useState)("browse"),[r,d]=(0,a.useState)([]),[c,p]=(0,a.useState)(null),[u,m]=(0,a.useState)([]),[x,h]=(0,a.useState)(null),[g,f]=(0,a.useState)([]),[b,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)(!1),[w,N]=(0,a.useState)(null),[C,k]=(0,a.useState)(null),[S,A]=(0,a.useState)(null),[I,E]=(0,a.useState)(!0),[T,M]=(0,a.useState)(!1),[D,R]=(0,a.useState)("all"),[z,O]=(0,a.useState)(""),_=(0,a.useCallback)(async()=>{try{E(!0);const e=(0,ee.rJ)(G.db,"personalShops");let t=(0,ee.query)(e,(0,ee.where)("status","==","active"),(0,ee.orderBy)("createdAt","desc"),(0,ee.AB)(50));const s=(await(0,ee.getDocs)(t)).docs.map(e=>(0,l.A)({id:e.id},e.data()));d(s)}catch(e){console.error("\uc0c1\uc810 \ubaa9\ub85d \ub85c\ub4dc \uc624\ub958:",e)}finally{E(!1)}},[]),W=(0,a.useCallback)(async()=>{if(e)try{const t=(0,ee.rJ)(G.db,"personalShops"),s=(0,ee.query)(t,(0,ee.where)("ownerId","==",e.uid),(0,ee.AB)(1)),a=await(0,ee.getDocs)(s);if(!a.empty){const e=(0,l.A)({id:a.docs[0].id},a.docs[0].data());p(e);const t=(0,ee.rJ)(G.db,"shopProducts"),s=(0,ee.query)(t,(0,ee.where)("shopId","==",e.id),(0,ee.orderBy)("createdAt","desc")),n=await(0,ee.getDocs)(s);m(n.docs.map(e=>(0,l.A)({id:e.id},e.data())))}}catch(t){console.error("\ub0b4 \uc0c1\uc810 \ub85c\ub4dc \uc624\ub958:",t)}},[e]),B=(0,a.useCallback)(async e=>{try{M(!0);const t=(0,ee.rJ)(G.db,"shopProducts"),s=(0,ee.query)(t,(0,ee.where)("shopId","==",e),(0,ee.where)("status","==","available"),(0,ee.orderBy)("createdAt","desc")),a=await(0,ee.getDocs)(s);f(a.docs.map(e=>(0,l.A)({id:e.id},e.data())))}catch(t){console.error("\uc0c1\ud488 \ub85c\ub4dc \uc624\ub958:",t)}finally{M(!1)}},[]);(0,a.useEffect)(()=>{_(),W()},[_,W]),(0,a.useEffect)(()=>{x&&B(x.id)},[x,B]);const P=async e=>{window.confirm('"'.concat(e.name,'"\uc744(\ub97c) \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?'))&&(await(0,ee.kd)((0,ee.H9)(G.db,"shopProducts",e.id)),await W())},F=(0,a.useMemo)(()=>r.filter(e=>{if("all"!==D&&e.category!==D)return!1;if(z){const t=z.toLowerCase();return e.shopName.toLowerCase().includes(t)||e.ownerName.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)}return!0}),[r,D,z]);return(0,L.jsxs)("div",{className:"personal-shop-container",children:[(0,L.jsxs)("div",{className:"market-header",children:[(0,L.jsx)("h1",{children:"\uac1c\uc778 \uc0c1\uc810"}),(0,L.jsx)("p",{className:"header-subtitle",children:"\ub098\ub9cc\uc758 \uc0c1\uc810\uc744 \uc5f4\uace0 \uc0c1\ud488/\uc11c\ube44\uc2a4\ub97c \ud310\ub9e4\ud574\ubcf4\uc138\uc694!"})]}),(0,L.jsx)("div",{className:"market-tabs",children:[{id:"browse",label:"\uc0c1\uc810 \ub458\ub7ec\ubcf4\uae30",icon:"\ud83d\udecd\ufe0f"},{id:"myshop",label:"\ub0b4 \uc0c1\uc810",icon:"\ud83c\udfea"},{id:"sales",label:"\ud310\ub9e4 \ub0b4\uc5ed",icon:"\ud83d\udcca"}].map(e=>(0,L.jsxs)("button",{onClick:()=>{o(e.id),h(null)},className:"tab-button ".concat(n===e.id?"active":""),children:[(0,L.jsx)("span",{className:"tab-icon",children:e.icon}),(0,L.jsx)("span",{className:"tab-label",children:e.label})]},e.id))}),(()=>{var e,t,s;switch(n){case"browse":return(0,L.jsx)("div",{className:"tab-content",children:x?(0,L.jsxs)("div",{className:"shop-detail-view",children:[(0,L.jsx)("button",{onClick:()=>{h(null),f([])},className:"back-button",children:"\u2190 \uc0c1\uc810 \ubaa9\ub85d\uc73c\ub85c"}),(0,L.jsxs)("div",{className:"shop-detail-header",children:[(0,L.jsx)("div",{className:"shop-detail-icon",children:(null===(e=ys.find(e=>e.value===x.category))||void 0===e?void 0:e.icon)||"\ud83c\udfea"}),(0,L.jsxs)("div",{className:"shop-detail-info",children:[(0,L.jsx)("h2",{children:x.shopName}),(0,L.jsxs)("p",{className:"owner",children:[x.ownerName,"\ub2d8\uc758 \uac00\uac8c"]}),x.description&&(0,L.jsx)("p",{className:"description",children:x.description})]})]}),(0,L.jsxs)("div",{className:"products-section",children:[(0,L.jsx)("h3",{children:"\ud310\ub9e4 \uc0c1\ud488"}),T?(0,L.jsx)("div",{className:"loading-state",children:"\uc0c1\ud488\uc744 \ubd88\ub7ec\uc624\ub294 \uc911..."}):0===g.length?(0,L.jsxs)("div",{className:"empty-state",children:[(0,L.jsx)("span",{className:"empty-icon",children:"\ud83d\udced"}),(0,L.jsx)("p",{children:"\ub4f1\ub85d\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"})]}):(0,L.jsx)("div",{className:"products-grid",children:g.map(e=>(0,L.jsx)(ks,{product:e,shop:x,onBuy:(e,t)=>{k(e),A(t)},isOwner:!1},e.id))})]})]}):(0,L.jsxs)("div",{className:"shop-list-view",children:[(0,L.jsxs)("div",{className:"controls-section",children:[(0,L.jsx)("div",{className:"search-box",children:(0,L.jsx)("input",{type:"text",value:z,onChange:e=>O(e.target.value),placeholder:"\uc0c1\uc810 \uac80\uc0c9...",className:"search-input"})}),(0,L.jsxs)("select",{value:D,onChange:e=>R(e.target.value),className:"category-filter",children:[(0,L.jsx)("option",{value:"all",children:"\uc804\uccb4 \uc5c5\uc885"}),ys.map(e=>(0,L.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))]})]}),I?(0,L.jsx)("div",{className:"loading-state",children:"\uc0c1\uc810\uc744 \ubd88\ub7ec\uc624\ub294 \uc911..."}):0===F.length?(0,L.jsxs)("div",{className:"empty-state",children:[(0,L.jsx)("span",{className:"empty-icon",children:"\ud83c\udfea"}),(0,L.jsx)("p",{children:z||"all"!==D?"\uac80\uc0c9 \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4":"\uc544\uc9c1 \ub4f1\ub85d\ub41c \uc0c1\uc810\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"})]}):(0,L.jsx)("div",{className:"shops-grid",children:F.map(e=>(0,L.jsx)(Cs,{shop:e,onClick:()=>h(e)},e.id))})]})});case"myshop":return(0,L.jsx)("div",{className:"tab-content",children:c?(0,L.jsxs)("div",{className:"my-shop-view",children:[(0,L.jsxs)("div",{className:"my-shop-header",children:[(0,L.jsxs)("div",{className:"my-shop-info",children:[(0,L.jsx)("div",{className:"my-shop-icon",children:(null===(t=ys.find(e=>e.value===c.category))||void 0===t?void 0:t.icon)||"\ud83c\udfea"}),(0,L.jsxs)("div",{className:"my-shop-details",children:[(0,L.jsx)("h2",{children:c.shopName}),(0,L.jsx)("p",{className:"category",children:null===(s=ys.find(e=>e.value===c.category))||void 0===s?void 0:s.label}),c.description&&(0,L.jsx)("p",{className:"description",children:c.description})]}),(0,L.jsx)("button",{onClick:()=>y(!0),className:"edit-shop-btn",children:"\u270f\ufe0f \uc218\uc815"})]}),(0,L.jsxs)("div",{className:"my-shop-stats",children:[(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\ucd1d \ub9e4\ucd9c"}),(0,L.jsx)("span",{className:"stat-value neon-text",children:bs(c.totalSales||0)})]}),(0,L.jsxs)("div",{className:"stat-item",children:[(0,L.jsx)("span",{className:"stat-label",children:"\ub0a9\ubd80\ud55c \ubd80\uac00\uc138"}),(0,L.jsx)("span",{className:"stat-value",children:bs(c.totalTaxPaid||0)})]})]})]}),(0,L.jsxs)("div",{className:"products-header",children:[(0,L.jsxs)("h3",{children:["\ub0b4 \uc0c1\ud488/\uc11c\ube44\uc2a4 (",u.length,")"]}),(0,L.jsx)("button",{onClick:()=>{N(null),v(!0)},className:"add-product-btn",children:"\u2795 \ub4f1\ub85d\ud558\uae30"})]}),0===u.length?(0,L.jsxs)("div",{className:"empty-state",children:[(0,L.jsx)("span",{className:"empty-icon",children:"\ud83d\udce6"}),(0,L.jsx)("p",{children:"\ub4f1\ub85d\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,L.jsx)("span",{className:"empty-hint",children:"\uc0c1\ud488\uc774\ub098 \uc11c\ube44\uc2a4\ub97c \ub4f1\ub85d\ud574\ubcf4\uc138\uc694!"})]}):(0,L.jsx)("div",{className:"products-grid",children:u.map(e=>(0,L.jsx)(ks,{product:e,shop:c,isOwner:!0,onEdit:e=>{N(e),v(!0)},onDelete:P},e.id))})]}):(0,L.jsx)("div",{className:"create-shop-view",children:(0,L.jsxs)("div",{className:"create-shop-card",children:[(0,L.jsx)("span",{className:"create-icon",children:"\ud83c\udfea"}),(0,L.jsx)("h2",{children:"\ub098\ub9cc\uc758 \uc0c1\uc810\uc744 \ub9cc\ub4e4\uc5b4\ubcf4\uc138\uc694!"}),(0,L.jsx)("p",{children:"\uc0c1\ud488\uc774\ub098 \uc11c\ube44\uc2a4\ub97c \ud310\ub9e4\ud558\uace0 \uc218\uc775\uc744 \uc62c\ub824\ubcf4\uc138\uc694"}),(0,L.jsx)("button",{onClick:()=>y(!0),className:"create-shop-btn",children:"\ud83c\udfea \uc0c1\uc810 \ub9cc\ub4e4\uae30"})]})})});case"sales":return(0,L.jsx)("div",{className:"tab-content",children:(0,L.jsxs)("div",{className:"empty-state",children:[(0,L.jsx)("span",{className:"empty-icon",children:"\ud83d\udcca"}),(0,L.jsx)("p",{children:"\ud310\ub9e4 \ub0b4\uc5ed \uae30\ub2a5 \uc900\ube44 \uc911..."})]})});default:return null}})(),(0,L.jsx)(vs,{isOpen:b,onClose:()=>y(!1),shop:c,onSave:async s=>{e&&(c?await(0,ee.mZ)((0,ee.H9)(G.db,"personalShops",c.id),(0,l.A)((0,l.A)({},s),{},{updatedAt:(0,ee.O5)()})):await(0,ee.addDoc)((0,ee.rJ)(G.db,"personalShops"),(0,l.A)((0,l.A)({},s),{},{ownerId:e.uid,ownerName:(null===t||void 0===t?void 0:t.name)||"\uc775\uba85",status:"active",totalSales:0,totalTaxPaid:0,createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)()})),await W(),await _())}}),(0,L.jsx)(ws,{isOpen:j,onClose:()=>{v(!1),N(null)},product:w,shopId:null===c||void 0===c?void 0:c.id,onSave:async t=>{c&&(w?await(0,ee.mZ)((0,ee.H9)(G.db,"shopProducts",w.id),(0,l.A)((0,l.A)({},t),{},{updatedAt:(0,ee.O5)()})):await(0,ee.addDoc)((0,ee.rJ)(G.db,"shopProducts"),(0,l.A)((0,l.A)({},t),{},{shopId:c.id,ownerId:e.uid,status:"available",soldCount:0,createdAt:(0,ee.O5)(),updatedAt:(0,ee.O5)()})),N(null),await W())}}),(0,L.jsx)(Ns,{isOpen:!!C,onClose:()=>{k(null),A(null)},product:C,shop:S,onConfirm:async a=>{if(!e||!C||!S)throw new Error("\uad6c\ub9e4 \uc815\ubcf4\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");const n=C.totalPrice*a,i=C.taxAmount*a,o=C.price*a;if(((null===t||void 0===t?void 0:t.balance)||0)<n)throw new Error("\uc794\uc561\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4!");if(S.ownerId===e.uid)throw new Error("\ubcf8\uc778 \uc0c1\uc810\uc5d0\uc11c\ub294 \uad6c\ub9e4\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4!");await(0,ee.c4)(G.db,async s=>{const l=(0,ee.H9)(G.db,"users",e.uid);s.update(l,{balance:(0,ee.GV)(-n)});const r=(0,ee.H9)(G.db,"users",S.ownerId);s.update(r,{balance:(0,ee.GV)(o)});const d=(0,ee.H9)(G.db,"nationalTax","treasury");s.update(d,{totalVAT:(0,ee.GV)(i),totalTaxCollected:(0,ee.GV)(i)});const c=(0,ee.H9)(G.db,"personalShops",S.id);s.update(c,{totalSales:(0,ee.GV)(o),totalTaxPaid:(0,ee.GV)(i)});const p=(0,ee.H9)(G.db,"shopProducts",C.id),u={soldCount:(0,ee.GV)(a)};"product"===C.type&&(u.stock=(0,ee.GV)(-a),C.stock-a<=0&&(u.status="soldout")),s.update(p,u);const m=(0,ee.rJ)(G.db,"activities");s.set((0,ee.H9)(m),{type:"shop_purchase",buyerId:e.uid,buyerName:(null===t||void 0===t?void 0:t.name)||"\uc775\uba85",sellerId:S.ownerId,sellerName:S.ownerName,shopId:S.id,shopName:S.shopName,productId:C.id,productName:C.name,productType:C.type,quantity:a,unitPrice:C.totalPrice,totalAmount:n,taxAmount:i,timestamp:(0,ee.O5)()})}),s&&await s(),x&&await B(x.id),k(null),A(null),alert("\uad6c\ub9e4\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4!")}})]})};var As=s(4776),Is=s(1662),Es=s(6648),Ts=s(6794),Ms=s(773),Ds=s(3242);const Rs=async e=>{if(!e)return null;try{const t=(0,G.rJ)(G.db,"users"),s=(0,G.P)(t,(0,G._M)("classCode","==",e),(0,G._M)("isAdmin","==",!0),(0,G.AB)(1)),a=await(0,G.GG)(s);if(!a.empty){const e=a.docs[0];return(0,l.A)({id:e.id},e.data())}return null}catch(t){return console.error("\uc120\uc0dd\ub2d8 \uacc4\uc815 \uc870\ud68c \uc624\ub958:",t),null}},zs={container:{fontFamily:"sans-serif",backgroundColor:"transparent",padding:"32px",minHeight:"auto"},message:e=>({padding:"16px 20px",borderRadius:"12px",marginBottom:"28px",textAlign:"center",fontSize:"16px",fontWeight:"500",color:"error"===e?"#f87171":"#34d399",backgroundColor:"error"===e?"rgba(239, 68, 68, 0.1)":"rgba(16, 185, 129, 0.1)",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid ".concat("error"===e?"rgba(239, 68, 68, 0.3)":"rgba(16, 185, 129, 0.3)")}),grid:{display:"grid",gap:"28px",maxWidth:"1200px",margin:"0 auto"},card:{backgroundColor:"rgba(20, 20, 35, 0.6)",boxShadow:"0 6px 20px rgba(0, 0, 0, 0.2)",borderRadius:"16px",padding:"32px",border:"1px solid rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)"},cardHeader:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"24px",paddingBottom:"20px",borderBottom:"2px solid rgba(255, 255, 255, 0.05)"},cardTitle:{fontSize:"26px",fontWeight:"bold",color:"#fff",letterSpacing:"-0.5px",textShadow:"0 0 10px rgba(0, 255, 242, 0.3)"},tabContainer:{display:"flex",borderBottom:"2px solid rgba(255, 255, 255, 0.1)",marginBottom:"20px",gap:"8px"},tabButton:e=>({padding:"12px 24px",border:"none",background:e?"rgba(99, 102, 241, 0.2)":"none",cursor:"pointer",fontSize:"17px",fontWeight:e?"700":"500",color:e?"#00fff2":"#94a3b8",borderBottom:"3px solid ".concat(e?"#00fff2":"transparent"),marginBottom:"-2px",borderRadius:"8px 8px 0 0",transition:"all 0.2s ease",textShadow:e?"0 0 5px rgba(0, 255, 242, 0.3)":"none"}),button:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"primary";return{backgroundColor:"primary"===t?"rgba(3, 105, 161, 0.8)":"danger"===t?"rgba(220, 38, 38, 0.8)":"success"===t?"rgba(5, 150, 105, 0.8)":"#4b5563",color:"white",padding:"12px 20px",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)",cursor:e?"not-allowed":"pointer",opacity:e?.5:1,fontSize:"15px",fontWeight:"600",boxShadow:e?"none":"0 4px 12px rgba(0,0,0,0.3)",transition:"all 0.2s ease",":hover":!e&&{transform:"translateY(-2px)",boxShadow:"0 6px 16px rgba(0,0,0,0.4)",filter:"brightness(1.1)"}}},noProduct:{textAlign:"center",color:"#94a3b8",padding:"32px 0",fontSize:"16px",fontStyle:"italic"},input:{width:"100%",padding:"14px 16px",backgroundColor:"rgba(0, 0, 0, 0.2)",border:"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"10px",marginBottom:"16px",fontSize:"16px",color:"white",transition:"border-color 0.2s ease",":focus":{outline:"none",borderColor:"#00fff2",boxShadow:"0 0 0 2px rgba(0, 255, 242, 0.1)"}},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(8px)"},modalContent:{background:"#1a1a2e",padding:"32px",borderRadius:"16px",width:"90%",maxWidth:"450px",position:"relative",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.6)",border:"1px solid rgba(255, 255, 255, 0.1)",color:"#e2e8f0"},modalTitle:{fontSize:"24px",fontWeight:"bold",marginBottom:"20px",color:"#fff",textShadow:"0 0 10px rgba(0, 255, 242, 0.3)"},modalCloseBtn:{position:"absolute",top:"20px",right:"20px",background:"none",border:"none",cursor:"pointer",color:"#94a3b8",transition:"color 0.2s ease",":hover":{color:"#fff"}}},Os=e=>"number"===typeof e?Math.round(e).toLocaleString():"0",_s=(e,t,s)=>{if(e<=0||!t||s<=0)return{interest:0,total:e};const a=e*Math.pow(1+t/100,s),n=a-e;return{interest:Math.round(n),total:Math.round(a)}},Ls=(e,t)=>Math.round(e*(t/100)),Ws={parking:(0,L.jsx)(d.A,{size:28,style:{color:"#0369a1"}}),deposits:(0,L.jsx)(C.A,{size:28,style:{color:"#059669"}}),savings:(0,L.jsx)(Ms.A,{size:28,style:{color:"#7c3aed"}}),loans:(0,L.jsx)(Ds.A,{size:28,style:{color:"#dc2626"}})},Bs=e=>{let{product:t,onCancel:s,onMaturity:a}=e;const n=t.maturityDate&&new Date>=t.maturityDate,i=t.maturityDate?Math.max(0,(0,Is.c)(t.maturityDate,new Date)):0,{interest:o,total:r}=(t.rate,_s(t.balance,t.rate,t.termInDays)),d=Ls(t.balance,t.rate);return(0,L.jsxs)("div",{style:{padding:"20px",border:"2px solid ".concat(n?"rgba(16, 185, 129, 0.5)":"rgba(255, 255, 255, 0.1)"),borderRadius:"12px",marginBottom:"16px",background:n?"rgba(16, 185, 129, 0.1)":"rgba(0, 0, 0, 0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{style:{fontWeight:"700",fontSize:"18px",color:"#e2e8f0",marginBottom:"4px"},children:t.name}),n&&(0,L.jsx)("span",{style:{backgroundColor:"#10b981",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"600"},children:"\ub9cc\uae30"})]}),(0,L.jsxs)("span",{style:{fontSize:"20px",fontWeight:"700",color:"#00fff2"},children:[Os(t.balance),"\uc6d0"]})]}),(0,L.jsxs)("div",{style:{fontSize:"15px",color:"#94a3b8",marginTop:"16px",display:"grid",gap:"10px",backgroundColor:"rgba(0, 0, 0, 0.2)",padding:"16px",borderRadius:"8px"},children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,L.jsx)("span",{style:{fontWeight:"500"},children:"\uae08\ub9ac (\uc77c):"}),(0,L.jsxs)("span",{style:{fontWeight:"700",color:"#00fff2"},children:[t.rate,"%"]})]}),(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,L.jsx)("span",{style:{fontWeight:"500"},children:"\uc77c\uc77c \uc774\uc790:"}),(0,L.jsxs)("span",{style:{fontWeight:"700",color:"#34d399"},children:["+",Os(d),"\uc6d0/\uc77c"]})]}),t.maturityDate&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,L.jsx)("span",{style:{fontWeight:"500"},children:"\ub9cc\uae30\uc77c:"}),(0,L.jsx)("span",{style:{fontWeight:"600",color:"#e2e8f0"},children:(0,Es.GP)(t.maturityDate,"yyyy-MM-dd")})]}),!n&&(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,L.jsx)("span",{style:{fontWeight:"500"},children:"\ub0a8\uc740 \uae30\uac04:"}),(0,L.jsxs)("span",{style:{fontWeight:"600",color:"#00fff2"},children:[i,"\uc77c"]})]})]})]}),(0,L.jsx)("div",{style:{borderTop:"1px dashed rgba(255, 255, 255, 0.1)",margin:"16px 0"}}),(0,L.jsxs)("div",{style:{fontSize:"15px",color:"#e2e8f0",display:"grid",gap:"10px",backgroundColor:"rgba(0, 255, 242, 0.05)",padding:"16px",borderRadius:"8px",border:"1px solid rgba(0, 255, 242, 0.1)"},children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,L.jsx)("span",{style:{fontWeight:"600"},children:"\ub9cc\uae30 \uc2dc \uc774\uc790 (\uc138\uc804):"}),(0,L.jsxs)("span",{style:{fontWeight:"700",color:"#34d399",fontSize:"17px"},children:["+",Os(o),"\uc6d0"]})]}),(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"17px"},children:[(0,L.jsx)("span",{style:{fontWeight:"700"},children:"\ub9cc\uae30 \uc2dc \ucd1d\uc561:"}),(0,L.jsxs)("span",{style:{fontWeight:"700",color:"#00fff2"},children:[Os(r),"\uc6d0"]})]})]}),(0,L.jsx)("div",{style:{marginTop:"20px",textAlign:"right"},children:n?(0,L.jsxs)("button",{onClick:a,style:(0,l.A)((0,l.A)({},zs.button(!1,"success")),{},{padding:"10px 20px",fontSize:"15px"}),children:["\ub9cc\uae30 \uc218\ub839 (",Os(r),"\uc6d0)"]}):(0,L.jsx)("button",{onClick:s,style:(0,l.A)((0,l.A)({},zs.button(!1,"danger")),{},{padding:"10px 20px",fontSize:"15px"}),children:"loan"===t.type?"\ub300\ucd9c \uc0c1\ud658":"\uc911\ub3c4 \ud574\uc9c0"})})]})},Ps=e=>{let{product:t,onSubscribe:s}=e;const a=t.dailyRate,{interest:n}=_s(1e5,a,t.termInDays);return(0,L.jsxs)("div",{style:{padding:"20px",border:"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(0, 0, 0, 0.2)",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.2s ease"},children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{style:{fontWeight:"700",fontSize:"18px",color:"#e2e8f0",marginBottom:"8px"},children:t.name}),(0,L.jsxs)("div",{style:{fontSize:"15px",color:"#94a3b8",marginBottom:"6px"},children:[(0,L.jsxs)("strong",{style:{color:"#00fff2"},children:["\uc77c ",t.dailyRate,"%"]})," (\uae30\uac04: ",t.termInDays,"\uc77c)"]}),(0,L.jsxs)("div",{style:{fontSize:"14px",color:"#34d399",fontWeight:"600"},children:[(0,L.jsx)(y.A,{size:14,style:{display:"inline",marginRight:"4px"}}),"10\ub9cc\uc6d0 \uac00\uc785 \uc2dc \uc608\uc0c1 \uc774\uc790: +",Os(n),"\uc6d0"]})]}),(0,L.jsx)("button",{onClick:s,style:(0,l.A)((0,l.A)({},zs.button(!1)),{},{padding:"12px 24px",fontSize:"16px"}),children:"\uac00\uc785"})]})},Fs=e=>{let{title:t,icon:s,subscribedProducts:n,availableProducts:i,onSubscribe:o,onCancel:l,onMaturity:r}=e;const[d,c]=(0,a.useState)("subscribed");return(0,L.jsxs)("div",{style:zs.card,children:[(0,L.jsxs)("div",{style:zs.cardHeader,children:[s,(0,L.jsx)("h2",{style:zs.cardTitle,children:t})]}),(0,L.jsxs)("div",{style:zs.tabContainer,children:[(0,L.jsx)("button",{onClick:()=>c("subscribed"),style:zs.tabButton("subscribed"===d),children:"\uac00\uc785\ud55c \uc0c1\ud488"}),(0,L.jsx)("button",{onClick:()=>c("available"),style:zs.tabButton("available"===d),children:"\uac00\uc785 \uac00\ub2a5\ud55c \uc0c1\ud488"})]}),(0,L.jsxs)("div",{children:["subscribed"===d&&(n.length>0?n.map(e=>(0,L.jsx)(Bs,{product:e,onCancel:()=>l(e),onMaturity:()=>r(e)},e.id)):(0,L.jsx)("p",{style:zs.noProduct,children:"\uac00\uc785\ud55c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})),"available"===d&&(i.length>0?i.map(e=>(0,L.jsx)(Ps,{product:e,onSubscribe:()=>o(e)},e.id)):(0,L.jsx)("p",{style:zs.noProduct,children:"\uac00\uc785 \uac00\ub2a5\ud55c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}))]})]})},qs=e=>{let{isOpen:t,onClose:s,product:n,onConfirm:i,isProcessing:o}=e;const[r,d]=(0,a.useState)("");if(!t||!n)return null;const c=parseFloat(r),p=n.dailyRate,{interest:u,total:m}=!isNaN(c)&&c>0?_s(c,p,n.termInDays):{interest:0,total:0};return(0,L.jsx)("div",{style:zs.modalOverlay,onClick:s,children:(0,L.jsxs)("div",{style:zs.modalContent,onClick:e=>e.stopPropagation(),children:[(0,L.jsx)("button",{onClick:s,style:zs.modalCloseBtn,children:(0,L.jsx)(O.A,{size:24})}),(0,L.jsxs)("h3",{style:zs.modalTitle,children:[n.name," \uac00\uc785"]}),(0,L.jsxs)("div",{style:{marginBottom:"20px",padding:"16px",backgroundColor:"rgba(0, 255, 242, 0.05)",borderRadius:"10px",border:"1px solid rgba(0, 255, 242, 0.2)"},children:[(0,L.jsxs)("div",{style:{fontSize:"15px",color:"#94a3b8",marginBottom:"8px"},children:[(0,L.jsx)("strong",{style:{color:"#00fff2"},children:"\uae08\ub9ac:"})," \uc77c ",n.dailyRate,"% (\uc77c\ubcf5\ub9ac)"]}),(0,L.jsxs)("div",{style:{fontSize:"15px",color:"#94a3b8"},children:[(0,L.jsx)("strong",{style:{color:"#00fff2"},children:"\uae30\uac04:"})," ",n.termInDays,"\uc77c"]})]}),(0,L.jsx)("p",{style:{marginBottom:"12px",fontSize:"16px",fontWeight:"600",color:"#e2e8f0"},children:"\uac00\uc785 \uae08\uc561\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694"}),(0,L.jsx)("input",{type:"number",value:r,onChange:e=>d(e.target.value),style:zs.input,placeholder:"".concat(Os(n.minAmount||0),"\uc6d0 \uc774\uc0c1"),autoFocus:!0}),c>0&&(0,L.jsxs)("div",{style:{marginBottom:"20px",padding:"16px",backgroundColor:"rgba(16, 185, 129, 0.1)",borderRadius:"10px",border:"1px solid rgba(16, 185, 129, 0.3)"},children:[(0,L.jsxs)("div",{style:{fontSize:"15px",color:"#34d399",marginBottom:"6px"},children:["\uc608\uc0c1 \ub9cc\uae30 \uc774\uc790: ",(0,L.jsxs)("strong",{children:["+",Os(u),"\uc6d0"]})]}),(0,L.jsxs)("div",{style:{fontSize:"16px",color:"#34d399",fontWeight:"700"},children:["\ub9cc\uae30 \uc2dc \ucd1d\uc561: ",Os(m),"\uc6d0"]})]}),(0,L.jsx)("button",{onClick:()=>{i(r),d("")},disabled:o||!r,style:(0,l.A)((0,l.A)({},zs.button(o||!r)),{},{width:"100%",fontSize:"17px",padding:"16px"}),children:o?"\ucc98\ub9ac \uc911...":"\uac00\uc785\ud558\uae30"})]})})},Us=e=>{let{balance:t,dailyInterest:s,onDeposit:n,onWithdraw:i,isProcessing:o,userCash:r}=e;const[c,p]=(0,a.useState)("");return(0,L.jsxs)("div",{style:(0,l.A)((0,l.A)({},zs.card),{},{background:"linear-gradient(135deg, rgba(6, 78, 117, 0.85) 0%, rgba(20, 40, 60, 0.9) 100%)",color:"white",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",border:"1px solid rgba(0, 180, 216, 0.25)"}),children:[(0,L.jsxs)("div",{style:(0,l.A)((0,l.A)({},zs.cardHeader),{},{borderBottom:"2px solid rgba(0, 180, 216, 0.2)"}),children:[(0,L.jsx)(d.A,{size:32,style:{color:"#67e8f9"}}),(0,L.jsx)("h2",{style:(0,l.A)((0,l.A)({},zs.cardTitle),{},{color:"#e0f7fa"}),children:"\ud30c\ud0b9\ud1b5\uc7a5"})]}),(0,L.jsxs)("div",{style:{backgroundColor:"rgba(0, 180, 216, 0.15)",padding:"12px 16px",borderRadius:"10px",marginBottom:"16px",backdropFilter:"blur(10px)",display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid rgba(0, 180, 216, 0.2)"},children:[(0,L.jsx)("span",{style:{fontSize:"16px",fontWeight:"500",color:"#94a3b8"},children:"\ubcf4\uc720 \ud604\uae08"}),(0,L.jsxs)("span",{style:{fontSize:"20px",fontWeight:"700",color:"#e0f7fa"},children:[Os(r||0),"\uc6d0"]})]}),(0,L.jsxs)("div",{style:{fontSize:"42px",fontWeight:"bold",color:"#e0f7fa",marginBottom:"8px"},children:[Os(t),"\uc6d0"]}),(0,L.jsx)("p",{style:{fontSize:"16px",color:"rgba(224, 247, 250, 0.8)",marginBottom:"16px",fontWeight:"500"},children:"\ub9e4\uc77c \uc774\uc790\uac00 \uc790\ub3d9 \uc9c0\uae09\ub418\ub294 \uc790\uc720 \uc785\ucd9c\uae08 \ud1b5\uc7a5"}),(0,L.jsxs)("div",{style:{backgroundColor:"rgba(0, 180, 216, 0.12)",padding:"16px",borderRadius:"10px",marginBottom:"24px",backdropFilter:"blur(10px)",border:"1px solid rgba(0, 180, 216, 0.2)"},children:[(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[(0,L.jsx)(y.A,{size:20,style:{color:"#67e8f9"}}),(0,L.jsx)("span",{style:{fontSize:"15px",fontWeight:"600",color:"#94a3b8"},children:"\uc77c\uc77c \uc774\uc790 \uc218\uc775"})]}),(0,L.jsxs)("div",{style:{fontSize:"28px",fontWeight:"700",color:"#67e8f9"},children:["+",Os(s),"\uc6d0/\uc77c"]}),(0,L.jsx)("div",{style:{fontSize:"14px",marginTop:"6px",color:"rgba(148, 163, 184, 0.9)"},children:"(\uc77c 1% \ubcf5\ub9ac \uae30\uc900)"})]}),(0,L.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,L.jsx)("input",{type:"number",value:c,onChange:e=>p(e.target.value),placeholder:"\uae08\uc561 \uc785\ub825",style:(0,l.A)((0,l.A)({},zs.input),{},{marginBottom:0,fontSize:"17px",flex:1,backgroundColor:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(0, 180, 216, 0.3)"}),disabled:o}),(0,L.jsx)("button",{onClick:()=>{n(c),p("")},disabled:o,style:(0,l.A)((0,l.A)({},zs.button(o,"success")),{},{fontSize:"17px",padding:"14px 24px"}),children:"\uc785\uae08"}),(0,L.jsx)("button",{onClick:()=>{i(c),p("")},disabled:o,style:(0,l.A)((0,l.A)({},zs.button(o)),{},{backgroundColor:"rgba(100, 116, 139, 0.5)",color:"white",fontSize:"17px",padding:"14px 24px"}),children:"\ucd9c\uae08"})]})]})},Qs=e=>{let{auth:t={},depositProducts:s=[],installmentProducts:n=[],loanProducts:i=[],activeView:o="parking",onViewChange:r,onLoadUserProducts:d,allUserProducts:c=[],onDeleteUserProduct:p}=e;const{user:u,userDoc:m,loading:x,refreshUserDocument:h,isAdmin:g,addCash:f,deductCash:b}=t,y=null===u||void 0===u?void 0:u.uid,[j,v]=(0,a.useState)(!1),[w,N]=(0,a.useState)(null),[C,k]=(0,a.useState)(""),[S,A]=(0,a.useState)(0),[I,E]=(0,a.useState)(0),[T,M]=(0,a.useState)([]),[D,R]=(0,a.useState)([]),[z,O]=(0,a.useState)([]),[_,W]=(0,a.useState)({isOpen:!1,product:null,type:""}),[B,P]=(0,a.useState)((null===m||void 0===m?void 0:m.cash)||0),F=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;N(e),k(t),s&&setTimeout(()=>N(null),s)},q=(0,a.useCallback)(async()=>{if(y){v(!0);try{const t=(0,G.H9)(G.db,"users",y,"financials","parkingAccount"),a=s.length>0?s[0]:null;if(a){const s=await(0,G.x7)(t);if(s.exists()){var e;const n=s.data(),i=null===(e=n.lastInterestDate)||void 0===e?void 0:e.toDate();if(!i||!(0,Ts.c)(i)){const e=i?(0,Is.c)(new Date,i):1;if(e>0){const s=a.dailyRate||.0027,{interest:i}=_s(n.balance||0,s,e);i>0&&(await(0,G.mZ)(t,{balance:(0,G.GV)(i),lastInterestDate:(0,G.O5)()}),F("\ud30c\ud0b9\ud1b5\uc7a5 \uc774\uc790 ".concat(Os(i),"\uc6d0\uc774 \uc9c0\uae09\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),"success"))}}}else await(0,G.BN)(t,{balance:0,lastInterestDate:(0,G.O5)()})}const n=await(0,G.x7)(t);if(n.exists()){const e=n.data().balance||0;A(e);const t=Ls(e,1);E(t)}const i=(0,G.rJ)(G.db,"users",y,"products"),o=await(0,G.GG)(i),r=[],d=[],c=[];o.forEach(e=>{var t;const s=(0,l.A)((0,l.A)({id:e.id},e.data()),{},{maturityDate:null!==(t=e.data().maturityDate)&&void 0!==t&&t.toDate?e.data().maturityDate.toDate():e.data().maturityDate});"deposit"===s.type?r.push(s):"savings"===s.type?d.push(s):"loan"===s.type&&c.push(s)}),M(r),R(d),O(c)}catch(t){console.error("\ub370\uc774\ud130 \ub85c\ub4dc \uc624\ub958:",t),F("\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.","error")}finally{v(!1)}}},[y,s]);(0,a.useEffect)(()=>{!x&&y&&q()},[y,x,q]),(0,a.useEffect)(()=>{void 0!==(null===m||void 0===m?void 0:m.cash)&&(P(m.cash),console.log("[ParkingAccount] currentCash \uc5c5\ub370\uc774\ud2b8:",m.cash))},[null===m||void 0===m?void 0:m.cash]);const U=(e,t)=>W({isOpen:!0,product:e,type:t}),Q=()=>W({isOpen:!1,product:null,type:""}),H=async e=>{console.log("--- handleMaturity \uc2dc\uc791 ---"),console.log("\ucc98\ub9ac\ud560 \uc0c1\ud488:",e);const{id:t,name:s,type:a,balance:n,termInDays:i,rate:o,teacherId:l}=e,r="loan"===a;if(!y)return F("\uc0ac\uc6a9\uc790 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694.","error"),void console.error("handleMaturity: userId\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const d=o,{total:c,interest:p}=_s(n,d,i);console.log("\uacc4\uc0b0 \uacb0\uacfc: \uc6d0\uae08=".concat(n,", \uc774\uc790=").concat(p,", \ucd1d\uc561=").concat(c));const u=r?"\ub300\ucd9c \ub9cc\uae30 \uc0c1\ud658: \uc6d0\uae08 ".concat(Os(n),"\uc6d0 + \uc774\uc790 ").concat(Os(p),"\uc6d0 = ").concat(Os(c),"\uc6d0\uc744 \uc0c1\ud658\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"):"\ub9cc\uae30 \uc218\ub839: \uc6d0\uae08 ".concat(Os(n),"\uc6d0 + \uc774\uc790 ").concat(Os(p),"\uc6d0 = ").concat(Os(c),"\uc6d0\uc744 \uc218\ub839\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?");if(!window.confirm(u))return void console.log("\uc0ac\uc6a9\uc790\uac00 \ub9cc\uae30 \ucc98\ub9ac\ub97c \ucde8\uc18c\ud588\uc2b5\ub2c8\ub2e4.");v(!0),console.log("\ub9cc\uae30 \ucc98\ub9ac \uc2dc\uc791...");let x=l;if(!x){const e=await Rs(null===m||void 0===m?void 0:m.classCode);if(!e)return F("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.","error"),void v(!1);x=e.id}console.log("\uc120\uc0dd\ub2d8 \uacc4\uc815 ID:",x);try{const e=(0,G.H9)(G.db,"users",y,"products",String(t));console.log("Firestore \ubb38\uc11c \ucc38\uc870:",e.path),await(0,G.c4)(G.db,async t=>{var s,a,n,i;console.log("\ud2b8\ub79c\uc7ad\uc158 \uc2dc\uc791");const o=(0,G.H9)(G.db,"users",y),l=(0,G.H9)(G.db,"users",x),d=await t.get(o),p=await t.get(l);if(!d.exists())throw new Error("\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!p.exists())throw new Error("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const u=null!==(s=null===(a=d.data())||void 0===a?void 0:a.cash)&&void 0!==s?s:0,m=null!==(n=null===(i=p.data())||void 0===i?void 0:i.cash)&&void 0!==n?n:0;if(r){if(u<c)throw new Error("\uc0c1\ud658\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(Os(c),"\uc6d0, \ubcf4\uc720: ").concat(Os(u),"\uc6d0)"));t.update(o,{cash:(0,G.GV)(-c)}),t.update(l,{cash:(0,G.GV)(c)}),console.log("\ub300\ucd9c \uc0c1\ud658: \ud559\uc0dd -".concat(c,", \uc120\uc0dd\ub2d8 +").concat(c))}else{if(m<c)throw new Error("\uc740\ud589(\uc120\uc0dd\ub2d8)\uc5d0 \uc9c0\uae09\ud560 \uc790\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(Os(c),"\uc6d0)"));t.update(o,{cash:(0,G.GV)(c)}),t.update(l,{cash:(0,G.GV)(-c)}),console.log("\ub9cc\uae30 \uc218\ub839: \ud559\uc0dd +".concat(c,", \uc120\uc0dd\ub2d8 -").concat(c))}t.delete(e),console.log("\uc0c1\ud488 \ubb38\uc11c \uc0ad\uc81c \uc608\uc57d"),console.log("\ud2b8\ub79c\uc7ad\uc158 \ucee4\ubc0b \uc2dc\ub3c4")}),console.log("\ud2b8\ub79c\uc7ad\uc158 \uc131\uacf5");const i=r?"\ub300\ucd9c \uc0c1\ud658 \uc644\ub8cc: ".concat(Os(c),"\uc6d0 (\uc120\uc0dd\ub2d8 \uacc4\uc815\uc73c\ub85c \uc774\uccb4)"):"\ub9cc\uae30 \uc218\ub839 \uc644\ub8cc: ".concat(Os(c),"\uc6d0 (\uc120\uc0dd\ub2d8 \uacc4\uc815\uc5d0\uc11c \uc9c0\uae09)");F(i,"success");const o=r?gs.gI.LOAN_REPAY:gs.gI.DEPOSIT_MATURITY;(0,gs.Mx)(G.db,{classCode:null===m||void 0===m?void 0:m.classCode,userId:y,userName:(null===m||void 0===m?void 0:m.name)||"\uc0ac\uc6a9\uc790",type:o,description:r?"\ub300\ucd9c \ub9cc\uae30 \uc0c1\ud658: ".concat(s," (\uc6d0\uae08: ").concat(Os(n),", \uc774\uc790: ").concat(Os(p),") - \uc120\uc0dd\ub2d8 \uacc4\uc815\uc73c\ub85c"):"".concat(s," \ub9cc\uae30 \uc218\ub839 (\uc6d0\uae08: ").concat(Os(n),", \uc774\uc790: ").concat(Os(p),") - \uc120\uc0dd\ub2d8 \uacc4\uc815\uc5d0\uc11c"),amount:r?-c:c,metadata:{productName:s,productType:a,principal:n,interest:p,total:c,teacherId:x}}),h&&(console.log("userDoc \uac31\uc2e0 \uc2dc\uc791"),h().then(()=>{console.log("[ParkingAccount] \ub9cc\uae30 \ucc98\ub9ac \ud6c4 userDoc \uac31\uc2e0 \uc644\ub8cc")})),console.log("\uc804\uccb4 \ub370\uc774\ud130 \ub2e4\uc2dc \ub85c\ub4dc"),await q()}catch(g){console.error("\ub9cc\uae30 \ucc98\ub9ac \uc911 \uc624\ub958 \ubc1c\uc0dd:",g),F("\ucc98\ub9ac \uc624\ub958: ".concat(g.message),"error"),void 0!==(null===m||void 0===m?void 0:m.cash)&&(console.log("\uc624\ub958 \ubc1c\uc0dd\uc73c\ub85c \ud604\uae08 \ub864\ubc31:",m.cash),P(m.cash))}finally{v(!1),console.log("--- handleMaturity \uc885\ub8cc ---")}},J=async e=>{console.log("--- handleCancelEarly \uc2dc\uc791 ---"),console.log("\uc911\ub3c4 \ud574\uc9c0\ud560 \uc0c1\ud488:",e);const{id:t,name:s,type:a,balance:n}=e,i="loan"===a;if(!y)return F("\uc0ac\uc6a9\uc790 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694.","error"),void console.error("handleCancelEarly: userId\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const o=i?"\ub300\ucd9c\uae08 ".concat(Os(n),"\uc6d0\uc744 \uc0c1\ud658\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"):"'".concat(s,"'\uc744(\ub97c) \uc911\ub3c4 \ud574\uc9c0\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? (\uc774\uc790 \uc5c6\uc774 \uc6d0\uae08\ub9cc \ubc18\ud658\ub429\ub2c8\ub2e4)");if(!window.confirm(o))return void console.log("\uc0ac\uc6a9\uc790\uac00 \uc911\ub3c4 \ud574\uc9c0\ub97c \ucde8\uc18c\ud588\uc2b5\ub2c8\ub2e4.");v(!0),console.log("\uc911\ub3c4 \ud574\uc9c0 \ucc98\ub9ac \uc2dc\uc791...");let l=e.teacherId;if(!l){const e=await Rs(null===m||void 0===m?void 0:m.classCode);if(!e)return F("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.","error"),void v(!1);l=e.id}console.log("\uc120\uc0dd\ub2d8 \uacc4\uc815 ID:",l);const r={deposit:[...T],savings:[...D],loan:[...z]},d=B,c=i?-n:n;P(e=>e+c),"deposit"===a?M(e=>e.filter(e=>e.id!==t)):"savings"===a?R(e=>e.filter(e=>e.id!==t)):"loan"===a&&O(e=>e.filter(e=>e.id!==t));try{const e=(0,G.H9)(G.db,"users",y,"products",String(t));console.log("Firestore \ubb38\uc11c \ucc38\uc870:",e.path),await(0,G.c4)(G.db,async t=>{var s,a,o,r;console.log("\ud2b8\ub79c\uc7ad\uc158 \uc2dc\uc791");const d=(0,G.H9)(G.db,"users",y),c=(0,G.H9)(G.db,"users",l),p=await t.get(d),u=await t.get(c);if(!p.exists())throw new Error("\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!u.exists())throw new Error("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const m=null!==(s=null===(a=p.data())||void 0===a?void 0:a.cash)&&void 0!==s?s:0,x=null!==(o=null===(r=u.data())||void 0===r?void 0:r.cash)&&void 0!==o?o:0;if(console.log("\ud604\uc7ac \ubcf4\uc720 \ud604\uae08 (DB): ".concat(m,", \uc120\uc0dd\ub2d8 \ubcf4\uc720 \ud604\uae08: ").concat(x)),i){if(m<n)throw new Error("\ub300\ucd9c\uae08\uc744 \uc0c1\ud658\ud558\uae30\uc5d0 \ud604\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");t.update(d,{cash:(0,G.GV)(-n)}),t.update(c,{cash:(0,G.GV)(n)}),console.log("\ub300\ucd9c \uc911\ub3c4 \uc0c1\ud658: \ud559\uc0dd -".concat(n,", \uc120\uc0dd\ub2d8 +").concat(n))}else{if(x<n)throw new Error("\uc740\ud589(\uc120\uc0dd\ub2d8)\uc5d0 \uc9c0\uae09\ud560 \uc790\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4. (\ud544\uc694: ".concat(Os(n),"\uc6d0)"));t.update(d,{cash:(0,G.GV)(n)}),t.update(c,{cash:(0,G.GV)(-n)}),console.log("\uc911\ub3c4 \ud574\uc9c0: \ud559\uc0dd +".concat(n,", \uc120\uc0dd\ub2d8 -").concat(n))}t.delete(e),console.log("\uc0c1\ud488 \ubb38\uc11c \uc0ad\uc81c \uc608\uc57d"),console.log("\ud2b8\ub79c\uc7ad\uc158 \ucee4\ubc0b \uc2dc\ub3c4")}),console.log("\ud2b8\ub79c\uc7ad\uc158 \uc131\uacf5");const o=i?"\ub300\ucd9c \uc0c1\ud658 \uc644\ub8cc: ".concat(Os(n),"\uc6d0 (\uc120\uc0dd\ub2d8 \uacc4\uc815\uc73c\ub85c \uc774\uccb4)"):"\uc911\ub3c4 \ud574\uc9c0 \uc644\ub8cc: \uc6d0\uae08 ".concat(Os(n),"\uc6d0 \ubc18\ud658 (\uc120\uc0dd\ub2d8 \uacc4\uc815\uc5d0\uc11c \uc9c0\uae09)");F(o,"success");const r=i?gs.gI.LOAN_REPAY:gs.gI.DEPOSIT_WITHDRAW;(0,gs.Mx)(G.db,{classCode:null===m||void 0===m?void 0:m.classCode,userId:y,userName:(null===m||void 0===m?void 0:m.name)||"\uc0ac\uc6a9\uc790",type:r,description:i?"\ub300\ucd9c \uc911\ub3c4 \uc0c1\ud658: ".concat(s," (").concat(Os(n),"\uc6d0) - \uc120\uc0dd\ub2d8 \uacc4\uc815\uc73c\ub85c"):"\uc911\ub3c4 \ud574\uc9c0: ".concat(s," (\uc6d0\uae08 ").concat(Os(n),"\uc6d0) - \uc120\uc0dd\ub2d8 \uacc4\uc815\uc5d0\uc11c"),amount:c,metadata:{productName:s,productType:a,principal:n,isEarlyCancellation:!0,teacherId:l}}),h&&(console.log("userDoc \uac31\uc2e0 \uc2dc\uc791"),h()),await q()}catch(p){console.error("\uc911\ub3c4 \ud574\uc9c0 \ucc98\ub9ac \uc911 \uc624\ub958 \ubc1c\uc0dd:",p),F("\ucc98\ub9ac \uc624\ub958: ".concat(p.message),"error"),M(r.deposit),R(r.savings),O(r.loan),P(d)}finally{v(!1),console.log("--- handleCancelEarly \uc885\ub8cc ---")}},V=async e=>{if(g()){if(window.confirm("\uc815\ub9d0\ub85c \uc774 \uc0c1\ud488(".concat(e.name,")\uc744 \uac15\uc81c\ub85c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))){v(!0);try{const t=(0,G.H9)(G.db,"users",e.userId,"products",e.id);await(0,G.kd)(t),F("\uc0c1\ud488\uc774 \uac15\uc81c\ub85c \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.","success"),q()}catch(t){console.error("\uad00\ub9ac\uc790 \uc0c1\ud488 \uc0ad\uc81c \uc911 \uc624\ub958:",t),F("\uc0ad\uc81c \ucc98\ub9ac \uc624\ub958: ".concat(t.message),"error")}finally{v(!1)}}}else F("\uad00\ub9ac\uc790 \uad8c\ud55c\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.","error")};return x?(0,L.jsx)("div",{style:zs.container,children:"\uae08\uc735 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911\uc785\ub2c8\ub2e4..."}):u?(0,L.jsxs)("div",{style:zs.container,children:[(0,L.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"24px",borderBottom:"2px solid rgba(255, 255, 255, 0.1)",paddingBottom:"0",position:"relative"},children:[(0,L.jsx)("button",{onClick:()=>r&&r("parking"),style:{padding:"12px 24px",border:"none",background:"parking"===o?"rgba(0, 255, 242, 0.1)":"none",cursor:"pointer",fontSize:"17px",fontWeight:"parking"===o?"700":"500",color:"parking"===o?"#00fff2":"#94a3b8",borderBottom:"3px solid ".concat("parking"===o?"#00fff2":"transparent"),marginBottom:"-2px",borderRadius:"8px 8px 0 0",transition:"all 0.2s ease"},children:"\ub098\uc758 \uae08\uc735 \ud604\ud669"}),g&&g()&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("button",{onClick:()=>r&&r("admin"),style:{padding:"12px 24px",border:"none",background:"admin"===o?"rgba(0, 255, 242, 0.1)":"none",cursor:"pointer",fontSize:"17px",fontWeight:"admin"===o?"700":"500",color:"admin"===o?"#00fff2":"#94a3b8",borderBottom:"3px solid ".concat("admin"===o?"#00fff2":"transparent"),marginBottom:"-2px",borderRadius:"8px 8px 0 0",transition:"all 0.2s ease"},children:"\uc0c1\ud488 \uad00\ub9ac"}),(0,L.jsx)("button",{onClick:()=>{r&&r("userProducts"),d&&d()},style:{padding:"12px 24px",border:"none",background:"userProducts"===o?"rgba(0, 255, 242, 0.1)":"none",cursor:"pointer",fontSize:"17px",fontWeight:"userProducts"===o?"700":"500",color:"userProducts"===o?"#00fff2":"#94a3b8",borderBottom:"3px solid ".concat("userProducts"===o?"#00fff2":"transparent"),marginBottom:"-2px",borderRadius:"8px 8px 0 0",transition:"all 0.2s ease"},children:"\uc720\uc800 \uc0c1\ud488 \uc870\ud68c"})]})]}),w&&(0,L.jsx)("div",{style:zs.message(C),children:w}),"userProducts"===o&&g&&g()&&(0,L.jsxs)("div",{style:{backgroundColor:"rgba(20, 20, 35, 0.6)",borderRadius:"16px",padding:"32px",boxShadow:"0 6px 20px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.05)"},children:[(0,L.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"16px",color:"#fff"},children:"\uc720\uc800\ubcc4 \uac00\uc785 \uc0c1\ud488 \uc870\ud68c \ubc0f \uad00\ub9ac"}),(0,L.jsx)("p",{style:{fontSize:"14px",color:"#94a3b8",marginBottom:"20px"},children:"\ud074\ub798\uc2a4 \ub0b4 \ubaa8\ub4e0 \uc720\uc800\uc758 \uac00\uc785 \uc0c1\ud488\uc744 \uc870\ud68c\ud558\uace0 \ud544\uc694\uc2dc \uac15\uc81c \uc0ad\uc81c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),0===c.length?(0,L.jsx)("p",{style:{textAlign:"center",padding:"40px",color:"#94a3b8"},children:"\uac00\uc785\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,L.jsxs)("div",{style:{overflowX:"auto"},children:[(0,L.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{style:{backgroundColor:"rgba(255, 255, 255, 0.05)",borderBottom:"2px solid rgba(255, 255, 255, 0.1)"},children:[(0,L.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uc0ac\uc6a9\uc790"}),(0,L.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uc0c1\ud488\uba85"}),(0,L.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uc885\ub958"}),(0,L.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uc794\uc561/\uae08\uc561"}),(0,L.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uae08\ub9ac(\uc77c)"}),(0,L.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uae30\uac04(\uc77c)"}),(0,L.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\ub9cc\uae30\uc77c"}),(0,L.jsx)("th",{style:{padding:"12px",textAlign:"left",fontSize:"14px",fontWeight:"600",color:"#94a3b8"},children:"\uad00\ub9ac"})]})}),(0,L.jsx)("tbody",{children:c.map((e,t)=>{const s="deposit"===e.type?"\uc608\uae08":"savings"===e.type?"\uc801\uae08":"loan"===e.type?"\ub300\ucd9c":"\uae30\ud0c0";return(0,L.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255, 255, 255, 0.05)"},children:[(0,L.jsx)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:e.userName}),(0,L.jsx)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:e.name}),(0,L.jsx)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:s}),(0,L.jsxs)("td",{style:{padding:"12px",fontSize:"14px",color:"#00fff2"},children:[(0,Le.bL)(e.balance||0),"\uc6d0"]}),(0,L.jsxs)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:[e.rate,"%"]}),(0,L.jsxs)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:[e.termInDays,"\uc77c"]}),(0,L.jsx)("td",{style:{padding:"12px",fontSize:"14px",color:"#e2e8f0"},children:e.maturityDate?new Date(e.maturityDate).toLocaleDateString("ko-KR"):"-"}),(0,L.jsx)("td",{style:{padding:"12px"},children:(0,L.jsx)("button",{onClick:()=>p&&p(e),style:(0,l.A)((0,l.A)({},zs.button(!1,"danger")),{},{fontSize:"12px",padding:"6px 12px"}),children:"\uc0ad\uc81c"})})]},"".concat(e.userId,"-").concat(e.id,"-").concat(t))})})]}),(0,L.jsxs)("div",{style:{marginTop:"20px",textAlign:"right",color:"#94a3b8",fontSize:"14px"},children:["\ucd1d ",c.length,"\uac1c\uc758 \uc0c1\ud488"]})]})]}),"parking"===o&&(0,L.jsxs)("div",{style:zs.grid,children:[(0,L.jsx)(Us,{balance:S,dailyInterest:I,onDeposit:async e=>{const t=parseFloat(e);if(isNaN(t)||t<=0)return F("\uc720\ud6a8\ud55c \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694.","error");v(!0);const s=S,a=B;A(e=>e+t);try{if(!await b(t,"\ud30c\ud0b9\ud1b5\uc7a5 \uc785\uae08: ".concat(Os(t),"\uc6d0")))throw new Error("\ubcf4\uc720 \ud604\uae08 \ucc28\uac10\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");await(0,G.c4)(G.db,async e=>{const s=(0,G.H9)(G.db,"users",y,"financials","parkingAccount");(await e.get(s)).exists()?e.update(s,{balance:(0,G.GV)(t)}):e.set(s,{balance:t,lastInterestDate:(0,G.O5)()})}),F("".concat(Os(t),"\uc6d0 \uc785\uae08 \uc644\ub8cc."),"success"),(0,gs.Mx)(G.db,{classCode:null===m||void 0===m?void 0:m.classCode,userId:y,userName:(null===m||void 0===m?void 0:m.name)||"\uc0ac\uc6a9\uc790",type:gs.gI.PARKING_DEPOSIT,description:"\ud30c\ud0b9\ud1b5\uc7a5 \uc785\uae08 ".concat(Os(t),"\uc6d0"),amount:-t,metadata:{parkingBalance:S+t}}),await q()}catch(n){F("\ucc98\ub9ac \uc624\ub958: ".concat(n.message),"error"),A(s),P(a)}finally{v(!1)}},onWithdraw:async e=>{const t=parseFloat(e);if(isNaN(t)||t<=0)return F("\uc720\ud6a8\ud55c \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694.","error");v(!0);const s=S,a=B;A(e=>e-t);try{await(0,G.c4)(G.db,async e=>{var s,a;const n=(0,G.H9)(G.db,"users",y,"financials","parkingAccount");if((null!==(s=null===(a=(await e.get(n)).data())||void 0===a?void 0:a.balance)&&void 0!==s?s:0)<t)throw new Error("\ud30c\ud0b9\ud1b5\uc7a5 \uc794\uc561\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");e.update(n,{balance:(0,G.GV)(-t)})});if(!await f(t,"\ud30c\ud0b9\ud1b5\uc7a5 \ucd9c\uae08: ".concat(Os(t),"\uc6d0")))throw new Error("\ubcf4\uc720 \ud604\uae08 \ucd94\uac00\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");F("".concat(Os(t),"\uc6d0 \ucd9c\uae08 \uc644\ub8cc."),"success"),(0,gs.Mx)(G.db,{classCode:null===m||void 0===m?void 0:m.classCode,userId:y,userName:(null===m||void 0===m?void 0:m.name)||"\uc0ac\uc6a9\uc790",type:gs.gI.PARKING_WITHDRAW,description:"\ud30c\ud0b9\ud1b5\uc7a5 \ucd9c\uae08 ".concat(Os(t),"\uc6d0"),amount:t,metadata:{parkingBalance:S-t}}),await q()}catch(n){F("\ucc98\ub9ac \uc624\ub958: ".concat(n.message),"error"),A(s),P(a)}finally{v(!1)}},isProcessing:j,userCash:B}),(0,L.jsx)(Fs,{title:"\uc608\uae08",icon:Ws.deposits,subscribedProducts:T,availableProducts:s,onSubscribe:e=>U(e,"deposits"),onCancel:J,onMaturity:H,isAdmin:g(),onAdminDelete:V}),(0,L.jsx)(Fs,{title:"\uc801\uae08",icon:Ws.savings,subscribedProducts:D,availableProducts:n,onSubscribe:e=>U(e,"savings"),onCancel:J,onMaturity:H,isAdmin:g(),onAdminDelete:V}),(0,L.jsx)(Fs,{title:"\ub300\ucd9c",icon:Ws.loans,subscribedProducts:z,availableProducts:i,onSubscribe:e=>U(e,"loans"),onCancel:J,onMaturity:H,isAdmin:g(),onAdminDelete:V})]}),(0,L.jsx)(qs,{isOpen:_.isOpen,onClose:Q,product:_.product,onConfirm:async e=>{console.log("--- handleSubscribe \uc2dc\uc791 ---");const t=parseFloat(e),{product:s,type:a}=_;if(console.log("\uac00\uc785\ud560 \uc0c1\ud488:",s),console.log("\uac00\uc785 \uc720\ud615: ".concat(a,", \uac00\uc785 \uae08\uc561: ").concat(t)),isNaN(t)||t<=0)return console.error("\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \uae08\uc561:",e),F("\uc720\ud6a8\ud55c \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694.","error");if(s.minAmount&&t<s.minAmount)return console.error("\ucd5c\uc18c \uac00\uc785 \uae08\uc561 \ubbf8\ub2ec: ".concat(t," < ").concat(s.minAmount)),F("\ucd5c\uc18c \uac00\uc785 \uae08\uc561\uc740 ".concat(Os(s.minAmount),"\uc6d0\uc785\ub2c8\ub2e4."),"error");if(s.maxAmount&&t>s.maxAmount)return console.error("\ucd5c\ub300 \uac00\uc785 \ud55c\ub3c4 \ucd08\uacfc: ".concat(t," > ").concat(s.maxAmount)),F("\ucd5c\ub300 \uac00\uc785 \ud55c\ub3c4\ub294 ".concat(Os(s.maxAmount),"\uc6d0\uc785\ub2c8\ub2e4."),"error");v(!0),Q();const n=await Rs(null===m||void 0===m?void 0:m.classCode);if(!n)return F("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694.","error"),void v(!1);console.log("\uc120\uc0dd\ub2d8 \uacc4\uc815:",n.name,n.id);const i="temp_".concat(Date.now()),o=new Date(Date.now()+24*s.termInDays*60*60*1e3),l={id:i,name:s.name,termInDays:s.termInDays,rate:s.dailyRate,balance:t,startDate:new Date,maturityDate:o,type:"deposits"===a?"deposit":"savings"===a?"savings":"loan",isOptimistic:!0};"deposit"===l.type?M(e=>[...e,l]):"savings"===l.type?R(e=>[...e,l]):"loan"===l.type&&O(e=>[...e,l]);const r="loans"===a?t:-t;P(e=>e+r);try{await(0,G.c4)(G.db,async e=>{var i,l,r,d;const c=(0,G.H9)(G.db,"users",y),p=(0,G.H9)(G.db,"users",n.id),u=await e.get(c),m=await e.get(p);if(!u.exists())throw new Error("\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!m.exists())throw new Error("\uc120\uc0dd\ub2d8(\uc740\ud589) \uacc4\uc815\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const x=null!==(i=null===(l=u.data())||void 0===l?void 0:l.cash)&&void 0!==i?i:0,h=null!==(r=null===(d=m.data())||void 0===d?void 0:d.cash)&&void 0!==r?r:0;if("loans"!==a&&x<t)throw new Error("\ubcf4\uc720 \ud604\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");if("loans"===a&&h<t)throw new Error("\uc740\ud589(\uc120\uc0dd\ub2d8)\uc5d0 \ub300\ucd9c \uac00\ub2a5\ud55c \uc790\uae08\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");const g={name:s.name,termInDays:s.termInDays,rate:s.dailyRate,balance:t,startDate:(0,G.O5)(),maturityDate:o,type:"deposits"===a?"deposit":"savings"===a?"savings":"loan",teacherId:n.id,teacherName:n.name||"\uc120\uc0dd\ub2d8"},f=(0,G.H9)((0,G.rJ)(G.db,"users",y,"products"));e.set(f,g),"loans"===a?(e.update(c,{cash:(0,G.GV)(t)}),e.update(p,{cash:(0,G.GV)(-t)})):(e.update(c,{cash:(0,G.GV)(-t)}),e.update(p,{cash:(0,G.GV)(t)}))});const e="loans"===a?"\ub300\ucd9c":"\uac00\uc785";F("".concat(s.name," ").concat(e,"\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. (\uc120\uc0dd\ub2d8 \uacc4\uc815\uacfc \uc5f0\ub3d9)"),"success");const i="deposits"===a||"savings"===a?gs.gI.DEPOSIT_CREATE:gs.gI.LOAN_CREATE;(0,gs.Mx)(G.db,{classCode:null===m||void 0===m?void 0:m.classCode,userId:y,userName:(null===m||void 0===m?void 0:m.name)||"\uc0ac\uc6a9\uc790",type:i,description:"".concat(s.name," ").concat("loans"===a?"\ub300\ucd9c":"\uac00\uc785"," (").concat(Os(t),"\uc6d0) - \uc120\uc0dd\ub2d8 \uacc4\uc815 \uc5f0\ub3d9"),amount:r,metadata:{productName:s.name,productType:a,termInDays:s.termInDays,dailyRate:s.dailyRate,maturityDate:o.toISOString(),teacherId:n.id,teacherName:n.name}}),await q(),h&&h()}catch(d){console.error("\uac00\uc785 \ucc98\ub9ac \uc911 \uc624\ub958 \ubc1c\uc0dd:",d),F("\ucc98\ub9ac \uc624\ub958: ".concat(d.message),"error"),"deposit"===l.type?M(e=>e.filter(e=>e.id!==i)):"savings"===l.type?R(e=>e.filter(e=>e.id!==i)):"loan"===l.type&&O(e=>e.filter(e=>e.id!==i)),P(e=>e-r)}finally{v(!1)}},isProcessing:j})]}):(0,L.jsx)("div",{style:zs.container,children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})},Hs=e=>Array.isArray(e)?e.map(e=>({id:e.id,name:e.name,dailyRate:void 0===e.dailyRate||isNaN(e.dailyRate)?0:parseFloat(e.dailyRate),termInDays:void 0===e.termInDays||isNaN(e.termInDays)?1:parseInt(e.termInDays),minAmount:void 0===e.minAmount||isNaN(e.minAmount)?0:parseInt(e.minAmount),maxAmount:void 0===e.maxAmount||isNaN(e.maxAmount)?0:parseInt(e.maxAmount)})):(console.error("convertAdminProductsToAccountFormat: \uc785\ub825\uac12\uc774 \ubc30\uc5f4\uc774 \uc544\ub2d9\ub2c8\ub2e4.",e),[]),Gs=()=>{var e,t,s,o,r;const d=(0,i.As)(),c=(0,n.Zp)(),[p,u]=(0,a.useState)(null),[m,x]=(0,a.useState)(""),[h,g]=(0,a.useState)("parking"),[f,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)([]),[v,w]=(0,a.useState)([]),[N,k]=(0,a.useState)([]),[S,A]=(0,a.useState)([]),I=async()=>{var e,t,s;if(null!==d&&void 0!==d&&null!==(e=d.userDoc)&&void 0!==e&&e.classCode&&(null!==(t=d.userDoc)&&void 0!==t&&t.isAdmin||"admin"===(null===(s=d.userDoc)||void 0===s?void 0:s.role))){b(!0);try{const e=(0,ee.query)((0,ee.rJ)(G.db,"users"),(0,ee.where)("classCode","==",d.userDoc.classCode)),t=await(0,ee.getDocs)(e),s={};t.forEach(e=>{s[e.id]=(0,l.A)({id:e.id,name:e.data().name||e.data().nickname||"\uc54c \uc218 \uc5c6\uc74c"},e.data())});const a=[],n=Object.keys(s).map(async e=>{const t=(0,ee.rJ)(G.db,"users",e,"products");return(await(0,ee.getDocs)(t)).docs.map(t=>{var a;const n=t.data();return(0,l.A)((0,l.A)({firestoreId:t.id,userId:e,userName:s[e].name},n),{},{maturityDate:null!==(a=n.maturityDate)&&void 0!==a&&a.toDate?n.maturityDate.toDate():n.maturityDate})})});(await Promise.all(n)).forEach(e=>{a.push(...e)}),A(a),console.log("\uc720\uc800 \uc0c1\ud488 \ub85c\ub4dc \uc644\ub8cc:",a)}catch(a){console.error("\uc720\uc800 \uc0c1\ud488 \ub85c\ub4dc \uc911 \uc624\ub958:",a),u("\uc720\uc800 \uc0c1\ud488 \ub85c\ub4dc \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),x("error")}finally{b(!1)}}},[E,T]=(0,a.useState)([]),[M,D]=(0,a.useState)([]),[R,z]=(0,a.useState)([]);(0,a.useEffect)(()=>{var e;d&&!d.loading&&d.user&&null!==(e=d.userDoc)&&void 0!==e&&e.classCode?(async()=>{var e;const t=null===d||void 0===d||null===(e=d.userDoc)||void 0===e?void 0:e.classCode;if(t&&"\ubbf8\uc9c0\uc815"!==t){b(!0);try{const e=await(0,G.jy)(t,!0,"Banking");e.deposits?j(e.deposits):j([]),e.savings?w(e.savings):w([]),e.loans?k(e.loans):k([])}catch(s){console.error("\ubc45\ud0b9 \uc0c1\ud488 \ub85c\ub4dc \uc911 \uc624\ub958:",s),u("\ub370\uc774\ud130 \ub85c\ub529 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),x("error")}finally{b(!1)}}else console.warn("[Banking] \uc720\ud6a8\ud55c \ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc5b4 \ubc45\ud0b9 \uc0c1\ud488\uc744 \ub85c\ub4dc\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.")})():!d||d.loading||d.user||(setParkingSavingsProducts([]),w([]),k([]))},[null===d||void 0===d?void 0:d.user,null===d||void 0===d?void 0:d.loading,null===d||void 0===d||null===(e=d.userDoc)||void 0===e?void 0:e.classCode]),(0,a.useEffect)(()=>{T(Hs(y)),D(Hs(v)),z(Hs(N))},[y,v,N]);const O=(e,t,s,a)=>{let n,i;switch(e){case"deposits":n=y,i=j;break;case"installments":n=v,i=w;break;case"loans":n=N,i=k;break;default:return}i(n.map((e,n)=>{if(n===t){const t=(0,l.A)({},e);if("termInDays"===s||"minAmount"===s||"maxAmount"===s){const e=parseInt(a);t[s]=isNaN(e)||e<("termInDays"===s?1:0)?"termInDays"===s?1:0:e}else if("dailyRate"===s){const e=parseFloat(a);t.dailyRate=isNaN(e)||e<0?0:e}else"name"===s&&(t[s]=a);return t}return e}))},_=async e=>{var t;if(null===d||void 0===d||null===(t=d.userDoc)||void 0===t||!t.classCode)return u("\ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc5b4 \uc800\uc7a5\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),void x("error");b(!0);try{let t,s;switch(e){case"deposits":t=y,s="deposits";break;case"installments":t=v,s="savings";break;case"loans":t=N,s="loans";break;default:return}await(0,G.OP)(d.userDoc.classCode,s,t),u("".concat("deposits"===e?"\uc608\uae08":"installments"===e?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")),x("success"),setTimeout(()=>{u(null),x("")},3e3)}catch(s){console.error("".concat(e," \uc0c1\ud488 \uc800\uc7a5 \uc911 \uc624\ub958:"),s),u("\uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),x("error")}finally{b(!1)}},W=e=>{const t={id:Date.now(),name:"\uc0c8 ".concat("deposits"===e?"\uc608\uae08":"installments"===e?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488"),dailyRate:.01,termInDays:365,minAmount:"loans"===e?0:1e5,maxAmount:"loans"===e?1e6:0};switch(e){case"deposits":j([...y,t]);break;case"installments":w([...v,t]);break;case"loans":k([...N,t])}},B=async(e,t)=>{var s;if(f)return;let a,n;switch(e){case"deposits":a=y,n=j;break;case"installments":a=v,n=w;break;case"loans":a=N,n=k;break;default:return}const i=a.filter((e,s)=>s!==t);if(n(i),null!==d&&void 0!==d&&null!==(s=d.userDoc)&&void 0!==s&&s.classCode){b(!0);try{const t="deposits"===e?"deposits":"installments"===e?"savings":"loans";await(0,G.OP)(d.userDoc.classCode,t,i),u("\uc0c1\ud488\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),x("info"),setTimeout(()=>{u(null),x("")},2e3)}catch(o){console.error("\uc0c1\ud488 \uc0ad\uc81c \uc911 \uc624\ub958:",o),u("\uc0ad\uc81c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),x("error"),n(a)}finally{b(!1)}}};return d.loading?(0,L.jsx)(wa,{}):(0,L.jsxs)(Pt.LN,{children:[f&&(0,L.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,L.jsx)(wa,{})}),(0,L.jsxs)("div",{className:"px-4 py-6 sm:px-6",children:[(0,L.jsx)(Pt.zY,{title:"\ud1b5\ud569 \uae08\uc735 \uad00\ub9ac",subtitle:"\uc608\uae08, \uc801\uae08, \ub300\ucd9c \uc0c1\ud488\uc744 \uad00\ub9ac\ud558\uc138\uc694",icon:C.A,backButton:(0,L.jsx)(Pt.rA,{variant:"ghost",icon:K.A,onClick:()=>c(-1),children:"\ub4a4\ub85c\uac00\uae30"})}),p&&(0,L.jsx)("div",{className:"mb-4 p-4 rounded-xl ".concat("error"===m?"bg-red-900/40 text-red-200 border border-red-800/50":"success"===m?"bg-emerald-900/40 text-emerald-200 border border-emerald-800/50":"bg-blue-900/40 text-blue-200 border border-blue-800/50"),children:p}),(0,L.jsxs)("div",{className:"admin"===h?"content-box":"",children:[("parking"===h||"userProducts"===h)&&(0,L.jsx)(Qs,{auth:d,depositProducts:E,installmentProducts:M,loanProducts:R,activeView:h,onViewChange:g,onLoadUserProducts:I,allUserProducts:S,onDeleteUserProduct:async e=>{var t,s;if(console.log("\uc0ad\uc81c \uc2dc\ub3c4:",e),!(null!==(t=d.userDoc)&&void 0!==t&&t.isAdmin||"admin"===(null===(s=d.userDoc)||void 0===s?void 0:s.role)))return console.log("\uad00\ub9ac\uc790 \uad8c\ud55c \uc5c6\uc74c"),void alert("\uad00\ub9ac\uc790 \uad8c\ud55c\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.");if(window.confirm("'".concat(e.userName,"'\ub2d8\uc758 '").concat(e.name,"' \uc0c1\ud488\uc744 \uac15\uc81c\ub85c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))){b(!0);try{const t=e.firestoreId||String(e.id);console.log("\uc0ad\uc81c \uacbd\ub85c:","users/".concat(e.userId,"/products/").concat(t)),console.log("\uc0ac\uc6a9\ud560 \ubb38\uc11c ID:",t);const s=(0,ee.H9)(G.db,"users",e.userId,"products",t);console.log("\uc0ad\uc81c \uc2dc\uc791..."),await(0,ee.kd)(s),console.log("\uc0ad\uc81c \uc644\ub8cc"),u("\uc0c1\ud488\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),x("success"),console.log("\ubaa9\ub85d \uc0c8\ub85c\uace0\uce68 \uc2dc\uc791..."),await I(),console.log("\ubaa9\ub85d \uc0c8\ub85c\uace0\uce68 \uc644\ub8cc"),setTimeout(()=>{u(null),x("")},3e3)}catch(a){console.error("\uc0c1\ud488 \uc0ad\uc81c \uc911 \uc624\ub958:",a),u("\uc0ad\uc81c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(a.message)),x("error")}finally{b(!1)}}else console.log("\uc0ac\uc6a9\uc790\uac00 \uc0ad\uc81c \ucde8\uc18c")},isLoading:f}),"admin"===h&&d.user&&((null===(t=d.userDoc)||void 0===t?void 0:t.isAdmin)||"admin"===(null===(s=d.userDoc)||void 0===s?void 0:s.role))&&(0,L.jsxs)("div",{children:[(0,L.jsx)("h2",{className:"admin-header",children:"\uad00\ub9ac\uc790 - \uae08\uc735 \uc0c1\ud488 \uad00\ub9ac (\uc77c \ubcf5\ub9ac \uae30\uc900)"}),(0,L.jsxs)("div",{className:"admin-section",children:[(0,L.jsx)("h3",{children:"\ud30c\ud0b9 \uc608\uae08 \uc0c1\ud488"}),(0,L.jsx)("p",{className:"admin-info-text",children:"\uc77c \uc774\uc728(%)\uacfc \uae30\uac04(\uc77c)\uc744 \uc785\ub825\ud569\ub2c8\ub2e4. \ubcc0\uacbd \ud6c4 '\uc800\uc7a5' \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694."}),(0,L.jsxs)("table",{className:"admin-table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{style:{width:"25%"},children:"\uc0c1\ud488\uba85"}),(0,L.jsx)("th",{style:{width:"15%"},children:"\uae30\uac04(\uc77c)"}),(0,L.jsx)("th",{style:{width:"18%"},children:"\uc77c \uc774\uc728(%)"}),(0,L.jsx)("th",{style:{width:"18%"},children:"\ucd5c\uc18c\uae08\uc561(\uc6d0)"}),(0,L.jsx)("th",{style:{width:"12%"},children:"\uad00\ub9ac"})]})}),(0,L.jsx)("tbody",{children:y.map((e,t)=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"text",value:e.name||"",onChange:e=>O("deposits",t,"name",e.target.value),className:"admin-input",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"number",min:"1",value:e.termInDays||0,onChange:e=>O("deposits",t,"termInDays",e.target.value),className:"admin-input",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"number",step:"0.001",min:"0",value:e.dailyRate||0,onChange:e=>O("deposits",t,"dailyRate",e.target.value),className:"admin-input",placeholder:"\uc608: 0.01",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"number",min:"0",value:e.minAmount||0,onChange:e=>O("deposits",t,"minAmount",e.target.value),className:"admin-input",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("button",{onClick:()=>B("deposits",t),className:"admin-button-small delete-button ".concat(f?"disabled-button":""),disabled:f,children:"\uc0ad\uc81c"})})]},e.id))})]}),(0,L.jsxs)("div",{className:"admin-action-buttons",children:[(0,L.jsx)("button",{onClick:()=>W("deposits"),className:"admin-button-small add-button ".concat(f?"disabled-button":""),disabled:f,children:"\ucd94\uac00"}),(0,L.jsx)("button",{onClick:()=>_("deposits"),className:"admin-button-small save-button ".concat(f?"disabled-button":""),disabled:f,children:"\uc608\uae08 \uc0c1\ud488 \uc800\uc7a5"})]})]}),(0,L.jsxs)("div",{className:"admin-section",children:[(0,L.jsx)("h3",{children:"\ud30c\ud0b9 \uc801\uae08 \uc0c1\ud488"}),(0,L.jsx)("p",{className:"admin-info-text",children:"\uc77c \uc774\uc728(%)\uacfc \uae30\uac04(\uc77c)\uc744 \uc785\ub825\ud569\ub2c8\ub2e4. \ubcc0\uacbd \ud6c4 '\uc800\uc7a5' \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694."}),(0,L.jsxs)("table",{className:"admin-table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{style:{width:"25%"},children:"\uc0c1\ud488\uba85"}),(0,L.jsx)("th",{style:{width:"15%"},children:"\uae30\uac04(\uc77c)"}),(0,L.jsx)("th",{style:{width:"18%"},children:"\uc77c \uc774\uc728(%)"}),(0,L.jsx)("th",{style:{width:"18%"},children:"\ucd5c\uc18c \uc6d4\ub0a9\uc785(\uc6d0)"}),(0,L.jsx)("th",{style:{width:"12%"},children:"\uad00\ub9ac"})]})}),(0,L.jsx)("tbody",{children:v.map((e,t)=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"text",value:e.name||"",onChange:e=>O("installments",t,"name",e.target.value),className:"admin-input",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"number",min:"1",value:e.termInDays||0,onChange:e=>O("installments",t,"termInDays",e.target.value),className:"admin-input",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"number",step:"0.001",min:"0",value:e.dailyRate||0,onChange:e=>O("installments",t,"dailyRate",e.target.value),className:"admin-input",placeholder:"\uc608: 0.011",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"number",min:"0",value:e.minAmount||0,onChange:e=>O("installments",t,"minAmount",e.target.value),className:"admin-input",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("button",{onClick:()=>B("installments",t),className:"admin-button-small delete-button ".concat(f?"disabled-button":""),disabled:f,children:"\uc0ad\uc81c"})})]},e.id))})]}),(0,L.jsxs)("div",{className:"admin-action-buttons",children:[(0,L.jsx)("button",{onClick:()=>W("installments"),className:"admin-button-small add-button ".concat(f?"disabled-button":""),disabled:f,children:"\ucd94\uac00"}),(0,L.jsx)("button",{onClick:()=>_("installments"),className:"admin-button-small save-button ".concat(f?"disabled-button":""),disabled:f,children:"\uc801\uae08 \uc0c1\ud488 \uc800\uc7a5"})]})]}),(0,L.jsxs)("div",{className:"admin-section",style:{borderBottom:"none"},children:[(0,L.jsx)("h3",{children:"\ud30c\ud0b9 \ub300\ucd9c \uc0c1\ud488"}),(0,L.jsx)("p",{className:"admin-info-text",children:"\uc77c \uc774\uc728(%)\uacfc \uae30\uac04(\uc77c)\uc744 \uc785\ub825\ud569\ub2c8\ub2e4. \ubcc0\uacbd \ud6c4 '\uc800\uc7a5' \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694."}),(0,L.jsxs)("table",{className:"admin-table",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{style:{width:"25%"},children:"\uc0c1\ud488\uba85"}),(0,L.jsx)("th",{style:{width:"15%"},children:"\uae30\uac04(\uc77c)"}),(0,L.jsx)("th",{style:{width:"18%"},children:"\uc77c \uc774\uc728(%)"}),(0,L.jsx)("th",{style:{width:"18%"},children:"\ucd5c\ub300 \ub300\ucd9c\uc561(\uc6d0)"}),(0,L.jsx)("th",{style:{width:"12%"},children:"\uad00\ub9ac"})]})}),(0,L.jsx)("tbody",{children:N.map((e,t)=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"text",value:e.name||"",onChange:e=>O("loans",t,"name",e.target.value),className:"admin-input",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"number",min:"1",value:e.termInDays||0,onChange:e=>O("loans",t,"termInDays",e.target.value),className:"admin-input",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"number",step:"0.001",min:"0",value:e.dailyRate||0,onChange:e=>O("loans",t,"dailyRate",e.target.value),className:"admin-input",placeholder:"\uc608: 0.05",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("input",{type:"number",min:"0",value:e.maxAmount||0,onChange:e=>O("loans",t,"maxAmount",e.target.value),className:"admin-input",disabled:f,style:{backgroundColor:"rgba(255,255,255,0.05)",color:"#fff",border:"1px solid rgba(255,255,255,0.1)"}})}),(0,L.jsx)("td",{className:"admin-td",children:(0,L.jsx)("button",{onClick:()=>B("loans",t),className:"admin-button-small delete-button ".concat(f?"disabled-button":""),disabled:f,children:"\uc0ad\uc81c"})})]},e.id))})]}),(0,L.jsxs)("div",{className:"admin-action-buttons",children:[(0,L.jsx)("button",{onClick:()=>W("loans"),className:"admin-button-small add-button ".concat(f?"disabled-button":""),disabled:f,children:"\ucd94\uac00"}),(0,L.jsx)("button",{onClick:()=>_("loans"),className:"admin-button-small save-button ".concat(f?"disabled-button":""),disabled:f,children:"\ub300\ucd9c \uc0c1\ud488 \uc800\uc7a5"})]})]})]}),"admin"===h&&!(d.user&&(null!==(o=d.userDoc)&&void 0!==o&&o.isAdmin||"admin"===(null===(r=d.userDoc)||void 0===r?void 0:r.role)))&&(0,L.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300 p-4 rounded-xl border border-yellow-200 dark:border-yellow-800",children:"\uad00\ub9ac\uc790 \uad8c\ud55c\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})]})]})]})};var Js=s(458);function Vs(e){let{isOpen:t,onClose:s,userId:n,onSave:i}=e;const[o,r]=(0,a.useState)(ke),[d,c]=(0,a.useState)("skinTone"),[p,u]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{if(t&&n){const e=Se(n);r(e),u(!1)}},[t,n]),!t)return null;const m=Ae(d);return(0,L.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"10px"},onClick:s,children:(0,L.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",borderRadius:"20px",padding:"20px",maxWidth:"600px",width:"100%",maxHeight:"90vh",overflowY:"auto",border:"2px solid #a78bfa40",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)"},onClick:e=>e.stopPropagation(),children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,L.jsxs)("h2",{style:{margin:0,fontSize:"20px",fontWeight:"700",color:"#e8e8ff",display:"flex",alignItems:"center",gap:"10px"},children:[(0,L.jsx)("span",{style:{fontSize:"24px"},children:"\ud83d\udc64"}),"\uc544\ubc14\ud0c0 \uafb8\ubbf8\uae30"]}),(0,L.jsx)("button",{onClick:s,style:{background:"transparent",border:"none",color:"#9ca3af",fontSize:"24px",cursor:"pointer"},children:"\u2715"})]}),(0,L.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"16px",padding:"16px",background:"linear-gradient(135deg, #11182750 0%, #1f293750 100%)",borderRadius:"16px",border:"1px solid #374151"},children:(0,L.jsxs)("div",{style:{position:"relative"},children:[(0,L.jsx)(Me,{config:o,size:150},JSON.stringify(o)),(0,L.jsx)("button",{onClick:()=>{const e={};Ee.forEach(t=>{const s=Ae(t.id);if(s.length>0){const a=Math.floor(Math.random()*s.length);e[t.id]=s[a].id}}),r(e),u(!0)},style:{position:"absolute",bottom:"-10px",right:"-10px",width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",border:"none",fontSize:"20px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(245, 158, 11, 0.4)"},title:"\ub79c\ub364 \uc0dd\uc131",children:"\ud83c\udfb2"})]})}),(0,L.jsx)("div",{style:{display:"flex",gap:"6px",overflowX:"auto",overflowY:"hidden",paddingBottom:"12px",marginBottom:"12px",WebkitOverflowScrolling:"touch",scrollbarWidth:"thin",msOverflowStyle:"auto"},children:Ee.map(e=>(0,L.jsxs)("button",{onClick:()=>c(e.id),style:{padding:"8px 12px",borderRadius:"10px",border:d===e.id?"2px solid #a78bfa":"2px solid transparent",background:d===e.id?"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)":"#374151",color:d===e.id?"#fff":"#9ca3af",fontSize:"12px",fontWeight:"600",cursor:"pointer",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s",minWidth:"fit-content"},children:[(0,L.jsx)("span",{style:{width:"14px",height:"14px",borderRadius:"50%",backgroundColor:e.icon,border:"2px solid rgba(255,255,255,0.3)",flexShrink:0}}),(0,L.jsx)("span",{children:e.name})]},e.id))}),(0,L.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(70px, 1fr))",gap:"8px",maxHeight:"200px",overflowY:"auto",padding:"8px",background:"#11182750",borderRadius:"12px",marginBottom:"16px"},children:m.map(e=>{const t=o[d]===e.id,s="hairstyle"===d&&!Ie(e.id,o.faceShape);return(0,L.jsxs)("button",{onClick:()=>!s&&(e=>{const t=(0,l.A)((0,l.A)({},o),{},{[d]:e});"faceShape"===d&&(Ie(o.hairstyle,e)||(t.hairstyle="short")),r(t),u(!0)})(e.id),disabled:s,style:{padding:"12px",borderRadius:"12px",border:t?"3px solid #a78bfa":"2px solid #374151",background:t?"linear-gradient(135deg, #a78bfa20 0%, #8b5cf620 100%)":"#1f2937",cursor:s?"not-allowed":"pointer",opacity:s?.4:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"6px",minWidth:"70px",transition:"all 0.2s"},children:[e.color&&(0,L.jsx)("div",{style:{width:"30px",height:"30px",borderRadius:"50%",backgroundColor:e.color,border:"2px solid rgba(255,255,255,0.3)",boxShadow:t?"0 0 10px ".concat(e.color):"none"}}),e.gradient&&(0,L.jsx)("div",{style:{width:"30px",height:"30px",borderRadius:"50%",background:"linear-gradient(135deg, ".concat(e.gradient.join(", "),")"),border:"2px solid rgba(255,255,255,0.3)"}}),"faceShape"===d&&e.path&&(0,L.jsx)("div",{style:{width:"36px",height:"36px"},children:(0,L.jsx)("svg",{viewBox:"0 0 100 100",width:"36",height:"36",children:(0,L.jsx)("path",{d:e.path,fill:"#F5DEB3",stroke:t?"#a78bfa":"#666",strokeWidth:"2"})})}),e.icon&&"faceShape"!==d&&(0,L.jsx)("div",{style:{width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px"},children:e.icon}),!e.color&&!e.gradient&&!e.path&&!e.icon&&(0,L.jsx)("div",{style:{width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",color:"#e8e8ff"},children:"none"===e.id?"\u274c":"\u2713"}),(0,L.jsx)("span",{style:{fontSize:"11px",color:t?"#a78bfa":"#9ca3af",fontWeight:t?"600":"400",textAlign:"center"},children:e.name}),s&&(0,L.jsx)("span",{style:{fontSize:"9px",color:"#ef4444"},children:"\ube44\ud638\ud658"})]},e.id)})}),(0,L.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,L.jsx)("button",{onClick:()=>{r((0,l.A)({},ke)),u(!0)},style:{padding:"10px 20px",borderRadius:"10px",border:"1px solid #374151",background:"transparent",color:"#9ca3af",fontSize:"14px",cursor:"pointer"},children:"\ucd08\uae30\ud654"}),(0,L.jsx)("button",{onClick:()=>{!function(e,t){try{return localStorage.setItem("avatar_".concat(e),JSON.stringify(t)),window.dispatchEvent(new CustomEvent("avatarChanged",{detail:{userId:e,config:t}})),!0}catch(s){return!1}}(n,o),u(!1),i&&i(o),s()},disabled:!p,style:{padding:"10px 24px",borderRadius:"10px",border:"none",background:p?"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)":"#374151",color:p?"#fff":"#6b7280",fontSize:"14px",fontWeight:"600",cursor:p?"pointer":"not-allowed",boxShadow:p?"0 4px 15px rgba(139, 92, 246, 0.4)":"none"},children:"\uc800\uc7a5\ud558\uae30"})]})]})})}function Ks(){var e;const{user:t,userDoc:s,logout:n}=(0,i.As)(),o=null===t||void 0===t?void 0:t.uid,l=(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.nickname)||(null===t||void 0===t?void 0:t.displayName)||"\uc0ac\uc6a9\uc790",[r,d]=(0,a.useState)(!1),[c,p]=(0,a.useState)(null),[u,m]=(0,a.useState)([]),[x,h]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!1),[b,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)(!1),[w,C]=(0,a.useState)(""),[k,S]=(0,a.useState)(""),[A,I]=(0,a.useState)(""),[E,T]=(0,a.useState)(""),[D,R]=(0,a.useState)(""),[z,O]=(0,a.useState)(""),[W,B]=(0,a.useState)(!1),[P,F]=(0,a.useState)(""),q=(Number(null===s||void 0===s?void 0:s.cash)||0)+(Number(null===s||void 0===s?void 0:s.stockValue)||0)+(Number(null===s||void 0===s?void 0:s.realEstateValue)||0)+(Number(null===s||void 0===s?void 0:s.itemValue)||0),U=Re(q);(0,a.useEffect)(()=>{o&&(p(Se(o)),m(_e(o)))},[o]);const Q=()=>{C(""),S(""),I(""),T(""),R(""),O(""),F(""),B(!1)},H={legendary:0,epic:1,rare:2,common:3},J=[...u].sort((e,t)=>{const s=Oe(e.id),a=Oe(t.id);return(H[null===s||void 0===s?void 0:s.rarity]||99)-(H[null===a||void 0===a?void 0:a.rarity]||99)}),K=J.length>0?Oe(J[0].id):null;return t?(0,L.jsxs)("div",{className:"w-full min-h-full",style:{backgroundColor:"#0a0a12"},children:[(0,L.jsxs)("div",{className:"w-full max-w-4xl mx-auto px-4 md:px-6 py-6",children:[(0,L.jsx)("h1",{style:{fontSize:"28px",fontWeight:"800",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",marginBottom:"24px"},children:"\ub0b4 \ud504\ub85c\ud544"}),(0,L.jsx)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"24px",padding:"32px",marginBottom:"24px",border:"2px solid #374151",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.4)"},children:(0,L.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"24px"},children:[(0,L.jsxs)("div",{style:{position:"relative"},children:[(0,L.jsx)(Me,{config:c,size:180}),(0,L.jsx)("button",{onClick:()=>d(!0),style:{position:"absolute",bottom:"5px",right:"5px",width:"44px",height:"44px",borderRadius:"50%",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",border:"3px solid #1a1a2e",fontSize:"18px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 15px rgba(167, 139, 250, 0.4)"},title:"\uc544\ubc14\ud0c0 \uc218\uc815",children:"\u270f\ufe0f"})]}),(0,L.jsxs)("div",{style:{textAlign:"center"},children:[(0,L.jsx)("h2",{style:{fontSize:"24px",fontWeight:"700",color:"#e8e8ff",marginBottom:"8px"},children:l}),(0,L.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"8px 16px",background:"linear-gradient(135deg, ".concat(U.color,"20 0%, ").concat(U.color,"10 100%)"),border:"2px solid ".concat(U.color),borderRadius:"20px",marginBottom:"12px"},children:[(0,L.jsx)("span",{style:{fontSize:"20px"},children:U.icon}),(0,L.jsxs)("span",{style:{color:U.color,fontWeight:"700",fontSize:"14px"},children:["Lv.",U.level," ",U.title]})]}),K&&(0,L.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"8px"},children:[(0,L.jsx)("span",{style:{fontSize:"18px"},children:K.icon}),(0,L.jsx)("span",{style:{color:"legendary"===K.rarity?"#f59e0b":"epic"===K.rarity?"#a78bfa":"rare"===K.rarity?"#3b82f6":"#9ca3af",fontWeight:"600",fontSize:"13px"},children:K.name})]}),(0,L.jsx)("div",{style:{marginTop:"12px"},children:(0,L.jsx)(Vt,{userId:o})})]})]})}),(0,L.jsxs)("div",{style:{background:"linear-gradient(145deg, #1e1e3f 0%, #16213e 100%)",borderRadius:"20px",padding:"24px",marginBottom:"24px",border:"2px solid #374151"},children:[(0,L.jsxs)("h3",{style:{color:"#a78bfa",fontSize:"18px",fontWeight:"700",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,L.jsx)("span",{children:"\ud83d\udcca"})," \ub808\ubca8 \uc9c4\ud589\ub3c4"]}),(0,L.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,L.jsxs)("span",{style:{color:"#9ca3af",fontSize:"14px"},children:[U.icon," Lv.",U.level," ",U.title]}),(0,L.jsxs)("span",{style:{color:"#e8e8ff",fontSize:"14px",fontWeight:"600"},children:[U.progress.toFixed(1),"%"]})]}),(0,L.jsx)("div",{style:{height:"12px",background:"#374151",borderRadius:"6px",overflow:"hidden"},children:(0,L.jsx)("div",{style:{width:"".concat(U.progress,"%"),height:"100%",background:"linear-gradient(90deg, ".concat(U.color," 0%, ").concat(U.color,"99 100%)"),borderRadius:"6px",transition:"width 0.5s ease"}})}),(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px",fontSize:"12px",color:"#6b7280"},children:[(0,L.jsxs)("span",{children:["\ud604\uc7ac: ",(0,Le.bL)(q)]}),U.level<De.length-1&&(0,L.jsxs)("span",{children:["\ub2e4\uc74c: ",(0,Le.bL)((null===(e=De[U.level+1])||void 0===e?void 0:e.minAssets)||0)]})]})]})]}),(0,L.jsxs)("div",{style:{background:"linear-gradient(145deg, #1e1e3f 0%, #16213e 100%)",borderRadius:"20px",padding:"24px",marginBottom:"24px",border:"2px solid #374151"},children:[(0,L.jsxs)("h3",{style:{color:"#a78bfa",fontSize:"18px",fontWeight:"700",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,L.jsx)("span",{children:"\ud83c\udfc6"})," \ud68d\ub4dd\ud55c \uc5c5\uc801 (",u.length,"\uac1c)"]}),0===u.length?(0,L.jsx)("div",{style:{textAlign:"center",padding:"32px",color:"#6b7280"},children:"\uc544\uc9c1 \ud68d\ub4dd\ud55c \uc5c5\uc801\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,L.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"12px"},children:J.map(e=>{const t=Oe(e.id);if(!t)return null;const s={legendary:{bg:"#f59e0b20",border:"#f59e0b",text:"#f59e0b"},epic:{bg:"#a78bfa20",border:"#a78bfa",text:"#a78bfa"},rare:{bg:"#3b82f620",border:"#3b82f6",text:"#3b82f6"},common:{bg:"#6b728020",border:"#6b7280",text:"#9ca3af"}},a=s[t.rarity]||s.common;return(0,L.jsxs)("div",{style:{background:a.bg,border:"2px solid ".concat(a.border),borderRadius:"12px",padding:"16px",textAlign:"center",transition:"all 0.2s"},children:[(0,L.jsx)("div",{style:{fontSize:"32px",marginBottom:"8px"},children:t.icon}),(0,L.jsx)("div",{style:{color:a.text,fontSize:"12px",fontWeight:"600",marginBottom:"4px"},children:t.name}),(0,L.jsx)("div",{style:{color:"#6b7280",fontSize:"10px"},children:new Date(e.unlockedAt).toLocaleDateString()})]},e.id)})})]}),(0,L.jsx)(Kt,{}),(0,L.jsxs)("div",{style:{background:"linear-gradient(145deg, #1e1e3f 0%, #16213e 100%)",borderRadius:"20px",padding:"24px",marginBottom:"24px",border:"2px solid #374151"},children:[(0,L.jsxs)("h3",{style:{color:"#a78bfa",fontSize:"18px",fontWeight:"700",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,L.jsx)(M.A,{size:20})," \uacc4\uc815 \uc124\uc815"]}),(0,L.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,L.jsx)("div",{style:{padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",marginBottom:"8px"},children:(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsx)("span",{style:{color:"#9ca3af",fontSize:"14px"},children:"\ud604\uc7ac \ud559\uae09 \ucf54\ub4dc"}),(0,L.jsx)("span",{style:{color:"#e8e8ff",fontSize:"16px",fontWeight:"600"},children:(null===s||void 0===s?void 0:s.classCode)||"\uc5c6\uc74c"})]})}),(0,L.jsxs)("button",{onClick:()=>{h(!0),F("")},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",cursor:"pointer",transition:"all 0.2s"},children:[(0,L.jsx)(X.A,{size:20,style:{color:"#a78bfa"}}),(0,L.jsx)("span",{style:{color:"#e8e8ff",fontSize:"14px",flex:1,textAlign:"left"},children:"\ub2c9\ub124\uc784 \ubcc0\uacbd"}),(0,L.jsx)(V.A,{size:18,style:{color:"#6b7280"}})]}),(0,L.jsxs)("button",{onClick:()=>{f(!0),F("")},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",cursor:"pointer",transition:"all 0.2s"},children:[(0,L.jsx)(Y.A,{size:20,style:{color:"#a78bfa"}}),(0,L.jsx)("span",{style:{color:"#e8e8ff",fontSize:"14px",flex:1,textAlign:"left"},children:"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"}),(0,L.jsx)(V.A,{size:18,style:{color:"#6b7280"}})]}),(0,L.jsxs)("button",{onClick:()=>{y(!0),F("")},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",cursor:"pointer",transition:"all 0.2s"},children:[(0,L.jsx)(N.A,{size:20,style:{color:"#a78bfa"}}),(0,L.jsx)("span",{style:{color:"#e8e8ff",fontSize:"14px",flex:1,textAlign:"left"},children:"\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd"}),(0,L.jsx)(V.A,{size:18,style:{color:"#6b7280"}})]}),(0,L.jsxs)("button",{onClick:n,style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"#0f0f23",borderRadius:"12px",border:"1px solid #374151",cursor:"pointer",transition:"all 0.2s",marginTop:"8px"},children:[(0,L.jsx)(_.A,{size:20,style:{color:"#9ca3af"}}),(0,L.jsx)("span",{style:{color:"#e8e8ff",fontSize:"14px",flex:1,textAlign:"left"},children:"\ub85c\uadf8\uc544\uc6c3"}),(0,L.jsx)(V.A,{size:18,style:{color:"#6b7280"}})]}),(0,L.jsxs)("button",{onClick:()=>{v(!0),F("")},style:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"rgba(239, 68, 68, 0.1)",borderRadius:"12px",border:"1px solid rgba(239, 68, 68, 0.3)",cursor:"pointer",transition:"all 0.2s"},children:[(0,L.jsx)(Z.A,{size:20,style:{color:"#ef4444"}}),(0,L.jsx)("span",{style:{color:"#ef4444",fontSize:"14px",flex:1,textAlign:"left"},children:"\uacc4\uc815 \uc0ad\uc81c"}),(0,L.jsx)(V.A,{size:18,style:{color:"#ef4444"}})]})]})]})]}),(0,L.jsx)(Vs,{isOpen:r,onClose:()=>d(!1),userId:o,onSave:e=>{p(e)}}),x&&(0,L.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{h(!1),Q()},children:(0,L.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",borderRadius:"20px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid #374151"},onClick:e=>e.stopPropagation(),children:[(0,L.jsx)("h3",{style:{color:"#e8e8ff",fontSize:"18px",fontWeight:"700",marginBottom:"20px"},children:"\ub2c9\ub124\uc784 \ubcc0\uacbd"}),(0,L.jsx)("input",{type:"text",value:w,onChange:e=>C(e.target.value),placeholder:"\uc0c8 \ub2c9\ub124\uc784 (2~10\uc790)",maxLength:10,style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"12px"}}),P&&(0,L.jsx)("p",{style:{color:"#ef4444",fontSize:"13px",marginBottom:"12px"},children:P}),(0,L.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,L.jsx)("button",{onClick:()=>{h(!1),Q()},style:{flex:1,padding:"12px",background:"#374151",border:"none",borderRadius:"10px",color:"#e8e8ff",fontSize:"14px",cursor:"pointer"},children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{if(w.trim())if(w.length<2||w.length>10)F("\ub2c9\ub124\uc784\uc740 2~10\uc790 \uc0ac\uc774\uc5ec\uc57c \ud569\ub2c8\ub2e4.");else{B(!0);try{const e=(0,ee.H9)(G.db,"users",o);await(0,ee.mZ)(e,{nickname:w.trim()}),alert("\ub2c9\ub124\uc784\uc774 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),h(!1),Q()}catch(e){F("\ub2c9\ub124\uc784 \ubcc0\uacbd\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}finally{B(!1)}}else F("\ub2c9\ub124\uc784\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:W,style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",border:"none",borderRadius:"10px",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:W?"not-allowed":"pointer",opacity:W?.7:1},children:W?"\ubcc0\uacbd \uc911...":"\ubcc0\uacbd"})]})]})}),g&&(0,L.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{f(!1),Q()},children:(0,L.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",borderRadius:"20px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid #374151"},onClick:e=>e.stopPropagation(),children:[(0,L.jsx)("h3",{style:{color:"#e8e8ff",fontSize:"18px",fontWeight:"700",marginBottom:"20px"},children:"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"}),(0,L.jsx)("input",{type:"password",value:k,onChange:e=>S(e.target.value),placeholder:"\ud604\uc7ac \ube44\ubc00\ubc88\ud638",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"10px"}}),(0,L.jsx)("input",{type:"password",value:A,onChange:e=>I(e.target.value),placeholder:"\uc0c8 \ube44\ubc00\ubc88\ud638 (6\uc790 \uc774\uc0c1)",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"10px"}}),(0,L.jsx)("input",{type:"password",value:E,onChange:e=>T(e.target.value),placeholder:"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"12px"}}),P&&(0,L.jsx)("p",{style:{color:"#ef4444",fontSize:"13px",marginBottom:"12px"},children:P}),(0,L.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,L.jsx)("button",{onClick:()=>{f(!1),Q()},style:{flex:1,padding:"12px",background:"#374151",border:"none",borderRadius:"10px",color:"#e8e8ff",fontSize:"14px",cursor:"pointer"},children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{if(k&&A&&E)if(A.length<6)F("\uc0c8 \ube44\ubc00\ubc88\ud638\ub294 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");else if(A===E){B(!0);try{const e=Js.IX.credential(t.email,k);await(0,Js.kZ)(t,e),await(0,Js.f3)(t,A),alert("\ube44\ubc00\ubc88\ud638\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),f(!1),Q()}catch(e){"auth/wrong-password"===e.code?F("\ud604\uc7ac \ube44\ubc00\ubc88\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."):F("\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}finally{B(!1)}}else F("\uc0c8 \ube44\ubc00\ubc88\ud638\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");else F("\ubaa8\ub4e0 \ud544\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:W,style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",border:"none",borderRadius:"10px",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:W?"not-allowed":"pointer",opacity:W?.7:1},children:W?"\ubcc0\uacbd \uc911...":"\ubcc0\uacbd"})]})]})}),b&&(0,L.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{y(!1),Q()},children:(0,L.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",borderRadius:"20px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid #374151"},onClick:e=>e.stopPropagation(),children:[(0,L.jsx)("h3",{style:{color:"#e8e8ff",fontSize:"18px",fontWeight:"700",marginBottom:"20px"},children:"\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd"}),(0,L.jsxs)("p",{style:{color:"#9ca3af",fontSize:"13px",marginBottom:"16px"},children:["\ud604\uc7ac \ud559\uae09: ",(0,L.jsx)("span",{style:{color:"#a78bfa",fontWeight:"600"},children:(null===s||void 0===s?void 0:s.classCode)||"\uc5c6\uc74c"})]}),(0,L.jsx)("input",{type:"text",value:D,onChange:e=>R(e.target.value.toUpperCase()),placeholder:"\uc0c8 \ud559\uae09 \ucf54\ub4dc",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #374151",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"12px",textTransform:"uppercase"}}),P&&(0,L.jsx)("p",{style:{color:"#ef4444",fontSize:"13px",marginBottom:"12px"},children:P}),(0,L.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,L.jsx)("button",{onClick:()=>{y(!1),Q()},style:{flex:1,padding:"12px",background:"#374151",border:"none",borderRadius:"10px",color:"#e8e8ff",fontSize:"14px",cursor:"pointer"},children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{if(D.trim()){B(!0);try{if(!await(0,G.JK)(D.trim()))return F("\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ud559\uae09 \ucf54\ub4dc\uc785\ub2c8\ub2e4."),void B(!1);const e=(0,ee.H9)(G.db,"users",o);await(0,ee.mZ)(e,{classCode:D.trim()}),alert("\ud559\uae09 \ucf54\ub4dc\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),y(!1),Q()}catch(e){F("\ud559\uae09 \ucf54\ub4dc \ubcc0\uacbd\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}finally{B(!1)}}else F("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:W,style:{flex:1,padding:"12px",background:"linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%)",border:"none",borderRadius:"10px",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:W?"not-allowed":"pointer",opacity:W?.7:1},children:W?"\ubcc0\uacbd \uc911...":"\ubcc0\uacbd"})]})]})}),j&&(0,L.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>{v(!1),Q()},children:(0,L.jsxs)("div",{style:{background:"linear-gradient(145deg, #1a1a2e 0%, #0f0f23 100%)",borderRadius:"20px",padding:"24px",maxWidth:"400px",width:"100%",border:"2px solid #ef4444"},onClick:e=>e.stopPropagation(),children:[(0,L.jsx)("h3",{style:{color:"#ef4444",fontSize:"18px",fontWeight:"700",marginBottom:"16px"},children:"\u26a0\ufe0f \uacc4\uc815 \uc0ad\uc81c"}),(0,L.jsxs)("p",{style:{color:"#9ca3af",fontSize:"13px",marginBottom:"16px",lineHeight:1.6},children:["\uacc4\uc815\uc744 \uc0ad\uc81c\ud558\uba74 \ubaa8\ub4e0 \ub370\uc774\ud130\uac00 \uc601\uad6c\uc801\uc73c\ub85c \uc0ad\uc81c\ub418\uba70 \ubcf5\uad6c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\ub824\uba74 \uc544\ub798\uc5d0 ",(0,L.jsx)("span",{style:{color:"#ef4444",fontWeight:"600"},children:"'\uacc4\uc815\uc0ad\uc81c'"}),"\ub97c \uc785\ub825\ud558\uc138\uc694."]}),(0,L.jsx)("input",{type:"text",value:z,onChange:e=>O(e.target.value),placeholder:"\uacc4\uc815\uc0ad\uc81c",style:{width:"100%",padding:"14px",background:"#0f0f23",border:"2px solid #ef4444",borderRadius:"12px",color:"#e8e8ff",fontSize:"14px",marginBottom:"12px"}}),P&&(0,L.jsx)("p",{style:{color:"#ef4444",fontSize:"13px",marginBottom:"12px"},children:P}),(0,L.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,L.jsx)("button",{onClick:()=>{v(!1),Q()},style:{flex:1,padding:"12px",background:"#374151",border:"none",borderRadius:"10px",color:"#e8e8ff",fontSize:"14px",cursor:"pointer"},children:"\ucde8\uc18c"}),(0,L.jsx)("button",{onClick:async()=>{if("\uacc4\uc815\uc0ad\uc81c"===z){B(!0);try{const e=(0,ee.H9)(G.db,"users",o);await(0,ee.kd)(e),await(0,Js.hG)(t),alert("\uacc4\uc815\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(e){"auth/requires-recent-login"===e.code?F("\ubcf4\uc548\uc744 \uc704\ud574 \ub2e4\uc2dc \ub85c\uadf8\uc778 \ud6c4 \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):F("\uacc4\uc815 \uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}finally{B(!1)}}else F("'\uacc4\uc815\uc0ad\uc81c'\ub97c \uc815\ud655\ud788 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},disabled:W||"\uacc4\uc815\uc0ad\uc81c"!==z,style:{flex:1,padding:"12px",background:"\uacc4\uc815\uc0ad\uc81c"===z?"#ef4444":"#374151",border:"none",borderRadius:"10px",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:W||"\uacc4\uc815\uc0ad\uc81c"!==z?"not-allowed":"pointer",opacity:W||"\uacc4\uc815\uc0ad\uc81c"!==z?.5:1},children:W?"\uc0ad\uc81c \uc911...":"\uc0ad\uc81c"})]})]})})]}):(0,L.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,L.jsx)("p",{className:"text-gray-400",children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})})}const Xs=(0,a.lazy)(()=>s.e(393).then(s.bind(s,7393))),Ys=(0,a.lazy)(()=>s.e(757).then(s.bind(s,6757))),Zs=(0,a.lazy)(()=>s.e(864).then(s.bind(s,3864))),$s=(0,a.lazy)(()=>Promise.resolve().then(s.bind(s,8164))),ea=(0,a.lazy)(()=>s.e(175).then(s.bind(s,7175))),ta=(0,a.lazy)(()=>s.e(920).then(s.bind(s,7920))),sa=(0,a.lazy)(()=>Promise.resolve().then(s.bind(s,5967))),aa=(0,a.lazy)(()=>s.e(896).then(s.bind(s,2896))),na=(0,a.lazy)(()=>s.e(716).then(s.bind(s,716))),ia=(0,a.lazy)(()=>s.e(765).then(s.bind(s,3765))),oa=(0,a.lazy)(()=>s.e(813).then(s.bind(s,2813))),la=(0,a.lazy)(()=>s.e(327).then(s.bind(s,9327))),ra=(0,a.lazy)(()=>s.e(665).then(s.bind(s,4665))),da=(0,a.lazy)(()=>s.e(610).then(s.bind(s,7610))),ca=(0,a.lazy)(()=>s.e(231).then(s.bind(s,2231))),pa=(0,a.lazy)(()=>s.e(398).then(s.bind(s,4398))),ua=(0,a.lazy)(()=>s.e(785).then(s.bind(s,5785))),ma=(0,a.lazy)(()=>s.e(613).then(s.bind(s,5613))),xa=(0,a.lazy)(()=>s.e(317).then(s.bind(s,5317))),ha=(0,a.lazy)(()=>s.e(512).then(s.bind(s,7512))),ga=(0,a.lazy)(()=>s.e(44).then(s.bind(s,8044))),fa=(0,a.lazy)(()=>s.e(5).then(s.bind(s,7005))),ba=(0,a.lazy)(()=>s.e(909).then(s.bind(s,3909))),ya=(0,a.lazy)(()=>s.e(358).then(s.bind(s,4358))),ja=(0,a.lazy)(()=>s.e(510).then(s.bind(s,4510))),va=["/learning-games/omok","/learning-games/science","/learning-games/typing","/auction","/court","/national-assembly","/music-room"],wa=e=>{let{message:t="\ub85c\ub529 \uc911..."}=e;return(0,L.jsx)(Xe.Cg,{message:t})},Na=e=>{let{children:t}=e;const{user:s,loading:a}=(0,i.As)(),o=(0,n.zy)();return a?(0,L.jsx)(wa,{}):s?t:(0,L.jsx)(n.C5,{to:"/login",state:{from:o},replace:!0})},Ca=e=>{let{children:t}=e;const{user:s,userDoc:a,loading:o}=(0,i.As)(),l=(0,n.zy)();if(o)return(0,L.jsx)(wa,{});if(!s)return(0,L.jsx)(n.C5,{to:"/login",state:{from:l},replace:!0});return(null===a||void 0===a?void 0:a.isAdmin)||"admin"===(null===a||void 0===a?void 0:a.role)||(null===a||void 0===a?void 0:a.isSuperAdmin)?t:(0,L.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0})},ka=e=>{let{children:t}=e;const{user:s,userDoc:a,loading:o}=(0,i.As)(),l=(0,n.zy)();if(o)return(0,L.jsx)(wa,{});if(!s)return(0,L.jsx)(n.C5,{to:"/login",state:{from:l},replace:!0});return(null===a||void 0===a?void 0:a.isTeacher)||(null===a||void 0===a?void 0:a.isAdmin)||(null===a||void 0===a?void 0:a.isSuperAdmin)?t:(0,L.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0})},Sa=e=>{let{children:t}=e;const{user:s,userDoc:a,loading:o}=(0,i.As)(),l=(0,n.zy)();return o?(0,L.jsx)(wa,{}):s?null!==a&&void 0!==a&&a.isSuperAdmin?t:(0,L.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0}):(0,L.jsx)(n.C5,{to:"/login",state:{from:l},replace:!0})};function Aa(){const e=(0,n.Zp)(),t=(0,n.zy)(),{user:s,userDoc:l,loading:r,logout:d}=(0,i.As)(),[c,p]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),[x,h]=(0,a.useState)(window.innerWidth<768),[g,f]=(0,a.useState)(!1),{updateAvailable:b,updateServiceWorker:y,isOnline:j}=Ke();(0,a.useEffect)(()=>{const e=document.createElement("link");return e.href="https://fonts.googleapis.com/css2?family=Jua&display=swap",e.rel="stylesheet",document.head.appendChild(e),()=>{document.head.contains(e)&&document.head.removeChild(e)}},[]),(0,a.useEffect)(()=>{va.some(e=>t.pathname.startsWith(e))&&!x&&m(!0)},[t.pathname,x]),(0,a.useEffect)(()=>{const e=()=>{const e=window.innerWidth<768;h(e),e&&p(!1)};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]);const v=(0,a.useCallback)(()=>{p(e=>!e)},[]),w=(0,a.useCallback)(()=>{p(!1)},[]),N=(0,a.useCallback)(()=>{m(e=>!e)},[]);if(!r&&!s)return(0,L.jsx)(n.C5,{to:"/login",state:{from:t},replace:!0});if(r||s&&!l)return(0,L.jsx)(wa,{});if("/login"===t.pathname)return s?(0,L.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0}):(0,L.jsx)(As.default,{});if(!l.classCode)return(0,L.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:(0,L.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl p-8 max-w-sm w-full text-center",children:[(0,L.jsx)("div",{className:"w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-4 text-3xl",children:"\u26a0\ufe0f"}),(0,L.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \ud544\uc694\ud569\ub2c8\ub2e4"}),(0,L.jsx)("p",{className:"text-gray-500 mb-6",children:"\uc120\uc0dd\ub2d8\uaed8 \ud559\uae09 \ucf54\ub4dc\ub97c \ubc1b\uc544 \uc785\ub825\ud574\uc8fc\uc138\uc694."}),(0,L.jsx)("button",{onClick:()=>d(),className:"px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-semibold transition-colors",children:"\ub85c\uadf8\uc544\uc6c3"})]})});const C=null===l||void 0===l?void 0:l.classCode;return(0,L.jsx)(o.px,{children:(0,L.jsxs)("div",{className:"min-h-screen bg-[#0a0a12] text-gray-100 font-sans selection:bg-indigo-500/30 selection:text-indigo-200 flex",children:[(0,L.jsx)(H,{isOpen:c,onClose:w,isCollapsed:u}),(0,L.jsxs)("main",{className:"flex-1 min-w-0 md:min-h-screen relative bg-[#0a0a12] overflow-visible",children:[(0,L.jsx)(Pe,{toggleSidebar:v,isMobile:x,isSidebarCollapsed:u,onToggleSidebarCollapse:N}),(0,L.jsx)("div",{className:"w-full pb-20 md:pb-4",children:(0,L.jsx)(a.Suspense,{fallback:(0,L.jsx)(wa,{message:"\ud398\uc774\uc9c0 \ub85c\ub529 \uc911..."}),children:(0,L.jsxs)(n.BV,{children:[(0,L.jsx)(n.qh,{path:"/dashboard/tasks",element:(0,L.jsx)(Na,{children:(0,L.jsx)(ns,{})})}),(0,L.jsx)(n.qh,{path:"/my-assets",element:(0,L.jsx)(Na,{children:(0,L.jsx)(fs,{})})}),(0,L.jsx)(n.qh,{path:"/my-profile",element:(0,L.jsx)(Na,{children:(0,L.jsx)(Ks,{})})}),(0,L.jsx)(n.qh,{path:"/coupon-goal",element:(0,L.jsx)(Na,{children:(0,L.jsx)(ja,{})})}),(0,L.jsx)(n.qh,{path:"/learning-games/omok",element:(0,L.jsx)(Na,{children:(0,L.jsx)(Xs,{})})}),(0,L.jsx)(n.qh,{path:"/learning-games/typing",element:(0,L.jsx)(Na,{children:(0,L.jsx)(Zs,{})})}),(0,L.jsx)(n.qh,{path:"/learning-games/science",element:(0,L.jsx)(Na,{children:(0,L.jsx)(Ys,{})})}),(0,L.jsx)(n.qh,{path:"/item-shop",element:(0,L.jsx)(Na,{children:(0,L.jsx)(cs,{})})}),(0,L.jsx)(n.qh,{path:"/my-items",element:(0,L.jsx)(Na,{children:(0,L.jsx)(hs,{})})}),(0,L.jsx)(n.qh,{path:"/item-market",element:(0,L.jsx)(Na,{children:(0,L.jsx)(Ss,{})})}),(0,L.jsx)(n.qh,{path:"/personal-shop",element:(0,L.jsx)(Na,{children:(0,L.jsx)(Ss,{})})}),(0,L.jsx)(n.qh,{path:"/banking",element:(0,L.jsx)(Na,{children:(0,L.jsx)(Gs,{})})}),(0,L.jsx)(n.qh,{path:"/stock-trading",element:(0,L.jsx)(Na,{children:(0,L.jsx)(pa,{})})}),(0,L.jsx)(n.qh,{path:"/auction",element:(0,L.jsx)(Na,{children:(0,L.jsx)(fa,{})})}),(0,L.jsx)(n.qh,{path:"/real-estate",element:(0,L.jsx)(Na,{children:(0,L.jsx)(ua,{})})}),(0,L.jsx)(n.qh,{path:"/government",element:(0,L.jsx)(Na,{children:(0,L.jsx)(xa,{})})}),(0,L.jsx)(n.qh,{path:"/national-assembly",element:(0,L.jsx)(Na,{children:(0,L.jsx)(ma,{})})}),(0,L.jsx)(n.qh,{path:"/court",element:(0,L.jsx)(Na,{children:(0,L.jsx)(ha,{})})}),(0,L.jsx)(n.qh,{path:"/police",element:(0,L.jsx)(Na,{children:(0,L.jsx)(ga,{})})}),(0,L.jsx)(n.qh,{path:"/learning-board",element:(0,L.jsx)(Na,{children:(0,L.jsx)(la,{})})}),(0,L.jsx)(n.qh,{path:"/learning-board/music-request",element:(0,L.jsx)(Na,{children:(0,L.jsx)(ra,{user:s})})}),(0,L.jsx)(n.qh,{path:"/music-room/:roomId",element:(0,L.jsx)(Na,{children:(0,L.jsx)(da,{user:s})})}),(0,L.jsx)(n.qh,{path:"/student-request/:roomId",element:(0,L.jsx)(ca,{})}),(0,L.jsx)(n.qh,{path:"/admin/app-settings",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ns,{adminTabMode:"generalSettings"})})}),(0,L.jsx)(n.qh,{path:"/admin/task-management",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ns,{adminTabMode:"taskManagement"})})}),(0,L.jsx)(n.qh,{path:"/admin/job-settings",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ns,{adminTabMode:"jobSettings"})})}),(0,L.jsx)(n.qh,{path:"/admin/salary-settings",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ns,{adminTabMode:"salarySettings"})})}),(0,L.jsx)(n.qh,{path:"/admin/class-members",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ns,{adminTabMode:"memberManagement"})})}),(0,L.jsx)(n.qh,{path:"/admin/app-management",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ns,{adminTabMode:"appManagement"})})}),(0,L.jsx)(n.qh,{path:"/admin/coupon-transfer",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ya,{})})}),(0,L.jsx)(n.qh,{path:"/admin/money-transfer",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ba,{})})}),(0,L.jsx)(n.qh,{path:"/admin/activity-log",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(sa,{})})}),(0,L.jsx)(n.qh,{path:"/admin/items",element:(0,L.jsx)(Ca,{children:(0,L.jsx)($s,{})})}),(0,L.jsx)(n.qh,{path:"/admin/page",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ea,{})})}),(0,L.jsx)(n.qh,{path:"/admin-panel",element:(0,L.jsx)(Ca,{children:(0,L.jsx)(ta,{onClose:()=>e(-1),classCode:C})})}),(0,L.jsx)(n.qh,{path:"/admin/students",element:(0,L.jsx)(ka,{children:(0,L.jsx)(ia,{})})}),(0,L.jsx)(n.qh,{path:"/super-admin",element:(0,L.jsx)(Sa,{children:(0,L.jsx)(oa,{})})}),(0,L.jsx)(n.qh,{path:"/super-admin/*",element:(0,L.jsx)(Sa,{children:(0,L.jsx)(oa,{})})}),(0,L.jsx)(n.qh,{path:"/doctor",element:(0,L.jsx)(Na,{children:(0,L.jsx)(aa,{})})}),(0,L.jsx)(n.qh,{path:"/recover-donations",element:(0,L.jsx)(Na,{children:(0,L.jsx)(na,{})})}),(0,L.jsx)(n.qh,{path:"/",element:(0,L.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0})}),(0,L.jsx)(n.qh,{path:"*",element:(0,L.jsx)(n.C5,{to:"/dashboard/tasks",replace:!0})})]})})}),(0,L.jsx)("footer",{className:"hidden md:block py-8 text-center text-sm text-gray-400 font-medium",children:"\xa9 2025 \uc54c\ucc2c Corp. All rights reserved."})]}),(0,L.jsx)(qe,{}),(0,L.jsx)(Ge,{}),b&&!g&&(0,L.jsx)(Ve,{onUpdate:y,onDismiss:()=>f(!0)}),!j&&(0,L.jsxs)("div",{className:"fixed top-0 left-0 right-0 bg-amber-500 text-white text-center py-2 text-sm font-medium z-50 flex items-center justify-center gap-2",children:[(0,L.jsx)(Ye.A,{size:16}),"\uc624\ud504\ub77c\uc778 \uc0c1\ud0dc\uc785\ub2c8\ub2e4. \uc77c\ubd80 \uae30\ub2a5\uc774 \uc81c\ud55c\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),(0,L.jsx)("style",{children:"\n        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }\n        .font-jua { font-family: 'Jua', sans-serif; }\n        @keyframes slide-up {\n          from { transform: translateY(100%); opacity: 0; }\n          to { transform: translateY(0); opacity: 1; }\n        }\n        .animate-slide-up { animation: slide-up 0.3s ease-out; }\n        @keyframes spin-slow {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        .animate-spin-slow { animation: spin-slow 2s linear infinite; }\n      "})]})})}}}]);
//# sourceMappingURL=306.b74daafe.chunk.js.map