"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[716],{716(t,o,e){e.r(o),e.d(o,{default:()=>c});var n=e(5043),a=e(5016),i=e(5452),s=e(2419),d=e(579);function c(){const{user:t,userDoc:o}=(0,a.As)(),[e,c]=(0,n.useState)(!1),[r,l]=(0,n.useState)([]),m=t=>{i.vF.log(t),l(o=>[...o,"[".concat((new Date).toLocaleTimeString(),"] ").concat(t)])};return t?null!==o&&void 0!==o&&o.isAdmin||null!==o&&void 0!==o&&o.isSuperAdmin?(0,d.jsxs)("div",{style:{padding:"20px",maxWidth:"800px",margin:"0 auto",fontFamily:"'Noto Sans KR', sans-serif"},children:[(0,d.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",color:"#ef4444",borderBottom:"2px solid #fecaca",paddingBottom:"10px",marginBottom:"20px"},children:"\ud83d\udea8 \uae30\ubd80 \ub0b4\uc5ed \ubcf5\uad6c \ub3c4\uad6c"}),(0,d.jsxs)("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:[(0,d.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"10px"},children:"\u26a0\ufe0f \uc8fc\uc758\uc0ac\ud56d"}),(0,d.jsxs)("ul",{style:{fontSize:"14px",lineHeight:"1.6",paddingLeft:"20px"},children:[(0,d.jsx)("li",{children:"\uc774 \ub3c4\uad6c\ub294 donations \uceec\ub809\uc158\uc5d0\uc11c \uae30\ubd80 \ub0b4\uc5ed\uc744 \ubcf5\uad6c\ud569\ub2c8\ub2e4."}),(0,d.jsx)("li",{children:"\ud604\uc7ac goals \ubb38\uc11c\uc758 donations \ubc30\uc5f4\uc774 \ub36e\uc5b4\uc368\uc9d1\ub2c8\ub2e4."}),(0,d.jsx)("li",{children:"\ubcf5\uad6c \uc804\uc5d0 \ubc18\ub4dc\uc2dc \ud604\uc7ac \ub370\uc774\ud130\ub97c \ubc31\uc5c5\ud558\uc138\uc694."}),(0,d.jsx)("li",{children:"\uad00\ub9ac\uc790\ub9cc \uc2e4\ud589 \uac00\ub2a5\ud569\ub2c8\ub2e4."})]})]}),(0,d.jsx)("button",{onClick:async()=>{if((null===o||void 0===o||!o.isAdmin)&&(null===o||void 0===o||!o.isSuperAdmin))return void alert("\uad00\ub9ac\uc790\ub9cc \ubcf5\uad6c \uc791\uc5c5\uc744 \uc218\ud589\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.");const e=null===o||void 0===o?void 0:o.classCode;if(e){if(window.confirm("".concat(e," \ud559\uae09\uc758 \uae30\ubd80 \ub0b4\uc5ed\uc744 donations \uceec\ub809\uc158\uc5d0\uc11c \ubcf5\uad6c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))){c(!0),l([]),m("\ubcf5\uad6c \uc791\uc5c5 \uc2dc\uc791...");try{m("donations \uceec\ub809\uc158\uc5d0\uc11c ".concat(e," \ud559\uae09 \ub370\uc774\ud130 \uc870\ud68c \uc911..."));const o=(0,s.P)((0,s.rJ)(s.db,"donations"),(0,s._M)("classCode","==",e)),n=await(0,s.GG)(o);if(n.empty)return m("\u274c donations \uceec\ub809\uc158\uc5d0\uc11c \ubcf5\uad6c \uac00\ub2a5\ud55c \ub370\uc774\ud130\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),alert("\ubcf5\uad6c \uac00\ub2a5\ud55c \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),void c(!1);m("\u2705 ".concat(n.size,"\uac1c\uc758 \uae30\ubd80 \uae30\ub85d\uc744 \ucc3e\uc558\uc2b5\ub2c8\ub2e4."));const a=[];let i=0;const d={};n.forEach(t=>{const o=t.data(),e={userId:o.userId,userName:o.userName,amount:Number(o.amount)||0,message:o.message||"",timestamp:o.timestamp,timestampISO:o.timestampISO||(o.timestamp?o.timestamp.toDate().toISOString():(new Date).toISOString()),classCode:o.classCode};a.push(e),i+=e.amount,d[e.userId]||(d[e.userId]=0),d[e.userId]+=e.amount,m("  - ".concat(e.userName,": ").concat(e.amount,"\ucfe0\ud3f0"))}),m("\ud83d\udcca \ucd1d \uae30\ubd80\uc561: ".concat(i,"\ucfe0\ud3f0")),m("\ud83d\udc65 \uae30\ubd80\uc790 \uc218: ".concat(Object.keys(d).length,"\uba85"));const r="".concat(e,"_goal"),l=(0,s.H9)(s.db,"goals",r);if(!(await(0,s.x7)(l)).exists())return m("\u274c \ubaa9\ud45c \ubb38\uc11c\uac00 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \uba3c\uc800 \ubaa9\ud45c\ub97c \uc0dd\uc131\ud574\uc8fc\uc138\uc694."),alert("\ubaa9\ud45c \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),void c(!1);m("\ud83c\udfaf \ubaa9\ud45c \ubb38\uc11c \uc5c5\ub370\uc774\ud2b8 \uc911...");const u=(0,s.wP)(s.db);u.update(l,{donations:a,progress:i,donationCount:a.length,updatedAt:(0,s.O5)(),recoveredAt:(0,s.O5)(),recoveredBy:t.uid}),m("\ud83d\udc64 \uc0ac\uc6a9\uc790 \uae30\uc5ec\ub3c4 \uc5c5\ub370\uc774\ud2b8 \uc911...");for(const[t,e]of Object.entries(d)){const o=(0,s.H9)(s.db,"users",t);u.update(o,{myContribution:e,updatedAt:(0,s.O5)()}),m("  - ".concat(t,": ").concat(e,"\ucfe0\ud3f0"))}await u.commit(),m("\u2705 \ubcf5\uad6c \uc644\ub8cc!"),m("\ud83d\udcdd \ucd1d ".concat(a.length,"\uac1c\uc758 \uae30\ubd80 \uae30\ub85d \ubcf5\uad6c\ub428")),m("\ud83d\udcb0 \ucd1d \uae30\ubd80\uc561: ".concat(i,"\ucfe0\ud3f0")),alert("\uae30\ubd80 \ub0b4\uc5ed \ubcf5\uad6c \uc644\ub8cc!\n\ucd1d ".concat(a.length,"\uac1c \uae30\ub85d, ").concat(i,"\ucfe0\ud3f0"))}catch(n){i.vF.error("\ubcf5\uad6c \uc2e4\ud328:",n),m("\u274c \uc624\ub958 \ubc1c\uc0dd: ".concat(n.message)),alert("\ubcf5\uad6c \uc2e4\ud328: ".concat(n.message))}finally{c(!1)}}}else alert("\ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.")},disabled:e,style:{width:"100%",padding:"15px",backgroundColor:e?"#9ca3af":"#ef4444",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:e?"not-allowed":"pointer",marginBottom:"20px"},children:e?"\ubcf5\uad6c \uc911...":"\ud83d\udd04 \uae30\ubd80 \ub0b4\uc5ed \ubcf5\uad6c \uc2dc\uc791"}),r.length>0&&(0,d.jsxs)("div",{style:{backgroundColor:"#1f2937",color:"#f3f4f6",borderRadius:"8px",padding:"15px",maxHeight:"400px",overflowY:"auto",fontFamily:"monospace",fontSize:"13px"},children:[(0,d.jsx)("h3",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"10px",color:"#60a5fa"},children:"\ud83d\udccb \uc791\uc5c5 \ub85c\uadf8"}),r.map((t,o)=>(0,d.jsx)("div",{style:{marginBottom:"5px"},children:t},o))]})]}):(0,d.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#ef4444"},children:"\uad00\ub9ac\uc790\ub9cc \uc811\uadfc \uac00\ub2a5\ud569\ub2c8\ub2e4."}):(0,d.jsx)("div",{style:{padding:"20px",textAlign:"center"},children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})}}}]);
//# sourceMappingURL=716.76ab0808.chunk.js.map