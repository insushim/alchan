{"version":3,"file":"static/js/530.fb00c406.chunk.js","mappings":"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","sources":["components/PageWrapper.js","pages/banking/ParkingAccount.js","pages/banking/Banking.js"],"sourcesContent":["// src/components/PageWrapper.js\n// 페이지 공통 래퍼 - 새로운 슬레이트 기반 디자인 시스템\n\nimport React from \"react\";\nimport { Loader2, CheckSquare } from \"lucide-react\";\nimport { AlchanLoadingScreen } from \"./ui/Skeleton\";\n\n// ============================================\n// 페이지 컨테이너\n// ============================================\nexport const PageContainer = ({ children, className = \"\" }) => (\n  <div className={`min-h-full w-full bg-[#0a0a12] ${className}`}>\n    <div className=\"w-full max-w-none px-2 md:px-3 lg:px-4 py-1 md:py-2\">\n      {children}\n    </div>\n  </div>\n);\n\n// ============================================\n// 페이지 헤더 - 새로운 디자인\n// ============================================\nexport const PageHeader = ({\n  title,\n  subtitle,\n  icon: Icon,\n  badge,\n  action,\n  backButton,\n  className = \"\",\n}) => (\n  <section\n    className={`bg-[#14142380] backdrop-blur-sm rounded-lg px-3 py-1.5 md:px-4 md:py-2 shadow-lg border border-cyan-900/30 flex flex-col md:flex-row md:items-center justify-between gap-1.5 md:gap-2 mb-2 md:mb-3 ${className}`}\n  >\n    <div className=\"flex items-center gap-3\">\n      {backButton}\n      {Icon && (\n        <div className=\"w-9 h-9 md:w-10 md:h-10 bg-cyan-900/30 rounded-lg flex items-center justify-center text-cyan-400 shrink-0 shadow-sm border border-cyan-500/30\">\n          <Icon className=\"w-5 h-5\" />\n        </div>\n      )}\n      <div>\n        <div className=\"flex items-center gap-2\">\n          <h2 className=\"text-lg md:text-xl font-bold text-white tracking-tight\">\n            {title}\n          </h2>\n          {badge}\n        </div>\n        {subtitle && (\n          <p className=\"text-xs md:text-sm text-slate-400 font-medium\">\n            {subtitle}\n          </p>\n        )}\n      </div>\n    </div>\n    {action && (\n      <div className=\"flex flex-wrap items-center gap-2 md:gap-3 md:ml-auto\">\n        {action}\n      </div>\n    )}\n  </section>\n);\n\n// ============================================\n// 섹션 제목\n// ============================================\nexport const SectionTitle = ({\n  children,\n  icon: Icon,\n  action,\n  className = \"\",\n}) => (\n  <div className={`flex items-center justify-between px-1 mb-4 ${className}`}>\n    <h3 className=\"text-lg md:text-xl font-bold text-white flex items-center gap-2\">\n      {Icon && <Icon className=\"w-5 h-5 text-cyan-400\" />}\n      {children}\n    </h3>\n    {action}\n  </div>\n);\n\n// ============================================\n// 로딩 상태 - null (HTML 스플래시만 사용)\n// ============================================\nexport const LoadingState = ({ message = \"데이터를 불러오는 중...\" }) => null;\n\n// ============================================\n// 에러 상태\n// ============================================\nexport const ErrorState = ({\n  title = \"오류가 발생했습니다\",\n  message,\n  onRetry,\n}) => (\n  <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n    <div className=\"w-16 h-16 bg-red-900/30 rounded-full flex items-center justify-center mb-4\">\n      <span className=\"text-3xl text-red-400\">!</span>\n    </div>\n    <h3 className=\"text-lg font-semibold text-white mb-2\">{title}</h3>\n    {message && <p className=\"text-slate-400 mb-4 max-w-md\">{message}</p>}\n    {onRetry && (\n      <button\n        onClick={onRetry}\n        className=\"px-5 py-2.5 bg-cyan-500 hover:bg-cyan-400 text-slate-900 rounded-xl font-bold text-sm transition-all shadow-lg shadow-cyan-500/30\"\n      >\n        다시 시도\n      </button>\n    )}\n  </div>\n);\n\n// ============================================\n// 빈 상태\n// ============================================\nexport const EmptyState = ({ icon: Icon, title, description, action }) => (\n  <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n    {Icon && (\n      <div className=\"w-16 h-16 rounded-full bg-[#14142380] shadow-lg flex items-center justify-center mb-4 border border-cyan-900/30\">\n        <Icon className=\"w-8 h-8 text-slate-400\" />\n      </div>\n    )}\n    {title && (\n      <h3 className=\"text-lg font-bold text-slate-300 mb-2\">{title}</h3>\n    )}\n    {description && (\n      <p className=\"text-slate-500 font-medium mb-6 max-w-md\">{description}</p>\n    )}\n    {action}\n  </div>\n);\n\n// ============================================\n// 카드 그리드\n// ============================================\nexport const CardGrid = ({ children, cols = 3, className = \"\" }) => {\n  const colsClass = {\n    1: \"grid-cols-1\",\n    2: \"grid-cols-1 md:grid-cols-2\",\n    3: \"grid-cols-1 md:grid-cols-2 xl:grid-cols-3\",\n    4: \"grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4\",\n  };\n\n  return (\n    <div\n      className={`grid ${colsClass[cols] || colsClass[3]} gap-6 ${className}`}\n    >\n      {children}\n    </div>\n  );\n};\n\n// ============================================\n// 통계 카드 - 새로운 디자인\n// ============================================\nexport const StatCard = ({\n  icon: Icon,\n  label,\n  value,\n  subValue,\n  trend,\n  iconBg = \"bg-cyan-900/30\",\n  iconColor = \"text-cyan-400\",\n  onClick,\n}) => (\n  <div\n    className={`bg-[#14142380] backdrop-blur-sm rounded-2xl p-6 border border-cyan-900/30 shadow-lg hover:shadow-xl hover:shadow-cyan-500/10 transition-all duration-300 ${\n      onClick ? \"cursor-pointer\" : \"\"\n    }`}\n    onClick={onClick}\n  >\n    <div className=\"flex items-start justify-between\">\n      <div\n        className={`w-12 h-12 rounded-xl flex items-center justify-center shadow-sm ${iconBg}`}\n      >\n        <Icon className={`w-6 h-6 ${iconColor}`} />\n      </div>\n      {trend && (\n        <span\n          className={`text-xs font-bold px-2.5 py-1 rounded-lg ${\n            trend.type === \"up\"\n              ? \"bg-emerald-900/30 text-emerald-400\"\n              : \"bg-red-900/30 text-red-400\"\n          }`}\n        >\n          {trend.type === \"up\" ? \"+\" : \"-\"}\n          {trend.value}%\n        </span>\n      )}\n    </div>\n    <div className=\"mt-4\">\n      <p className=\"text-sm text-slate-400 font-medium\">{label}</p>\n      <p className=\"text-2xl font-bold text-white mt-1 tracking-tight\">\n        {value}\n      </p>\n      {subValue && <p className=\"text-sm text-slate-500 mt-1\">{subValue}</p>}\n    </div>\n  </div>\n);\n\n// ============================================\n// 자산 카드 - 헤더용\n// ============================================\nexport const AssetCard = ({ icon: Icon, label, value, color, iconColor }) => (\n  <div\n    className={`hidden lg:flex items-center gap-3 px-3 py-1.5 rounded-xl ${color} bg-opacity-50 border border-transparent`}\n  >\n    <div\n      className={`w-10 h-10 rounded-xl flex items-center justify-center shadow-sm ${iconColor}`}\n    >\n      <Icon className=\"w-5 h-5\" />\n    </div>\n    <div>\n      <p className=\"text-[10px] font-bold opacity-70 mb-0 leading-tight\">\n        {label}\n      </p>\n      <p className=\"text-lg font-black tracking-tight leading-tight\">{value}</p>\n    </div>\n  </div>\n);\n\n// ============================================\n// 탭 컴포넌트\n// ============================================\nexport const TabGroup = ({ tabs, activeTab, onChange, className = \"\" }) => (\n  <div\n    className={`flex gap-1 p-1 bg-[#0a0a12] rounded-xl border border-cyan-900/30 ${className}`}\n  >\n    {tabs.map((tab) => (\n      <button\n        key={tab.id}\n        onClick={() => onChange(tab.id)}\n        className={`flex-1 px-4 py-2.5 text-sm font-bold rounded-lg transition-all duration-200 ${\n          activeTab === tab.id\n            ? \"bg-cyan-500 text-slate-900 shadow-lg shadow-cyan-500/30\"\n            : \"text-slate-400 hover:text-white hover:bg-white/5\"\n        }`}\n      >\n        {tab.icon && <tab.icon className=\"w-4 h-4 mr-2 inline-block\" />}\n        {tab.label}\n        {tab.count !== undefined && (\n          <span\n            className={`ml-2 px-1.5 py-0.5 text-xs rounded-full ${\n              activeTab === tab.id\n                ? \"bg-slate-900 text-cyan-400\"\n                : \"bg-slate-800 text-slate-400\"\n            }`}\n          >\n            {tab.count}\n          </span>\n        )}\n      </button>\n    ))}\n  </div>\n);\n\n// ============================================\n// 액션 버튼 - 새로운 디자인\n// ============================================\nexport const ActionButton = ({\n  children,\n  icon: Icon,\n  variant = \"primary\",\n  size = \"md\",\n  loading = false,\n  disabled = false,\n  onClick,\n  className = \"\",\n  title,\n}) => {\n  const variants = {\n    primary:\n      \"bg-cyan-500 text-slate-900 hover:bg-cyan-400 ring-1 ring-cyan-400 shadow-cyan-500/30\",\n    secondary: \"bg-slate-800 hover:bg-slate-700 text-slate-200\",\n    outline:\n      \"bg-transparent text-slate-300 ring-1 ring-slate-600 hover:bg-slate-800 hover:ring-slate-500 shadow-sm\",\n    \"outline-green\":\n      \"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm\",\n    \"outline-red\":\n      \"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm\",\n    danger:\n      \"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm\",\n    success:\n      \"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm\",\n    ghost: \"text-slate-400 hover:bg-slate-800 hover:text-white\",\n    indigo: \"bg-purple-900/30 text-purple-300 hover:bg-purple-900/50\",\n  };\n\n  const sizes = {\n    sm: \"px-4 py-2 text-sm\",\n    md: \"px-5 py-2.5 text-sm\",\n    lg: \"px-6 py-3 text-base\",\n  };\n\n  return (\n    <button\n      onClick={onClick}\n      disabled={disabled || loading}\n      title={title}\n      className={`inline-flex items-center justify-center gap-2 font-bold rounded-xl transition-all duration-200 active:scale-95 whitespace-nowrap focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${variants[variant]} ${sizes[size]} ${className}`}\n    >\n      {loading ? (\n        <Loader2 className=\"w-4 h-4 animate-spin\" />\n      ) : Icon ? (\n        <Icon className=\"w-4 h-4\" />\n      ) : null}\n      {children}\n    </button>\n  );\n};\n\n// ============================================\n// 정보 배지\n// ============================================\nexport const InfoBadge = ({\n  children,\n  variant = \"default\",\n  className = \"\",\n}) => {\n  const variants = {\n    default: \"bg-slate-100 text-slate-700\",\n    primary: \"bg-indigo-100 text-indigo-700\",\n    success: \"bg-emerald-100 text-emerald-700\",\n    warning: \"bg-amber-100 text-amber-700\",\n    danger: \"bg-red-100 text-red-700\",\n  };\n\n  return (\n    <span\n      className={`inline-flex items-center px-2.5 py-1 text-xs font-bold rounded-lg ${variants[variant]} ${className}`}\n    >\n      {children}\n    </span>\n  );\n};\n\n// ============================================\n// 알림 배너\n// ============================================\nexport const AlertBanner = ({\n  children,\n  variant = \"info\",\n  icon: Icon,\n  onClose,\n  className = \"\",\n}) => {\n  const variants = {\n    info: \"bg-blue-50 border-blue-200 text-blue-800\",\n    success: \"bg-emerald-50 border-emerald-200 text-emerald-800\",\n    warning: \"bg-amber-50 border-amber-200 text-amber-800\",\n    danger: \"bg-red-50 border-red-200 text-red-800\",\n  };\n\n  return (\n    <div\n      className={`flex items-start gap-3 p-4 rounded-xl border ${variants[variant]} ${className}`}\n    >\n      {Icon && <Icon className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />}\n      <div className=\"flex-1 text-sm font-medium\">{children}</div>\n      {onClose && (\n        <button\n          onClick={onClose}\n          className=\"text-current opacity-50 hover:opacity-100\"\n        >\n          ×\n        </button>\n      )}\n    </div>\n  );\n};\n\n// ============================================\n// 리스트 아이템 / 할일 아이템\n// ============================================\nexport const ListItem = ({\n  children,\n  icon: Icon,\n  onClick,\n  active,\n  className = \"\",\n}) => (\n  <div\n    className={`flex items-center gap-3 p-4 rounded-xl transition-all ${\n      onClick ? \"cursor-pointer\" : \"\"\n    } ${\n      active\n        ? \"bg-cyan-900/30 border border-cyan-500/50\"\n        : \"bg-[#14142380] border border-cyan-900/20 hover:border-cyan-500/30 hover:shadow-lg hover:shadow-cyan-500/10\"\n    } ${className}`}\n    onClick={onClick}\n  >\n    {Icon && (\n      <div\n        className={`p-2 rounded-lg ${active ? \"bg-cyan-500\" : \"bg-slate-800\"}`}\n      >\n        <Icon\n          className={`w-5 h-5 ${active ? \"text-slate-900\" : \"text-slate-400\"}`}\n        />\n      </div>\n    )}\n    <div className=\"flex-1 min-w-0\">{children}</div>\n  </div>\n);\n\n// ============================================\n// 할일 아이템 - 새로운 디자인\n// ============================================\nexport const TaskItem = ({\n  task,\n  onComplete,\n  onEdit,\n  onDelete,\n  showActions = true,\n}) => (\n  <div className=\"group flex items-center justify-between p-3 rounded-xl bg-[#0a0a12] border border-cyan-900/30 hover:border-cyan-500/50 hover:bg-slate-900/50 hover:shadow-lg hover:shadow-cyan-500/10 transition-all\">\n    <div className=\"flex items-center gap-3 min-w-0\">\n      <div\n        onClick={onComplete}\n        className=\"w-5 h-5 rounded md:rounded-md border-2 border-slate-600 group-hover:border-cyan-500 cursor-pointer transition-colors flex items-center justify-center shrink-0\"\n      >\n        {/* 체크박스 영역 */}\n      </div>\n      <span className=\"font-bold text-slate-300 text-base truncate group-hover:text-cyan-400 transition-colors\">\n        {task.name}\n      </span>\n    </div>\n\n    <div className=\"flex items-center gap-2 shrink-0\">\n      {task.rewardType === \"random\" && (\n        <span className=\"px-2.5 py-1 rounded-lg bg-amber-900/30 text-amber-400 text-xs font-bold flex items-center gap-1\">\n          🎁 랜덤\n        </span>\n      )}\n      {showActions && (\n        <div className=\"opacity-0 group-hover:opacity-100 flex gap-1 transition-opacity\">\n          {onEdit && (\n            <button\n              onClick={onEdit}\n              className=\"p-1.5 text-slate-500 hover:text-cyan-400 rounded hover:bg-cyan-900/30\"\n            >\n              ✏️\n            </button>\n          )}\n          {onDelete && (\n            <button\n              onClick={onDelete}\n              className=\"p-1.5 text-slate-500 hover:text-red-400 rounded hover:bg-red-900/30\"\n            >\n              🗑️\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  </div>\n);\n\n// ============================================\n// 직업 카드 - 새로운 디자인\n// ============================================\nexport const JobCard = ({ job, children, onEdit, onDelete, onAddTask }) => {\n  const gradients = {\n    indigo: \"from-indigo-500 to-purple-600\",\n    blue: \"from-blue-500 to-cyan-500\",\n    emerald: \"from-emerald-500 to-teal-600\",\n    orange: \"from-orange-400 to-red-500\",\n    pink: \"from-pink-500 to-rose-500\",\n    violet: \"from-violet-500 to-purple-600\",\n  };\n\n  const gradient = job.color || gradients.indigo;\n\n  return (\n    <div className=\"bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg hover:shadow-xl hover:shadow-cyan-500/10 transition-all duration-300 border border-cyan-900/30 overflow-hidden flex flex-col\">\n      {/* 카드 헤더 */}\n      <div\n        className={`h-16 px-6 flex items-center justify-between bg-gradient-to-r ${gradient}`}\n      >\n        <h4 className=\"text-white font-bold text-lg tracking-wide flex items-center gap-2\">\n          👑 {job.title}\n        </h4>\n        {(onEdit || onDelete) && (\n          <div className=\"flex gap-2\">\n            {onEdit && (\n              <button\n                onClick={onEdit}\n                className=\"p-1.5 rounded-lg bg-white/20 hover:bg-white/30 text-white transition-colors\"\n              >\n                ✏️\n              </button>\n            )}\n            {onDelete && (\n              <button\n                onClick={onDelete}\n                className=\"p-1.5 rounded-lg bg-white/20 hover:bg-white/30 text-white transition-colors\"\n              >\n                🗑️\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* 할일 목록 */}\n      <div className=\"p-6 space-y-4 flex-1\">{children}</div>\n\n      {/* 하단 버튼 */}\n      {onAddTask && (\n        <div className=\"px-6 pb-6 pt-2\">\n          <button\n            onClick={onAddTask}\n            className=\"w-full py-3 rounded-xl bg-slate-900/50 text-slate-400 text-sm font-bold border border-cyan-900/30 hover:bg-cyan-900/30 hover:text-cyan-400 hover:border-cyan-500/50 transition-colors flex items-center justify-center gap-2\"\n          >\n            ➕ 이 직업에 할일 추가\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// ============================================\n// 콘텐츠 섹션 카드\n// ============================================\nexport const ContentSection = ({ children, className = \"\" }) => (\n  <div\n    className={`bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg border border-cyan-900/30 p-6 ${className}`}\n  >\n    {children}\n  </div>\n);\n\n// ============================================\n// 금액 표시\n// ============================================\nexport const MoneyDisplay = ({\n  amount,\n  size = \"md\",\n  showSign = false,\n  className = \"\",\n}) => {\n  const formatted = Math.abs(amount || 0).toLocaleString(\"ko-KR\");\n  const isNegative = amount < 0;\n  const isPositive = amount > 0;\n\n  const sizes = {\n    sm: \"text-sm\",\n    md: \"text-base\",\n    lg: \"text-xl\",\n    xl: \"text-2xl\",\n  };\n\n  return (\n    <span\n      className={`font-bold tabular-nums ${sizes[size]} ${\n        isNegative\n          ? \"text-red-500\"\n          : isPositive && showSign\n            ? \"text-emerald-500\"\n            : \"text-slate-900\"\n      } ${className}`}\n    >\n      {showSign && isPositive && \"+\"}\n      {isNegative && \"-\"}\n      {formatted}원\n    </span>\n  );\n};\n\n// ============================================\n// 빈 추가 카드\n// ============================================\nexport const AddCard = ({ onClick, label = \"새로 추가하기\" }) => (\n  <button\n    onClick={onClick}\n    className=\"group relative flex flex-col items-center justify-center h-full min-h-[260px] rounded-2xl border-2 border-dashed border-cyan-900/50 bg-slate-900/30 hover:bg-cyan-900/20 hover:border-cyan-500/50 transition-all\"\n  >\n    <div className=\"w-16 h-16 rounded-full bg-slate-800 shadow-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform\">\n      <span className=\"text-3xl text-slate-500 group-hover:text-cyan-400\">\n        ➕\n      </span>\n    </div>\n    <span className=\"text-slate-500 font-bold group-hover:text-cyan-400 text-sm\">\n      {label}\n    </span>\n  </button>\n);\n\nexport default {\n  PageContainer,\n  PageHeader,\n  SectionTitle,\n  LoadingState,\n  ErrorState,\n  EmptyState,\n  CardGrid,\n  StatCard,\n  AssetCard,\n  TabGroup,\n  ActionButton,\n  InfoBadge,\n  AlertBanner,\n  ListItem,\n  TaskItem,\n  JobCard,\n  ContentSection,\n  MoneyDisplay,\n  AddCard,\n};\n","// src/ParkingAccount.js\r\nimport React, { useState, useEffect, useCallback } from \"react\";\r\nimport { db, doc, getDoc, setDoc, serverTimestamp, updateDoc, increment, runTransaction, collection, getDocs, deleteDoc, query, where, limit } from \"../../firebase\";\r\nimport { format, isToday, differenceInDays } from 'date-fns';\r\nimport { PiggyBank, Landmark, HandCoins, Wallet, X, TrendingUp } from 'lucide-react';\r\nimport { formatKoreanCurrency } from '../../utils/numberFormatter';\r\nimport { logActivity, ACTIVITY_TYPES } from '../../utils/firestoreHelpers';\r\n\r\nimport { logger } from \"../../utils/logger\";\r\n// 선생님(관리자) 계정 찾기 - 같은 학급의 관리자\r\nconst getTeacherAccount = async (classCode) => {\r\n  if (!classCode) return null;\r\n\r\n  try {\r\n    const usersRef = collection(db, \"users\");\r\n    const q = query(\r\n      usersRef,\r\n      where(\"classCode\", \"==\", classCode),\r\n      where(\"isAdmin\", \"==\", true),\r\n      limit(1)\r\n    );\r\n    const snapshot = await getDocs(q);\r\n\r\n    if (!snapshot.empty) {\r\n      const teacherDoc = snapshot.docs[0];\r\n      return {\r\n        id: teacherDoc.id,\r\n        ...teacherDoc.data()\r\n      };\r\n    }\r\n    return null;\r\n  } catch (error) {\r\n    logger.error(\"선생님 계정 조회 오류:\", error);\r\n    return null;\r\n  }\r\n};\r\n\r\n// --- Tailwind class helpers ---\r\nconst cls = {\r\n  container: \"font-sans bg-transparent p-8 min-h-0\",\r\n  message: (type) => `px-5 py-4 rounded-xl mb-7 text-center text-base font-medium shadow-sm ${\r\n    type === 'error'\r\n      ? 'text-red-400 bg-red-500/10 border border-red-500/30'\r\n      : 'text-emerald-400 bg-emerald-500/10 border border-emerald-500/30'\r\n  }`,\r\n  grid: \"grid gap-7 w-full\",\r\n  card: \"bg-[rgba(20,20,35,0.6)] shadow-[0_6px_20px_rgba(0,0,0,0.2)] rounded-2xl p-8 border border-white/5 backdrop-blur-[10px]\",\r\n  cardHeader: \"flex items-center gap-4 mb-6 pb-5 border-b-2 border-white/5\",\r\n  cardTitle: \"text-[26px] font-bold text-white tracking-tight drop-shadow-[0_0_10px_rgba(0,255,242,0.3)]\",\r\n  tabContainer: \"flex border-b-2 border-white/10 mb-5 gap-2\",\r\n  tabButton: (isActive) => `px-6 py-3 border-none cursor-pointer text-[17px] rounded-t-lg transition-all duration-200 -mb-0.5 ${\r\n    isActive\r\n      ? 'bg-indigo-500/20 font-bold text-cyber-cyan border-b-[3px] border-b-cyber-cyan drop-shadow-[0_0_5px_rgba(0,255,242,0.3)]'\r\n      : 'font-medium text-slate-400 border-b-[3px] border-b-transparent'\r\n  }`,\r\n  button: (disabled, variant = 'primary') => `text-white px-5 py-3 rounded-[10px] border border-white/10 text-[15px] font-semibold transition-all duration-200 ${\r\n    disabled ? 'cursor-not-allowed opacity-50' : 'cursor-pointer shadow-[0_4px_12px_rgba(0,0,0,0.3)] hover:-translate-y-0.5 hover:brightness-110'\r\n  } ${\r\n    variant === 'primary' ? 'bg-sky-700/80' : variant === 'danger' ? 'bg-red-600/80' : variant === 'success' ? 'bg-emerald-600/80' : 'bg-gray-600'\r\n  }`,\r\n  noProduct: \"text-center text-slate-400 py-8 text-base italic\",\r\n  input: \"w-full py-3.5 px-4 bg-black/20 border-2 border-white/10 rounded-[10px] mb-4 text-base text-white transition-colors duration-200 focus:outline-none focus:border-cyber-cyan focus:ring-2 focus:ring-cyber-cyan/10\",\r\n  modalOverlay: \"fixed inset-0 bg-black/80 flex items-center justify-center z-[1000] backdrop-blur-[8px]\",\r\n  modalContent: \"bg-[#1a1a2e] p-8 rounded-2xl w-[90%] max-w-[450px] relative shadow-[0_20px_60px_rgba(0,0,0,0.6)] border border-white/10 text-slate-200\",\r\n  modalTitle: \"text-2xl font-bold mb-5 text-white drop-shadow-[0_0_10px_rgba(0,255,242,0.3)]\",\r\n  modalCloseBtn: \"absolute top-5 right-5 bg-transparent border-none cursor-pointer text-slate-400 transition-colors duration-200 hover:text-white\",\r\n};\r\n\r\n// --- Helper Functions & Sub-Components ---\r\nconst formatCurrency = (amount) => (typeof amount === 'number' ? Math.round(amount).toLocaleString() : '0');\r\n\r\n// 일복리 계산\r\nconst calculateCompoundInterest = (principal, dailyRate, days) => {\r\n  if (principal <= 0 || !dailyRate || days <= 0) return { interest: 0, total: principal };\r\n  const total = principal * Math.pow(1 + dailyRate / 100, days);\r\n  const interest = total - principal;\r\n  return { interest: Math.round(interest), total: Math.round(total) };\r\n};\r\n\r\n// 일일 이자 계산 (메모이제이션으로 최적화)\r\nconst calculateDailyInterest = (principal, dailyRate) => {\r\n  // 콘솔 로그 제거 - 성능 최적화\r\n  return Math.round(principal * (dailyRate / 100));\r\n};\r\n\r\nconst ICON_MAP = {\r\n  parking: <Wallet size={28} className=\"text-sky-700\" />,\r\n  deposits: <Landmark size={28} className=\"text-emerald-600\" />,\r\n  savings: <PiggyBank size={28} className=\"text-violet-600\" />,\r\n  loans: <HandCoins size={28} className=\"text-red-600\" />,\r\n};\r\n\r\nconst SubscribedProductItem = ({ product, onCancel, onMaturity }) => {\r\n  const isMatured = product.maturityDate && new Date() >= product.maturityDate;\r\n  const daysRemaining = product.maturityDate ? Math.max(0, differenceInDays(product.maturityDate, new Date())) : 0;\r\n  const dailyRate = product.rate; // 연이율을 일이율로 변환\r\n\r\n  const { interest, total } = calculateCompoundInterest(\r\n    product.balance,\r\n    product.rate, // 일복리\r\n    product.termInDays\r\n  );\r\n\r\n  const dailyInterestAmount = calculateDailyInterest(product.balance, product.rate);\r\n\r\n  return (\r\n    <div className={`p-5 border-2 rounded-xl mb-4 shadow-[0_2px_8px_rgba(0,0,0,0.2)] ${\r\n      isMatured ? 'border-emerald-500/50 bg-emerald-500/10' : 'border-white/10 bg-black/20'\r\n    }`}>\r\n      <div className=\"flex justify-between items-start mb-3\">\r\n        <div>\r\n          <div className=\"font-bold text-lg text-slate-200 mb-1\">{product.name}</div>\r\n          {isMatured && <span className=\"bg-emerald-500 text-white px-3 py-1 rounded-full text-[13px] font-semibold\">만기</span>}\r\n        </div>\r\n        <span className=\"text-xl font-bold text-cyber-cyan\">{formatCurrency(product.balance)}원</span>\r\n      </div>\r\n\r\n      <div className=\"text-[15px] text-slate-400 mt-4 grid gap-2.5 bg-black/20 p-4 rounded-lg\">\r\n        <div className=\"flex justify-between\">\r\n          <span className=\"font-medium\">금리 (일):</span>\r\n          <span className=\"font-bold text-cyber-cyan\">{product.rate}%</span>\r\n        </div>\r\n        <div className=\"flex justify-between\">\r\n          <span className=\"font-medium\">일일 이자:</span>\r\n          <span className=\"font-bold text-emerald-400\">+{formatCurrency(dailyInterestAmount)}원/일</span>\r\n        </div>\r\n        {product.maturityDate && (\r\n          <>\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"font-medium\">만기일:</span>\r\n              <span className=\"font-semibold text-slate-200\">{format(product.maturityDate, 'yyyy-MM-dd')}</span>\r\n            </div>\r\n            {!isMatured && (\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"font-medium\">남은 기간:</span>\r\n                <span className=\"font-semibold text-cyber-cyan\">{daysRemaining}일</span>\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"border-t border-dashed border-white/10 my-4\"></div>\r\n\r\n      <div className=\"text-[15px] text-slate-200 grid gap-2.5 bg-cyber-cyan/5 p-4 rounded-lg border border-cyber-cyan/10\">\r\n        <div className=\"flex justify-between\">\r\n          <span className=\"font-semibold\">만기 시 이자 (세전):</span>\r\n          <span className=\"font-bold text-emerald-400 text-[17px]\">+{formatCurrency(interest)}원</span>\r\n        </div>\r\n        <div className=\"flex justify-between text-[17px]\">\r\n          <span className=\"font-bold\">만기 시 총액:</span>\r\n          <span className=\"font-bold text-cyber-cyan\">{formatCurrency(total)}원</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-5 text-right\">\r\n        {isMatured ? (\r\n          <button\r\n            onClick={onMaturity}\r\n            className={cls.button(false, 'success') + ' px-5 py-2.5 text-[15px]'}\r\n          >\r\n            만기 수령 ({formatCurrency(total)}원)\r\n          </button>\r\n        ) : (\r\n          <button\r\n            onClick={onCancel}\r\n            className={cls.button(false, 'danger') + ' px-5 py-2.5 text-[15px]'}\r\n          >\r\n            {product.type === 'loan' ? '대출 상환' : '중도 해지'}\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst AvailableProductItem = ({ product, onSubscribe }) => {\r\n  const dailyRate = product.dailyRate;\r\n  const { interest: projectedInterest } = calculateCompoundInterest(100000, dailyRate, product.termInDays);\r\n\r\n  return (\r\n    <div className=\"p-5 border-2 border-white/10 rounded-xl mb-3 flex justify-between items-center bg-black/20 shadow-[0_2px_8px_rgba(0,0,0,0.2)] transition-all duration-200\">\r\n      <div>\r\n        <div className=\"font-bold text-lg text-slate-200 mb-2\">{product.name}</div>\r\n        <div className=\"text-[15px] text-slate-400 mb-1.5\">\r\n          <strong className=\"text-cyber-cyan\">일 {product.dailyRate}%</strong> (기간: {product.termInDays}일)\r\n        </div>\r\n        <div className=\"text-sm text-emerald-400 font-semibold\">\r\n          <TrendingUp size={14} className=\"inline mr-1\" />\r\n          10만원 가입 시 예상 이자: +{formatCurrency(projectedInterest)}원\r\n        </div>\r\n      </div>\r\n      <button\r\n        onClick={onSubscribe}\r\n        className={cls.button(false) + ' px-6 py-3 text-base'}\r\n      >\r\n        가입\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ProductSection = ({ title, icon, subscribedProducts, availableProducts, onSubscribe, onCancel, onMaturity }) => {\r\n  const [activeTab, setActiveTab] = useState('subscribed');\r\n  return (\r\n    <div className={cls.card}>\r\n      <div className={cls.cardHeader}>\r\n        {icon}\r\n        <h2 className={cls.cardTitle}>{title}</h2>\r\n      </div>\r\n      <div className={cls.tabContainer}>\r\n        <button\r\n          onClick={() => setActiveTab('subscribed')}\r\n          className={cls.tabButton(activeTab === 'subscribed')}\r\n        >\r\n          가입한 상품\r\n        </button>\r\n        <button\r\n          onClick={() => setActiveTab('available')}\r\n          className={cls.tabButton(activeTab === 'available')}\r\n        >\r\n          가입 가능한 상품\r\n        </button>\r\n      </div>\r\n      <div>\r\n        {activeTab === 'subscribed' && (\r\n          subscribedProducts.length > 0\r\n            ? subscribedProducts.map(p => (\r\n              <SubscribedProductItem\r\n                key={p.id}\r\n                product={p}\r\n                onCancel={() => onCancel(p)}\r\n                onMaturity={() => onMaturity(p)}\r\n              />\r\n            ))\r\n            : <p className={cls.noProduct}>가입한 상품이 없습니다.</p>\r\n        )}\r\n        {activeTab === 'available' && (\r\n          availableProducts.length > 0\r\n            ? availableProducts.map(p => (\r\n              <AvailableProductItem\r\n                key={p.id}\r\n                product={p}\r\n                onSubscribe={() => onSubscribe(p)}\r\n              />\r\n            ))\r\n            : <p className={cls.noProduct}>가입 가능한 상품이 없습니다.</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst SubscriptionModal = ({ isOpen, onClose, product, onConfirm, isProcessing }) => {\r\n  const [amount, setAmount] = useState(\"\");\r\n\r\n  if (!isOpen || !product) return null;\r\n\r\n  const numAmount = parseFloat(amount);\r\n  const dailyRate = product.dailyRate;\r\n  const { interest: projectedInterest, total: projectedTotal } = !isNaN(numAmount) && numAmount > 0\r\n    ? calculateCompoundInterest(numAmount, dailyRate, product.termInDays)\r\n    : { interest: 0, total: 0 };\r\n\r\n  return (\r\n    <div className={cls.modalOverlay} onClick={onClose}>\r\n      <div className={cls.modalContent} onClick={(e) => e.stopPropagation()}>\r\n        <button onClick={onClose} className={cls.modalCloseBtn} aria-label=\"닫기\"><X size={24} /></button>\r\n        <h3 className={cls.modalTitle}>{product.name} 가입</h3>\r\n\r\n        <div className=\"mb-5 p-4 bg-cyber-cyan/5 rounded-[10px] border border-cyber-cyan/20\">\r\n          <div className=\"text-[15px] text-slate-400 mb-2\">\r\n            <strong className=\"text-cyber-cyan\">금리:</strong> 일 {product.dailyRate}% (일복리)\r\n          </div>\r\n          <div className=\"text-[15px] text-slate-400\">\r\n            <strong className=\"text-cyber-cyan\">기간:</strong> {product.termInDays}일\r\n          </div>\r\n        </div>\r\n\r\n        <p className=\"mb-3 text-base font-semibold text-slate-200\">가입 금액을 입력해주세요</p>\r\n        <input\r\n          type=\"number\"\r\n          value={amount}\r\n          onChange={(e) => setAmount(e.target.value)}\r\n          className={cls.input}\r\n          placeholder={`${formatCurrency(product.minAmount || 0)}원 이상`}\r\n          autoFocus\r\n        />\r\n\r\n        {numAmount > 0 && (\r\n          <div className=\"mb-5 p-4 bg-emerald-500/10 rounded-[10px] border border-emerald-500/30\">\r\n            <div className=\"text-[15px] text-emerald-400 mb-1.5\">\r\n              예상 만기 이자: <strong>+{formatCurrency(projectedInterest)}원</strong>\r\n            </div>\r\n            <div className=\"text-base text-emerald-400 font-bold\">\r\n              만기 시 총액: {formatCurrency(projectedTotal)}원\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <button\r\n          onClick={() => { onConfirm(amount); setAmount(\"\"); }}\r\n          disabled={isProcessing || !amount}\r\n          className={cls.button(isProcessing || !amount) + ' w-full text-[17px] py-4'}\r\n        >\r\n          {isProcessing ? '처리 중...' : '가입하기'}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ParkingAccountSection = ({ balance, dailyInterest, onDeposit, onWithdraw, isProcessing, userCash }) => {\r\n  const [amount, setAmount] = useState(\"\");\r\n\r\n  return (\r\n    <div className=\"bg-gradient-to-br from-[rgba(6,78,117,0.85)] to-[rgba(20,40,60,0.9)] text-white shadow-[0_8px_24px_rgba(0,0,0,0.4)] rounded-2xl p-8 border border-[rgba(0,180,216,0.25)] backdrop-blur-[10px]\">\r\n      <div className=\"flex items-center gap-4 mb-6 pb-5 border-b-2 border-[rgba(0,180,216,0.2)]\">\r\n        <Wallet size={32} className=\"text-cyan-300\" />\r\n        <h2 className=\"text-[26px] font-bold text-[#e0f7fa] tracking-tight drop-shadow-[0_0_10px_rgba(0,255,242,0.3)]\">파킹통장</h2>\r\n      </div>\r\n\r\n      {/* 보유현금 표시 */}\r\n      <div className=\"bg-[rgba(0,180,216,0.15)] px-4 py-3 rounded-[10px] mb-4 backdrop-blur-[10px] flex justify-between items-center border border-[rgba(0,180,216,0.2)]\">\r\n        <span className=\"text-base font-medium text-slate-400\">보유 현금</span>\r\n        <span className=\"text-xl font-bold text-[#e0f7fa]\">{formatCurrency(userCash || 0)}원</span>\r\n      </div>\r\n\r\n      <div className=\"text-[42px] font-bold text-[#e0f7fa] mb-2\">\r\n        {formatCurrency(balance)}원\r\n      </div>\r\n\r\n      <p className=\"text-base text-[#e0f7fa]/80 mb-4 font-medium\">\r\n        매일 이자가 자동 지급되는 자유 입출금 통장\r\n      </p>\r\n\r\n      <div className=\"bg-[rgba(0,180,216,0.12)] p-4 rounded-[10px] mb-6 backdrop-blur-[10px] border border-[rgba(0,180,216,0.2)]\">\r\n        <div className=\"flex items-center gap-2 mb-2\">\r\n          <TrendingUp size={20} className=\"text-cyan-300\" />\r\n          <span className=\"text-[15px] font-semibold text-slate-400\">일일 이자 수익</span>\r\n        </div>\r\n        <div className=\"text-[28px] font-bold text-cyan-300\">\r\n          +{formatCurrency(dailyInterest)}원/일\r\n        </div>\r\n        <div className=\"text-sm mt-1.5 text-slate-400/90\">\r\n          (일 1% 복리 기준)\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex gap-2.5\">\r\n        <input\r\n          type=\"number\"\r\n          value={amount}\r\n          onChange={(e) => setAmount(e.target.value)}\r\n          placeholder=\"금액 입력\"\r\n          className=\"flex-1 py-3.5 px-4 bg-black/30 border border-[rgba(0,180,216,0.3)] rounded-[10px] text-[17px] text-white focus:outline-none focus:border-cyber-cyan\"\r\n          disabled={isProcessing}\r\n        />\r\n        <button\r\n          onClick={() => { onDeposit(amount); setAmount(\"\"); }}\r\n          disabled={isProcessing}\r\n          className={cls.button(isProcessing, 'success') + ' text-[17px] px-6 py-3.5'}\r\n        >\r\n          입금\r\n        </button>\r\n        <button\r\n          onClick={() => { onWithdraw(amount); setAmount(\"\"); }}\r\n          disabled={isProcessing}\r\n          className={cls.button(isProcessing) + ' !bg-slate-500/50 text-[17px] px-6 py-3.5'}\r\n        >\r\n          출금\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// --- Main Component ---\r\nconst ParkingAccount = ({\r\n  auth = {},\r\n  depositProducts = [],\r\n  installmentProducts = [],\r\n  loanProducts = [],\r\n  activeView = 'parking',\r\n  onViewChange,\r\n  onLoadUserProducts,\r\n  allUserProducts = [],\r\n  onDeleteUserProduct\r\n}) => {\r\n  const { user, userDoc, loading, refreshUserDocument, isAdmin, addCash, deductCash } = auth;\r\n  const userId = user?.uid;\r\n\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [message, setMessage] = useState(null);\r\n  const [messageType, setMessageType] = useState(\"\");\r\n  const [parkingBalance, setParkingBalance] = useState(0);\r\n  const [parkingDailyInterest, setParkingDailyInterest] = useState(0);\r\n  const [userDeposits, setUserDeposits] = useState([]);\r\n  const [userSavings, setUserSavings] = useState([]);\r\n  const [userLoans, setUserLoans] = useState([]);\r\n  const [modal, setModal] = useState({ isOpen: false, product: null, type: '' });\r\n  const [currentCash, setCurrentCash] = useState(userDoc?.cash || 0);\r\n\r\n  const displayMessage = (text, type = \"info\", duration = 3000) => {\r\n    setMessage(text);\r\n    setMessageType(type);\r\n    if (duration) setTimeout(() => setMessage(null), duration);\r\n  };\r\n\r\n  const loadAllData = useCallback(async () => {\r\n    if (!userId) return;\r\n    setIsProcessing(true);\r\n    try {\r\n      // 파킹통장 처리\r\n      const parkingRef = doc(db, \"users\", userId, \"financials\", \"parkingAccount\");\r\n      const parkingRateProduct = depositProducts.length > 0 ? depositProducts[0] : null;\r\n\r\n      if (parkingRateProduct) {\r\n        const parkingDoc = await getDoc(parkingRef);\r\n        if (parkingDoc.exists()) {\r\n          const data = parkingDoc.data();\r\n          const lastInterestDate = data.lastInterestDate?.toDate();\r\n\r\n          if (!lastInterestDate || !isToday(lastInterestDate)) {\r\n            const daysToApply = lastInterestDate ? differenceInDays(new Date(), lastInterestDate) : 1;\r\n            if (daysToApply > 0) {\r\n              const dailyRate = (parkingRateProduct.dailyRate || 0.0027); // 기본 1% 연이율을 일로 환산한 값과 유사하게\r\n              const { interest } = calculateCompoundInterest(data.balance || 0, dailyRate, daysToApply);\r\n\r\n              if (interest > 0) {\r\n                await updateDoc(parkingRef, {\r\n                  balance: increment(interest),\r\n                  lastInterestDate: serverTimestamp()\r\n                });\r\n                displayMessage(`파킹통장 이자 ${formatCurrency(interest)}원이 지급되었습니다.`, 'success');\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          // 파킹통장이 없으면 생성\r\n          await setDoc(parkingRef, {\r\n            balance: 0,\r\n            lastInterestDate: serverTimestamp()\r\n          });\r\n        }\r\n      }\r\n\r\n      // 최종 잔액 조회\r\n      const finalParkingDoc = await getDoc(parkingRef);\r\n      if (finalParkingDoc.exists()) {\r\n        const balance = finalParkingDoc.data().balance || 0;\r\n        setParkingBalance(balance);\r\n\r\n        // 일일 이자 계산 (1% 기준)\r\n        const dailyRate = 1; // 1% 일일 이자율\r\n        const dailyInterest = calculateDailyInterest(balance, dailyRate);\r\n        setParkingDailyInterest(dailyInterest);\r\n      }\r\n\r\n      // 가입 상품 조회\r\n      const productsRef = collection(db, \"users\", userId, \"products\");\r\n      const snapshot = await getDocs(productsRef);\r\n      const deposits = [], savings = [], loans = [];\r\n\r\n      snapshot.forEach(docSnap => {\r\n        const product = {\r\n          id: docSnap.id,\r\n          ...docSnap.data(),\r\n          maturityDate: docSnap.data().maturityDate?.toDate ? docSnap.data().maturityDate.toDate() : docSnap.data().maturityDate\r\n        };\r\n        if (product.type === 'deposit') deposits.push(product);\r\n        else if (product.type === 'savings') savings.push(product);\r\n        else if (product.type === 'loan') loans.push(product);\r\n      });\r\n\r\n      setUserDeposits(deposits);\r\n      setUserSavings(savings);\r\n      setUserLoans(loans);\r\n    } catch (error) {\r\n      logger.error(\"데이터 로드 오류:\", error);\r\n      displayMessage(\"데이터를 불러오는 데 실패했습니다.\", \"error\");\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  }, [userId, depositProducts]);\r\n\r\n  useEffect(() => {\r\n    if (!loading && userId) loadAllData();\r\n  }, [userId, loading, loadAllData]);\r\n\r\n  // userDoc의 cash가 변경될 때마다 currentCash 업데이트\r\n  useEffect(() => {\r\n    if (userDoc?.cash !== undefined) {\r\n      setCurrentCash(userDoc.cash);\r\n      logger.log(\"[ParkingAccount] currentCash 업데이트:\", userDoc.cash);\r\n    }\r\n  }, [userDoc?.cash]);\r\n\r\n  const handleOpenModal = (product, type) => setModal({ isOpen: true, product, type });\r\n  const handleCloseModal = () => setModal({ isOpen: false, product: null, type: '' });\r\n\r\n  const handleSubscribe = async (subscribeAmount) => {\r\n    logger.log(\"--- handleSubscribe 시작 ---\");\r\n    const amount = parseFloat(subscribeAmount);\r\n    const { product, type } = modal;\r\n\r\n    logger.log(\"가입할 상품:\", product);\r\n    logger.log(`가입 유형: ${type}, 가입 금액: ${amount}`);\r\n\r\n    if (isNaN(amount) || amount <= 0) {\r\n      logger.error(\"유효하지 않은 금액:\", subscribeAmount);\r\n      return displayMessage(\"유효한 금액을 입력하세요.\", \"error\");\r\n    }\r\n    if (product.minAmount && amount < product.minAmount) {\r\n      logger.error(`최소 가입 금액 미달: ${amount} < ${product.minAmount}`);\r\n      return displayMessage(`최소 가입 금액은 ${formatCurrency(product.minAmount)}원입니다.`, \"error\");\r\n    }\r\n    if (product.maxAmount && amount > product.maxAmount) {\r\n      logger.error(`최대 가입 한도 초과: ${amount} > ${product.maxAmount}`);\r\n      return displayMessage(`최대 가입 한도는 ${formatCurrency(product.maxAmount)}원입니다.`, \"error\");\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    handleCloseModal(); // UX 개선을 위해 모달 즉시 닫기\r\n\r\n    // --- 선생님 계정 조회 ---\r\n    const teacherAccount = await getTeacherAccount(userDoc?.classCode);\r\n    if (!teacherAccount) {\r\n      displayMessage(\"선생님(은행) 계정을 찾을 수 없습니다. 관리자에게 문의하세요.\", \"error\");\r\n      setIsProcessing(false);\r\n      return;\r\n    }\r\n    logger.log(\"선생님 계정:\", teacherAccount.name, teacherAccount.id);\r\n\r\n    // --- 낙관적 업데이트 (Optimistic Update) ---\r\n    const tempId = `temp_${Date.now()}`;\r\n    const maturityDate = new Date(Date.now() + product.termInDays * 24 * 60 * 60 * 1000);\r\n    const optimisticProduct = {\r\n      id: tempId,\r\n      name: product.name,\r\n      termInDays: product.termInDays,\r\n      rate: product.dailyRate,\r\n      balance: amount,\r\n      startDate: new Date(),\r\n      maturityDate: maturityDate,\r\n      type: type === 'deposits' ? 'deposit' : (type === 'savings' ? 'savings' : 'loan'),\r\n      isOptimistic: true // 임시 데이터임을 표시\r\n    };\r\n\r\n    // 상품 목록 낙관적 업데이트\r\n    if (optimisticProduct.type === 'deposit') {\r\n      setUserDeposits(prev => [...prev, optimisticProduct]);\r\n    } else if (optimisticProduct.type === 'savings') {\r\n      setUserSavings(prev => [...prev, optimisticProduct]);\r\n    } else if (optimisticProduct.type === 'loan') {\r\n      setUserLoans(prev => [...prev, optimisticProduct]);\r\n    }\r\n\r\n    // 현금 보유량 낙관적 업데이트\r\n    const cashChangeAmount = type === 'loans' ? amount : -amount;\r\n    setCurrentCash(prev => prev + cashChangeAmount); // 로컬 UI 상태만 먼저 업데이트\r\n\r\n    try {\r\n      await runTransaction(db, async (transaction) => {\r\n        const userRef = doc(db, \"users\", userId);\r\n        const teacherRef = doc(db, \"users\", teacherAccount.id);\r\n\r\n        const userSnapshot = await transaction.get(userRef);\r\n        const teacherSnapshot = await transaction.get(teacherRef);\r\n\r\n        if (!userSnapshot.exists()) throw new Error(\"사용자 정보를 찾을 수 없습니다.\");\r\n        if (!teacherSnapshot.exists()) throw new Error(\"선생님(은행) 계정을 찾을 수 없습니다.\");\r\n\r\n        const currentCashInDb = userSnapshot.data()?.cash ?? 0;\r\n        const teacherCashInDb = teacherSnapshot.data()?.cash ?? 0;\r\n\r\n        // 예금/적금: 학생 현금 확인\r\n        if (type !== 'loans' && currentCashInDb < amount) {\r\n          throw new Error(\"보유 현금이 부족합니다.\");\r\n        }\r\n\r\n        // 대출: 선생님(은행) 현금 확인\r\n        if (type === 'loans' && teacherCashInDb < amount) {\r\n          throw new Error(\"은행(선생님)에 대출 가능한 자금이 부족합니다.\");\r\n        }\r\n\r\n        const newProductData = {\r\n          name: product.name,\r\n          termInDays: product.termInDays,\r\n          rate: product.dailyRate,\r\n          balance: amount,\r\n          startDate: serverTimestamp(),\r\n          maturityDate: maturityDate,\r\n          type: type === 'deposits' ? 'deposit' : (type === 'savings' ? 'savings' : 'loan'),\r\n          teacherId: teacherAccount.id, // 선생님 계정 ID 저장\r\n          teacherName: teacherAccount.name || '선생님'\r\n        };\r\n\r\n        const newProductRef = doc(collection(db, \"users\", userId, \"products\"));\r\n        transaction.set(newProductRef, newProductData);\r\n\r\n        // 예금/적금: 학생 → 선생님\r\n        // 대출: 선생님 → 학생\r\n        if (type === 'loans') {\r\n          // 대출: 선생님에서 학생으로\r\n          transaction.update(userRef, { cash: increment(amount) });\r\n          transaction.update(teacherRef, { cash: increment(-amount) });\r\n        } else {\r\n          // 예금/적금: 학생에서 선생님으로\r\n          transaction.update(userRef, { cash: increment(-amount) });\r\n          transaction.update(teacherRef, { cash: increment(amount) });\r\n        }\r\n      });\r\n\r\n      const actionText = type === 'loans' ? '대출' : '가입';\r\n      displayMessage(`${product.name} ${actionText}이 완료되었습니다. (선생님 계정과 연동)`, \"success\");\r\n\r\n      // 🔥 활동 로그 기록 (예금/적금/대출 가입)\r\n      const activityType = type === 'deposits' ? ACTIVITY_TYPES.DEPOSIT_CREATE\r\n        : type === 'savings' ? ACTIVITY_TYPES.DEPOSIT_CREATE\r\n          : ACTIVITY_TYPES.LOAN_CREATE;\r\n      logActivity(db, {\r\n        classCode: userDoc?.classCode,\r\n        userId: userId,\r\n        userName: userDoc?.name || '사용자',\r\n        type: activityType,\r\n        description: `${product.name} ${type === 'loans' ? '대출' : '가입'} (${formatCurrency(amount)}원) - 선생님 계정 연동`,\r\n        amount: cashChangeAmount,\r\n        metadata: {\r\n          productName: product.name,\r\n          productType: type,\r\n          termInDays: product.termInDays,\r\n          dailyRate: product.dailyRate,\r\n          maturityDate: maturityDate.toISOString(),\r\n          teacherId: teacherAccount.id,\r\n          teacherName: teacherAccount.name\r\n        }\r\n      });\r\n\r\n      // 서버 데이터로 다시 로드하여 낙관적 업데이트 결과 교체\r\n      await loadAllData();\r\n      if (refreshUserDocument) refreshUserDocument();\r\n\r\n    } catch (error) {\r\n      logger.error(\"가입 처리 중 오류 발생:\", error);\r\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\r\n\r\n      // --- 낙관적 업데이트 롤백 ---\r\n      if (optimisticProduct.type === 'deposit') {\r\n        setUserDeposits(prev => prev.filter(p => p.id !== tempId));\r\n      } else if (optimisticProduct.type === 'savings') {\r\n        setUserSavings(prev => prev.filter(p => p.id !== tempId));\r\n      } else if (optimisticProduct.type === 'loan') {\r\n        setUserLoans(prev => prev.filter(p => p.id !== tempId));\r\n      }\r\n\r\n      // 현금 롤백 (로컬 UI)\r\n      setCurrentCash(prev => prev - cashChangeAmount);\r\n\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  // 만기 수령\r\n  const handleMaturity = async (product) => {\r\n    logger.log(\"--- handleMaturity 시작 ---\");\r\n    logger.log(\"처리할 상품:\", product);\r\n\r\n    const { id, name, type, balance, termInDays, rate, teacherId } = product;\r\n    const isLoan = type === 'loan';\r\n\r\n    if (!userId) {\r\n      displayMessage(\"사용자 정보가 없습니다. 다시 로그인해주세요.\", \"error\");\r\n      logger.error(\"handleMaturity: userId가 없습니다.\");\r\n      return;\r\n    }\r\n\r\n    const dailyRate = rate;\r\n    const { total, interest } = calculateCompoundInterest(balance, dailyRate, termInDays);\r\n\r\n    logger.log(`계산 결과: 원금=${balance}, 이자=${interest}, 총액=${total}`);\r\n\r\n    const confirmMsg = isLoan\r\n      ? `대출 만기 상환: 원금 ${formatCurrency(balance)}원 + 이자 ${formatCurrency(interest)}원 = ${formatCurrency(total)}원을 상환하시겠습니까?`\r\n      : `만기 수령: 원금 ${formatCurrency(balance)}원 + 이자 ${formatCurrency(interest)}원 = ${formatCurrency(total)}원을 수령하시겠습니까?`;\r\n\r\n    if (!window.confirm(confirmMsg)) {\r\n      logger.log(\"사용자가 만기 처리를 취소했습니다.\");\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    logger.log(\"만기 처리 시작...\");\r\n\r\n    // 선생님 계정 조회 (저장된 teacherId 사용 또는 새로 조회)\r\n    let teacherAccountId = teacherId;\r\n    if (!teacherAccountId) {\r\n      const teacherAccount = await getTeacherAccount(userDoc?.classCode);\r\n      if (!teacherAccount) {\r\n        displayMessage(\"선생님(은행) 계정을 찾을 수 없습니다.\", \"error\");\r\n        setIsProcessing(false);\r\n        return;\r\n      }\r\n      teacherAccountId = teacherAccount.id;\r\n    }\r\n    logger.log(\"선생님 계정 ID:\", teacherAccountId);\r\n\r\n    try {\r\n      const productRef = doc(db, \"users\", userId, \"products\", String(id));\r\n      logger.log(\"Firestore 문서 참조:\", productRef.path);\r\n\r\n      await runTransaction(db, async (transaction) => {\r\n        logger.log(\"트랜잭션 시작\");\r\n        const userRef = doc(db, \"users\", userId);\r\n        const teacherRef = doc(db, \"users\", teacherAccountId);\r\n\r\n        const userSnapshot = await transaction.get(userRef);\r\n        const teacherSnapshot = await transaction.get(teacherRef);\r\n\r\n        if (!userSnapshot.exists()) throw new Error(\"사용자 정보를 찾을 수 없습니다.\");\r\n        if (!teacherSnapshot.exists()) throw new Error(\"선생님(은행) 계정을 찾을 수 없습니다.\");\r\n\r\n        const currentCashInDb = userSnapshot.data()?.cash ?? 0;\r\n        const teacherCashInDb = teacherSnapshot.data()?.cash ?? 0;\r\n\r\n        if (isLoan) {\r\n          // 대출 만기 상환: 학생 → 선생님 (원금+이자)\r\n          if (currentCashInDb < total) {\r\n            throw new Error(`상환금이 부족합니다. (필요: ${formatCurrency(total)}원, 보유: ${formatCurrency(currentCashInDb)}원)`);\r\n          }\r\n          transaction.update(userRef, { cash: increment(-total) });\r\n          transaction.update(teacherRef, { cash: increment(total) });\r\n          logger.log(`대출 상환: 학생 -${total}, 선생님 +${total}`);\r\n        } else {\r\n          // 예금/적금 만기 수령: 선생님 → 학생 (원금+이자)\r\n          if (teacherCashInDb < total) {\r\n            throw new Error(`은행(선생님)에 지급할 자금이 부족합니다. (필요: ${formatCurrency(total)}원)`);\r\n          }\r\n          transaction.update(userRef, { cash: increment(total) });\r\n          transaction.update(teacherRef, { cash: increment(-total) });\r\n          logger.log(`만기 수령: 학생 +${total}, 선생님 -${total}`);\r\n        }\r\n\r\n        transaction.delete(productRef);\r\n        logger.log(\"상품 문서 삭제 예약\");\r\n        logger.log(\"트랜잭션 커밋 시도\");\r\n      });\r\n\r\n      logger.log(\"트랜잭션 성공\");\r\n\r\n      const successMsg = isLoan\r\n        ? `대출 상환 완료: ${formatCurrency(total)}원 (선생님 계정으로 이체)`\r\n        : `만기 수령 완료: ${formatCurrency(total)}원 (선생님 계정에서 지급)`;\r\n      displayMessage(successMsg, \"success\");\r\n\r\n      // 🔥 활동 로그 기록 (예금 만기 / 대출 상환)\r\n      const activityType = isLoan ? ACTIVITY_TYPES.LOAN_REPAY : ACTIVITY_TYPES.DEPOSIT_MATURITY;\r\n      logActivity(db, {\r\n        classCode: userDoc?.classCode,\r\n        userId: userId,\r\n        userName: userDoc?.name || '사용자',\r\n        type: activityType,\r\n        description: isLoan\r\n          ? `대출 만기 상환: ${name} (원금: ${formatCurrency(balance)}, 이자: ${formatCurrency(interest)}) - 선생님 계정으로`\r\n          : `${name} 만기 수령 (원금: ${formatCurrency(balance)}, 이자: ${formatCurrency(interest)}) - 선생님 계정에서`,\r\n        amount: isLoan ? -total : total,\r\n        metadata: {\r\n          productName: name,\r\n          productType: type,\r\n          principal: balance,\r\n          interest,\r\n          total,\r\n          teacherId: teacherAccountId\r\n        }\r\n      });\r\n\r\n      // 백그라운드에서 userDoc 갱신\r\n      if (refreshUserDocument) {\r\n        logger.log(\"userDoc 갱신 시작\");\r\n        refreshUserDocument().then(() => {\r\n          logger.log(\"[ParkingAccount] 만기 처리 후 userDoc 갱신 완료\");\r\n        });\r\n      }\r\n\r\n      logger.log(\"전체 데이터 다시 로드\");\r\n      await loadAllData();\r\n\r\n    } catch (error) {\r\n      logger.error(\"만기 처리 중 오류 발생:\", error);\r\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\r\n      // 에러 발생 시 currentCash 롤백\r\n      if (userDoc?.cash !== undefined) {\r\n        logger.log(\"오류 발생으로 현금 롤백:\", userDoc.cash);\r\n        setCurrentCash(userDoc.cash);\r\n      }\r\n    } finally {\r\n      setIsProcessing(false);\r\n      logger.log(\"--- handleMaturity 종료 ---\");\r\n    }\r\n  };\r\n\r\n  // 중도 해지\r\n  const handleCancelEarly = async (product) => {\r\n    logger.log(\"--- handleCancelEarly 시작 ---\");\r\n    logger.log(\"중도 해지할 상품:\", product);\r\n\r\n    const { id, name, type, balance } = product;\r\n    const isLoan = type === 'loan';\r\n\r\n    if (!userId) {\r\n      displayMessage(\"사용자 정보가 없습니다. 다시 로그인해주세요.\", \"error\");\r\n      logger.error(\"handleCancelEarly: userId가 없습니다.\");\r\n      return;\r\n    }\r\n\r\n    const confirmMessage = isLoan\r\n      ? `대출금 ${formatCurrency(balance)}원을 상환하시겠습니까?`\r\n      : `'${name}'을(를) 중도 해지하시겠습니까? (이자 없이 원금만 반환됩니다)`;\r\n\r\n    if (!window.confirm(confirmMessage)) {\r\n      logger.log(\"사용자가 중도 해지를 취소했습니다.\");\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    logger.log(\"중도 해지 처리 시작...\");\r\n\r\n    // 선생님 계정 조회 (저장된 teacherId 사용 또는 새로 조회)\r\n    const teacherId = product.teacherId;\r\n    let teacherAccountId = teacherId;\r\n    if (!teacherAccountId) {\r\n      const teacherAccount = await getTeacherAccount(userDoc?.classCode);\r\n      if (!teacherAccount) {\r\n        displayMessage(\"선생님(은행) 계정을 찾을 수 없습니다.\", \"error\");\r\n        setIsProcessing(false);\r\n        return;\r\n      }\r\n      teacherAccountId = teacherAccount.id;\r\n    }\r\n    logger.log(\"선생님 계정 ID:\", teacherAccountId);\r\n\r\n    // --- 낙관적 업데이트 (Optimistic Update) ---\r\n    const originalProducts = {\r\n      deposit: [...userDeposits],\r\n      savings: [...userSavings],\r\n      loan: [...userLoans]\r\n    };\r\n    const originalCash = currentCash;\r\n\r\n    const cashChangeAmount = isLoan ? -balance : balance;\r\n    setCurrentCash(prev => prev + cashChangeAmount);\r\n\r\n    if (type === 'deposit') {\r\n      setUserDeposits(prev => prev.filter(p => p.id !== id));\r\n    } else if (type === 'savings') {\r\n      setUserSavings(prev => prev.filter(p => p.id !== id));\r\n    } else if (type === 'loan') {\r\n      setUserLoans(prev => prev.filter(p => p.id !== id));\r\n    }\r\n\r\n    try {\r\n      const productRef = doc(db, \"users\", userId, \"products\", String(id));\r\n      logger.log(\"Firestore 문서 참조:\", productRef.path);\r\n\r\n      await runTransaction(db, async (transaction) => {\r\n        logger.log(\"트랜잭션 시작\");\r\n        const userRef = doc(db, \"users\", userId);\r\n        const teacherRef = doc(db, \"users\", teacherAccountId);\r\n\r\n        const userSnapshot = await transaction.get(userRef);\r\n        const teacherSnapshot = await transaction.get(teacherRef);\r\n\r\n        if (!userSnapshot.exists()) throw new Error(\"사용자 정보를 찾을 수 없습니다.\");\r\n        if (!teacherSnapshot.exists()) throw new Error(\"선생님(은행) 계정을 찾을 수 없습니다.\");\r\n\r\n        const currentCashInDb = userSnapshot.data()?.cash ?? 0;\r\n        const teacherCashInDb = teacherSnapshot.data()?.cash ?? 0;\r\n        logger.log(`현재 보유 현금 (DB): ${currentCashInDb}, 선생님 보유 현금: ${teacherCashInDb}`);\r\n\r\n        if (isLoan) {\r\n          // 대출 중도 상환: 학생 → 선생님 (원금만)\r\n          if (currentCashInDb < balance) {\r\n            throw new Error(\"대출금을 상환하기에 현금이 부족합니다.\");\r\n          }\r\n          transaction.update(userRef, { cash: increment(-balance) });\r\n          transaction.update(teacherRef, { cash: increment(balance) });\r\n          logger.log(`대출 중도 상환: 학생 -${balance}, 선생님 +${balance}`);\r\n        } else {\r\n          // 예금/적금 중도 해지: 선생님 → 학생 (원금만, 이자 없음)\r\n          if (teacherCashInDb < balance) {\r\n            throw new Error(`은행(선생님)에 지급할 자금이 부족합니다. (필요: ${formatCurrency(balance)}원)`);\r\n          }\r\n          transaction.update(userRef, { cash: increment(balance) });\r\n          transaction.update(teacherRef, { cash: increment(-balance) });\r\n          logger.log(`중도 해지: 학생 +${balance}, 선생님 -${balance}`);\r\n        }\r\n\r\n        transaction.delete(productRef);\r\n        logger.log(\"상품 문서 삭제 예약\");\r\n        logger.log(\"트랜잭션 커밋 시도\");\r\n      });\r\n\r\n      logger.log(\"트랜잭션 성공\");\r\n\r\n      const successMsg = isLoan\r\n        ? `대출 상환 완료: ${formatCurrency(balance)}원 (선생님 계정으로 이체)`\r\n        : `중도 해지 완료: 원금 ${formatCurrency(balance)}원 반환 (선생님 계정에서 지급)`;\r\n      displayMessage(successMsg, \"success\");\r\n\r\n      // 🔥 활동 로그 기록 (중도 해지 / 대출 상환)\r\n      const activityType = isLoan ? ACTIVITY_TYPES.LOAN_REPAY : ACTIVITY_TYPES.DEPOSIT_WITHDRAW;\r\n      logActivity(db, {\r\n        classCode: userDoc?.classCode,\r\n        userId: userId,\r\n        userName: userDoc?.name || '사용자',\r\n        type: activityType,\r\n        description: isLoan\r\n          ? `대출 중도 상환: ${name} (${formatCurrency(balance)}원) - 선생님 계정으로`\r\n          : `중도 해지: ${name} (원금 ${formatCurrency(balance)}원) - 선생님 계정에서`,\r\n        amount: cashChangeAmount,\r\n        metadata: {\r\n          productName: name,\r\n          productType: type,\r\n          principal: balance,\r\n          isEarlyCancellation: true,\r\n          teacherId: teacherAccountId\r\n        }\r\n      });\r\n\r\n      // 백그라운드에서 userDoc 갱신\r\n      if (refreshUserDocument) {\r\n        logger.log(\"userDoc 갱신 시작\");\r\n        refreshUserDocument();\r\n      }\r\n      await loadAllData();\r\n\r\n    } catch (error) {\r\n      logger.error(\"중도 해지 처리 중 오류 발생:\", error);\r\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\r\n\r\n      // --- 낙관적 업데이트 롤백 ---\r\n      setUserDeposits(originalProducts.deposit);\r\n      setUserSavings(originalProducts.savings);\r\n      setUserLoans(originalProducts.loan);\r\n      setCurrentCash(originalCash);\r\n\r\n    } finally {\r\n      setIsProcessing(false);\r\n      logger.log(\"--- handleCancelEarly 종료 ---\");\r\n    }\r\n  };\r\n\r\n  const handleParkingDeposit = async (amountStr) => {\r\n    const amount = parseFloat(amountStr);\r\n    if (isNaN(amount) || amount <= 0) return displayMessage(\"유효한 금액을 입력하세요.\", \"error\");\r\n\r\n    setIsProcessing(true);\r\n    const previousParkingBalance = parkingBalance; // Store for rollback\r\n    const previousCurrentCash = currentCash; // Store for rollback\r\n\r\n    // Optimistically update UI for parking balance\r\n    setParkingBalance(prev => prev + amount);\r\n\r\n    try {\r\n      // 먼저 사용자 현금 차감 (AuthContext의 deductCash 사용)\r\n      const cashDeducted = await deductCash(amount, `파킹통장 입금: ${formatCurrency(amount)}원`);\r\n      if (!cashDeducted) {\r\n        throw new Error(\"보유 현금 차감에 실패했습니다.\");\r\n      }\r\n\r\n      await runTransaction(db, async (transaction) => {\r\n        const parkingRef = doc(db, \"users\", userId, \"financials\", \"parkingAccount\");\r\n        const parkingSnapshot = await transaction.get(parkingRef);\r\n\r\n        if (parkingSnapshot.exists()) {\r\n          transaction.update(parkingRef, { balance: increment(amount) });\r\n        } else {\r\n          transaction.set(parkingRef, { balance: amount, lastInterestDate: serverTimestamp() });\r\n        }\r\n      });\r\n\r\n      displayMessage(`${formatCurrency(amount)}원 입금 완료.`, \"success\");\r\n\r\n      // 🔥 활동 로그 기록 (파킹통장 입금)\r\n      logActivity(db, {\r\n        classCode: userDoc?.classCode,\r\n        userId: userId,\r\n        userName: userDoc?.name || '사용자',\r\n        type: ACTIVITY_TYPES.PARKING_DEPOSIT,\r\n        description: `파킹통장 입금 ${formatCurrency(amount)}원`,\r\n        amount: -amount,\r\n        metadata: { parkingBalance: parkingBalance + amount }\r\n      });\r\n\r\n      await loadAllData(); // Reconcile parkingBalance and other products\r\n    } catch (error) {\r\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\r\n      // Rollback UI on error\r\n      setParkingBalance(previousParkingBalance);\r\n      setCurrentCash(previousCurrentCash);\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  const handleParkingWithdraw = async (amountStr) => {\r\n    const amount = parseFloat(amountStr);\r\n    if (isNaN(amount) || amount <= 0) return displayMessage(\"유효한 금액을 입력하세요.\", \"error\");\r\n\r\n    setIsProcessing(true);\r\n    const previousParkingBalance = parkingBalance; // Store for rollback\r\n    const previousCurrentCash = currentCash; // Store for rollback\r\n\r\n    // Optimistically update UI for parking balance\r\n    setParkingBalance(prev => prev - amount);\r\n\r\n    try {\r\n      await runTransaction(db, async (transaction) => {\r\n        const parkingRef = doc(db, \"users\", userId, \"financials\", \"parkingAccount\");\r\n        const parkingSnapshot = await transaction.get(parkingRef);\r\n        const currentParkingBalance = parkingSnapshot.data()?.balance ?? 0;\r\n\r\n        if (currentParkingBalance < amount) throw new Error(\"파킹통장 잔액이 부족합니다.\");\r\n\r\n        transaction.update(parkingRef, { balance: increment(-amount) });\r\n      });\r\n\r\n      // 사용자 현금 추가 (AuthContext의 addCash 사용)\r\n      const cashAdded = await addCash(amount, `파킹통장 출금: ${formatCurrency(amount)}원`);\r\n      if (!cashAdded) {\r\n        throw new Error(\"보유 현금 추가에 실패했습니다.\");\r\n      }\r\n\r\n      displayMessage(`${formatCurrency(amount)}원 출금 완료.`, \"success\");\r\n\r\n      // 🔥 활동 로그 기록 (파킹통장 출금)\r\n      logActivity(db, {\r\n        classCode: userDoc?.classCode,\r\n        userId: userId,\r\n        userName: userDoc?.name || '사용자',\r\n        type: ACTIVITY_TYPES.PARKING_WITHDRAW,\r\n        description: `파킹통장 출금 ${formatCurrency(amount)}원`,\r\n        amount: amount,\r\n        metadata: { parkingBalance: parkingBalance - amount }\r\n      });\r\n\r\n      await loadAllData(); // Reconcile parkingBalance and other products\r\n    } catch (error) {\r\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\r\n      // Rollback UI on error\r\n      setParkingBalance(previousParkingBalance);\r\n      setCurrentCash(previousCurrentCash);\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  const handleAdminDeleteSubscribedProduct = async (product) => {\r\n    if (!isAdmin()) {\r\n      displayMessage(\"관리자 권한이 필요합니다.\", \"error\");\r\n      return;\r\n    }\r\n\r\n    if (!window.confirm(`정말로 이 상품(${product.name})을 강제로 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`)) {\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    try {\r\n      const productRef = doc(db, \"users\", product.userId, \"products\", product.id);\r\n      await deleteDoc(productRef);\r\n      displayMessage(\"상품이 강제로 삭제되었습니다.\", \"success\");\r\n      loadAllData();\r\n    } catch (error) {\r\n      logger.error(\"관리자 상품 삭제 중 오류:\", error);\r\n      displayMessage(`삭제 처리 오류: ${error.message}`, \"error\");\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  if (loading) return <div className={cls.container}>금융 정보를 불러오는 중입니다...</div>;\r\n  if (!user) return <div className={cls.container}>로그인이 필요합니다.</div>;\r\n\r\n  const mainTabClass = (isActive) => `px-6 py-3 border-none cursor-pointer text-[17px] rounded-t-lg transition-all duration-200 -mb-0.5 ${\r\n    isActive\r\n      ? 'bg-cyber-cyan/10 font-bold text-cyber-cyan border-b-[3px] border-b-cyber-cyan'\r\n      : 'font-medium text-slate-400 border-b-[3px] border-b-transparent'\r\n  }`;\r\n\r\n  return (\r\n    <div className={cls.container}>\r\n      {/* 탭 메뉴 */}\r\n      <div className=\"flex gap-2.5 mb-6 border-b-2 border-white/10 relative\">\r\n        <button\r\n          onClick={() => onViewChange && onViewChange('parking')}\r\n          className={mainTabClass(activeView === 'parking')}\r\n        >\r\n          나의 금융 현황\r\n        </button>\r\n        {isAdmin && isAdmin() && (\r\n          <>\r\n            <button\r\n              onClick={() => onViewChange && onViewChange('admin')}\r\n              className={mainTabClass(activeView === 'admin')}\r\n            >\r\n              상품 관리\r\n            </button>\r\n            <button\r\n              onClick={() => {\r\n                if (onViewChange) onViewChange('userProducts');\r\n                if (onLoadUserProducts) onLoadUserProducts();\r\n              }}\r\n              className={mainTabClass(activeView === 'userProducts')}\r\n            >\r\n              유저 상품 조회\r\n            </button>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {message && <div className={cls.message(messageType)}>{message}</div>}\r\n\r\n      {/* 유저 상품 조회 화면 */}\r\n      {activeView === 'userProducts' && isAdmin && isAdmin() && (\r\n        <div className=\"bg-[rgba(20,20,35,0.6)] rounded-2xl p-8 shadow-[0_6px_20px_rgba(0,0,0,0.3)] border border-white/5\">\r\n          <h2 className=\"text-2xl font-bold mb-4 text-white\">\r\n            유저별 가입 상품 조회 및 관리\r\n          </h2>\r\n          <p className=\"text-sm text-slate-400 mb-5\">\r\n            클래스 내 모든 유저의 가입 상품을 조회하고 필요시 강제 삭제할 수 있습니다.\r\n          </p>\r\n\r\n          {allUserProducts.length === 0 ? (\r\n            <p className=\"text-center p-10 text-slate-400\">\r\n              가입된 상품이 없습니다.\r\n            </p>\r\n          ) : (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full border-collapse\">\r\n                <thead>\r\n                  <tr className=\"bg-white/5 border-b-2 border-white/10\">\r\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">사용자</th>\r\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">상품명</th>\r\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">종류</th>\r\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">잔액/금액</th>\r\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">금리(일)</th>\r\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">기간(일)</th>\r\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">만기일</th>\r\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">관리</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {allUserProducts.map((product, index) => {\r\n                    const typeLabel = product.type === 'deposit' ? '예금' :\r\n                      product.type === 'savings' ? '적금' :\r\n                        product.type === 'loan' ? '대출' : '기타';\r\n                    return (\r\n                      <tr key={`${product.userId}-${product.id}-${index}`} className=\"border-b border-white/5\">\r\n                        <td className=\"p-3 text-sm text-slate-200\">{product.userName}</td>\r\n                        <td className=\"p-3 text-sm text-slate-200\">{product.name}</td>\r\n                        <td className=\"p-3 text-sm text-slate-200\">{typeLabel}</td>\r\n                        <td className=\"p-3 text-sm text-cyber-cyan\">{formatKoreanCurrency(product.balance || 0)}원</td>\r\n                        <td className=\"p-3 text-sm text-slate-200\">{product.rate}%</td>\r\n                        <td className=\"p-3 text-sm text-slate-200\">{product.termInDays}일</td>\r\n                        <td className=\"p-3 text-sm text-slate-200\">\r\n                          {product.maturityDate\r\n                            ? new Date(product.maturityDate).toLocaleDateString('ko-KR')\r\n                            : '-'}\r\n                        </td>\r\n                        <td className=\"p-3\">\r\n                          <button\r\n                            onClick={() => onDeleteUserProduct && onDeleteUserProduct(product)}\r\n                            className={cls.button(false, 'danger') + ' text-xs px-3 py-1.5'}\r\n                          >\r\n                            삭제\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n              <div className=\"mt-5 text-right text-slate-400 text-sm\">\r\n                총 {allUserProducts.length}개의 상품\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* 기존 금융 현황 화면 */}\r\n      {activeView === 'parking' && (\r\n        <div className={cls.grid}>\r\n          <ParkingAccountSection\r\n            balance={parkingBalance}\r\n            dailyInterest={parkingDailyInterest}\r\n            onDeposit={handleParkingDeposit}\r\n            onWithdraw={handleParkingWithdraw}\r\n            isProcessing={isProcessing}\r\n            userCash={currentCash}\r\n          />\r\n          <ProductSection\r\n            title=\"예금\"\r\n            icon={ICON_MAP.deposits}\r\n            subscribedProducts={userDeposits}\r\n            availableProducts={depositProducts}\r\n            onSubscribe={(p) => handleOpenModal(p, 'deposits')}\r\n            onCancel={handleCancelEarly}\r\n            onMaturity={handleMaturity}\r\n            isAdmin={isAdmin()}\r\n            onAdminDelete={handleAdminDeleteSubscribedProduct}\r\n          />\r\n          <ProductSection\r\n            title=\"적금\"\r\n            icon={ICON_MAP.savings}\r\n            subscribedProducts={userSavings}\r\n            availableProducts={installmentProducts}\r\n            onSubscribe={(p) => handleOpenModal(p, 'savings')}\r\n            onCancel={handleCancelEarly}\r\n            onMaturity={handleMaturity}\r\n            isAdmin={isAdmin()}\r\n            onAdminDelete={handleAdminDeleteSubscribedProduct}\r\n          />\r\n          <ProductSection\r\n            title=\"대출\"\r\n            icon={ICON_MAP.loans}\r\n            subscribedProducts={userLoans}\r\n            availableProducts={loanProducts}\r\n            onSubscribe={(p) => handleOpenModal(p, 'loans')}\r\n            onCancel={handleCancelEarly}\r\n            onMaturity={handleMaturity}\r\n            isAdmin={isAdmin()}\r\n            onAdminDelete={handleAdminDeleteSubscribedProduct}\r\n          />\r\n        </div>\r\n      )}\r\n      <SubscriptionModal\r\n        isOpen={modal.isOpen}\r\n        onClose={handleCloseModal}\r\n        product={modal.product}\r\n        onConfirm={handleSubscribe}\r\n        isProcessing={isProcessing}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ParkingAccount;\r\n","// src/Banking.js - Tailwind UI 리팩토링\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { useAuth } from \"../../contexts/AuthContext\";\nimport ParkingAccount from \"./ParkingAccount\";\nimport { getBankingProducts, updateBankingProducts, db } from \"../../firebase\";\nimport {\n  collection,\n  query,\n  where,\n  getDocs,\n  doc,\n  deleteDoc,\n} from \"firebase/firestore\";\nimport { PageContainer, PageHeader } from \"../../components/PageWrapper\";\nimport { Landmark, ChevronLeft } from \"lucide-react\";\nimport { AlchanLoading } from \"../../components/AlchanLayout\";\nimport \"./Banking.css\";\nimport { logger } from \"../../utils/logger\";\n\nconst convertAdminProductsToAccountFormat = (adminProducts) => {\n  if (!Array.isArray(adminProducts)) {\n    logger.error(\n      \"convertAdminProductsToAccountFormat: 입력값이 배열이 아닙니다.\",\n      adminProducts,\n    );\n    return [];\n  }\n  return adminProducts.map((product) => ({\n    id: product.id,\n    name: product.name,\n    dailyRate:\n      product.dailyRate !== undefined && !isNaN(product.dailyRate)\n        ? parseFloat(product.dailyRate)\n        : 0,\n    termInDays:\n      product.termInDays !== undefined && !isNaN(product.termInDays)\n        ? parseInt(product.termInDays)\n        : 1,\n    minAmount:\n      product.minAmount !== undefined && !isNaN(product.minAmount)\n        ? parseInt(product.minAmount)\n        : 0,\n    maxAmount:\n      product.maxAmount !== undefined && !isNaN(product.maxAmount)\n        ? parseInt(product.maxAmount)\n        : 0,\n  }));\n};\n\nconst Banking = () => {\n  const auth = useAuth();\n  const [message, setMessage] = useState(null);\n  const [messageType, setMessageType] = useState(\"\");\n  const [activeView, setActiveView] = useState(\"parking\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  const [parkingDepositProducts, setParkingDepositProducts] = useState([]);\n  const [parkingInstallmentProducts, setParkingInstallmentProducts] = useState(\n    [],\n  );\n  const [parkingLoanProducts, setParkingLoanProducts] = useState([]);\n\n  // 유저별 가입 상품 관리\n  const [allUserProducts, setAllUserProducts] = useState([]);\n\n  // 모든 유저의 가입 상품 로드\n  const loadAllUserProducts = async () => {\n    if (\n      !auth?.userDoc?.classCode ||\n      !(auth.userDoc?.isAdmin || auth.userDoc?.role === \"admin\")\n    ) {\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      // 먼저 해당 클래스의 모든 유저 조회\n      const usersQuery = query(\n        collection(db, \"users\"),\n        where(\"classCode\", \"==\", auth.userDoc.classCode),\n      );\n      const usersSnapshot = await getDocs(usersQuery);\n\n      const userMap = {};\n      usersSnapshot.forEach((doc) => {\n        userMap[doc.id] = {\n          id: doc.id,\n          name: doc.data().name || doc.data().nickname || \"알 수 없음\",\n          ...doc.data(),\n        };\n      });\n\n      // 🔥 [최적화] 각 유저의 상품 조회 - 병렬 처리로 N+1 문제 해결\n      const allProducts = [];\n      const userIds = Object.keys(userMap);\n\n      // 모든 유저의 products를 병렬로 조회 (순차 대신 Promise.all 사용)\n      const productPromises = userIds.map(async (userId) => {\n        const productsQuery = collection(db, \"users\", userId, \"products\");\n        const productsSnapshot = await getDocs(productsQuery);\n\n        return productsSnapshot.docs.map((productDoc) => {\n          const productData = productDoc.data();\n          return {\n            firestoreId: productDoc.id, // 실제 Firestore 문서 ID\n            userId: userId,\n            userName: userMap[userId].name,\n            ...productData,\n            maturityDate: productData.maturityDate?.toDate\n              ? productData.maturityDate.toDate()\n              : productData.maturityDate,\n          };\n        });\n      });\n\n      // 모든 Promise가 완료될 때까지 대기\n      const productsArrays = await Promise.all(productPromises);\n\n      // 2D 배열을 1D 배열로 평탄화\n      productsArrays.forEach((productsArray) => {\n        allProducts.push(...productsArray);\n      });\n\n      setAllUserProducts(allProducts);\n      logger.log(\"유저 상품 로드 완료:\", allProducts);\n    } catch (error) {\n      logger.error(\"유저 상품 로드 중 오류:\", error);\n      setMessage(\"유저 상품 로드 중 오류가 발생했습니다.\");\n      setMessageType(\"error\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // 관리자가 유저 상품 강제 삭제\n  const handleAdminDeleteUserProduct = async (product) => {\n    logger.log(\"삭제 시도:\", product);\n\n    if (!(auth.userDoc?.isAdmin || auth.userDoc?.role === \"admin\")) {\n      logger.log(\"관리자 권한 없음\");\n      alert(\"관리자 권한이 필요합니다.\");\n      return;\n    }\n\n    if (\n      !window.confirm(\n        `'${product.userName}'님의 '${product.name}' 상품을 강제로 삭제하시겠습니까?\\n이 작업은 되돌릴 수 없습니다.`,\n      )\n    ) {\n      logger.log(\"사용자가 삭제 취소\");\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      // firestoreId를 사용 (실제 Firestore 문서 ID)\n      const productId = product.firestoreId || String(product.id);\n      logger.log(\"삭제 경로:\", `users/${product.userId}/products/${productId}`);\n      logger.log(\"사용할 문서 ID:\", productId);\n\n      const productRef = doc(\n        db,\n        \"users\",\n        product.userId,\n        \"products\",\n        productId,\n      );\n      logger.log(\"삭제 시작...\");\n      await deleteDoc(productRef);\n      logger.log(\"삭제 완료\");\n\n      setMessage(\"상품이 삭제되었습니다.\");\n      setMessageType(\"success\");\n\n      // 목록 새로고침\n      logger.log(\"목록 새로고침 시작...\");\n      await loadAllUserProducts();\n      logger.log(\"목록 새로고침 완료\");\n\n      setTimeout(() => {\n        setMessage(null);\n        setMessageType(\"\");\n      }, 3000);\n    } catch (error) {\n      logger.error(\"상품 삭제 중 오류:\", error);\n      setMessage(`삭제 중 오류가 발생했습니다: ${error.message}`);\n      setMessageType(\"error\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const formattedDepositProducts = useMemo(\n    () => convertAdminProductsToAccountFormat(parkingDepositProducts),\n    [parkingDepositProducts],\n  );\n  const formattedInstallmentProducts = useMemo(\n    () => convertAdminProductsToAccountFormat(parkingInstallmentProducts),\n    [parkingInstallmentProducts],\n  );\n  const formattedLoanProducts = useMemo(\n    () => convertAdminProductsToAccountFormat(parkingLoanProducts),\n    [parkingLoanProducts],\n  );\n\n  // Firestore에서 데이터 로드\n  const loadAllData = async () => {\n    const classCode = auth?.userDoc?.classCode;\n    if (!classCode || classCode === \"미지정\") {\n      logger.warn(\n        \"[Banking] 유효한 학급 코드가 없어 뱅킹 상품을 로드하지 않습니다.\",\n      );\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const bankingData = await getBankingProducts(classCode, true, \"Banking\");\n\n      // deposits를 savings로 매핑 (예금 상품)\n      if (bankingData.deposits) {\n        setParkingDepositProducts(bankingData.deposits);\n      } else {\n        setParkingDepositProducts([]);\n      }\n\n      // savings를 installments로 매핑 (적금 상품)\n      if (bankingData.savings) {\n        setParkingInstallmentProducts(bankingData.savings);\n      } else {\n        setParkingInstallmentProducts([]);\n      }\n\n      // loans는 그대로 매핑 (대출 상품)\n      if (bankingData.loans) {\n        setParkingLoanProducts(bankingData.loans);\n      } else {\n        setParkingLoanProducts([]);\n      }\n    } catch (error) {\n      logger.error(\"뱅킹 상품 로드 중 오류:\", error);\n      setMessage(\"데이터 로딩 중 오류가 발생했습니다.\");\n      setMessageType(\"error\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (auth && !auth.loading && auth.user && auth.userDoc?.classCode) {\n      loadAllData();\n    } else if (auth && !auth.loading && !auth.user) {\n      setParkingDepositProducts([]);\n      setParkingInstallmentProducts([]);\n      setParkingLoanProducts([]);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [auth?.user, auth?.loading, auth?.userDoc?.classCode]); // loadAllData 추가하면 무한루프, auth 객체 전체 추가도 불필요한 리렌더링 발생\n\n  const handleParkingProductChange = (type, index, field, value) => {\n    let productsState, setProductsState;\n    switch (type) {\n      case \"deposits\":\n        productsState = parkingDepositProducts;\n        setProductsState = setParkingDepositProducts;\n        break;\n      case \"installments\":\n        productsState = parkingInstallmentProducts;\n        setProductsState = setParkingInstallmentProducts;\n        break;\n      case \"loans\":\n        productsState = parkingLoanProducts;\n        setProductsState = setParkingLoanProducts;\n        break;\n      default:\n        return;\n    }\n\n    const updatedProducts = productsState.map((product, i) => {\n      if (i === index) {\n        const updatedProduct = { ...product };\n        if (\n          field === \"termInDays\" ||\n          field === \"minAmount\" ||\n          field === \"maxAmount\"\n        ) {\n          const numValue = parseInt(value);\n          updatedProduct[field] =\n            isNaN(numValue) || numValue < (field === \"termInDays\" ? 1 : 0)\n              ? field === \"termInDays\"\n                ? 1\n                : 0\n              : numValue;\n        } else if (field === \"dailyRate\") {\n          const dailyRateValue = parseFloat(value);\n          updatedProduct.dailyRate =\n            isNaN(dailyRateValue) || dailyRateValue < 0 ? 0 : dailyRateValue;\n        } else if (field === \"name\") {\n          updatedProduct[field] = value;\n        }\n        return updatedProduct;\n      }\n      return product;\n    });\n    setProductsState(updatedProducts);\n  };\n\n  const saveParkingProducts = async (type) => {\n    if (!auth?.userDoc?.classCode) {\n      setMessage(\"학급 코드가 없어 저장할 수 없습니다.\");\n      setMessageType(\"error\");\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      let products, firestoreType;\n\n      switch (type) {\n        case \"deposits\":\n          products = parkingDepositProducts;\n          firestoreType = \"deposits\"; // Firebase에서는 deposits로 저장\n          break;\n        case \"installments\":\n          products = parkingInstallmentProducts;\n          firestoreType = \"savings\"; // Firebase에서는 savings로 저장\n          break;\n        case \"loans\":\n          products = parkingLoanProducts;\n          firestoreType = \"loans\";\n          break;\n        default:\n          return;\n      }\n\n      await updateBankingProducts(\n        auth.userDoc.classCode,\n        firestoreType,\n        products,\n      );\n\n      setMessage(\n        `${\n          type === \"deposits\"\n            ? \"예금\"\n            : type === \"installments\"\n              ? \"적금\"\n              : \"대출\"\n        } 상품이 성공적으로 저장되었습니다.`,\n      );\n      setMessageType(\"success\");\n\n      setTimeout(() => {\n        setMessage(null);\n        setMessageType(\"\");\n      }, 3000);\n    } catch (error) {\n      logger.error(`${type} 상품 저장 중 오류:`, error);\n      setMessage(\"저장 중 오류가 발생했습니다.\");\n      setMessageType(\"error\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const addParkingProduct = (type) => {\n    const newProduct = {\n      id: Date.now(),\n      name: `새 ${\n        type === \"deposits\" ? \"예금\" : type === \"installments\" ? \"적금\" : \"대출\"\n      } 상품`,\n      dailyRate: 0.01,\n      termInDays: 365,\n      minAmount: type === \"loans\" ? 0 : 100000,\n      maxAmount: type === \"loans\" ? 1000000 : 0,\n    };\n\n    switch (type) {\n      case \"deposits\":\n        setParkingDepositProducts([...parkingDepositProducts, newProduct]);\n        break;\n      case \"installments\":\n        setParkingInstallmentProducts([\n          ...parkingInstallmentProducts,\n          newProduct,\n        ]);\n        break;\n      case \"loans\":\n        setParkingLoanProducts([...parkingLoanProducts, newProduct]);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const deleteParkingProduct = async (type, indexToDelete) => {\n    if (isLoading) return; // 중복 클릭 방지\n\n    let productsState, setProductsState;\n    switch (type) {\n      case \"deposits\":\n        productsState = parkingDepositProducts;\n        setProductsState = setParkingDepositProducts;\n        break;\n      case \"installments\":\n        productsState = parkingInstallmentProducts;\n        setProductsState = setParkingInstallmentProducts;\n        break;\n      case \"loans\":\n        productsState = parkingLoanProducts;\n        setProductsState = setParkingLoanProducts;\n        break;\n      default:\n        return;\n    }\n\n    const updatedProducts = productsState.filter(\n      (_, index) => index !== indexToDelete,\n    );\n    setProductsState(updatedProducts);\n\n    // 삭제 후 자동 저장\n    if (auth?.userDoc?.classCode) {\n      setIsLoading(true);\n      try {\n        const firestoreType =\n          type === \"deposits\"\n            ? \"deposits\"\n            : type === \"installments\"\n              ? \"savings\"\n              : \"loans\";\n        await updateBankingProducts(\n          auth.userDoc.classCode,\n          firestoreType,\n          updatedProducts,\n        );\n        setMessage(\"상품이 삭제되었습니다.\");\n        setMessageType(\"info\");\n        setTimeout(() => {\n          setMessage(null);\n          setMessageType(\"\");\n        }, 2000);\n      } catch (error) {\n        logger.error(\"상품 삭제 중 오류:\", error);\n        setMessage(\"삭제 중 오류가 발생했습니다.\");\n        setMessageType(\"error\");\n        // 삭제 실패 시 원래 상태로 되돌릴 수 있습니다 (선택적)\n        setProductsState(productsState);\n      } finally {\n        setIsLoading(false);\n      }\n    }\n  };\n\n  if (auth.loading) {\n    return <AlchanLoading />;\n  }\n\n  return (\n    <PageContainer>\n      {/* 로딩 오버레이 */}\n      {isLoading && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n          <AlchanLoading />\n        </div>\n      )}\n\n      <div className=\"px-4 py-6 sm:px-6\">\n        {/* 페이지 헤더 */}\n        <PageHeader\n          title=\"통합 금융 관리\"\n          subtitle=\"예금, 적금, 대출 상품을 관리하세요\"\n          icon={Landmark}\n        />\n\n        {/* 메시지 표시 */}\n        {message && (\n          <div\n            className={`mb-4 p-4 rounded-xl ${\n              messageType === \"error\"\n                ? \"bg-red-900/40 text-red-200 border border-red-800/50\"\n                : messageType === \"success\"\n                  ? \"bg-emerald-900/40 text-emerald-200 border border-emerald-800/50\"\n                  : \"bg-blue-900/40 text-blue-200 border border-blue-800/50\"\n            }`}\n          >\n            {message}\n          </div>\n        )}\n\n        <div className={activeView === \"admin\" ? \"content-box\" : \"\"}>\n          {(activeView === \"parking\" || activeView === \"userProducts\") && (\n            <ParkingAccount\n              auth={auth}\n              depositProducts={formattedDepositProducts}\n              installmentProducts={formattedInstallmentProducts}\n              loanProducts={formattedLoanProducts}\n              activeView={activeView}\n              onViewChange={setActiveView}\n              onLoadUserProducts={loadAllUserProducts}\n              allUserProducts={allUserProducts}\n              onDeleteUserProduct={handleAdminDeleteUserProduct}\n              isLoading={isLoading}\n            />\n          )}\n          {activeView === \"admin\" &&\n            auth.user &&\n            (auth.userDoc?.isAdmin || auth.userDoc?.role === \"admin\") && (\n              <div>\n                <div className=\"flex items-center gap-4 mb-4\">\n                  <button\n                    onClick={() => setActiveView(\"parking\")}\n                    className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-cyber-cyan/10 border border-cyber-cyan/40 text-cyber-cyan hover:bg-cyber-cyan/20 hover:text-white transition-all text-sm font-semibold shadow-[0_0_8px_rgba(0,243,255,0.15)]\"\n                  >\n                    <ChevronLeft size={16} />\n                    은행으로 돌아가기\n                  </button>\n                </div>\n                <h2 className=\"admin-header\">\n                  관리자 - 금융 상품 관리 (일 복리 기준)\n                </h2>\n                {/* Savings Products */}\n                <div className=\"admin-section\">\n                  <h3>파킹 예금 상품</h3>\n                  <p className=\"admin-info-text\">\n                    일 이율(%)과 기간(일)을 입력합니다. 변경 후 '저장' 버튼을\n                    클릭하세요.\n                  </p>\n                  <table className=\"admin-table\">\n                    <thead>\n                      <tr>\n                        <th style={{ width: \"25%\" }}>상품명</th>\n                        <th style={{ width: \"15%\" }}>기간(일)</th>\n                        <th style={{ width: \"18%\" }}>일 이율(%)</th>\n                        <th style={{ width: \"18%\" }}>최소금액(원)</th>\n                        <th style={{ width: \"12%\" }}>관리</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {parkingDepositProducts.map((p, index) => (\n                        <tr key={p.id}>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"text\"\n                              value={p.name || \"\"}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"deposits\",\n                                  index,\n                                  \"name\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"1\"\n                              value={p.termInDays || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"deposits\",\n                                  index,\n                                  \"termInDays\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              step=\"0.001\"\n                              min=\"0\"\n                              value={p.dailyRate || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"deposits\",\n                                  index,\n                                  \"dailyRate\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              placeholder=\"예: 0.01\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"0\"\n                              value={p.minAmount || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"deposits\",\n                                  index,\n                                  \"minAmount\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <button\n                              onClick={() =>\n                                deleteParkingProduct(\"deposits\", index)\n                              }\n                              className={`admin-button-small delete-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                              disabled={isLoading}\n                            >\n                              삭제\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                  <div className=\"admin-action-buttons\">\n                    <button\n                      onClick={() => addParkingProduct(\"deposits\")}\n                      className={`admin-button-small add-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      추가\n                    </button>\n                    <button\n                      onClick={() => saveParkingProducts(\"deposits\")}\n                      className={`admin-button-small save-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      예금 상품 저장\n                    </button>\n                  </div>\n                </div>\n\n                {/* Installment Products */}\n                <div className=\"admin-section\">\n                  <h3>파킹 적금 상품</h3>\n                  <p className=\"admin-info-text\">\n                    일 이율(%)과 기간(일)을 입력합니다. 변경 후 '저장' 버튼을\n                    클릭하세요.\n                  </p>\n                  <table className=\"admin-table\">\n                    <thead>\n                      <tr>\n                        <th style={{ width: \"25%\" }}>상품명</th>\n                        <th style={{ width: \"15%\" }}>기간(일)</th>\n                        <th style={{ width: \"18%\" }}>일 이율(%)</th>\n                        <th style={{ width: \"18%\" }}>최소 월납입(원)</th>\n                        <th style={{ width: \"12%\" }}>관리</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {parkingInstallmentProducts.map((p, index) => (\n                        <tr key={p.id}>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"text\"\n                              value={p.name || \"\"}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"installments\",\n                                  index,\n                                  \"name\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"1\"\n                              value={p.termInDays || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"installments\",\n                                  index,\n                                  \"termInDays\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              step=\"0.001\"\n                              min=\"0\"\n                              value={p.dailyRate || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"installments\",\n                                  index,\n                                  \"dailyRate\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              placeholder=\"예: 0.011\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"0\"\n                              value={p.minAmount || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"installments\",\n                                  index,\n                                  \"minAmount\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <button\n                              onClick={() =>\n                                deleteParkingProduct(\"installments\", index)\n                              }\n                              className={`admin-button-small delete-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                              disabled={isLoading}\n                            >\n                              삭제\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                  <div className=\"admin-action-buttons\">\n                    <button\n                      onClick={() => addParkingProduct(\"installments\")}\n                      className={`admin-button-small add-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      추가\n                    </button>\n                    <button\n                      onClick={() => saveParkingProducts(\"installments\")}\n                      className={`admin-button-small save-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      적금 상품 저장\n                    </button>\n                  </div>\n                </div>\n\n                {/* Loan Products */}\n                <div className=\"admin-section\" style={{ borderBottom: \"none\" }}>\n                  <h3>파킹 대출 상품</h3>\n                  <p className=\"admin-info-text\">\n                    일 이율(%)과 기간(일)을 입력합니다. 변경 후 '저장' 버튼을\n                    클릭하세요.\n                  </p>\n                  <table className=\"admin-table\">\n                    <thead>\n                      <tr>\n                        <th style={{ width: \"25%\" }}>상품명</th>\n                        <th style={{ width: \"15%\" }}>기간(일)</th>\n                        <th style={{ width: \"18%\" }}>일 이율(%)</th>\n                        <th style={{ width: \"18%\" }}>최대 대출액(원)</th>\n                        <th style={{ width: \"12%\" }}>관리</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {parkingLoanProducts.map((p, index) => (\n                        <tr key={p.id}>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"text\"\n                              value={p.name || \"\"}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"loans\",\n                                  index,\n                                  \"name\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"1\"\n                              value={p.termInDays || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"loans\",\n                                  index,\n                                  \"termInDays\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              step=\"0.001\"\n                              min=\"0\"\n                              value={p.dailyRate || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"loans\",\n                                  index,\n                                  \"dailyRate\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              placeholder=\"예: 0.05\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"0\"\n                              value={p.maxAmount || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"loans\",\n                                  index,\n                                  \"maxAmount\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <button\n                              onClick={() =>\n                                deleteParkingProduct(\"loans\", index)\n                              }\n                              className={`admin-button-small delete-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                              disabled={isLoading}\n                            >\n                              삭제\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                  <div className=\"admin-action-buttons\">\n                    <button\n                      onClick={() => addParkingProduct(\"loans\")}\n                      className={`admin-button-small add-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      추가\n                    </button>\n                    <button\n                      onClick={() => saveParkingProducts(\"loans\")}\n                      className={`admin-button-small save-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      대출 상품 저장\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n          {activeView === \"admin\" &&\n            !(\n              auth.user &&\n              (auth.userDoc?.isAdmin || auth.userDoc?.role === \"admin\")\n            ) && (\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300 p-4 rounded-xl border border-yellow-200 dark:border-yellow-800\">\n                관리자 권한이 필요합니다.\n              </div>\n            )}\n        </div>\n      </div>\n    </PageContainer>\n  );\n};\n\nexport default Banking;\n"],"names":["PageContainer","_ref","children","className","_jsx","concat","PageHeader","_ref2","title","subtitle","icon","Icon","badge","action","backButton","_jsxs","LoadingState","_ref4","message","EmptyState","_ref6","description","ActionButton","_ref1","variant","size","loading","disabled","onClick","primary","secondary","outline","danger","success","ghost","indigo","sm","md","lg","Loader2","getTeacherAccount","async","classCode","usersRef","collection","db","q","query","where","limit","snapshot","getDocs","empty","teacherDoc","docs","_objectSpread","id","data","error","logger","cls","type","isActive","arguments","length","undefined","formatCurrency","amount","Math","round","toLocaleString","calculateCompoundInterest","principal","dailyRate","days","interest","total","pow","calculateDailyInterest","ICON_MAP","parking","Wallet","deposits","Landmark","savings","PiggyBank","loans","HandCoins","SubscribedProductItem","product","onCancel","onMaturity","isMatured","maturityDate","Date","daysRemaining","max","differenceInDays","rate","balance","termInDays","dailyInterestAmount","name","_Fragment","format","AvailableProductItem","onSubscribe","projectedInterest","TrendingUp","ProductSection","_ref3","subscribedProducts","availableProducts","activeTab","setActiveTab","useState","map","p","SubscriptionModal","isOpen","onClose","onConfirm","isProcessing","setAmount","numAmount","parseFloat","projectedTotal","isNaN","e","stopPropagation","X","value","onChange","target","placeholder","minAmount","autoFocus","ParkingAccountSection","_ref5","dailyInterest","onDeposit","onWithdraw","userCash","auth","depositProducts","installmentProducts","loanProducts","activeView","onViewChange","onLoadUserProducts","allUserProducts","onDeleteUserProduct","user","userDoc","refreshUserDocument","isAdmin","addCash","deductCash","userId","uid","setIsProcessing","setMessage","messageType","setMessageType","parkingBalance","setParkingBalance","parkingDailyInterest","setParkingDailyInterest","userDeposits","setUserDeposits","userSavings","setUserSavings","userLoans","setUserLoans","modal","setModal","currentCash","setCurrentCash","cash","displayMessage","text","duration","setTimeout","loadAllData","useCallback","parkingRef","doc","parkingRateProduct","parkingDoc","getDoc","exists","_data$lastInterestDat","lastInterestDate","toDate","isToday","daysToApply","updateDoc","increment","serverTimestamp","setDoc","finalParkingDoc","productsRef","forEach","docSnap","_docSnap$data$maturit","push","useEffect","log","handleOpenModal","handleCloseModal","handleMaturity","teacherId","isLoan","confirmMsg","window","confirm","teacherAccountId","teacherAccount","productRef","String","path","runTransaction","_userSnapshot$data$ca2","_userSnapshot$data2","_teacherSnapshot$data3","_teacherSnapshot$data4","userRef","teacherRef","userSnapshot","transaction","get","teacherSnapshot","Error","currentCashInDb","teacherCashInDb","update","delete","successMsg","activityType","ACTIVITY_TYPES","LOAN_REPAY","DEPOSIT_MATURITY","logActivity","userName","metadata","productName","productType","then","handleCancelEarly","confirmMessage","originalProducts","deposit","loan","originalCash","cashChangeAmount","prev","filter","_userSnapshot$data$ca3","_userSnapshot$data3","_teacherSnapshot$data5","_teacherSnapshot$data6","DEPOSIT_WITHDRAW","isEarlyCancellation","handleAdminDeleteSubscribedProduct","deleteDoc","mainTabClass","index","typeLabel","formatKoreanCurrency","toLocaleDateString","amountStr","previousParkingBalance","previousCurrentCash","set","PARKING_DEPOSIT","_parkingSnapshot$data","_parkingSnapshot$data2","PARKING_WITHDRAW","onAdminDelete","subscribeAmount","maxAmount","tempId","now","optimisticProduct","startDate","isOptimistic","_userSnapshot$data$ca","_userSnapshot$data","_teacherSnapshot$data","_teacherSnapshot$data2","newProductData","teacherName","newProductRef","actionText","DEPOSIT_CREATE","LOAN_CREATE","toISOString","convertAdminProductsToAccountFormat","adminProducts","Array","isArray","parseInt","Banking","_auth$userDoc8","_auth$userDoc1","_auth$userDoc10","_auth$userDoc11","_auth$userDoc12","useAuth","setActiveView","isLoading","setIsLoading","parkingDepositProducts","setParkingDepositProducts","parkingInstallmentProducts","setParkingInstallmentProducts","parkingLoanProducts","setParkingLoanProducts","setAllUserProducts","loadAllUserProducts","_auth$userDoc","_auth$userDoc2","_auth$userDoc3","role","usersQuery","usersSnapshot","userMap","nickname","allProducts","productPromises","Object","keys","productsQuery","productDoc","_productData$maturity","productData","firestoreId","Promise","all","productsArray","formattedDepositProducts","useMemo","formattedInstallmentProducts","formattedLoanProducts","_auth$userDoc7","_auth$userDoc6","bankingData","getBankingProducts","warn","handleParkingProductChange","field","productsState","setProductsState","i","updatedProduct","numValue","dailyRateValue","saveParkingProducts","_auth$userDoc9","products","firestoreType","updateBankingProducts","addParkingProduct","newProduct","deleteParkingProduct","indexToDelete","_auth$userDoc0","updatedProducts","_","AlchanLoading","ParkingAccount","_auth$userDoc4","_auth$userDoc5","alert","productId","ChevronLeft","style","width","backgroundColor","color","border","min","step","borderBottom"],"ignoreList":[],"sourceRoot":""}