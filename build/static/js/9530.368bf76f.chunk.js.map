{"version":3,"file":"static/js/9530.368bf76f.chunk.js","mappings":"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","sources":["components/PageWrapper.js","pages/banking/ParkingAccount.js","pages/banking/Banking.js"],"sourcesContent":["// src/components/PageWrapper.js\n// 페이지 공통 래퍼 - 새로운 슬레이트 기반 디자인 시스템\n\nimport React from \"react\";\nimport { Loader2, CheckSquare } from \"lucide-react\";\nimport { AlchanLoadingScreen } from \"./ui/Skeleton\";\n\n// ============================================\n// 페이지 컨테이너\n// ============================================\nexport const PageContainer = ({ children, className = \"\" }) => (\n  <div className={`min-h-full w-full bg-[#0a0a12] ${className}`}>\n    <div className=\"w-full max-w-none px-2 md:px-3 lg:px-4 py-1 md:py-2\">\n      {children}\n    </div>\n  </div>\n);\n\n// ============================================\n// 페이지 헤더 - 새로운 디자인\n// ============================================\nexport const PageHeader = ({\n  title,\n  subtitle,\n  icon: Icon,\n  badge,\n  action,\n  backButton,\n  className = \"\",\n}) => (\n  <section\n    className={`bg-[#14142380] backdrop-blur-sm rounded-lg px-3 py-1.5 md:px-4 md:py-2 shadow-lg border border-cyan-900/30 flex flex-col md:flex-row md:items-center justify-between gap-1.5 md:gap-2 mb-2 md:mb-3 ${className}`}\n  >\n    <div className=\"flex items-center gap-3\">\n      {backButton}\n      {Icon && (\n        <div className=\"w-9 h-9 md:w-10 md:h-10 bg-cyan-900/30 rounded-lg flex items-center justify-center text-cyan-400 shrink-0 shadow-sm border border-cyan-500/30\">\n          <Icon className=\"w-5 h-5\" />\n        </div>\n      )}\n      <div>\n        <div className=\"flex items-center gap-2\">\n          <h2 className=\"text-lg md:text-xl font-bold text-white tracking-tight\">\n            {title}\n          </h2>\n          {badge}\n        </div>\n        {subtitle && (\n          <p className=\"text-xs md:text-sm text-slate-400 font-medium\">\n            {subtitle}\n          </p>\n        )}\n      </div>\n    </div>\n    {action && (\n      <div className=\"flex flex-wrap items-center gap-2 md:gap-3 md:ml-auto\">\n        {action}\n      </div>\n    )}\n  </section>\n);\n\n// ============================================\n// 섹션 제목\n// ============================================\nexport const SectionTitle = ({\n  children,\n  icon: Icon,\n  action,\n  className = \"\",\n}) => (\n  <div className={`flex items-center justify-between px-1 mb-4 ${className}`}>\n    <h3 className=\"text-lg md:text-xl font-bold text-white flex items-center gap-2\">\n      {Icon && <Icon className=\"w-5 h-5 text-cyan-400\" />}\n      {children}\n    </h3>\n    {action}\n  </div>\n);\n\n// ============================================\n// 로딩 상태 - null (HTML 스플래시만 사용)\n// ============================================\nexport const LoadingState = ({ message = \"데이터를 불러오는 중...\" }) => null;\n\n// ============================================\n// 에러 상태\n// ============================================\nexport const ErrorState = ({\n  title = \"오류가 발생했습니다\",\n  message,\n  onRetry,\n}) => (\n  <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n    <div className=\"w-16 h-16 bg-red-900/30 rounded-full flex items-center justify-center mb-4\">\n      <span className=\"text-3xl text-red-400\">!</span>\n    </div>\n    <h3 className=\"text-lg font-semibold text-white mb-2\">{title}</h3>\n    {message && <p className=\"text-slate-400 mb-4 max-w-md\">{message}</p>}\n    {onRetry && (\n      <button\n        onClick={onRetry}\n        className=\"px-5 py-2.5 bg-cyan-500 hover:bg-cyan-400 text-slate-900 rounded-xl font-bold text-sm transition-all shadow-lg shadow-cyan-500/30\"\n      >\n        다시 시도\n      </button>\n    )}\n  </div>\n);\n\n// ============================================\n// 빈 상태\n// ============================================\nexport const EmptyState = ({ icon: Icon, title, description, action }) => (\n  <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n    {Icon && (\n      <div className=\"w-16 h-16 rounded-full bg-[#14142380] shadow-lg flex items-center justify-center mb-4 border border-cyan-900/30\">\n        <Icon className=\"w-8 h-8 text-slate-400\" />\n      </div>\n    )}\n    {title && (\n      <h3 className=\"text-lg font-bold text-slate-300 mb-2\">{title}</h3>\n    )}\n    {description && (\n      <p className=\"text-slate-400 font-medium mb-6 max-w-md\">{description}</p>\n    )}\n    {action}\n  </div>\n);\n\n// ============================================\n// 카드 그리드\n// ============================================\nexport const CardGrid = ({ children, cols = 3, className = \"\" }) => {\n  const colsClass = {\n    1: \"grid-cols-1\",\n    2: \"grid-cols-1 md:grid-cols-2\",\n    3: \"grid-cols-1 md:grid-cols-2 xl:grid-cols-3\",\n    4: \"grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4\",\n  };\n\n  return (\n    <div\n      className={`grid ${colsClass[cols] || colsClass[3]} gap-6 ${className}`}\n    >\n      {children}\n    </div>\n  );\n};\n\n// ============================================\n// 통계 카드 - 새로운 디자인\n// ============================================\nexport const StatCard = ({\n  icon: Icon,\n  label,\n  value,\n  subValue,\n  trend,\n  iconBg = \"bg-cyan-900/30\",\n  iconColor = \"text-cyan-400\",\n  onClick,\n}) => (\n  <div\n    className={`bg-[#14142380] backdrop-blur-sm rounded-2xl p-6 border border-cyan-900/30 shadow-lg hover:shadow-xl hover:shadow-cyan-500/10 transition-all duration-300 ${\n      onClick ? \"cursor-pointer\" : \"\"\n    }`}\n    onClick={onClick}\n  >\n    <div className=\"flex items-start justify-between\">\n      <div\n        className={`w-12 h-12 rounded-xl flex items-center justify-center shadow-sm ${iconBg}`}\n      >\n        <Icon className={`w-6 h-6 ${iconColor}`} />\n      </div>\n      {trend && (\n        <span\n          className={`text-xs font-bold px-2.5 py-1 rounded-lg ${\n            trend.type === \"up\"\n              ? \"bg-emerald-900/30 text-emerald-400\"\n              : \"bg-red-900/30 text-red-400\"\n          }`}\n        >\n          {trend.type === \"up\" ? \"+\" : \"-\"}\n          {trend.value}%\n        </span>\n      )}\n    </div>\n    <div className=\"mt-4\">\n      <p className=\"text-sm text-slate-400 font-medium\">{label}</p>\n      <p className=\"text-2xl font-bold text-white mt-1 tracking-tight\">\n        {value}\n      </p>\n      {subValue && <p className=\"text-sm text-slate-500 mt-1\">{subValue}</p>}\n    </div>\n  </div>\n);\n\n// ============================================\n// 자산 카드 - 헤더용\n// ============================================\nexport const AssetCard = ({ icon: Icon, label, value, color, iconColor }) => (\n  <div\n    className={`hidden lg:flex items-center gap-3 px-3 py-1.5 rounded-xl ${color} bg-opacity-50 border border-transparent`}\n  >\n    <div\n      className={`w-10 h-10 rounded-xl flex items-center justify-center shadow-sm ${iconColor}`}\n    >\n      <Icon className=\"w-5 h-5\" />\n    </div>\n    <div>\n      <p className=\"text-[10px] font-bold opacity-70 mb-0 leading-tight\">\n        {label}\n      </p>\n      <p className=\"text-lg font-black tracking-tight leading-tight\">{value}</p>\n    </div>\n  </div>\n);\n\n// ============================================\n// 탭 컴포넌트\n// ============================================\nexport const TabGroup = ({ tabs, activeTab, onChange, className = \"\" }) => (\n  <div\n    className={`flex gap-1 p-1 bg-[#0a0a12] rounded-xl border border-cyan-900/30 ${className}`}\n  >\n    {tabs.map((tab) => (\n      <button\n        key={tab.id}\n        onClick={() => onChange(tab.id)}\n        className={`flex-1 px-4 py-2.5 text-sm font-bold rounded-lg transition-all duration-200 ${\n          activeTab === tab.id\n            ? \"bg-cyan-500 text-slate-900 shadow-lg shadow-cyan-500/30\"\n            : \"text-slate-400 hover:text-white hover:bg-white/5\"\n        }`}\n      >\n        {tab.icon && <tab.icon className=\"w-4 h-4 mr-2 inline-block\" />}\n        {tab.label}\n        {tab.count !== undefined && (\n          <span\n            className={`ml-2 px-1.5 py-0.5 text-xs rounded-full ${\n              activeTab === tab.id\n                ? \"bg-slate-900 text-cyan-400\"\n                : \"bg-slate-800 text-slate-400\"\n            }`}\n          >\n            {tab.count}\n          </span>\n        )}\n      </button>\n    ))}\n  </div>\n);\n\n// ============================================\n// 액션 버튼 - 새로운 디자인\n// ============================================\nexport const ActionButton = ({\n  children,\n  icon: Icon,\n  variant = \"primary\",\n  size = \"md\",\n  loading = false,\n  disabled = false,\n  onClick,\n  className = \"\",\n  title,\n}) => {\n  const variants = {\n    primary:\n      \"bg-cyan-500 text-slate-900 hover:bg-cyan-400 ring-1 ring-cyan-400 shadow-cyan-500/30\",\n    secondary: \"bg-slate-800 hover:bg-slate-700 text-slate-200\",\n    outline:\n      \"bg-transparent text-slate-300 ring-1 ring-slate-600 hover:bg-slate-800 hover:ring-slate-500 shadow-sm\",\n    \"outline-green\":\n      \"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm\",\n    \"outline-red\":\n      \"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm\",\n    danger:\n      \"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm\",\n    success:\n      \"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm\",\n    ghost: \"text-slate-400 hover:bg-slate-800 hover:text-white\",\n    indigo: \"bg-purple-900/30 text-purple-300 hover:bg-purple-900/50\",\n  };\n\n  const sizes = {\n    sm: \"px-4 py-2 text-sm\",\n    md: \"px-5 py-2.5 text-sm\",\n    lg: \"px-6 py-3 text-base\",\n  };\n\n  return (\n    <button\n      onClick={onClick}\n      disabled={disabled || loading}\n      title={title}\n      className={`inline-flex items-center justify-center gap-2 font-bold rounded-xl transition-all duration-200 active:scale-95 whitespace-nowrap focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${variants[variant]} ${sizes[size]} ${className}`}\n    >\n      {loading ? (\n        <Loader2 className=\"w-4 h-4 animate-spin\" />\n      ) : Icon ? (\n        <Icon className=\"w-4 h-4\" />\n      ) : null}\n      {children}\n    </button>\n  );\n};\n\n// ============================================\n// 정보 배지\n// ============================================\nexport const InfoBadge = ({\n  children,\n  variant = \"default\",\n  className = \"\",\n}) => {\n  const variants = {\n    default: \"bg-slate-800 text-slate-300\",\n    primary: \"bg-indigo-900/50 text-indigo-300\",\n    success: \"bg-emerald-900/50 text-emerald-300\",\n    warning: \"bg-amber-900/50 text-amber-300\",\n    danger: \"bg-red-900/50 text-red-300\",\n  };\n\n  return (\n    <span\n      className={`inline-flex items-center px-2.5 py-1 text-xs font-bold rounded-lg ${variants[variant]} ${className}`}\n    >\n      {children}\n    </span>\n  );\n};\n\n// ============================================\n// 알림 배너\n// ============================================\nexport const AlertBanner = ({\n  children,\n  variant = \"info\",\n  icon: Icon,\n  onClose,\n  className = \"\",\n}) => {\n  const variants = {\n    info: \"bg-blue-900/30 border-blue-500/30 text-blue-300\",\n    success: \"bg-emerald-900/30 border-emerald-500/30 text-emerald-300\",\n    warning: \"bg-amber-900/30 border-amber-500/30 text-amber-300\",\n    danger: \"bg-red-900/30 border-red-500/30 text-red-300\",\n  };\n\n  return (\n    <div\n      className={`flex items-start gap-3 p-4 rounded-xl border ${variants[variant]} ${className}`}\n    >\n      {Icon && <Icon className=\"w-5 h-5 flex-shrink-0 mt-0.5\" />}\n      <div className=\"flex-1 text-sm font-medium\">{children}</div>\n      {onClose && (\n        <button\n          onClick={onClose}\n          className=\"text-current opacity-50 hover:opacity-100\"\n        >\n          ×\n        </button>\n      )}\n    </div>\n  );\n};\n\n// ============================================\n// 리스트 아이템 / 할일 아이템\n// ============================================\nexport const ListItem = ({\n  children,\n  icon: Icon,\n  onClick,\n  active,\n  className = \"\",\n}) => (\n  <div\n    className={`flex items-center gap-3 p-4 rounded-xl transition-all ${\n      onClick ? \"cursor-pointer\" : \"\"\n    } ${\n      active\n        ? \"bg-cyan-900/30 border border-cyan-500/50\"\n        : \"bg-[#14142380] border border-cyan-900/20 hover:border-cyan-500/30 hover:shadow-lg hover:shadow-cyan-500/10\"\n    } ${className}`}\n    onClick={onClick}\n  >\n    {Icon && (\n      <div\n        className={`p-2 rounded-lg ${active ? \"bg-cyan-500\" : \"bg-slate-800\"}`}\n      >\n        <Icon\n          className={`w-5 h-5 ${active ? \"text-slate-900\" : \"text-slate-400\"}`}\n        />\n      </div>\n    )}\n    <div className=\"flex-1 min-w-0\">{children}</div>\n  </div>\n);\n\n// ============================================\n// 할일 아이템 - 새로운 디자인\n// ============================================\nexport const TaskItem = ({\n  task,\n  onComplete,\n  onEdit,\n  onDelete,\n  showActions = true,\n}) => (\n  <div className=\"group flex items-center justify-between p-3 rounded-xl bg-[#0a0a12] border border-cyan-900/30 hover:border-cyan-500/50 hover:bg-slate-900/50 hover:shadow-lg hover:shadow-cyan-500/10 transition-all\">\n    <div className=\"flex items-center gap-3 min-w-0\">\n      <div\n        onClick={onComplete}\n        className=\"w-5 h-5 rounded md:rounded-md border-2 border-slate-600 group-hover:border-cyan-500 cursor-pointer transition-colors flex items-center justify-center shrink-0\"\n      >\n        {/* 체크박스 영역 */}\n      </div>\n      <span className=\"font-bold text-slate-300 text-base truncate group-hover:text-cyan-400 transition-colors\">\n        {task.name}\n      </span>\n    </div>\n\n    <div className=\"flex items-center gap-2 shrink-0\">\n      {task.rewardType === \"random\" && (\n        <span className=\"px-2.5 py-1 rounded-lg bg-amber-900/30 text-amber-400 text-xs font-bold flex items-center gap-1\">\n          🎁 랜덤\n        </span>\n      )}\n      {showActions && (\n        <div className=\"opacity-0 group-hover:opacity-100 flex gap-1 transition-opacity\">\n          {onEdit && (\n            <button\n              onClick={onEdit}\n              className=\"p-1.5 text-slate-500 hover:text-cyan-400 rounded hover:bg-cyan-900/30\"\n            >\n              ✏️\n            </button>\n          )}\n          {onDelete && (\n            <button\n              onClick={onDelete}\n              className=\"p-1.5 text-slate-500 hover:text-red-400 rounded hover:bg-red-900/30\"\n            >\n              🗑️\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  </div>\n);\n\n// ============================================\n// 직업 카드 - 새로운 디자인\n// ============================================\nexport const JobCard = ({ job, children, onEdit, onDelete, onAddTask }) => {\n  const gradients = {\n    indigo: \"from-indigo-500 to-purple-600\",\n    blue: \"from-blue-500 to-cyan-500\",\n    emerald: \"from-emerald-500 to-teal-600\",\n    orange: \"from-orange-400 to-red-500\",\n    pink: \"from-pink-500 to-rose-500\",\n    violet: \"from-violet-500 to-purple-600\",\n  };\n\n  const gradient = job.color || gradients.indigo;\n\n  return (\n    <div className=\"bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg hover:shadow-xl hover:shadow-cyan-500/10 transition-all duration-300 border border-cyan-900/30 overflow-hidden flex flex-col\">\n      {/* 카드 헤더 */}\n      <div\n        className={`h-16 px-6 flex items-center justify-between bg-gradient-to-r ${gradient}`}\n      >\n        <h4 className=\"text-white font-bold text-lg tracking-wide flex items-center gap-2\">\n          👑 {job.title}\n        </h4>\n        {(onEdit || onDelete) && (\n          <div className=\"flex gap-2\">\n            {onEdit && (\n              <button\n                onClick={onEdit}\n                className=\"p-1.5 rounded-lg bg-white/20 hover:bg-white/30 text-white transition-colors\"\n              >\n                ✏️\n              </button>\n            )}\n            {onDelete && (\n              <button\n                onClick={onDelete}\n                className=\"p-1.5 rounded-lg bg-white/20 hover:bg-white/30 text-white transition-colors\"\n              >\n                🗑️\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* 할일 목록 */}\n      <div className=\"p-6 space-y-4 flex-1\">{children}</div>\n\n      {/* 하단 버튼 */}\n      {onAddTask && (\n        <div className=\"px-6 pb-6 pt-2\">\n          <button\n            onClick={onAddTask}\n            className=\"w-full py-3 rounded-xl bg-slate-900/50 text-slate-400 text-sm font-bold border border-cyan-900/30 hover:bg-cyan-900/30 hover:text-cyan-400 hover:border-cyan-500/50 transition-colors flex items-center justify-center gap-2\"\n          >\n            ➕ 이 직업에 할일 추가\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// ============================================\n// 콘텐츠 섹션 카드\n// ============================================\nexport const ContentSection = ({ children, className = \"\" }) => (\n  <div\n    className={`bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg border border-cyan-900/30 p-6 ${className}`}\n  >\n    {children}\n  </div>\n);\n\n// ============================================\n// 금액 표시\n// ============================================\nexport const MoneyDisplay = ({\n  amount,\n  size = \"md\",\n  showSign = false,\n  className = \"\",\n}) => {\n  const formatted = Math.abs(amount || 0).toLocaleString(\"ko-KR\");\n  const isNegative = amount < 0;\n  const isPositive = amount > 0;\n\n  const sizes = {\n    sm: \"text-sm\",\n    md: \"text-base\",\n    lg: \"text-xl\",\n    xl: \"text-2xl\",\n  };\n\n  return (\n    <span\n      className={`font-bold tabular-nums ${sizes[size]} ${\n        isNegative\n          ? \"text-red-400\"\n          : isPositive && showSign\n            ? \"text-emerald-400\"\n            : \"text-white\"\n      } ${className}`}\n    >\n      {showSign && isPositive && \"+\"}\n      {isNegative && \"-\"}\n      {formatted}원\n    </span>\n  );\n};\n\n// ============================================\n// 빈 추가 카드\n// ============================================\nexport const AddCard = ({ onClick, label = \"새로 추가하기\" }) => (\n  <button\n    onClick={onClick}\n    className=\"group relative flex flex-col items-center justify-center h-full min-h-[260px] rounded-2xl border-2 border-dashed border-cyan-900/50 bg-slate-900/30 hover:bg-cyan-900/20 hover:border-cyan-500/50 transition-all\"\n  >\n    <div className=\"w-16 h-16 rounded-full bg-slate-800 shadow-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform\">\n      <span className=\"text-3xl text-slate-500 group-hover:text-cyan-400\">\n        ➕\n      </span>\n    </div>\n    <span className=\"text-slate-500 font-bold group-hover:text-cyan-400 text-sm\">\n      {label}\n    </span>\n  </button>\n);\n\nexport default {\n  PageContainer,\n  PageHeader,\n  SectionTitle,\n  LoadingState,\n  ErrorState,\n  EmptyState,\n  CardGrid,\n  StatCard,\n  AssetCard,\n  TabGroup,\n  ActionButton,\n  InfoBadge,\n  AlertBanner,\n  ListItem,\n  TaskItem,\n  JobCard,\n  ContentSection,\n  MoneyDisplay,\n  AddCard,\n};\n","// src/ParkingAccount.js\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  db,\n  doc,\n  getDoc,\n  setDoc,\n  serverTimestamp,\n  updateDoc,\n  increment,\n  runTransaction,\n  collection,\n  getDocs,\n  deleteDoc,\n  query,\n  where,\n  limit,\n} from \"../../firebase\";\nimport { format, isToday, differenceInDays } from \"date-fns\";\nimport {\n  PiggyBank,\n  Landmark,\n  HandCoins,\n  Wallet,\n  X,\n  TrendingUp,\n} from \"lucide-react\";\nimport {\n  formatKoreanCurrency,\n  getCurrencyUnit,\n} from \"../../utils/numberFormatter\";\nimport { logActivity, ACTIVITY_TYPES } from \"../../utils/firestoreHelpers\";\nimport { useCurrency } from \"../../contexts/CurrencyContext\";\n\nimport { logger } from \"../../utils/logger\";\n// 선생님(관리자) 계정 찾기 - 같은 학급의 관리자\nconst getTeacherAccount = async (classCode) => {\n  if (!classCode) return null;\n\n  try {\n    const usersRef = collection(db, \"users\");\n    const q = query(\n      usersRef,\n      where(\"classCode\", \"==\", classCode),\n      where(\"isAdmin\", \"==\", true),\n      limit(1),\n    );\n    const snapshot = await getDocs(q);\n\n    if (!snapshot.empty) {\n      const teacherDoc = snapshot.docs[0];\n      return {\n        id: teacherDoc.id,\n        ...teacherDoc.data(),\n      };\n    }\n    return null;\n  } catch (error) {\n    logger.error(\"선생님 계정 조회 오류:\", error);\n    return null;\n  }\n};\n\n// --- Tailwind class helpers ---\nconst cls = {\n  container: \"font-sans bg-transparent p-8 min-h-0\",\n  message: (type) =>\n    `px-5 py-4 rounded-xl mb-7 text-center text-base font-medium shadow-sm ${\n      type === \"error\"\n        ? \"text-red-400 bg-red-500/10 border border-red-500/30\"\n        : \"text-emerald-400 bg-emerald-500/10 border border-emerald-500/30\"\n    }`,\n  grid: \"grid gap-7 w-full\",\n  card: \"bg-[rgba(20,20,35,0.6)] shadow-[0_6px_20px_rgba(0,0,0,0.2)] rounded-2xl p-8 border border-white/5 backdrop-blur-[10px]\",\n  cardHeader: \"flex items-center gap-4 mb-6 pb-5 border-b-2 border-white/5\",\n  cardTitle:\n    \"text-[26px] font-bold text-white tracking-tight drop-shadow-[0_0_10px_rgba(0,255,242,0.3)]\",\n  tabContainer: \"flex border-b-2 border-white/10 mb-5 gap-2\",\n  tabButton: (isActive) =>\n    `px-6 py-3 border-none cursor-pointer text-[17px] rounded-t-lg transition-all duration-200 -mb-0.5 ${\n      isActive\n        ? \"bg-indigo-500/20 font-bold text-cyber-cyan border-b-[3px] border-b-cyber-cyan drop-shadow-[0_0_5px_rgba(0,255,242,0.3)]\"\n        : \"font-medium text-slate-400 border-b-[3px] border-b-transparent\"\n    }`,\n  button: (disabled, variant = \"primary\") =>\n    `text-white px-5 py-3 rounded-[10px] border border-white/10 text-[15px] font-semibold transition-all duration-200 ${\n      disabled\n        ? \"cursor-not-allowed opacity-50\"\n        : \"cursor-pointer shadow-[0_4px_12px_rgba(0,0,0,0.3)] hover:-translate-y-0.5 hover:brightness-110\"\n    } ${\n      variant === \"primary\"\n        ? \"bg-sky-700/80\"\n        : variant === \"danger\"\n          ? \"bg-red-600/80\"\n          : variant === \"success\"\n            ? \"bg-emerald-600/80\"\n            : \"bg-gray-600\"\n    }`,\n  noProduct: \"text-center text-slate-400 py-8 text-base italic\",\n  input:\n    \"w-full py-3.5 px-4 bg-black/20 border-2 border-white/10 rounded-[10px] mb-4 text-base text-white transition-colors duration-200 focus:outline-none focus:border-cyber-cyan focus:ring-2 focus:ring-cyber-cyan/10\",\n  modalOverlay:\n    \"fixed inset-0 bg-black/80 flex items-center justify-center z-[1000] backdrop-blur-[8px]\",\n  modalContent:\n    \"bg-[#1a1a2e] p-8 rounded-2xl w-[90%] max-w-[450px] relative shadow-[0_20px_60px_rgba(0,0,0,0.6)] border border-white/10 text-slate-200\",\n  modalTitle:\n    \"text-2xl font-bold mb-5 text-white drop-shadow-[0_0_10px_rgba(0,255,242,0.3)]\",\n  modalCloseBtn:\n    \"absolute top-5 right-5 bg-transparent border-none cursor-pointer text-slate-400 transition-colors duration-200 hover:text-white\",\n};\n\n// --- Helper Functions & Sub-Components ---\nconst formatCurrency = (amount) =>\n  typeof amount === \"number\" ? Math.round(amount).toLocaleString() : \"0\";\n\n// 화폐 단위를 포함한 금액 포맷 헬퍼\nconst formatCurrencyWithUnit = (amount) =>\n  `${formatCurrency(amount)}${getCurrencyUnit()}`;\n\n// 일복리 계산\nconst calculateCompoundInterest = (principal, dailyRate, days) => {\n  if (principal <= 0 || !dailyRate || days <= 0)\n    return { interest: 0, total: principal };\n  const total = principal * Math.pow(1 + dailyRate / 100, days);\n  const interest = total - principal;\n  return { interest: Math.round(interest), total: Math.round(total) };\n};\n\n// 일일 이자 계산 (메모이제이션으로 최적화)\nconst calculateDailyInterest = (principal, dailyRate) => {\n  // 콘솔 로그 제거 - 성능 최적화\n  return Math.round(principal * (dailyRate / 100));\n};\n\nconst ICON_MAP = {\n  parking: <Wallet size={28} className=\"text-sky-700\" />,\n  deposits: <Landmark size={28} className=\"text-emerald-600\" />,\n  savings: <PiggyBank size={28} className=\"text-violet-600\" />,\n  loans: <HandCoins size={28} className=\"text-red-600\" />,\n};\n\nconst SubscribedProductItem = ({ product, onCancel, onMaturity }) => {\n  const isMatured = product.maturityDate && new Date() >= product.maturityDate;\n  const daysRemaining = product.maturityDate\n    ? Math.max(0, differenceInDays(product.maturityDate, new Date()))\n    : 0;\n  const dailyRate = product.rate; // 연이율을 일이율로 변환\n\n  const { interest, total } = calculateCompoundInterest(\n    product.balance,\n    product.rate, // 일복리\n    product.termInDays,\n  );\n\n  const dailyInterestAmount = calculateDailyInterest(\n    product.balance,\n    product.rate,\n  );\n\n  return (\n    <div\n      className={`p-5 border-2 rounded-xl mb-4 shadow-[0_2px_8px_rgba(0,0,0,0.2)] ${\n        isMatured\n          ? \"border-emerald-500/50 bg-emerald-500/10\"\n          : \"border-white/10 bg-black/20\"\n      }`}\n    >\n      <div className=\"flex justify-between items-start mb-3\">\n        <div>\n          <div className=\"font-bold text-lg text-slate-200 mb-1\">\n            {product.name}\n          </div>\n          {isMatured && (\n            <span className=\"bg-emerald-500 text-white px-3 py-1 rounded-full text-[13px] font-semibold\">\n              만기\n            </span>\n          )}\n        </div>\n        <span className=\"text-xl font-bold text-cyber-cyan\">\n          {formatCurrencyWithUnit(product.balance)}\n        </span>\n      </div>\n\n      <div className=\"text-[15px] text-slate-400 mt-4 grid gap-2.5 bg-black/20 p-4 rounded-lg\">\n        <div className=\"flex justify-between\">\n          <span className=\"font-medium\">금리 (일):</span>\n          <span className=\"font-bold text-cyber-cyan\">{product.rate}%</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"font-medium\">일일 이자:</span>\n          <span className=\"font-bold text-emerald-400\">\n            +{formatCurrencyWithUnit(dailyInterestAmount)}/일\n          </span>\n        </div>\n        {product.maturityDate && (\n          <>\n            <div className=\"flex justify-between\">\n              <span className=\"font-medium\">만기일:</span>\n              <span className=\"font-semibold text-slate-200\">\n                {format(product.maturityDate, \"yyyy-MM-dd\")}\n              </span>\n            </div>\n            {!isMatured && (\n              <div className=\"flex justify-between\">\n                <span className=\"font-medium\">남은 기간:</span>\n                <span className=\"font-semibold text-cyber-cyan\">\n                  {daysRemaining}일\n                </span>\n              </div>\n            )}\n          </>\n        )}\n      </div>\n\n      <div className=\"border-t border-dashed border-white/10 my-4\"></div>\n\n      <div className=\"text-[15px] text-slate-200 grid gap-2.5 bg-cyber-cyan/5 p-4 rounded-lg border border-cyber-cyan/10\">\n        <div className=\"flex justify-between\">\n          <span className=\"font-semibold\">만기 시 이자 (세전):</span>\n          <span className=\"font-bold text-emerald-400 text-[17px]\">\n            +{formatCurrencyWithUnit(interest)}\n          </span>\n        </div>\n        <div className=\"flex justify-between text-[17px]\">\n          <span className=\"font-bold\">만기 시 총액:</span>\n          <span className=\"font-bold text-cyber-cyan\">\n            {formatCurrencyWithUnit(total)}\n          </span>\n        </div>\n      </div>\n\n      <div className=\"mt-5 text-right\">\n        {isMatured ? (\n          <button\n            onClick={onMaturity}\n            className={\n              cls.button(false, \"success\") + \" px-5 py-2.5 text-[15px]\"\n            }\n          >\n            만기 수령 ({formatCurrencyWithUnit(total)})\n          </button>\n        ) : (\n          <button\n            onClick={onCancel}\n            className={cls.button(false, \"danger\") + \" px-5 py-2.5 text-[15px]\"}\n          >\n            {product.type === \"loan\" ? \"대출 상환\" : \"중도 해지\"}\n          </button>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst AvailableProductItem = ({ product, onSubscribe }) => {\n  const dailyRate = product.dailyRate;\n  const { interest: projectedInterest } = calculateCompoundInterest(\n    100000,\n    dailyRate,\n    product.termInDays,\n  );\n\n  return (\n    <div className=\"p-5 border-2 border-white/10 rounded-xl mb-3 flex justify-between items-center bg-black/20 shadow-[0_2px_8px_rgba(0,0,0,0.2)] transition-all duration-200\">\n      <div>\n        <div className=\"font-bold text-lg text-slate-200 mb-2\">\n          {product.name}\n        </div>\n        <div className=\"text-[15px] text-slate-400 mb-1.5\">\n          <strong className=\"text-cyber-cyan\">일 {product.dailyRate}%</strong>{\" \"}\n          (기간: {product.termInDays}일)\n        </div>\n        <div className=\"text-sm text-emerald-400 font-semibold\">\n          <TrendingUp size={14} className=\"inline mr-1\" />\n          10만{getCurrencyUnit()} 가입 시 예상 이자: +\n          {formatCurrencyWithUnit(projectedInterest)}\n        </div>\n      </div>\n      <button\n        onClick={onSubscribe}\n        className={cls.button(false) + \" px-6 py-3 text-base\"}\n      >\n        가입\n      </button>\n    </div>\n  );\n};\n\nconst ProductSection = ({\n  title,\n  icon,\n  subscribedProducts,\n  availableProducts,\n  onSubscribe,\n  onCancel,\n  onMaturity,\n}) => {\n  const [activeTab, setActiveTab] = useState(\"subscribed\");\n  return (\n    <div className={cls.card}>\n      <div className={cls.cardHeader}>\n        {icon}\n        <h2 className={cls.cardTitle}>{title}</h2>\n      </div>\n      <div className={cls.tabContainer}>\n        <button\n          onClick={() => setActiveTab(\"subscribed\")}\n          className={cls.tabButton(activeTab === \"subscribed\")}\n        >\n          가입한 상품\n        </button>\n        <button\n          onClick={() => setActiveTab(\"available\")}\n          className={cls.tabButton(activeTab === \"available\")}\n        >\n          가입 가능한 상품\n        </button>\n      </div>\n      <div>\n        {activeTab === \"subscribed\" &&\n          (subscribedProducts.length > 0 ? (\n            subscribedProducts.map((p) => (\n              <SubscribedProductItem\n                key={p.id}\n                product={p}\n                onCancel={() => onCancel(p)}\n                onMaturity={() => onMaturity(p)}\n              />\n            ))\n          ) : (\n            <p className={cls.noProduct}>가입한 상품이 없습니다.</p>\n          ))}\n        {activeTab === \"available\" &&\n          (availableProducts.length > 0 ? (\n            availableProducts.map((p) => (\n              <AvailableProductItem\n                key={p.id}\n                product={p}\n                onSubscribe={() => onSubscribe(p)}\n              />\n            ))\n          ) : (\n            <p className={cls.noProduct}>가입 가능한 상품이 없습니다.</p>\n          ))}\n      </div>\n    </div>\n  );\n};\n\nconst SubscriptionModal = ({\n  isOpen,\n  onClose,\n  product,\n  onConfirm,\n  isProcessing,\n}) => {\n  const [amount, setAmount] = useState(\"\");\n\n  if (!isOpen || !product) return null;\n\n  const numAmount = parseFloat(amount);\n  const dailyRate = product.dailyRate;\n  const { interest: projectedInterest, total: projectedTotal } =\n    !isNaN(numAmount) && numAmount > 0\n      ? calculateCompoundInterest(numAmount, dailyRate, product.termInDays)\n      : { interest: 0, total: 0 };\n\n  return (\n    <div className={cls.modalOverlay} onClick={onClose}>\n      <div className={cls.modalContent} onClick={(e) => e.stopPropagation()}>\n        <button\n          onClick={onClose}\n          className={cls.modalCloseBtn}\n          aria-label=\"닫기\"\n        >\n          <X size={24} />\n        </button>\n        <h3 className={cls.modalTitle}>{product.name} 가입</h3>\n\n        <div className=\"mb-5 p-4 bg-cyber-cyan/5 rounded-[10px] border border-cyber-cyan/20\">\n          <div className=\"text-[15px] text-slate-400 mb-2\">\n            <strong className=\"text-cyber-cyan\">금리:</strong> 일{\" \"}\n            {product.dailyRate}% (일복리)\n          </div>\n          <div className=\"text-[15px] text-slate-400\">\n            <strong className=\"text-cyber-cyan\">기간:</strong>{\" \"}\n            {product.termInDays}일\n          </div>\n        </div>\n\n        <p className=\"mb-3 text-base font-semibold text-slate-200\">\n          가입 금액을 입력해주세요\n        </p>\n        <input\n          type=\"number\"\n          value={amount}\n          onChange={(e) => setAmount(e.target.value)}\n          className={cls.input}\n          placeholder={`${formatCurrencyWithUnit(product.minAmount || 0)} 이상`}\n          autoFocus\n        />\n\n        {numAmount > 0 && (\n          <div className=\"mb-5 p-4 bg-emerald-500/10 rounded-[10px] border border-emerald-500/30\">\n            <div className=\"text-[15px] text-emerald-400 mb-1.5\">\n              예상 만기 이자:{\" \"}\n              <strong>+{formatCurrencyWithUnit(projectedInterest)}</strong>\n            </div>\n            <div className=\"text-base text-emerald-400 font-bold\">\n              만기 시 총액: {formatCurrencyWithUnit(projectedTotal)}\n            </div>\n          </div>\n        )}\n\n        <button\n          onClick={() => {\n            onConfirm(amount);\n            setAmount(\"\");\n          }}\n          disabled={isProcessing || !amount}\n          className={\n            cls.button(isProcessing || !amount) + \" w-full text-[17px] py-4\"\n          }\n        >\n          {isProcessing ? \"처리 중...\" : \"가입하기\"}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nconst ParkingAccountSection = ({\n  balance,\n  dailyInterest,\n  onDeposit,\n  onWithdraw,\n  isProcessing,\n  userCash,\n}) => {\n  const [amount, setAmount] = useState(\"\");\n\n  return (\n    <div className=\"bg-gradient-to-br from-[rgba(6,78,117,0.85)] to-[rgba(20,40,60,0.9)] text-white shadow-[0_8px_24px_rgba(0,0,0,0.4)] rounded-2xl p-8 border border-[rgba(0,180,216,0.25)] backdrop-blur-[10px]\">\n      <div className=\"flex items-center gap-4 mb-6 pb-5 border-b-2 border-[rgba(0,180,216,0.2)]\">\n        <Wallet size={32} className=\"text-cyan-300\" />\n        <h2 className=\"text-[26px] font-bold text-[#e0f7fa] tracking-tight drop-shadow-[0_0_10px_rgba(0,255,242,0.3)]\">\n          파킹통장\n        </h2>\n      </div>\n\n      {/* 보유현금 표시 */}\n      <div className=\"bg-[rgba(0,180,216,0.15)] px-4 py-3 rounded-[10px] mb-4 backdrop-blur-[10px] flex justify-between items-center border border-[rgba(0,180,216,0.2)]\">\n        <span className=\"text-base font-medium text-slate-400\">보유 현금</span>\n        <span className=\"text-xl font-bold text-[#e0f7fa]\">\n          {formatCurrencyWithUnit(userCash || 0)}\n        </span>\n      </div>\n\n      <div className=\"text-[42px] font-bold text-[#e0f7fa] mb-2\">\n        {formatCurrencyWithUnit(balance)}\n      </div>\n\n      <p className=\"text-base text-[#e0f7fa]/80 mb-4 font-medium\">\n        매일 이자가 자동 지급되는 자유 입출금 통장\n      </p>\n\n      <div className=\"bg-[rgba(0,180,216,0.12)] p-4 rounded-[10px] mb-6 backdrop-blur-[10px] border border-[rgba(0,180,216,0.2)]\">\n        <div className=\"flex items-center gap-2 mb-2\">\n          <TrendingUp size={20} className=\"text-cyan-300\" />\n          <span className=\"text-[15px] font-semibold text-slate-400\">\n            일일 이자 수익\n          </span>\n        </div>\n        <div className=\"text-[28px] font-bold text-cyan-300\">\n          +{formatCurrencyWithUnit(dailyInterest)}/일\n        </div>\n        <div className=\"text-sm mt-1.5 text-slate-400/90\">\n          (일 1% 복리 기준)\n        </div>\n      </div>\n\n      <div className=\"flex gap-2.5\">\n        <input\n          type=\"number\"\n          value={amount}\n          onChange={(e) => setAmount(e.target.value)}\n          placeholder=\"금액 입력\"\n          className=\"flex-1 py-3.5 px-4 bg-black/30 border border-[rgba(0,180,216,0.3)] rounded-[10px] text-[17px] text-white focus:outline-none focus:border-cyber-cyan\"\n          disabled={isProcessing}\n        />\n        <button\n          onClick={() => {\n            onDeposit(amount);\n            setAmount(\"\");\n          }}\n          disabled={isProcessing}\n          className={\n            cls.button(isProcessing, \"success\") + \" text-[17px] px-6 py-3.5\"\n          }\n        >\n          입금\n        </button>\n        <button\n          onClick={() => {\n            onWithdraw(amount);\n            setAmount(\"\");\n          }}\n          disabled={isProcessing}\n          className={\n            cls.button(isProcessing) +\n            \" !bg-slate-500/50 text-[17px] px-6 py-3.5\"\n          }\n        >\n          출금\n        </button>\n      </div>\n    </div>\n  );\n};\n\n// --- Main Component ---\nconst ParkingAccount = ({\n  auth = {},\n  depositProducts = [],\n  installmentProducts = [],\n  loanProducts = [],\n  activeView = \"parking\",\n  onViewChange,\n  onLoadUserProducts,\n  allUserProducts = [],\n  onDeleteUserProduct,\n}) => {\n  const {\n    user,\n    userDoc,\n    loading,\n    refreshUserDocument,\n    isAdmin,\n    addCash,\n    deductCash,\n  } = auth;\n  const userId = user?.uid;\n\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [message, setMessage] = useState(null);\n  const [messageType, setMessageType] = useState(\"\");\n  const [parkingBalance, setParkingBalance] = useState(0);\n  const [parkingDailyInterest, setParkingDailyInterest] = useState(0);\n  const [userDeposits, setUserDeposits] = useState([]);\n  const [userSavings, setUserSavings] = useState([]);\n  const [userLoans, setUserLoans] = useState([]);\n  const [modal, setModal] = useState({\n    isOpen: false,\n    product: null,\n    type: \"\",\n  });\n  const [currentCash, setCurrentCash] = useState(userDoc?.cash || 0);\n  const { currencyUnit } = useCurrency();\n\n  const displayMessage = (text, type = \"info\", duration = 3000) => {\n    setMessage(text);\n    setMessageType(type);\n    if (duration) setTimeout(() => setMessage(null), duration);\n  };\n\n  const loadAllData = useCallback(async () => {\n    if (!userId) return;\n    setIsProcessing(true);\n    try {\n      // 파킹통장 처리\n      const parkingRef = doc(\n        db,\n        \"users\",\n        userId,\n        \"financials\",\n        \"parkingAccount\",\n      );\n      const parkingRateProduct =\n        depositProducts.length > 0 ? depositProducts[0] : null;\n\n      if (parkingRateProduct) {\n        const parkingDoc = await getDoc(parkingRef);\n        if (parkingDoc.exists()) {\n          const data = parkingDoc.data();\n          const lastInterestDate = data.lastInterestDate?.toDate();\n\n          if (!lastInterestDate || !isToday(lastInterestDate)) {\n            const daysToApply = lastInterestDate\n              ? differenceInDays(new Date(), lastInterestDate)\n              : 1;\n            if (daysToApply > 0) {\n              const dailyRate = parkingRateProduct.dailyRate || 0.0027; // 기본 1% 연이율을 일로 환산한 값과 유사하게\n              const { interest } = calculateCompoundInterest(\n                data.balance || 0,\n                dailyRate,\n                daysToApply,\n              );\n\n              if (interest > 0) {\n                await updateDoc(parkingRef, {\n                  balance: increment(interest),\n                  lastInterestDate: serverTimestamp(),\n                });\n                displayMessage(\n                  `파킹통장 이자 ${formatCurrency(interest)}${currencyUnit}이 지급되었습니다.`,\n                  \"success\",\n                );\n              }\n            }\n          }\n        } else {\n          // 파킹통장이 없으면 생성\n          await setDoc(parkingRef, {\n            balance: 0,\n            lastInterestDate: serverTimestamp(),\n          });\n        }\n      }\n\n      // 최종 잔액 조회\n      const finalParkingDoc = await getDoc(parkingRef);\n      if (finalParkingDoc.exists()) {\n        const balance = finalParkingDoc.data().balance || 0;\n        setParkingBalance(balance);\n\n        // 일일 이자 계산 (1% 기준)\n        const dailyRate = 1; // 1% 일일 이자율\n        const dailyInterest = calculateDailyInterest(balance, dailyRate);\n        setParkingDailyInterest(dailyInterest);\n      }\n\n      // 가입 상품 조회\n      const productsRef = collection(db, \"users\", userId, \"products\");\n      const snapshot = await getDocs(productsRef);\n      const deposits = [],\n        savings = [],\n        loans = [];\n\n      snapshot.forEach((docSnap) => {\n        const product = {\n          id: docSnap.id,\n          ...docSnap.data(),\n          maturityDate: docSnap.data().maturityDate?.toDate\n            ? docSnap.data().maturityDate.toDate()\n            : docSnap.data().maturityDate,\n        };\n        if (product.type === \"deposit\") deposits.push(product);\n        else if (product.type === \"savings\") savings.push(product);\n        else if (product.type === \"loan\") loans.push(product);\n      });\n\n      setUserDeposits(deposits);\n      setUserSavings(savings);\n      setUserLoans(loans);\n    } catch (error) {\n      logger.error(\"데이터 로드 오류:\", error);\n      displayMessage(\"데이터를 불러오는 데 실패했습니다.\", \"error\");\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [userId, depositProducts]);\n\n  useEffect(() => {\n    if (!loading && userId) loadAllData();\n  }, [userId, loading, loadAllData]);\n\n  // userDoc의 cash가 변경될 때마다 currentCash 업데이트\n  useEffect(() => {\n    if (userDoc?.cash !== undefined) {\n      setCurrentCash(userDoc.cash);\n      logger.log(\"[ParkingAccount] currentCash 업데이트:\", userDoc.cash);\n    }\n  }, [userDoc?.cash]);\n\n  const handleOpenModal = (product, type) =>\n    setModal({ isOpen: true, product, type });\n  const handleCloseModal = () =>\n    setModal({ isOpen: false, product: null, type: \"\" });\n\n  const handleSubscribe = async (subscribeAmount) => {\n    logger.log(\"--- handleSubscribe 시작 ---\");\n    const amount = parseFloat(subscribeAmount);\n    const { product, type } = modal;\n\n    logger.log(\"가입할 상품:\", product);\n    logger.log(`가입 유형: ${type}, 가입 금액: ${amount}`);\n\n    if (isNaN(amount) || amount <= 0) {\n      logger.error(\"유효하지 않은 금액:\", subscribeAmount);\n      return displayMessage(\"유효한 금액을 입력하세요.\", \"error\");\n    }\n    if (product.minAmount && amount < product.minAmount) {\n      logger.error(`최소 가입 금액 미달: ${amount} < ${product.minAmount}`);\n      return displayMessage(\n        `최소 가입 금액은 ${formatCurrency(product.minAmount)}${currencyUnit}입니다.`,\n        \"error\",\n      );\n    }\n    if (product.maxAmount && amount > product.maxAmount) {\n      logger.error(`최대 가입 한도 초과: ${amount} > ${product.maxAmount}`);\n      return displayMessage(\n        `최대 가입 한도는 ${formatCurrency(product.maxAmount)}${currencyUnit}입니다.`,\n        \"error\",\n      );\n    }\n\n    setIsProcessing(true);\n    handleCloseModal(); // UX 개선을 위해 모달 즉시 닫기\n\n    // --- 선생님 계정 조회 ---\n    const teacherAccount = await getTeacherAccount(userDoc?.classCode);\n    if (!teacherAccount) {\n      displayMessage(\n        \"선생님(은행) 계정을 찾을 수 없습니다. 관리자에게 문의하세요.\",\n        \"error\",\n      );\n      setIsProcessing(false);\n      return;\n    }\n    logger.log(\"선생님 계정:\", teacherAccount.name, teacherAccount.id);\n\n    // --- 낙관적 업데이트 (Optimistic Update) ---\n    const tempId = `temp_${Date.now()}`;\n    const maturityDate = new Date(\n      Date.now() + product.termInDays * 24 * 60 * 60 * 1000,\n    );\n    const optimisticProduct = {\n      id: tempId,\n      name: product.name,\n      termInDays: product.termInDays,\n      rate: product.dailyRate,\n      balance: amount,\n      startDate: new Date(),\n      maturityDate: maturityDate,\n      type:\n        type === \"deposits\"\n          ? \"deposit\"\n          : type === \"savings\"\n            ? \"savings\"\n            : \"loan\",\n      isOptimistic: true, // 임시 데이터임을 표시\n    };\n\n    // 상품 목록 낙관적 업데이트\n    if (optimisticProduct.type === \"deposit\") {\n      setUserDeposits((prev) => [...prev, optimisticProduct]);\n    } else if (optimisticProduct.type === \"savings\") {\n      setUserSavings((prev) => [...prev, optimisticProduct]);\n    } else if (optimisticProduct.type === \"loan\") {\n      setUserLoans((prev) => [...prev, optimisticProduct]);\n    }\n\n    // 현금 보유량 낙관적 업데이트\n    const cashChangeAmount = type === \"loans\" ? amount : -amount;\n    setCurrentCash((prev) => prev + cashChangeAmount); // 로컬 UI 상태만 먼저 업데이트\n\n    try {\n      await runTransaction(db, async (transaction) => {\n        const userRef = doc(db, \"users\", userId);\n        const teacherRef = doc(db, \"users\", teacherAccount.id);\n\n        const userSnapshot = await transaction.get(userRef);\n        const teacherSnapshot = await transaction.get(teacherRef);\n\n        if (!userSnapshot.exists())\n          throw new Error(\"사용자 정보를 찾을 수 없습니다.\");\n        if (!teacherSnapshot.exists())\n          throw new Error(\"선생님(은행) 계정을 찾을 수 없습니다.\");\n\n        const currentCashInDb = userSnapshot.data()?.cash ?? 0;\n        const teacherCashInDb = teacherSnapshot.data()?.cash ?? 0;\n\n        // 예금/적금: 학생 현금 확인\n        if (type !== \"loans\" && currentCashInDb < amount) {\n          throw new Error(\"보유 현금이 부족합니다.\");\n        }\n\n        // 대출: 선생님(은행) 현금 확인\n        if (type === \"loans\" && teacherCashInDb < amount) {\n          throw new Error(\"은행(선생님)에 대출 가능한 자금이 부족합니다.\");\n        }\n\n        const newProductData = {\n          name: product.name,\n          termInDays: product.termInDays,\n          rate: product.dailyRate,\n          balance: amount,\n          startDate: serverTimestamp(),\n          maturityDate: maturityDate,\n          type:\n            type === \"deposits\"\n              ? \"deposit\"\n              : type === \"savings\"\n                ? \"savings\"\n                : \"loan\",\n          teacherId: teacherAccount.id, // 선생님 계정 ID 저장\n          teacherName: teacherAccount.name || \"선생님\",\n        };\n\n        const newProductRef = doc(collection(db, \"users\", userId, \"products\"));\n        transaction.set(newProductRef, newProductData);\n\n        // 예금/적금: 학생 → 선생님\n        // 대출: 선생님 → 학생\n        if (type === \"loans\") {\n          // 대출: 선생님에서 학생으로\n          transaction.update(userRef, { cash: increment(amount) });\n          transaction.update(teacherRef, { cash: increment(-amount) });\n        } else {\n          // 예금/적금: 학생에서 선생님으로\n          transaction.update(userRef, { cash: increment(-amount) });\n          transaction.update(teacherRef, { cash: increment(amount) });\n        }\n      });\n\n      const actionText = type === \"loans\" ? \"대출\" : \"가입\";\n      displayMessage(\n        `${product.name} ${actionText}이 완료되었습니다. (선생님 계정과 연동)`,\n        \"success\",\n      );\n\n      // 🔥 활동 로그 기록 (예금/적금/대출 가입)\n      const activityType =\n        type === \"deposits\"\n          ? ACTIVITY_TYPES.DEPOSIT_CREATE\n          : type === \"savings\"\n            ? ACTIVITY_TYPES.DEPOSIT_CREATE\n            : ACTIVITY_TYPES.LOAN_CREATE;\n      logActivity(db, {\n        classCode: userDoc?.classCode,\n        userId: userId,\n        userName: userDoc?.name || \"사용자\",\n        type: activityType,\n        description: `${product.name} ${type === \"loans\" ? \"대출\" : \"가입\"} (${formatCurrency(amount)}원) - 선생님 계정 연동`,\n        amount: cashChangeAmount,\n        metadata: {\n          productName: product.name,\n          productType: type,\n          termInDays: product.termInDays,\n          dailyRate: product.dailyRate,\n          maturityDate: maturityDate.toISOString(),\n          teacherId: teacherAccount.id,\n          teacherName: teacherAccount.name,\n        },\n      });\n\n      // 서버 데이터로 다시 로드하여 낙관적 업데이트 결과 교체\n      await loadAllData();\n      if (refreshUserDocument) refreshUserDocument();\n    } catch (error) {\n      logger.error(\"가입 처리 중 오류 발생:\", error);\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\n\n      // --- 낙관적 업데이트 롤백 ---\n      if (optimisticProduct.type === \"deposit\") {\n        setUserDeposits((prev) => prev.filter((p) => p.id !== tempId));\n      } else if (optimisticProduct.type === \"savings\") {\n        setUserSavings((prev) => prev.filter((p) => p.id !== tempId));\n      } else if (optimisticProduct.type === \"loan\") {\n        setUserLoans((prev) => prev.filter((p) => p.id !== tempId));\n      }\n\n      // 현금 롤백 (로컬 UI)\n      setCurrentCash((prev) => prev - cashChangeAmount);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // 만기 수령\n  const handleMaturity = async (product) => {\n    logger.log(\"--- handleMaturity 시작 ---\");\n    logger.log(\"처리할 상품:\", product);\n\n    const { id, name, type, balance, termInDays, rate, teacherId } = product;\n    const isLoan = type === \"loan\";\n\n    if (!userId) {\n      displayMessage(\"사용자 정보가 없습니다. 다시 로그인해주세요.\", \"error\");\n      logger.error(\"handleMaturity: userId가 없습니다.\");\n      return;\n    }\n\n    const dailyRate = rate;\n    const { total, interest } = calculateCompoundInterest(\n      balance,\n      dailyRate,\n      termInDays,\n    );\n\n    logger.log(`계산 결과: 원금=${balance}, 이자=${interest}, 총액=${total}`);\n\n    const confirmMsg = isLoan\n      ? `대출 만기 상환: 원금 ${formatCurrency(balance)}${currencyUnit} + 이자 ${formatCurrency(interest)}${currencyUnit} = ${formatCurrency(total)}${currencyUnit}을 상환하시겠습니까?`\n      : `만기 수령: 원금 ${formatCurrency(balance)}${currencyUnit} + 이자 ${formatCurrency(interest)}${currencyUnit} = ${formatCurrency(total)}${currencyUnit}을 수령하시겠습니까?`;\n\n    if (!window.confirm(confirmMsg)) {\n      logger.log(\"사용자가 만기 처리를 취소했습니다.\");\n      return;\n    }\n\n    setIsProcessing(true);\n    logger.log(\"만기 처리 시작...\");\n\n    // 선생님 계정 조회 (저장된 teacherId 사용 또는 새로 조회)\n    let teacherAccountId = teacherId;\n    if (!teacherAccountId) {\n      const teacherAccount = await getTeacherAccount(userDoc?.classCode);\n      if (!teacherAccount) {\n        displayMessage(\"선생님(은행) 계정을 찾을 수 없습니다.\", \"error\");\n        setIsProcessing(false);\n        return;\n      }\n      teacherAccountId = teacherAccount.id;\n    }\n    logger.log(\"선생님 계정 ID:\", teacherAccountId);\n\n    try {\n      const productRef = doc(db, \"users\", userId, \"products\", String(id));\n      logger.log(\"Firestore 문서 참조:\", productRef.path);\n\n      await runTransaction(db, async (transaction) => {\n        logger.log(\"트랜잭션 시작\");\n        const userRef = doc(db, \"users\", userId);\n        const teacherRef = doc(db, \"users\", teacherAccountId);\n\n        const userSnapshot = await transaction.get(userRef);\n        const teacherSnapshot = await transaction.get(teacherRef);\n\n        if (!userSnapshot.exists())\n          throw new Error(\"사용자 정보를 찾을 수 없습니다.\");\n        if (!teacherSnapshot.exists())\n          throw new Error(\"선생님(은행) 계정을 찾을 수 없습니다.\");\n\n        const currentCashInDb = userSnapshot.data()?.cash ?? 0;\n        const teacherCashInDb = teacherSnapshot.data()?.cash ?? 0;\n\n        if (isLoan) {\n          // 대출 만기 상환: 학생 → 선생님 (원금+이자)\n          if (currentCashInDb < total) {\n            throw new Error(\n              `상환금이 부족합니다. (필요: ${formatCurrency(total)}${currencyUnit}, 보유: ${formatCurrency(currentCashInDb)}${currencyUnit})`,\n            );\n          }\n          transaction.update(userRef, { cash: increment(-total) });\n          transaction.update(teacherRef, { cash: increment(total) });\n          logger.log(`대출 상환: 학생 -${total}, 선생님 +${total}`);\n        } else {\n          // 예금/적금 만기 수령: 선생님 → 학생 (원금+이자)\n          if (teacherCashInDb < total) {\n            throw new Error(\n              `은행(선생님)에 지급할 자금이 부족합니다. (필요: ${formatCurrency(total)}${currencyUnit})`,\n            );\n          }\n          transaction.update(userRef, { cash: increment(total) });\n          transaction.update(teacherRef, { cash: increment(-total) });\n          logger.log(`만기 수령: 학생 +${total}, 선생님 -${total}`);\n        }\n\n        transaction.delete(productRef);\n        logger.log(\"상품 문서 삭제 예약\");\n        logger.log(\"트랜잭션 커밋 시도\");\n      });\n\n      logger.log(\"트랜잭션 성공\");\n\n      const successMsg = isLoan\n        ? `대출 상환 완료: ${formatCurrency(total)}${currencyUnit} (선생님 계정으로 이체)`\n        : `만기 수령 완료: ${formatCurrency(total)}${currencyUnit} (선생님 계정에서 지급)`;\n      displayMessage(successMsg, \"success\");\n\n      // 🔥 활동 로그 기록 (예금 만기 / 대출 상환)\n      const activityType = isLoan\n        ? ACTIVITY_TYPES.LOAN_REPAY\n        : ACTIVITY_TYPES.DEPOSIT_MATURITY;\n      logActivity(db, {\n        classCode: userDoc?.classCode,\n        userId: userId,\n        userName: userDoc?.name || \"사용자\",\n        type: activityType,\n        description: isLoan\n          ? `대출 만기 상환: ${name} (원금: ${formatCurrency(balance)}, 이자: ${formatCurrency(interest)}) - 선생님 계정으로`\n          : `${name} 만기 수령 (원금: ${formatCurrency(balance)}, 이자: ${formatCurrency(interest)}) - 선생님 계정에서`,\n        amount: isLoan ? -total : total,\n        metadata: {\n          productName: name,\n          productType: type,\n          principal: balance,\n          interest,\n          total,\n          teacherId: teacherAccountId,\n        },\n      });\n\n      // 백그라운드에서 userDoc 갱신\n      if (refreshUserDocument) {\n        logger.log(\"userDoc 갱신 시작\");\n        refreshUserDocument().then(() => {\n          logger.log(\"[ParkingAccount] 만기 처리 후 userDoc 갱신 완료\");\n        });\n      }\n\n      logger.log(\"전체 데이터 다시 로드\");\n      await loadAllData();\n    } catch (error) {\n      logger.error(\"만기 처리 중 오류 발생:\", error);\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\n      // 에러 발생 시 currentCash 롤백\n      if (userDoc?.cash !== undefined) {\n        logger.log(\"오류 발생으로 현금 롤백:\", userDoc.cash);\n        setCurrentCash(userDoc.cash);\n      }\n    } finally {\n      setIsProcessing(false);\n      logger.log(\"--- handleMaturity 종료 ---\");\n    }\n  };\n\n  // 중도 해지\n  const handleCancelEarly = async (product) => {\n    logger.log(\"--- handleCancelEarly 시작 ---\");\n    logger.log(\"중도 해지할 상품:\", product);\n\n    const { id, name, type, balance } = product;\n    const isLoan = type === \"loan\";\n\n    if (!userId) {\n      displayMessage(\"사용자 정보가 없습니다. 다시 로그인해주세요.\", \"error\");\n      logger.error(\"handleCancelEarly: userId가 없습니다.\");\n      return;\n    }\n\n    const confirmMessage = isLoan\n      ? `대출금 ${formatCurrency(balance)}${currencyUnit}을 상환하시겠습니까?`\n      : `'${name}'을(를) 중도 해지하시겠습니까? (이자 없이 원금만 반환됩니다)`;\n\n    if (!window.confirm(confirmMessage)) {\n      logger.log(\"사용자가 중도 해지를 취소했습니다.\");\n      return;\n    }\n\n    setIsProcessing(true);\n    logger.log(\"중도 해지 처리 시작...\");\n\n    // 선생님 계정 조회 (저장된 teacherId 사용 또는 새로 조회)\n    const teacherId = product.teacherId;\n    let teacherAccountId = teacherId;\n    if (!teacherAccountId) {\n      const teacherAccount = await getTeacherAccount(userDoc?.classCode);\n      if (!teacherAccount) {\n        displayMessage(\"선생님(은행) 계정을 찾을 수 없습니다.\", \"error\");\n        setIsProcessing(false);\n        return;\n      }\n      teacherAccountId = teacherAccount.id;\n    }\n    logger.log(\"선생님 계정 ID:\", teacherAccountId);\n\n    // --- 낙관적 업데이트 (Optimistic Update) ---\n    const originalProducts = {\n      deposit: [...userDeposits],\n      savings: [...userSavings],\n      loan: [...userLoans],\n    };\n    const originalCash = currentCash;\n\n    const cashChangeAmount = isLoan ? -balance : balance;\n    setCurrentCash((prev) => prev + cashChangeAmount);\n\n    if (type === \"deposit\") {\n      setUserDeposits((prev) => prev.filter((p) => p.id !== id));\n    } else if (type === \"savings\") {\n      setUserSavings((prev) => prev.filter((p) => p.id !== id));\n    } else if (type === \"loan\") {\n      setUserLoans((prev) => prev.filter((p) => p.id !== id));\n    }\n\n    try {\n      const productRef = doc(db, \"users\", userId, \"products\", String(id));\n      logger.log(\"Firestore 문서 참조:\", productRef.path);\n\n      await runTransaction(db, async (transaction) => {\n        logger.log(\"트랜잭션 시작\");\n        const userRef = doc(db, \"users\", userId);\n        const teacherRef = doc(db, \"users\", teacherAccountId);\n\n        const userSnapshot = await transaction.get(userRef);\n        const teacherSnapshot = await transaction.get(teacherRef);\n\n        if (!userSnapshot.exists())\n          throw new Error(\"사용자 정보를 찾을 수 없습니다.\");\n        if (!teacherSnapshot.exists())\n          throw new Error(\"선생님(은행) 계정을 찾을 수 없습니다.\");\n\n        const currentCashInDb = userSnapshot.data()?.cash ?? 0;\n        const teacherCashInDb = teacherSnapshot.data()?.cash ?? 0;\n        logger.log(\n          `현재 보유 현금 (DB): ${currentCashInDb}, 선생님 보유 현금: ${teacherCashInDb}`,\n        );\n\n        if (isLoan) {\n          // 대출 중도 상환: 학생 → 선생님 (원금만)\n          if (currentCashInDb < balance) {\n            throw new Error(\"대출금을 상환하기에 현금이 부족합니다.\");\n          }\n          transaction.update(userRef, { cash: increment(-balance) });\n          transaction.update(teacherRef, { cash: increment(balance) });\n          logger.log(`대출 중도 상환: 학생 -${balance}, 선생님 +${balance}`);\n        } else {\n          // 예금/적금 중도 해지: 선생님 → 학생 (원금만, 이자 없음)\n          if (teacherCashInDb < balance) {\n            throw new Error(\n              `은행(선생님)에 지급할 자금이 부족합니다. (필요: ${formatCurrency(balance)}${currencyUnit})`,\n            );\n          }\n          transaction.update(userRef, { cash: increment(balance) });\n          transaction.update(teacherRef, { cash: increment(-balance) });\n          logger.log(`중도 해지: 학생 +${balance}, 선생님 -${balance}`);\n        }\n\n        transaction.delete(productRef);\n        logger.log(\"상품 문서 삭제 예약\");\n        logger.log(\"트랜잭션 커밋 시도\");\n      });\n\n      logger.log(\"트랜잭션 성공\");\n\n      const successMsg = isLoan\n        ? `대출 상환 완료: ${formatCurrency(balance)}${currencyUnit} (선생님 계정으로 이체)`\n        : `중도 해지 완료: 원금 ${formatCurrency(balance)}${currencyUnit} 반환 (선생님 계정에서 지급)`;\n      displayMessage(successMsg, \"success\");\n\n      // 🔥 활동 로그 기록 (중도 해지 / 대출 상환)\n      const activityType = isLoan\n        ? ACTIVITY_TYPES.LOAN_REPAY\n        : ACTIVITY_TYPES.DEPOSIT_WITHDRAW;\n      logActivity(db, {\n        classCode: userDoc?.classCode,\n        userId: userId,\n        userName: userDoc?.name || \"사용자\",\n        type: activityType,\n        description: isLoan\n          ? `대출 중도 상환: ${name} (${formatCurrency(balance)}원) - 선생님 계정으로`\n          : `중도 해지: ${name} (원금 ${formatCurrency(balance)}원) - 선생님 계정에서`,\n        amount: cashChangeAmount,\n        metadata: {\n          productName: name,\n          productType: type,\n          principal: balance,\n          isEarlyCancellation: true,\n          teacherId: teacherAccountId,\n        },\n      });\n\n      // 백그라운드에서 userDoc 갱신\n      if (refreshUserDocument) {\n        logger.log(\"userDoc 갱신 시작\");\n        refreshUserDocument();\n      }\n      await loadAllData();\n    } catch (error) {\n      logger.error(\"중도 해지 처리 중 오류 발생:\", error);\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\n\n      // --- 낙관적 업데이트 롤백 ---\n      setUserDeposits(originalProducts.deposit);\n      setUserSavings(originalProducts.savings);\n      setUserLoans(originalProducts.loan);\n      setCurrentCash(originalCash);\n    } finally {\n      setIsProcessing(false);\n      logger.log(\"--- handleCancelEarly 종료 ---\");\n    }\n  };\n\n  const handleParkingDeposit = async (amountStr) => {\n    const amount = parseFloat(amountStr);\n    if (isNaN(amount) || amount <= 0)\n      return displayMessage(\"유효한 금액을 입력하세요.\", \"error\");\n\n    setIsProcessing(true);\n    const previousParkingBalance = parkingBalance; // Store for rollback\n    const previousCurrentCash = currentCash; // Store for rollback\n\n    // Optimistically update UI for parking balance\n    setParkingBalance((prev) => prev + amount);\n\n    try {\n      // 먼저 사용자 현금 차감 (AuthContext의 deductCash 사용)\n      const cashDeducted = await deductCash(\n        amount,\n        `파킹통장 입금: ${formatCurrency(amount)}원`,\n      );\n      if (!cashDeducted) {\n        throw new Error(\"보유 현금 차감에 실패했습니다.\");\n      }\n\n      await runTransaction(db, async (transaction) => {\n        const parkingRef = doc(\n          db,\n          \"users\",\n          userId,\n          \"financials\",\n          \"parkingAccount\",\n        );\n        const parkingSnapshot = await transaction.get(parkingRef);\n\n        if (parkingSnapshot.exists()) {\n          transaction.update(parkingRef, { balance: increment(amount) });\n        } else {\n          transaction.set(parkingRef, {\n            balance: amount,\n            lastInterestDate: serverTimestamp(),\n          });\n        }\n      });\n\n      displayMessage(\n        `${formatCurrency(amount)}${currencyUnit} 입금 완료.`,\n        \"success\",\n      );\n\n      // 🔥 활동 로그 기록 (파킹통장 입금)\n      logActivity(db, {\n        classCode: userDoc?.classCode,\n        userId: userId,\n        userName: userDoc?.name || \"사용자\",\n        type: ACTIVITY_TYPES.PARKING_DEPOSIT,\n        description: `파킹통장 입금 ${formatCurrency(amount)}원`,\n        amount: -amount,\n        metadata: { parkingBalance: parkingBalance + amount },\n      });\n\n      await loadAllData(); // Reconcile parkingBalance and other products\n    } catch (error) {\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\n      // Rollback UI on error\n      setParkingBalance(previousParkingBalance);\n      setCurrentCash(previousCurrentCash);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleParkingWithdraw = async (amountStr) => {\n    const amount = parseFloat(amountStr);\n    if (isNaN(amount) || amount <= 0)\n      return displayMessage(\"유효한 금액을 입력하세요.\", \"error\");\n\n    setIsProcessing(true);\n    const previousParkingBalance = parkingBalance; // Store for rollback\n    const previousCurrentCash = currentCash; // Store for rollback\n\n    // Optimistically update UI for parking balance\n    setParkingBalance((prev) => prev - amount);\n\n    try {\n      await runTransaction(db, async (transaction) => {\n        const parkingRef = doc(\n          db,\n          \"users\",\n          userId,\n          \"financials\",\n          \"parkingAccount\",\n        );\n        const parkingSnapshot = await transaction.get(parkingRef);\n        const currentParkingBalance = parkingSnapshot.data()?.balance ?? 0;\n\n        if (currentParkingBalance < amount)\n          throw new Error(\"파킹통장 잔액이 부족합니다.\");\n\n        transaction.update(parkingRef, { balance: increment(-amount) });\n      });\n\n      // 사용자 현금 추가 (AuthContext의 addCash 사용)\n      const cashAdded = await addCash(\n        amount,\n        `파킹통장 출금: ${formatCurrency(amount)}원`,\n      );\n      if (!cashAdded) {\n        throw new Error(\"보유 현금 추가에 실패했습니다.\");\n      }\n\n      displayMessage(\n        `${formatCurrency(amount)}${currencyUnit} 출금 완료.`,\n        \"success\",\n      );\n\n      // 🔥 활동 로그 기록 (파킹통장 출금)\n      logActivity(db, {\n        classCode: userDoc?.classCode,\n        userId: userId,\n        userName: userDoc?.name || \"사용자\",\n        type: ACTIVITY_TYPES.PARKING_WITHDRAW,\n        description: `파킹통장 출금 ${formatCurrency(amount)}원`,\n        amount: amount,\n        metadata: { parkingBalance: parkingBalance - amount },\n      });\n\n      await loadAllData(); // Reconcile parkingBalance and other products\n    } catch (error) {\n      displayMessage(`처리 오류: ${error.message}`, \"error\");\n      // Rollback UI on error\n      setParkingBalance(previousParkingBalance);\n      setCurrentCash(previousCurrentCash);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleAdminDeleteSubscribedProduct = async (product) => {\n    if (!isAdmin()) {\n      displayMessage(\"관리자 권한이 필요합니다.\", \"error\");\n      return;\n    }\n\n    if (\n      !window.confirm(\n        `정말로 이 상품(${product.name})을 강제로 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`,\n      )\n    ) {\n      return;\n    }\n\n    setIsProcessing(true);\n    try {\n      const productRef = doc(\n        db,\n        \"users\",\n        product.userId,\n        \"products\",\n        product.id,\n      );\n      await deleteDoc(productRef);\n      displayMessage(\"상품이 강제로 삭제되었습니다.\", \"success\");\n      loadAllData();\n    } catch (error) {\n      logger.error(\"관리자 상품 삭제 중 오류:\", error);\n      displayMessage(`삭제 처리 오류: ${error.message}`, \"error\");\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  if (loading)\n    return (\n      <div className={cls.container}>금융 정보를 불러오는 중입니다...</div>\n    );\n  if (!user) return <div className={cls.container}>로그인이 필요합니다.</div>;\n\n  const mainTabClass = (isActive) =>\n    `px-6 py-3 border-none cursor-pointer text-[17px] rounded-t-lg transition-all duration-200 -mb-0.5 ${\n      isActive\n        ? \"bg-cyber-cyan/10 font-bold text-cyber-cyan border-b-[3px] border-b-cyber-cyan\"\n        : \"font-medium text-slate-400 border-b-[3px] border-b-transparent\"\n    }`;\n\n  return (\n    <div className={cls.container}>\n      {/* 탭 메뉴 */}\n      <div className=\"flex gap-2.5 mb-6 border-b-2 border-white/10 relative\">\n        <button\n          onClick={() => onViewChange && onViewChange(\"parking\")}\n          className={mainTabClass(activeView === \"parking\")}\n        >\n          나의 금융 현황\n        </button>\n        {isAdmin && isAdmin() && (\n          <>\n            <button\n              onClick={() => onViewChange && onViewChange(\"admin\")}\n              className={mainTabClass(activeView === \"admin\")}\n            >\n              상품 관리\n            </button>\n            <button\n              onClick={() => {\n                if (onViewChange) onViewChange(\"userProducts\");\n                if (onLoadUserProducts) onLoadUserProducts();\n              }}\n              className={mainTabClass(activeView === \"userProducts\")}\n            >\n              유저 상품 조회\n            </button>\n          </>\n        )}\n      </div>\n\n      {message && <div className={cls.message(messageType)}>{message}</div>}\n\n      {/* 유저 상품 조회 화면 */}\n      {activeView === \"userProducts\" && isAdmin && isAdmin() && (\n        <div className=\"bg-[rgba(20,20,35,0.6)] rounded-2xl p-8 shadow-[0_6px_20px_rgba(0,0,0,0.3)] border border-white/5\">\n          <h2 className=\"text-2xl font-bold mb-4 text-white\">\n            유저별 가입 상품 조회 및 관리\n          </h2>\n          <p className=\"text-sm text-slate-400 mb-5\">\n            클래스 내 모든 유저의 가입 상품을 조회하고 필요시 강제 삭제할 수\n            있습니다.\n          </p>\n\n          {allUserProducts.length === 0 ? (\n            <p className=\"text-center p-10 text-slate-400\">\n              가입된 상품이 없습니다.\n            </p>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full border-collapse\">\n                <thead>\n                  <tr className=\"bg-white/5 border-b-2 border-white/10\">\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">\n                      사용자\n                    </th>\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">\n                      상품명\n                    </th>\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">\n                      종류\n                    </th>\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">\n                      잔액/금액\n                    </th>\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">\n                      금리(일)\n                    </th>\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">\n                      기간(일)\n                    </th>\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">\n                      만기일\n                    </th>\n                    <th className=\"p-3 text-left text-sm font-semibold text-slate-400\">\n                      관리\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {allUserProducts.map((product, index) => {\n                    const typeLabel =\n                      product.type === \"deposit\"\n                        ? \"예금\"\n                        : product.type === \"savings\"\n                          ? \"적금\"\n                          : product.type === \"loan\"\n                            ? \"대출\"\n                            : \"기타\";\n                    return (\n                      <tr\n                        key={`${product.userId}-${product.id}-${index}`}\n                        className=\"border-b border-white/5\"\n                      >\n                        <td className=\"p-3 text-sm text-slate-200\">\n                          {product.userName}\n                        </td>\n                        <td className=\"p-3 text-sm text-slate-200\">\n                          {product.name}\n                        </td>\n                        <td className=\"p-3 text-sm text-slate-200\">\n                          {typeLabel}\n                        </td>\n                        <td className=\"p-3 text-sm text-cyber-cyan\">\n                          {formatKoreanCurrency(product.balance || 0)}\n                        </td>\n                        <td className=\"p-3 text-sm text-slate-200\">\n                          {product.rate}%\n                        </td>\n                        <td className=\"p-3 text-sm text-slate-200\">\n                          {product.termInDays}일\n                        </td>\n                        <td className=\"p-3 text-sm text-slate-200\">\n                          {product.maturityDate\n                            ? new Date(product.maturityDate).toLocaleDateString(\n                                \"ko-KR\",\n                              )\n                            : \"-\"}\n                        </td>\n                        <td className=\"p-3\">\n                          <button\n                            onClick={() =>\n                              onDeleteUserProduct &&\n                              onDeleteUserProduct(product)\n                            }\n                            className={\n                              cls.button(false, \"danger\") +\n                              \" text-xs px-3 py-1.5\"\n                            }\n                          >\n                            삭제\n                          </button>\n                        </td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n              <div className=\"mt-5 text-right text-slate-400 text-sm\">\n                총 {allUserProducts.length}개의 상품\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* 기존 금융 현황 화면 */}\n      {activeView === \"parking\" && (\n        <div className={cls.grid}>\n          <ParkingAccountSection\n            balance={parkingBalance}\n            dailyInterest={parkingDailyInterest}\n            onDeposit={handleParkingDeposit}\n            onWithdraw={handleParkingWithdraw}\n            isProcessing={isProcessing}\n            userCash={currentCash}\n          />\n          <ProductSection\n            title=\"예금\"\n            icon={ICON_MAP.deposits}\n            subscribedProducts={userDeposits}\n            availableProducts={depositProducts}\n            onSubscribe={(p) => handleOpenModal(p, \"deposits\")}\n            onCancel={handleCancelEarly}\n            onMaturity={handleMaturity}\n            isAdmin={isAdmin()}\n            onAdminDelete={handleAdminDeleteSubscribedProduct}\n          />\n          <ProductSection\n            title=\"적금\"\n            icon={ICON_MAP.savings}\n            subscribedProducts={userSavings}\n            availableProducts={installmentProducts}\n            onSubscribe={(p) => handleOpenModal(p, \"savings\")}\n            onCancel={handleCancelEarly}\n            onMaturity={handleMaturity}\n            isAdmin={isAdmin()}\n            onAdminDelete={handleAdminDeleteSubscribedProduct}\n          />\n          <ProductSection\n            title=\"대출\"\n            icon={ICON_MAP.loans}\n            subscribedProducts={userLoans}\n            availableProducts={loanProducts}\n            onSubscribe={(p) => handleOpenModal(p, \"loans\")}\n            onCancel={handleCancelEarly}\n            onMaturity={handleMaturity}\n            isAdmin={isAdmin()}\n            onAdminDelete={handleAdminDeleteSubscribedProduct}\n          />\n        </div>\n      )}\n      <SubscriptionModal\n        isOpen={modal.isOpen}\n        onClose={handleCloseModal}\n        product={modal.product}\n        onConfirm={handleSubscribe}\n        isProcessing={isProcessing}\n      />\n    </div>\n  );\n};\n\nexport default ParkingAccount;\n","// src/Banking.js - Tailwind UI 리팩토링\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { useAuth } from \"../../contexts/AuthContext\";\nimport ParkingAccount from \"./ParkingAccount\";\nimport { getBankingProducts, updateBankingProducts, db } from \"../../firebase\";\nimport {\n  collection,\n  query,\n  where,\n  getDocs,\n  doc,\n  deleteDoc,\n} from \"firebase/firestore\";\nimport { PageContainer, PageHeader } from \"../../components/PageWrapper\";\nimport { Landmark, ChevronLeft } from \"lucide-react\";\nimport { AlchanLoading } from \"../../components/AlchanLayout\";\nimport { useCurrency } from \"../../contexts/CurrencyContext\";\nimport \"./Banking.css\";\nimport { logger } from \"../../utils/logger\";\n\nconst convertAdminProductsToAccountFormat = (adminProducts) => {\n  if (!Array.isArray(adminProducts)) {\n    logger.error(\n      \"convertAdminProductsToAccountFormat: 입력값이 배열이 아닙니다.\",\n      adminProducts,\n    );\n    return [];\n  }\n  return adminProducts.map((product) => ({\n    id: product.id,\n    name: product.name,\n    dailyRate:\n      product.dailyRate !== undefined && !isNaN(product.dailyRate)\n        ? parseFloat(product.dailyRate)\n        : 0,\n    termInDays:\n      product.termInDays !== undefined && !isNaN(product.termInDays)\n        ? parseInt(product.termInDays)\n        : 1,\n    minAmount:\n      product.minAmount !== undefined && !isNaN(product.minAmount)\n        ? parseInt(product.minAmount)\n        : 0,\n    maxAmount:\n      product.maxAmount !== undefined && !isNaN(product.maxAmount)\n        ? parseInt(product.maxAmount)\n        : 0,\n  }));\n};\n\nconst Banking = () => {\n  const auth = useAuth();\n  const { currencyUnit } = useCurrency();\n  const [message, setMessage] = useState(null);\n  const [messageType, setMessageType] = useState(\"\");\n  const [activeView, setActiveView] = useState(\"parking\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  const [parkingDepositProducts, setParkingDepositProducts] = useState([]);\n  const [parkingInstallmentProducts, setParkingInstallmentProducts] = useState(\n    [],\n  );\n  const [parkingLoanProducts, setParkingLoanProducts] = useState([]);\n\n  // 유저별 가입 상품 관리\n  const [allUserProducts, setAllUserProducts] = useState([]);\n\n  // 모든 유저의 가입 상품 로드\n  const loadAllUserProducts = async () => {\n    if (\n      !auth?.userDoc?.classCode ||\n      !(auth.userDoc?.isAdmin || auth.userDoc?.role === \"admin\")\n    ) {\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      // 먼저 해당 클래스의 모든 유저 조회\n      const usersQuery = query(\n        collection(db, \"users\"),\n        where(\"classCode\", \"==\", auth.userDoc.classCode),\n      );\n      const usersSnapshot = await getDocs(usersQuery);\n\n      const userMap = {};\n      usersSnapshot.forEach((doc) => {\n        userMap[doc.id] = {\n          id: doc.id,\n          name: doc.data().name || doc.data().nickname || \"알 수 없음\",\n          ...doc.data(),\n        };\n      });\n\n      // 🔥 [최적화] 각 유저의 상품 조회 - 병렬 처리로 N+1 문제 해결\n      const allProducts = [];\n      const userIds = Object.keys(userMap);\n\n      // 모든 유저의 products를 병렬로 조회 (순차 대신 Promise.all 사용)\n      const productPromises = userIds.map(async (userId) => {\n        const productsQuery = collection(db, \"users\", userId, \"products\");\n        const productsSnapshot = await getDocs(productsQuery);\n\n        return productsSnapshot.docs.map((productDoc) => {\n          const productData = productDoc.data();\n          return {\n            firestoreId: productDoc.id, // 실제 Firestore 문서 ID\n            userId: userId,\n            userName: userMap[userId].name,\n            ...productData,\n            maturityDate: productData.maturityDate?.toDate\n              ? productData.maturityDate.toDate()\n              : productData.maturityDate,\n          };\n        });\n      });\n\n      // 모든 Promise가 완료될 때까지 대기\n      const productsArrays = await Promise.all(productPromises);\n\n      // 2D 배열을 1D 배열로 평탄화\n      productsArrays.forEach((productsArray) => {\n        allProducts.push(...productsArray);\n      });\n\n      setAllUserProducts(allProducts);\n      logger.log(\"유저 상품 로드 완료:\", allProducts);\n    } catch (error) {\n      logger.error(\"유저 상품 로드 중 오류:\", error);\n      setMessage(\"유저 상품 로드 중 오류가 발생했습니다.\");\n      setMessageType(\"error\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // 관리자가 유저 상품 강제 삭제\n  const handleAdminDeleteUserProduct = async (product) => {\n    logger.log(\"삭제 시도:\", product);\n\n    if (!(auth.userDoc?.isAdmin || auth.userDoc?.role === \"admin\")) {\n      logger.log(\"관리자 권한 없음\");\n      alert(\"관리자 권한이 필요합니다.\");\n      return;\n    }\n\n    if (\n      !window.confirm(\n        `'${product.userName}'님의 '${product.name}' 상품을 강제로 삭제하시겠습니까?\\n이 작업은 되돌릴 수 없습니다.`,\n      )\n    ) {\n      logger.log(\"사용자가 삭제 취소\");\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      // firestoreId를 사용 (실제 Firestore 문서 ID)\n      const productId = product.firestoreId || String(product.id);\n      logger.log(\"삭제 경로:\", `users/${product.userId}/products/${productId}`);\n      logger.log(\"사용할 문서 ID:\", productId);\n\n      const productRef = doc(\n        db,\n        \"users\",\n        product.userId,\n        \"products\",\n        productId,\n      );\n      logger.log(\"삭제 시작...\");\n      await deleteDoc(productRef);\n      logger.log(\"삭제 완료\");\n\n      setMessage(\"상품이 삭제되었습니다.\");\n      setMessageType(\"success\");\n\n      // 목록 새로고침\n      logger.log(\"목록 새로고침 시작...\");\n      await loadAllUserProducts();\n      logger.log(\"목록 새로고침 완료\");\n\n      setTimeout(() => {\n        setMessage(null);\n        setMessageType(\"\");\n      }, 3000);\n    } catch (error) {\n      logger.error(\"상품 삭제 중 오류:\", error);\n      setMessage(`삭제 중 오류가 발생했습니다: ${error.message}`);\n      setMessageType(\"error\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const formattedDepositProducts = useMemo(\n    () => convertAdminProductsToAccountFormat(parkingDepositProducts),\n    [parkingDepositProducts],\n  );\n  const formattedInstallmentProducts = useMemo(\n    () => convertAdminProductsToAccountFormat(parkingInstallmentProducts),\n    [parkingInstallmentProducts],\n  );\n  const formattedLoanProducts = useMemo(\n    () => convertAdminProductsToAccountFormat(parkingLoanProducts),\n    [parkingLoanProducts],\n  );\n\n  // Firestore에서 데이터 로드\n  const loadAllData = async () => {\n    const classCode = auth?.userDoc?.classCode;\n    if (!classCode || classCode === \"미지정\") {\n      logger.warn(\n        \"[Banking] 유효한 학급 코드가 없어 뱅킹 상품을 로드하지 않습니다.\",\n      );\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const bankingData = await getBankingProducts(classCode, true, \"Banking\");\n\n      // deposits를 savings로 매핑 (예금 상품)\n      if (bankingData.deposits) {\n        setParkingDepositProducts(bankingData.deposits);\n      } else {\n        setParkingDepositProducts([]);\n      }\n\n      // savings를 installments로 매핑 (적금 상품)\n      if (bankingData.savings) {\n        setParkingInstallmentProducts(bankingData.savings);\n      } else {\n        setParkingInstallmentProducts([]);\n      }\n\n      // loans는 그대로 매핑 (대출 상품)\n      if (bankingData.loans) {\n        setParkingLoanProducts(bankingData.loans);\n      } else {\n        setParkingLoanProducts([]);\n      }\n    } catch (error) {\n      logger.error(\"뱅킹 상품 로드 중 오류:\", error);\n      setMessage(\"데이터 로딩 중 오류가 발생했습니다.\");\n      setMessageType(\"error\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (auth && !auth.loading && auth.user && auth.userDoc?.classCode) {\n      loadAllData();\n    } else if (auth && !auth.loading && !auth.user) {\n      setParkingDepositProducts([]);\n      setParkingInstallmentProducts([]);\n      setParkingLoanProducts([]);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [auth?.user, auth?.loading, auth?.userDoc?.classCode]); // loadAllData 추가하면 무한루프, auth 객체 전체 추가도 불필요한 리렌더링 발생\n\n  const handleParkingProductChange = (type, index, field, value) => {\n    let productsState, setProductsState;\n    switch (type) {\n      case \"deposits\":\n        productsState = parkingDepositProducts;\n        setProductsState = setParkingDepositProducts;\n        break;\n      case \"installments\":\n        productsState = parkingInstallmentProducts;\n        setProductsState = setParkingInstallmentProducts;\n        break;\n      case \"loans\":\n        productsState = parkingLoanProducts;\n        setProductsState = setParkingLoanProducts;\n        break;\n      default:\n        return;\n    }\n\n    const updatedProducts = productsState.map((product, i) => {\n      if (i === index) {\n        const updatedProduct = { ...product };\n        if (\n          field === \"termInDays\" ||\n          field === \"minAmount\" ||\n          field === \"maxAmount\"\n        ) {\n          const numValue = parseInt(value);\n          updatedProduct[field] =\n            isNaN(numValue) || numValue < (field === \"termInDays\" ? 1 : 0)\n              ? field === \"termInDays\"\n                ? 1\n                : 0\n              : numValue;\n        } else if (field === \"dailyRate\") {\n          const dailyRateValue = parseFloat(value);\n          updatedProduct.dailyRate =\n            isNaN(dailyRateValue) || dailyRateValue < 0 ? 0 : dailyRateValue;\n        } else if (field === \"name\") {\n          updatedProduct[field] = value;\n        }\n        return updatedProduct;\n      }\n      return product;\n    });\n    setProductsState(updatedProducts);\n  };\n\n  const saveParkingProducts = async (type) => {\n    if (!auth?.userDoc?.classCode) {\n      setMessage(\"학급 코드가 없어 저장할 수 없습니다.\");\n      setMessageType(\"error\");\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      let products, firestoreType;\n\n      switch (type) {\n        case \"deposits\":\n          products = parkingDepositProducts;\n          firestoreType = \"deposits\"; // Firebase에서는 deposits로 저장\n          break;\n        case \"installments\":\n          products = parkingInstallmentProducts;\n          firestoreType = \"savings\"; // Firebase에서는 savings로 저장\n          break;\n        case \"loans\":\n          products = parkingLoanProducts;\n          firestoreType = \"loans\";\n          break;\n        default:\n          return;\n      }\n\n      await updateBankingProducts(\n        auth.userDoc.classCode,\n        firestoreType,\n        products,\n      );\n\n      setMessage(\n        `${\n          type === \"deposits\"\n            ? \"예금\"\n            : type === \"installments\"\n              ? \"적금\"\n              : \"대출\"\n        } 상품이 성공적으로 저장되었습니다.`,\n      );\n      setMessageType(\"success\");\n\n      setTimeout(() => {\n        setMessage(null);\n        setMessageType(\"\");\n      }, 3000);\n    } catch (error) {\n      logger.error(`${type} 상품 저장 중 오류:`, error);\n      setMessage(\"저장 중 오류가 발생했습니다.\");\n      setMessageType(\"error\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const addParkingProduct = (type) => {\n    const newProduct = {\n      id: Date.now(),\n      name: `새 ${\n        type === \"deposits\" ? \"예금\" : type === \"installments\" ? \"적금\" : \"대출\"\n      } 상품`,\n      dailyRate: 0.01,\n      termInDays: 365,\n      minAmount: type === \"loans\" ? 0 : 100000,\n      maxAmount: type === \"loans\" ? 1000000 : 0,\n    };\n\n    switch (type) {\n      case \"deposits\":\n        setParkingDepositProducts([...parkingDepositProducts, newProduct]);\n        break;\n      case \"installments\":\n        setParkingInstallmentProducts([\n          ...parkingInstallmentProducts,\n          newProduct,\n        ]);\n        break;\n      case \"loans\":\n        setParkingLoanProducts([...parkingLoanProducts, newProduct]);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const deleteParkingProduct = async (type, indexToDelete) => {\n    if (isLoading) return; // 중복 클릭 방지\n\n    let productsState, setProductsState;\n    switch (type) {\n      case \"deposits\":\n        productsState = parkingDepositProducts;\n        setProductsState = setParkingDepositProducts;\n        break;\n      case \"installments\":\n        productsState = parkingInstallmentProducts;\n        setProductsState = setParkingInstallmentProducts;\n        break;\n      case \"loans\":\n        productsState = parkingLoanProducts;\n        setProductsState = setParkingLoanProducts;\n        break;\n      default:\n        return;\n    }\n\n    const updatedProducts = productsState.filter(\n      (_, index) => index !== indexToDelete,\n    );\n    setProductsState(updatedProducts);\n\n    // 삭제 후 자동 저장\n    if (auth?.userDoc?.classCode) {\n      setIsLoading(true);\n      try {\n        const firestoreType =\n          type === \"deposits\"\n            ? \"deposits\"\n            : type === \"installments\"\n              ? \"savings\"\n              : \"loans\";\n        await updateBankingProducts(\n          auth.userDoc.classCode,\n          firestoreType,\n          updatedProducts,\n        );\n        setMessage(\"상품이 삭제되었습니다.\");\n        setMessageType(\"info\");\n        setTimeout(() => {\n          setMessage(null);\n          setMessageType(\"\");\n        }, 2000);\n      } catch (error) {\n        logger.error(\"상품 삭제 중 오류:\", error);\n        setMessage(\"삭제 중 오류가 발생했습니다.\");\n        setMessageType(\"error\");\n        // 삭제 실패 시 원래 상태로 되돌릴 수 있습니다 (선택적)\n        setProductsState(productsState);\n      } finally {\n        setIsLoading(false);\n      }\n    }\n  };\n\n  if (auth.loading) {\n    return <AlchanLoading />;\n  }\n\n  return (\n    <PageContainer>\n      {/* 로딩 오버레이 */}\n      {isLoading && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n          <AlchanLoading />\n        </div>\n      )}\n\n      <div className=\"px-4 py-6 sm:px-6\">\n        {/* 페이지 헤더 */}\n        <PageHeader\n          title=\"통합 금융 관리\"\n          subtitle=\"예금, 적금, 대출 상품을 관리하세요\"\n          icon={Landmark}\n        />\n\n        {/* 메시지 표시 */}\n        {message && (\n          <div\n            className={`mb-4 p-4 rounded-xl ${\n              messageType === \"error\"\n                ? \"bg-red-900/40 text-red-200 border border-red-800/50\"\n                : messageType === \"success\"\n                  ? \"bg-emerald-900/40 text-emerald-200 border border-emerald-800/50\"\n                  : \"bg-blue-900/40 text-blue-200 border border-blue-800/50\"\n            }`}\n          >\n            {message}\n          </div>\n        )}\n\n        <div className={activeView === \"admin\" ? \"content-box\" : \"\"}>\n          {(activeView === \"parking\" || activeView === \"userProducts\") && (\n            <ParkingAccount\n              auth={auth}\n              depositProducts={formattedDepositProducts}\n              installmentProducts={formattedInstallmentProducts}\n              loanProducts={formattedLoanProducts}\n              activeView={activeView}\n              onViewChange={setActiveView}\n              onLoadUserProducts={loadAllUserProducts}\n              allUserProducts={allUserProducts}\n              onDeleteUserProduct={handleAdminDeleteUserProduct}\n              isLoading={isLoading}\n            />\n          )}\n          {activeView === \"admin\" &&\n            auth.user &&\n            (auth.userDoc?.isAdmin || auth.userDoc?.role === \"admin\") && (\n              <div>\n                <div className=\"flex items-center gap-4 mb-4\">\n                  <button\n                    onClick={() => setActiveView(\"parking\")}\n                    className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-cyber-cyan/10 border border-cyber-cyan/40 text-cyber-cyan hover:bg-cyber-cyan/20 hover:text-white transition-all text-sm font-semibold shadow-[0_0_8px_rgba(0,243,255,0.15)]\"\n                  >\n                    <ChevronLeft size={16} />\n                    은행으로 돌아가기\n                  </button>\n                </div>\n                <h2 className=\"admin-header\">\n                  관리자 - 금융 상품 관리 (일 복리 기준)\n                </h2>\n                {/* Savings Products */}\n                <div className=\"admin-section\">\n                  <h3>파킹 예금 상품</h3>\n                  <p className=\"admin-info-text\">\n                    일 이율(%)과 기간(일)을 입력합니다. 변경 후 '저장' 버튼을\n                    클릭하세요.\n                  </p>\n                  <table className=\"admin-table\">\n                    <thead>\n                      <tr>\n                        <th style={{ width: \"25%\" }}>상품명</th>\n                        <th style={{ width: \"15%\" }}>기간(일)</th>\n                        <th style={{ width: \"18%\" }}>일 이율(%)</th>\n                        <th style={{ width: \"18%\" }}>\n                          최소금액({currencyUnit})\n                        </th>\n                        <th style={{ width: \"12%\" }}>관리</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {parkingDepositProducts.map((p, index) => (\n                        <tr key={p.id}>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"text\"\n                              value={p.name || \"\"}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"deposits\",\n                                  index,\n                                  \"name\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"1\"\n                              value={p.termInDays || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"deposits\",\n                                  index,\n                                  \"termInDays\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              step=\"0.001\"\n                              min=\"0\"\n                              value={p.dailyRate || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"deposits\",\n                                  index,\n                                  \"dailyRate\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              placeholder=\"예: 0.01\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"0\"\n                              value={p.minAmount || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"deposits\",\n                                  index,\n                                  \"minAmount\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <button\n                              onClick={() =>\n                                deleteParkingProduct(\"deposits\", index)\n                              }\n                              className={`admin-button-small delete-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                              disabled={isLoading}\n                            >\n                              삭제\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                  <div className=\"admin-action-buttons\">\n                    <button\n                      onClick={() => addParkingProduct(\"deposits\")}\n                      className={`admin-button-small add-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      추가\n                    </button>\n                    <button\n                      onClick={() => saveParkingProducts(\"deposits\")}\n                      className={`admin-button-small save-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      예금 상품 저장\n                    </button>\n                  </div>\n                </div>\n\n                {/* Installment Products */}\n                <div className=\"admin-section\">\n                  <h3>파킹 적금 상품</h3>\n                  <p className=\"admin-info-text\">\n                    일 이율(%)과 기간(일)을 입력합니다. 변경 후 '저장' 버튼을\n                    클릭하세요.\n                  </p>\n                  <table className=\"admin-table\">\n                    <thead>\n                      <tr>\n                        <th style={{ width: \"25%\" }}>상품명</th>\n                        <th style={{ width: \"15%\" }}>기간(일)</th>\n                        <th style={{ width: \"18%\" }}>일 이율(%)</th>\n                        <th style={{ width: \"18%\" }}>\n                          최소 월납입({currencyUnit})\n                        </th>\n                        <th style={{ width: \"12%\" }}>관리</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {parkingInstallmentProducts.map((p, index) => (\n                        <tr key={p.id}>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"text\"\n                              value={p.name || \"\"}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"installments\",\n                                  index,\n                                  \"name\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"1\"\n                              value={p.termInDays || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"installments\",\n                                  index,\n                                  \"termInDays\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              step=\"0.001\"\n                              min=\"0\"\n                              value={p.dailyRate || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"installments\",\n                                  index,\n                                  \"dailyRate\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              placeholder=\"예: 0.011\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"0\"\n                              value={p.minAmount || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"installments\",\n                                  index,\n                                  \"minAmount\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <button\n                              onClick={() =>\n                                deleteParkingProduct(\"installments\", index)\n                              }\n                              className={`admin-button-small delete-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                              disabled={isLoading}\n                            >\n                              삭제\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                  <div className=\"admin-action-buttons\">\n                    <button\n                      onClick={() => addParkingProduct(\"installments\")}\n                      className={`admin-button-small add-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      추가\n                    </button>\n                    <button\n                      onClick={() => saveParkingProducts(\"installments\")}\n                      className={`admin-button-small save-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      적금 상품 저장\n                    </button>\n                  </div>\n                </div>\n\n                {/* Loan Products */}\n                <div className=\"admin-section\" style={{ borderBottom: \"none\" }}>\n                  <h3>파킹 대출 상품</h3>\n                  <p className=\"admin-info-text\">\n                    일 이율(%)과 기간(일)을 입력합니다. 변경 후 '저장' 버튼을\n                    클릭하세요.\n                  </p>\n                  <table className=\"admin-table\">\n                    <thead>\n                      <tr>\n                        <th style={{ width: \"25%\" }}>상품명</th>\n                        <th style={{ width: \"15%\" }}>기간(일)</th>\n                        <th style={{ width: \"18%\" }}>일 이율(%)</th>\n                        <th style={{ width: \"18%\" }}>\n                          최대 대출액({currencyUnit})\n                        </th>\n                        <th style={{ width: \"12%\" }}>관리</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {parkingLoanProducts.map((p, index) => (\n                        <tr key={p.id}>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"text\"\n                              value={p.name || \"\"}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"loans\",\n                                  index,\n                                  \"name\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"1\"\n                              value={p.termInDays || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"loans\",\n                                  index,\n                                  \"termInDays\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              step=\"0.001\"\n                              min=\"0\"\n                              value={p.dailyRate || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"loans\",\n                                  index,\n                                  \"dailyRate\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              placeholder=\"예: 0.05\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <input\n                              type=\"number\"\n                              min=\"0\"\n                              value={p.maxAmount || 0}\n                              onChange={(e) =>\n                                handleParkingProductChange(\n                                  \"loans\",\n                                  index,\n                                  \"maxAmount\",\n                                  e.target.value,\n                                )\n                              }\n                              className=\"admin-input\"\n                              disabled={isLoading}\n                              style={{\n                                backgroundColor: \"rgba(255,255,255,0.05)\",\n                                color: \"#fff\",\n                                border: \"1px solid rgba(255,255,255,0.1)\",\n                              }}\n                            />\n                          </td>\n                          <td className=\"admin-td\">\n                            <button\n                              onClick={() =>\n                                deleteParkingProduct(\"loans\", index)\n                              }\n                              className={`admin-button-small delete-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                              disabled={isLoading}\n                            >\n                              삭제\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                  <div className=\"admin-action-buttons\">\n                    <button\n                      onClick={() => addParkingProduct(\"loans\")}\n                      className={`admin-button-small add-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      추가\n                    </button>\n                    <button\n                      onClick={() => saveParkingProducts(\"loans\")}\n                      className={`admin-button-small save-button ${isLoading ? \"disabled-button\" : \"\"}`}\n                      disabled={isLoading}\n                    >\n                      대출 상품 저장\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n          {activeView === \"admin\" &&\n            !(\n              auth.user &&\n              (auth.userDoc?.isAdmin || auth.userDoc?.role === \"admin\")\n            ) && (\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300 p-4 rounded-xl border border-yellow-200 dark:border-yellow-800\">\n                관리자 권한이 필요합니다.\n              </div>\n            )}\n        </div>\n      </div>\n    </PageContainer>\n  );\n};\n\nexport default Banking;\n"],"names":["PageContainer","_ref","children","className","_jsx","concat","PageHeader","_ref2","title","subtitle","icon","Icon","badge","action","backButton","_jsxs","LoadingState","_ref4","message","EmptyState","_ref6","description","ActionButton","_ref1","variant","size","loading","disabled","onClick","primary","secondary","outline","danger","success","ghost","indigo","sm","md","lg","Loader2","getTeacherAccount","async","classCode","usersRef","collection","db","q","query","where","limit","snapshot","getDocs","empty","teacherDoc","docs","_objectSpread","id","data","error","logger","cls","type","isActive","arguments","length","undefined","formatCurrency","amount","Math","round","toLocaleString","formatCurrencyWithUnit","getCurrencyUnit","calculateCompoundInterest","principal","dailyRate","days","interest","total","pow","calculateDailyInterest","ICON_MAP","parking","Wallet","deposits","Landmark","savings","PiggyBank","loans","HandCoins","SubscribedProductItem","product","onCancel","onMaturity","isMatured","maturityDate","Date","daysRemaining","max","differenceInDays","rate","balance","termInDays","dailyInterestAmount","name","_Fragment","format","AvailableProductItem","onSubscribe","projectedInterest","TrendingUp","ProductSection","_ref3","subscribedProducts","availableProducts","activeTab","setActiveTab","useState","map","p","SubscriptionModal","isOpen","onClose","onConfirm","isProcessing","setAmount","numAmount","parseFloat","projectedTotal","isNaN","e","stopPropagation","X","value","onChange","target","placeholder","minAmount","autoFocus","ParkingAccountSection","_ref5","dailyInterest","onDeposit","onWithdraw","userCash","auth","depositProducts","installmentProducts","loanProducts","activeView","onViewChange","onLoadUserProducts","allUserProducts","onDeleteUserProduct","user","userDoc","refreshUserDocument","isAdmin","addCash","deductCash","userId","uid","setIsProcessing","setMessage","messageType","setMessageType","parkingBalance","setParkingBalance","parkingDailyInterest","setParkingDailyInterest","userDeposits","setUserDeposits","userSavings","setUserSavings","userLoans","setUserLoans","modal","setModal","currentCash","setCurrentCash","cash","currencyUnit","useCurrency","displayMessage","text","duration","setTimeout","loadAllData","useCallback","parkingRef","doc","parkingRateProduct","parkingDoc","getDoc","exists","_data$lastInterestDat","lastInterestDate","toDate","isToday","daysToApply","updateDoc","increment","serverTimestamp","setDoc","finalParkingDoc","productsRef","forEach","docSnap","_docSnap$data$maturit","push","useEffect","log","handleOpenModal","handleCloseModal","handleMaturity","teacherId","isLoan","confirmMsg","window","confirm","teacherAccountId","teacherAccount","productRef","String","path","runTransaction","_userSnapshot$data$ca2","_userSnapshot$data2","_teacherSnapshot$data3","_teacherSnapshot$data4","userRef","teacherRef","userSnapshot","transaction","get","teacherSnapshot","Error","currentCashInDb","teacherCashInDb","update","delete","successMsg","activityType","ACTIVITY_TYPES","LOAN_REPAY","DEPOSIT_MATURITY","logActivity","userName","metadata","productName","productType","then","handleCancelEarly","confirmMessage","originalProducts","deposit","loan","originalCash","cashChangeAmount","prev","filter","_userSnapshot$data$ca3","_userSnapshot$data3","_teacherSnapshot$data5","_teacherSnapshot$data6","DEPOSIT_WITHDRAW","isEarlyCancellation","handleAdminDeleteSubscribedProduct","deleteDoc","mainTabClass","index","typeLabel","formatKoreanCurrency","toLocaleDateString","amountStr","previousParkingBalance","previousCurrentCash","set","PARKING_DEPOSIT","_parkingSnapshot$data","_parkingSnapshot$data2","PARKING_WITHDRAW","onAdminDelete","subscribeAmount","maxAmount","tempId","now","optimisticProduct","startDate","isOptimistic","_userSnapshot$data$ca","_userSnapshot$data","_teacherSnapshot$data","_teacherSnapshot$data2","newProductData","teacherName","newProductRef","actionText","DEPOSIT_CREATE","LOAN_CREATE","toISOString","convertAdminProductsToAccountFormat","adminProducts","Array","isArray","parseInt","Banking","_auth$userDoc8","_auth$userDoc1","_auth$userDoc10","_auth$userDoc11","_auth$userDoc12","useAuth","setActiveView","isLoading","setIsLoading","parkingDepositProducts","setParkingDepositProducts","parkingInstallmentProducts","setParkingInstallmentProducts","parkingLoanProducts","setParkingLoanProducts","setAllUserProducts","loadAllUserProducts","_auth$userDoc","_auth$userDoc2","_auth$userDoc3","role","usersQuery","usersSnapshot","userMap","nickname","allProducts","productPromises","Object","keys","productsQuery","productDoc","_productData$maturity","productData","firestoreId","Promise","all","productsArray","formattedDepositProducts","useMemo","formattedInstallmentProducts","formattedLoanProducts","_auth$userDoc7","_auth$userDoc6","bankingData","getBankingProducts","warn","handleParkingProductChange","field","productsState","setProductsState","i","updatedProduct","numValue","dailyRateValue","saveParkingProducts","_auth$userDoc9","products","firestoreType","updateBankingProducts","addParkingProduct","newProduct","deleteParkingProduct","indexToDelete","_auth$userDoc0","updatedProducts","_","AlchanLoading","ParkingAccount","_auth$userDoc4","_auth$userDoc5","alert","productId","ChevronLeft","style","width","backgroundColor","color","border","min","step","borderBottom"],"ignoreList":[],"sourceRoot":""}