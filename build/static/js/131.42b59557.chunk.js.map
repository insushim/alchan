{"version":3,"file":"static/js/131.42b59557.chunk.js","mappings":"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","sources":["../node_modules/lucide-react/src/icons/scroll-text.ts","../node_modules/lucide-react/src/icons/vote.ts","components/NewBillPopup.js"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M15 12h-5', key: 'r7krc0' }],\n  ['path', { d: 'M15 8h-5', key: '1khuty' }],\n  ['path', { d: 'M19 17V5a2 2 0 0 0-2-2H4', key: 'zz82l3' }],\n  [\n    'path',\n    {\n      d: 'M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3',\n      key: '1ph1d7',\n    },\n  ],\n];\n\n/**\n * @component @name ScrollText\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTUgMTJoLTUiIC8+CiAgPHBhdGggZD0iTTE1IDhoLTUiIC8+CiAgPHBhdGggZD0iTTE5IDE3VjVhMiAyIDAgMCAwLTItMkg0IiAvPgogIDxwYXRoIGQ9Ik04IDIxaDEyYTIgMiAwIDAgMCAyLTJ2LTFhMSAxIDAgMCAwLTEtMUgxMWExIDEgMCAwIDAtMSAxdjFhMiAyIDAgMSAxLTQgMFY1YTIgMiAwIDEgMC00IDB2MmExIDEgMCAwIDAgMSAxaDMiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/scroll-text\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ScrollText = createLucideIcon('scroll-text', __iconNode);\n\nexport default ScrollText;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm9 12 2 2 4-4', key: 'dzmm74' }],\n  ['path', { d: 'M5 7c0-1.1.9-2 2-2h10a2 2 0 0 1 2 2v12H5V7Z', key: '1ezoue' }],\n  ['path', { d: 'M22 19H2', key: 'nuriw5' }],\n];\n\n/**\n * @component @name Vote\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtOSAxMiAyIDIgNC00IiAvPgogIDxwYXRoIGQ9Ik01IDdjMC0xLjEuOS0yIDItMmgxMGEyIDIgMCAwIDEgMiAydjEySDVWN1oiIC8+CiAgPHBhdGggZD0iTTIyIDE5SDIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/vote\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Vote = createLucideIcon('vote', __iconNode);\n\nexport default Vote;\n","// src/components/NewBillPopup.js\n// 새 법안 제안 시 투표 미참여 학생에게 팝업으로 알려주는 모달\nimport React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport {\n  collection,\n  query,\n  where,\n  onSnapshot,\n  doc,\n  getDoc,\n} from \"firebase/firestore\";\nimport { db } from \"../firebase\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { useNavigate } from \"react-router-dom\";\nimport { X, ScrollText, Vote } from \"lucide-react\";\n\nexport default function NewBillPopup() {\n  const { userDoc } = useAuth();\n  const navigate = useNavigate();\n  const classCode = userDoc?.classCode;\n  const userId = userDoc?.id || userDoc?.uid;\n\n  const [pendingBill, setPendingBill] = useState(null);\n  const [visible, setVisible] = useState(false);\n  const lastSeenBillIdsRef = useRef(new Set());\n  const initialLoadRef = useRef(true);\n\n  useEffect(() => {\n    if (!classCode || !userId) return;\n\n    const lawsRef = collection(\n      db,\n      \"classes\",\n      classCode,\n      \"nationalAssemblyLaws\",\n    );\n    const q = query(lawsRef, where(\"status\", \"==\", \"pending\"));\n\n    const unsubscribe = onSnapshot(q, async (snapshot) => {\n      // 초기 로드 시: 현재 존재하는 법안 ID를 기록만 해두고, 팝업은 표시하지 않음\n      if (initialLoadRef.current) {\n        initialLoadRef.current = false;\n        const currentIds = new Set();\n        snapshot.docs.forEach((d) => currentIds.add(d.id));\n        lastSeenBillIdsRef.current = currentIds;\n        return;\n      }\n\n      // 새로 추가된 법안 찾기\n      const currentIds = new Set();\n      snapshot.docs.forEach((d) => currentIds.add(d.id));\n\n      let newBill = null;\n      for (const docSnap of snapshot.docs) {\n        const billId = docSnap.id;\n        if (!lastSeenBillIdsRef.current.has(billId)) {\n          // 새 법안 발견\n          const billData = docSnap.data();\n\n          // localStorage로 이미 확인한 법안인지 체크\n          const seenKey = `billPopup_${classCode}_${billId}`;\n          if (localStorage.getItem(seenKey)) continue;\n\n          // 이미 투표했는지 확인\n          if (billData.voters && billData.voters[userId]) continue;\n\n          // userVotes 컬렉션에서도 확인\n          try {\n            const userVotesRef = doc(\n              db,\n              \"classes\",\n              classCode,\n              \"userVotes\",\n              userId,\n            );\n            const userVotesSnap = await getDoc(userVotesRef);\n            if (userVotesSnap.exists() && userVotesSnap.data()[billId])\n              continue;\n          } catch {\n            // 에러 시 그냥 팝업 표시\n          }\n\n          newBill = { id: billId, ...billData, _seenKey: seenKey };\n          break; // 가장 최근 새 법안 하나만\n        }\n      }\n\n      lastSeenBillIdsRef.current = currentIds;\n\n      if (newBill) {\n        setPendingBill(newBill);\n        setTimeout(() => setVisible(true), 50);\n      }\n    });\n\n    return () => unsubscribe();\n  }, [classCode, userId]);\n\n  const handleClose = useCallback(() => {\n    if (pendingBill?._seenKey) {\n      localStorage.setItem(pendingBill._seenKey, \"1\");\n    }\n    setVisible(false);\n    setTimeout(() => setPendingBill(null), 300);\n  }, [pendingBill]);\n\n  const handleGoVote = useCallback(() => {\n    if (pendingBill?._seenKey) {\n      localStorage.setItem(pendingBill._seenKey, \"1\");\n    }\n    setVisible(false);\n    setTimeout(() => {\n      setPendingBill(null);\n      navigate(\"/national-assembly\");\n    }, 300);\n  }, [pendingBill, navigate]);\n\n  if (!pendingBill) return null;\n\n  return (\n    <div\n      className=\"fixed inset-0 z-[9999] flex items-center justify-center p-4\"\n      style={{\n        background: \"rgba(0,0,0,0.75)\",\n        backdropFilter: \"blur(4px)\",\n        opacity: visible ? 1 : 0,\n        transition: \"opacity 0.3s ease\",\n        pointerEvents: visible ? \"auto\" : \"none\",\n      }}\n      onClick={(e) => {\n        if (e.target === e.currentTarget) handleClose();\n      }}\n    >\n      <div\n        style={{\n          transform: visible\n            ? \"scale(1) translateY(0)\"\n            : \"scale(0.9) translateY(20px)\",\n          transition: \"transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)\",\n          maxWidth: 440,\n          width: \"100%\",\n        }}\n      >\n        {/* 카드 */}\n        <div className=\"relative rounded-2xl overflow-hidden shadow-2xl border border-amber-500/40 bg-gradient-to-br from-slate-900 via-amber-950/30 to-slate-900\">\n          {/* 상단 글로우 */}\n          <div className=\"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-amber-400 via-yellow-400 to-amber-400\" />\n\n          {/* 배경 패턴 */}\n          <div\n            className=\"absolute inset-0 opacity-5\"\n            style={{\n              backgroundImage:\n                \"radial-gradient(circle at 50% 50%, white 1px, transparent 1px)\",\n              backgroundSize: \"24px 24px\",\n            }}\n          />\n\n          {/* 헤더 */}\n          <div className=\"relative px-6 pt-6 pb-4 flex items-start gap-4\">\n            {/* 아이콘 */}\n            <div className=\"flex-shrink-0 w-16 h-16 rounded-2xl flex items-center justify-center text-3xl shadow-lg bg-amber-500/20 ring-1 ring-amber-500/30\">\n              <ScrollText className=\"w-8 h-8 text-amber-400\" />\n            </div>\n\n            <div className=\"flex-1 min-w-0\">\n              {/* 태그 */}\n              <div className=\"flex items-center gap-2 mb-1\">\n                <Vote className=\"w-3.5 h-3.5 text-amber-400\" />\n                <span className=\"text-xs font-bold uppercase tracking-widest text-amber-400\">\n                  새 법안 제안\n                </span>\n              </div>\n\n              {/* 제목 */}\n              <h2 className=\"text-xl font-bold text-white leading-tight\">\n                {pendingBill.title}\n              </h2>\n\n              {/* 제안자 */}\n              <p className=\"text-xs text-slate-500 mt-0.5\">\n                제안자: {pendingBill.proposerName || \"익명\"}\n              </p>\n            </div>\n\n            {/* 닫기 버튼 */}\n            <button\n              onClick={handleClose}\n              className=\"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full bg-slate-800 hover:bg-slate-700 text-slate-400 hover:text-white transition-colors\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n\n          {/* 구분선 */}\n          <div className=\"mx-6 h-px bg-amber-500/20\" />\n\n          {/* 본문 */}\n          <div className=\"relative px-6 py-4 space-y-3\">\n            {/* 메시지 */}\n            <p className=\"text-sm text-slate-300 leading-relaxed\">\n              새 법안이 제안되었습니다! 찬반 투표에 참여해주세요.\n            </p>\n\n            {/* 법안 정보 */}\n            <div className=\"rounded-xl p-3 bg-amber-500/10 border border-amber-500/20\">\n              {pendingBill.purpose && (\n                <p className=\"text-sm text-amber-200 mb-1\">\n                  <span className=\"font-semibold text-amber-300\">취지:</span>{\" \"}\n                  {pendingBill.purpose}\n                </p>\n              )}\n              {pendingBill.description && (\n                <p className=\"text-sm text-amber-200 mb-1\">\n                  <span className=\"font-semibold text-amber-300\">설명:</span>{\" \"}\n                  {pendingBill.description.length > 80\n                    ? pendingBill.description.substring(0, 80) + \"...\"\n                    : pendingBill.description}\n                </p>\n              )}\n              {pendingBill.fine && (\n                <p className=\"text-sm text-amber-200\">\n                  <span className=\"font-semibold text-amber-300\">벌금:</span>{\" \"}\n                  {pendingBill.fine}\n                </p>\n              )}\n            </div>\n          </div>\n\n          {/* 버튼 영역 */}\n          <div className=\"px-6 pb-6 flex gap-3\">\n            <button\n              onClick={handleClose}\n              className=\"flex-1 py-3 rounded-xl font-bold text-sm transition-all active:scale-[0.98] bg-slate-700 hover:bg-slate-600 text-slate-300\"\n            >\n              나중에\n            </button>\n            <button\n              onClick={handleGoVote}\n              className=\"flex-1 py-3 rounded-xl font-bold text-sm transition-all active:scale-[0.98] bg-amber-500 hover:bg-amber-400 text-white shadow-lg shadow-amber-500/25\"\n            >\n              투표하러 가기\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["ScrollText","createLucideIcon","d","key","Vote","NewBillPopup","userDoc","useAuth","navigate","useNavigate","classCode","userId","id","uid","pendingBill","setPendingBill","useState","visible","setVisible","lastSeenBillIdsRef","useRef","Set","initialLoadRef","useEffect","lawsRef","collection","db","q","query","where","unsubscribe","onSnapshot","async","current","currentIds","snapshot","docs","forEach","add","newBill","docSnap","billId","has","billData","data","seenKey","concat","localStorage","getItem","voters","userVotesRef","doc","userVotesSnap","getDoc","exists","_unused","_objectSpread","_seenKey","setTimeout","handleClose","useCallback","setItem","handleGoVote","_jsx","className","style","background","backdropFilter","opacity","transition","pointerEvents","onClick","e","target","currentTarget","children","transform","maxWidth","width","_jsxs","backgroundImage","backgroundSize","title","proposerName","X","purpose","description","length","substring","fine"],"ignoreList":[],"sourceRoot":""}