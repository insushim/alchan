"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[44],{8044(e,s,t){t.r(s),t.d(s,{default:()=>f});var a=t(2555),n=t(5043),r=t(7950),l=t(5016),o=t(2419),i=t(579);const c=e=>{let{onSubmitReport:s,reportReasons:t,users:r,currentUser:l}=e;const[o,c]=(0,n.useState)({reportedUserId:"",reason:"",details:""}),d=t.filter(e=>e.isLaw),m=t.filter(e=>!e.isLaw),u=e=>{const{name:s,value:t}=e.target;c((0,a.A)((0,a.A)({},o),{},{[s]:t}))},p=()=>{const e=t.find(e=>e.reason===o.reason);return e?e.amount:0},h=()=>{const e=t.find(e=>e.reason===o.reason);return(null===e||void 0===e?void 0:e.description)||""};return l?(0,i.jsxs)("div",{className:"submit-report-container",children:[(0,i.jsx)("h2",{className:"section-title",children:"\uc2e0\uace0 \uc81c\ucd9c"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o.reportedUserId&&o.reason?(s(o),c({reportedUserId:"",reason:"",details:""})):alert("\uc2e0\uace0 \ub300\uc0c1\uacfc \uc0ac\uc720\ub97c \ubaa8\ub450 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.")},className:"report-form",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"reportedUserId",children:"\uc2e0\uace0 \ub300\uc0c1"}),(0,i.jsxs)("select",{id:"reportedUserId",name:"reportedUserId",value:o.reportedUserId,onChange:u,required:!0,className:"form-select",children:[(0,i.jsx)("option",{value:"",children:"\uc2e0\uace0\ud560 \uc0ac\ub78c\uc744 \uc120\ud0dd\ud558\uc138\uc694"}),r.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"reason",children:"\uc2e0\uace0 \uc0ac\uc720"}),(0,i.jsxs)("select",{id:"reason",name:"reason",value:o.reason,onChange:u,required:!0,className:"form-select",children:[(0,i.jsx)("option",{value:"",children:"\uc0ac\uc720\ub97c \uc120\ud0dd\ud558\uc138\uc694"}),d.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("option",{disabled:!0,className:"reason-group-heading",children:"--- \ubc95\uc548 \uae30\ubc18 \uc2e0\uace0 \uc0ac\uc720 ---"}),d.map((e,s)=>(0,i.jsxs)("option",{value:e.reason,className:"law-reason-option",children:[e.reason," (\ubc8c\uae08: ",e.amount.toLocaleString(),"\uc6d0)"]},"law-".concat(s)))]}),(0,i.jsx)("option",{disabled:!0,className:"reason-group-heading",children:"--- \uc77c\ubc18 \uc2e0\uace0 \uc0ac\uc720 ---"}),m.map((e,s)=>(0,i.jsxs)("option",{value:e.reason,children:[e.reason," ",e.amount>0?"(\ubc8c\uae08: ".concat(e.amount.toLocaleString(),"\uc6d0)"):""]},"standard-".concat(s)))]})]}),o.reason&&h()&&(0,i.jsxs)("div",{className:"reason-description-box",children:[(0,i.jsx)("h3",{children:"\ubc95\uc548 \uc124\uba85"}),(0,i.jsx)("p",{children:h()}),p()>0&&(0,i.jsxs)("p",{className:"default-fine",children:["\uae30\ubcf8 \ubc8c\uae08: ",p().toLocaleString(),"\uc6d0"]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"details",children:"\uc0c1\uc138 \ub0b4\uc6a9 (\uc120\ud0dd\uc0ac\ud56d)"}),(0,i.jsx)("textarea",{id:"details",name:"details",value:o.details,onChange:u,className:"form-textarea",placeholder:"\uc2e0\uace0\uc5d0 \ub300\ud55c \uc0c1\uc138 \ub0b4\uc6a9\uc744 \uc791\uc131\ud558\uc138\uc694 (\uc120\ud0dd\uc0ac\ud56d)",rows:"4"})]}),(0,i.jsx)("div",{className:"form-actions",children:(0,i.jsx)("button",{type:"submit",className:"submit-button",children:"\uc2e0\uace0 \uc81c\ucd9c"})})]})]}):(0,i.jsx)("p",{className:"login-required-message",children:"\uc2e0\uace0\ud558\ub824\uba74 \ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})};var d=t(5452);const m=e=>{let{reports:s,onProcessReport:t,onSettlement:a,reportReasons:r,formatDate:l,onAcceptReport:o,onDismissReport:c,isAdminView:m}=e;const[u,p]=(0,n.useState)("submitted"),[h,x]=(0,n.useState)(!1),[v,j]=(0,n.useState)(null),[N,g]=(0,n.useState)(""),[f,b]=(0,n.useState)(""),y=e=>{if(!Array.isArray(r))return null;const s=r.find(s=>s.reason===e);return s?s.amount:null},w=e=>{const s=e.target.value.replace(/[^0-9]/g,"");g(s)},I=()=>{if(!v)return;if(!t)return void alert("\ubc8c\uae08 \ucc98\ub9ac \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const e=N?parseInt(N,10):0;try{t(v.id,e,f),C()}catch(s){d.vF.error("\ubc8c\uae08 \ucc98\ub9ac \uc911 \uc624\ub958:",s),alert("\ubc8c\uae08 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},C=()=>{x(!1),j(null),g(""),b("")},S=s.filter(e=>"accepted"===e.status),D=s.filter(e=>"submitted"===e.status),R=e=>e&&e.startsWith("[\ubc95\uc548]")?(0,i.jsx)("span",{className:"law-reason-highlight",children:e}):e,k=n.useMemo(()=>h&&v?()=>{var e,s,t;return(0,i.jsx)("div",{className:"process-modal-overlay",onClick:e=>{"process-modal-overlay"===e.target.className&&C()},children:(0,i.jsxs)("div",{className:"process-modal-container",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"process-modal-header",children:[(0,i.jsxs)("h2",{children:["\ubc8c\uae08 \ucc98\ub9ac (\uc0ac\uac74\ubc88\ud638: ",(null===v||void 0===v||null===(e=v.id)||void 0===e?void 0:e.slice(-6))||"\uc5c6\uc74c",")"]}),(0,i.jsx)("button",{className:"close-button",onClick:C,children:"\xd7"})]}),(0,i.jsxs)("div",{className:"process-modal-content",children:[(0,i.jsxs)("div",{className:"report-summary",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc0ac\uac74\ubc88\ud638:"})," ",(null===v||void 0===v||null===(s=v.id)||void 0===s?void 0:s.slice(-6))||"\uc5c6\uc74c"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ub300\uc0c1\uc790:"})," ",(null===v||void 0===v?void 0:v.reportedUserName)||"\uc54c \uc218 \uc5c6\uc74c"]}),(0,i.jsxs)("p",{className:"report-reason",children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0 \uc0ac\uc720:"})," ",(null===v||void 0===v?void 0:v.reason)||"\uc54c \uc218 \uc5c6\uc74c"]}),(null===v||void 0===v?void 0:v.description)&&(0,i.jsxs)("p",{className:"law-description",children:[(0,i.jsx)("strong",{children:"\uc124\uba85:"})," ",v.description]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"processingAmount",children:"\ubc8c\uae08 \uae08\uc561 (\uc6d0)"}),(0,i.jsx)("input",{type:"text",id:"processingAmount",value:N,onChange:w,placeholder:"\ubc8c\uae08 \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694 (0\uc6d0\uc740 \uacbd\uace0)",className:"form-input"}),null!==y(null===v||void 0===v?void 0:v.reason)&&(0,i.jsxs)("p",{className:"form-hint",children:["\uae30\ubcf8 \uae08\uc561: ",null===(t=y(null===v||void 0===v?void 0:v.reason))||void 0===t?void 0:t.toLocaleString(),"\uc6d0"]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"processingReason",children:"\ucc98\ub9ac \uc0ac\uc720 (\uc120\ud0dd)"}),(0,i.jsx)("textarea",{id:"processingReason",value:f,onChange:e=>b(e.target.value),placeholder:"\ucc98\ub9ac \uc0ac\uc720\ub97c \uc785\ub825\ud558\uc138\uc694 (\uc120\ud0dd\uc0ac\ud56d)",className:"form-textarea",rows:"3"})]}),r&&r.length>0&&(0,i.jsxs)("div",{className:"quick-reasons-container",children:[(0,i.jsx)("p",{className:"quick-reasons-label",children:"\ube60\ub978 \uc120\ud0dd:"}),(0,i.jsx)("div",{className:"quick-reasons-buttons",children:r.map((e,s)=>(0,i.jsxs)("button",{type:"button",onClick:()=>{g(e.amount.toString()),b(e.reason)},className:"quick-reason-btn",children:[e.reason," (",e.amount.toLocaleString(),"\uc6d0)"]},s))})]})]}),(0,i.jsxs)("div",{className:"process-modal-footer",children:[(0,i.jsx)("button",{className:"modal-button cancel",onClick:C,children:"\ucde8\uc18c"}),(0,i.jsx)("button",{className:"modal-button process",onClick:I,children:"\ucc98\ub9ac \uc644\ub8cc"})]})]})})}:null,[h,v,N,f,r]);return(0,i.jsxs)("div",{className:"report-status-container",children:[(0,i.jsx)("h2",{className:"section-title",children:"\uc2e0\uace0 \ucc98\ub9ac \ud604\ud669"}),(0,i.jsxs)("div",{className:"tabs-container",children:[(0,i.jsxs)("button",{onClick:()=>p("submitted"),className:"tab-button ".concat("submitted"===u?"active":""),children:["\uc81c\ucd9c\ub41c \uc2e0\uace0 (",D.length,")"]}),(0,i.jsxs)("button",{onClick:()=>p("accepted"),className:"tab-button ".concat("accepted"===u?"active":""),children:["\uc811\uc218\ub41c \uc2e0\uace0 (",S.length,")"]})]}),0===s.length?(0,i.jsx)("div",{className:"empty-state",children:"\ucc98\ub9ac \uc911\uc778 \uc2e0\uace0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,i.jsxs)(i.Fragment,{children:["accepted"===u&&(0,i.jsx)("div",{className:"status-section",children:(0,i.jsx)("div",{className:"report-list",children:0===S.length?(0,i.jsx)("div",{className:"empty-state",children:"\uc811\uc218\ub41c \uc2e0\uace0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):S.map(e=>(0,i.jsxs)("div",{className:"report-item ".concat(e.isLawReport?"law-report":""),children:[(0,i.jsxs)("div",{className:"report-header",children:[(0,i.jsxs)("span",{className:"report-id",children:["\uc0ac\uac74\ubc88\ud638: ",e.id.slice(-6)]}),(0,i.jsxs)("span",{className:"report-date",children:["\uc811\uc218\uc77c: ",l(e.acceptanceDate)]})]}),(0,i.jsxs)("div",{className:"report-content",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0\uc790:"})," ",e.reporterName]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ub300\uc0c1:"})," ",e.reportedUserName]}),(0,i.jsxs)("p",{className:"report-reason",children:[(0,i.jsx)("strong",{children:"\uc0ac\uc720:"})," ",R(e.reason)]}),e.description&&(0,i.jsxs)("p",{className:"report-description",children:[(0,i.jsx)("strong",{children:"\uc124\uba85:"})," ",e.description]}),e.details&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc0c1\uc138:"})," ",e.details]})]}),m&&(0,i.jsxs)("div",{className:"report-actions",children:[(0,i.jsx)("button",{onClick:()=>{d.vF.log("\ubc8c\uae08 \ucc98\ub9ac \ubc84\ud2bc \ud074\ub9ad\ub428:",e),(e=>{if(!e)return;let s="";if(Array.isArray(r)&&r.length>0){const t=r.find(s=>s.reason===e.reason);t&&"number"===typeof t.amount&&(s=t.amount.toString())}j(e),g(s),b(""),x(!0)})(e)},className:"action-button process-button fine-button",children:"\ubc8c\uae08 \ucc98\ub9ac"}),(0,i.jsx)("button",{onClick:()=>{d.vF.log("\ud569\uc758 \ucc98\ub9ac \ubc84\ud2bc \ud074\ub9ad\ub428:",e),(e=>{if(!a)return d.vF.error("onSettlement \ud568\uc218\uac00 \uc804\ub2ec\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4"),void alert("\ud569\uc758 \ucc98\ub9ac \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694.");if(e)try{a(e)}catch(s){d.vF.error("\ud569\uc758 \ucc98\ub9ac \uc911 \uc624\ub958:",s),alert("\ud569\uc758 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}else d.vF.error("handleSettlementClick: report\uac00 \uc5c6\uc2b5\ub2c8\ub2e4")})(e)},className:"action-button settlement-button",children:"\ud569\uc758 \ucc98\ub9ac"}),(0,i.jsx)("button",{onClick:()=>{d.vF.log("\ubc18\ub824 \ubc84\ud2bc \ud074\ub9ad\ub428:",e.id),c?c(e.id):d.vF.error("onDismissReport \ud568\uc218\uac00 \uc5c6\uc2b5\ub2c8\ub2e4")},className:"action-button dismiss-button",children:"\ubc18\ub824"})]})]},e.id))})}),"submitted"===u&&(0,i.jsx)("div",{className:"status-section",children:(0,i.jsx)("div",{className:"report-list",children:0===D.length?(0,i.jsx)("div",{className:"empty-state",children:"\uc81c\ucd9c\ub41c \uc2e0\uace0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):D.map(e=>(0,i.jsxs)("div",{className:"report-item ".concat(e.isLawReport?"law-report":""),children:[(0,i.jsxs)("div",{className:"report-header",children:[(0,i.jsxs)("span",{className:"report-id",children:["\uc0ac\uac74\ubc88\ud638: ",e.id.slice(-6)]}),(0,i.jsxs)("span",{className:"report-date",children:["\uc81c\ucd9c\uc77c: ",l(e.submitDate)]})]}),(0,i.jsxs)("div",{className:"report-content",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0\uc790:"})," ",e.reporterName]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ub300\uc0c1:"})," ",e.reportedUserName]}),(0,i.jsxs)("p",{className:"report-reason",children:[(0,i.jsx)("strong",{children:"\uc0ac\uc720:"})," ",R(e.reason)]}),e.description&&(0,i.jsxs)("p",{className:"report-description",children:[(0,i.jsx)("strong",{children:"\uc124\uba85:"})," ",e.description]}),e.details&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc0c1\uc138:"})," ",e.details]})]}),m&&(0,i.jsxs)("div",{className:"report-actions",children:[(0,i.jsx)("button",{onClick:()=>{d.vF.log("\uc811\uc218 \ubc84\ud2bc \ud074\ub9ad\ub428:",e.id),o?o(e.id):d.vF.error("onAcceptReport \ud568\uc218\uac00 \uc5c6\uc2b5\ub2c8\ub2e4")},className:"action-button accept-button",children:"\uc811\uc218"}),(0,i.jsx)("button",{onClick:()=>{d.vF.log("\ubc18\ub824 \ubc84\ud2bc \ud074\ub9ad\ub428:",e.id),c?c(e.id):d.vF.error("onDismissReport \ud568\uc218\uac00 \uc5c6\uc2b5\ub2c8\ub2e4")},className:"action-button dismiss-button",children:"\ubc18\ub824"})]})]},e.id))})})]}),k&&k()]})},u=e=>{let{reports:s,formatDate:t,isAdminView:a,onEditReport:r,onDeleteReport:l}=e;const[o,c]=(0,n.useState)("all"),d=s.filter(e=>"all"===o||("fine"===o?"resolved_fine"===e.status:"settlement"===o?"resolved_settlement"===e.status:"dismissed"!==o||"dismissed"===e.status));return(0,i.jsxs)("div",{className:"report-results-container",children:[(0,i.jsx)("h2",{className:"section-title",children:"\ucc98\ub9ac \uacb0\uacfc"}),(0,i.jsxs)("div",{className:"filter-controls",children:[(0,i.jsx)("span",{className:"filter-label",children:"\ud544\ud130:"}),(0,i.jsxs)("div",{className:"filter-buttons",children:[(0,i.jsxs)("button",{className:"filter-button ".concat("all"===o?"active":""),onClick:()=>c("all"),children:["\uc804\uccb4 (",s.length,")"]}),(0,i.jsx)("button",{className:"filter-button ".concat("fine"===o?"active":""),onClick:()=>c("fine"),children:"\ubc8c\uae08 \ucc98\ub9ac"}),(0,i.jsx)("button",{className:"filter-button ".concat("settlement"===o?"active":""),onClick:()=>c("settlement"),children:"\ud569\uc758 \ucc98\ub9ac"}),(0,i.jsx)("button",{className:"filter-button ".concat("dismissed"===o?"active":""),onClick:()=>c("dismissed"),children:"\ubc18\ub824"})]})]}),0===d.length?(0,i.jsx)("div",{className:"empty-state",children:"\ucc98\ub9ac\ub41c \uc2e0\uace0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,i.jsx)("div",{className:"results-list",children:d.map(e=>{return(0,i.jsxs)("div",{className:"result-item ".concat(e.isLawReport?"law-report":""," status-").concat(e.status),children:[(0,i.jsxs)("div",{className:"result-header",children:[(0,i.jsxs)("span",{className:"report-id",children:["\uc0ac\uac74\ubc88\ud638: ",e.id.slice(-6)]}),(0,i.jsxs)("span",{className:"result-status",children:["resolved_fine"===e.status&&"\ubc8c\uae08 \ucc98\ub9ac","resolved_settlement"===e.status&&"\ud569\uc758 \ucc98\ub9ac","dismissed"===e.status&&"\ubc18\ub824"]}),(0,i.jsxs)("span",{className:"result-date",children:["\ucc98\ub9ac\uc77c:"," ",t(e.resolutionDate||e.submitDate)]})]}),(0,i.jsxs)("div",{className:"result-content",children:[(0,i.jsxs)("div",{className:"result-parties",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0\uc790:"})," ",e.reporterName]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ub300\uc0c1\uc790:"})," ",e.reportedUserName]})]}),(0,i.jsxs)("div",{className:"result-details",children:[(0,i.jsxs)("p",{className:"report-reason",children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0 \uc0ac\uc720:"})," ",(s=e.reason,s.startsWith("[\ubc95\uc548]")?(0,i.jsx)("span",{className:"law-reason-highlight",children:s}):s)]}),e.description&&(0,i.jsxs)("p",{className:"report-description",children:[(0,i.jsx)("strong",{children:"\uc124\uba85:"})," ",e.description]}),e.details&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc0c1\uc138\ub0b4\uc6a9:"})," ",e.details]}),e.resolution&&(0,i.jsxs)("p",{className:"resolution",children:[(0,i.jsx)("strong",{children:"\ucc98\ub9ac\uacb0\uacfc:"})," ",e.resolution]}),e.amount>0&&(0,i.jsxs)("p",{className:"amount",children:[(0,i.jsx)("strong",{children:"\uae08\uc561:"})," ",e.amount.toLocaleString(),"\uc6d0","resolved_settlement"===e.status&&" (\ud569\uc758\uae08)","resolved_fine"===e.status&&" (\ubc8c\uae08)"]})]}),(0,i.jsx)("div",{className:"processed-by",children:(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ucc98\ub9ac\uc790:"})," ",e.processedByName||"\uc2dc\uc2a4\ud15c"]})})]}),a&&(0,i.jsxs)("div",{className:"admin-actions",children:[(0,i.jsx)("button",{onClick:()=>r(e.id),className:"admin-button edit-button",title:"\ud3b8\uc9d1",children:"\ud3b8\uc9d1"}),(0,i.jsx)("button",{onClick:()=>l(e.id),className:"admin-button delete-button",title:"\uc0ad\uc81c",children:"\uc0ad\uc81c"})]})]},e.id);var s})})]})},p=e=>{let{reportReasons:s,onUpdateReasons:t,onDeleteAllReports:a}=e;const[r,l]=(0,n.useState)([]);(0,n.useEffect)(()=>{l(JSON.parse(JSON.stringify(s||[])))},[s]);const o=(e,s,t)=>{const a=[...r];a[e][s]="amount"===s?""===t?0:parseInt(t,10):t,l(a)};return(0,i.jsxs)("div",{className:"admin-settings-container",children:[(0,i.jsx)("h2",{className:"admin-settings-h2",children:"\uad00\ub9ac\uc790 \uc124\uc815"}),(0,i.jsxs)("div",{className:"admin-section",children:[(0,i.jsx)("h3",{className:"admin-section-title",children:"\uc0ac\uc6a9\uc790 \uc815\uc758 \uc2e0\uace0 \uc0ac\uc720 \uad00\ub9ac"}),(0,i.jsx)("p",{className:"admin-section-desc",children:"\ubc95\uc548 \uae30\ubc18\uc774 \uc544\ub2cc, \uc0ac\uc6a9\uc790\uac00 \uc9c1\uc811 \ucd94\uac00\ud558\ub294 \uc2e0\uace0 \uc0ac\uc720 \ubaa9\ub85d\uc785\ub2c8\ub2e4. \ubc8c\uae08\uc561\uc744 0\uc73c\ub85c \uc124\uc815\ud558\uba74 \ubc8c\uae08 \uc5c6\uc774 \ucc98\ub9ac\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),(0,i.jsx)("div",{className:"reasons-list",children:r.map((e,s)=>(0,i.jsxs)("div",{className:"reason-item-editor",children:[(0,i.jsx)("input",{type:"text",value:e.reason,onChange:e=>o(s,"reason",e.target.value),placeholder:"\uc2e0\uace0 \uc0ac\uc720",className:"reason-input"}),(0,i.jsxs)("div",{className:"reason-amount-wrapper",children:[(0,i.jsx)("input",{type:"number",value:e.amount,onChange:e=>o(s,"amount",e.target.value),placeholder:"\ubc8c\uae08\uc561",className:"reason-amount-input",min:"0",step:"1000"}),(0,i.jsx)("span",{children:"\uc6d0"})]}),(0,i.jsx)("button",{onClick:()=>{return e=s,void(window.confirm("\uc774 \uc0ac\uc720\ub97c \uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&l(r.filter((s,t)=>t!==e)));var e},className:"reason-delete-button",children:"\uc0ad\uc81c"})]},s))}),(0,i.jsxs)("div",{className:"reason-actions",children:[(0,i.jsx)("button",{onClick:()=>{l([...r,{reason:"\uc0c8\ub85c\uc6b4 \uc0ac\uc720",amount:1e4,isLaw:!1}])},className:"reason-add-button",children:"\uc0ac\uc720 \ucd94\uac00"}),(0,i.jsx)("button",{onClick:()=>{r.some(e=>!e.reason.trim())?alert("\uc0ac\uc720 \uc774\ub984\uc740 \ube44\uc6cc\ub458 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."):t(r)},className:"reason-save-button",children:"\ubcc0\uacbd\uc0ac\ud56d \uc800\uc7a5"})]})]}),(0,i.jsxs)("div",{className:"admin-section danger-zone",children:[(0,i.jsx)("h3",{className:"admin-section-title danger-zone-title",children:"\uc704\ud5d8 \uad6c\uc5ed"}),(0,i.jsx)("p",{className:"admin-section-desc",children:"\uc8fc\uc758: \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc73c\ubbc0\ub85c \uc2e0\uc911\ud558\uac8c \uc9c4\ud589\ud574\uc8fc\uc138\uc694."}),(0,i.jsxs)("div",{className:"danger-zone-actions",children:[(0,i.jsxs)("p",{className:"danger-zone-p",children:[(0,i.jsx)("strong",{children:"\ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c"}),(0,i.jsx)("br",{}),"\ud604\uc7ac \ud559\uae09\uc5d0 \uc81c\ucd9c, \ucc98\ub9ac, \uc644\ub8cc\ub41c \ubaa8\ub4e0 \uc2e0\uace0 \ub0b4\uc5ed\uc744 \uc601\uad6c\uc801\uc73c\ub85c \uc0ad\uc81c\ud569\ub2c8\ub2e4."]}),(0,i.jsx)("button",{onClick:()=>{window.confirm("\uc815\ub9d0\ub85c \ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")&&a()},className:"danger-zone-button",children:"\ubaa8\ub4e0 \uae30\ub85d \uc0ad\uc81c"})]})]})]})};var h=t(577),x=t(5472);const v=e=>{let{complaint:s,onSave:t,onCancel:l,users:o}=e;const[c,d]=(0,n.useState)(s.reason),[m,u]=(0,n.useState)(s.desiredResolution),[p,h]=(0,n.useState)(s.defendantId),x=o.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name||e.displayName||e.id},e.id));return r.createPortal((0,i.jsx)("div",{className:"modal-overlay",onClick:l,children:(0,i.jsxs)("div",{className:"edit-modal-container modal-container",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsxs)("h3",{children:["\uace0\uc18c\uc7a5 \uc218\uc815 (ID: ",s.id.slice(-6),")"]}),(0,i.jsx)("button",{className:"close-button",onClick:l,children:"\xd7"})]}),(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"defendantSelectEdit",className:"form-label",children:"\ud53c\uace0\uc18c\uc778"}),(0,i.jsxs)("select",{id:"defendantSelectEdit",className:"form-select",value:p,onChange:e=>h(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"-- \uc120\ud0dd --"}),x]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"form-label",children:"\uace0\uc18c \uc0ac\uc720"}),(0,i.jsx)("textarea",{className:"form-textarea",value:c,onChange:e=>d(e.target.value),rows:5})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"form-label",children:"\uc6d0\ud558\ub294 \uacb0\uacfc"}),(0,i.jsx)("textarea",{className:"form-textarea",value:m,onChange:e=>u(e.target.value),rows:3})]})]}),(0,i.jsxs)("div",{className:"modal-footer",children:[(0,i.jsx)("button",{onClick:l,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,i.jsx)("button",{onClick:()=>{p&&c.trim()&&m.trim()?t((0,a.A)((0,a.A)({},s),{},{reason:c,desiredResolution:m,defendantId:p})):alert("\ubaa8\ub4e0 \ud544\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},className:"modal-button process",children:"\uc800\uc7a5"})]})]})}),document.getElementById("modal-root")||document.body)},j=e=>{let{complaint:s,onSave:t,onCancel:a}=e;const[l,o]=(0,n.useState)(s.judgment||"");return r.createPortal((0,i.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,i.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsxs)("h3",{children:["\ud310\uacb0\ubb38 \uc791\uc131 (ID: ",s.id.slice(-6),")"]}),(0,i.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,i.jsx)("div",{className:"modal-content",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"judgmentText",className:"form-label",children:"\ud310\uacb0 \ub0b4\uc6a9"}),(0,i.jsx)("textarea",{id:"judgmentText",className:"form-textarea judgment-textarea",value:l,onChange:e=>o(e.target.value),rows:10,placeholder:"\ud310\uacb0 \ub0b4\uc6a9\uc744 \uc0c1\uc138\ud788 \uc791\uc131\ud574\uc8fc\uc138\uc694..."})]})}),(0,i.jsxs)("div",{className:"modal-footer",children:[(0,i.jsx)("button",{onClick:a,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,i.jsx)("button",{onClick:()=>{l.trim()?t(s.id,l):alert("\ud310\uacb0 \ub0b4\uc6a9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},className:"modal-button process",children:"\ud310\uacb0 \uc800\uc7a5"})]})]})}),document.getElementById("modal-root")||document.body)},N=e=>{var s,t,a;let{complaint:r,users:o,onSave:c,onCancel:m,getUserNameById:u}=e;const p=r||{},[h,x]=(0,n.useState)((null===(s=p.amount)||void 0===s?void 0:s.toString())||""),[v,j]=(0,n.useState)(p.resolution||"\uc0c1\ud638 \ud569\uc758\uc5d0 \ub530\ub978 \ud569\uc758\uae08 \uc9c0\uae09"),[N,g]=(0,n.useState)(p.defendantId||p.reportedUserId||""),[f,b]=(0,n.useState)(p.complainantId||p.reporterId||""),y=null===(t=(0,l.As)().userDoc)||void 0===t?void 0:t.id;(0,n.useEffect)(()=>{d.vF.log("SettlementModal\uc774 \ub80c\ub354\ub9c1\ub428",{complaintId:p.id,senderId:N,recipientId:f})},[p.id,N,f]);const w=o.filter(e=>e.id!==f),I=o.filter(e=>e.id!==N);return(0,i.jsx)("div",{className:"settlement-modal-overlay",onClick:m,children:(0,i.jsxs)("div",{className:"settlement-modal-safe-container",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"settlement-modal-header",children:[(0,i.jsxs)("h3",{children:["\ud569\uc758\uae08 \uc9c0\uae09 \ucc98\ub9ac (\uc0ac\uac74\ubc88\ud638: ",(null===(a=p.id)||void 0===a?void 0:a.slice(-6))||"\uc5c6\uc74c",")"]}),(0,i.jsx)("button",{className:"close-button",onClick:m,children:"\xd7"})]}),(0,i.jsxs)("div",{className:"settlement-modal-content",children:[(0,i.jsxs)("p",{className:"text-white mb-2",children:[(0,i.jsx)("strong",{children:"\uace0\uc18c\uc778:"})," ",u(f)]}),(0,i.jsxs)("p",{className:"text-white mb-4",children:[(0,i.jsx)("strong",{children:"\ud53c\uace0\uc18c\uc778:"})," ",u(N)]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"settlementSender",className:"form-label",children:"\uc1a1\uae08\uc790:"}),(0,i.jsxs)("select",{id:"settlementSender",className:"form-select",value:N,onChange:e=>g(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"-- \uc120\ud0dd --"}),w.map(e=>(0,i.jsx)("option",{value:e.id,children:u(e.id)},e.id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"settlementRecipient",className:"form-label",children:"\uc218\uae08\uc790:"}),(0,i.jsxs)("select",{id:"settlementRecipient",className:"form-select",value:f,onChange:e=>b(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"-- \uc120\ud0dd --"}),I.map(e=>(0,i.jsx)("option",{value:e.id,children:u(e.id)},e.id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"settlementAmount",className:"form-label",children:"\ud569\uc758\uae08 (\uc6d0):"}),(0,i.jsx)("input",{type:"number",id:"settlementAmount",className:"form-input",value:h,onChange:e=>x(e.target.value),placeholder:"\uae08\uc561 \uc785\ub825",min:"1"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"settlementReason",className:"form-label",children:"\ucc98\ub9ac \uc0ac\uc720:"}),(0,i.jsx)("textarea",{id:"settlementReason",className:"form-textarea",value:v,onChange:e=>j(e.target.value),rows:"3",placeholder:"\uc608: \uc0c1\ud638 \uc6d0\ub9cc\ud55c \ud569\uc758"})]})]}),(0,i.jsxs)("div",{className:"settlement-modal-footer",children:[(0,i.jsx)("button",{onClick:m,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,i.jsx)("button",{onClick:async()=>{if(d.vF.log("Settlement Modal - handleSave \ud638\ucd9c\ub428",{reportId:p.id,amount:h,senderId:N,recipientId:f,reason:v}),p.id)if(!h||isNaN(parseInt(h))||parseInt(h)<=0)alert("\uc720\ud6a8\ud55c \ud569\uc758 \uae08\uc561\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");else if(N&&f)if(N!==f)try{await c(p.id,parseInt(h),N,f,v,y)}catch(e){d.vF.error("Settlement Modal - \uc800\uc7a5 \uc911 \uc624\ub958:",e),alert("\uc624\ub958 \ubc1c\uc0dd: ".concat(e.message))}else alert("\uc1a1\uae08\uc790\uc640 \uc218\uae08\uc790\ub294 \uac19\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");else alert("\uc1a1\uae08\uc790\uc640 \uc218\uae08\uc790\ub97c \ubaa8\ub450 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");else alert("\uc624\ub958: \uc0ac\uac74 ID\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc5b4 \ucc98\ub9ac\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},className:"modal-button process",children:"\uc9c0\uae09 \ucc98\ub9ac"})]})]})})},g=[{reason:"\uae09\uc2dd\uc2e4 \uc0c8\uce58\uae30",amount:3e4,isLaw:!1},{reason:"\uc2e4\ub0b4\uc5d0\uc11c \uc2e0\ubc1c\uc2e0\uae30",amount:3e4,isLaw:!1},{reason:"\uc6b4\ub3d9\uc7a5\uc5d0\uc11c \uc2e4\ub0b4\ud654 \uc2e0\uae30",amount:3e4,isLaw:!1},{reason:"\uc695\uc124 \uc0ac\uc6a9",amount:5e4,isLaw:!1},{reason:"\uce5c\uad6c \uac74\ub4e4\uae30/\ub54c\ub9ac\uae30",amount:1e5,isLaw:!1},{reason:"\uc2dc\ube44 \uac78\uae30",amount:7e4,isLaw:!1},{reason:"\uae30\ud0c0",amount:0,isLaw:!1}],f=()=>{const e=(0,l.As)(),s=e.userDoc,t=null===s||void 0===s?void 0:s.id,r=null===s||void 0===s?void 0:s.classCode,f=!e.loading&&(e.isAdmin?e.isAdmin():(null===s||void 0===s?void 0:s.isAdmin)||!1),[b,y]=(0,n.useState)("submit"),[w,I]=(0,n.useState)("submit"),[C,S]=(0,n.useState)([]),[D,R]=(0,n.useState)([]),[k,F]=(0,n.useState)(!0),[A,L]=(0,n.useState)(!1),[U,E]=(0,n.useState)(null),[B,M]=(0,n.useState)(!1),[O,T]=(0,n.useState)(null),[_,q]=(0,n.useState)(!1),[J,P]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!document.getElementById("modal-root")){const e=document.createElement("div");e.id="modal-root",document.body.appendChild(e)}},[]);const H=(0,n.useCallback)(e=>{if(!D||0===D.length)return e||"\uc815\ubcf4 \uc5c6\uc74c";const s=D.find(s=>s.id===e);return(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.displayName)||e||"\uc54c \uc218 \uc5c6\uc74c"},[D]),z=e=>{if(!e)return"N/A";try{const s="function"===typeof e.toDate?e.toDate():new Date(e);return isNaN(s.getTime())?"\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ub0a0\uc9dc":s.toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})}catch(s){return d.vF.error("Error formatting date:",e,s),"\ub0a0\uc9dc \uc624\ub958"}},Z=(0,n.useMemo)(()=>{var s;return!r||(null===(s=e.classmates)||void 0===s?void 0:s.length)>0?null:(0,x.query)((0,x.rJ)(o.db,"users"),(0,x.where)("classCode","==",r))},[r,e.classmates]),{data:V,loading:W}=(0,h.nm)(async()=>{if(!Z)return null;return(await(0,x.getDocs)(Z)).docs.map(e=>(0,a.A)({id:e.id},e.data()))},{interval:18e5,enabled:!!Z&&!e.loading,deps:[r,e.loading,Z]});(0,n.useEffect)(()=>{if(e.loading)F(!0);else if(e.classmates&&e.classmates.length>0){const t=e.classmates;s&&!t.find(e=>e.id===s.id)&&t.push((0,a.A)({id:s.id,name:s.name,displayName:s.displayName},s)),R(t),F(!1)}else r?V?(R(V),F(W)):F(W):(R([]),F(!1))},[e.loading,e.classmates,r,s,V,W]);const K=(0,n.useMemo)(()=>{if(!r)return null;const e=(0,x.rJ)(o.db,"jobs");return(0,x.query)(e,(0,x.where)("classCode","==",r))},[r]),{data:X,loading:G}=(0,h.nm)(async()=>{if(!K)return[];return(await(0,x.getDocs)(K)).docs.map(e=>(0,a.A)({id:e.id},e.data()))},{interval:18e5,enabled:!!r,deps:[r]}),Q=(0,n.useMemo)(()=>{if(null===s||void 0===s||!s.selectedJobIds||!X)return!1;return X.filter(e=>s.selectedJobIds.includes(e.id)).some(e=>"\uacbd\ucc30\uccad\uc7a5"===e.title)},[null===s||void 0===s?void 0:s.selectedJobIds,X]),Y=f||Q,$=(0,n.useMemo)(()=>r?(0,x.H9)(o.db,(e=>"nationalTreasuries/".concat(e))(r)):null,[r]),{data:ee,loading:se}=(0,h.nm)(async()=>{if(!$)return 0;const e=await(0,x.x7)($),s=e.exists()&&e.data().totalAmount||0;return!e.exists()&&Y&&(0,x.BN)($,{totalAmount:0,stockTaxRevenue:0,stockCommissionRevenue:0,realEstateTransactionTaxRevenue:0,realEstateAnnualTaxRevenue:0,incomeTaxRevenue:0,corporateTaxRevenue:0,otherTaxRevenue:0,classCode:r,createdAt:(0,x.O5)(),lastUpdated:(0,x.O5)()}).catch(e=>d.vF.error("Error creating national treasury:",e)),s},{interval:9e5,enabled:!!r&&!e.loading,deps:[r,e.loading,Y]}),te=(0,n.useMemo)(()=>{if(!r)return null;const e=(0,x.rJ)(o.db,"classes",r,"nationalAssemblyLaws");return(0,x.query)(e,(0,x.where)("finalStatus","==","final_approved"),(0,x.orderBy)("timestamp","desc"),(0,x.limit)(50))},[r]),{data:ae,loading:ne}=(0,h.nm)(async()=>{if(!te)return[];return(await(0,x.getDocs)(te)).docs.map(e=>(0,a.A)({id:e.id},e.data()))},{interval:18e5,enabled:!!r,deps:[r]}),re=(0,n.useMemo)(()=>r?(0,x.H9)(o.db,"classes",r,"policeReportReasons","custom"):null,[r]),{data:le,loading:oe}=(0,h.nm)(async()=>{if(!re)return[...g.filter(e=>!e.isLaw)];const e=await(0,x.x7)(re);let s;return e.exists()&&e.data().reasons?s=e.data().reasons:(s=g.filter(e=>!e.isLaw),Y&&(0,x.BN)(re,{reasons:s,updatedAt:(0,x.O5)(),classCode:r}).catch(e=>d.vF.error("Error creating default custom reasons:",e))),s},{interval:36e5,enabled:!!r,deps:[r,Y]});(0,n.useEffect)(()=>{if(ne||oe)return;const e=le||[],s=(ae||[]).map(e=>{var s;const t=null===(s=e.fine)||void 0===s?void 0:s.match(/\d+/g),a=t?parseInt(t.join(""),10):1e4;return{reason:"[\ubc95\uc548] ".concat(e.title," \uc704\ubc18"),description:e.description||"",amount:a,lawId:e.id,isLaw:!0}});S([...s,...e])},[ae,le,ne,oe]);const ie=(0,n.useMemo)(()=>{if(!r)return null;const e=(0,x.rJ)(o.db,"classes",r,"policeReports");return(0,x.query)(e,(0,x.orderBy)("submitDate","desc"),(0,x.limit)(100))},[r]),{data:ce,loading:de,refetch:me}=(0,h.nm)(async()=>{if(!ie)return[];return(await(0,x.getDocs)(ie)).docs.map(e=>{var s,t,n;const r=e.data();return(0,a.A)((0,a.A)({id:e.id},r),{},{submitDate:null!==(s=r.submitDate)&&void 0!==s&&s.toDate?r.submitDate.toDate().toISOString():null,acceptanceDate:null!==(t=r.acceptanceDate)&&void 0!==t&&t.toDate?r.acceptanceDate.toDate().toISOString():null,resolutionDate:null!==(n=r.resolutionDate)&&void 0!==n&&n.toDate?r.resolutionDate.toDate().toISOString():null})})},{interval:6e5,enabled:!!r,deps:[r]}),ue=e=>{I(b),y(e)},pe=()=>{y("admin"!==w?w:"submit")},he=async e=>{if(!t||!r)return void alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud558\uac70\ub098 \ud559\uae09 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!e.reportedUserId||!e.reason)return void alert("\uc2e0\uace0 \ub300\uc0c1\uacfc \uc0ac\uc720\ub97c \ubaa8\ub450 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");const n=C.find(s=>s.reason===e.reason),l=(0,x.rJ)(o.db,"classes",r,"policeReports"),i=(0,a.A)((0,a.A)({},e),{},{reporterId:t,complainantId:t,reporterName:s.name||s.displayName||"\uc775\uba85",submitDate:(0,x.O5)(),status:"submitted",amount:(null===n||void 0===n?void 0:n.amount)||0,isLawReport:(null===n||void 0===n?void 0:n.isLaw)||!1,description:(null===n||void 0===n?void 0:n.description)||e.reason,lawId:(null===n||void 0===n?void 0:n.lawId)||null,classCode:r,acceptanceDate:null,resolution:null,resolutionDate:null,processedById:null,processedByName:null,settlementPaid:!1,defendantId:e.reportedUserId});try{await(0,x.addDoc)(l,i),me(),ue("status"),alert("\uc2e0\uace0\uac00 \uc131\uacf5\uc801\uc73c\ub85c \uc81c\ucd9c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(c){d.vF.error("Error adding report:",c),alert("\uc2e0\uace0 \uc81c\ucd9c \uc624\ub958.")}},xe=async e=>{if(d.vF.log("handleAcceptReport \ud638\ucd9c\ub428:",e),!Y||!r||!t)return void alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \uc815\ubcf4\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4.");const a=(0,x.H9)(o.db,"classes",r,"policeReports",e);try{await(0,x.mZ)(a,{status:"accepted",acceptanceDate:(0,x.O5)(),processedById:t,processedByName:s.name||s.displayName||"\uad00\ub9ac\uc790"}),me(),d.vF.log("\uc2e0\uace0 \uc811\uc218 \uc131\uacf5:",e),alert("\uc2e0\uace0\uac00 \uc811\uc218\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(n){d.vF.error("Error accepting report:",n),alert("\uc2e0\uace0 \uc811\uc218 \uc624\ub958.")}},ve=async e=>{if(d.vF.log("handleDismissReport \ud638\ucd9c\ub428:",e),!Y||!r||!t)return void alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \uc815\ubcf4\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4.");const a=(0,x.H9)(o.db,"classes",r,"policeReports",e);try{await(0,x.mZ)(a,{status:"dismissed",resolution:"\uc2e0\uace0 \ubc18\ub824/\uae30\uac01",resolutionDate:(0,x.O5)(),processedById:t,processedByName:s.name||s.displayName||"\uad00\ub9ac\uc790"}),me(),d.vF.log("\uc2e0\uace0 \ubc18\ub824 \uc131\uacf5:",e),alert("\uc2e0\uace0\uac00 \ubc18\ub824\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(n){d.vF.error("Error dismissing report:",n),alert("\uc2e0\uace0 \ubc18\ub824 \uc624\ub958.")}},je=async(e,a,n)=>{if(d.vF.log("handleProcessReport \ud638\ucd9c\ub428:",{id:e,processingAmount:a,processingReason:n}),!Y||!t||!r)return void alert("\uad8c\ud55c \ub610\ub294 \uc815\ubcf4 \ubd80\uc871");const l=ce.find(s=>s.id===e);if(!l)return void alert("\uc2e0\uace0\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if("accepted"!==l.status)return void alert("\uc811\uc218\ub41c \uc2e0\uace0\ub9cc \ucc98\ub9ac \uac00\ub2a5\ud569\ub2c8\ub2e4.");const i=parseInt(a,10);if(isNaN(i)||i<0)return void alert("\uc720\ud6a8\ud55c \uae08\uc561(0 \uc774\uc0c1) \uc785\ub825 \ud544\uc694");let c=n||"\ubc8c\uae08 \ubd80\uacfc \ucc98\ub9ac";l.isLawReport&&l.description&&(c="".concat(n||"\ubc95\uc548 \uc704\ubc18",": ").concat(l.description));const m=(0,x.H9)(o.db,"classes",r,"policeReports",e);if(i>0){const a=l.reportedUserId||l.defendantId;try{const n="\uacbd\ucc30\uc11c \uc2e0\uace0 (\uc0ac\uac74\ubc88\ud638: ".concat(e.slice(-6),")\uc5d0 \ub300\ud55c \ubc8c\uae08 ").concat(i.toLocaleString(),"\uc6d0 \ub0a9\ubd80");await(0,o.ef)(a,r,i,n),await(0,x.mZ)(m,{status:"resolved_fine",resolutionDate:(0,x.O5)(),resolution:c,amount:i,processedById:t,processedByName:s.name||s.displayName||"\uad00\ub9ac\uc790"}),me(),alert("\ubc8c\uae08 \ucc98\ub9ac\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(u){return d.vF.error("\ubc8c\uae08 \ucc98\ub9ac \ud2b8\ub79c\uc7ad\uc158 \uc624\ub958:",u),void alert("\ubc8c\uae08 \ucc98\ub9ac \uc2e4\ud328: ".concat(u.message))}}else try{await(0,x.mZ)(m,{status:"resolved_fine",resolutionDate:(0,x.O5)(),resolution:c,amount:0,processedById:t,processedByName:s.name||s.displayName||"\uad00\ub9ac\uc790"}),me(),alert("\uacbd\uace0 \ucc98\ub9ac\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(u){d.vF.error("\ubc8c\uae08 0\uc6d0 \ucc98\ub9ac \uc624\ub958:",u),alert("\ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},Ne=async()=>{if(!Y||!r)return alert("\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");if(window.confirm("\ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c?"))try{const e=(0,x.rJ)(o.db,"classes",r,"policeReports"),s=await(0,x.getDocs)(e),t=(0,x.wP)(o.db);s.docs.forEach(e=>t.delete(e.ref)),await t.commit(),alert("\ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c \uc644\ub8cc.")}catch(e){d.vF.error("Error deleting all reports:",e),alert("\ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c \uc624\ub958.")}},ge=async e=>{if(!Y||!r)return alert("\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");if(ce.find(s=>s.id===e)&&window.confirm("\uc0ac\uac74\ubc88\ud638 ".concat(e.slice(-6)," \uc0ad\uc81c?")))try{const s=(0,x.H9)(o.db,"classes",r,"policeReports",e);await(0,x.kd)(s),alert("\uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c \uc644\ub8cc.")}catch(s){d.vF.error("Error deleting report:",s),alert("\uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c \uc624\ub958.")}},fe=e=>{if(!Y)return;const s=ce.find(s=>s.id===e);s&&(!s.defendantId&&s.reportedUserId&&(s.defendantId=s.reportedUserId),E(s),L(!0))},be=async e=>{if(!Y||!r)return alert("\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");if(Array.isArray(e)&&!e.some(e=>"object"!==typeof e||!e.reason||"number"!==typeof e.amount))try{const s=(0,x.H9)(o.db,"classes",r,"policeReportReasons","custom");await(0,x.BN)(s,{reasons:e,updatedAt:(0,x.O5)(),classCode:r}),alert("\uc0ac\uc6a9\uc790 \uc815\uc758 \uc2e0\uace0 \uc0ac\uc720 \uc5c5\ub370\uc774\ud2b8 \uc644\ub8cc.")}catch(s){d.vF.error("Error updating reasons:",s),alert("\uc2e0\uace0 \uc0ac\uc720 \uc5c5\ub370\uc774\ud2b8 \uc624\ub958.")}else alert("\uc2e0\uace0 \uc0ac\uc720 \ub370\uc774\ud130 \ud615\uc2dd \uc624\ub958.")},ye=e=>{if(d.vF.log("handleOpenSettlementModal \ud638\ucd9c\ub428:",e),!e||!e.id)return d.vF.error("\ud569\uc758 \ucc98\ub9ac \uc624\ub958: \uc720\ud6a8\ud55c \uc0ac\uac74 \uac1d\uccb4\ub97c \uc804\ub2ec\ubc1b\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.",e),void alert("\uc624\ub958: \uc0ac\uac74 \uc815\ubcf4\ub97c \ucc3e\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4. \ud398\uc774\uc9c0\ub97c \uc0c8\ub85c\uace0\uce68 \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc138\uc694.");const s=(0,a.A)((0,a.A)({},e),{},{complainantId:e.complainantId||e.reporterId,defendantId:e.defendantId||e.reportedUserId});if(!s.complainantId||!s.defendantId)return d.vF.error("\ud569\uc758 \ucc98\ub9ac \uc624\ub958: \uace0\uc18c\uc778 \ub610\ub294 \ud53c\uace0\uc18c\uc778 \uc815\ubcf4\uac00 \ub204\ub77d\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",s),void alert("\uc624\ub958: \uace0\uc18c\uc778 \ub610\ub294 \ud53c\uace0\uc18c\uc778 \uc815\ubcf4\uac00 \uc5c6\ub294 \uc0ac\uac74\uc740 \ucc98\ub9ac\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");d.vF.log("\ud569\uc758 \ubaa8\ub2ec \uc5f4\uae30 \uc900\ube44 \uc644\ub8cc, \uc0c1\ud0dc \uc5c5\ub370\uc774\ud2b8 \uc9c1\uc804:",s),P(s),q(!0)},we=(0,n.useMemo)(()=>k||de||!ce?ce||[]:ce.map(e=>(0,a.A)((0,a.A)({},e),{},{reporterName:H(e.reporterId),reportedUserName:H(e.reportedUserId||e.defendantId),processedByName:e.processedById?H(e.processedById):null})),[ce,k,de,H]),Ie=(0,n.useMemo)(()=>we.filter(e=>"submitted"===e.status||"accepted"===e.status),[we]),Ce=(0,n.useMemo)(()=>we.filter(e=>e.status.startsWith("resolved_")||"dismissed"===e.status).sort((e,s)=>{const t=e.resolutionDate||e.submitDate,a=s.resolutionDate||s.submitDate,n="function"===typeof(null===t||void 0===t?void 0:t.toDate)?t.toDate().getTime():new Date(t).getTime();return("function"===typeof(null===a||void 0===a?void 0:a.toDate)?a.toDate().getTime():new Date(a).getTime())-n}),[we]);if(e.loading)return(0,i.jsx)("div",{className:"police-container",children:(0,i.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"\uc0ac\uc6a9\uc790 \uc778\uc99d \uc815\ubcf4\ub97c \ud655\uc778 \uc911\uc785\ub2c8\ub2e4..."})});if(!s)return(0,i.jsx)("div",{className:"police-container",children:(0,i.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4. \uacbd\ucc30\uc11c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud558\ub824\uba74 \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})});if(!r&&!Y)return(0,i.jsx)("div",{className:"police-container",children:(0,i.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"\uacbd\ucc30\uc11c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud558\ub824\uba74 \ud559\uae09 \ucf54\ub4dc\uac00 \uc0ac\uc6a9\uc790 \uc815\ubcf4\uc5d0 \uc124\uc815\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4. \ud504\ub85c\ud544\uc5d0\uc11c \ud559\uae09 \ucf54\ub4dc\ub97c \uc124\uc815\ud574\uc8fc\uc138\uc694."})});if(r&&(k||se||ne||G||oe||de))return(0,i.jsx)("div",{className:"police-container",children:(0,i.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})});if(Y&&!r&&"admin"!==b)return(0,i.jsxs)("div",{className:"police-container loading",children:["\uad00\ub9ac\uc790\ub2d8, \ud604\uc7ac \ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \uc774 \ud0ed\uc758 \ub0b4\uc6a9\uc744 \ubcfc \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790 \uc124\uc815\uc744 \ud655\uc778\ud558\uac70\ub098 \ud504\ub85c\ud544\uc5d0\uc11c \ud559\uae09 \ucf54\ub4dc\ub97c \uc124\uc815\ud574\uc8fc\uc138\uc694.",(0,i.jsx)("button",{onClick:()=>y("admin"),children:"\uad00\ub9ac\uc790 \uc124\uc815\uc73c\ub85c \uc774\ub3d9"})]});const Se=()=>{if(!r&&!Y&&"admin"!==b)return(0,i.jsx)("p",{className:"empty-state",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc5b4 \uc788\uc9c0 \uc54a\uc544 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."});switch(b){case"submit":return r?(0,i.jsx)(c,{onSubmitReport:he,reportReasons:C,users:D.filter(e=>e.id!==t),currentUser:s}):(0,i.jsx)("p",{className:"empty-state",children:"\uc2e0\uace0\ub97c \uc81c\ucd9c\ud560 \ud559\uae09\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."});case"status":return r?(0,i.jsx)(m,{reports:Ie,onProcessReport:je,onSettlement:ye,reportReasons:C,formatDate:z,onAcceptReport:xe,onDismissReport:ve,currentUser:s,isAdminView:Y,users:D}):(0,i.jsx)("p",{className:"empty-state",children:"\ucc98\ub9ac \ud604\ud669\uc744 \ubcfc \ud559\uae09\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."});case"results":return r?(0,i.jsx)(u,{reports:Ce,formatDate:z,isAdminView:Y,onEditReport:fe,onDeleteReport:ge,users:D,getUserNameById:H,isAdmin:Y}):(0,i.jsx)("p",{className:"empty-state",children:"\ucc98\ub9ac \uacb0\uacfc\ub97c \ubcfc \ud559\uae09\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."});case"admin":return(0,i.jsxs)("div",{className:"police-admin-content",children:[(0,i.jsx)("div",{className:"admin-nav-buttons",children:(0,i.jsx)("button",{onClick:pe,className:"back-to-police-button",children:"\uacbd\ucc30\uc11c\ub85c \ub3cc\uc544\uac00\uae30"})}),(0,i.jsx)(p,{reportReasons:le,onUpdateReasons:be,onDeleteAllReports:r?Ne:()=>alert("\ubaa8\ub4e0 \uc2e0\uace0 \uc0ad\uc81c\ub294 \ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub41c \ud6c4 \uac00\ub2a5\ud569\ub2c8\ub2e4.")}),(0,i.jsxs)("div",{className:"law-reasons-info",children:[(0,i.jsx)("h3",{children:"\ubc95\uc548 \uae30\ubc18 \uc2e0\uace0 \uc0ac\uc720 (\uc790\ub3d9 \uc5c5\ub370\uc774\ud2b8)"}),r?C.filter(e=>e.isLaw).length>0?(0,i.jsx)("div",{className:"law-reasons-list",children:C.filter(e=>e.isLaw).map((e,s)=>(0,i.jsxs)("div",{className:"law-reason-item",children:[(0,i.jsx)("div",{className:"reason-name",children:e.reason}),e.description&&(0,i.jsx)("div",{className:"reason-description",children:e.description}),(0,i.jsxs)("div",{className:"reason-amount",children:["\ubc8c\uae08: ",e.amount.toLocaleString(),"\uc6d0"]})]},s))}):(0,i.jsx)("p",{className:"empty-state",children:"\ud604\uc7ac \ud559\uae09\uc5d0 \uac00\uacb0\ub41c \ubc95\uc548\uc774 \uc5c6\uac70\ub098, \ubd88\ub7ec\uc624\ub294 \uc911\uc785\ub2c8\ub2e4."}):(0,i.jsx)("p",{className:"empty-state",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \ubc95\uc548 \uae30\ubc18 \uc2e0\uace0 \uc0ac\uc720\ub97c \ubcfc \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]});default:return(0,i.jsx)("p",{children:"\ud0ed\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694."})}};return(0,i.jsxs)("div",{className:"police-container",children:[(e.loading||r&&(k||de||se||ne||G||oe))&&(0,i.jsx)("div",{className:"loading-overlay-transparent",children:"\ub370\uc774\ud130 \ub3d9\uae30\ud654 \uc911..."}),(0,i.jsxs)("div",{className:"police-header-container",children:[(0,i.jsxs)("h1",{className:"police-header",children:["\uacbd\ucc30\uc11c ",r&&"(\ud559\uae09: ".concat(r,")")]}),(0,i.jsxs)("div",{className:"header-info",children:[s&&(0,i.jsxs)("span",{className:"welcome-message",children:["\ud658\uc601\ud569\ub2c8\ub2e4,"," ",s.name||s.displayName||s.id,"\ub2d8!"]}),(0,i.jsxs)("span",{className:"treasury-balance",children:["\ud604\uc7ac \uad6d\uace0 \uc794\uc561: ",(ee||0).toLocaleString(),"\uc6d0"]}),Y&&(0,i.jsx)("button",{onClick:()=>ue("admin"),className:"admin-settings-button ".concat("admin"===b?"active":""),title:"\uad00\ub9ac \uc124\uc815 \uc5f4\uae30",children:"\uad00\ub9ac \uc124\uc815"})]})]}),"admin"!==b?(0,i.jsx)(i.Fragment,{children:r?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"police-tabs",children:[(0,i.jsx)("button",{onClick:()=>ue("submit"),className:"police-tab-button ".concat("submit"===b?"active":""),children:"\uc2e0\uace0\ud558\uae30"}),(0,i.jsxs)("button",{onClick:()=>ue("status"),className:"police-tab-button ".concat("status"===b?"active":""),children:["\ucc98\ub9ac \ud604\ud669 (",Ie.length,")"]}),(0,i.jsxs)("button",{onClick:()=>ue("results"),className:"police-tab-button ".concat("results"===b?"active":""),children:["\ucc98\ub9ac \uacb0\uacfc (",Ce.length,")"]})]}),(0,i.jsx)("div",{className:"police-tab-content",children:Se()})]}):!Y&&(0,i.jsx)("div",{className:"empty-state",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc5b4\uc57c \uacbd\ucc30\uc11c \uae30\ub2a5\uc744 \uc774\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})}):Y?Se():(0,i.jsx)("div",{className:"empty-state",children:"\uad00\ub9ac\uc790\ub9cc \uc811\uadfc \uac00\ub2a5\ud569\ub2c8\ub2e4."}),A&&U&&(0,i.jsx)(v,{complaint:U,onSave:async e=>{if(!Y||!r)return void alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \ud559\uae09 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const s=(0,x.H9)(o.db,"classes",r,"policeReports",e.id);try{await(0,x.mZ)(s,{reason:e.reason,desiredResolution:e.desiredResolution,defendantId:e.defendantId,reportedUserId:e.defendantId}),me(),alert("\uace0\uc18c\uc7a5 \uc815\ubcf4\uac00 \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),L(!1),E(null)}catch(t){d.vF.error("\uace0\uc18c\uc7a5 \uc5c5\ub370\uc774\ud2b8 \uc624\ub958:",t),alert("\uace0\uc18c\uc7a5 \uc815\ubcf4 \uc5c5\ub370\uc774\ud2b8\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},onCancel:()=>{L(!1),E(null)},users:D.filter(e=>e.id!==(U.complainantId||U.reporterId)&&e.classCode===r)}),B&&O&&(0,i.jsx)(j,{complaint:O,onSave:async(e,s)=>{if(!Y||!r)return void alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \ud559\uae09 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const t=(0,x.H9)(o.db,"classes",r,"policeReports",e);try{await(0,x.mZ)(t,{judgment:s}),me(),alert("\ud310\uacb0 \ub0b4\uc6a9\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),M(!1),T(null)}catch(a){d.vF.error("\ud310\uacb0 \uc800\uc7a5 \uc624\ub958:",a),alert("\ud310\uacb0 \ub0b4\uc6a9 \uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},onCancel:()=>{M(!1),T(null)}}),_&&J&&(0,i.jsx)(N,{complaint:J,users:D,onSave:async(e,s,t,a,n,l)=>{if(d.vF.log("handleSendSettlement \ud638\ucd9c\ub428 (Cloud Function):",{reportId:e,amount:s,senderId:t,recipientId:a,reason:n,adminId:l}),!Y||!r)return alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \ud559\uae09 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),!1;try{const r=await(0,o.Xz)({reportId:e,amount:s,senderId:t,recipientId:a,reason:n,adminId:l});if(r.success)return alert(r.message||"\ud569\uc758\uae08 \uc9c0\uae09 \ucc98\ub9ac\uac00 \uc131\uacf5\uc801\uc73c\ub85c \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),me(),q(!1),P(null),!0;throw new Error(r.message||"\uc11c\ubc84\uc5d0\uc11c \ucc98\ub9ac\ub97c \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(i){return d.vF.error("\ud569\uc758\uae08 \ucc98\ub9ac \uc2e4\ud328 (Cloud Function):",i),alert("\uc624\ub958: ".concat(i.message||"\ud569\uc758\uae08 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")),!1}},onCancel:()=>{q(!1),P(null)},getUserNameById:H})]})}}}]);
//# sourceMappingURL=44.023494d5.chunk.js.map