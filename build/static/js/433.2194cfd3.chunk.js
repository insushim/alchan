"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[433,657],{6555(e,s,a){a.d(s,{Gu:()=>r,LN:()=>l,pp:()=>d,rA:()=>c,zY:()=>i});a(5043);var t=a(2024),n=(a(5881),a(579));const l=e=>{let{children:s,className:a=""}=e;return(0,n.jsx)("div",{className:"min-h-full w-full bg-[#0a0a12] ".concat(a),children:(0,n.jsx)("div",{className:"w-full max-w-none px-2 md:px-3 lg:px-4 py-1 md:py-2",children:s})})},i=e=>{let{title:s,subtitle:a,icon:t,badge:l,action:i,backButton:r,className:d=""}=e;return(0,n.jsxs)("section",{className:"bg-[#14142380] backdrop-blur-sm rounded-lg px-3 py-1.5 md:px-4 md:py-2 shadow-lg border border-cyan-900/30 flex flex-col md:flex-row md:items-center justify-between gap-1.5 md:gap-2 mb-2 md:mb-3 ".concat(d),children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[r,t&&(0,n.jsx)("div",{className:"w-9 h-9 md:w-10 md:h-10 bg-cyan-900/30 rounded-lg flex items-center justify-center text-cyan-400 shrink-0 shadow-sm border border-cyan-500/30",children:(0,n.jsx)(t,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("h2",{className:"text-lg md:text-xl font-bold text-white tracking-tight",children:s}),l]}),a&&(0,n.jsx)("p",{className:"text-xs md:text-sm text-slate-400 font-medium",children:a})]})]}),i&&(0,n.jsx)("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 md:ml-auto",children:i})]})},r=e=>{let{message:s="\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."}=e;return null},d=e=>{let{icon:s,title:a,description:t,action:l}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[s&&(0,n.jsx)("div",{className:"w-16 h-16 rounded-full bg-[#14142380] shadow-lg flex items-center justify-center mb-4 border border-cyan-900/30",children:(0,n.jsx)(s,{className:"w-8 h-8 text-slate-400"})}),a&&(0,n.jsx)("h3",{className:"text-lg font-bold text-slate-300 mb-2",children:a}),t&&(0,n.jsx)("p",{className:"text-slate-500 font-medium mb-6 max-w-md",children:t}),l]})},c=e=>{let{children:s,icon:a,variant:l="primary",size:i="md",loading:r=!1,disabled:d=!1,onClick:c,className:o="",title:m}=e;return(0,n.jsxs)("button",{onClick:c,disabled:d||r,title:m,className:"inline-flex items-center justify-center gap-2 font-bold rounded-xl transition-all duration-200 active:scale-95 whitespace-nowrap focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ".concat({primary:"bg-cyan-500 text-slate-900 hover:bg-cyan-400 ring-1 ring-cyan-400 shadow-cyan-500/30",secondary:"bg-slate-800 hover:bg-slate-700 text-slate-200",outline:"bg-transparent text-slate-300 ring-1 ring-slate-600 hover:bg-slate-800 hover:ring-slate-500 shadow-sm","outline-green":"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm","outline-red":"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm",danger:"bg-transparent text-rose-400 ring-1 ring-rose-600 hover:bg-rose-900/30 hover:ring-rose-500 shadow-sm",success:"bg-transparent text-emerald-400 ring-1 ring-emerald-600 hover:bg-emerald-900/30 hover:ring-emerald-500 shadow-sm",ghost:"text-slate-400 hover:bg-slate-800 hover:text-white",indigo:"bg-purple-900/30 text-purple-400 hover:bg-purple-900/50"}[l]," ").concat({sm:"px-4 py-2 text-sm",md:"px-5 py-2.5 text-sm",lg:"px-6 py-3 text-base"}[i]," ").concat(o),children:[r?(0,n.jsx)(t.A,{className:"w-4 h-4 animate-spin"}):a?(0,n.jsx)(a,{className:"w-4 h-4"}):null,s]})}},8625(e,s,a){a.r(s),a.d(s,{default:()=>xe});var t=a(2555),n=a(5043),l=a(5016),i=a(4689),r=a(5472),d=a(2395),c=a(7950);var o=a(5452),m=a(579);const u=(0,n.memo)(function(e){let{task:s,onEarnCoupon:a,isJobTask:l,isAdmin:i,onEditTask:r,onDeleteTask:d,taskId:u,jobId:I=null}=e;const[M,J]=(0,n.useState)(!1),[E,R]=(0,n.useState)(""),[_,O]=(0,n.useState)(!1),[P,L]=(0,n.useState)(null),[W,z]=(0,n.useState)(null),[H,B]=(0,n.useState)(!1),G=e=>{H||W||(o.vF.log("[TaskItem] \uce74\ub4dc \uc120\ud0dd:",{cardType:e,taskId:u,jobId:I,isJobTask:l}),z(e),B(!0),setTimeout(()=>{const t="cash"===e?P.cash:P.coupon,n="cash"===e?"".concat(t.toLocaleString(),"\uc6d0"):"".concat(t,"\uac1c");o.vF.log("[TaskItem] onEarnCoupon \ud638\ucd9c \uc900\ube44:",{taskId:u,jobId:I,isJobTask:l,cardType:e,reward:t}),"function"===typeof a&&a(u||s.id,I,l,e,t),O(!1),R("".concat("cash"===e?"\ud83d\udcb0 \ud604\uae08":"\ud83c\udfab \ucfe0\ud3f0"," ").concat(n," \ud68d\ub4dd! \ud83d\ude0a")),J(!0),B(!1)},800))};(0,n.useEffect)(()=>{let e;return M&&(e=setTimeout(()=>{J(!1),R("")},2e3)),()=>clearTimeout(e)},[M]);const K=s&&s.maxClicks>0&&s.clicks>=s.maxClicks;if(!s)return null;const q=window.innerWidth<=768,V={backgroundColor:K?"rgba(20, 20, 35, 0.4)":"rgba(30, 30, 50, 0.6)",border:"1px solid ".concat(K?"rgba(100, 116, 139, 0.1)":"rgba(0, 255, 242, 0.15)"),opacity:K?.6:1,padding:q?"8px 10px":"12px",boxShadow:K?"none":"0 4px 12px rgba(0, 0, 0, 0.1)"},Q={gap:q?"6px":"10px"},X={color:K?"#64748b":"#e8e8ff",fontSize:q?"12px":"16px",lineHeight:"1.4"},Y={gap:q?"4px":"8px"},U={backgroundColor:l?"rgba(79, 70, 229, 0.3)":"rgba(16, 185, 129, 0.3)",color:l?"#818cf8":"#34d399",border:l?"1px solid rgba(99, 102, 241, 0.5)":"1px solid rgba(52, 211, 153, 0.5)",padding:q?"3px 6px":"4px 10px",fontSize:q?"10px":"13px"};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"flex flex-row items-center justify-between relative rounded-lg mb-2 transition-all",style:(0,t.A)((0,t.A)({},V),{},{cursor:K?"default":"pointer",gap:q?"6px":"8px"}),onClick:K?null:()=>{if(o.vF.log("[TaskItem] handleInternalClick \ud638\ucd9c\ub428:",{taskName:null===s||void 0===s?void 0:s.name,isJobTask:l,taskId:u,jobId:I}),!s||"number"!==typeof s.clicks||"number"!==typeof s.maxClicks)return void o.vF.error("Invalid task prop:",s);if(s.maxClicks>0&&s.clicks>=s.maxClicks)return;o.vF.log("[TaskItem] \uce74\ub4dc \ubaa8\ub2ec \uc5f4\uae30");const e=(()=>{const e=e=>{const s=e.reduce((e,s)=>e+s.weight,0);let a=Math.random()*s;for(const t of e)if(a-=t.weight,a<=0)return t.amount;return e[e.length-1].amount};return{cash:e([{amount:5e4,weight:5},{amount:3e4,weight:10},{amount:2e4,weight:15},{amount:1e4,weight:20},{amount:5e3,weight:18},{amount:3e3,weight:12},{amount:1e3,weight:10},{amount:500,weight:7},{amount:100,weight:3}]),coupon:e([{amount:20,weight:10},{amount:10,weight:20},{amount:5,weight:20},{amount:3,weight:20},{amount:1,weight:30}])}})();L(e),z(null),B(!1),O(!0)},children:[(0,m.jsx)("div",{className:"flex items-center flex-grow min-w-0 overflow-hidden",style:Q,children:(0,m.jsx)("span",{className:"font-semibold overflow-hidden text-ellipsis whitespace-nowrap flex-1 min-w-0",style:X,title:s.name,children:s.name})}),(0,m.jsxs)("div",{className:"flex items-center flex-shrink-0",style:Y,children:[(0,m.jsx)("span",{className:"rounded-lg font-medium whitespace-nowrap",style:U,children:"\ud83c\udf81 \ub79c\ub364\ubcf4\uc0c1"}),i&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("button",{onClick:e=>{e.stopPropagation(),r()},className:"cursor-pointer p-1 flex items-center justify-center",style:h,"aria-label":"\ud560\uc77c \uc218\uc815",children:"\u270f\ufe0f"}),(0,m.jsx)("button",{onClick:e=>{e.stopPropagation(),d()},className:"cursor-pointer p-1 flex items-center justify-center",style:h,"aria-label":"\ud560\uc77c \uc0ad\uc81c",children:"\ud83d\uddd1\ufe0f"})]})]}),M&&(0,m.jsxs)("div",{className:"absolute left-1/2 -translate-x-1/2 rounded-md font-medium whitespace-nowrap z-10 pointer-events-none",style:x,children:[E,(0,m.jsx)("div",{className:"absolute",style:g})]})]}),(()=>{if(!_||!P)return null;const e=(0,t.A)((0,t.A)({},b),{},{padding:q?"20px":"40px"}),s=(0,t.A)((0,t.A)({},v),{},{fontSize:q?"20px":"28px"}),a=(0,t.A)((0,t.A)({},j),{},{fontSize:q?"13px":"16px"}),n=(0,t.A)((0,t.A)({},f),{},{gap:q?"15px":"20px"}),l=(0,t.A)((0,t.A)({},y),{},{width:q?"140px":"200px",height:q?"200px":"280px"}),i=(0,t.A)((0,t.A)({},S),{},{fontSize:q?"50px":"80px",marginBottom:q?"10px":"20px"}),r=(0,t.A)((0,t.A)({},F),{},{fontSize:q?"18px":"24px"}),d=(0,t.A)((0,t.A)({},T),{},{fontSize:q?"24px":"36px"}),o=(0,t.A)((0,t.A)({},D),{},{fontSize:q?"14px":"18px"});return(0,c.createPortal)((0,m.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-[10000]",style:p,onClick:()=>O(!1),children:(0,m.jsxs)("div",{className:"rounded-[20px] max-w-[600px]",style:(0,t.A)((0,t.A)({},e),{},{width:q?"95%":"90%"}),onClick:e=>e.stopPropagation(),children:[(0,m.jsx)("h3",{className:"text-center font-bold",style:(0,t.A)((0,t.A)({},s),{},{marginBottom:q?"8px":"10px"}),children:"\ud83c\udf81 \ubcf4\uc0c1 \uc120\ud0dd"}),(0,m.jsx)("p",{className:"text-center",style:(0,t.A)((0,t.A)({},a),{},{marginBottom:q?"20px":"30px"}),children:"\ub450 \uac1c\uc758 \uce74\ub4dc \uc911 \ud558\ub098\ub97c \uc120\ud0dd\ud558\uc138\uc694!"}),(0,m.jsxs)("div",{className:"flex justify-center flex-wrap",style:n,children:[(0,m.jsx)("div",{className:"cursor-pointer",style:(0,t.A)((0,t.A)({},l),"cash"===W&&N),onClick:()=>!W&&G("cash"),children:(0,m.jsxs)("div",{className:"relative w-full h-full",style:(0,t.A)((0,t.A)({},k),{},{transform:"cash"===W?"rotateY(180deg)":"rotateY(0deg)"}),children:[(0,m.jsxs)("div",{className:"absolute w-full h-full rounded-2xl flex flex-col items-center justify-center",style:(0,t.A)((0,t.A)({},w),{},{backfaceVisibility:"hidden"}),children:[(0,m.jsx)("div",{style:i,children:"\ud83d\udcb0"}),(0,m.jsx)("div",{className:"text-2xl font-bold",style:r,children:"\ud604\uae08"})]}),(0,m.jsxs)("div",{className:"absolute w-full h-full rounded-2xl flex flex-col items-center justify-center",style:(0,t.A)((0,t.A)((0,t.A)({},A),"cash"===W&&C),{},{backfaceVisibility:"hidden"}),children:[(0,m.jsxs)("div",{className:"text-4xl font-bold mb-2.5",style:d,children:[P.cash.toLocaleString(),"\uc6d0"]}),(0,m.jsx)("div",{className:"text-lg",style:o,children:"\ud83d\udcb0 \ud604\uae08 \ud68d\ub4dd!"})]})]})}),(0,m.jsx)("div",{className:"cursor-pointer",style:(0,t.A)((0,t.A)({},l),"coupon"===W&&N),onClick:()=>!W&&G("coupon"),children:(0,m.jsxs)("div",{className:"relative w-full h-full",style:(0,t.A)((0,t.A)({},k),{},{transform:"coupon"===W?"rotateY(180deg)":"rotateY(0deg)"}),children:[(0,m.jsxs)("div",{className:"absolute w-full h-full rounded-2xl flex flex-col items-center justify-center",style:(0,t.A)((0,t.A)({},w),{},{backfaceVisibility:"hidden"}),children:[(0,m.jsx)("div",{style:i,children:"\ud83c\udfab"}),(0,m.jsx)("div",{className:"text-2xl font-bold",style:r,children:"\ucfe0\ud3f0"})]}),(0,m.jsxs)("div",{className:"absolute w-full h-full rounded-2xl flex flex-col items-center justify-center",style:(0,t.A)((0,t.A)((0,t.A)({},A),"coupon"===W&&C),{},{backfaceVisibility:"hidden"}),children:[(0,m.jsxs)("div",{className:"text-4xl font-bold mb-2.5",style:d,children:[P.coupon,"\uac1c"]}),(0,m.jsx)("div",{className:"text-lg",style:o,children:"\ud83c\udfab \ucfe0\ud3f0 \ud68d\ub4dd!"})]})]})})]})]})}),document.body)})()]})}),h={background:"none",border:"none",fontSize:"16px",color:"#94a3b8"},x={bottom:"calc(100% + 8px)",backgroundColor:"rgba(0, 0, 0, 0.75)",color:"white",padding:"5px 10px",fontSize:"12px",boxShadow:"0 2px 5px rgba(0,0,0,0.2)"},g={content:'""',top:"100%",left:"50%",marginLeft:"-5px",borderWidth:"5px",borderStyle:"solid",borderColor:"rgba(0, 0, 0, 0.75) transparent transparent transparent"},p={backgroundColor:"rgba(0, 0, 0, 0.7)",animation:"fadeIn 0.3s ease"},b={backgroundColor:"#1a1a2e",border:"1px solid rgba(0, 255, 242, 0.3)",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",animation:"zoomIn 0.3s ease"},v={color:"#ffffff",textShadow:"0 0 10px rgba(0, 255, 242, 0.5)"},j={color:"#a0a0c0"},f={gap:"20px"},y={perspective:"1000px",transition:"transform 0.2s ease"},N={transform:"scale(1.05)"},k={transition:"transform 0.8s",transformStyle:"preserve-3d"},w={background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.2)",border:"3px solid #fff"},A={backgroundColor:"#fff",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.2)",border:"3px solid #667eea",transform:"rotateY(180deg)",opacity:0,transition:"opacity 0.3s ease 0.4s"},C={opacity:1},S={fontSize:"80px",marginBottom:"20px"},F={color:"white"},T={color:"#667eea"},D={color:"#666"},I=(0,n.memo)(function(e){let{job:s,isAdmin:a,onEditJob:t,onDeleteJob:n,onAddTask:l,onEditTask:i,onDeleteTask:r,onEarnCoupon:d,addJobTaskButtonStyle:c}=e;if(!s)return null;const o=window.innerWidth<=768;return(0,m.jsxs)("div",{className:"flex flex-col h-full rounded-lg overflow-hidden mb-4",style:{backgroundColor:"rgba(20, 20, 35, 0.6)",border:"1px solid rgba(0, 255, 242, 0.2)",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.3)",backdropFilter:"blur(5px)"},children:[(0,m.jsxs)("div",{className:"job-header-container flex justify-between items-center",style:{background:"linear-gradient(135deg, rgba(79, 70, 229, 0.2) 0%, rgba(99, 102, 241, 0.2) 100%)",padding:o?"12px 14px":"14px 16px",borderBottom:"1px solid rgba(0, 255, 242, 0.2)"},children:[(0,m.jsx)("div",{className:"job-title-text font-bold",style:{fontSize:o?"15px":"18px",textShadow:"0 0 10px rgba(0, 255, 242, 0.3)",letterSpacing:"-0.01em",color:"#e8e8ff"},children:s.title}),a&&(0,m.jsxs)("div",{children:[(0,m.jsx)("button",{onClick:()=>t(s.id),className:"cursor-pointer p-0 mr-2",style:{background:"none",border:"none",color:"rgba(255, 255, 255, 0.7)"},"aria-label":"".concat(s.title," \uc9c1\uc5c5 \uc218\uc815"),children:"\u270f\ufe0f"}),(0,m.jsx)("button",{onClick:()=>n(s.id),className:"cursor-pointer p-0",style:{background:"none",border:"none",color:"rgba(255, 255, 255, 0.7)"},"aria-label":"".concat(s.title," \uc9c1\uc5c5 \uc0ad\uc81c"),children:"\ud83d\uddd1\ufe0f"})]})]}),(0,m.jsx)("div",{className:"flex-grow overflow-y-auto",style:{padding:o?"8px":"10px"},children:s.tasks&&s.tasks.length>0?s.tasks.map(e=>(0,m.jsx)(u,{task:e,taskId:e.id,jobId:s.id,onEarnCoupon:d,onEditTask:()=>i(e.id,s.id),onDeleteTask:()=>r(e.id,s.id),isAdmin:a,isJobTask:!0},e.id)):(0,m.jsx)("p",{className:"text-center my-2.5",style:{fontSize:"13px",color:"#9999bb"},children:"\ub4f1\ub85d\ub41c \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})}),a&&(0,m.jsx)("div",{style:{padding:o?"8px":"10px",borderTop:"1px solid rgba(0, 255, 242, 0.1)"},children:(0,m.jsx)("button",{onClick:l,className:"w-full cursor-pointer rounded-md mt-0 transition-all",style:c||{padding:o?"6px":"8px",backgroundColor:"rgba(0, 255, 242, 0.1)",border:"1px solid rgba(0, 255, 242, 0.3)",color:"#00fff2",fontSize:o?"12px":"13px",fontWeight:"500"},children:"+ \uc774 \uc9c1\uc5c5\uc5d0 \ud560\uc77c \ucd94\uac00"})})]},s.id)});function M(e){let{tasks:s,isAdmin:a,onEditTask:t,onDeleteTask:n,onEarnCoupon:l}=e;if(!Array.isArray(s)||0===s.length)return(0,m.jsx)("div",{className:"p-5 text-center",style:{color:"#6b7280"},children:a?"\ub4f1\ub85d\ub41c \uacf5\ud1b5 \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790 \uc124\uc815\uc5d0\uc11c \ucd94\uac00\ud574\uc8fc\uc138\uc694.":"\ud604\uc7ac \uc218\ud589\ud560 \uc218 \uc788\ub294 \uacf5\ud1b5 \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."});const i="undefined"!==typeof window&&window.innerWidth<=768;return(0,m.jsx)("div",{className:"grid",style:{gridTemplateColumns:i?"1fr":"repeat(2, 1fr)",gap:i?"8px":"10px"},children:s.map(e=>(0,m.jsx)(u,{task:e,taskId:e.id,onEarnCoupon:l,onEditTask:()=>t(e.id),onDeleteTask:()=>n(e.id),isAdmin:a,isJobTask:!1},e.id))})}var J=a(2532),E=a(3248),R=a(7097);const _=e=>{const s=(0,d.Qg)(i.Cn,e);return async a=>{try{const e=await s(a);if(e.data.success)return e.data;throw new Error(e.data.message||"\ud568\uc218 \uc2e4\ud589 \uc2e4\ud328")}catch(t){throw o.vF.error("".concat(e," \uc624\ub958:"),t),t}}},O={getAdminSettingsData:_("getAdminSettingsData"),batchPaySalaries:_("batchPaySalaries"),getItemContextData:_("getItemContextData")},P=(e,s)=>["adminSettings",e,s],L=e=>["students",e],W=e=>["salarySettings",e],z=()=>["systemManagement"],H=()=>navigator.onLine&&!document.hidden,B=(e,s)=>{try{localStorage.setItem("backup_".concat(e),JSON.stringify({data:s,timestamp:Date.now()}))}catch(a){o.vF.warn("\ub85c\uceec \ubc31\uc5c5 \uc800\uc7a5 \uc2e4\ud328:",a)}},G=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e4;try{const a=localStorage.getItem("backup_".concat(e));if(a){const e=JSON.parse(a);if(Date.now()-e.timestamp<s)return e.data}}catch(a){o.vF.warn("\ub85c\uceec \ubc31\uc5c5 \ub85c\ub4dc \uc2e4\ud328:",a)}return null},K=e=>{try{localStorage.removeItem("backup_".concat(e))}catch(s){o.vF.warn("\ub85c\uceec \ubc31\uc5c5 \uc0ad\uc81c \uc2e4\ud328:",s)}},q=e=>{let{isSuperAdmin:s}=e;const[a,t]=(0,n.useState)(null),[l,r]=(0,n.useState)(!1),[c,u]=(0,n.useState)(null),[h,x]=(0,n.useState)(!1),[g,p]=(0,n.useState)(null),[b,v]=(0,n.useState)(0),j=(0,d.Qg)(i.Cn,"getSystemStatus"),f=(0,d.Qg)(i.Cn,"resolveSystemAlert"),y=(0,n.useCallback)(async()=>{if(s){r(!0),u(null);try{const e=await j();if(!e.data.success)throw new Error(e.data.message||"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc \uc870\ud68c \uc2e4\ud328");t(e.data.data),p(new Date),v(0)}catch(e){o.vF.error("[SystemMonitoring] \uc0c1\ud0dc \uc870\ud68c \uc624\ub958:",e),u(e.message||"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc\ub97c \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),v(e=>e+1),b>=2&&(x(!1),o.vF.warn("[SystemMonitoring] \uc5f0\uc18d \uc5d0\ub7ec \ubc1c\uc0dd\uc73c\ub85c \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\uc744 \uc911\uc9c0\ud569\ub2c8\ub2e4."))}finally{r(!1)}}},[s,j,b]),N=(0,n.useCallback)(async e=>{if(window.confirm("\uc774 \uacbd\uace0\ub97c \ud574\uacb0 \ucc98\ub9ac\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))try{(await f({alertId:e})).data.success&&(alert("\uacbd\uace0\uac00 \ud574\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),y())}catch(s){o.vF.error("[SystemMonitoring] \uacbd\uace0 \ud574\uacb0 \uc624\ub958:",s),alert("\uacbd\uace0 \ud574\uacb0 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(s.message))}},[f,y]);return(0,n.useEffect)(()=>{s&&y()},[s,y]),(0,n.useEffect)(()=>{if(!h||!s)return;const e=setInterval(()=>{y()},12e4);return()=>clearInterval(e)},[h,s,y]),(0,n.useEffect)(()=>{h&&v(0)},[h]),s?(0,m.jsxs)("div",{className:"system-monitoring section-card",children:[(0,m.jsxs)("div",{className:"monitoring-header",children:[(0,m.jsx)("h3",{children:"\ud83d\udda5\ufe0f \uc11c\ubc84 \uc0c1\ud0dc \ubaa8\ub2c8\ud130\ub9c1"}),(0,m.jsxs)("div",{className:"monitoring-controls",children:[(0,m.jsxs)("label",{className:"auto-refresh-toggle",children:[(0,m.jsx)("input",{type:"checkbox",checked:h,onChange:e=>x(e.target.checked)}),(0,m.jsx)("span",{children:"\uc790\ub3d9 \uc0c8\ub85c\uace0\uce68 (30\ucd08)"})]}),(0,m.jsx)("button",{onClick:y,disabled:l,className:"refresh-button",children:l?"\u23f3 \uc870\ud68c \uc911...":"\ud83d\udd04 \uc0c8\ub85c\uace0\uce68"})]})]}),g&&(0,m.jsxs)("p",{className:"last-update",children:["\ub9c8\uc9c0\ub9c9 \uc5c5\ub370\uc774\ud2b8: ",g.toLocaleTimeString("ko-KR")]}),c&&(0,m.jsxs)("div",{className:"error-message",children:[(0,m.jsxs)("p",{children:["\u274c ",c]}),b>=3&&(0,m.jsx)("p",{style:{marginTop:"8px",fontSize:"14px"},children:"\u26a0\ufe0f \uc5f0\uc18d \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud558\uc5ec \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\uc774 \uc911\uc9c0\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc218\ub3d9\uc73c\ub85c \uc0c8\ub85c\uace0\uce68\ud558\uac70\ub098 \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\uc744 \ub2e4\uc2dc \ud65c\uc131\ud654\ud574\uc8fc\uc138\uc694."})]}),a&&(0,m.jsxs)(m.Fragment,{children:[a.message&&(0,m.jsx)("div",{className:"info-message",style:{padding:"12px",background:"#e3f2fd",border:"1px solid #90caf9",borderRadius:"4px",marginBottom:"15px",color:"#1976d2"},children:(0,m.jsxs)("p",{style:{margin:0},children:["\u2139\ufe0f ",a.message]})}),(0,m.jsxs)("div",{className:"system-health-card",children:[(0,m.jsx)("h4",{children:"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc"}),(0,m.jsxs)("div",{className:"health-indicator health-".concat(a.health),children:[(0,m.jsx)("span",{className:"health-icon",children:"healthy"===a.health?"\u2705":"warning"===a.health?"\u26a0\ufe0f":"\ud83d\udea8"}),(0,m.jsx)("span",{className:"health-text",children:"healthy"===a.health?"\uc815\uc0c1":"warning"===a.health?"\uc8fc\uc758":"\uc704\ud5d8"})]}),(0,m.jsx)("div",{className:"stats-grid",children:(0,m.jsxs)("div",{className:"stat-item",children:[(0,m.jsx)("span",{className:"stat-label",children:"\uc804\uccb4 \uc0ac\uc6a9\uc790"}),(0,m.jsx)("span",{className:"stat-value",children:a.totalUsers})]})})]}),(0,m.jsxs)("div",{className:"stats-card",children:[(0,m.jsx)("h4",{children:"\ucd5c\uadfc 1\ubd84 \ud1b5\uacc4"}),(0,m.jsxs)("div",{className:"stats-grid",children:[(0,m.jsxs)("div",{className:"stat-item",children:[(0,m.jsx)("span",{className:"stat-label",children:"\uc77d\uae30 \uc791\uc5c5"}),(0,m.jsx)("span",{className:"stat-value",children:a.stats.lastMinute.reads.toLocaleString()})]}),(0,m.jsxs)("div",{className:"stat-item",children:[(0,m.jsx)("span",{className:"stat-label",children:"\uc4f0\uae30 \uc791\uc5c5"}),(0,m.jsx)("span",{className:"stat-value",children:a.stats.lastMinute.writes.toLocaleString()})]}),(0,m.jsxs)("div",{className:"stat-item",children:[(0,m.jsx)("span",{className:"stat-label",children:"\uc5d0\ub7ec \uc218"}),(0,m.jsx)("span",{className:"stat-value",children:a.stats.lastMinute.errors})]}),(0,m.jsxs)("div",{className:"stat-item",children:[(0,m.jsx)("span",{className:"stat-label",children:"\uc5d0\ub7ec\uc728"}),(0,m.jsxs)("span",{className:"stat-value",children:[(100*a.stats.lastMinute.errorRate).toFixed(2),"%"]})]}),(0,m.jsxs)("div",{className:"stat-item",children:[(0,m.jsx)("span",{className:"stat-label",children:"\ud3c9\uade0 \uc751\ub2f5 \uc2dc\uac04"}),(0,m.jsxs)("span",{className:"stat-value",children:[a.stats.lastMinute.avgResponseTime.toFixed(0),"ms"]})]})]})]}),a.anomalies&&a.anomalies.length>0&&(0,m.jsxs)("div",{className:"anomalies-card",children:[(0,m.jsx)("h4",{children:"\u26a0\ufe0f \ube44\uc815\uc0c1 \ud328\ud134 \uac10\uc9c0"}),(0,m.jsx)("div",{className:"anomalies-list",children:a.anomalies.map((e,s)=>(0,m.jsxs)("div",{className:"anomaly-item anomaly-".concat(e.severity),children:[(0,m.jsxs)("div",{className:"anomaly-header",children:[(0,m.jsx)("span",{className:"anomaly-severity",children:"critical"===e.severity?"\ud83d\udea8 \uc2ec\uac01":"error"===e.severity?"\u274c \uc624\ub958":"\u26a0\ufe0f \uacbd\uace0"}),(0,m.jsx)("span",{className:"anomaly-type",children:e.type})]}),(0,m.jsx)("p",{className:"anomaly-message",children:e.message})]},s))})]}),a.alerts&&a.alerts.length>0&&(0,m.jsxs)("div",{className:"alerts-card",children:[(0,m.jsxs)("h4",{children:["\ud83d\udd14 \ud65c\uc131 \uacbd\uace0 (",a.alerts.length,")"]}),(0,m.jsx)("div",{className:"alerts-list",children:a.alerts.map(e=>{var s,a;const t=null!==(s=e.timestamp)&&void 0!==s&&s.toDate?e.timestamp.toDate():new Date(1e3*(null===(a=e.timestamp)||void 0===a?void 0:a.seconds)||Date.now());return(0,m.jsxs)("div",{className:"alert-item alert-".concat(e.severity),children:[(0,m.jsxs)("div",{className:"alert-header",children:[(0,m.jsx)("span",{className:"alert-time",children:t.toLocaleString("ko-KR")}),(0,m.jsx)("button",{onClick:()=>N(e.id),className:"resolve-alert-button",children:"\ud574\uacb0"})]}),(0,m.jsx)("p",{className:"alert-message",children:e.message})]},e.id)})})]}),a.errorLogs&&a.errorLogs.length>0&&(0,m.jsxs)("div",{className:"error-logs-card",children:[(0,m.jsx)("h4",{children:"\ud83d\udcdd \ucd5c\uadfc \uc5d0\ub7ec \ub85c\uadf8 (1\uc2dc\uac04)"}),(0,m.jsx)("div",{className:"error-logs-list",children:a.errorLogs.slice(0,10).map(e=>{var s,a;const t=null!==(s=e.timestamp)&&void 0!==s&&s.toDate?e.timestamp.toDate():new Date(1e3*(null===(a=e.timestamp)||void 0===a?void 0:a.seconds)||Date.now());return(0,m.jsxs)("div",{className:"error-log-item",children:[(0,m.jsx)("span",{className:"log-time",children:t.toLocaleTimeString("ko-KR")}),(0,m.jsx)("span",{className:"log-message",children:e.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958"})]},e.id)})})]}),(0,m.jsxs)("div",{className:"stats-card",children:[(0,m.jsx)("h4",{children:"\ucd5c\uadfc 5\ubd84 \ud1b5\uacc4"}),(0,m.jsxs)("div",{className:"stats-grid",children:[(0,m.jsxs)("div",{className:"stat-item",children:[(0,m.jsx)("span",{className:"stat-label",children:"\ucd1d \uc77d\uae30 \uc791\uc5c5"}),(0,m.jsx)("span",{className:"stat-value",children:a.stats.last5Minutes.reads.toLocaleString()})]}),(0,m.jsxs)("div",{className:"stat-item",children:[(0,m.jsx)("span",{className:"stat-label",children:"\ucd1d \uc4f0\uae30 \uc791\uc5c5"}),(0,m.jsx)("span",{className:"stat-value",children:a.stats.last5Minutes.writes.toLocaleString()})]}),(0,m.jsxs)("div",{className:"stat-item",children:[(0,m.jsx)("span",{className:"stat-label",children:"\ucd1d \uc5d0\ub7ec"}),(0,m.jsx)("span",{className:"stat-value",children:a.stats.last5Minutes.errors})]})]})]})]}),!a&&!l&&!c&&(0,m.jsx)("div",{className:"no-data-message",children:(0,m.jsx)("p",{children:"\uc2dc\uc2a4\ud15c \uc0c1\ud0dc \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub824\uba74 \uc0c8\ub85c\uace0\uce68 \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694."})})]}):(0,m.jsxs)("div",{className:"system-monitoring section-card",children:[(0,m.jsx)("h3",{children:"\ud83d\udd12 \uc11c\ubc84 \uc0c1\ud0dc \ubaa8\ub2c8\ud130\ub9c1"}),(0,m.jsx)("p",{className:"admin-section-desc",children:"\ucd5c\uace0 \uad00\ub9ac\uc790\ub9cc \uc811\uadfc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})]})};var V=a(5967);const Q=[{id:"KP",name:"\ucf54\ub529 \ud30c\ud2b8\ub108",price:1e4,history:[{price:1e4,timestamp:new Date}]},{id:"SS",name:"\uc0bc\uc131\uc804\uc790",price:8e4,history:[{price:8e4,timestamp:new Date}]},{id:"LG",name:"LG\uc5d0\ub108\uc9c0\uc194\ub8e8\uc158",price:35e4,history:[{price:35e4,timestamp:new Date}]},{id:"SK",name:"SK\ud558\uc774\ub2c9\uc2a4",price:23e4,history:[{price:23e4,timestamp:new Date}]}],X=e=>{let{userClassCode:s,isAdmin:a,isSuperAdmin:t}=e;const[l,r]=(0,n.useState)(""),[d,c]=(0,n.useState)(!1),[u,h]=(0,n.useState)(!1);return a||t?(0,m.jsxs)("div",{className:"section-card mt-6 border-2 border-red-500/50 bg-red-900/10",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,m.jsx)("span",{className:"text-2xl",children:"\u26a0\ufe0f"}),(0,m.jsx)("h3",{className:"text-xl font-bold text-red-400",children:"\uc704\ud5d8 \uad6c\uc5ed: \ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c"})]}),(0,m.jsxs)("div",{className:"bg-red-900/20 rounded-lg p-4 mb-4 border border-red-500/30",children:[(0,m.jsx)("p",{className:"text-sm text-red-200 mb-2",children:(0,m.jsx)("strong",{children:"\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4!"})}),(0,m.jsx)("p",{className:"text-sm text-red-200 mb-2",children:"\uac1c\uc778\uc815\ubcf4 \ud30c\uae30 \uc758\ubb34\ub97c \uc704\ud574 \ud559\ub144 \ub9d0\uc5d0 \uc0ac\uc6a9\ud558\uc138\uc694."}),(0,m.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:"\uc0ad\uc81c \ub300\uc0c1:"}),(0,m.jsxs)("ul",{className:"text-sm text-gray-300 list-disc list-inside ml-2 space-y-1",children:[(0,m.jsx)("li",{children:"\ud559\uc0dd \uacc4\uc815 (role: 'student')"}),(0,m.jsx)("li",{children:"\ud65c\ub3d9 \ub85c\uadf8 (activity_logs)"}),(0,m.jsx)("li",{children:"\uac70\ub798 \ub0b4\uc5ed (transactions)"})]}),(0,m.jsx)("p",{className:"text-sm text-green-300 mt-2",children:"\u2713 \uc120\uc0dd\ub2d8(admin) \uacc4\uc815\uc740 \uc720\uc9c0\ub429\ub2c8\ub2e4."}),(0,m.jsx)("p",{className:"text-sm text-green-300",children:"\u2713 \uc9c1\uc5c5, \ud560\uc77c, \uc0c1\uc810 \uc544\uc774\ud15c \uc124\uc815\uc740 \uc720\uc9c0\ub429\ub2c8\ub2e4."})]}),u?(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:['\ud655\uc778\uc744 \uc704\ud574 "',(0,m.jsx)("strong",{className:"text-red-400",children:"\uc0ad\uc81c"}),'"\ub97c \uc815\ud655\ud788 \uc785\ub825\ud558\uc138\uc694:']}),(0,m.jsx)("input",{type:"text",value:l,onChange:e=>r(e.target.value),placeholder:"\uc0ad\uc81c",disabled:d,className:"w-full px-4 py-2 bg-[#1a1a2e] border border-gray-600 rounded-lg text-white focus:outline-none focus:border-red-500"})]}),(0,m.jsxs)("div",{className:"flex gap-3",children:[(0,m.jsx)("button",{onClick:async()=>{if(!s)return void alert("\ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");if("\uc0ad\uc81c"!==l)return void alert("'\uc0ad\uc81c'\ub97c \uc815\ud655\ud788 \uc785\ub825\ud574\uc8fc\uc138\uc694.");if(window.confirm("\uc815\ub9d0\ub85c '".concat(s,"' \ud559\uae09\uc758 \ubaa8\ub4e0 \ud559\uc0dd \ub370\uc774\ud130\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\n\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc73c\uba70 \ub2e4\uc74c \ub370\uc774\ud130\uac00 \uc601\uad6c \uc0ad\uc81c\ub429\ub2c8\ub2e4:\n- \ud559\uc0dd \uacc4\uc815 (role: 'student')\n- \ud65c\ub3d9 \ub85c\uadf8\n- \uac70\ub798 \ub0b4\uc5ed\n\n\uc120\uc0dd\ub2d8(admin) \uacc4\uc815\uc740 \uc720\uc9c0\ub429\ub2c8\ub2e4."))){c(!0);try{o.vF.log("[ClassDataDeletion] ".concat(s," \ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c \uc2dc\uc791"));const e=firestoreCollection(i.db,"users"),a=(0,i.P)(e,(0,i._M)("classCode","==",s),(0,i._M)("role","==","student")),t=await(0,i.FX)(a);o.vF.log("[ClassDataDeletion] \uc0ad\uc81c\ud560 \ud559\uc0dd \uc218: ".concat(t.size,"\uba85"));const n=firestoreCollection(i.db,"activity_logs"),l=(0,i.P)(n,(0,i._M)("classCode","==",s)),d=await(0,i.FX)(l);o.vF.log("[ClassDataDeletion] \uc0ad\uc81c\ud560 \ud65c\ub3d9 \ub85c\uadf8: ".concat(d.size,"\uac1c"));const c=t.docs.map(e=>e.id);let m=[];if(c.length>0){const e=[];for(let s=0;s<c.length;s+=10)e.push(c.slice(s,s+10));for(const s of e){const e=firestoreCollection(i.db,"transactions"),a=(0,i.P)(e,(0,i._M)("userId","in",s)),t=await(0,i.FX)(a);m.push(...t.docs)}}o.vF.log("[ClassDataDeletion] \uc0ad\uc81c\ud560 \uac70\ub798 \ub0b4\uc5ed: ".concat(m.length,"\uac1c"));const u=[...t.docs,...d.docs,...m];o.vF.log("[ClassDataDeletion] \ucd1d \uc0ad\uc81c\ud560 \ubb38\uc11c: ".concat(u.length,"\uac1c"));const x=500;for(let s=0;s<u.length;s+=x){const e=(0,i.wP)(i.db);u.slice(s,s+x).forEach(s=>{e.delete(s.ref)}),await e.commit(),o.vF.log("[ClassDataDeletion] \ubc30\uce58 ".concat(Math.floor(s/x)+1," \uc0ad\uc81c \uc644\ub8cc"))}alert("\ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c \uc644\ub8cc!\n\n\uc0ad\uc81c\ub41c \ub370\uc774\ud130:\n- \ud559\uc0dd \uacc4\uc815: ".concat(t.size,"\uba85\n- \ud65c\ub3d9 \ub85c\uadf8: ").concat(d.size,"\uac1c\n- \uac70\ub798 \ub0b4\uc5ed: ").concat(m.length,"\uac1c")),o.vF.log("[ClassDataDeletion] ".concat(s," \ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c \uc644\ub8cc")),r(""),h(!1)}catch(e){o.vF.error("[ClassDataDeletion] \uc0ad\uc81c \uc911 \uc624\ub958:",e),alert("\uc624\ub958 \ubc1c\uc0dd: ".concat(e.message,"\n\n\uc77c\ubd80 \ub370\uc774\ud130\ub9cc \uc0ad\uc81c\ub418\uc5c8\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."))}finally{c(!1)}}},disabled:d||"\uc0ad\uc81c"!==l,className:"px-6 py-2 rounded-lg font-medium transition-colors ".concat("\uc0ad\uc81c"!==l||d?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"),children:d?"\uc0ad\uc81c \uc911...":"\ucd5c\uc885 \uc0ad\uc81c \uc2e4\ud589"}),(0,m.jsx)("button",{onClick:()=>{h(!1),r("")},disabled:d,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"\ucde8\uc18c"})]})]}):(0,m.jsx)("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"\ud559\uae09 \ub370\uc774\ud130 \uc0ad\uc81c \uc2dc\uc791"})]}):null},Y=e=>{var s;let{isAdmin:a,isSuperAdmin:c,userClassCode:u,showAdminSettingsModal:h,setShowAdminSettingsModal:x,adminSelectedMenu:g,setAdminSelectedMenu:p,newGoalAmount:b,setNewGoalAmount:v,adminCouponValue:j,setAdminCouponValue:f,handleSaveAdminSettings:y,jobs:N,adminNewJobTitle:k,setAdminNewJobTitle:w,adminEditingJob:A,setAdminEditingJob:C,handleSaveJob:S,handleDeleteJob:F,handleEditJob:T,commonTasks:D,showAddTaskForm:I,setShowAddTaskForm:M,adminNewTaskName:_,setAdminNewTaskName:Y,adminNewTaskReward:U,setAdminNewTaskReward:Z,adminNewTaskMaxClicks:$,setAdminNewTaskMaxClicks:ee,adminEditingTask:se,setAdminEditingTask:ae,handleSaveTask:te,handleEditTask:ne,handleDeleteTask:le,taskFormJobId:ie,taskFormIsJobTask:re,handleAddTaskClick:de,classCodes:ce=[],onAddClassCode:oe,onRemoveClassCode:me}=e;const[ue,he]=(0,n.useState)(""),[xe,ge]=(0,n.useState)(!1),[pe,be]=(0,n.useState)([]),[ve,je]=(0,n.useState)(!1),[fe,ye]=(0,n.useState)(!1),[Ne,ke]=(0,n.useState)(null),[we,Ae]=(0,n.useState)([]),[Ce,Se]=(0,n.useState)([]),[Fe,Te]=(0,n.useState)(!1),[De,Ie]=(0,n.useState)(!1),[Me,Je]=(0,n.useState)(!1),[Ee,Re]=(0,n.useState)(null),[_e,Oe]=(0,n.useState)([]),[Pe,Le]=(0,n.useState)(!1),[We,ze]=(0,n.useState)(""),[He,Be]=(0,n.useState)([]),[Ge,Ke]=(0,n.useState)([]),[qe,Ve]=(0,n.useState)([]),[Qe,Xe]=(0,n.useState)(""),[Ye,Ue]=(0,n.useState)(""),[Ze,$e]=(0,n.useState)(""),[es,ss]=(0,n.useState)("deposit"),[as,ts]=(0,n.useState)(null),[ns,ls]=(0,n.useState)("job"),[is,rs]=(0,n.useState)("student"),[ds,cs]=(0,n.useState)("financial"),[os,ms]=(0,n.useState)("database"),[us,hs]=(0,n.useState)({isOpen:!1}),[xs,gs]=(0,n.useState)(""),[ps,bs]=(0,n.useState)(!1),vs=(0,n.useRef)(null),[js,fs]=(0,n.useState)(.1),[ys,Ns]=(0,n.useState)(""),[ks,ws]=(0,n.useState)(null),As=(0,d.Qg)(i.Cn,"toggleMarketManually"),[Cs,Ss]=(0,n.useState)({taxRate:.1,salaryIncreaseRate:.03}),[Fs,Ts]=(0,n.useState)("10"),[Ds,Is]=(0,n.useState)("3"),[Ms,Js]=(0,n.useState)(!1),Es=(()=>{const{userDoc:e,isAdmin:s,isSuperAdmin:a}=(0,l.As)(),t=null===e||void 0===e?void 0:e.classCode;return(0,J.I)({queryKey:L(t),queryFn:async()=>(await O.getAdminSettingsData({tab:"studentManagement"})).data,enabled:!(null===s||void 0===s||!s()||!t),staleTime:18e4,gcTime:48e4})})(),Rs=(()=>{const{userDoc:e,isAdmin:s}=(0,l.As)(),a=null===e||void 0===e?void 0:e.classCode;return(0,J.I)({queryKey:W(a),queryFn:async()=>(await O.getAdminSettingsData({tab:"salarySettings"})).data,enabled:!(null===s||void 0===s||!s()||!a),staleTime:6e5,gcTime:9e5})})(),_s=((()=>{const{isSuperAdmin:e}=(0,l.As)();(0,J.I)({queryKey:z(),queryFn:async()=>(await O.getAdminSettingsData({tab:"systemManagement"})).data,enabled:!(null===e||void 0===e||!e()),staleTime:9e5,gcTime:12e5})})(),(e=>{const{userDoc:s,isAdmin:a}=(0,l.As)(),t=null===s||void 0===s?void 0:s.classCode;(0,J.I)({queryKey:P(t,e),queryFn:async()=>{const s="admin_".concat(t,"_").concat(e),a=G(s,3e4);if(a&&!navigator.onLine)return a;const n=await O.getAdminSettingsData({tab:e});return B(s,n),n},enabled:!!(null!==a&&void 0!==a&&a()&&t&&e),staleTime:3e5,gcTime:6e5,retry:(e,s)=>"permission-denied"!==(null===s||void 0===s?void 0:s.code)&&e<2,refetchInterval:!!H()&&3e5})})("generalSettings"),(()=>{const e=(0,E.jE)(),{userDoc:s}=(0,l.As)(),a=null===s||void 0===s?void 0:s.classCode;return(0,R.n)({mutationFn:async e=>{let{studentIds:s,payAll:a}=e;return await O.batchPaySalaries({studentIds:s,payAll:a})},onSuccess:()=>{e.invalidateQueries({queryKey:L(a)}),e.invalidateQueries({queryKey:W(a)}),K("admin_".concat(a,"_studentManagement")),K("admin_".concat(a,"_salarySettings"))},onError:e=>{o.vF.error("\uae09\uc5ec \uc9c0\uae09 \uc2e4\ud328:",e)}})})()),{preloadAdminData:Os}=(()=>{const e=(0,E.jE)(),{userDoc:s,isAdmin:a}=(0,l.As)(),t=null===s||void 0===s?void 0:s.classCode;return{preloadAdminData:async()=>{if(null===a||void 0===a||!a()||!t)return;const s=["generalSettings","studentManagement","salarySettings"].map(s=>e.prefetchQuery({queryKey:P(t,s),queryFn:async()=>await O.getAdminSettingsData({tab:s}),staleTime:3e5}));await Promise.allSettled(s)}}})(),Ps=(0,n.useCallback)(async()=>{if(i.db)try{const e=u?(0,i.EW)(i.db,"settings","salarySettings_".concat(u)):(0,i.EW)(i.db,"settings","salarySettings"),s=await(0,i.I_)(e);if(s.exists()){const e=s.data(),a={taxRate:e.taxRate||.1,salaryIncreaseRate:e.salaryIncreaseRate||.03};Ss(a),Ts(String((100*a.taxRate).toFixed(1))),Is(String((100*a.salaryIncreaseRate).toFixed(1))),e.lastPaidDate&&Re(e.lastPaidDate.toDate())}else await(0,i.iv)(e,{taxRate:.1,salaryIncreaseRate:.03,lastPaidDate:null,classCode:u||null,createdAt:(0,i.O5)(),updatedAt:(0,i.O5)()})}catch(We){o.vF.error("\uae09\uc5ec \uc124\uc815 \ub85c\ub4dc \uc624\ub958:",We)}},[u]),Ls=(0,n.useCallback)(async()=>{if(!i.db)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.");const e=parseFloat(Fs),s=parseFloat(Ds);if(isNaN(e)||e<0||e>100)alert("\uc138\uc728\uc740 0~100 \uc0ac\uc774\uc758 \uc22b\uc790\uc5ec\uc57c \ud569\ub2c8\ub2e4.");else if(isNaN(s)||s<0||s>100)alert("\uc8fc\uae09 \uc778\uc0c1\ub960\uc740 0~100 \uc0ac\uc774\uc758 \uc22b\uc790\uc5ec\uc57c \ud569\ub2c8\ub2e4.");else{Js(!0);try{const a=u?(0,i.EW)(i.db,"settings","salarySettings_".concat(u)):(0,i.EW)(i.db,"settings","salarySettings"),t={taxRate:e/100,salaryIncreaseRate:s/100,classCode:u||null,updatedAt:(0,i.O5)()};await(0,i.tI)(a,t),Ss({taxRate:t.taxRate,salaryIncreaseRate:t.salaryIncreaseRate}),alert("\uae09\uc5ec \uc124\uc815\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(We){o.vF.error("\uae09\uc5ec \uc124\uc815 \uc800\uc7a5 \uc624\ub958:",We),alert("\uae09\uc5ec \uc124\uc815 \uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+We.message)}finally{Js(!1)}}},[u,Fs,Ds]),Ws=(0,n.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Array.isArray(e)||0===e.length)return{gross:0,tax:0,net:0};const a=2e6+5e5*Math.max(0,e.length-1);if(!s)return a;const t=Math.floor(a*Cs.taxRate);return{gross:a,tax:t,net:a-t}},[Cs.taxRate]),zs=(0,n.useCallback)(e=>{o.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \ud3b8\uc9d1 \ud074\ub9ad:",e),T&&"function"===typeof T?T(e):(o.vF.error("[AdminSettingsModal] handleEditJob \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\uc9c1\uc5c5 \ud3b8\uc9d1 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[T]),Hs=(0,n.useCallback)(e=>{o.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc0ad\uc81c \ud074\ub9ad:",e),F&&"function"===typeof F?F(e):(o.vF.error("[AdminSettingsModal] handleDeleteJob \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\uc9c1\uc5c5 \uc0ad\uc81c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[F]),Bs=(0,n.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o.vF.log("[AdminSettingsModal] \ud560\uc77c \ud3b8\uc9d1 \ud074\ub9ad:",e,"jobId:",s),ne&&"function"===typeof ne?ne(e,s):(o.vF.error("[AdminSettingsModal] handleEditTask \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \ud3b8\uc9d1 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[ne]),Gs=(0,n.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o.vF.log("[AdminSettingsModal] \ud560\uc77c \uc0ad\uc81c \ud074\ub9ad:",e,"jobId:",s),le&&"function"===typeof le?le(e,s):(o.vF.error("[AdminSettingsModal] handleDeleteTask \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \uc0ad\uc81c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[le]),Ks=(0,n.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];o.vF.log("[AdminSettingsModal] \ud560\uc77c \ucd94\uac00 \ud074\ub9ad:",e,"isJobTask:",s),de&&"function"===typeof de?de(e,s):(o.vF.error("[AdminSettingsModal] handleAddTaskClick \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \ucd94\uac00 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},[de]),qs=(0,n.useCallback)(async()=>{if(!i.db)return o.vF.error("loadStudents: Firestore \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."),ze("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958\ub85c \ud559\uc0dd \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),Se([]),void Te(!1);Te(!0),ze("");try{let a=[];if(!c&&!u)return ze("\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \ud559\uc0dd \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),Se([]),void Te(!1);if(!c&&u)try{const e=(0,i.gJ)(i.db,"Class",u,"students");(await(0,i.FX)(e)).forEach(e=>{const s=e.data();a.push({id:e.id,nickname:s.nickname||s.name||"\uc774\ub984 \uc5c6\uc74c",name:s.name||"",email:s.email||"",classCode:u,selectedJobIds:s.selectedJobIds||[],cash:s.money||s.cash||0,lastSalaryDate:s.lastSalaryDate?s.lastSalaryDate.toDate():null,lastGrossSalary:s.lastGrossSalary||0,lastTaxAmount:s.lastTaxAmount||0,lastNetSalary:s.lastNetSalary||0,totalSalaryReceived:s.totalSalaryReceived||0})})}catch(e){}if(0===a.length){const e=(0,i.gJ)(i.db,"users");let s;!c&&u?s=(0,i.P)(e,(0,i._M)("classCode","==",u)):c&&(s=e);(await(0,i.FX)(s)).forEach(e=>{const s=e.data();s.isAdmin||s.isSuperAdmin||a.push({id:e.id,nickname:s.nickname||s.name||"\uc774\ub984 \uc5c6\uc74c",name:s.name||"",email:s.email||"",classCode:s.classCode||"\ubbf8\uc9c0\uc815",selectedJobIds:s.selectedJobIds||[],cash:s.cash||0,lastSalaryDate:s.lastSalaryDate?s.lastSalaryDate.toDate():null,lastGrossSalary:s.lastGrossSalary||0,lastTaxAmount:s.lastTaxAmount||0,lastNetSalary:s.lastNetSalary||0,totalSalaryReceived:s.totalSalaryReceived||0})})}Se(a);try{const e=u?(0,i.EW)(i.db,"settings","salarySettings_".concat(u)):(0,i.EW)(i.db,"settings","salarySettings"),s=await(0,i.I_)(e);if(s.exists()){const e=s.data();Re(e.lastPaidDate?e.lastPaidDate.toDate():null),Ss({taxRate:e.taxRate||.1,salaryIncreaseRate:e.salaryIncreaseRate||.03})}else Re(null)}catch(s){o.vF.error("\uae09\uc5ec \uc124\uc815 \ub85c\ub4dc \uc624\ub958:",s),Re(null)}Oe([]),Le(!1)}catch(We){o.vF.error("loadStudents: \ud559\uc0dd \ubaa9\ub85d \ub85c\ub4dc \uc624\ub958:",We),ze("\ud559\uc0dd \ubaa9\ub85d\uc744 \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+We.message),Se([])}finally{Te(!1)}},[c,u]),Vs=(0,n.useCallback)(async()=>{if(!i.db)return o.vF.error("loadClassMembers: Firestore \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."),ze("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958\ub85c \ud559\uae09 \uad6c\uc131\uc6d0 \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),be([]),void je(!1);je(!0),ze("");try{const e=(0,i.gJ)(i.db,"users");let s;if(!c&&u)s=(0,i.P)(e,(0,i._M)("classCode","==",u));else{if(!c)return o.vF.warn("\uad00\ub9ac\uc790\uc758 \ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),ze("\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \uad6c\uc131\uc6d0 \uc815\ubcf4\ub97c \uac00\uc838\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),be([]),void je(!1);s=e}const a=await(0,i.FX)(s),t=[];a.forEach(e=>{const s=e.data();t.push({id:e.id,name:s.name||s.nickname||"\uc774\ub984 \uc5c6\uc74c",email:s.email,classCode:s.classCode||"\ucf54\ub4dc \uc5c6\uc74c",isAdmin:s.isAdmin||!1,isSuperAdmin:s.isSuperAdmin||!1})}),be(t),o.vF.log("[AdminSettingsModal] ".concat(t.length,"\uba85\uc758 \uad6c\uc131\uc6d0 \ub85c\ub4dc \uc644\ub8cc"))}catch(We){o.vF.error("loadClassMembers: \ud559\uae09 \uad6c\uc131\uc6d0 \ub85c\ub4dc \uc624\ub958:",We),ze("\ud559\uae09 \uad6c\uc131\uc6d0\uc744 \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+We.message),be([])}finally{je(!1)}},[c,u]),Qs=(0,d.Qg)(i.Cn,"adminResetUserPassword"),Xs=(0,n.useCallback)(async e=>{if(!a&&!c)return void alert("\uad00\ub9ac\uc790\ub9cc \ube44\ubc00\ubc88\ud638\ub97c \ucd08\uae30\ud654\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.");const s=prompt("\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694. 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");if(!s||s.length<6)alert("\ube44\ubc00\ubc88\ud638\ub294 6\uc790 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.");else if(window.confirm("\uc0ac\uc6a9\uc790(ID: ".concat(e,")\uc758 \ube44\ubc00\ubc88\ud638\ub97c \uc815\ub9d0\ub85c \ucd08\uae30\ud654\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))try{je(!0);const a=await Qs({userId:e,newPassword:s});if(!a.data.success)throw new Error(a.data.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958");alert(a.data.message)}catch(We){o.vF.error("\ube44\ubc00\ubc88\ud638 \ucd08\uae30\ud654 \uc624\ub958:",We),alert("\ube44\ubc00\ubc88\ud638 \ucd08\uae30\ud654 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(We.message))}finally{je(!1)}},[a,c,Qs]),Ys=(0,n.useCallback)(async(e,s)=>{if(i.db)if(c){if(window.confirm("\uc774 \uc0ac\uc6a9\uc790\uc758 \uad00\ub9ac\uc790 \uad8c\ud55c\uc744 ".concat(s?"\uc81c\uac70":"\ubd80\uc5ec","\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))){je(!0);try{const a=(0,i.EW)(i.db,"users",e);await(0,i.tI)(a,{isAdmin:!s}),be(a=>a.map(a=>a.id===e?(0,t.A)((0,t.A)({},a),{},{isAdmin:!s}):a)),alert("\uad00\ub9ac\uc790 \uad8c\ud55c\uc774 ".concat(s?"\uc81c\uac70":"\ubd80\uc5ec","\ub418\uc5c8\uc2b5\ub2c8\ub2e4."))}catch(We){o.vF.error("\uad00\ub9ac\uc790 \uad8c\ud55c \ubcc0\uacbd \uc624\ub958:",We),alert("\uad00\ub9ac\uc790 \uad8c\ud55c \ubcc0\uacbd \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{je(!1)}}}else alert("\ucd5c\uace0 \uad00\ub9ac\uc790\ub9cc \uad00\ub9ac\uc790 \uad8c\ud55c\uc744 \ubd80\uc5ec/\ud574\uc81c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.");else alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.")},[c]),Us=(0,n.useCallback)(()=>{try{const e=localStorage.getItem("depositProducts"),s=localStorage.getItem("savingProducts"),a=localStorage.getItem("loanProducts");e&&Be(JSON.parse(e)),s&&Ke(JSON.parse(s)),a&&Ve(JSON.parse(a))}catch(We){o.vF.error("\uae08\uc735 \uc0c1\ud488 \ub85c\ub4dc \uc624\ub958:",We)}},[]),Zs=(0,n.useCallback)(()=>{if(!Qe||""===Qe.trim())return void ts({type:"error",text:"\uc0c1\ud488\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});if(!Ye||isNaN(Ye)||parseInt(Ye)<=0)return void ts({type:"error",text:"\uc720\ud6a8\ud55c \uae30\uac04\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});if(!Ze||isNaN(Ze)||parseFloat(Ze)<0)return void ts({type:"error",text:"\uc720\ud6a8\ud55c \uc774\uc728\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});const e={id:Date.now(),name:Qe.trim(),period:parseInt(Ye),rate:parseFloat(Ze)},s="deposit"===es?"\uc608\uae08":"saving"===es?"\uc801\uae08":"\ub300\ucd9c";let a=[],t="";"deposit"===es?(a=[...He,e],Be(a),t="depositProducts"):"saving"===es?(a=[...Ge,e],Ke(a),t="savingProducts"):"loan"===es&&(a=[...qe,e],Ve(a),t="loanProducts"),localStorage.setItem(t,JSON.stringify(a)),ts({type:"success",text:"".concat(s," \uc0c1\ud488\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}),Xe(""),Ue(""),$e(""),setTimeout(()=>ts(null),3e3)},[Qe,Ye,Ze,es,He,Ge,qe]),$s=(0,n.useCallback)((e,s)=>{const a="deposit"===s?"\uc608\uae08":"saving"===s?"\uc801\uae08":"\ub300\ucd9c";if(!window.confirm("\uc774 ".concat(a," \uc0c1\ud488\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))return;let t=[],n="";"deposit"===s?(t=He.filter(s=>s.id!==e),Be(t),n="depositProducts"):"saving"===s?(t=Ge.filter(s=>s.id!==e),Ke(t),n="savingProducts"):"loan"===s&&(t=qe.filter(s=>s.id!==e),Ve(t),n="loanProducts"),localStorage.setItem(n,JSON.stringify(t)),ts({type:"success",text:"".concat(a," \uc0c1\ud488\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}),setTimeout(()=>ts(null),3e3)},[He,Ge,qe]),ea=(0,n.useCallback)(async function(){if(u)if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&vs.current&&ps)hs(vs.current);else try{const e=(0,r.H9)(i.db,"ClassStock/".concat(u,"/marketStatus/status")),s=await(0,r.x7)(e);let a;s.exists()?a=s.data():(a={isOpen:!1},await(0,r.BN)(e,a)),vs.current=a,hs(a),bs(!0)}catch(We){o.vF.error("\uc2dc\uc7a5 \uc0c1\ud0dc \uc870\ud68c \uc2e4\ud328:",We),gs("\uc2dc\uc7a5 \uc0c1\ud0dc\ub97c \ubd88\ub7ec\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},[u,ps]),sa=(0,n.useCallback)(async e=>{const s=e?"\uc218\ub3d9 \uac1c\uc7a5":"\uc218\ub3d9 \ud3d0\uc7a5";if(window.confirm("\uc815\ub9d0\ub85c \uc2dc\uc7a5\uc744 '".concat(s,"' \uc0c1\ud0dc\ub85c \ubcc0\uacbd\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))){try{const s={isOpen:e};hs(s),vs.current=s;const a=await As({classCode:u,isOpen:e});gs(a.data.message)}catch(We){o.vF.error("\uc2dc\uc7a5 \uc0c1\ud0dc \ubcc0\uacbd \uc624\ub958:",We),gs("\uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: ".concat(We.message)),vs.current?hs(vs.current):ea(!0)}setTimeout(()=>gs(""),5e3)}},[u,As,ea]),aa=(0,n.useCallback)(async()=>{if(window.confirm("\ubaa8\ub4e0 \uc8fc\uc2dd \uc815\ubcf4\ub97c \ucd08\uae30\ud654\ud558\uace0 \uae30\ubcf8\uac12\uc73c\ub85c \uc124\uc815\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")){try{const e=(0,i.wP)(i.db);Q.forEach(s=>{const a=(0,r.H9)(i.db,"CentralStocks",s.id);e.set(a,s)}),await e.commit(),alert("\uc8fc\uc2dd \uc815\ubcf4\uac00 \uc131\uacf5\uc801\uc73c\ub85c \ucd08\uae30\ud654\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),gs("\uc8fc\uc2dd \uc815\ubcf4\uac00 \uc131\uacf5\uc801\uc73c\ub85c \ucd08\uae30\ud654\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(We){o.vF.error("\uc8fc\uc2dd \uc815\ubcf4 \ucd08\uae30\ud654 \uc911 \uc624\ub958 \ubc1c\uc0dd:",We),gs("\ucd08\uae30\ud654 \uc2e4\ud328: ".concat(We.message))}setTimeout(()=>gs(""),5e3)}},[]),ta=(0,n.useCallback)(()=>{const e=localStorage.getItem("parkingInterestRate");e&&fs(parseFloat(e))},[]),na=(0,n.useCallback)(()=>{if(!ys||isNaN(ys)||parseFloat(ys)<0)return void ws({type:"error",text:"\uc720\ud6a8\ud55c \uc774\uc790\uc728\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694 (0 \uc774\uc0c1)."});const e=parseFloat(ys);fs(e),localStorage.setItem("parkingInterestRate",e.toString()),ws({type:"success",text:"\ud30c\ud0b9 \ud1b5\uc7a5 \uc77c\uc77c \uc774\uc790\uc728\uc774 ".concat(e,"%\ub85c \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}),Ns(""),setTimeout(()=>ws(null),3e3)},[ys]),la=(0,n.useCallback)(async()=>{if(!oe||"function"!==typeof oe)return void alert("\ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const e=ue.trim();if(e){ge(!0);try{await oe(e)&&he("")}catch(We){o.vF.error("AdminSettingsModal: \ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uc911 \uc624\ub958:",We)}finally{ge(!1)}}else alert("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},[ue,oe]),ia=(0,n.useCallback)(async e=>{if(me&&"function"===typeof me){ge(!0);try{await me(e)}catch(We){o.vF.error("AdminSettingsModal: \ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uc911 \uc624\ub958:",We)}finally{ge(!1)}}else alert("\ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},[me]);(0,n.useEffect)(()=>{h&&(Os(),ze(""),Us(),ta()),h||(he(""),be([]),Se([]),ke(null),Ae([]),ye(!1),Re(null),Oe([]),Le(!1),ge(!1),je(!1),Te(!1),Ie(!1),ze(""),ts(null),gs(""),ws(null))},[h,g,Vs,qs,Ps,Us,ta]),(0,n.useEffect)(()=>{const e={taskManagement:["jobAndTask",()=>ls("task")],jobSettings:["jobAndTask",()=>ls("job")],studentManagement:["studentAndMember",()=>rs("student")],salarySettings:["studentAndMember",()=>rs("salary")],memberManagement:["studentAndMember",()=>rs("member")],financialProducts:["financeAndMarket",()=>cs("financial")],parkingAccount:["financeAndMarket",()=>cs("parking")],marketControl:["financeAndMarket",()=>cs("market")],databaseManagement:["system",()=>ms("database")],systemManagement:["system",()=>ms("system")]}[g];e&&(p(e[0]),e[1]())},[g,p]),(0,n.useEffect)(()=>{h&&"studentAndMember"===g&&"student"===is&&qs()},[h,g,is]),(0,n.useEffect)(()=>{h&&"studentAndMember"===g&&"member"===is&&Vs()},[h,g,is]),(0,n.useEffect)(()=>{h&&"financeAndMarket"===g&&"market"===ds&&ea()},[h,g,ds,ea]);const ra=()=>{if(!Ee)return"\uc544\uc9c1 \uc9c0\uae09 \uae30\ub85d \uc5c6\uc74c";try{const e=Ee;return"".concat(e.getFullYear(),"\ub144 ").concat(String(e.getMonth()+1).padStart(2,"0"),"\uc6d4 ").concat(String(e.getDate()).padStart(2,"0"),"\uc77c ").concat(String(e.getHours()).padStart(2,"0"),":").concat(String(e.getMinutes()).padStart(2,"0"))}catch(e){return o.vF.error("formatLastSalaryDate \uc624\ub958:",e),"\ub0a0\uc9dc \ud615\uc2dd \uc624\ub958"}};return h?a||c?(0,m.jsxs)("div",{className:"admin-settings-modal ".concat(h?"show":""),children:[(0,m.jsxs)("div",{className:"admin-settings-content",children:[(0,m.jsxs)("h2",{children:["\uad00\ub9ac\uc790 \uc124\uc815"," ",c&&(0,m.jsx)("span",{className:"super-admin-badge",children:"(\ucd5c\uace0 \uad00\ub9ac\uc790)"})]}),!c&&u&&(0,m.jsxs)("p",{className:"admin-class-info",children:["\uad00\ub9ac \ud559\uae09: ",u]}),(0,m.jsxs)("div",{className:"admin-menu-tabs flex flex-wrap gap-2.5 p-4 rounded-2xl border border-gray-700",style:{background:"linear-gradient(135deg, #16213e 0%, #1a1a2e 100%)"},children:[(0,m.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("generalSettings"===g?"active":""),onClick:()=>p("generalSettings"),children:"\u2699\ufe0f \uc77c\ubc18 \uc124\uc815"}),(0,m.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("jobAndTask"===g?"active":""),onClick:()=>p("jobAndTask"),children:"\ud83d\udcbc \uc9c1\uc5c5/\ud560\uc77c"}),(0,m.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("studentAndMember"===g?"active":""),onClick:()=>p("studentAndMember"),children:"\ud83d\udc65 \ud559\uc0dd/\uad6c\uc131\uc6d0"}),(0,m.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("financeAndMarket"===g?"active":""),onClick:()=>p("financeAndMarket"),children:"\ud83c\udfe6 \uae08\uc735/\uc2dc\uc7a5"}),(0,m.jsx)("button",{className:"px-4 py-2.5 rounded-2xl text-[13px] whitespace-nowrap ".concat("system"===g?"active":""),onClick:()=>p("system"),children:"\ud83d\udd27 \uc2dc\uc2a4\ud15c"})]}),"generalSettings"===g&&(0,m.jsxs)("div",{className:"general-settings-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsxs)("div",{className:"admin-goal-settings section-card",children:[(0,m.jsx)("h3",{children:"\ubaa9\ud45c \ubc0f \ucfe0\ud3f0 \uac00\uce58 \uc124\uc815"}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{children:"\ud074\ub798\uc2a4 \ubaa9\ud45c \ucfe0\ud3f0 \uc218:"}),(0,m.jsx)("input",{type:"number",min:"1",value:b||"",onChange:e=>v&&v(e.target.value),className:"admin-input"})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{children:"\ucfe0\ud3f0 \uac00\uce58 (\uc6d0):"}),(0,m.jsx)("input",{type:"number",min:"1",value:j||"",onChange:e=>f&&f(e.target.value),className:"admin-input"})]}),(0,m.jsx)("button",{onClick:y,className:"admin-save-button",children:"\uc800\uc7a5"})]})]}),"jobAndTask"===g&&(0,m.jsxs)("div",{className:"flex gap-2 mb-4 p-3 rounded-xl bg-[#16213e]/50 border border-gray-700/50",children:[(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("job"===ns?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>ls("job"),children:"\uc9c1\uc5c5 \uad00\ub9ac"}),(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("task"===ns?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>ls("task"),children:"\ud560\uc77c \uad00\ub9ac"})]}),"jobAndTask"===g&&"task"===ns&&(0,m.jsxs)("div",{className:"task-management-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsxs)("div",{className:"admin-tasks-settings section-card",children:[(0,m.jsx)("h3",{children:"\ud560\uc77c \uad00\ub9ac"}),(0,m.jsx)("p",{className:"admin-section-desc",children:"\uc9c1\uc5c5\ubcc4 \ud560\uc77c\uacfc \uacf5\ud1b5 \ud560\uc77c\uc744 \uad00\ub9ac\ud569\ub2c8\ub2e4."}),I?(0,m.jsxs)("div",{className:"add-task-form",children:[(0,m.jsx)("h4",{children:se?"\ud560\uc77c \uc218\uc815":"\uc0c8 \ud560\uc77c \ucd94\uac00"}),(0,m.jsx)("p",{children:re&&N&&ie?"\uc9c1\uc5c5: ".concat((null===(s=N.find(e=>e.id===ie))||void 0===s?void 0:s.title)||"\uc54c \uc218 \uc5c6\ub294 \uc9c1\uc5c5"):"\uacf5\ud1b5 \ud560\uc77c"}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{children:"\ud560\uc77c \uc774\ub984:"}),(0,m.jsx)("input",{type:"text",value:_,onChange:e=>Y(e.target.value),placeholder:"\ud560\uc77c \uc774\ub984 \uc785\ub825",className:"admin-input"})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{children:"\ubcf4\uc0c1 (\ucfe0\ud3f0):"}),(0,m.jsx)("input",{type:"number",min:"0",value:U,onChange:e=>Z(e.target.value),placeholder:"\ucfe0\ud3f0 \ubcf4\uc0c1",className:"admin-input"})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{children:"\ucd5c\ub300 \ud074\ub9ad \uc218:"}),(0,m.jsx)("input",{type:"number",min:"1",value:$,onChange:e=>ee(e.target.value),placeholder:"\ucd5c\ub300 \ud074\ub9ad \uc218",className:"admin-input"})]}),(0,m.jsxs)("div",{className:"task-form-buttons",children:[(0,m.jsx)("button",{onClick:()=>{o.vF.log("[AdminSettingsModal] \ud560\uc77c \uc800\uc7a5 \ubc84\ud2bc \ud074\ub9ad"),te&&"function"===typeof te?te():(o.vF.error("[AdminSettingsModal] handleSaveTask \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\ud560\uc77c \uc800\uc7a5 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},className:"admin-save-button",children:se?"\uc218\uc815":"\ucd94\uac00"}),(0,m.jsx)("button",{onClick:()=>{M(!1),ae(null)},className:"admin-cancel-button",children:"\ucde8\uc18c"})]})]}):(0,m.jsxs)("div",{className:"task-management",children:[(0,m.jsxs)("div",{className:"task-management-buttons",children:[(0,m.jsx)("button",{onClick:()=>{o.vF.log("[AdminSettingsModal] \uacf5\ud1b5 \ud560\uc77c \ucd94\uac00 \ubc84\ud2bc \ud074\ub9ad"),Ks(null,!1)},className:"admin-button",children:"\uacf5\ud1b5 \ud560\uc77c \ucd94\uac00"}),(0,m.jsxs)("select",{onChange:e=>{e.target.value&&(o.vF.log("[AdminSettingsModal] \uc9c1\uc5c5\ubcc4 \ud560\uc77c \ucd94\uac00 \uc120\ud0dd:",e.target.value),Ks(e.target.value,!0))},className:"job-select",value:"",children:[(0,m.jsx)("option",{value:"",children:"\uc9c1\uc5c5\ubcc4 \ud560\uc77c \ucd94\uac00..."}),Array.isArray(N)&&N.map(e=>(0,m.jsxs)("option",{value:e.id,children:[e.title,"\uc5d0 \ud560\uc77c \ucd94\uac00"]},e.id))]})]}),(0,m.jsxs)("div",{className:"tasks-by-job",children:[(0,m.jsx)("h4",{children:"\uc9c1\uc5c5\ubcc4 \ud560\uc77c"}),Array.isArray(N)&&N.length>0?N.map(e=>(0,m.jsxs)("div",{className:"job-tasks",children:[(0,m.jsx)("h5",{children:e.title}),Array.isArray(e.tasks)&&e.tasks.length>0?(0,m.jsx)("ul",{className:"admin-tasks",children:e.tasks.map(s=>(0,m.jsxs)("li",{className:"admin-task-item",children:[(0,m.jsxs)("div",{className:"task-info",children:[(0,m.jsx)("span",{className:"task-name",children:s.name}),(0,m.jsxs)("span",{className:"task-reward",children:["\ubcf4\uc0c1: ",s.reward||0," \ucfe0\ud3f0"]}),(0,m.jsxs)("span",{className:"task-clicks",children:["\ud074\ub9ad: ",s.clicks||0,"/",s.maxClicks||5]})]}),(0,m.jsxs)("div",{className:"task-actions",children:[(0,m.jsx)("button",{onClick:()=>{o.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \ud560\uc77c \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",s,e.id),Bs(s,e.id)},className:"edit-button",children:"\uc218\uc815"}),(0,m.jsx)("button",{onClick:()=>{o.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \ud560\uc77c \uc0ad\uc81c \ubc84\ud2bc \ud074\ub9ad:",s.id,e.id),Gs(s.id,e.id)},className:"delete-button",children:"\uc0ad\uc81c"})]})]},s.id))}):(0,m.jsx)("p",{className:"no-items-message",children:"\uc774 \uc9c1\uc5c5\uc5d0 \ub4f1\ub85d\ub41c \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]},e.id)):(0,m.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,m.jsxs)("div",{className:"common-tasks",children:[(0,m.jsx)("h4",{children:"\uacf5\ud1b5 \ud560\uc77c"}),Array.isArray(D)&&D.length>0?(0,m.jsx)("ul",{className:"admin-tasks",children:D.map(e=>(0,m.jsxs)("li",{className:"admin-task-item",children:[(0,m.jsxs)("div",{className:"task-info",children:[(0,m.jsx)("span",{className:"task-name",children:e.name}),(0,m.jsxs)("span",{className:"task-reward",children:["\ubcf4\uc0c1: ",e.reward||0," \ucfe0\ud3f0"]}),(0,m.jsxs)("span",{className:"task-clicks",children:["\ud074\ub9ad: ",e.clicks||0,"/",e.maxClicks||5]})]}),(0,m.jsxs)("div",{className:"task-actions",children:[(0,m.jsx)("button",{onClick:()=>{o.vF.log("[AdminSettingsModal] \uacf5\ud1b5 \ud560\uc77c \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",e),Bs(e)},className:"edit-button",children:"\uc218\uc815"}),(0,m.jsx)("button",{onClick:()=>{o.vF.log("[AdminSettingsModal] \uacf5\ud1b5 \ud560\uc77c \uc0ad\uc81c \ubc84\ud2bc \ud074\ub9ad:",e.id),Gs(e.id)},className:"delete-button",children:"\uc0ad\uc81c"})]})]},e.id))}):(0,m.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uacf5\ud1b5 \ud560\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]})]})]}),"jobAndTask"===g&&"job"===ns&&(0,m.jsxs)("div",{className:"job-settings-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsxs)("div",{className:"admin-jobs-settings section-card",children:[(0,m.jsx)("h3",{children:"\uc9c1\uc5c5 \uad00\ub9ac"}),(0,m.jsxs)("div",{className:"add-job-form",children:[(0,m.jsx)("input",{type:"text",value:k,onChange:e=>w(e.target.value),placeholder:A?"\uc9c1\uc5c5\uba85 \uc218\uc815":"\uc0c8 \uc9c1\uc5c5\uba85 \uc785\ub825",className:"admin-input"}),(0,m.jsx)("button",{onClick:()=>{o.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc800\uc7a5 \ubc84\ud2bc \ud074\ub9ad"),S&&"function"===typeof S?S():(o.vF.error("[AdminSettingsModal] handleSaveJob \ud568\uc218\uac00 \uc815\uc758\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."),alert("\uc9c1\uc5c5 \uc800\uc7a5 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))},className:"admin-save-button",children:A?"\uc218\uc815":"\ucd94\uac00"}),A&&(0,m.jsx)("button",{onClick:()=>{C(null),w("")},className:"admin-cancel-button",children:"\ucde8\uc18c"})]}),(0,m.jsxs)("div",{className:"jobs-list",children:[(0,m.jsx)("h4",{children:"\ub4f1\ub85d\ub41c \uc9c1\uc5c5 \ubaa9\ub85d"}),N&&N.length>0?(0,m.jsx)("ul",{className:"admin-jobs",children:N.map(e=>(0,m.jsxs)("li",{className:"admin-job-item",children:[(0,m.jsx)("span",{className:"job-title",children:e.title}),(0,m.jsxs)("div",{className:"job-actions",children:[(0,m.jsx)("button",{onClick:()=>{o.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",e),zs(e)},className:"edit-button",children:"\uc218\uc815"}),(0,m.jsx)("button",{onClick:()=>{o.vF.log("[AdminSettingsModal] \uc9c1\uc5c5 \uc0ad\uc81c \ubc84\ud2bc \ud074\ub9ad:",e.id),Hs(e.id)},className:"delete-button",children:"\uc0ad\uc81c"})]})]},e.id))}):(0,m.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]})]}),"studentAndMember"===g&&(0,m.jsxs)("div",{className:"flex gap-2 mb-4 p-3 rounded-xl bg-[#16213e]/50 border border-gray-700/50",children:[(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("student"===is?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>rs("student"),children:"\ud559\uc0dd/\uae09\uc5ec \uad00\ub9ac"}),(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("salary"===is?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>rs("salary"),children:"\uae09\uc5ec \uc124\uc815"}),(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("member"===is?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>rs("member"),children:"\uad6c\uc131\uc6d0 \uad00\ub9ac"})]}),"studentAndMember"===g&&"student"===is&&(0,m.jsxs)("div",{className:"student-management-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsxs)("div",{className:"student-jobs-settings section-card",children:[(0,m.jsx)("h3",{children:"\ud559\uc0dd\uc9c1\uc5c5 \uad00\ub9ac"}),We&&(0,m.jsx)("p",{className:"error-message",children:We}),(0,m.jsx)("p",{className:"admin-section-desc",children:"\ud559\uc0dd\ub4e4\uc5d0\uac8c \uc9c1\uc5c5\uc744 \ubc30\uc815\ud558\uac70\ub098 \uad00\ub9ac\ud569\ub2c8\ub2e4. \uc8fc\uae09\uc740 \uc9c1\uc5c5 \uc218\uc5d0 \ub530\ub77c \ucc28\ub4f1 \uc9c0\uae09\ub429\ub2c8\ub2e4."}),(0,m.jsxs)("div",{className:"salary-management",children:[(0,m.jsxs)("div",{className:"salary-info",children:[(0,m.jsx)("h4",{children:"\uc8fc\uae09 \uc9c0\uae09 \uad00\ub9ac"}),(0,m.jsx)("p",{children:"\uae30\ubcf8 \uc8fc\uae09: 200\ub9cc\uc6d0, \ucd94\uac00 \uc9c1\uc5c5\ub2f9: 50\ub9cc\uc6d0"}),(0,m.jsxs)("p",{children:["\uc138\uc728: ",(100*Cs.taxRate).toFixed(1),"%"]}),(0,m.jsxs)("p",{children:["\uc8fc\uae09 \uc778\uc0c1\ub960: ",(100*Cs.salaryIncreaseRate).toFixed(1),"% (\ub9e4\uc8fc)"]}),(0,m.jsxs)("p",{children:["\ub9c8\uc9c0\ub9c9 \uc8fc\uae09 \uc9c0\uae09\uc77c: ",ra()]}),(0,m.jsx)("p",{className:"auto-payment-info",children:"\u23f0 \uc790\ub3d9 \uc8fc\uae09 \uc9c0\uae09: \ub9e4\uc8fc \uae08\uc694\uc77c \uc624\uc804 8\uc2dc (\uc11c\ubc84 \uc790\ub3d9 \uc2e4\ud589)"})]}),(0,m.jsxs)("div",{className:"salary-buttons",children:[(0,m.jsx)("button",{className:"admin-button pay-salary-button",onClick:async()=>{var e,s;const a=(null===(e=Es.data)||void 0===e?void 0:e.students)||Ce,t=(null===(s=Rs.data)||void 0===s?void 0:s.settings)||Cs;if(a&&0!==a.length){if(window.confirm("\ubaa8\ub4e0 \ud559\uc0dd\ub4e4\uc5d0\uac8c \uc9c1\uc5c5\ubcc4 \uc8fc\uae09\uc744 \uc9c0\uae09\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n(\uc9c1\uc5c5\uc774 \uc788\ub294 \ud559\uc0dd\ub9cc \ud574\ub2f9, \uc138\uae08 ".concat((100*t.taxRate).toFixed(1),"% \uacf5\uc81c)"))){Je(!0);try{const e=await _s.mutateAsync({studentIds:[],payAll:!0});if(e.success){const{summary:s}=e;alert("\uc8fc\uae09 \uc9c0\uae09 \uc644\ub8cc!\n".concat(s.totalStudentsPaid,"\uba85\uc758 \ud559\uc0dd\uc5d0\uac8c \uc9c0\uae09\n\ucd1d \uae09\uc5ec: ").concat((s.totalGrossPaid/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc138\uae08 \uacf5\uc81c: ").concat((s.totalTaxDeducted/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc2e4\uc81c \uc9c0\uae09: ").concat((s.totalNetPaid/1e4).toFixed(0),"\ub9cc\uc6d0"))}else alert(e.message||"\uc8fc\uae09 \uc9c0\uae09\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(We){o.vF.error("[AdminSettingsModal] \uc804\uccb4 \ud559\uc0dd \uc8fc\uae09 \uc9c0\uae09 \uc624\ub958:",We),alert("\uc8fc\uae09 \uc9c0\uae09 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+We.message)}finally{Je(!1)}}}else alert("\ud559\uc0dd \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.")},disabled:Me||Fe,children:Me?"\uc8fc\uae09 \uc9c0\uae09 \uc911...":"\uc804\uccb4 \ud559\uc0dd \uc8fc\uae09 \uc9c0\uae09"}),(0,m.jsx)("button",{className:"admin-button pay-selected-salary-button",onClick:async()=>{var e;if(0===_e.length)return void alert("\uc120\ud0dd\ub41c \ud559\uc0dd\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");const s=(null===(e=Rs.data)||void 0===e?void 0:e.settings)||Cs;if(window.confirm("\uc120\ud0dd\ub41c ".concat(_e.length,"\uba85\uc758 \ud559\uc0dd\uc5d0\uac8c \uc8fc\uae09\uc744 \uc9c0\uae09\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n(\uc138\uae08 ").concat((100*s.taxRate).toFixed(1),"% \uacf5\uc81c \ud6c4 \uc9c0\uae09)"))){Je(!0);try{const e=await _s.mutateAsync({studentIds:_e,payAll:!1});if(e.success){const{summary:s}=e;alert("\uc8fc\uae09 \uc9c0\uae09 \uc644\ub8cc!\n".concat(s.totalStudentsPaid,"\uba85\uc758 \ud559\uc0dd\uc5d0\uac8c \uc9c0\uae09\n\ucd1d \uae09\uc5ec: ").concat((s.totalGrossPaid/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc138\uae08 \uacf5\uc81c: ").concat((s.totalTaxDeducted/1e4).toFixed(0),"\ub9cc\uc6d0\n\uc2e4\uc81c \uc9c0\uae09: ").concat((s.totalNetPaid/1e4).toFixed(0),"\ub9cc\uc6d0")),Oe([]),Le(!1)}else alert(e.message||"\uc8fc\uae09 \uc9c0\uae09\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(We){o.vF.error("[AdminSettingsModal] \uc120\ud0dd\ub41c \ud559\uc0dd \uc8fc\uae09 \uc9c0\uae09 \uc624\ub958:",We),alert("\uc8fc\uae09 \uc9c0\uae09 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+We.message)}finally{Je(!1)}}},disabled:Me||Fe||0===_e.length,children:Me?"\uc8fc\uae09 \uc9c0\uae09 \uc911...":"\uc120\ud0dd \ud559\uc0dd(".concat(_e.length,") \uc8fc\uae09 \uc9c0\uae09")})]})]}),(0,m.jsxs)("div",{className:"student-jobs-container",children:[(0,m.jsxs)("div",{className:"student-list-header",children:[(0,m.jsxs)("h4",{children:["\ud559\uc0dd \ubaa9\ub85d"," ",!c&&u&&"(".concat(u," \ud559\uae09)")]}),(0,m.jsx)("button",{onClick:qs,className:"admin-button",disabled:Fe,children:Fe?"\ub85c\ub529 \uc911...":"\ud559\uc0dd \ubaa9\ub85d \uc0c8\ub85c\uace0\uce68"})]}),Fe?(0,m.jsx)("p",{children:"\ud559\uc0dd \uc815\ubcf4 \ub85c\ub529 \uc911..."}):Ce.length>0?(0,m.jsx)("div",{className:"members-table-container",children:(0,m.jsxs)("table",{className:"members-table",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:(0,m.jsx)("input",{type:"checkbox",checked:Pe,onChange:()=>{Oe(Pe?[]:Ce.map(e=>e.id).filter(e=>null!=e)),Le(!Pe)},disabled:0===Ce.length})}),(0,m.jsx)("th",{children:"\ud559\uc0dd \uc774\ub984"}),(0,m.jsx)("th",{children:"\uc774\uba54\uc77c"}),(0,m.jsx)("th",{children:"\ud559\uae09"}),(0,m.jsx)("th",{children:"\ud604\uc7ac \uc9c1\uc5c5"}),(0,m.jsx)("th",{children:"\uc608\uc0c1 \ucd1d\uae09\uc5ec"}),(0,m.jsx)("th",{children:"\uc138\uae08 \uacf5\uc81c"}),(0,m.jsx)("th",{children:"\uc2e4\uae09\uc5ec"}),(0,m.jsx)("th",{children:"\ubcf4\uc720 \ud604\uae08"}),(0,m.jsx)("th",{children:"\ucd5c\uadfc \uc8fc\uae09\uc77c"}),(0,m.jsx)("th",{children:"\uad00\ub9ac"})]})}),(0,m.jsx)("tbody",{children:Ce.map(e=>{const s=Ws(e.selectedJobIds,!0);return(0,m.jsxs)("tr",{className:_e.includes(e.id)?"selected-student-row":"",children:[(0,m.jsx)("td",{children:(0,m.jsx)("input",{type:"checkbox",checked:_e.includes(e.id),onChange:()=>{return s=e.id,void Oe(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s}})}),(0,m.jsx)("td",{children:e.nickname||e.name||"\uc774\ub984 \uc5c6\uc74c"}),(0,m.jsx)("td",{children:e.email||"-"}),(0,m.jsx)("td",{children:e.classCode||"\ubbf8\uc9c0\uc815"}),(0,m.jsx)("td",{children:Array.isArray(e.selectedJobIds)&&e.selectedJobIds.length>0?e.selectedJobIds.map(e=>{const s=Array.isArray(N)?N.find(s=>s.id===e):null;return s?s.title:null}).filter(Boolean).join(", "):(0,m.jsx)("span",{className:"no-jobs",children:"\uc9c1\uc5c5 \uc5c6\uc74c"})}),(0,m.jsx)("td",{className:"salary-column",children:"".concat((s.gross/1e4).toFixed(0),"\ub9cc\uc6d0")}),(0,m.jsx)("td",{className:"tax-column",children:"".concat((s.tax/1e4).toFixed(0),"\ub9cc\uc6d0")}),(0,m.jsx)("td",{className:"net-salary-column",children:"".concat((s.net/1e4).toFixed(0),"\ub9cc\uc6d0")}),(0,m.jsxs)("td",{className:"cash-column",children:[(e.cash||0).toLocaleString(),"\uc6d0"]}),(0,m.jsx)("td",{children:e.lastSalaryDate?e.lastSalaryDate.toLocaleDateString():"\uc5c6\uc74c"}),(0,m.jsx)("td",{children:(0,m.jsx)("button",{className:"edit-button",onClick:()=>(e=>{ke(e),Ae(Array.isArray(e.selectedJobIds)?[...e.selectedJobIds]:[]),ye(!0)})(e),children:"\uc9c1\uc5c5 \uc124\uc815"})})]},e.id)})})]})}):(0,m.jsx)("p",{className:"no-items-message",children:c||u?"\ud559\uc0dd \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.":"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."})]})]})]}),"financeAndMarket"===g&&(0,m.jsxs)("div",{className:"flex gap-2 mb-4 p-3 rounded-xl bg-[#16213e]/50 border border-gray-700/50",children:[(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("financial"===ds?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>cs("financial"),children:"\uae08\uc735 \uc0c1\ud488"}),(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("parking"===ds?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>cs("parking"),children:"\ud30c\ud0b9 \ud1b5\uc7a5"}),(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("market"===ds?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>cs("market"),children:"\uc2dc\uc7a5 \uc81c\uc5b4"})]}),"financeAndMarket"===g&&"financial"===ds&&(0,m.jsxs)("div",{className:"financial-products-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsxs)("div",{className:"financial-products-settings section-card",children:[(0,m.jsx)("h3",{children:"\uae08\uc735 \uc0c1\ud488 \uad00\ub9ac"}),(0,m.jsx)("p",{className:"admin-section-desc",children:"\uc608\uae08, \uc801\uae08, \ub300\ucd9c \uc0c1\ud488\uc744 \ucd94\uac00\ud558\uac70\ub098 \uc0ad\uc81c\ud569\ub2c8\ub2e4."}),(0,m.jsxs)("div",{className:"financial-sub-tabs flex gap-2 mb-4",children:[(0,m.jsx)("button",{className:"sub-tab-button px-4 py-2 rounded-lg cursor-pointer font-semibold ".concat("deposit"===es?"active":""),onClick:()=>ss("deposit"),style:{border:"deposit"===es?"2px solid #4f46e5":"1px solid #374151",background:"deposit"===es?"#4f46e5":"transparent",color:"deposit"===es?"white":"#9ca3af"},children:"\uc608\uae08 \uc0c1\ud488"}),(0,m.jsx)("button",{className:"sub-tab-button px-4 py-2 rounded-lg cursor-pointer font-semibold ".concat("saving"===es?"active":""),onClick:()=>ss("saving"),style:{border:"saving"===es?"2px solid #4f46e5":"1px solid #374151",background:"saving"===es?"#4f46e5":"transparent",color:"saving"===es?"white":"#9ca3af"},children:"\uc801\uae08 \uc0c1\ud488"}),(0,m.jsx)("button",{className:"sub-tab-button px-4 py-2 rounded-lg cursor-pointer font-semibold ".concat("loan"===es?"active":""),onClick:()=>ss("loan"),style:{border:"loan"===es?"2px solid #4f46e5":"1px solid #374151",background:"loan"===es?"#4f46e5":"transparent",color:"loan"===es?"white":"#9ca3af"},children:"\ub300\ucd9c \uc0c1\ud488"})]}),as&&(0,m.jsx)("div",{className:"message-box ".concat(as.type," p-3 mb-4 rounded-lg text-white"),style:{background:"success"===as.type?"#065f46":"#991b1b"},children:as.text}),(0,m.jsxs)("div",{className:"add-product-form p-4 rounded-xl mb-4 bg-gray-700/50",children:[(0,m.jsxs)("h4",{className:"mb-3 text-white",children:["deposit"===es?"\uc608\uae08":"saving"===es?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488 \ucd94\uac00"]}),(0,m.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block mb-1 text-gray-400 text-xs",children:"\uc0c1\ud488\uba85"}),(0,m.jsx)("input",{type:"text",value:Qe,onChange:e=>Xe(e.target.value),placeholder:"\uc0c1\ud488\uba85 \uc785\ub825",className:"admin-input w-full"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block mb-1 text-gray-400 text-xs",children:"\uae30\uac04 (\uc77c)"}),(0,m.jsx)("input",{type:"number",value:Ye,onChange:e=>Ue(e.target.value),placeholder:"\uae30\uac04 (\uc77c)",min:"1",className:"admin-input w-full"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block mb-1 text-gray-400 text-xs",children:"\uc774\uc728 (%)"}),(0,m.jsx)("input",{type:"number",value:Ze,onChange:e=>$e(e.target.value),placeholder:"\uc774\uc728 (%)",min:"0",step:"0.1",className:"admin-input w-full"})]})]}),(0,m.jsx)("button",{onClick:Zs,className:"admin-save-button w-full",children:"\uc0c1\ud488 \ucd94\uac00\ud558\uae30"})]}),(0,m.jsxs)("div",{className:"product-list",children:[(0,m.jsxs)("h4",{className:"mb-3 text-white",children:["deposit"===es?"\uc608\uae08":"saving"===es?"\uc801\uae08":"\ub300\ucd9c"," \uc0c1\ud488 \ubaa9\ub85d"]}),(()=>{const e="deposit"===es?He:"saving"===es?Ge:qe;return 0===e.length?(0,m.jsx)("p",{className:"no-items-message",children:"\ub4f1\ub85d\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,m.jsx)("div",{className:"members-table-container",children:(0,m.jsxs)("table",{className:"members-table",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"\uc0c1\ud488\uba85"}),(0,m.jsx)("th",{children:"\uae30\uac04 (\uc77c)"}),(0,m.jsx)("th",{children:"\uc774\uc728 (%)"}),(0,m.jsx)("th",{children:"\uad00\ub9ac"})]})}),(0,m.jsx)("tbody",{children:e.map(e=>(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:e.name}),(0,m.jsxs)("td",{children:[e.period,"\uc77c"]}),(0,m.jsxs)("td",{children:[e.rate,"%"]}),(0,m.jsx)("td",{children:(0,m.jsx)("button",{onClick:()=>$s(e.id,es),className:"delete-button",children:"\uc0ad\uc81c"})})]},e.id))})]})})})()]})]})]}),"financeAndMarket"===g&&"market"===ds&&(0,m.jsxs)("div",{className:"market-control-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsxs)("div",{className:"market-control-settings section-card",children:[(0,m.jsx)("h3",{children:"\uc8fc\uc2dd \uc2dc\uc7a5 \uc81c\uc5b4"}),(0,m.jsx)("p",{className:"admin-section-desc",children:"\uc8fc\uc2dd \uc2dc\uc7a5\uc758 \uac1c\uc7a5/\ud3d0\uc7a5 \uc0c1\ud0dc\ub97c \uc218\ub3d9\uc73c\ub85c \uc81c\uc5b4\ud569\ub2c8\ub2e4."}),(0,m.jsxs)("div",{className:"p-4 rounded-xl mb-4 bg-gray-700/50",children:[(0,m.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,m.jsxs)("p",{className:"text-white",children:["\ud604\uc7ac \uc0c1\ud0dc:"," ",(0,m.jsx)("span",{className:"font-bold px-3 py-1 rounded-2xl",style:{color:us.isOpen?"#22c55e":"#ef4444",background:us.isOpen?"rgba(34, 197, 94, 0.2)":"rgba(239, 68, 68, 0.2)"},children:us.isOpen?"\ud83d\udfe2 \uac1c\uc7a5":"\ud83d\udd34 \ud3d0\uc7a5"})]}),(0,m.jsx)("button",{onClick:()=>ea(!0),className:"admin-button",disabled:!u,children:"\uc0c8\ub85c\uace0\uce68"})]}),(0,m.jsxs)("div",{className:"flex gap-3 mb-4",children:[(0,m.jsx)("button",{onClick:()=>sa(!0),disabled:us.isOpen,className:"admin-save-button flex-1",style:{background:us.isOpen?"#374151":"#22c55e",cursor:us.isOpen?"not-allowed":"pointer"},children:"\uc218\ub3d9 \uac1c\uc7a5"}),(0,m.jsx)("button",{onClick:()=>sa(!1),disabled:!us.isOpen,className:"admin-cancel-button flex-1",style:{background:us.isOpen?"#ef4444":"#374151",cursor:us.isOpen?"pointer":"not-allowed"},children:"\uc218\ub3d9 \ud3d0\uc7a5"})]}),(0,m.jsxs)("p",{className:"text-xs text-gray-400",children:["\ubc84\ud2bc\uc744 \ub204\ub974\uba74 \uc815\ud574\uc9c4 \uc2dc\uac04\uacfc \uc0c1\uad00\uc5c6\uc774 \uc2dc\uc7a5 \uc0c1\ud0dc\uac00 \uc989\uc2dc \ubcc0\uacbd\ub429\ub2c8\ub2e4.",(0,m.jsx)("br",{}),"\uc790\ub3d9 \uac1c\uc7a5/\ud3d0\uc7a5 \uc2dc\uac04(\uc6d4-\uae08, \uc624\uc804 8\uc2dc/\uc624\ud6c4 3\uc2dc)\uc774 \ub418\uba74 \uc790\ub3d9\uc73c\ub85c \uc0c1\ud0dc\uac00 \ubcc0\uacbd\ub429\ub2c8\ub2e4."]})]}),xs&&(0,m.jsx)("div",{className:"p-3 mb-4 rounded-lg bg-amber-600 text-white text-center",children:xs}),(0,m.jsxs)("div",{className:"p-4 rounded-xl bg-red-500/10 border border-red-500/30",children:[(0,m.jsx)("h4",{className:"mb-3 text-red-500",children:"\u26a0\ufe0f \uc8fc\uc2dd \uc815\ubcf4 \ucd08\uae30\ud654"}),(0,m.jsx)("p",{className:"text-xs text-gray-400 mb-3",children:"\uc8fc\uc758: \uc774 \ubc84\ud2bc\uc744 \ub204\ub974\uba74 \ubaa8\ub4e0 \uc8fc\uc2dd\uc758 \uac00\uaca9\uacfc \uac70\ub798 \ub0b4\uc5ed\uc774 \uae30\ubcf8\uac12\uc73c\ub85c \ucd08\uae30\ud654\ub429\ub2c8\ub2e4. \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."}),(0,m.jsx)("button",{onClick:aa,className:"w-full p-3 rounded-lg bg-orange-600 text-white border-0 cursor-pointer font-semibold",children:"\ubaa8\ub4e0 \uc8fc\uc2dd \uc815\ubcf4 \ucd08\uae30\ud654"})]})]})]}),"financeAndMarket"===g&&"parking"===ds&&(0,m.jsxs)("div",{className:"parking-account-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsxs)("div",{className:"parking-account-settings section-card",children:[(0,m.jsx)("h3",{children:"\ud30c\ud0b9 \ud1b5\uc7a5 \uc774\uc790\uc728 \uad00\ub9ac"}),(0,m.jsx)("p",{className:"admin-section-desc",children:"\ud30c\ud0b9 \ud1b5\uc7a5\uc758 \uc77c\uc77c \uc774\uc790\uc728\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."}),ks&&(0,m.jsx)("div",{className:"p-3 mb-4 rounded-lg text-white",style:{background:"success"===ks.type?"#065f46":"#991b1b"},children:ks.text}),(0,m.jsxs)("div",{className:"p-4 rounded-xl mb-4 bg-gray-700/50",children:[(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsx)("p",{className:"text-gray-400 text-sm",children:"\ud604\uc7ac \uc77c\uc77c \uc774\uc790\uc728"}),(0,m.jsxs)("p",{className:"text-green-500 text-[32px] font-bold",children:[js,"%"]})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{className:"block mb-2 text-gray-400",children:"\uc0c8 \uc77c\uc77c \uc774\uc790\uc728 (%)"}),(0,m.jsx)("input",{type:"number",value:ys,onChange:e=>Ns(e.target.value),placeholder:"\uc0c8 \uc774\uc790\uc728 \uc785\ub825 (%)",min:"0",step:"0.01",className:"admin-input mb-3"}),(0,m.jsx)("button",{onClick:na,className:"admin-save-button w-full",disabled:!ys||isNaN(ys)||parseFloat(ys)<0,children:"\uc774\uc790\uc728 \ubcc0\uacbd"})]}),(0,m.jsx)("p",{className:"text-xs text-gray-400 mt-3",children:"\ud30c\ud0b9 \ud1b5\uc7a5\uc5d0 \uc608\uce58\ub41c \uae08\uc561\uc740 \ub9e4\uc77c \uc124\uc815\ub41c \uc774\uc790\uc728\ub9cc\ud07c \uc774\uc790\uac00 \ubc1c\uc0dd\ud569\ub2c8\ub2e4."})]})]})]}),"studentAndMember"===g&&"member"===is&&(0,m.jsxs)("div",{className:"member-management-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsxs)("div",{className:"admin-class-members-container section-card",children:[(0,m.jsx)("h3",{children:"\ud559\uae09 \uad6c\uc131\uc6d0 \uad00\ub9ac"}),We&&(0,m.jsx)("p",{className:"error-message",children:We}),(0,m.jsxs)("p",{className:"admin-section-desc",children:["\ud559\uae09 \uad6c\uc131\uc6d0\uc758 \uc815\ubcf4\ub97c \ud655\uc778\ud558\uace0 \uad00\ub9ac\ud569\ub2c8\ub2e4.",c&&" \ucd5c\uace0 \uad00\ub9ac\uc790\ub294 \ubaa8\ub4e0 \ud559\uae09\uc758 \uad6c\uc131\uc6d0\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),ve?(0,m.jsx)("p",{children:"\uad6c\uc131\uc6d0 \uc815\ubcf4 \ub85c\ub529 \uc911..."}):pe.length>0?(0,m.jsx)("div",{className:"user-cards-container",children:pe.map(e=>(0,m.jsxs)("div",{className:"user-card",children:[(0,m.jsxs)("div",{className:"user-card-header",children:[(0,m.jsx)("span",{className:"user-card-name",children:e.name}),(0,m.jsx)("span",{className:"user-card-role role-".concat(e.isSuperAdmin?"super":e.isAdmin?"admin":"student"),children:e.isSuperAdmin?"\ucd5c\uace0 \uad00\ub9ac\uc790":e.isAdmin?"\uad00\ub9ac\uc790":"\ud559\uc0dd"})]}),(0,m.jsxs)("div",{className:"user-card-body",children:[(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"\uc774\uba54\uc77c:"})," ",e.email]}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"\ud559\uae09 \ucf54\ub4dc:"})," ",e.classCode]})]}),c&&(0,m.jsxs)("div",{className:"user-card-actions",children:[!e.isSuperAdmin&&(0,m.jsx)("button",{onClick:()=>Ys(e.id,e.isAdmin),className:"admin-action-button ".concat(e.isAdmin?"remove-admin-button":"add-admin-button"),disabled:ve,children:e.isAdmin?"\uad00\ub9ac\uc790 \ud574\uc81c":"\uad00\ub9ac\uc790 \uc9c0\uc815"}),(0,m.jsx)("button",{onClick:()=>Xs(e.id),className:"admin-action-button reset-password-button",disabled:ve,children:"\ube44\ubc00\ubc88\ud638 \ucd08\uae30\ud654"})]})]},e.id))}):(0,m.jsx)("p",{className:"no-members-message",children:c||u?"\ub4f1\ub85d\ub41c \ud559\uae09 \uad6c\uc131\uc6d0\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.":"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."}),(0,m.jsx)("div",{className:"refresh-members-section",children:(0,m.jsx)("button",{onClick:Vs,className:"admin-button",disabled:ve,children:ve?"\ub85c\ub529 \uc911...":"\uad6c\uc131\uc6d0 \ubaa9\ub85d \uc0c8\ub85c\uace0\uce68"})})]})]}),"studentAndMember"===g&&"salary"===is&&(0,m.jsxs)("div",{className:"salary-settings-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsxs)("div",{className:"salary-settings section-card",children:[(0,m.jsx)("h3",{children:"\uae09\uc5ec \uc124\uc815"}),(0,m.jsx)("p",{className:"admin-section-desc",children:"\uc138\uc728\uacfc \uc8fc\uae09 \uc778\uc0c1\ub960\uc744 \uc124\uc815\ud569\ub2c8\ub2e4. \uc790\ub3d9 \uc8fc\uae09 \uc9c0\uae09\uc740 \ub9e4\uc8fc \uae08\uc694\uc77c \uc624\uc804 8\uc2dc\uc5d0 \uc2e4\ud589\ub429\ub2c8\ub2e4."}),(0,m.jsxs)("div",{className:"salary-settings-form",children:[(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{children:"\uc138\uc728 (%):"}),(0,m.jsx)("input",{type:"number",min:"0",max:"100",step:"0.1",value:Fs,onChange:e=>Ts(e.target.value),className:"admin-input",placeholder:"\uc608: 10 (10%)"}),(0,m.jsx)("small",{className:"form-help",children:"\ud559\uc0dd\ub4e4\uc758 \uc8fc\uae09\uc5d0\uc11c \uacf5\uc81c\ub420 \uc138\uc728\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsx)("label",{children:"\uc8fc\uae09 \uc778\uc0c1\ub960 (%):"}),(0,m.jsx)("input",{type:"number",min:"0",max:"100",step:"0.1",value:Ds,onChange:e=>Is(e.target.value),className:"admin-input",placeholder:"\uc608: 3 (3%)"}),(0,m.jsx)("small",{className:"form-help",children:"\ub9e4\uc8fc \uc790\ub3d9\uc73c\ub85c \uc801\uc6a9\ub420 \uc8fc\uae09 \uc778\uc0c1\ub960\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."})]}),(0,m.jsx)("button",{onClick:Ls,className:"admin-save-button",disabled:Ms,children:Ms?"\uc800\uc7a5 \uc911...":"\uae09\uc5ec \uc124\uc815 \uc800\uc7a5"})]}),(0,m.jsxs)("div",{className:"current-salary-settings",children:[(0,m.jsx)("h4",{children:"\ud604\uc7ac \uae09\uc5ec \uc124\uc815"}),(0,m.jsxs)("div",{className:"settings-display",children:[(0,m.jsxs)("p",{children:["\ud604\uc7ac \uc138\uc728: ",(0,m.jsxs)("strong",{children:[(100*Cs.taxRate).toFixed(1),"%"]})]}),(0,m.jsxs)("p",{children:["\ud604\uc7ac \uc8fc\uae09 \uc778\uc0c1\ub960: ",(0,m.jsxs)("strong",{children:[(100*Cs.salaryIncreaseRate).toFixed(1),"%"]})]}),(0,m.jsxs)("p",{children:["\ub9c8\uc9c0\ub9c9 \uc790\ub3d9 \uc9c0\uae09\uc77c: ",(0,m.jsx)("strong",{children:ra()})]})]}),(0,m.jsxs)("div",{className:"salary-calculation-example",children:[(0,m.jsx)("h5",{children:"\uc8fc\uae09 \uacc4\uc0b0 \uc608\uc2dc"}),(0,m.jsxs)("p",{children:["\u2022 \uc9c1\uc5c5 1\uac1c: \ucd1d 200\ub9cc\uc6d0 \u2192 \uc138\uae08 ",(2e6*Cs.taxRate/1e4).toFixed(0),"\ub9cc\uc6d0 \uacf5\uc81c \u2192 \uc2e4\uae09\uc5ec ",(2e6*(1-Cs.taxRate)/1e4).toFixed(0),"\ub9cc\uc6d0"]}),(0,m.jsxs)("p",{children:["\u2022 \uc9c1\uc5c5 2\uac1c: \ucd1d 250\ub9cc\uc6d0 \u2192 \uc138\uae08 ",(25e5*Cs.taxRate/1e4).toFixed(0),"\ub9cc\uc6d0 \uacf5\uc81c \u2192 \uc2e4\uae09\uc5ec ",(25e5*(1-Cs.taxRate)/1e4).toFixed(0),"\ub9cc\uc6d0"]}),(0,m.jsxs)("p",{children:["\u2022 \uc9c1\uc5c5 3\uac1c: \ucd1d 300\ub9cc\uc6d0 \u2192 \uc138\uae08 ",(3e6*Cs.taxRate/1e4).toFixed(0),"\ub9cc\uc6d0 \uacf5\uc81c \u2192 \uc2e4\uae09\uc5ec ",(3e6*(1-Cs.taxRate)/1e4).toFixed(0),"\ub9cc\uc6d0"]})]}),(0,m.jsxs)("div",{className:"auto-payment-info",children:[(0,m.jsx)("h5",{children:"\uc790\ub3d9 \uc8fc\uae09 \uc9c0\uae09 \uc2dc\uc2a4\ud15c"}),(0,m.jsx)("p",{children:"\ud83e\udd16 \ub9e4\uc8fc \uae08\uc694\uc77c \uc624\uc804 8\uc2dc\uc5d0 \uc11c\ubc84\uc5d0\uc11c \uc790\ub3d9\uc73c\ub85c \uc8fc\uae09\uc774 \uc9c0\uae09\ub429\ub2c8\ub2e4."}),(0,m.jsx)("p",{children:"\ud83d\udcc8 \ub9e4\uc8fc \uc8fc\uae09 \uc778\uc0c1\ub960\ub9cc\ud07c \uae09\uc5ec\uac00 \uc790\ub3d9\uc73c\ub85c \uc778\uc0c1\ub429\ub2c8\ub2e4."}),(0,m.jsx)("p",{children:"\ud83d\udcb0 \uc138\uae08\uc774 \uc790\ub3d9\uc73c\ub85c \uacf5\uc81c\ub418\uc5b4 \uc2e4\uae09\uc5ec\uac00 \uc9c0\uae09\ub429\ub2c8\ub2e4."}),(0,m.jsx)("p",{children:"\u2699\ufe0f \uad00\ub9ac\uc790\uac00 \ub85c\uadf8\uc778\ud558\uc9c0 \uc54a\uc544\ub3c4 \uc790\ub3d9\uc73c\ub85c \uc2e4\ud589\ub429\ub2c8\ub2e4."})]})]})]})]}),"system"===g&&(0,m.jsxs)("div",{className:"flex gap-2 mb-4 p-3 rounded-xl bg-[#16213e]/50 border border-gray-700/50",children:[(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("database"===os?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>ms("database"),children:"\ub370\uc774\ud130\ubca0\uc774\uc2a4"}),c&&(0,m.jsx)("button",{className:"px-4 py-2 rounded-xl text-sm font-medium transition-all ".concat("system"===os?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/30":"text-gray-400 hover:text-white hover:bg-gray-700/50"),onClick:()=>ms("system"),children:"\uc2dc\uc2a4\ud15c \uad00\ub9ac"})]}),"system"===g&&"database"===os&&(0,m.jsxs)("div",{className:"database-management-tab",children:[!c&&u&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsxs)("p",{className:"current-class-info",children:["\ud83c\udfeb \ud604\uc7ac \uad00\ub9ac \ud559\uae09: ",(0,m.jsx)("strong",{children:u})]})}),(0,m.jsx)("div",{className:"database-management-container section-card min-h-[500px] max-h-[70vh] overflow-auto",children:(0,m.jsx)(V.default,{})}),(0,m.jsxs)("div",{className:"section-card mt-6 p-6 rounded-2xl bg-violet-500/5 border border-violet-500/30",children:[(0,m.jsx)("h3",{className:"text-lg font-bold text-violet-300 mb-3",children:"\uac1c\uc778\uc815\ubcf4 \ubcf4\ud638 \ubb38\uc11c"}),(0,m.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:"\ud559\ubd80\ubaa8 \ub3d9\uc758\uc11c \uc591\uc2dd\uacfc \uac1c\uc778\uc815\ubcf4\ucc98\ub9ac\ubc29\uce68\uc744 \ud655\uc778\ud558\uc138\uc694."}),(0,m.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,m.jsx)("a",{href:"/consent-form",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-violet-600 hover:bg-violet-500 text-white rounded-lg transition-colors text-sm font-medium",children:"\ud83d\udcc4 \uac00\uc815\ud1b5\uc2e0\ubb38 (\ub3d9\uc758\uc11c \uc591\uc2dd)"}),(0,m.jsx)("a",{href:"/privacy",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-colors text-sm font-medium",children:"\ud83d\udd12 \uac1c\uc778\uc815\ubcf4\ucc98\ub9ac\ubc29\uce68"})]})]}),(0,m.jsx)(X,{userClassCode:u,isAdmin:a,isSuperAdmin:c})]}),"system"===g&&"system"===os&&(0,m.jsxs)("div",{className:"system-management-tab",children:[c&&(0,m.jsx)("div",{className:"class-info-header",children:(0,m.jsx)("p",{className:"current-class-info",children:"\ud83c\udf10 \uc2dc\uc2a4\ud15c \uc804\uccb4 \uad00\ub9ac (\ucd5c\uace0 \uad00\ub9ac\uc790)"})}),c&&(0,m.jsxs)("div",{className:"admin-class-codes-container section-card",children:[(0,m.jsx)("h3",{children:"\ud559\uae09 \ucf54\ub4dc \uad00\ub9ac"}),We&&(0,m.jsx)("p",{className:"error-message",children:We}),(0,m.jsxs)("div",{className:"add-class-code-form",children:[(0,m.jsx)("input",{type:"text",value:ue,onChange:e=>he(e.target.value),placeholder:"\uc0c8 \ud559\uae09 \ucf54\ub4dc \uc785\ub825",disabled:xe,className:"admin-input"}),(0,m.jsx)("button",{onClick:la,disabled:xe||!ue.trim(),className:"admin-button",children:xe?"\ucd94\uac00 \uc911...":"\ucf54\ub4dc \ucd94\uac00"})]}),(0,m.jsxs)("div",{className:"class-codes-list",children:[(0,m.jsxs)("h4",{children:["\ub4f1\ub85d\ub41c \ud559\uae09 \ucf54\ub4dc \ubaa9\ub85d (",Array.isArray(ce)?ce.length:0,"\uac1c)"]}),Array.isArray(ce)&&ce.length>0?(0,m.jsx)("ul",{className:"codes-list",children:ce.map(e=>(0,m.jsxs)("li",{className:"code-item",children:[(0,m.jsx)("span",{className:"code-text",children:e}),(0,m.jsx)("button",{onClick:()=>ia(e),className:"remove-code-button",disabled:xe,children:"\uc0ad\uc81c"})]},e))}):(0,m.jsx)("p",{className:"no-codes-message",children:"\ub4f1\ub85d\ub41c \ud559\uae09 \ucf54\ub4dc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]}),(0,m.jsx)(q,{isSuperAdmin:c})]}),(0,m.jsx)("div",{className:"admin-settings-footer",children:(0,m.jsx)("button",{onClick:()=>x(!1),className:"admin-close-button",children:"\ub2eb\uae30"})})]}),fe&&Ne&&(0,m.jsx)("div",{className:"modal-overlay show",children:(0,m.jsxs)("div",{className:"edit-student-jobs-modal",children:[(0,m.jsxs)("div",{className:"modal-header",children:[(0,m.jsxs)("h3",{children:["\ud559\uc0dd \uc9c1\uc5c5 \uc124\uc815:"," ",Ne.nickname||Ne.name]}),(0,m.jsx)("button",{className:"close-modal-btn",onClick:()=>ye(!1),children:"\u2715"})]}),(0,m.jsxs)("div",{className:"modal-body",children:[(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:Ne.nickname||Ne.name}),"\ub2d8\uc758 \uc9c1\uc5c5\uc744 \uc124\uc815\ud569\ub2c8\ub2e4."]}),(0,m.jsxs)("div",{className:"salary-info",children:[(0,m.jsxs)("p",{children:["\ud604\uc7ac \ubcf4\uc720 \ud604\uae08: ",(Ne.cash||0).toLocaleString(),"\uc6d0"]}),(()=>{const e=Ws(we,!0);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("p",{children:["\uc608\uc0c1 \ucd1d\uae09\uc5ec: ","".concat((e.gross/1e4).toFixed(0),"\ub9cc\uc6d0")]}),(0,m.jsxs)("p",{children:["\uc138\uae08 \uacf5\uc81c: ","".concat((e.tax/1e4).toFixed(0),"\ub9cc\uc6d0")," (",(100*Cs.taxRate).toFixed(1),"%)"]}),(0,m.jsxs)("p",{children:["\uc2e4\uae09\uc5ec: ","".concat((e.net/1e4).toFixed(0),"\ub9cc\uc6d0")]})]})})(),(0,m.jsxs)("p",{className:"salary-explanation",children:["(\uae30\ubcf8 200\ub9cc\uc6d0 + \ucd94\uac00 \uc9c1\uc5c5\ub2f9 50\ub9cc\uc6d0, \uc138\uae08 ",(100*Cs.taxRate).toFixed(1),"% \uacf5\uc81c)"]})]}),(0,m.jsx)("div",{className:"job-selection-list",children:Array.isArray(N)&&N.filter(e=>!1!==e.active).length>0?N.filter(e=>!1!==e.active).map(e=>(0,m.jsxs)("div",{className:"job-selection-item",children:[(0,m.jsx)("input",{type:"checkbox",id:"job-modal-".concat(e.id),checked:we.includes(e.id),onChange:()=>{return s=e.id,void Ae(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s}}),(0,m.jsx)("label",{htmlFor:"job-modal-".concat(e.id),children:e.title})]},e.id)):(0,m.jsx)("p",{className:"no-items-message",children:"\uc124\uc815 \uac00\ub2a5\ud55c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})})]}),(0,m.jsxs)("div",{className:"modal-footer",children:[(0,m.jsx)("button",{className:"admin-cancel-button",onClick:()=>ye(!1),children:"\ucde8\uc18c"}),(0,m.jsx)("button",{className:"admin-save-button",onClick:async()=>{if(Ne&&i.db){Ie(!0);try{const e=(0,i.EW)(i.db,"users",Ne.id);await(0,i.tI)(e,{selectedJobIds:we,updatedAt:(0,i.O5)()}),Se(e=>e.map(e=>e.id===Ne.id?(0,t.A)((0,t.A)({},e),{},{selectedJobIds:we}):e)),alert("\ud559\uc0dd \uc9c1\uc5c5\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),ye(!1)}catch(We){o.vF.error("\ud559\uc0dd \uc9c1\uc5c5 \uc5c5\ub370\uc774\ud2b8 \uc624\ub958:",We),alert("\ud559\uc0dd \uc9c1\uc5c5 \uc5c5\ub370\uc774\ud2b8 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+We.message)}finally{Ie(!1)}}else alert("\ud559\uc0dd \uc815\ubcf4 \ub610\ub294 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958")},disabled:De,children:De?"\uc800\uc7a5 \uc911...":"\uc800\uc7a5"})]})]})})]}):(0,m.jsx)("div",{className:"admin-settings-modal show",children:(0,m.jsxs)("div",{className:"admin-settings-content",children:[(0,m.jsx)("h2",{children:"\uad00\ub9ac\uc790 \uc124\uc815"}),(0,m.jsx)("p",{children:"\uad00\ub9ac\uc790\ub9cc \uc811\uadfc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),(0,m.jsx)("button",{onClick:()=>x(!1),className:"admin-cancel-button",children:"\ub2eb\uae30"})]})}):null};var U=a(6555),Z=a(4891),$=a(3190),ee=a(9809),se=a(7365),ae=a(516),te=a(4805),ne=a(9463),le=a(1360);const ie={JOBS:216e5,TASKS:216e5,SETTINGS:432e5,GOALS:216e5,CLASS_CODES:864e5},re=e=>Z.Ay.get(e),de=(e,s,a)=>Z.Ay.set(e,s,a||ie.TASKS),ce=e=>Z.Ay.invalidate(e),oe=()=>Z.Ay.clearAll();const me=new class{constructor(){this.pendingWrites=[],this.batchTimeout=null,this.BATCH_DELAY=2e3,this.MAX_BATCH_SIZE=500}addWrite(e){this.pendingWrites.push(e),this.pendingWrites.length>=this.MAX_BATCH_SIZE?this.executeBatch():this.scheduleBatch()}scheduleBatch(){this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.executeBatch()},this.BATCH_DELAY)}async executeBatch(){if(0===this.pendingWrites.length)return;this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null);const e=(0,r.wP)(i.db),s=[...this.pendingWrites];this.pendingWrites=[];try{s.forEach(s=>{let{type:a,ref:t,data:n}=s;switch(a){case"set":e.set(t,n);break;case"update":e.update(t,n);break;case"delete":e.delete(t)}}),await e.commit(),o.vF.log("\ubc30\uce58 \uc2e4\ud589 \uc644\ub8cc: ".concat(s.length,"\uac1c \uc791\uc5c5"))}catch(a){o.vF.error("\ubc30\uce58 \uc2e4\ud589 \uc2e4\ud328:",a)}}};class ue{constructor(){this.listeners=new Map}addListener(e,s){this.listeners.has(e)&&this.listeners.get(e)(),this.listeners.set(e,s)}removeListener(e){this.listeners.has(e)&&(this.listeners.get(e)(),this.listeners.delete(e))}removeAllListeners(){this.listeners.forEach(e=>e()),this.listeners.clear()}}function he(e){let{availableJobs:s,currentSelectedJobIds:a=[],onConfirmSelection:t,onCancel:l}=e;const[i,r]=(0,n.useState)(Array.isArray(a)?[...a]:[]),d=(0,n.useMemo)(()=>Array.isArray(s)?s.filter(e=>!1!==e.active):[],[s]),c=(0,n.useCallback)(e=>{r(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},[]);return(0,m.jsxs)("div",{className:"bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg border border-cyan-900/30 p-6 max-w-xl mx-auto my-8",children:[(0,m.jsx)("h4",{className:"text-xl font-semibold text-white text-center mb-2",children:"\uc9c1\uc5c5 \uc120\ud0dd (\ub2e4\uc911 \uc120\ud0dd \uac00\ub2a5)"}),(0,m.jsx)("p",{className:"text-sm text-slate-400 text-center mb-4",children:"'\ub098\uc758 \ud560\uc77c'\uc5d0 \ud45c\uc2dc\ud560 \uc9c1\uc5c5\uc744 \uc120\ud0dd\ud558\uc138\uc694."}),(0,m.jsxs)("div",{className:"flex flex-col gap-3",children:[d.map(e=>(0,m.jsxs)("label",{className:"p-3 rounded-xl border-2 cursor-pointer transition-all flex items-center gap-3 ".concat(i.includes(e.id)?"border-cyan-500 bg-cyan-900/30":"border-cyan-900/20 bg-[#14142380] hover:border-cyan-500/50"),children:[(0,m.jsx)("input",{type:"checkbox",checked:i.includes(e.id),onChange:()=>c(e.id),className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500 cursor-pointer"}),(0,m.jsx)("span",{className:"font-medium ".concat(i.includes(e.id)?"text-cyan-400":"text-slate-300"),children:e.title})]},e.id)),0===d.length&&(0,m.jsx)(U.pp,{icon:$.A,title:"\uc120\ud0dd \uac00\ub2a5\ud55c \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4",description:"\uad00\ub9ac\uc790\uac00 \uc9c1\uc5c5\uc744 \ub4f1\ub85d\ud558\uba74 \uc5ec\uae30\uc5d0 \ud45c\uc2dc\ub429\ub2c8\ub2e4."})]}),(0,m.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,m.jsx)(U.rA,{variant:"secondary",onClick:l,children:"\ucde8\uc18c"}),(0,m.jsx)(U.rA,{variant:"primary",onClick:()=>t(i),children:"\uc120\ud0dd \uc644\ub8cc"})]})]})}const xe=function(e){let{adminTabMode:s}=e;const{user:a,userDoc:c,setUserDoc:u,loading:h,updateUser:x,refreshUserDocument:g,isAdmin:p,isSuperAdmin:b,optimisticUpdate:v}=(0,l.As)(),j=(0,n.useRef)(new ue),f=(0,n.useRef)(0),y=(0,n.useRef)(null),[N,k]=(0,n.useState)(!0),[w,A]=(0,n.useState)("list"),[C,S]=(0,n.useState)(!1),[F,T]=(0,n.useState)("generalSettings"),[D,J]=(0,n.useState)([]),[E,R]=(0,n.useState)([]),[_,O]=(0,n.useState)(null),[P,L]=(0,n.useState)(""),[W,z]=(0,n.useState)(null),[H,B]=(0,n.useState)(null),[G,K]=(0,n.useState)(!1),[q,V]=(0,n.useState)(!1),[Q,X]=(0,n.useState)(""),[Z,xe]=(0,n.useState)(""),[ge,pe]=(0,n.useState)("5"),be=(0,n.useMemo)(()=>(0,d.Qg)(i.Cn,"completeTask"),[]),ve=(0,n.useMemo)(()=>(0,d.Qg)(i.Cn,"manualResetClassTasks"),[]),[je,fe]=(0,n.useState)(!1),[ye,Ne]=(0,n.useState)(1e3),[ke,we]=(0,n.useState)(1e3),[Ae,Ce]=(0,n.useState)(String(1e3)),[Se,Fe]=(0,n.useState)(String(1e3)),[Te,De]=(0,n.useState)([]);(0,n.useEffect)(()=>{s&&null!==p&&void 0!==p&&p()&&(T(s),S(!0))},[s,p]);const Ie=(0,n.useMemo)(()=>null!==c&&void 0!==c&&c.classCode&&null!==p&&void 0!==p&&p()?"".concat(c.classCode,"_goal"):null,[null===c||void 0===c?void 0:c.classCode,p]),Me=(0,n.useMemo)(()=>c&&Array.isArray(c.selectedJobIds)?c.selectedJobIds:[],[c]),Je=(0,n.useMemo)(()=>{const e=(null===c||void 0===c?void 0:c.completedJobTasks)||{};return Array.isArray(D)?D.filter(e=>Me.includes(e.id)&&!1!==e.active).map(s=>(0,t.A)((0,t.A)({},s),{},{tasks:(s.tasks||[]).map(a=>(0,t.A)((0,t.A)({},a),{},{clicks:e["".concat(s.id,"_").concat(a.id)]||0}))})):[]},[D,Me,c]),Ee=(0,n.useMemo)(()=>{if(!E||!c)return[];const e=c.completedTasks||{};return E.map(s=>(0,t.A)((0,t.A)({},s),{},{clicks:e[s.id]||0}))},[E,c]),Re=(0,n.useCallback)(()=>{try{return(0,r.H9)((0,r.rJ)(i.db,"temp")).id}catch(e){return o.vF.error("Error generating ID:",e),Date.now().toString()+Math.random().toString(36).substring(2,11)}},[]),_e=(0,n.useCallback)(async e=>{if(!e)return;const s=async()=>{try{const s=(0,r.query)((0,r.rJ)(i.db,"jobs"),(0,r.where)("classCode","==",e),(0,r.limit)(50)),a=(await(0,r.getDocs)(s)).docs.map(e=>(0,t.A)((0,t.A)({id:e.id},e.data()),{},{tasks:(e.data().tasks||[]).map(e=>(0,t.A)((0,t.A)({},e),{},{reward:e.reward||0,clicks:0,maxClicks:e.maxClicks||5})),active:!1!==e.data().active})).sort((e,s)=>{var a,t,n,l;const i=(null===(a=e.updatedAt)||void 0===a||null===(t=a.toMillis)||void 0===t?void 0:t.call(a))||0;return((null===(n=s.updatedAt)||void 0===n||null===(l=n.toMillis)||void 0===l?void 0:l.call(n))||0)-i});J(a),de("jobs_".concat(e),a,ie.JOBS);const n=(0,r.query)((0,r.rJ)(i.db,"commonTasks"),(0,r.where)("classCode","==",e),(0,r.limit)(50)),l=(await(0,r.getDocs)(n)).docs.map(e=>(0,t.A)((0,t.A)({id:e.id},e.data()),{},{reward:e.data().reward||0,clicks:e.data().clicks||0,maxClicks:e.data().maxClicks||5})).sort((e,s)=>{var a,t,n,l;const i=(null===(a=e.updatedAt)||void 0===a||null===(t=a.toMillis)||void 0===t?void 0:t.call(a))||0;return((null===(n=s.updatedAt)||void 0===n||null===(l=n.toMillis)||void 0===l?void 0:l.call(n))||0)-i});R(l),de("commonTasks_".concat(e),l,ie.TASKS)}catch(s){o.vF.error("Polling \uc5d0\ub7ec:",s)}};await s();const a=setInterval(s,72e5);j.current.addListener("polling",()=>clearInterval(a))},[]),Oe=(0,n.useCallback)(async e=>{const s=re("jobs_".concat(e)),a=re("commonTasks_".concat(e)),t=re("mainSettings");return s&&J(s),a&&R(a),t&&(we(t.couponValue||1e3),Ce(String(t.couponValue||1e3))),{hasJobsCache:!!s,hasTasksCache:!!a,hasSettingsCache:!!t}},[]),Pe=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null===c||void 0===c||!c.classCode)return void k(!1);const s=Date.now(),a=c.classCode;if(y.current&&!e)return y.current;if(!e&&s-f.current<72e5)return void k(!1);k(!0);return y.current=(async()=>{try{const t=await Oe(a);t.hasJobsCache&&t.hasTasksCache&&k(!1),j.current.listeners.has("jobs")||setTimeout(()=>_e(a),0);const n=[];if(t.hasSettingsCache&&!e||n.push((0,r.x7)((0,r.H9)(i.db,"settings","mainSettings")).then(e=>({type:"settings",data:e.exists()?e.data():null}))),!Ie||re("goal_".concat(Ie))&&!e||n.push((0,r.x7)((0,r.H9)(i.db,"goals",Ie)).then(e=>({type:"goal",data:e.exists()?e.data():null}))),!b()||re("classCodes")&&!e||n.push((0,r.x7)((0,r.H9)(i.db,"settings","classCodes")).then(e=>({type:"classCodes",data:e.exists()?e.data():null}))),n.length>0){(await Promise.all(n)).forEach(e=>{switch(e.type){case"settings":if(e.data){const s=e.data.couponValue||1e3;we(s),Ce(String(s)),de("mainSettings",e.data,ie.SETTINGS)}break;case"goal":if(e.data&&e.data.classCode===a){const s=e.data.targetAmount||1e3;Ne(s),Fe(String(s)),de("goal_".concat(Ie),e.data,ie.GOALS)}break;case"classCodes":e.data&&(De(e.data.validCodes||[]),de("classCodes",e.data,ie.CLASS_CODES))}})}f.current=s}catch(t){o.vF.warn("[Dashboard] data fetch failed:",t)}finally{k(!1),y.current=null}})(),y.current},[null===c||void 0===c?void 0:c.classCode,Ie,b,_e,Oe]),Le=(0,n.useRef)(!1),We=(0,n.useCallback)(async()=>{if(Le.current)o.vF.log("[Dashboard] \uc774\ubbf8 \uc0c8\ub85c\uace0\uce68 \uc9c4\ud589 \uc911 - \uc911\ubcf5 \uc2e4\ud589 \ubc29\uc9c0");else{Le.current=!0,o.vF.log("[Dashboard] \uc11c\ubc84 \ub9ac\uc14b \uac10\uc9c0 - \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0c1\ud0dc \uc0c8\ub85c\uace0\uce68");try{g&&await g(),Pe&&await Pe(!0);const e=(new Date).toDateString();localStorage.setItem("lastTaskResetDate",e),o.vF.log("[Dashboard] \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0c1\ud0dc \uc0c8\ub85c\uace0\uce68 \uc644\ub8cc")}catch(e){o.vF.error("[Dashboard] \uc0c1\ud0dc \uc0c8\ub85c\uace0\uce68 \uc624\ub958:",e)}finally{Le.current=!1}}},[g,Pe]);(0,n.useEffect)(()=>{if(h)return void k(!0);if(!a)return k(!1),J([]),R([]),void j.current.removeAllListeners();null!==c&&void 0!==c&&c.id&&null!==c&&void 0!==c&&c.classCode?Pe():k(!1);const e=j.current;return()=>{e.removeAllListeners()}},[h,a,null===c||void 0===c?void 0:c.id,null===c||void 0===c?void 0:c.classCode,Pe]);const ze=(0,n.useRef)(!1),He=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(null===c||void 0===c||!c.classCode||!We)return;const e=()=>{const e=(new Date).toDateString(),s=localStorage.getItem("lastTaskResetDate");He.current!==e&&(He.current=e,s!==e&&We())};ze.current||(ze.current=!0,e());const s=setInterval(()=>{e()},36e5);return()=>{s&&clearInterval(s)}},[null===c||void 0===c?void 0:c.classCode,We]);const Be=(0,n.useCallback)(async()=>{if(!i.db||null===c||void 0===c||!c.classCode)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c.");const e=P.trim();if(e){k(!0);try{if(_){const s=(0,r.H9)(i.db,"jobs",_.id);me.addWrite({type:"update",ref:s,data:{title:e,updatedAt:(0,r.O5)()}}),alert("\uc9c1\uc5c5\uc774 \uc218\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),L(""),O(null),S(!1)}else{const s=Re(),a=(0,r.H9)(i.db,"jobs",s);me.addWrite({type:"set",ref:a,data:{title:e,active:!0,tasks:[],createdAt:(0,r.O5)(),updatedAt:(0,r.O5)(),classCode:c.classCode}}),alert("\uc9c1\uc5c5\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),L("")}ce("jobs_".concat(c.classCode))}catch(s){o.vF.error("handleSaveJob \uc624\ub958:",s),alert("\uc9c1\uc5c5 \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd")}finally{k(!1)}}else alert("\uc9c1\uc5c5 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},[P,_,Re,c]),Ge=(0,n.useCallback)(async e=>{if(i.db){if(window.confirm("\uc815\ub9d0\ub85c \uc774 \uc9c1\uc5c5\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uad00\ub828\ub41c \ud560\uc77c\ub3c4 \ubaa8\ub450 \uc0ad\uc81c\ub429\ub2c8\ub2e4.")){k(!0);try{var s;const t=(0,r.H9)(i.db,"jobs",e);if(me.addWrite({type:"delete",ref:t,data:null}),a&&null!==c&&void 0!==c&&null!==(s=c.selectedJobIds)&&void 0!==s&&s.includes(e)){const s=c.selectedJobIds.filter(s=>s!==e);await x({selectedJobIds:s})}(null===_||void 0===_?void 0:_.id)===e&&(L(""),O(null)),S(!1),alert("\uc9c1\uc5c5\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),ce("jobs_".concat(c.classCode))}catch(t){o.vF.error("handleDeleteJob \uc624\ub958:",t),alert("\uc9c1\uc5c5 \uc0ad\uc81c \uc911 \uc624\ub958 \ubc1c\uc0dd")}finally{k(!1)}}}else alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.")},[a,c,_,x]),Ke=(0,n.useCallback)(e=>{e?(O(e),L(e.title),T("jobSettings"),S(!0)):alert("\ud574\ub2f9 \uc9c1\uc5c5\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},[]),qe=(0,n.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;K(arguments.length>1&&void 0!==arguments[1]&&arguments[1]),B(e),X(""),xe(""),pe("5"),z(null),T("taskManagement"),V(!0),S(!0)},[]),Ve=(0,n.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e?(z(e),X(e.name),xe(String(e.reward||0)),pe(String(e.maxClicks||5)),K(!!s),B(s),T("taskManagement"),V(!0),S(!0)):alert("\uc218\uc815\ud560 \ud560\uc77c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},[]),Qe=(0,n.useCallback)(async()=>{if(!i.db||null===c||void 0===c||!c.classCode)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958 \ub610\ub294 \ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c.");const e=Q.trim(),s=parseInt(Z,10),a=parseInt(ge,10);if(!e||isNaN(s)||s<0||isNaN(a)||a<=0)return void alert("\uc785\ub825\uac12\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694. (\uc774\ub984, \ubcf4\uc0c1: 0 \uc774\uc0c1 \uc22b\uc790, \ucd5c\ub300 \ud074\ub9ad: 1 \uc774\uc0c1 \uc22b\uc790)");k(!0);const n={name:e,reward:s,maxClicks:a,clicks:(null===W||void 0===W?void 0:W.clicks)||0};try{if(W){const e=W.id;if(G&&H){const s=(0,r.H9)(i.db,"jobs",H),a=await(0,r.x7)(s);if(!a.exists()||a.data().classCode!==c.classCode)throw new Error("\uc9c1\uc5c5 \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uac70\ub098 \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");const l=a.data().tasks||[],d=l.findIndex(s=>s.id===e);if(-1===d)throw new Error("\uc9c1\uc5c5 \ub0b4 \ud560\uc77c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const o=[...l];o[d]=(0,t.A)((0,t.A)({},o[d]),n),me.addWrite({type:"update",ref:s,data:{tasks:o,updatedAt:(0,r.O5)()}})}else{const s=(0,r.H9)(i.db,"commonTasks",e);me.addWrite({type:"update",ref:s,data:(0,t.A)((0,t.A)({},n),{},{updatedAt:(0,r.O5)()})})}V(!1),z(null),S(!1),alert("\ud560\uc77c\uc774 \uc218\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}else{const e=Re(),s=(0,t.A)((0,t.A)({},n),{},{id:e,clicks:0});if(G&&H){const e=(0,r.H9)(i.db,"jobs",H);me.addWrite({type:"update",ref:e,data:{tasks:(0,r.hq)(s),updatedAt:(0,r.O5)()}})}else{const a=(0,r.H9)(i.db,"commonTasks",e);me.addWrite({type:"set",ref:a,data:(0,t.A)((0,t.A)({},s),{},{createdAt:(0,r.O5)(),updatedAt:(0,r.O5)(),classCode:c.classCode})})}X(""),xe(""),pe("5"),alert("\ud560\uc77c\uc774 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}ce(G?"jobs_".concat(c.classCode):"commonTasks_".concat(c.classCode))}catch(l){o.vF.error("handleSaveTask \uc624\ub958:",l),alert("\ud560\uc77c \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd: "+l.message)}finally{k(!1)}},[Q,Z,ge,W,G,H,Re,c]),Xe=(0,n.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(i.db){if(window.confirm("\uc815\ub9d0\ub85c \uc774 \ud560\uc77c\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){k(!0);try{if(s){const a=(0,r.H9)(i.db,"jobs",s),t=await(0,r.x7)(a);if(!t.exists())throw new Error("\uc9c1\uc5c5 \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const n=(t.data().tasks||[]).filter(s=>s.id!==e);me.addWrite({type:"update",ref:a,data:{tasks:n,updatedAt:(0,r.O5)()}})}else{const s=(0,r.H9)(i.db,"commonTasks",e);me.addWrite({type:"delete",ref:s,data:null})}(null===W||void 0===W?void 0:W.id)===e&&(V(!1),z(null)),S(!1),alert("\ud560\uc77c\uc774 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),ce(s?"jobs_".concat(c.classCode):"commonTasks_".concat(c.classCode))}catch(a){o.vF.error("handleDeleteTask \uc624\ub958:",a),alert("\ud560\uc77c \uc0ad\uc81c \uc911 \uc624\ub958 \ubc1c\uc0dd: "+a.message)}finally{k(!1)}}}else alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.")},[W,c]),Ye=(0,n.useCallback)(()=>{A("selectJob")},[]),Ue=(0,n.useCallback)(async e=>{if(null===a||void 0===a||!a.uid)return void alert("\uc0ac\uc6a9\uc790 \uc815\ubcf4 \uc624\ub958.");const s=Array.isArray(e)?e:[];k(!0);try{await x({selectedJobIds:s})?(u(e=>(0,t.A)((0,t.A)({},e),{},{selectedJobIds:s})),A("list"),alert("\uc120\ud0dd\ud55c \uc9c1\uc5c5\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")):alert("\uc120\ud0dd\ud55c \uc9c1\uc5c5 \uc800\uc7a5 \uc911 \uc624\ub958 \ubc1c\uc0dd.")}catch(n){o.vF.error("handleConfirmJobSelection \uc624\ub958:",n),alert("\uc120\ud0dd \uc9c1\uc5c5 \uc800\uc7a5 \uc911 \uc608\uc0c1\uce58 \ubabb\ud55c \uc624\ub958 \ubc1c\uc0dd.")}finally{k(!1)}},[a,x]),Ze=(0,n.useCallback)(()=>{A("list")},[]),$e=(0,n.useCallback)(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(je)return;if(null===c||void 0===c||!c.id)return void alert("\uc0ac\uc6a9\uc790 \uc815\ubcf4\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.");if(a&&s){var i,r;const a="".concat(s,"_").concat(e),t=(c.completedJobTasks||{})[a]||0,n=null===(i=D.find(e=>e.id===s))||void 0===i||null===(r=i.tasks)||void 0===r?void 0:r.find(s=>s.id===e);if(n&&n.maxClicks>0&&t>=n.maxClicks)return void o.vF.warn("[Dashboard] \uc774\ubbf8 \uc644\ub8cc\ub41c \uc9c1\uc5c5 \ud560\uc77c:",{taskKey:a,currentClicks:t,maxClicks:n.maxClicks})}else if(!a){const s=(c.completedTasks||{})[e]||0,a=null===E||void 0===E?void 0:E.find(s=>s.id===e);if(a&&a.maxClicks>0&&s>=a.maxClicks)return void o.vF.warn("[Dashboard] \uc774\ubbf8 \uc644\ub8cc\ub41c \uacf5\ud1b5 \ud560\uc77c:",{taskId:e,currentClicks:s,maxClicks:a.maxClicks})}fe(!0),o.vF.log("[Dashboard] \ud560\uc77c \uc644\ub8cc \ucc98\ub9ac \uc2dc\uc791:",{taskId:e,jobId:s,isJobTask:a,cardType:n,rewardAmount:l});let d=0,m=0;n&&l&&("cash"===n?d=l:"coupon"===n&&(m=l));const h=(0,t.A)({},c),x=c.cash+d,g=c.coupons+m;u(a&&s?a=>(0,t.A)((0,t.A)({},a),{},{cash:x,coupons:g,completedJobTasks:(0,t.A)((0,t.A)({},a.completedJobTasks||{}),{},{["".concat(s,"_").concat(e)]:((a.completedJobTasks||{})["".concat(s,"_").concat(e)]||0)+1})}):s=>{var a;return(0,t.A)((0,t.A)({},s),{},{cash:x,coupons:g,completedTasks:(0,t.A)((0,t.A)({},s.completedTasks||{}),{},{[e]:((null===(a=s.completedTasks)||void 0===a?void 0:a[e])||0)+1})})});try{const i=(await be({taskId:e,jobId:s,isJobTask:a,cardType:n,rewardAmount:l})).data;if(o.vF.log("\u2705 [\ub514\ubc84\uadf8] \uc11c\ubc84\ub85c\ubd80\ud130 \ubc1b\uc740 \uacb0\uacfc:",i),!i.success)throw new Error(i.message||"\uc54c \uc218 \uc5c6\ub294 \uc11c\ubc84 \uc624\ub958");{const e="number"===typeof i.updatedCash?i.updatedCash:x,s="number"===typeof i.updatedCoupons?i.updatedCoupons:g;o.vF.log("\u2705 [\ub514\ubc84\uadf8] \ub099\uad00\uc801 \uc5c5\ub370\uc774\ud2b8: \ud604\uae08 ".concat(x,"\uc6d0, \ucfe0\ud3f0 ").concat(g,"\uac1c \u2192 \uc11c\ubc84 \ud655\uc815: \ud604\uae08 ").concat(e,"\uc6d0, \ucfe0\ud3f0 ").concat(s,"\uac1c")),u(a=>(0,t.A)((0,t.A)({},a),{},{cash:e,coupons:s})),alert(i.message)}}catch(p){o.vF.error("[Dashboard] \ud560\uc77c \uc644\ub8cc \ucc98\ub9ac \uc911 \uc2ec\uac01\ud55c \uc624\ub958:",p),alert("\ud560\uc77c \uc644\ub8cc\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4: ".concat(p.message)),u(h)}finally{fe(!1)}},[je,c,E,D,u,be]),es=(0,n.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generalSettings";Fe(String(ye)),Ce(String(ke)),T(e),S(!0)},[ye,ke]),ss=(0,n.useCallback)(async()=>{if(o.vF.log("--- [DEBUG] EXECUTING handleSaveAdminSettings with LATEST code ---"),!i.db)return void alert("\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc624\ub958.");const e=parseInt(Se,10),s=parseInt(Ae,10);if(isNaN(e)||e<=0||isNaN(s)||s<=0)alert("\uc62c\ubc14\ub978 \ubaa9\ud45c \uae08\uc561\uacfc \ucfe0\ud3f0 \uac00\uce58\ub97c \uc785\ub825\ud558\uc138\uc694 (0\ubcf4\ub2e4 \ud070 \uc22b\uc790).");else{k(!0);try{const t=(0,r.H9)(i.db,"settings","mainSettings"),n=await(0,r.x7)(t);if(n.exists()&&n.data().couponValue===s||me.addWrite({type:"set",ref:t,data:{couponValue:s,updatedAt:(0,r.O5)()}}),Ie&&null!==p&&void 0!==p&&p())try{const s=(0,r.H9)(i.db,"goals",Ie);await(0,r.BN)(s,{targetAmount:e,classCode:c.classCode,updatedAt:(0,r.O5)()},{merge:!0})}catch(a){o.vF.warn("\ubaa9\ud45c \uc124\uc815 \uad8c\ud55c\uc774 \uc5c6\uc5b4 \ubaa9\ud45c \uae08\uc561 \uc124\uc815\uc744 \uac74\ub108\ub700:",a.code)}we(s),Ie&&null!==p&&void 0!==p&&p()&&Ne(e),S(!1),alert("\uad00\ub9ac\uc790 \uc124\uc815\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),ce("mainSettings"),Ie&&ce("goal_".concat(Ie))}catch(t){o.vF.error("\uad00\ub9ac\uc790 \uc124\uc815 \uc800\uc7a5 \uc624\ub958:",t),alert("\uad00\ub9ac\uc790 \uc124\uc815 \uc800\uc7a5 \uc911 \uc624\ub958: "+t.message)}finally{k(!1)}}},[Se,Ae,Ie,c,p]),as=(0,n.useCallback)(async()=>{if(!i.db||null===p||void 0===p||!p())return;const e=re("classCodes");if(e)De(e.validCodes||[]);else try{const e=(0,r.H9)(i.db,"settings","classCodes"),s=await(0,r.x7)(e);if(s.exists()){const e=Array.isArray(s.data().validCodes)?s.data().validCodes:[];De(e),de("classCodes",s.data(),ie.CLASS_CODES)}else me.addWrite({type:"set",ref:e,data:{validCodes:[],createdAt:(0,r.O5)(),updatedAt:(0,r.O5)()}}),De([])}catch(s){o.vF.error("\ud559\uae09 \ucf54\ub4dc \ub85c\ub4dc \uc624\ub958:",s),De([])}},[p]);(0,n.useEffect)(()=>{null!==p&&void 0!==p&&p()&&as()},[p,as]);const ts=(0,n.useCallback)(async e=>{if(!i.db)return!1;const s=e.trim();if(!s)return alert("\ud559\uae09 \ucf54\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694."),!1;if(Te.includes(s))return alert("\uc774\ubbf8 \ub4f1\ub85d\ub41c \ud559\uae09 \ucf54\ub4dc\uc785\ub2c8\ub2e4."),!1;k(!0);try{const e=(0,r.H9)(i.db,"settings","classCodes"),t=await(0,r.x7)(e),n=t.exists()&&t.data().validCodes||[];me.addWrite({type:"update",ref:e,data:{validCodes:[...n,s],updatedAt:(0,r.O5)()}});try{const e=await(0,i.Sj)(s);e.success?alert("\ud559\uae09 \ucf54\ub4dc '".concat(s,"'\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4!\n\n\uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc644\ub8cc:\n- \uc9c1\uc5c5 ").concat(e.results.jobs.copied,"\uac1c\n- \uc0c1\uc810 \uc544\uc774\ud15c ").concat(e.results.storeItems.copied,"\uac1c")):alert("\ud559\uae09 \ucf54\ub4dc '".concat(s,"'\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\n\n\u26a0\ufe0f \uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc911 \uc624\ub958: ").concat(e.error,"\n(\ub098\uc911\uc5d0 \uc9c1\uc811 \ucd94\uac00\ud574\uc8fc\uc138\uc694)"))}catch(a){o.vF.error("\uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc624\ub958:",a),alert("\ud559\uae09 \ucf54\ub4dc '".concat(s,"'\uac00 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\n\n\u26a0\ufe0f \uae30\ubcf8 \ub370\uc774\ud130 \ubcf5\uc0ac \uc2e4\ud328\n(\ub098\uc911\uc5d0 \uc9c1\uc811 \ucd94\uac00\ud574\uc8fc\uc138\uc694)"))}return De(e=>[...e,s]),ce("classCodes"),!0}catch(t){return o.vF.error("\ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uc624\ub958:",t),alert("\ud559\uae09 \ucf54\ub4dc \ucd94\uac00 \uc911 \uc624\ub958 \ubc1c\uc0dd"),!1}finally{k(!1)}},[Te]),ns=(0,n.useCallback)(async e=>{if(!i.db)return!1;if(!window.confirm("'".concat(e,"' \ucf54\ub4dc\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")))return!1;k(!0);try{const s=(0,r.H9)(i.db,"settings","classCodes"),a=await(0,r.x7)(s);if(!a.exists())throw new Error("\ud559\uae09 \ucf54\ub4dc \ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const t=(a.data().validCodes||[]).filter(s=>s!==e);return me.addWrite({type:"update",ref:s,data:{validCodes:t,updatedAt:(0,r.O5)()}}),alert("\ud559\uae09 \ucf54\ub4dc\uac00 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),De(s=>s.filter(s=>s!==e)),ce("classCodes"),!0}catch(s){return o.vF.error("\ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uc624\ub958:",s),alert("\ud559\uae09 \ucf54\ub4dc \uc0ad\uc81c \uc911 \uc624\ub958 \ubc1c\uc0dd: "+s.message),!1}finally{k(!1)}},[]),ls=(0,n.useCallback)(()=>{oe(),j.current.removeAllListeners(),null!==c&&void 0!==c&&c.classCode&&_e(c.classCode),Pe(!0)},[Pe,null===c||void 0===c?void 0:c.classCode,_e]),is=(0,n.useCallback)(async()=>{if(o.vF.log("[Dashboard] \uc218\ub3d9 \ud560\uc77c \ub9ac\uc14b \uc2dc\uc791"),null===c||void 0===c||!c.classCode)return o.vF.error("[Dashboard] \ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc5b4 \ub9ac\uc14b\uc744 \uc911\ub2e8\ud569\ub2c8\ub2e4."),void alert("\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");if(window.confirm("'".concat(c.classCode,"' \ud074\ub798\uc2a4\uc758 \ubaa8\ub4e0 \ud559\uc0dd\ub4e4\uc758 '\uc624\ub298\uc758 \ud560\uc77c' \uc644\ub8cc \uae30\ub85d\uc744 \ucd08\uae30\ud654\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\n\uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."))){o.vF.log("[Dashboard] ".concat(c.classCode," \ud074\ub798\uc2a4 \ub9ac\uc14b \uc2e4\ud589...")),k(!0);try{const e=ve,s=await e({classCode:c.classCode});if(o.vF.log("[Dashboard] \ud074\ub77c\uc6b0\ub4dc \ud568\uc218 \uacb0\uacfc \uc218\uc2e0:",s.data),!s.data.success)throw new Error(s.data.message||"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958");{u(e=>(0,t.A)((0,t.A)({},e),{},{completedTasks:{},completedJobTasks:{}}));const e=(new Date).toDateString();localStorage.setItem("lastTaskResetDate",e),alert("\ub9ac\uc14b \uc131\uacf5!\n".concat(s.data.message)),o.vF.log("[Dashboard] \ub9ac\uc14b \uc131\uacf5: ".concat(s.data.message))}}catch(e){o.vF.error("[Dashboard] \ud560\uc77c \ub9ac\uc14b \uc2e4\ud328:",e),alert("\uc624\ub958: \ud560\uc77c \ub9ac\uc14b\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.\n\n".concat(e.message))}finally{k(!1),o.vF.log("[Dashboard] \uc218\ub3d9 \ud560\uc77c \ub9ac\uc14b \uc885\ub8cc")}}else o.vF.log("[Dashboard] \uc0ac\uc6a9\uc790\uac00 \ub9ac\uc14b\uc744 \ucde8\uc18c\ud588\uc2b5\ub2c8\ub2e4.")},[null===c||void 0===c?void 0:c.classCode,u]);if(h||N)return(0,m.jsx)(U.LN,{className:"flex items-center justify-center",children:(0,m.jsx)(U.Gu,{message:"\uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})});if(!a)return(0,m.jsx)(U.LN,{className:"flex items-center justify-center",children:(0,m.jsx)(U.pp,{icon:ee.A,title:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4",description:"\ud560\uc77c\uc744 \ud655\uc778\ud558\ub824\uba74 \uba3c\uc800 \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})});if(null===c||void 0===c||!c.id)return(0,m.jsx)(U.LN,{className:"flex items-center justify-center",children:(0,m.jsx)(U.pp,{icon:ee.A,title:"\uc0ac\uc6a9\uc790 \uc815\ubcf4 \ub85c\ub4dc \uc2e4\ud328",description:"\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \uc644\uc804\ud788 \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4. \uc0c8\ub85c\uace0\uce68\ud558\uac70\ub098 \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})});if(!c.classCode)return(0,m.jsx)(U.LN,{className:"flex items-center justify-center",children:(0,m.jsx)(U.pp,{icon:ee.A,title:"\ud559\uae09 \ucf54\ub4dc \uc5c6\uc74c",description:"\ud559\uae09 \ucf54\ub4dc \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc5ec \ud559\uae09 \ucf54\ub4dc\ub97c \ud560\ub2f9\ubc1b\uc73c\uc138\uc694."})});const rs=(null===c||void 0===c?void 0:c.name)||(null===c||void 0===c?void 0:c.nickname)||(null===a||void 0===a?void 0:a.displayName)||"\uc0ac\uc6a9\uc790";return(0,m.jsxs)("div",{className:"min-h-full w-full bg-[#0a0a12] px-2 pt-1 pb-0",children:[!s&&(0,m.jsxs)("section",{className:"bg-[#14142380] backdrop-blur-sm rounded-lg px-3 py-1.5 shadow-lg border border-cyan-900/30 flex flex-col md:flex-row md:items-center justify-between gap-1.5 mb-2",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("div",{className:"w-7 h-7 bg-cyan-900/30 rounded-md flex items-center justify-center text-cyan-400 shrink-0 border border-cyan-500/30",children:(0,m.jsx)(ee.A,{className:"w-4 h-4"})}),(0,m.jsxs)("div",{className:"leading-tight",children:[(0,m.jsx)("h2",{className:"text-sm md:text-base font-bold text-white",children:"\uc624\ub298\uc758 \ud560\uc77c"}),(0,m.jsxs)("p",{className:"text-[11px] text-slate-400",children:[rs,"\ub2d8, \uc624\ub298\ub3c4 \ud654\uc774\ud305!"]})]})]}),(null===p||void 0===p?void 0:p())&&"list"===w&&!C&&(0,m.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[(0,m.jsx)(U.rA,{variant:"primary",icon:se.A,onClick:()=>es("generalSettings"),size:"sm",className:"!bg-gradient-to-r !from-red-500 !to-orange-500 !text-white !font-bold !shadow-lg !shadow-red-500/30 !border-2 !border-red-400 !text-sm",children:"\u2699\ufe0f \uad00\ub9ac\uc790 \uae30\ub2a5"}),(0,m.jsx)(U.rA,{variant:"success",icon:ae.A,onClick:ls,size:"sm",children:"\uc0c8\ub85c\uace0\uce68"}),(0,m.jsx)(U.rA,{variant:"danger",icon:te.A,onClick:is,size:"sm",title:"\uc774 \ud074\ub798\uc2a4\uc758 \ubaa8\ub4e0 \uc0ac\uc6a9\uc790 \ud560\uc77c\uc744 \ub9ac\uc14b\ud569\ub2c8\ub2e4",children:"\ud560\uc77c \ub9ac\uc14b"})]}),"selectJob"===w&&(0,m.jsx)(U.rA,{variant:"ghost",icon:ne.A,onClick:Ze,children:"\ub4a4\ub85c\uac00\uae30"})]}),"list"===w&&!C&&!s&&(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"bg-[#14142380] backdrop-blur-sm rounded-2xl shadow-lg border border-cyan-900/30 overflow-hidden mb-6",children:[(0,m.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-4 md:px-6 py-3 md:py-4 flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)($.A,{className:"w-5 h-5 text-white"}),(0,m.jsx)("h3",{className:"text-base md:text-lg font-bold text-white",children:"\ub098\uc758 \uc9c1\uc5c5 \ud560\uc77c"})]}),(0,m.jsx)(U.rA,{variant:"outline",icon:le.A,onClick:Ye,size:"sm",className:"!bg-white/20 !text-white !border-white/30 hover:!bg-white/30",children:"\uc9c1\uc5c5 \ucd94\uac00/\uc120\ud0dd"})]}),(0,m.jsxs)("div",{className:"p-4 md:p-6",children:[(0,m.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Je.length>0?Je.map(e=>(0,m.jsx)(I,{job:e,isAdmin:null===p||void 0===p?void 0:p(),onEditJob:()=>Ke(e),onDeleteJob:()=>Ge(e.id),onAddTask:()=>qe(e.id,!0),onEarnCoupon:(e,s,a,t,n)=>$e(e,s,a,t,n),onEditTask:s=>Ve(s,e.id),onDeleteTask:s=>Xe(s,e.id),isHandlingTask:je},e.id)):(0,m.jsx)("div",{className:"col-span-full",children:(0,m.jsx)(U.pp,{icon:$.A,title:"\ud45c\uc2dc\ud560 \uc9c1\uc5c5\uc774 \uc5c6\uc2b5\ub2c8\ub2e4",description:"'\uc9c1\uc5c5 \ucd94\uac00/\uc120\ud0dd' \ubc84\ud2bc\uc744 \ub20c\ub7ec \uc9c1\uc5c5\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.",action:(0,m.jsx)(U.rA,{variant:"primary",icon:le.A,onClick:Ye,children:"\uc9c1\uc5c5 \uc120\ud0dd\ud558\uae30"})})})}),(0,m.jsxs)("div",{className:"mt-6 rounded-xl overflow-hidden border border-emerald-900/30 bg-[#14142380] backdrop-blur-sm",children:[(0,m.jsxs)("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 px-4 md:px-6 py-3 md:py-4 flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)(ee.A,{className:"w-5 h-5 text-white"}),(0,m.jsx)("h3",{className:"text-base md:text-lg font-bold text-white",children:"\uacf5\ud1b5 \ud560\uc77c"})]}),(null===p||void 0===p?void 0:p())&&(0,m.jsx)(U.rA,{variant:"outline",icon:le.A,onClick:()=>qe(null,!1),size:"sm",className:"!bg-white/20 !text-white !border-white/30 hover:!bg-white/30",children:"\uacf5\ud1b5 \ud560\uc77c \ucd94\uac00"})]}),(0,m.jsx)("div",{className:"p-4 md:p-6 bg-[#0a0a12]/50",children:(0,m.jsx)(M,{tasks:Ee,isAdmin:null===p||void 0===p?void 0:p(),onEarnCoupon:(e,s,a,t,n)=>$e(e,s,a,t,n),onEditTask:e=>Ve(E.find(s=>s.id===e),null),onDeleteTask:e=>Xe(e,null),isHandlingTask:je})})]})]})]})}),"selectJob"===w&&(0,m.jsx)(he,{availableJobs:D,currentSelectedJobIds:Me,onConfirmSelection:Ue,onCancel:Ze}),(null===p||void 0===p?void 0:p())&&(0,m.jsx)(Y,{isAdmin:null===p||void 0===p?void 0:p(),isSuperAdmin:null===b||void 0===b?void 0:b(),userClassCode:null===c||void 0===c?void 0:c.classCode,showAdminSettingsModal:C,setShowAdminSettingsModal:S,adminSelectedMenu:F,setAdminSelectedMenu:T,classCodes:Te,onAddClassCode:ts,onRemoveClassCode:ns,newGoalAmount:Se,setNewGoalAmount:Fe,adminCouponValue:Ae,setAdminCouponValue:Ce,handleSaveAdminSettings:ss,jobs:D,adminNewJobTitle:P,setAdminNewJobTitle:L,adminEditingJob:_,setAdminEditingJob:O,handleSaveJob:Be,handleDeleteJob:Ge,handleEditJob:Ke,commonTasks:E,showAddTaskForm:q,setShowAddTaskForm:V,adminNewTaskName:Q,setAdminNewTaskName:X,adminNewTaskReward:Z,setAdminNewTaskReward:xe,adminNewTaskMaxClicks:ge,setAdminNewTaskMaxClicks:pe,adminEditingTask:W,setAdminEditingTask:z,handleSaveTask:Qe,handleEditTask:Ve,handleDeleteTask:Xe,taskFormJobId:H,taskFormIsJobTask:G,handleAddTaskClick:qe})]})}}}]);
//# sourceMappingURL=433.2194cfd3.chunk.js.map