"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[771],{1771:(e,s,t)=>{t.r(s),t.d(s,{default:()=>b});var n=t(4919),i=t(5043),r=t(5016),a=t(791),o=t(5472),l=t(577),c=t(9270),d=t(8180),u=t(579);const m={0:[1,3,4],1:[0,3,4],3:[0,1,4],4:[0,1,3]},f=[{id:0,x:150,y:20,isHome:"B"},{id:1,x:50,y:80},{id:2,x:150,y:80},{id:3,x:250,y:80},{id:4,x:50,y:160},{id:5,x:150,y:160},{id:6,x:250,y:160},{id:7,x:50,y:240},{id:8,x:150,y:240},{id:9,x:250,y:240},{id:10,x:150,y:300,isHome:"R"}],h={0:[2],1:[2,4,5],2:[0,1,3,4,5,6],3:[2,5,6],4:[1,2,5,7,8],5:[1,2,3,4,6,7,8,9],6:[2,3,5,8,9],7:[4,5,8],8:[4,5,6,7,9,10],9:[5,6,8],10:[8]},p=[];for(let j=0;j<4;j++)for(let e=0;e<4;e++)p.push({id:4*j+e,x:60+80*e,y:60+80*j,row:j,col:e});const v=[];for(let j=0;j<4;j++)for(let e=0;e<3;e++)v.push([4*j+e,4*j+e+1]);for(let j=0;j<3;j++)for(let e=0;e<4;e++)v.push([4*j+e,4*(j+1)+e]);for(let j=0;j<3;j++)for(let e=0;e<3;e++)v.push([4*j+e,4*(j+1)+e+1]);for(let j=0;j<3;j++)for(let e=1;e<4;e++)v.push([4*j+e,4*(j+1)+e-1]);const y={};for(let j=0;j<16;j++)y[j]=[];v.forEach(e=>{let[s,t]=e;y[s].push(t),y[t].push(s)});const g={umul:{name:"\uc6b0\ubb3c\uace0\ub204",description:"\uac00\uc7a5 \uae30\ubcf8\uc801\uc778 \uace0\ub204. \uac01\uc790 2\uac1c\uc758 \ub9d0\ub85c \uc0c1\ub300\ub97c \ubd09\uc1c4\ud558\uba74 \uc2b9\ub9ac!",rules:["\uac01\uc790 2\uac1c\uc758 \ub9d0\uc744 \uac00\uc9c0\uace0 \uc2dc\uc791\ud569\ub2c8\ub2e4","\ub9d0\uc740 \uc120\uc744 \ub530\ub77c \ud55c \uce78\uc529\ub9cc \uc774\ub3d9\ud569\ub2c8\ub2e4","\uc911\uc559(\uc6b0\ubb3c)\uc73c\ub85c\ub294 \uc774\ub3d9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4","\uc0c1\ub300\uc758 \ub9d0\uc774 \ub354 \uc774\uc0c1 \uc6c0\uc9c1\uc77c \uc218 \uc5c6\uac8c \ub9cc\ub4e4\uba74 \uc2b9\ub9ac!"],nodes:[{id:0,x:150,y:40},{id:1,x:40,y:150},{id:2,x:150,y:150},{id:3,x:260,y:150},{id:4,x:150,y:260}],edges:[[0,1],[0,3],[1,4],[3,4],[0,4],[1,3]],adjacency:m,initialPieces:()=>({0:"B",1:"B",3:"R",4:"R"}),piecesPerPlayer:2,boardWidth:300,boardHeight:300,checkWin:(e,s)=>{const t="B"===s?"R":"B",n=Object.entries(e).filter(e=>{let[,s]=e;return s===t}).map(e=>{let[s]=e;return parseInt(s)});for(const i of n){const s=m[i]||[];for(const t of s)if(!e[t])return null}return s},isWell:e=>2===e},hobak:{name:"\ud638\ubc15\uace0\ub204",description:"\ucd9c\ubc1c\uc120\uc774 \uc788\ub294 \uace0\ub204. \uac01\uc790 3\uac1c\uc758 \ub9d0\ub85c \uc0c1\ub300\ub97c \ubd09\uc1c4\ud558\uba74 \uc2b9\ub9ac!",rules:["\uac01\uc790 3\uac1c\uc758 \ub9d0\uc744 \uac00\uc9c0\uace0 \uc2dc\uc791\ud569\ub2c8\ub2e4","\ub9d0\uc740 \uc120\uc744 \ub530\ub77c \ud55c \uce78\uc529\ub9cc \uc774\ub3d9\ud569\ub2c8\ub2e4","\ucd9c\ubc1c\uc120\uc5d0\uc11c \ub098\uc628 \ub9d0\uc740 \ucd9c\ubc1c\uc120\uc73c\ub85c \ub3cc\uc544\uac08 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4","\uc0c1\ub300 \ucd9c\ubc1c\uc120\uc73c\ub85c\ub3c4 \ub4e4\uc5b4\uac08 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4","\uc0c1\ub300\uc758 \ub9d0\uc774 \ub354 \uc774\uc0c1 \uc6c0\uc9c1\uc77c \uc218 \uc5c6\uac8c \ub9cc\ub4e4\uba74 \uc2b9\ub9ac!"],nodes:f,edges:[[0,2],[1,2],[2,3],[1,4],[2,5],[3,6],[4,5],[5,6],[4,7],[5,8],[6,9],[7,8],[8,9],[8,10],[1,5],[2,4],[2,6],[3,5],[4,8],[5,7],[5,9],[6,8]],adjacency:h,initialPieces:()=>({0:"B",1:"B",3:"B",10:"R",7:"R",9:"R"}),piecesPerPlayer:3,boardWidth:300,boardHeight:320,checkWin:(e,s)=>{const t="B"===s?"R":"B",n=Object.entries(e).filter(e=>{let[,s]=e;return s===t}).map(e=>{let[s]=e;return parseInt(s)});for(const i of n){const s=h[i]||[];for(const t of s)if(!e[t]){const e=f.find(e=>e.id===t);if(null!==e&&void 0!==e&&e.isHome)continue;return null}}return s},getHomeNode:e=>"B"===e?0:10},bat:{name:"\ubc2d\uace0\ub204 (\ub124\uc904\uace0\ub204)",description:"4x4 \uaca9\uc790\uc5d0\uc11c \uc790\uae30 \ub9d0 3\uac1c\ub97c \uc77c\ub82c\ub85c \ub9cc\ub4e4\uba74 \uc0c1\ub300 \ub9d0\uc744 \uc81c\uac70!",rules:["\uac01\uc790 4\uac1c\uc758 \ub9d0\uc744 \uac00\uc9c0\uace0 \uc2dc\uc791\ud569\ub2c8\ub2e4","\ub9d0\uc740 \uc120\uc744 \ub530\ub77c \ud55c \uce78\uc529\ub9cc \uc774\ub3d9\ud569\ub2c8\ub2e4","\uc790\uae30 \ub9d0 3\uac1c\uac00 \uac00\ub85c/\uc138\ub85c/\ub300\uac01\uc120 \uc77c\ub82c\uc774 \ub418\uba74 \uc0c1\ub300 \ub9d0 1\uac1c \uc81c\uac70","\uc0c1\ub300 \ub9d0\uc744 1\uac1c\ub9cc \ub0a8\uae30\uba74 \uc2b9\ub9ac!"],nodes:p,edges:v,adjacency:y,initialPieces:()=>({0:"B",1:"B",2:"B",3:"B",12:"R",13:"R",14:"R",15:"R"}),piecesPerPlayer:4,boardWidth:320,boardHeight:320,checkWin:e=>{const s=Object.values(e).filter(e=>"B"===e).length,t=Object.values(e).filter(e=>"R"===e).length;return s<=1?"R":t<=1?"B":null},checkThreeInRow:(e,s,t)=>{const n=p.find(e=>e.id===s);if(!n)return!1;const{row:i,col:r}=n;for(let a=Math.max(0,r-2);a<=Math.min(1,r);a++){let s=0;for(let n=a;n<a+3&&n<4;n++){e[4*i+n]===t&&s++}if(3===s)return!0}for(let a=Math.max(0,i-2);a<=Math.min(1,i);a++){let s=0;for(let n=a;n<a+3&&n<4;n++){e[4*n+r]===t&&s++}if(3===s)return!0}for(let a=-2;a<=0;a++){let s=0;for(let n=0;n<3;n++){const o=i+a+n,l=r+a+n;if(o>=0&&o<4&&l>=0&&l<4){e[4*o+l]===t&&s++}}if(3===s)return!0}for(let a=-2;a<=0;a++){let s=0;for(let n=0;n<3;n++){const o=i+a+n,l=r-a-n;if(o>=0&&o<4&&l>=0&&l<4){e[4*o+l]===t&&s++}}if(3===s)return!0}return!1}}},x=e=>{const s={};for(const t in e)s[parseInt(t)]=e[t];return s},b=()=>{var e,s,t,m;const{user:h,userDoc:v}=(0,r.As)(),[y,b]=(0,i.useState)(null),[j,B]=(0,i.useState)(null),[N,w]=(0,i.useState)(!0),[k,R]=(0,i.useState)(""),[A,W]=(0,i.useState)({message:"",type:""}),[T,E]=(0,i.useState)(null),[H,I]=(0,i.useState)("umul"),[C,S]=(0,i.useState)([]),[M,G]=(0,i.useState)(!1),[P,O]=(0,i.useState)(!1),[L,_]=(0,i.useState)("pvp"),[z,F]=(0,i.useState)(!1),[V,D]=(0,i.useState)([]),[J,q]=(0,i.useState)(null),[K,Q]=(0,i.useState)(null),U=j&&h&&j.turn===(j.players.B===h.uid?"B":"R"),X=j&&h&&(j.players.B===h.uid?"B":"R"),Y=(0,i.useRef)(y);(0,i.useEffect)(()=>{Y.current=y},[y]);const Z=(0,i.useRef)(j);(0,i.useEffect)(()=>{Z.current=j},[j]);const $=(0,i.useRef)(h);(0,i.useEffect)(()=>{$.current=h},[h]),(0,i.useEffect)(()=>{const e=()=>{const e=Y.current,s=Z.current,t=$.current;e&&s&&t&&"waiting"===s.status&&s.players.B===t.uid&&(0,o.kd)((0,o.H9)(a.db,"gonuGames",e))};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]),(0,i.useEffect)(()=>{if(!T)return void D([]);const e=(null===K||void 0===K?void 0:K.pieces)||(j?x(j.pieces):{}),s=(null===K||void 0===K?void 0:K.gameType)||(null===j||void 0===j?void 0:j.gameType)||"umul",t=g[s],n=t.adjacency,i=K?"B":X;if(e[T]!==i)return void D([]);const r=[],a=n[T]||[];for(const o of a)if(!e[o]&&("umul"!==s||!t.isWell||!t.isWell(o))){if("hobak"===s){const e=f.find(e=>e.id===o);if(null!==e&&void 0!==e&&e.isHome)continue}r.push(o)}D(r)},[T,K,j,X]);const ee=(0,i.useCallback)(async()=>{if(h){O(!0);try{const e=(0,o.P)((0,o.rJ)(a.db,"gonuGames"),(0,o._M)("status","==","waiting")),s=await(0,o.GG)(e),t=[];s.forEach(e=>{const s=e.data();s.players.B!==h.uid&&t.push((0,n.A)({id:e.id},s))}),S(t)}catch(e){console.error("Error fetching rooms:",e)}finally{O(!1)}}},[h]);(0,i.useEffect)(()=>{if(N&&h&&"pvp"===L){ee();const e=setInterval(ee,6e4);return()=>clearInterval(e)}},[N,h,ee,L]);const se=(0,i.useCallback)(async()=>{if(!y)return;const e=(0,o.H9)(a.db,"gonuGames",y);try{const s=await(0,o.x7)(e);if(s.exists()){const t=s.data();B(t),w(!1),"finished"===t.status&&setTimeout(async()=>{try{await(0,o.kd)(e)}catch(s){console.error("Error deleting finished game:",s)}},1e4)}else W({message:"\uac8c\uc784\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",type:"error"}),b(null),B(null),w(!0)}catch(s){console.error("Error fetching game data:",s)}},[y]);(0,l.nm)(se,{interval:3e3,enabled:!!y}),(0,i.useEffect)(()=>{if(A.message){const e=setTimeout(()=>W({message:"",type:""}),3e3);return()=>clearTimeout(e)}},[A.message]),(0,i.useEffect)(()=>{if(!K||"active"!==K.status||"R"!==K.turn||z||J)return;F(!0);const e=setTimeout(()=>{const e=((e,s,t)=>{const i=g[e],r=i.adjacency,a="B"===t?"R":"B",o=Object.entries(s).filter(e=>{let[,s]=e;return s===t}).map(e=>{let[s]=e;return parseInt(s)}),l=[];for(const n of o){const t=r[n]||[];for(const r of t)if(!s[r]){if("hobak"===e){const e=f.find(e=>e.id===r);if(null!==e&&void 0!==e&&e.isHome)continue}"umul"===e&&i.isWell&&i.isWell(r)||l.push({from:n,to:r})}}if(0===l.length)return null;const c=l.map(o=>{let l=0;const c=(0,n.A)({},s);delete c[o.from],c[o.to]=t,i.checkWin(c,t)===t&&(l+=1e3);const d=Object.entries(c).filter(e=>{let[,s]=e;return s===a}).map(e=>{let[s]=e;return parseInt(s)});let u=0;for(const s of d){const t=r[s]||[];for(const s of t)if(!c[s])if("hobak"===e){const e=f.find(e=>e.id===s);null!==e&&void 0!==e&&e.isHome||u++}else"umul"===e&&i.isWell&&i.isWell(s)||u++}if(l-=5*u,"bat"===e){const e=p.find(e=>e.id===o.to);e&&(l-=2*(Math.abs(e.row-1.5)+Math.abs(e.col-1.5))),i.checkThreeInRow(c,o.to,t)&&(l+=100)}return l+=3*Math.random(),(0,n.A)((0,n.A)({},o),{},{score:l})});return c.sort((e,s)=>s.score-e.score),c[0]})(K.gameType,K.pieces,"R");if(e){const s=(0,n.A)({},K.pieces);delete s[e.from],s[e.to]="R";const t=g[K.gameType];if("bat"===K.gameType&&t.checkThreeInRow(s,e.to,"R")){const e=Object.entries(s).filter(e=>{let[,s]=e;return"B"===s}).map(e=>{let[s]=e;return parseInt(s)});if(e.length>0){const t=Math.floor(Math.random()*e.length);delete s[e[t]]}}const i=t.checkWin(s,"R");Q(e=>(0,n.A)((0,n.A)({},e),{},{pieces:s,turn:"B",status:i?"finished":"active",winner:i}))}F(!1)},800);return()=>clearTimeout(e)},[K,z,J]);const te=()=>{const e=g[H];Q({gameType:H,pieces:e.initialPieces(),turn:"B",status:"active",winner:null}),w(!1)},ne=async()=>{if(!h)return void W({message:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.",type:"error"});O(!0);const e=Math.random().toString(36).substring(2,8),s=(0,o.H9)(a.db,"gonuGames",e),t=g[H],n={pieces:t.initialPieces(),players:{B:h.uid,R:null},playerNames:{B:v.name,R:null},turn:"B",status:"waiting",winner:null,gameType:H,gameName:t.name,createdAt:(0,o.O5)()};try{await(0,o.BN)(s,n),b(e),W({message:"".concat(t.name," \ubc29 \uc0dd\uc131 \uc644\ub8cc! \ucf54\ub4dc: ").concat(e),type:"success"}),await se()}catch(i){console.error("Error creating room:",i),W({message:"\ubc29 \uc0dd\uc131\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",type:"error"})}finally{O(!1)}},ie=async e=>{const s=e||k.trim();if(!s)return void W({message:"\ucc38\uac00\ud560 \ubc29 \ucf54\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694.",type:"error"});if(!h)return void W({message:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.",type:"error"});O(!0);const t=(0,o.H9)(a.db,"gonuGames",s);try{await(0,o.c4)(a.db,async e=>{const s=await e.get(t);if(!s.exists())throw new Error("\ubc29\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const n=s.data();if(n.players.R)throw new Error("\ubc29\uc774 \uac00\ub4dd \ucc3c\uc2b5\ub2c8\ub2e4.");if(n.players.B===h.uid)throw new Error("\uc790\uc2e0\uc774 \ub9cc\ub4e0 \ubc29\uc5d0\ub294 \ucc38\uac00\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");e.update(t,{"players.R":h.uid,"playerNames.R":v.name,status:"active"})}),b(s),await se()}catch(n){console.error("Error joining room: ",n),W({message:"\ucc38\uac00 \uc2e4\ud328: ".concat(n.message),type:"error"})}finally{O(!1)}},re=e=>{if(!J)return;const s=(null===K||void 0===K?void 0:K.pieces)||x(j.pieces),t="B"===J.capturer?"R":"B";if(s[e]!==t)return void W({message:"\uc0c1\ub300\ubc29\uc758 \ub9d0\uc744 \uc120\ud0dd\ud558\uc138\uc694.",type:"error"});const i=(0,n.A)({},s);delete i[e];const r=g[(null===K||void 0===K?void 0:K.gameType)||j.gameType].checkWin(i,J.capturer);K&&Q(e=>(0,n.A)((0,n.A)({},e),{},{pieces:i,turn:"B"===J.capturer?"R":"B",status:r?"finished":"active",winner:r})),q(null)},ae=(0,i.useCallback)(async e=>{if(J)return void re(e);if(null===T)return;if(K){if("active"!==K.status||"B"!==K.turn)return;const s=K.pieces;if("B"!==s[T])return;if(!V.includes(e))return void W({message:"\uc774\ub3d9\ud560 \uc218 \uc5c6\ub294 \uc704\uce58\uc785\ub2c8\ub2e4.",type:"error"});const t=(0,n.A)({},s);delete t[T],t[e]="B";const i=g[K.gameType];if("bat"===K.gameType&&i.checkThreeInRow(t,e,"B"))return Q(e=>(0,n.A)((0,n.A)({},e),{},{pieces:t})),q({capturer:"B"}),E(null),void W({message:"3\uc5f0\uc18d! \uc81c\uac70\ud560 \uc0c1\ub300 \ub9d0\uc744 \uc120\ud0dd\ud558\uc138\uc694.",type:"success"});const r=i.checkWin(t,"B");return Q(e=>(0,n.A)((0,n.A)({},e),{},{pieces:t,turn:"R",status:r?"finished":"active",winner:r})),E(null),void("B"===r&&W({message:"\ud83c\udf89 \uc2b9\ub9ac\ud588\uc2b5\ub2c8\ub2e4!",type:"success"}))}if(!U||!j)return;if(x(j.pieces)[T]!==X)return;if(!V.includes(e))return void W({message:"\uc774\ub3d9\ud560 \uc218 \uc5c6\ub294 \uc704\uce58\uc785\ub2c8\ub2e4.",type:"error"});const s=(0,o.H9)(a.db,"gonuGames",y);try{await(0,o.c4)(a.db,async t=>{const i=await t.get(s);if(!i.exists())throw new Error("\uac8c\uc784\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");const r=i.data();if(r.turn!==X)throw new Error("\uc0c1\ub300\ubc29\uc758 \ud134\uc785\ub2c8\ub2e4.");const l=(0,n.A)({},x(r.pieces));delete l[T],l[e]=X;const d=g[j.gameType].checkWin(l,X),u="B"===X?"R":"B";if(t.update(s,{pieces:l,turn:u,status:d?"finished":"active",winner:d}),d){const e=(0,o.H9)(a.db,"users",h.uid);t.update(e,{coupons:(0,o.GV)(1)}),(0,c.Mx)(a.db,{classCode:null===v||void 0===v?void 0:v.classCode,userId:h.uid,userName:(null===v||void 0===v?void 0:v.name)||"\uc0ac\uc6a9\uc790",type:c.gI.GAME_WIN,description:"".concat(j.gameName||"\uace0\ub204"," \uc2b9\ub9ac - \ucfe0\ud3f0 1\uac1c \ud68d\ub4dd"),couponAmount:1,metadata:{gameType:"gonu",gameVariant:j.gameType,gameName:j.gameName}})}}),E(null)}catch(t){console.error("Move error:",t),W({message:"\uc774\ub3d9 \uc2e4\ud328: ".concat(t.message),type:"error"})}},[y,j,U,X,T,null===h||void 0===h?void 0:h.uid,K,V,J]);if(N)return(0,u.jsx)("div",{className:"gonu-container",children:(0,u.jsxs)("div",{className:"room-creation",children:[(0,u.jsx)("h2",{children:"\ud83c\udfaf \uace0\ub204 \uac8c\uc784"}),(0,u.jsx)("p",{children:"\ud55c\uad6d \uc804\ud1b5 \ubcf4\ub4dc\uac8c\uc784\uc744 \uc990\uaca8\ubcf4\uc138\uc694!"}),A.message&&(0,u.jsx)("div",{className:"feedback ".concat(A.type),children:A.message}),(0,u.jsxs)("div",{className:"game-mode-selector",children:[(0,u.jsx)("h3",{children:"\ud83c\udfae \uac8c\uc784 \ubaa8\ub4dc"}),(0,u.jsxs)("div",{className:"mode-buttons",children:[(0,u.jsx)("button",{className:"mode-btn ".concat("ai"===L?"selected":""),onClick:()=>_("ai"),children:"\ud83e\udd16 AI \ub300\uc804"}),(0,u.jsx)("button",{className:"mode-btn ".concat("pvp"===L?"selected":""),onClick:()=>_("pvp"),children:"\ud83d\udc65 \uce5c\uad6c \ub300\uc804"})]})]}),(0,u.jsxs)("div",{className:"game-type-selector",children:[(0,u.jsx)("h3",{children:"\uac8c\uc784 \uc885\ub958 \uc120\ud0dd"}),(0,u.jsx)("div",{className:"game-types",children:Object.entries(g).map(e=>{let[s,t]=e;return(0,u.jsxs)("label",{className:"game-type-option ".concat(H===s?"selected":""),children:[(0,u.jsx)("input",{type:"radio",value:s,checked:H===s,onChange:e=>I(e.target.value)}),(0,u.jsxs)("div",{className:"game-type-info",children:[(0,u.jsx)("strong",{children:t.name}),(0,u.jsx)("small",{children:t.description})]})]},s)})}),(0,u.jsx)("button",{onClick:()=>G(!M),className:"rules-toggle-btn",children:M?"\uaddc\uce59 \uc228\uae30\uae30":"\uaddc\uce59 \ubcf4\uae30"}),M&&(0,u.jsxs)("div",{className:"rules-display",children:[(0,u.jsxs)("h4",{children:[g[H].name," \uaddc\uce59"]}),(0,u.jsx)("ul",{children:g[H].rules.map((e,s)=>(0,u.jsx)("li",{children:e},s))})]})]}),(0,u.jsx)("div",{className:"room-actions",children:"ai"===L?(0,u.jsx)("button",{onClick:te,className:"create-room-btn",disabled:P,children:"\ud83e\udd16 AI\uc640 \ub300\uc804 \uc2dc\uc791"}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{onClick:ne,className:"create-room-btn",disabled:P,children:P?(0,u.jsx)("span",{className:"loading"}):"\uc0c8\ub85c\uc6b4 \ubc29 \ub9cc\ub4e4\uae30"}),(0,u.jsxs)("div",{className:"join-room",children:[(0,u.jsx)("input",{type:"text",value:k,onChange:e=>R(e.target.value),placeholder:"\ubc29 \ucf54\ub4dc \uc785\ub825",maxLength:"6"}),(0,u.jsx)("button",{onClick:()=>ie(),disabled:P,children:P?(0,u.jsx)("span",{className:"loading"}):"\ucf54\ub4dc\ub85c \ucc38\uac00"})]})]})}),"pvp"===L&&C.length>0&&(0,u.jsxs)("div",{className:"available-rooms",children:[(0,u.jsx)("h3",{children:"\ud83d\udccb \ub300\uae30 \uc911\uc778 \ubc29 \ubaa9\ub85d"}),(0,u.jsx)("div",{className:"rooms-list",children:C.map(e=>(0,u.jsxs)("div",{className:"room-item",children:[(0,u.jsxs)("div",{className:"room-info",children:[(0,u.jsx)("span",{className:"room-type",children:e.gameName}),(0,u.jsxs)("span",{className:"room-host",children:["\ud638\uc2a4\ud2b8: ",e.playerNames.B]}),(0,u.jsxs)("span",{className:"room-code",children:["\ucf54\ub4dc: ",e.id]})]}),(0,u.jsxs)("div",{className:"room-item-buttons",children:[(0,u.jsx)("button",{onClick:()=>ie(e.id),className:"join-btn",disabled:P,children:"\ucc38\uac00"}),(null===v||void 0===v?void 0:v.isAdmin)&&(0,u.jsx)("button",{onClick:()=>(async e=>{if(null!==v&&void 0!==v&&v.isAdmin)try{await(0,o.kd)((0,o.H9)(a.db,"gonuGames",e)),W({message:"\ubc29 ".concat(e,"\uac00 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),type:"success"}),ee()}catch(s){console.error("Error deleting room by admin:",s),W({message:"\ubc29 \uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",type:"error"})}else W({message:"\uc0ad\uc81c \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.",type:"error"})})(e.id),className:"delete-btn",children:"\uc0ad\uc81c"})]})]},e.id))})]})]})});if(!K&&!j)return(0,u.jsx)(d.AlchanLoading,{});const oe=(null===K||void 0===K?void 0:K.gameType)||(null===j||void 0===j?void 0:j.gameType)||"umul",le=(null===K||void 0===K?void 0:K.status)||(null===j||void 0===j?void 0:j.status),ce=(null===K||void 0===K?void 0:K.winner)||(null===j||void 0===j?void 0:j.winner),de=(null===K||void 0===K?void 0:K.turn)||(null===j||void 0===j?void 0:j.turn);return(0,u.jsxs)("div",{className:"gonu-container",children:[(0,u.jsxs)("div",{className:"game-info",children:[(0,u.jsxs)("h2",{children:[g[oe].name,K&&" (AI \ub300\uc804)",y&&" (\ubc29: ".concat(y,")")]}),!K&&(0,u.jsxs)("div",{className:"player-info",children:[(0,u.jsxs)("p",{className:"player-b ".concat("B"===de?"active-turn":""),children:["\ud83d\udd35 ",(null===j||void 0===j||null===(e=j.playerNames)||void 0===e?void 0:e.B)||"\ud50c\ub808\uc774\uc5b4 1"," ",(null===j||void 0===j||null===(s=j.players)||void 0===s?void 0:s.B)===(null===h||void 0===h?void 0:h.uid)&&"(\ub098)"]}),(0,u.jsxs)("p",{className:"player-r ".concat("R"===de?"active-turn":""),children:["\ud83d\udd34 ",(null===j||void 0===j||null===(t=j.playerNames)||void 0===t?void 0:t.R)||"\ub300\uae30\uc911..."," ",(null===j||void 0===j||null===(m=j.players)||void 0===m?void 0:m.R)===(null===h||void 0===h?void 0:h.uid)&&"(\ub098)"]})]}),K&&(0,u.jsxs)("div",{className:"player-info",children:[(0,u.jsx)("p",{className:"player-b ".concat("B"===de?"active-turn":""),children:"\ud83d\udd35 \ub098 (\ud30c\ub791)"}),(0,u.jsxs)("p",{className:"player-r ".concat("R"===de?"active-turn":""),children:["\ud83d\udd34 AI (\uc801) ",z&&"\ud83e\udd14 \uc0dd\uac01 \uc911..."]})]}),"finished"===le?(0,u.jsx)("div",{className:"game-status winner",children:K?"B"===ce?"\ud83c\udf89 \uc2b9\ub9ac\ud588\uc2b5\ub2c8\ub2e4!":"\ud83d\ude22 AI\uc5d0\uac8c \ud328\ubc30\ud588\uc2b5\ub2c8\ub2e4.":ce===X?"\ud83c\udf89 \uc2b9\ub9ac! \ucfe0\ud3f0 1\uac1c\ub97c \ud68d\ub4dd\ud588\uc2b5\ub2c8\ub2e4!":"\ud83d\ude22 \ud328\ubc30\ud588\uc2b5\ub2c8\ub2e4."}):"waiting"===le?(0,u.jsx)("div",{className:"game-status",children:"\uc0c1\ub300\ubc29\uc744 \uae30\ub2e4\ub9ac\ub294 \uc911..."}):J?(0,u.jsx)("div",{className:"game-status capture-mode",children:"\ud83c\udfaf \uc81c\uac70\ud560 \uc0c1\ub300 \ub9d0\uc744 \uc120\ud0dd\ud558\uc138\uc694!"}):(0,u.jsx)("div",{className:"game-status",children:K?"B"===de?"\ud83c\udfaf \ub2f9\uc2e0\uc758 \ud134\uc785\ub2c8\ub2e4.":"\u23f3 AI\uac00 \uc0dd\uac01 \uc911...":U?"\ud83c\udfaf \ub2f9\uc2e0\uc758 \ud134\uc785\ub2c8\ub2e4.":"\u23f3 \uc0c1\ub300\ubc29\uc758 \ud134\uc744 \uae30\ub2e4\ub9ac\ub294 \uc911..."})]}),(0,u.jsx)("div",{className:"board-area",children:(()=>{const e=(null===K||void 0===K?void 0:K.gameType)||(null===j||void 0===j?void 0:j.gameType)||"umul",s=g[e],t=(null===K||void 0===K?void 0:K.pieces)||(j?x(j.pieces):{}),n=(null===K||void 0===K?void 0:K.turn)||(null===j||void 0===j?void 0:j.turn);return(0,u.jsxs)("svg",{className:"gonu-svg-board",width:s.boardWidth,height:s.boardHeight,viewBox:"0 0 ".concat(s.boardWidth," ").concat(s.boardHeight),style:{width:"100%",maxWidth:s.boardWidth,height:"auto"},children:[(0,u.jsx)("rect",{x:"0",y:"0",width:s.boardWidth,height:s.boardHeight,fill:"#2a2a3a",rx:"10"}),s.edges.map((e,t)=>{let[n,i]=e;const r=s.nodes.find(e=>e.id===n),a=s.nodes.find(e=>e.id===i);return(0,u.jsx)("line",{x1:r.x,y1:r.y,x2:a.x,y2:a.y,stroke:"#555",strokeWidth:"3"},"edge-".concat(t))}),s.nodes.map(n=>{const i=t[n.id],r=T===n.id,a=V.includes(n.id),o="umul"===e&&s.isWell&&s.isWell(n.id),l=n.isHome,c=J&&i&&i!==J.capturer;return(0,u.jsxs)("g",{onClick:()=>(e=>{if(J)return void re(e);const s=(null===K||void 0===K?void 0:K.pieces)||(j?x(j.pieces):{}),t=(null===K||void 0===K?void 0:K.turn)||(null===j||void 0===j?void 0:j.turn),n=K?"B":X;"active"===((null===K||void 0===K?void 0:K.status)||(null===j||void 0===j?void 0:j.status))&&(K&&"B"!==t||(K||U)&&(s[e]!==n?null===T||s[e]||ae(e):E(e)))})(n.id),style:{cursor:"pointer"},children:[(0,u.jsx)("circle",{cx:n.x,cy:n.y,r:o?20:22,fill:o?"#333":a?"#4a7":l?"B"===l?"#334":"#433":"#444",stroke:r?"#0ff":a?"#4f7":c?"#f44":"#666",strokeWidth:r||a||c?3:2}),o&&(0,u.jsx)("text",{x:n.x,y:n.y+5,textAnchor:"middle",fill:"#666",fontSize:"12",fontWeight:"bold",children:"\uc6b0\ubb3c"}),l&&!i&&(0,u.jsx)("text",{x:n.x,y:n.y+5,textAnchor:"middle",fill:"B"===l?"#88f":"#f88",fontSize:"10",children:"\ucd9c\ubc1c"}),i&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("circle",{cx:n.x,cy:n.y,r:18,fill:"B"===i?"#1a5fb4":"#c00",stroke:"B"===i?"#62a0ea":"#f66",strokeWidth:"3"}),(0,u.jsx)("circle",{cx:n.x-5,cy:n.y-5,r:6,fill:"B"===i?"#62a0ea":"#f44",opacity:"0.6"})]}),a&&!i&&(0,u.jsx)("circle",{cx:n.x,cy:n.y,r:8,fill:"#4f7",opacity:"0.6"})]},"node-".concat(n.id))}),(0,u.jsx)("text",{x:s.boardWidth/2,y:s.boardHeight-8,textAnchor:"middle",fill:"#aaa",fontSize:"11",children:"B"===n?"\ud83d\udd35 \ud30c\ub791 \ucc28\ub840":"\ud83d\udd34 \ube68\uac15 \ucc28\ub840"})]})})()}),A.message&&(0,u.jsx)("div",{className:"feedback ".concat(A.type),children:A.message}),(0,u.jsx)("button",{onClick:async()=>{if(K)return Q(null),w(!0),E(null),void q(null);if(j&&"waiting"===j.status&&y&&j.players.B===h.uid)try{await(0,o.kd)((0,o.H9)(a.db,"gonuGames",y))}catch(e){console.error("Error deleting room:",e)}b(null),B(null),w(!0),E(null),q(null)},className:"leave-button",children:"finished"===le?"\ub098\uac00\uae30":"\uac8c\uc784 \ub098\uac00\uae30"})]})}}}]);
//# sourceMappingURL=771.15a7b616.chunk.js.map