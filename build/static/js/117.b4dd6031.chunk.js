/*! For license information please see 117.b4dd6031.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[117],{1117(e,t,s){s.r(t),s.d(t,{default:()=>N});var r=s(2555),a=s(5043),l=s(5016),i=s(8719),n=s(359),o=s(4689),c=s(7118),d=s(1360),x=s(5088);const m=(0,s(7784).A)("trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);var u=s(3242),p=s(5711),h=s(2382),b=s(7819),g=s(9855),f=s(614),v=s(8343),y=s(5452),j=s(579);function N(){const{user:e,userDoc:t,isAdmin:s}=(0,l.As)(),{items:N}=(0,i.wB)()||{items:[]},{currencyUnit:w}=(null===n.H2||void 0===n.H2?void 0:(0,n.H2)())||{currencyUnit:"\uc54c\ucc2c"},k=null===t||void 0===t?void 0:t.classCode,[A,I]=(0,a.useState)([]),[C,P]=(0,a.useState)(!0),[D,M]=(0,a.useState)(!1),[S,F]=(0,a.useState)(null),[H,R]=(0,a.useState)(""),[E,q]=(0,a.useState)(null),[z,V]=(0,a.useState)("active"),[_,G]=(0,a.useState)({itemName:"",itemIcon:"\ud83c\udf81",itemDescription:"",targetPrice:"",useStoreItem:!1,selectedItemId:""}),J=(0,a.useCallback)(async()=>{if(k)try{const e=(0,o.P)((0,o.rJ)(o.db,"groupPurchases"),(0,o._M)("classCode","==",k),(0,o.My)("createdAt","desc")),t=(await(0,o.GG)(e)).docs.map(e=>(0,r.A)({id:e.id},e.data()));I(t)}catch(e){y.vF.error("\ud568\uaed8\uad6c\ub9e4 \ub85c\ub4dc \uc2e4\ud328:",e)}finally{P(!1)}},[k]);(0,a.useEffect)(()=>{J()},[J]);const L=A.filter(e=>"active"===z?"active"===e.status:"completed"!==z||"completed"===e.status);return C?(0,j.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,j.jsx)("div",{className:"w-8 h-8 border-2 border-cyber-cyan border-t-transparent rounded-full animate-spin"})}):(0,j.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6 space-y-6",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500/20 to-indigo-500/20 border border-purple-500/30 flex items-center justify-center",children:(0,j.jsx)(c.A,{className:"w-5 h-5 text-purple-400"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h1",{className:"text-xl font-bold text-white font-jua",children:"\ud568\uaed8\uad6c\ub9e4"}),(0,j.jsx)("p",{className:"text-xs text-gray-400",children:"\uce5c\uad6c\ub4e4\uacfc \ubaa8\uae08\ud558\uc5ec \ud568\uaed8 \uc544\uc774\ud15c\uc744 \uad6c\ub9e4\ud574\uc694"})]})]}),(0,j.jsxs)("button",{onClick:()=>M(!0),className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white text-sm font-bold transition-all hover:scale-105 shadow-lg shadow-purple-500/20",children:[(0,j.jsx)(d.A,{className:"w-4 h-4"}),"\uc0c8 \ud568\uaed8\uad6c\ub9e4"]})]}),(0,j.jsx)("div",{className:"flex gap-2",children:[{key:"active",label:"\uc9c4\ud589\uc911",icon:x.A},{key:"completed",label:"\uc644\ub8cc",icon:m},{key:"all",label:"\uc804\uccb4",icon:c.A}].map(e=>{let{key:t,label:s,icon:r}=e;return(0,j.jsxs)("button",{onClick:()=>V(t),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium transition-all ".concat(z===t?"bg-purple-500/20 text-purple-300 border border-purple-500/30":"bg-white/5 text-gray-400 border border-transparent hover:bg-white/10"),children:[(0,j.jsx)(r,{className:"w-3.5 h-3.5"}),s]},t)})}),0===L.length?(0,j.jsxs)("div",{className:"text-center py-16",children:[(0,j.jsx)("div",{className:"text-5xl mb-4 opacity-50",children:"\ud83e\udd1d"}),(0,j.jsx)("p",{className:"text-gray-400 text-lg font-medium",children:"active"===z?"\uc9c4\ud589 \uc911\uc778 \ud568\uaed8\uad6c\ub9e4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4":"completed"===z?"\uc644\ub8cc\ub41c \ud568\uaed8\uad6c\ub9e4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4":"\ud568\uaed8\uad6c\ub9e4 \ub0b4\uc5ed\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,j.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:"\uc0c8 \ud568\uaed8\uad6c\ub9e4\ub97c \uc2dc\uc791\ud574\ubcf4\uc138\uc694!"})]}):(0,j.jsx)("div",{className:"space-y-3",children:L.map(t=>{var r,a,l;const i=(n=t,Math.min(100,Math.round(n.currentAmount/n.targetPrice*100)));var n;const c=(t=>{var s;const r=null===(s=t.contributors)||void 0===s?void 0:s.find(t=>t.userId===(null===e||void 0===e?void 0:e.uid));return(null===r||void 0===r?void 0:r.amount)||0})(t),d="completed"===t.status,x=E===t.id,f=s()||t.initiatorId===(null===e||void 0===e?void 0:e.uid),N=t.targetPrice-t.currentAmount;return(0,j.jsxs)("div",{className:"rounded-2xl border transition-all ".concat(d?"bg-gradient-to-r from-emerald-900/20 to-teal-900/20 border-emerald-500/20":"bg-[rgba(20,20,35,0.6)] border-[rgba(0,255,242,0.1)] hover:border-purple-500/30"),children:[(0,j.jsx)("div",{className:"p-4",children:(0,j.jsxs)("div",{className:"flex items-start gap-3",children:[(0,j.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl flex-shrink-0 ".concat(d?"bg-emerald-500/20":"bg-purple-500/10 border border-purple-500/20"),children:t.itemIcon}),(0,j.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,j.jsx)("h3",{className:"text-base font-bold text-white truncate",children:t.itemName}),d&&(0,j.jsxs)("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-400 text-xs font-bold",children:[(0,j.jsx)(m,{className:"w-3 h-3"}),"\ub2ec\uc131"]})]}),t.itemDescription&&(0,j.jsx)("p",{className:"text-xs text-gray-400 mb-2 line-clamp-1",children:t.itemDescription}),(0,j.jsxs)("div",{className:"relative h-3 bg-white/5 rounded-full overflow-hidden mb-2",children:[(0,j.jsx)("div",{className:"absolute inset-y-0 left-0 rounded-full transition-all duration-500 ".concat(d?"bg-gradient-to-r from-emerald-500 to-teal-400":"bg-gradient-to-r from-purple-500 to-indigo-500"),style:{width:"".concat(i,"%")}}),(0,j.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,j.jsxs)("span",{className:"text-[10px] font-bold text-white drop-shadow-md",children:[i,"%"]})})]}),(0,j.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,j.jsxs)("span",{className:"text-gray-400",children:[(0,v.FR)(t.currentAmount),w," /"," ",(0,v.FR)(t.targetPrice),w]}),(0,j.jsxs)("span",{className:"text-gray-500",children:["\ucc38\uc5ec ",(null===(r=t.contributors)||void 0===r?void 0:r.length)||0,"\uba85"]})]}),c>0&&(0,j.jsxs)("div",{className:"mt-1.5 text-xs text-purple-300",children:["\ub0b4 \uae30\uc5ec: ",(0,v.FR)(c),w]})]}),(0,j.jsxs)("div",{className:"flex flex-col gap-1.5 flex-shrink-0",children:[!d&&(0,j.jsxs)("button",{onClick:()=>{F(t),R("")},className:"flex items-center gap-1.5 px-3 py-2 rounded-lg bg-purple-600/80 hover:bg-purple-500 text-white text-xs font-bold transition-all",children:[(0,j.jsx)(u.A,{className:"w-3.5 h-3.5"}),"\ucc38\uc5ec"]}),(0,j.jsxs)("button",{onClick:()=>q(x?null:t.id),className:"flex items-center gap-1 px-3 py-1.5 rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 text-xs transition-all",children:[x?(0,j.jsx)(p.A,{className:"w-3.5 h-3.5"}):(0,j.jsx)(h.A,{className:"w-3.5 h-3.5"}),"\uc0c1\uc138"]})]})]})}),x&&(0,j.jsxs)("div",{className:"px-4 pb-4 border-t border-white/5 pt-3 space-y-3",children:[(0,j.jsxs)("div",{className:"text-xs text-gray-500",children:["\uc2dc\uc791: ",t.initiatorName," \xb7"," ",null!==(a=t.createdAt)&&void 0!==a&&a.toDate?t.createdAt.toDate().toLocaleDateString("ko-KR"):""]}),(null===(l=t.contributors)||void 0===l?void 0:l.length)>0&&(0,j.jsxs)("div",{children:[(0,j.jsxs)("p",{className:"text-xs font-bold text-gray-300 mb-2",children:["\ucc38\uc5ec\uc790 (",t.contributors.length,"\uba85)"]}),(0,j.jsx)("div",{className:"space-y-1.5",children:t.contributors.sort((e,t)=>t.amount-e.amount).map((e,t)=>(0,j.jsxs)("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-3 py-2",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsxs)("span",{className:"text-xs font-bold text-gray-300",children:[t+1,"."]}),(0,j.jsx)("span",{className:"text-sm text-white",children:e.userName})]}),(0,j.jsxs)("span",{className:"text-sm font-bold text-purple-300",children:[(0,v.FR)(e.amount),w]})]},t))})]}),!d&&N>0&&(0,j.jsxs)("div",{className:"flex items-center gap-2 bg-amber-500/10 border border-amber-500/20 rounded-lg px-3 py-2",children:[(0,j.jsx)(b.A,{className:"w-4 h-4 text-amber-400 flex-shrink-0"}),(0,j.jsxs)("span",{className:"text-xs text-amber-300",children:["\ubaa9\ud45c\uae4c\uc9c0"," ",(0,j.jsxs)("strong",{children:[(0,v.FR)(N),w]})," ","\ub354 \ud544\uc694\ud569\ub2c8\ub2e4"]})]}),f&&(0,j.jsxs)("button",{onClick:()=>(async e=>{if(window.confirm("\uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \ubaa8\uae08\ub41c \uae08\uc561\uc740 \ucc38\uc5ec\uc790\uc5d0\uac8c \ud658\ubd88\ub429\ub2c8\ub2e4."))try{var t;if((null===(t=e.contributors)||void 0===t?void 0:t.length)>0&&e.currentAmount>0)for(const t of e.contributors){const e=(0,o.H9)(o.db,"users",t.userId);await(0,o.c4)(o.db,async s=>{const r=await s.get(e);r.exists()&&s.update(e,{cash:(r.data().cash||0)+t.amount})})}await(0,o.kd)((0,o.H9)(o.db,"groupPurchases",e.id)),J()}catch(s){y.vF.error("\ud568\uaed8\uad6c\ub9e4 \uc0ad\uc81c \uc2e4\ud328:",s),alert("\uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}})(t),className:"flex items-center gap-1.5 px-3 py-2 rounded-lg bg-red-500/10 hover:bg-red-500/20 text-red-400 text-xs font-medium transition-all",children:[(0,j.jsx)(g.A,{className:"w-3.5 h-3.5"}),"\uc0ad\uc81c (\ud658\ubd88 \ucc98\ub9ac)"]})]})]},t.id)})}),D&&(0,j.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/70 backdrop-blur-sm p-4",onClick:()=>M(!1),children:(0,j.jsxs)("div",{className:"w-full max-w-md bg-[#12121f] border border-purple-500/30 rounded-2xl shadow-2xl overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,j.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 bg-gradient-to-r from-purple-600/20 to-indigo-600/20 border-b border-purple-500/20",children:[(0,j.jsxs)("h2",{className:"text-lg font-bold text-white font-jua flex items-center gap-2",children:[(0,j.jsx)(d.A,{className:"w-5 h-5 text-purple-400"}),"\uc0c8 \ud568\uaed8\uad6c\ub9e4"]}),(0,j.jsx)("button",{onClick:()=>M(!1),className:"p-1 rounded-lg hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:(0,j.jsx)(f.A,{className:"w-5 h-5"})})]}),(0,j.jsxs)("div",{className:"p-5 space-y-4",children:[(null===N||void 0===N?void 0:N.length)>0&&(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-xs font-bold text-gray-400 mb-1.5",children:"\uc0c1\uc810 \uc544\uc774\ud15c\uc5d0\uc11c \uc120\ud0dd (\uc120\ud0dd\uc0ac\ud56d)"}),(0,j.jsxs)("select",{value:_.selectedItemId,onChange:e=>(e=>{const t=null===N||void 0===N?void 0:N.find(t=>t.id===e);t&&G(s=>(0,r.A)((0,r.A)({},s),{},{selectedItemId:e,itemName:t.name,itemIcon:t.icon||"\ud83c\udf81",itemDescription:t.description||"",targetPrice:String(t.price||"")}))})(e.target.value),className:"w-full px-3 py-2.5 rounded-xl bg-white/5 border border-white/10 text-white text-sm focus:border-purple-500/50 focus:outline-none",children:[(0,j.jsx)("option",{value:"",children:"\uc9c1\uc811 \uc785\ub825"}),N.filter(e=>!1!==e.available).map(e=>(0,j.jsxs)("option",{value:e.id,children:[e.icon||"\ud83c\udf81"," ",e.name," -"," ",(0,v.FR)(e.price),w]},e.id))]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-xs font-bold text-gray-400 mb-1.5",children:"\uc544\uc774\ud15c \uc774\ub984 *"}),(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)("input",{type:"text",value:_.itemIcon,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{itemIcon:e.target.value})),className:"w-14 px-2 py-2.5 rounded-xl bg-white/5 border border-white/10 text-center text-lg focus:border-purple-500/50 focus:outline-none",placeholder:"\ud83c\udf81"}),(0,j.jsx)("input",{type:"text",value:_.itemName,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{itemName:e.target.value})),className:"flex-1 px-3 py-2.5 rounded-xl bg-white/5 border border-white/10 text-white text-sm focus:border-purple-500/50 focus:outline-none",placeholder:"\uc608: \uc790\uc720\uc2dc\uac04, \ud53c\uc790\ud30c\ud2f0"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-xs font-bold text-gray-400 mb-1.5",children:"\uc124\uba85 (\uc120\ud0dd)"}),(0,j.jsx)("input",{type:"text",value:_.itemDescription,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{itemDescription:e.target.value})),className:"w-full px-3 py-2.5 rounded-xl bg-white/5 border border-white/10 text-white text-sm focus:border-purple-500/50 focus:outline-none",placeholder:"\uc608: \uc6b0\ub9ac\ubc18 \ubaa8\ub450 \ud568\uaed8 \uc790\uc720\uc2dc\uac04\uc744 \uc990\uaca8\uc694!"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-xs font-bold text-gray-400 mb-1.5",children:"\ubaa9\ud45c \uae08\uc561 *"}),(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("input",{type:"number",value:_.targetPrice,onChange:e=>G(t=>(0,r.A)((0,r.A)({},t),{},{targetPrice:e.target.value})),className:"w-full px-3 py-2.5 pr-14 rounded-xl bg-white/5 border border-white/10 text-white text-sm focus:border-purple-500/50 focus:outline-none",placeholder:"0",min:"1"}),(0,j.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:w})]})]}),(0,j.jsx)("button",{onClick:async()=>{const s=parseInt(_.targetPrice);if(_.itemName.trim()&&s&&!(s<=0))try{await(0,o.gS)((0,o.rJ)(o.db,"groupPurchases"),{classCode:k,itemName:_.itemName.trim(),itemIcon:_.itemIcon||"\ud83c\udf81",itemDescription:_.itemDescription.trim(),targetPrice:s,currentAmount:0,initiatorId:e.uid,initiatorName:(null===t||void 0===t?void 0:t.name)||"\uc54c \uc218 \uc5c6\uc74c",contributors:[],status:"active",createdAt:(0,o.O5)(),completedAt:null}),M(!1),G({itemName:"",itemIcon:"\ud83c\udf81",itemDescription:"",targetPrice:"",useStoreItem:!1,selectedItemId:""}),J()}catch(r){y.vF.error("\ud568\uaed8\uad6c\ub9e4 \uc0dd\uc131 \uc2e4\ud328:",r),alert("\uc0dd\uc131\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},disabled:!_.itemName.trim()||!_.targetPrice||parseInt(_.targetPrice)<=0,className:"w-full py-3 rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed text-white font-bold text-sm transition-all",children:"\ud568\uaed8\uad6c\ub9e4 \uc2dc\uc791\ud558\uae30"})]})]})}),S&&(0,j.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/70 backdrop-blur-sm p-4",onClick:()=>F(null),children:(0,j.jsxs)("div",{className:"w-full max-w-sm bg-[#12121f] border border-purple-500/30 rounded-2xl shadow-2xl overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,j.jsx)("div",{className:"px-5 py-4 bg-gradient-to-r from-purple-600/20 to-indigo-600/20 border-b border-purple-500/20",children:(0,j.jsxs)("h2",{className:"text-lg font-bold text-white font-jua flex items-center gap-2",children:[(0,j.jsx)(u.A,{className:"w-5 h-5 text-purple-400"}),"\ubaa8\uae08 \ucc38\uc5ec"]})}),(0,j.jsxs)("div",{className:"p-5 space-y-4",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3 bg-white/5 rounded-xl p-3",children:[(0,j.jsx)("span",{className:"text-2xl",children:S.itemIcon}),(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-sm font-bold text-white",children:S.itemName}),(0,j.jsxs)("p",{className:"text-xs text-gray-400",children:["\ub0a8\uc740 \uae08\uc561:"," ",(0,v.FR)(S.targetPrice-S.currentAmount),w]})]})]}),(0,j.jsxs)("div",{className:"text-xs text-gray-400",children:["\ub0b4 \uc794\uc561:"," ",(0,j.jsxs)("span",{className:"text-white font-bold",children:[(0,v.FR)((null===t||void 0===t?void 0:t.cash)||0),w]})]}),(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("input",{type:"number",value:H,onChange:e=>R(e.target.value),className:"w-full px-3 py-3 pr-14 rounded-xl bg-white/5 border border-white/10 text-white text-lg font-bold focus:border-purple-500/50 focus:outline-none text-center",placeholder:"0",min:"1",max:Math.min((null===t||void 0===t?void 0:t.cash)||0,S.targetPrice-S.currentAmount),autoFocus:!0}),(0,j.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:w})]}),(0,j.jsx)("div",{className:"flex gap-2",children:[100,500,1e3,5e3].map(e=>(0,j.jsx)("button",{onClick:()=>R(String(e)),className:"flex-1 py-1.5 rounded-lg bg-white/5 hover:bg-purple-500/20 text-gray-300 text-xs font-medium transition-all",children:(0,v.FR)(e)},e))}),(0,j.jsx)("button",{onClick:()=>{const e=Math.min((null===t||void 0===t?void 0:t.cash)||0,S.targetPrice-S.currentAmount);R(String(e))},className:"w-full py-2 rounded-lg bg-white/5 hover:bg-white/10 text-gray-300 text-xs font-medium transition-all",children:"\ub0a8\uc740 \uae08\uc561 \uc804\ubd80 \ucc38\uc5ec"}),(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)("button",{onClick:()=>F(null),className:"flex-1 py-3 rounded-xl bg-white/5 hover:bg-white/10 text-gray-400 font-bold text-sm transition-all",children:"\ucde8\uc18c"}),(0,j.jsx)("button",{onClick:async()=>{const s=parseInt(H);if(!s||s<=0||!S)return;const r=S,a=r.targetPrice-r.currentAmount,l=Math.min(s,a);if(((null===t||void 0===t?void 0:t.cash)||0)<l)alert("\uc794\uc561\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");else try{const s=(0,o.H9)(o.db,"groupPurchases",r.id),a=(0,o.H9)(o.db,"users",e.uid);await(0,o.c4)(o.db,async r=>{const i=await r.get(s),n=await r.get(a);if(!i.exists()||!n.exists())throw new Error("\ubb38\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const o=i.data(),c=n.data();if("active"!==o.status)throw new Error("\uc774\ubbf8 \uc644\ub8cc\ub41c \ucea0\ud398\uc778\uc785\ub2c8\ub2e4.");const d=o.targetPrice-o.currentAmount,x=Math.min(l,d);if(c.cash<x)throw new Error("\uc794\uc561\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4.");const m=[...o.contributors||[]],u=m.findIndex(t=>t.userId===e.uid);u>=0?(m[u].amount+=x,m[u].contributedAt=new Date):m.push({userId:e.uid,userName:(null===t||void 0===t?void 0:t.name)||"\uc54c \uc218 \uc5c6\uc74c",amount:x,contributedAt:new Date});const p=o.currentAmount+x,h=p>=o.targetPrice;r.update(s,{currentAmount:p,contributors:m,status:h?"completed":"active",completedAt:h?new Date:null}),r.update(a,{cash:c.cash-x})}),F(null),R(""),J()}catch(i){y.vF.error("\ubaa8\uae08 \ucc38\uc5ec \uc2e4\ud328:",i),alert(i.message||"\ucc38\uc5ec\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},disabled:!H||parseInt(H)<=0||parseInt(H)>((null===t||void 0===t?void 0:t.cash)||0),className:"flex-1 py-3 rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed text-white font-bold text-sm transition-all",children:"\ucc38\uc5ec\ud558\uae30"})]})]})]})})]})}},3242(e,t,s){s.d(t,{A:()=>r});const r=(0,s(7784).A)("hand-coins",[["path",{d:"M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17",key:"geh8rc"}],["path",{d:"m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"1fto5m"}],["path",{d:"m2 16 6 6",key:"1pfhp9"}],["circle",{cx:"16",cy:"9",r:"2.9",key:"1n0dlu"}],["circle",{cx:"6",cy:"5",r:"3",key:"151irh"}]])},5088(e,t,s){s.d(t,{A:()=>r});const r=(0,s(7784).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5711(e,t,s){s.d(t,{A:()=>r});const r=(0,s(7784).A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},7819(e,t,s){s.d(t,{A:()=>r});const r=(0,s(7784).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])}}]);
//# sourceMappingURL=117.b4dd6031.chunk.js.map