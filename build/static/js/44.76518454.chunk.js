"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[44],{8044:(e,s,t)=>{t.r(s),t.d(s,{default:()=>g});var a=t(4919),n=t(5043),r=t(7950),l=t(5016),o=t(5010),i=(t(6555),t(579));const c=e=>{let{onSubmitReport:s,reportReasons:t,users:r,currentUser:l}=e;const[o,c]=(0,n.useState)({reportedUserId:"",reason:"",details:""}),d=t.filter(e=>e.isLaw),m=t.filter(e=>!e.isLaw),u=e=>{const{name:s,value:t}=e.target;c((0,a.A)((0,a.A)({},o),{},{[s]:t}))},p=()=>{const e=t.find(e=>e.reason===o.reason);return e?e.amount:0},h=()=>{const e=t.find(e=>e.reason===o.reason);return(null===e||void 0===e?void 0:e.description)||""};return l?(0,i.jsxs)("div",{className:"submit-report-container",children:[(0,i.jsx)("h2",{className:"section-title",children:"\uc2e0\uace0 \uc81c\ucd9c"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o.reportedUserId&&o.reason?(s(o),c({reportedUserId:"",reason:"",details:""})):alert("\uc2e0\uace0 \ub300\uc0c1\uacfc \uc0ac\uc720\ub97c \ubaa8\ub450 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.")},className:"report-form",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"reportedUserId",children:"\uc2e0\uace0 \ub300\uc0c1"}),(0,i.jsxs)("select",{id:"reportedUserId",name:"reportedUserId",value:o.reportedUserId,onChange:u,required:!0,className:"form-select",children:[(0,i.jsx)("option",{value:"",children:"\uc2e0\uace0\ud560 \uc0ac\ub78c\uc744 \uc120\ud0dd\ud558\uc138\uc694"}),r.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"reason",children:"\uc2e0\uace0 \uc0ac\uc720"}),(0,i.jsxs)("select",{id:"reason",name:"reason",value:o.reason,onChange:u,required:!0,className:"form-select",children:[(0,i.jsx)("option",{value:"",children:"\uc0ac\uc720\ub97c \uc120\ud0dd\ud558\uc138\uc694"}),d.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("option",{disabled:!0,className:"reason-group-heading",children:"--- \ubc95\uc548 \uae30\ubc18 \uc2e0\uace0 \uc0ac\uc720 ---"}),d.map((e,s)=>(0,i.jsxs)("option",{value:e.reason,className:"law-reason-option",children:[e.reason," (\ubc8c\uae08: ",e.amount.toLocaleString(),"\uc6d0)"]},"law-".concat(s)))]}),(0,i.jsx)("option",{disabled:!0,className:"reason-group-heading",children:"--- \uc77c\ubc18 \uc2e0\uace0 \uc0ac\uc720 ---"}),m.map((e,s)=>(0,i.jsxs)("option",{value:e.reason,children:[e.reason," ",e.amount>0?"(\ubc8c\uae08: ".concat(e.amount.toLocaleString(),"\uc6d0)"):""]},"standard-".concat(s)))]})]}),o.reason&&h()&&(0,i.jsxs)("div",{className:"reason-description-box",children:[(0,i.jsx)("h3",{children:"\ubc95\uc548 \uc124\uba85"}),(0,i.jsx)("p",{children:h()}),p()>0&&(0,i.jsxs)("p",{className:"default-fine",children:["\uae30\ubcf8 \ubc8c\uae08: ",p().toLocaleString(),"\uc6d0"]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"details",children:"\uc0c1\uc138 \ub0b4\uc6a9 (\uc120\ud0dd\uc0ac\ud56d)"}),(0,i.jsx)("textarea",{id:"details",name:"details",value:o.details,onChange:u,className:"form-textarea",placeholder:"\uc2e0\uace0\uc5d0 \ub300\ud55c \uc0c1\uc138 \ub0b4\uc6a9\uc744 \uc791\uc131\ud558\uc138\uc694 (\uc120\ud0dd\uc0ac\ud56d)",rows:"4"})]}),(0,i.jsx)("div",{className:"form-actions",children:(0,i.jsx)("button",{type:"submit",className:"submit-button",children:"\uc2e0\uace0 \uc81c\ucd9c"})})]})]}):(0,i.jsx)("p",{className:"login-required-message",children:"\uc2e0\uace0\ud558\ub824\uba74 \ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."})},d=e=>{let{reports:s,onProcessReport:t,onSettlement:a,reportReasons:r,formatDate:l,onAcceptReport:o,onDismissReport:c,isAdminView:d}=e;const[m,u]=(0,n.useState)("submitted"),[p,h]=(0,n.useState)(!1),[x,j]=(0,n.useState)(null),[v,N]=(0,n.useState)(""),[g,f]=(0,n.useState)(""),b=e=>{if(!Array.isArray(r))return null;const s=r.find(s=>s.reason===e);return s?s.amount:null},y=e=>{const s=e.target.value.replace(/[^0-9]/g,"");N(s)},w=()=>{if(!x)return;if(!t)return void alert("\ubc8c\uae08 \ucc98\ub9ac \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const e=v?parseInt(v,10):0;try{t(x.id,e,g),I()}catch(s){console.error("\ubc8c\uae08 \ucc98\ub9ac \uc911 \uc624\ub958:",s),alert("\ubc8c\uae08 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},I=()=>{h(!1),j(null),N(""),f("")},C=s.filter(e=>"accepted"===e.status),S=s.filter(e=>"submitted"===e.status),D=e=>e&&e.startsWith("[\ubc95\uc548]")?(0,i.jsx)("span",{className:"law-reason-highlight",children:e}):e,R=n.useMemo(()=>p&&x?()=>{var e,s,t;return(0,i.jsx)("div",{className:"process-modal-overlay",onClick:e=>{"process-modal-overlay"===e.target.className&&I()},children:(0,i.jsxs)("div",{className:"process-modal-container",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"process-modal-header",children:[(0,i.jsxs)("h2",{children:["\ubc8c\uae08 \ucc98\ub9ac (\uc0ac\uac74\ubc88\ud638: ",(null===x||void 0===x||null===(e=x.id)||void 0===e?void 0:e.slice(-6))||"\uc5c6\uc74c",")"]}),(0,i.jsx)("button",{className:"close-button",onClick:I,children:"\xd7"})]}),(0,i.jsxs)("div",{className:"process-modal-content",children:[(0,i.jsxs)("div",{className:"report-summary",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc0ac\uac74\ubc88\ud638:"})," ",(null===x||void 0===x||null===(s=x.id)||void 0===s?void 0:s.slice(-6))||"\uc5c6\uc74c"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ub300\uc0c1\uc790:"})," ",(null===x||void 0===x?void 0:x.reportedUserName)||"\uc54c \uc218 \uc5c6\uc74c"]}),(0,i.jsxs)("p",{className:"report-reason",children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0 \uc0ac\uc720:"})," ",(null===x||void 0===x?void 0:x.reason)||"\uc54c \uc218 \uc5c6\uc74c"]}),(null===x||void 0===x?void 0:x.description)&&(0,i.jsxs)("p",{className:"law-description",children:[(0,i.jsx)("strong",{children:"\uc124\uba85:"})," ",x.description]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"processingAmount",children:"\ubc8c\uae08 \uae08\uc561 (\uc6d0)"}),(0,i.jsx)("input",{type:"text",id:"processingAmount",value:v,onChange:y,placeholder:"\ubc8c\uae08 \uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694 (0\uc6d0\uc740 \uacbd\uace0)",className:"form-input"}),null!==b(null===x||void 0===x?void 0:x.reason)&&(0,i.jsxs)("p",{className:"form-hint",children:["\uae30\ubcf8 \uae08\uc561: ",null===(t=b(null===x||void 0===x?void 0:x.reason))||void 0===t?void 0:t.toLocaleString(),"\uc6d0"]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"processingReason",children:"\ucc98\ub9ac \uc0ac\uc720 (\uc120\ud0dd)"}),(0,i.jsx)("textarea",{id:"processingReason",value:g,onChange:e=>f(e.target.value),placeholder:"\ucc98\ub9ac \uc0ac\uc720\ub97c \uc785\ub825\ud558\uc138\uc694 (\uc120\ud0dd\uc0ac\ud56d)",className:"form-textarea",rows:"3"})]}),r&&r.length>0&&(0,i.jsxs)("div",{className:"quick-reasons-container",children:[(0,i.jsx)("p",{className:"quick-reasons-label",children:"\ube60\ub978 \uc120\ud0dd:"}),(0,i.jsx)("div",{className:"quick-reasons-buttons",children:r.map((e,s)=>(0,i.jsxs)("button",{type:"button",onClick:()=>{N(e.amount.toString()),f(e.reason)},className:"quick-reason-btn",children:[e.reason," (",e.amount.toLocaleString(),"\uc6d0)"]},s))})]})]}),(0,i.jsxs)("div",{className:"process-modal-footer",children:[(0,i.jsx)("button",{className:"modal-button cancel",onClick:I,children:"\ucde8\uc18c"}),(0,i.jsx)("button",{className:"modal-button process",onClick:w,children:"\ucc98\ub9ac \uc644\ub8cc"})]})]})})}:null,[p,x,v,g,r]);return(0,i.jsxs)("div",{className:"report-status-container",children:[(0,i.jsx)("h2",{className:"section-title",children:"\uc2e0\uace0 \ucc98\ub9ac \ud604\ud669"}),(0,i.jsxs)("div",{className:"tabs-container",children:[(0,i.jsxs)("button",{onClick:()=>u("submitted"),className:"tab-button ".concat("submitted"===m?"active":""),children:["\uc81c\ucd9c\ub41c \uc2e0\uace0 (",S.length,")"]}),(0,i.jsxs)("button",{onClick:()=>u("accepted"),className:"tab-button ".concat("accepted"===m?"active":""),children:["\uc811\uc218\ub41c \uc2e0\uace0 (",C.length,")"]})]}),0===s.length?(0,i.jsx)("div",{className:"empty-state",children:"\ucc98\ub9ac \uc911\uc778 \uc2e0\uace0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,i.jsxs)(i.Fragment,{children:["accepted"===m&&(0,i.jsx)("div",{className:"status-section",children:(0,i.jsx)("div",{className:"report-list",children:0===C.length?(0,i.jsx)("div",{className:"empty-state",children:"\uc811\uc218\ub41c \uc2e0\uace0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):C.map(e=>(0,i.jsxs)("div",{className:"report-item ".concat(e.isLawReport?"law-report":""),children:[(0,i.jsxs)("div",{className:"report-header",children:[(0,i.jsxs)("span",{className:"report-id",children:["\uc0ac\uac74\ubc88\ud638: ",e.id.slice(-6)]}),(0,i.jsxs)("span",{className:"report-date",children:["\uc811\uc218\uc77c: ",l(e.acceptanceDate)]})]}),(0,i.jsxs)("div",{className:"report-content",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0\uc790:"})," ",e.reporterName]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ub300\uc0c1:"})," ",e.reportedUserName]}),(0,i.jsxs)("p",{className:"report-reason",children:[(0,i.jsx)("strong",{children:"\uc0ac\uc720:"})," ",D(e.reason)]}),e.description&&(0,i.jsxs)("p",{className:"report-description",children:[(0,i.jsx)("strong",{children:"\uc124\uba85:"})," ",e.description]}),e.details&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc0c1\uc138:"})," ",e.details]})]}),d&&(0,i.jsxs)("div",{className:"report-actions",children:[(0,i.jsx)("button",{onClick:()=>{console.log("\ubc8c\uae08 \ucc98\ub9ac \ubc84\ud2bc \ud074\ub9ad\ub428:",e),(e=>{if(!e)return;let s="";if(Array.isArray(r)&&r.length>0){const t=r.find(s=>s.reason===e.reason);t&&"number"===typeof t.amount&&(s=t.amount.toString())}j(e),N(s),f(""),h(!0)})(e)},className:"action-button process-button fine-button",children:"\ubc8c\uae08 \ucc98\ub9ac"}),(0,i.jsx)("button",{onClick:()=>{console.log("\ud569\uc758 \ucc98\ub9ac \ubc84\ud2bc \ud074\ub9ad\ub428:",e),(e=>{if(!a)return console.error("onSettlement \ud568\uc218\uac00 \uc804\ub2ec\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4"),void alert("\ud569\uc758 \ucc98\ub9ac \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694.");if(e)try{a(e)}catch(s){console.error("\ud569\uc758 \ucc98\ub9ac \uc911 \uc624\ub958:",s),alert("\ud569\uc758 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}else console.error("handleSettlementClick: report\uac00 \uc5c6\uc2b5\ub2c8\ub2e4")})(e)},className:"action-button settlement-button",children:"\ud569\uc758 \ucc98\ub9ac"}),(0,i.jsx)("button",{onClick:()=>{console.log("\ubc18\ub824 \ubc84\ud2bc \ud074\ub9ad\ub428:",e.id),c?c(e.id):console.error("onDismissReport \ud568\uc218\uac00 \uc5c6\uc2b5\ub2c8\ub2e4")},className:"action-button dismiss-button",children:"\ubc18\ub824"})]})]},e.id))})}),"submitted"===m&&(0,i.jsx)("div",{className:"status-section",children:(0,i.jsx)("div",{className:"report-list",children:0===S.length?(0,i.jsx)("div",{className:"empty-state",children:"\uc81c\ucd9c\ub41c \uc2e0\uace0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):S.map(e=>(0,i.jsxs)("div",{className:"report-item ".concat(e.isLawReport?"law-report":""),children:[(0,i.jsxs)("div",{className:"report-header",children:[(0,i.jsxs)("span",{className:"report-id",children:["\uc0ac\uac74\ubc88\ud638: ",e.id.slice(-6)]}),(0,i.jsxs)("span",{className:"report-date",children:["\uc81c\ucd9c\uc77c: ",l(e.submitDate)]})]}),(0,i.jsxs)("div",{className:"report-content",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0\uc790:"})," ",e.reporterName]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ub300\uc0c1:"})," ",e.reportedUserName]}),(0,i.jsxs)("p",{className:"report-reason",children:[(0,i.jsx)("strong",{children:"\uc0ac\uc720:"})," ",D(e.reason)]}),e.description&&(0,i.jsxs)("p",{className:"report-description",children:[(0,i.jsx)("strong",{children:"\uc124\uba85:"})," ",e.description]}),e.details&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc0c1\uc138:"})," ",e.details]})]}),d&&(0,i.jsxs)("div",{className:"report-actions",children:[(0,i.jsx)("button",{onClick:()=>{console.log("\uc811\uc218 \ubc84\ud2bc \ud074\ub9ad\ub428:",e.id),o?o(e.id):console.error("onAcceptReport \ud568\uc218\uac00 \uc5c6\uc2b5\ub2c8\ub2e4")},className:"action-button accept-button",children:"\uc811\uc218"}),(0,i.jsx)("button",{onClick:()=>{console.log("\ubc18\ub824 \ubc84\ud2bc \ud074\ub9ad\ub428:",e.id),c?c(e.id):console.error("onDismissReport \ud568\uc218\uac00 \uc5c6\uc2b5\ub2c8\ub2e4")},className:"action-button dismiss-button",children:"\ubc18\ub824"})]})]},e.id))})})]}),R&&R()]})},m=e=>{let{reports:s,formatDate:t,isAdminView:a,onEditReport:r,onDeleteReport:l}=e;const[o,c]=(0,n.useState)("all"),d=s.filter(e=>"all"===o||("fine"===o?"resolved_fine"===e.status:"settlement"===o?"resolved_settlement"===e.status:"dismissed"!==o||"dismissed"===e.status));return(0,i.jsxs)("div",{className:"report-results-container",children:[(0,i.jsx)("h2",{className:"section-title",children:"\ucc98\ub9ac \uacb0\uacfc"}),(0,i.jsxs)("div",{className:"filter-controls",children:[(0,i.jsx)("span",{className:"filter-label",children:"\ud544\ud130:"}),(0,i.jsxs)("div",{className:"filter-buttons",children:[(0,i.jsxs)("button",{className:"filter-button ".concat("all"===o?"active":""),onClick:()=>c("all"),children:["\uc804\uccb4 (",s.length,")"]}),(0,i.jsx)("button",{className:"filter-button ".concat("fine"===o?"active":""),onClick:()=>c("fine"),children:"\ubc8c\uae08 \ucc98\ub9ac"}),(0,i.jsx)("button",{className:"filter-button ".concat("settlement"===o?"active":""),onClick:()=>c("settlement"),children:"\ud569\uc758 \ucc98\ub9ac"}),(0,i.jsx)("button",{className:"filter-button ".concat("dismissed"===o?"active":""),onClick:()=>c("dismissed"),children:"\ubc18\ub824"})]})]}),0===d.length?(0,i.jsx)("div",{className:"empty-state",children:"\ucc98\ub9ac\ub41c \uc2e0\uace0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,i.jsx)("div",{className:"results-list",children:d.map(e=>{return(0,i.jsxs)("div",{className:"result-item ".concat(e.isLawReport?"law-report":""," status-").concat(e.status),children:[(0,i.jsxs)("div",{className:"result-header",children:[(0,i.jsxs)("span",{className:"report-id",children:["\uc0ac\uac74\ubc88\ud638: ",e.id.slice(-6)]}),(0,i.jsxs)("span",{className:"result-status",children:["resolved_fine"===e.status&&"\ubc8c\uae08 \ucc98\ub9ac","resolved_settlement"===e.status&&"\ud569\uc758 \ucc98\ub9ac","dismissed"===e.status&&"\ubc18\ub824"]}),(0,i.jsxs)("span",{className:"result-date",children:["\ucc98\ub9ac\uc77c:"," ",t(e.resolutionDate||e.submitDate)]})]}),(0,i.jsxs)("div",{className:"result-content",children:[(0,i.jsxs)("div",{className:"result-parties",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0\uc790:"})," ",e.reporterName]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ub300\uc0c1\uc790:"})," ",e.reportedUserName]})]}),(0,i.jsxs)("div",{className:"result-details",children:[(0,i.jsxs)("p",{className:"report-reason",children:[(0,i.jsx)("strong",{children:"\uc2e0\uace0 \uc0ac\uc720:"})," ",(s=e.reason,s.startsWith("[\ubc95\uc548]")?(0,i.jsx)("span",{className:"law-reason-highlight",children:s}):s)]}),e.description&&(0,i.jsxs)("p",{className:"report-description",children:[(0,i.jsx)("strong",{children:"\uc124\uba85:"})," ",e.description]}),e.details&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\uc0c1\uc138\ub0b4\uc6a9:"})," ",e.details]}),e.resolution&&(0,i.jsxs)("p",{className:"resolution",children:[(0,i.jsx)("strong",{children:"\ucc98\ub9ac\uacb0\uacfc:"})," ",e.resolution]}),e.amount>0&&(0,i.jsxs)("p",{className:"amount",children:[(0,i.jsx)("strong",{children:"\uae08\uc561:"})," ",e.amount.toLocaleString(),"\uc6d0","resolved_settlement"===e.status&&" (\ud569\uc758\uae08)","resolved_fine"===e.status&&" (\ubc8c\uae08)"]})]}),(0,i.jsx)("div",{className:"processed-by",children:(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"\ucc98\ub9ac\uc790:"})," ",e.processedByName||"\uc2dc\uc2a4\ud15c"]})})]}),a&&(0,i.jsxs)("div",{className:"admin-actions",children:[(0,i.jsx)("button",{onClick:()=>r(e.id),className:"admin-button edit-button",title:"\ud3b8\uc9d1",children:"\ud3b8\uc9d1"}),(0,i.jsx)("button",{onClick:()=>l(e.id),className:"admin-button delete-button",title:"\uc0ad\uc81c",children:"\uc0ad\uc81c"})]})]},e.id);var s})})]})},u=e=>{let{reportReasons:s,onUpdateReasons:t,onDeleteAllReports:a}=e;const[r,l]=(0,n.useState)([]);(0,n.useEffect)(()=>{l(JSON.parse(JSON.stringify(s||[])))},[s]);const o=(e,s,t)=>{const a=[...r];a[e][s]="amount"===s?""===t?0:parseInt(t,10):t,l(a)};return(0,i.jsxs)("div",{className:"admin-settings-container",children:[(0,i.jsx)("h2",{className:"admin-settings-h2",children:"\uad00\ub9ac\uc790 \uc124\uc815"}),(0,i.jsxs)("div",{className:"admin-section",children:[(0,i.jsx)("h3",{className:"admin-section-title",children:"\uc0ac\uc6a9\uc790 \uc815\uc758 \uc2e0\uace0 \uc0ac\uc720 \uad00\ub9ac"}),(0,i.jsx)("p",{className:"admin-section-desc",children:"\ubc95\uc548 \uae30\ubc18\uc774 \uc544\ub2cc, \uc0ac\uc6a9\uc790\uac00 \uc9c1\uc811 \ucd94\uac00\ud558\ub294 \uc2e0\uace0 \uc0ac\uc720 \ubaa9\ub85d\uc785\ub2c8\ub2e4. \ubc8c\uae08\uc561\uc744 0\uc73c\ub85c \uc124\uc815\ud558\uba74 \ubc8c\uae08 \uc5c6\uc774 \ucc98\ub9ac\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),(0,i.jsx)("div",{className:"reasons-list",children:r.map((e,s)=>(0,i.jsxs)("div",{className:"reason-item-editor",children:[(0,i.jsx)("input",{type:"text",value:e.reason,onChange:e=>o(s,"reason",e.target.value),placeholder:"\uc2e0\uace0 \uc0ac\uc720",className:"reason-input"}),(0,i.jsxs)("div",{className:"reason-amount-wrapper",children:[(0,i.jsx)("input",{type:"number",value:e.amount,onChange:e=>o(s,"amount",e.target.value),placeholder:"\ubc8c\uae08\uc561",className:"reason-amount-input",min:"0",step:"1000"}),(0,i.jsx)("span",{children:"\uc6d0"})]}),(0,i.jsx)("button",{onClick:()=>{return e=s,void(window.confirm("\uc774 \uc0ac\uc720\ub97c \uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&l(r.filter((s,t)=>t!==e)));var e},className:"reason-delete-button",children:"\uc0ad\uc81c"})]},s))}),(0,i.jsxs)("div",{className:"reason-actions",children:[(0,i.jsx)("button",{onClick:()=>{l([...r,{reason:"\uc0c8\ub85c\uc6b4 \uc0ac\uc720",amount:1e4,isLaw:!1}])},className:"reason-add-button",children:"\uc0ac\uc720 \ucd94\uac00"}),(0,i.jsx)("button",{onClick:()=>{r.some(e=>!e.reason.trim())?alert("\uc0ac\uc720 \uc774\ub984\uc740 \ube44\uc6cc\ub458 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."):t(r)},className:"reason-save-button",children:"\ubcc0\uacbd\uc0ac\ud56d \uc800\uc7a5"})]})]}),(0,i.jsxs)("div",{className:"admin-section danger-zone",children:[(0,i.jsx)("h3",{className:"admin-section-title danger-zone-title",children:"\uc704\ud5d8 \uad6c\uc5ed"}),(0,i.jsx)("p",{className:"admin-section-desc",children:"\uc8fc\uc758: \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc73c\ubbc0\ub85c \uc2e0\uc911\ud558\uac8c \uc9c4\ud589\ud574\uc8fc\uc138\uc694."}),(0,i.jsxs)("div",{className:"danger-zone-actions",children:[(0,i.jsxs)("p",{className:"danger-zone-p",children:[(0,i.jsx)("strong",{children:"\ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c"}),(0,i.jsx)("br",{}),"\ud604\uc7ac \ud559\uae09\uc5d0 \uc81c\ucd9c, \ucc98\ub9ac, \uc644\ub8cc\ub41c \ubaa8\ub4e0 \uc2e0\uace0 \ub0b4\uc5ed\uc744 \uc601\uad6c\uc801\uc73c\ub85c \uc0ad\uc81c\ud569\ub2c8\ub2e4."]}),(0,i.jsx)("button",{onClick:()=>{window.confirm("\uc815\ub9d0\ub85c \ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")&&a()},className:"danger-zone-button",children:"\ubaa8\ub4e0 \uae30\ub85d \uc0ad\uc81c"})]})]})]})};var p=t(577),h=t(5472);const x=e=>{let{complaint:s,onSave:t,onCancel:l,users:o}=e;const[c,d]=(0,n.useState)(s.reason),[m,u]=(0,n.useState)(s.desiredResolution),[p,h]=(0,n.useState)(s.defendantId),x=o.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name||e.displayName||e.id},e.id));return r.createPortal((0,i.jsx)("div",{className:"modal-overlay",onClick:l,children:(0,i.jsxs)("div",{className:"edit-modal-container modal-container",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsxs)("h3",{children:["\uace0\uc18c\uc7a5 \uc218\uc815 (ID: ",s.id.slice(-6),")"]}),(0,i.jsx)("button",{className:"close-button",onClick:l,children:"\xd7"})]}),(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"defendantSelectEdit",className:"form-label",children:"\ud53c\uace0\uc18c\uc778"}),(0,i.jsxs)("select",{id:"defendantSelectEdit",className:"form-select",value:p,onChange:e=>h(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"-- \uc120\ud0dd --"}),x]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"form-label",children:"\uace0\uc18c \uc0ac\uc720"}),(0,i.jsx)("textarea",{className:"form-textarea",value:c,onChange:e=>d(e.target.value),rows:5})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"form-label",children:"\uc6d0\ud558\ub294 \uacb0\uacfc"}),(0,i.jsx)("textarea",{className:"form-textarea",value:m,onChange:e=>u(e.target.value),rows:3})]})]}),(0,i.jsxs)("div",{className:"modal-footer",children:[(0,i.jsx)("button",{onClick:l,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,i.jsx)("button",{onClick:()=>{p&&c.trim()&&m.trim()?t((0,a.A)((0,a.A)({},s),{},{reason:c,desiredResolution:m,defendantId:p})):alert("\ubaa8\ub4e0 \ud544\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.")},className:"modal-button process",children:"\uc800\uc7a5"})]})]})}),document.getElementById("modal-root")||document.body)},j=e=>{let{complaint:s,onSave:t,onCancel:a}=e;const[l,o]=(0,n.useState)(s.judgment||"");return r.createPortal((0,i.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,i.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsxs)("h3",{children:["\ud310\uacb0\ubb38 \uc791\uc131 (ID: ",s.id.slice(-6),")"]}),(0,i.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,i.jsx)("div",{className:"modal-content",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"judgmentText",className:"form-label",children:"\ud310\uacb0 \ub0b4\uc6a9"}),(0,i.jsx)("textarea",{id:"judgmentText",className:"form-textarea judgment-textarea",value:l,onChange:e=>o(e.target.value),rows:10,placeholder:"\ud310\uacb0 \ub0b4\uc6a9\uc744 \uc0c1\uc138\ud788 \uc791\uc131\ud574\uc8fc\uc138\uc694..."})]})}),(0,i.jsxs)("div",{className:"modal-footer",children:[(0,i.jsx)("button",{onClick:a,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,i.jsx)("button",{onClick:()=>{l.trim()?t(s.id,l):alert("\ud310\uacb0 \ub0b4\uc6a9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},className:"modal-button process",children:"\ud310\uacb0 \uc800\uc7a5"})]})]})}),document.getElementById("modal-root")||document.body)},v=e=>{var s,t,a;let{complaint:r,users:o,onSave:c,onCancel:d,getUserNameById:m}=e;const u=r||{},[p,h]=(0,n.useState)((null===(s=u.amount)||void 0===s?void 0:s.toString())||""),[x,j]=(0,n.useState)(u.resolution||"\uc0c1\ud638 \ud569\uc758\uc5d0 \ub530\ub978 \ud569\uc758\uae08 \uc9c0\uae09"),[v,N]=(0,n.useState)(u.defendantId||u.reportedUserId||""),[g,f]=(0,n.useState)(u.complainantId||u.reporterId||""),b=null===(t=(0,l.As)().userDoc)||void 0===t?void 0:t.id;(0,n.useEffect)(()=>{console.log("SettlementModal\uc774 \ub80c\ub354\ub9c1\ub428",{complaintId:u.id,senderId:v,recipientId:g})},[u.id,v,g]);const y=o.filter(e=>e.id!==g),w=o.filter(e=>e.id!==v);return(0,i.jsx)("div",{className:"settlement-modal-overlay",onClick:d,children:(0,i.jsxs)("div",{className:"settlement-modal-safe-container",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"settlement-modal-header",children:[(0,i.jsxs)("h3",{children:["\ud569\uc758\uae08 \uc9c0\uae09 \ucc98\ub9ac (\uc0ac\uac74\ubc88\ud638: ",(null===(a=u.id)||void 0===a?void 0:a.slice(-6))||"\uc5c6\uc74c",")"]}),(0,i.jsx)("button",{className:"close-button",onClick:d,children:"\xd7"})]}),(0,i.jsxs)("div",{className:"settlement-modal-content",children:[(0,i.jsxs)("p",{className:"text-white mb-2",children:[(0,i.jsx)("strong",{children:"\uace0\uc18c\uc778:"})," ",m(g)]}),(0,i.jsxs)("p",{className:"text-white mb-4",children:[(0,i.jsx)("strong",{children:"\ud53c\uace0\uc18c\uc778:"})," ",m(v)]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"settlementSender",className:"form-label",children:"\uc1a1\uae08\uc790:"}),(0,i.jsxs)("select",{id:"settlementSender",className:"form-select",value:v,onChange:e=>N(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"-- \uc120\ud0dd --"}),y.map(e=>(0,i.jsx)("option",{value:e.id,children:m(e.id)},e.id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"settlementRecipient",className:"form-label",children:"\uc218\uae08\uc790:"}),(0,i.jsxs)("select",{id:"settlementRecipient",className:"form-select",value:g,onChange:e=>f(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"-- \uc120\ud0dd --"}),w.map(e=>(0,i.jsx)("option",{value:e.id,children:m(e.id)},e.id))]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"settlementAmount",className:"form-label",children:"\ud569\uc758\uae08 (\uc6d0):"}),(0,i.jsx)("input",{type:"number",id:"settlementAmount",className:"form-input",value:p,onChange:e=>h(e.target.value),placeholder:"\uae08\uc561 \uc785\ub825",min:"1"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"settlementReason",className:"form-label",children:"\ucc98\ub9ac \uc0ac\uc720:"}),(0,i.jsx)("textarea",{id:"settlementReason",className:"form-textarea",value:x,onChange:e=>j(e.target.value),rows:"3",placeholder:"\uc608: \uc0c1\ud638 \uc6d0\ub9cc\ud55c \ud569\uc758"})]})]}),(0,i.jsxs)("div",{className:"settlement-modal-footer",children:[(0,i.jsx)("button",{onClick:d,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,i.jsx)("button",{onClick:async()=>{if(console.log("Settlement Modal - handleSave \ud638\ucd9c\ub428",{reportId:u.id,amount:p,senderId:v,recipientId:g,reason:x}),u.id)if(!p||isNaN(parseInt(p))||parseInt(p)<=0)alert("\uc720\ud6a8\ud55c \ud569\uc758 \uae08\uc561\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.");else if(v&&g)if(v!==g)try{await c(u.id,parseInt(p),v,g,x,b)}catch(e){console.error("Settlement Modal - \uc800\uc7a5 \uc911 \uc624\ub958:",e),alert("\uc624\ub958 \ubc1c\uc0dd: ".concat(e.message))}else alert("\uc1a1\uae08\uc790\uc640 \uc218\uae08\uc790\ub294 \uac19\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");else alert("\uc1a1\uae08\uc790\uc640 \uc218\uae08\uc790\ub97c \ubaa8\ub450 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");else alert("\uc624\ub958: \uc0ac\uac74 ID\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc5b4 \ucc98\ub9ac\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},className:"modal-button process",children:"\uc9c0\uae09 \ucc98\ub9ac"})]})]})})},N=[{reason:"\uae09\uc2dd\uc2e4 \uc0c8\uce58\uae30",amount:3e4,isLaw:!1},{reason:"\uc2e4\ub0b4\uc5d0\uc11c \uc2e0\ubc1c\uc2e0\uae30",amount:3e4,isLaw:!1},{reason:"\uc6b4\ub3d9\uc7a5\uc5d0\uc11c \uc2e4\ub0b4\ud654 \uc2e0\uae30",amount:3e4,isLaw:!1},{reason:"\uc695\uc124 \uc0ac\uc6a9",amount:5e4,isLaw:!1},{reason:"\uce5c\uad6c \uac74\ub4e4\uae30/\ub54c\ub9ac\uae30",amount:1e5,isLaw:!1},{reason:"\uc2dc\ube44 \uac78\uae30",amount:7e4,isLaw:!1},{reason:"\uae30\ud0c0",amount:0,isLaw:!1}],g=()=>{const e=(0,l.As)(),s=e.userDoc,t=null===s||void 0===s?void 0:s.id,r=null===s||void 0===s?void 0:s.classCode,g=!e.loading&&(e.isAdmin?e.isAdmin():(null===s||void 0===s?void 0:s.isAdmin)||!1),[f,b]=(0,n.useState)("submit"),[y,w]=(0,n.useState)("submit"),[I,C]=(0,n.useState)([]),[S,D]=(0,n.useState)([]),[R,k]=(0,n.useState)(!0),[A,L]=(0,n.useState)(!1),[U,B]=(0,n.useState)(null),[E,F]=(0,n.useState)(!1),[M,O]=(0,n.useState)(null),[T,_]=(0,n.useState)(!1),[q,J]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!document.getElementById("modal-root")){const e=document.createElement("div");e.id="modal-root",document.body.appendChild(e)}},[]);const P=(0,n.useCallback)(e=>{if(!S||0===S.length)return e||"\uc815\ubcf4 \uc5c6\uc74c";const s=S.find(s=>s.id===e);return(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.displayName)||e||"\uc54c \uc218 \uc5c6\uc74c"},[S]),H=e=>{if(!e)return"N/A";try{const s="function"===typeof e.toDate?e.toDate():new Date(e);return isNaN(s.getTime())?"\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \ub0a0\uc9dc":s.toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})}catch(s){return console.error("Error formatting date:",e,s),"\ub0a0\uc9dc \uc624\ub958"}},z=(0,n.useMemo)(()=>{var s;return!r||(null===(s=e.classmates)||void 0===s?void 0:s.length)>0?null:(0,h.query)((0,h.rJ)(o.db,"users"),(0,h.where)("classCode","==",r))},[r,e.classmates]),{data:Z,loading:V}=(0,p.nm)(async()=>{if(!z)return null;return(await(0,h.getDocs)(z)).docs.map(e=>(0,a.A)({id:e.id},e.data()))},{interval:18e5,enabled:!!z&&!e.loading,deps:[r,e.loading,z]});(0,n.useEffect)(()=>{if(e.loading)k(!0);else if(e.classmates&&e.classmates.length>0){const t=e.classmates;s&&!t.find(e=>e.id===s.id)&&t.push((0,a.A)({id:s.id,name:s.name,displayName:s.displayName},s)),D(t),k(!1)}else r?Z?(D(Z),k(V)):k(V):(D([]),k(!1))},[e.loading,e.classmates,r,s,Z,V]);const W=(0,n.useMemo)(()=>{if(!r)return null;const e=(0,h.rJ)(o.db,"jobs");return(0,h.query)(e,(0,h.where)("classCode","==",r))},[r]),{data:K,loading:X}=(0,p.nm)(async()=>{if(!W)return[];return(await(0,h.getDocs)(W)).docs.map(e=>(0,a.A)({id:e.id},e.data()))},{interval:18e5,enabled:!!r,deps:[r]}),G=(0,n.useMemo)(()=>{if(null===s||void 0===s||!s.selectedJobIds||!K)return!1;return K.filter(e=>s.selectedJobIds.includes(e.id)).some(e=>"\uacbd\ucc30\uccad\uc7a5"===e.title)},[null===s||void 0===s?void 0:s.selectedJobIds,K]),Q=g||G,Y=(0,n.useMemo)(()=>r?(0,h.H9)(o.db,(e=>"nationalTreasuries/".concat(e))(r)):null,[r]),{data:$,loading:ee}=(0,p.nm)(async()=>{if(!Y)return 0;const e=await(0,h.x7)(Y),s=e.exists()&&e.data().totalAmount||0;return!e.exists()&&Q&&(0,h.BN)(Y,{totalAmount:0,stockTaxRevenue:0,stockCommissionRevenue:0,realEstateTransactionTaxRevenue:0,realEstateAnnualTaxRevenue:0,incomeTaxRevenue:0,corporateTaxRevenue:0,otherTaxRevenue:0,classCode:r,createdAt:(0,h.O5)(),lastUpdated:(0,h.O5)()}).catch(e=>console.error("Error creating national treasury:",e)),s},{interval:9e5,enabled:!!r&&!e.loading,deps:[r,e.loading,Q]}),se=(0,n.useMemo)(()=>{if(!r)return null;const e=(0,h.rJ)(o.db,"classes",r,"nationalAssemblyLaws");return(0,h.query)(e,(0,h.where)("finalStatus","==","final_approved"),(0,h.orderBy)("timestamp","desc"),(0,h.AB)(50))},[r]),{data:te,loading:ae}=(0,p.nm)(async()=>{if(!se)return[];return(await(0,h.getDocs)(se)).docs.map(e=>(0,a.A)({id:e.id},e.data()))},{interval:18e5,enabled:!!r,deps:[r]}),ne=(0,n.useMemo)(()=>r?(0,h.H9)(o.db,"classes",r,"policeReportReasons","custom"):null,[r]),{data:re,loading:le}=(0,p.nm)(async()=>{if(!ne)return[...N.filter(e=>!e.isLaw)];const e=await(0,h.x7)(ne);let s;return e.exists()&&e.data().reasons?s=e.data().reasons:(s=N.filter(e=>!e.isLaw),Q&&(0,h.BN)(ne,{reasons:s,updatedAt:(0,h.O5)(),classCode:r}).catch(e=>console.error("Error creating default custom reasons:",e))),s},{interval:36e5,enabled:!!r,deps:[r,Q]});(0,n.useEffect)(()=>{if(ae||le)return;const e=re||[],s=(te||[]).map(e=>{var s;const t=null===(s=e.fine)||void 0===s?void 0:s.match(/\d+/g),a=t?parseInt(t.join(""),10):1e4;return{reason:"[\ubc95\uc548] ".concat(e.title," \uc704\ubc18"),description:e.description||"",amount:a,lawId:e.id,isLaw:!0}});C([...s,...e])},[te,re,ae,le]);const oe=(0,n.useMemo)(()=>{if(!r)return null;const e=(0,h.rJ)(o.db,"classes",r,"policeReports");return(0,h.query)(e,(0,h.orderBy)("submitDate","desc"),(0,h.AB)(100))},[r]),{data:ie,loading:ce,refetch:de}=(0,p.nm)(async()=>{if(!oe)return[];return(await(0,h.getDocs)(oe)).docs.map(e=>{var s,t,n;const r=e.data();return(0,a.A)((0,a.A)({id:e.id},r),{},{submitDate:null!==(s=r.submitDate)&&void 0!==s&&s.toDate?r.submitDate.toDate().toISOString():null,acceptanceDate:null!==(t=r.acceptanceDate)&&void 0!==t&&t.toDate?r.acceptanceDate.toDate().toISOString():null,resolutionDate:null!==(n=r.resolutionDate)&&void 0!==n&&n.toDate?r.resolutionDate.toDate().toISOString():null})})},{interval:6e5,enabled:!!r,deps:[r]}),me=e=>{w(f),b(e)},ue=()=>{b("admin"!==y?y:"submit")},pe=async e=>{if(!t||!r)return void alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud558\uac70\ub098 \ud559\uae09 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!e.reportedUserId||!e.reason)return void alert("\uc2e0\uace0 \ub300\uc0c1\uacfc \uc0ac\uc720\ub97c \ubaa8\ub450 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");const n=I.find(s=>s.reason===e.reason),l=(0,h.rJ)(o.db,"classes",r,"policeReports"),i=(0,a.A)((0,a.A)({},e),{},{reporterId:t,complainantId:t,reporterName:s.name||s.displayName||"\uc775\uba85",submitDate:(0,h.O5)(),status:"submitted",amount:(null===n||void 0===n?void 0:n.amount)||0,isLawReport:(null===n||void 0===n?void 0:n.isLaw)||!1,description:(null===n||void 0===n?void 0:n.description)||e.reason,lawId:(null===n||void 0===n?void 0:n.lawId)||null,classCode:r,acceptanceDate:null,resolution:null,resolutionDate:null,processedById:null,processedByName:null,settlementPaid:!1,defendantId:e.reportedUserId});try{await(0,h.addDoc)(l,i),de(),me("status"),alert("\uc2e0\uace0\uac00 \uc131\uacf5\uc801\uc73c\ub85c \uc81c\ucd9c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(c){console.error("Error adding report:",c),alert("\uc2e0\uace0 \uc81c\ucd9c \uc624\ub958.")}},he=async e=>{if(console.log("handleAcceptReport \ud638\ucd9c\ub428:",e),!Q||!r||!t)return void alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \uc815\ubcf4\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4.");const a=(0,h.H9)(o.db,"classes",r,"policeReports",e);try{await(0,h.mZ)(a,{status:"accepted",acceptanceDate:(0,h.O5)(),processedById:t,processedByName:s.name||s.displayName||"\uad00\ub9ac\uc790"}),de(),console.log("\uc2e0\uace0 \uc811\uc218 \uc131\uacf5:",e),alert("\uc2e0\uace0\uac00 \uc811\uc218\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(n){console.error("Error accepting report:",n),alert("\uc2e0\uace0 \uc811\uc218 \uc624\ub958.")}},xe=async e=>{if(console.log("handleDismissReport \ud638\ucd9c\ub428:",e),!Q||!r||!t)return void alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \uc815\ubcf4\uac00 \ubd80\uc871\ud569\ub2c8\ub2e4.");const a=(0,h.H9)(o.db,"classes",r,"policeReports",e);try{await(0,h.mZ)(a,{status:"dismissed",resolution:"\uc2e0\uace0 \ubc18\ub824/\uae30\uac01",resolutionDate:(0,h.O5)(),processedById:t,processedByName:s.name||s.displayName||"\uad00\ub9ac\uc790"}),de(),console.log("\uc2e0\uace0 \ubc18\ub824 \uc131\uacf5:",e),alert("\uc2e0\uace0\uac00 \ubc18\ub824\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(n){console.error("Error dismissing report:",n),alert("\uc2e0\uace0 \ubc18\ub824 \uc624\ub958.")}},je=async(e,a,n)=>{if(console.log("handleProcessReport \ud638\ucd9c\ub428:",{id:e,processingAmount:a,processingReason:n}),!Q||!t||!r)return void alert("\uad8c\ud55c \ub610\ub294 \uc815\ubcf4 \ubd80\uc871");const l=ie.find(s=>s.id===e);if(!l)return void alert("\uc2e0\uace0\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if("accepted"!==l.status)return void alert("\uc811\uc218\ub41c \uc2e0\uace0\ub9cc \ucc98\ub9ac \uac00\ub2a5\ud569\ub2c8\ub2e4.");const i=parseInt(a,10);if(isNaN(i)||i<0)return void alert("\uc720\ud6a8\ud55c \uae08\uc561(0 \uc774\uc0c1) \uc785\ub825 \ud544\uc694");let c=n||"\ubc8c\uae08 \ubd80\uacfc \ucc98\ub9ac";l.isLawReport&&l.description&&(c="".concat(n||"\ubc95\uc548 \uc704\ubc18",": ").concat(l.description));const d=(0,h.H9)(o.db,"classes",r,"policeReports",e);if(i>0){const a=l.reportedUserId||l.defendantId;try{const n="\uacbd\ucc30\uc11c \uc2e0\uace0 (\uc0ac\uac74\ubc88\ud638: ".concat(e.slice(-6),")\uc5d0 \ub300\ud55c \ubc8c\uae08 ").concat(i.toLocaleString(),"\uc6d0 \ub0a9\ubd80");await(0,o.ef)(a,r,i,n),await(0,h.mZ)(d,{status:"resolved_fine",resolutionDate:(0,h.O5)(),resolution:c,amount:i,processedById:t,processedByName:s.name||s.displayName||"\uad00\ub9ac\uc790"}),de(),alert("\ubc8c\uae08 \ucc98\ub9ac\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(m){return console.error("\ubc8c\uae08 \ucc98\ub9ac \ud2b8\ub79c\uc7ad\uc158 \uc624\ub958:",m),void alert("\ubc8c\uae08 \ucc98\ub9ac \uc2e4\ud328: ".concat(m.message))}}else try{await(0,h.mZ)(d,{status:"resolved_fine",resolutionDate:(0,h.O5)(),resolution:c,amount:0,processedById:t,processedByName:s.name||s.displayName||"\uad00\ub9ac\uc790"}),de(),alert("\uacbd\uace0 \ucc98\ub9ac\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}catch(m){console.error("\ubc8c\uae08 0\uc6d0 \ucc98\ub9ac \uc624\ub958:",m),alert("\ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},ve=async()=>{if(!Q||!r)return alert("\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");if(window.confirm("\ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c?"))try{const e=(0,h.rJ)(o.db,"classes",r,"policeReports"),s=await(0,h.getDocs)(e),t=(0,h.wP)(o.db);s.docs.forEach(e=>t.delete(e.ref)),await t.commit(),alert("\ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c \uc644\ub8cc.")}catch(e){console.error("Error deleting all reports:",e),alert("\ubaa8\ub4e0 \uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c \uc624\ub958.")}},Ne=async e=>{if(!Q||!r)return alert("\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");if(ie.find(s=>s.id===e)&&window.confirm("\uc0ac\uac74\ubc88\ud638 ".concat(e.slice(-6)," \uc0ad\uc81c?")))try{const s=(0,h.H9)(o.db,"classes",r,"policeReports",e);await(0,h.kd)(s),alert("\uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c \uc644\ub8cc.")}catch(s){console.error("Error deleting report:",s),alert("\uc2e0\uace0 \uae30\ub85d \uc0ad\uc81c \uc624\ub958.")}},ge=e=>{if(!Q)return;const s=ie.find(s=>s.id===e);s&&(!s.defendantId&&s.reportedUserId&&(s.defendantId=s.reportedUserId),B(s),L(!0))},fe=async e=>{if(!Q||!r)return alert("\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");if(Array.isArray(e)&&!e.some(e=>"object"!==typeof e||!e.reason||"number"!==typeof e.amount))try{const s=(0,h.H9)(o.db,"classes",r,"policeReportReasons","custom");await(0,h.BN)(s,{reasons:e,updatedAt:(0,h.O5)(),classCode:r}),alert("\uc0ac\uc6a9\uc790 \uc815\uc758 \uc2e0\uace0 \uc0ac\uc720 \uc5c5\ub370\uc774\ud2b8 \uc644\ub8cc.")}catch(s){console.error("Error updating reasons:",s),alert("\uc2e0\uace0 \uc0ac\uc720 \uc5c5\ub370\uc774\ud2b8 \uc624\ub958.")}else alert("\uc2e0\uace0 \uc0ac\uc720 \ub370\uc774\ud130 \ud615\uc2dd \uc624\ub958.")},be=e=>{if(console.log("handleOpenSettlementModal \ud638\ucd9c\ub428:",e),!e||!e.id)return console.error("\ud569\uc758 \ucc98\ub9ac \uc624\ub958: \uc720\ud6a8\ud55c \uc0ac\uac74 \uac1d\uccb4\ub97c \uc804\ub2ec\ubc1b\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.",e),void alert("\uc624\ub958: \uc0ac\uac74 \uc815\ubcf4\ub97c \ucc3e\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4. \ud398\uc774\uc9c0\ub97c \uc0c8\ub85c\uace0\uce68 \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc138\uc694.");const s=(0,a.A)((0,a.A)({},e),{},{complainantId:e.complainantId||e.reporterId,defendantId:e.defendantId||e.reportedUserId});if(!s.complainantId||!s.defendantId)return console.error("\ud569\uc758 \ucc98\ub9ac \uc624\ub958: \uace0\uc18c\uc778 \ub610\ub294 \ud53c\uace0\uc18c\uc778 \uc815\ubcf4\uac00 \ub204\ub77d\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",s),void alert("\uc624\ub958: \uace0\uc18c\uc778 \ub610\ub294 \ud53c\uace0\uc18c\uc778 \uc815\ubcf4\uac00 \uc5c6\ub294 \uc0ac\uac74\uc740 \ucc98\ub9ac\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");console.log("\ud569\uc758 \ubaa8\ub2ec \uc5f4\uae30 \uc900\ube44 \uc644\ub8cc, \uc0c1\ud0dc \uc5c5\ub370\uc774\ud2b8 \uc9c1\uc804:",s),J(s),_(!0)},ye=(0,n.useMemo)(()=>R||ce||!ie?ie||[]:ie.map(e=>(0,a.A)((0,a.A)({},e),{},{reporterName:P(e.reporterId),reportedUserName:P(e.reportedUserId||e.defendantId),processedByName:e.processedById?P(e.processedById):null})),[ie,S,R,ce,P]),we=(0,n.useMemo)(()=>ye.filter(e=>"submitted"===e.status||"accepted"===e.status),[ye]),Ie=(0,n.useMemo)(()=>ye.filter(e=>e.status.startsWith("resolved_")||"dismissed"===e.status).sort((e,s)=>{const t=e.resolutionDate||e.submitDate,a=s.resolutionDate||s.submitDate,n="function"===typeof(null===t||void 0===t?void 0:t.toDate)?t.toDate().getTime():new Date(t).getTime();return("function"===typeof(null===a||void 0===a?void 0:a.toDate)?a.toDate().getTime():new Date(a).getTime())-n}),[ye]);if(e.loading)return(0,i.jsx)("div",{className:"police-container",children:(0,i.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"\uc0ac\uc6a9\uc790 \uc778\uc99d \uc815\ubcf4\ub97c \ud655\uc778 \uc911\uc785\ub2c8\ub2e4..."})});if(!s)return(0,i.jsx)("div",{className:"police-container",children:(0,i.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4. \uacbd\ucc30\uc11c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud558\ub824\uba74 \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694."})});if(!r&&!Q)return(0,i.jsx)("div",{className:"police-container",children:(0,i.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"\uacbd\ucc30\uc11c \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud558\ub824\uba74 \ud559\uae09 \ucf54\ub4dc\uac00 \uc0ac\uc6a9\uc790 \uc815\ubcf4\uc5d0 \uc124\uc815\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4. \ud504\ub85c\ud544\uc5d0\uc11c \ud559\uae09 \ucf54\ub4dc\ub97c \uc124\uc815\ud574\uc8fc\uc138\uc694."})});if(r&&(R||ee||ae||X||le||ce))return(0,i.jsx)("div",{className:"police-container",children:(0,i.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"\ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})});if(Q&&!r&&"admin"!==f)return(0,i.jsxs)("div",{className:"police-container loading",children:["\uad00\ub9ac\uc790\ub2d8, \ud604\uc7ac \ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \uc774 \ud0ed\uc758 \ub0b4\uc6a9\uc744 \ubcfc \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uad00\ub9ac\uc790 \uc124\uc815\uc744 \ud655\uc778\ud558\uac70\ub098 \ud504\ub85c\ud544\uc5d0\uc11c \ud559\uae09 \ucf54\ub4dc\ub97c \uc124\uc815\ud574\uc8fc\uc138\uc694.",(0,i.jsx)("button",{onClick:()=>b("admin"),children:"\uad00\ub9ac\uc790 \uc124\uc815\uc73c\ub85c \uc774\ub3d9"})]});const Ce=()=>{if(!r&&!Q&&"admin"!==f)return(0,i.jsx)("p",{className:"empty-state",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc5b4 \uc788\uc9c0 \uc54a\uc544 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."});switch(f){case"submit":return r?(0,i.jsx)(c,{onSubmitReport:pe,reportReasons:I,users:S.filter(e=>e.id!==t),currentUser:s}):(0,i.jsx)("p",{className:"empty-state",children:"\uc2e0\uace0\ub97c \uc81c\ucd9c\ud560 \ud559\uae09\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."});case"status":return r?(0,i.jsx)(d,{reports:we,onProcessReport:je,onSettlement:be,reportReasons:I,formatDate:H,onAcceptReport:he,onDismissReport:xe,currentUser:s,isAdminView:Q,users:S}):(0,i.jsx)("p",{className:"empty-state",children:"\ucc98\ub9ac \ud604\ud669\uc744 \ubcfc \ud559\uae09\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."});case"results":return r?(0,i.jsx)(m,{reports:Ie,formatDate:H,isAdminView:Q,onEditReport:ge,onDeleteReport:Ne,users:S,getUserNameById:P,isAdmin:Q}):(0,i.jsx)("p",{className:"empty-state",children:"\ucc98\ub9ac \uacb0\uacfc\ub97c \ubcfc \ud559\uae09\uc774 \uc124\uc815\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."});case"admin":return(0,i.jsxs)("div",{className:"police-admin-content",children:[(0,i.jsx)("div",{className:"admin-nav-buttons",children:(0,i.jsx)("button",{onClick:ue,className:"back-to-police-button",children:"\uacbd\ucc30\uc11c\ub85c \ub3cc\uc544\uac00\uae30"})}),(0,i.jsx)(u,{reportReasons:re,onUpdateReasons:fe,onDeleteAllReports:r?ve:()=>alert("\ubaa8\ub4e0 \uc2e0\uace0 \uc0ad\uc81c\ub294 \ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub41c \ud6c4 \uac00\ub2a5\ud569\ub2c8\ub2e4.")}),(0,i.jsxs)("div",{className:"law-reasons-info",children:[(0,i.jsx)("h3",{children:"\ubc95\uc548 \uae30\ubc18 \uc2e0\uace0 \uc0ac\uc720 (\uc790\ub3d9 \uc5c5\ub370\uc774\ud2b8)"}),r?I.filter(e=>e.isLaw).length>0?(0,i.jsx)("div",{className:"law-reasons-list",children:I.filter(e=>e.isLaw).map((e,s)=>(0,i.jsxs)("div",{className:"law-reason-item",children:[(0,i.jsx)("div",{className:"reason-name",children:e.reason}),e.description&&(0,i.jsx)("div",{className:"reason-description",children:e.description}),(0,i.jsxs)("div",{className:"reason-amount",children:["\ubc8c\uae08: ",e.amount.toLocaleString(),"\uc6d0"]})]},s))}):(0,i.jsx)("p",{className:"empty-state",children:"\ud604\uc7ac \ud559\uae09\uc5d0 \uac00\uacb0\ub41c \ubc95\uc548\uc774 \uc5c6\uac70\ub098, \ubd88\ub7ec\uc624\ub294 \uc911\uc785\ub2c8\ub2e4."}):(0,i.jsx)("p",{className:"empty-state",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc544 \ubc95\uc548 \uae30\ubc18 \uc2e0\uace0 \uc0ac\uc720\ub97c \ubcfc \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]});default:return(0,i.jsx)("p",{children:"\ud0ed\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694."})}};return(0,i.jsxs)("div",{className:"police-container",children:[(e.loading||r&&(R||ce||ee||ae||X||le))&&(0,i.jsx)("div",{className:"loading-overlay-transparent",children:"\ub370\uc774\ud130 \ub3d9\uae30\ud654 \uc911..."}),(0,i.jsxs)("div",{className:"police-header-container",children:[(0,i.jsxs)("h1",{className:"police-header",children:["\uacbd\ucc30\uc11c ",r&&"(\ud559\uae09: ".concat(r,")")]}),(0,i.jsxs)("div",{className:"header-info",children:[s&&(0,i.jsxs)("span",{className:"welcome-message",children:["\ud658\uc601\ud569\ub2c8\ub2e4,"," ",s.name||s.displayName||s.id,"\ub2d8!"]}),(0,i.jsxs)("span",{className:"treasury-balance",children:["\ud604\uc7ac \uad6d\uace0 \uc794\uc561: ",($||0).toLocaleString(),"\uc6d0"]}),Q&&(0,i.jsx)("button",{onClick:()=>me("admin"),className:"admin-settings-button ".concat("admin"===f?"active":""),title:"\uad00\ub9ac \uc124\uc815 \uc5f4\uae30",children:"\uad00\ub9ac \uc124\uc815"})]})]}),"admin"!==f?(0,i.jsx)(i.Fragment,{children:r?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"police-tabs",children:[(0,i.jsx)("button",{onClick:()=>me("submit"),className:"police-tab-button ".concat("submit"===f?"active":""),children:"\uc2e0\uace0\ud558\uae30"}),(0,i.jsxs)("button",{onClick:()=>me("status"),className:"police-tab-button ".concat("status"===f?"active":""),children:["\ucc98\ub9ac \ud604\ud669 (",we.length,")"]}),(0,i.jsxs)("button",{onClick:()=>me("results"),className:"police-tab-button ".concat("results"===f?"active":""),children:["\ucc98\ub9ac \uacb0\uacfc (",Ie.length,")"]})]}),(0,i.jsx)("div",{className:"police-tab-content",children:Ce()})]}):!Q&&(0,i.jsx)("div",{className:"empty-state",children:"\ud559\uae09 \ucf54\ub4dc\uac00 \uc124\uc815\ub418\uc5b4\uc57c \uacbd\ucc30\uc11c \uae30\ub2a5\uc744 \uc774\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."})}):Q?Ce():(0,i.jsx)("div",{className:"empty-state",children:"\uad00\ub9ac\uc790\ub9cc \uc811\uadfc \uac00\ub2a5\ud569\ub2c8\ub2e4."}),A&&U&&(0,i.jsx)(x,{complaint:U,onSave:async e=>{if(!Q||!r)return void alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \ud559\uae09 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const s=(0,h.H9)(o.db,"classes",r,"policeReports",e.id);try{await(0,h.mZ)(s,{reason:e.reason,desiredResolution:e.desiredResolution,defendantId:e.defendantId,reportedUserId:e.defendantId}),de(),alert("\uace0\uc18c\uc7a5 \uc815\ubcf4\uac00 \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),L(!1),B(null)}catch(t){console.error("\uace0\uc18c\uc7a5 \uc5c5\ub370\uc774\ud2b8 \uc624\ub958:",t),alert("\uace0\uc18c\uc7a5 \uc815\ubcf4 \uc5c5\ub370\uc774\ud2b8\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},onCancel:()=>{L(!1),B(null)},users:S.filter(e=>e.id!==(U.complainantId||U.reporterId)&&e.classCode===r)}),E&&M&&(0,i.jsx)(j,{complaint:M,onSave:async(e,s)=>{if(!Q||!r)return void alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \ud559\uae09 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const t=(0,h.H9)(o.db,"classes",r,"policeReports",e);try{await(0,h.mZ)(t,{judgment:s}),de(),alert("\ud310\uacb0 \ub0b4\uc6a9\uc774 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),F(!1),O(null)}catch(a){console.error("\ud310\uacb0 \uc800\uc7a5 \uc624\ub958:",a),alert("\ud310\uacb0 \ub0b4\uc6a9 \uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},onCancel:()=>{F(!1),O(null)}}),T&&q&&(0,i.jsx)(v,{complaint:q,users:S,onSave:async(e,s,t,a,n,l)=>{if(console.log("handleSendSettlement \ud638\ucd9c\ub428 (Cloud Function):",{reportId:e,amount:s,senderId:t,recipientId:a,reason:n,adminId:l}),!Q||!r)return alert("\uad8c\ud55c\uc774 \uc5c6\uac70\ub098 \ud559\uae09 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),!1;try{const r=await(0,o.Xz)({reportId:e,amount:s,senderId:t,recipientId:a,reason:n,adminId:l});if(r.success)return alert(r.message||"\ud569\uc758\uae08 \uc9c0\uae09 \ucc98\ub9ac\uac00 \uc131\uacf5\uc801\uc73c\ub85c \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),de(),_(!1),J(null),!0;throw new Error(r.message||"\uc11c\ubc84\uc5d0\uc11c \ucc98\ub9ac\ub97c \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}catch(i){return console.error("\ud569\uc758\uae08 \ucc98\ub9ac \uc2e4\ud328 (Cloud Function):",i),alert("\uc624\ub958: ".concat(i.message||"\ud569\uc758\uae08 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")),!1}},onCancel:()=>{_(!1),J(null)},getUserNameById:P})]})}}}]);
//# sourceMappingURL=44.76518454.chunk.js.map