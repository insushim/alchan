{"version":3,"file":"static/js/771.4a257692.chunk.js","mappings":"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","sources":["pages/games/GonuGame.js"],"sourcesContent":["// src/GonuGame.js - 실제 고누 규칙 적용 + AI 모드\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { db } from '../../firebase';\r\nimport {\r\n    doc,\r\n    setDoc,\r\n    getDoc,\r\n    runTransaction,\r\n    increment,\r\n    serverTimestamp,\r\n    collection,\r\n    query,\r\n    where,\r\n    getDocs,\r\n    deleteDoc\r\n} from 'firebase/firestore';\r\nimport { usePolling } from '../../hooks/usePolling';\r\nimport { logActivity, ACTIVITY_TYPES } from '../../utils/firestoreHelpers';\r\nimport './GonuGame.css';\r\nimport { AlchanLoading } from '../../components/AlchanLayout';\r\n\r\n// ═══════════════════════════════════════════════════════════════\r\n// 우물고누 정의 (가장 기본적인 고누)\r\n// 동그라미 안에 X 표시 형태, 각자 2개의 말\r\n// ═══════════════════════════════════════════════════════════════\r\n\r\n// 우물고누 노드 배치 (5개의 점)\r\n// 실제 우물고누 말판: 원 안에 X자\r\n//     0\r\n//    /|\\\r\n//   1-+-3   (중앙 2는 우물 - 이동 불가)\r\n//    \\|/\r\n//     4\r\nconst UMUL_NODES = [\r\n    { id: 0, x: 150, y: 40 },   // 상단\r\n    { id: 1, x: 40, y: 150 },   // 좌측\r\n    { id: 2, x: 150, y: 150 },  // 중앙 (우물 - 이동 불가)\r\n    { id: 3, x: 260, y: 150 },  // 우측\r\n    { id: 4, x: 150, y: 260 },  // 하단\r\n];\r\n\r\n// 우물고누 연결 (선) - X자 + 테두리\r\nconst UMUL_EDGES = [\r\n    [0, 1], [0, 3],  // 상단에서 좌우 대각선\r\n    [1, 4], [3, 4],  // 하단으로 대각선\r\n    [0, 4],          // 상하 세로선\r\n    [1, 3],          // 좌우 가로선\r\n];\r\n\r\n// 우물고누에서 이동 가능한 연결 (선을 따라 이동, 우물 제외)\r\nconst UMUL_VALID_MOVES = {\r\n    0: [1, 3, 4],    // 상단: 좌측, 우측, 하단으로\r\n    1: [0, 3, 4],    // 좌측: 상단, 우측, 하단으로\r\n    3: [0, 1, 4],    // 우측: 상단, 좌측, 하단으로\r\n    4: [0, 1, 3],    // 하단: 상단, 좌측, 우측으로\r\n};\r\n\r\n// ═══════════════════════════════════════════════════════════════\r\n// 호박고누 정의\r\n// 출발선 부분이 있는 말판, 각자 3개의 말\r\n// ═══════════════════════════════════════════════════════════════\r\n\r\n// 호박고누 노드 배치 (10개의 점)\r\n//   0       (흑 출발선)\r\n//   |\r\n//   1---2---3\r\n//   |\\ /|\\ /|\r\n//   4--5--6\r\n//   |/ \\|/ \\|\r\n//   7---8---9\r\n//   |\r\n//   10      (적 출발선)\r\n\r\nconst HOBAK_NODES = [\r\n    { id: 0, x: 150, y: 20, isHome: 'B' },   // 흑 출발선\r\n    { id: 1, x: 50, y: 80 },\r\n    { id: 2, x: 150, y: 80 },\r\n    { id: 3, x: 250, y: 80 },\r\n    { id: 4, x: 50, y: 160 },\r\n    { id: 5, x: 150, y: 160 },  // 중앙\r\n    { id: 6, x: 250, y: 160 },\r\n    { id: 7, x: 50, y: 240 },\r\n    { id: 8, x: 150, y: 240 },\r\n    { id: 9, x: 250, y: 240 },\r\n    { id: 10, x: 150, y: 300, isHome: 'R' },  // 적 출발선\r\n];\r\n\r\n// 호박고누 연결 (선)\r\nconst HOBAK_EDGES = [\r\n    [0, 2],                      // 출발선 연결\r\n    [1, 2], [2, 3],              // 상단 가로\r\n    [1, 4], [2, 5], [3, 6],      // 세로\r\n    [4, 5], [5, 6],              // 중앙 가로\r\n    [4, 7], [5, 8], [6, 9],      // 세로\r\n    [7, 8], [8, 9],              // 하단 가로\r\n    [8, 10],                     // 출발선 연결\r\n    // 대각선\r\n    [1, 5], [2, 4], [2, 6], [3, 5],\r\n    [4, 8], [5, 7], [5, 9], [6, 8],\r\n];\r\n\r\n// 호박고누에서 이동 가능한 연결 (인접 리스트)\r\nconst HOBAK_ADJACENCY = {\r\n    0: [2],\r\n    1: [2, 4, 5],\r\n    2: [0, 1, 3, 4, 5, 6],\r\n    3: [2, 5, 6],\r\n    4: [1, 2, 5, 7, 8],\r\n    5: [1, 2, 3, 4, 6, 7, 8, 9],\r\n    6: [2, 3, 5, 8, 9],\r\n    7: [4, 5, 8],\r\n    8: [4, 5, 6, 7, 9, 10],\r\n    9: [5, 6, 8],\r\n    10: [8],\r\n};\r\n\r\n// ═══════════════════════════════════════════════════════════════\r\n// 밭고누 (네줄고누) 정의\r\n// 4x4 격자, 각자 4개의 말, 3연속 만들면 상대 말 제거\r\n// ═══════════════════════════════════════════════════════════════\r\n\r\n// 밭고누 노드 배치 (16개의 점, 4x4 격자)\r\nconst BAT_NODES = [];\r\nfor (let row = 0; row < 4; row++) {\r\n    for (let col = 0; col < 4; col++) {\r\n        BAT_NODES.push({\r\n            id: row * 4 + col,\r\n            x: 60 + col * 80,\r\n            y: 60 + row * 80,\r\n            row: row,\r\n            col: col\r\n        });\r\n    }\r\n}\r\n\r\n// 밭고누 연결 (가로, 세로, 대각선)\r\nconst BAT_EDGES = [];\r\n// 가로 연결\r\nfor (let row = 0; row < 4; row++) {\r\n    for (let col = 0; col < 3; col++) {\r\n        BAT_EDGES.push([row * 4 + col, row * 4 + col + 1]);\r\n    }\r\n}\r\n// 세로 연결\r\nfor (let row = 0; row < 3; row++) {\r\n    for (let col = 0; col < 4; col++) {\r\n        BAT_EDGES.push([row * 4 + col, (row + 1) * 4 + col]);\r\n    }\r\n}\r\n// 대각선 연결 (오른쪽 아래)\r\nfor (let row = 0; row < 3; row++) {\r\n    for (let col = 0; col < 3; col++) {\r\n        BAT_EDGES.push([row * 4 + col, (row + 1) * 4 + col + 1]);\r\n    }\r\n}\r\n// 대각선 연결 (왼쪽 아래)\r\nfor (let row = 0; row < 3; row++) {\r\n    for (let col = 1; col < 4; col++) {\r\n        BAT_EDGES.push([row * 4 + col, (row + 1) * 4 + col - 1]);\r\n    }\r\n}\r\n\r\n// 밭고누 인접 리스트 생성\r\nconst BAT_ADJACENCY = {};\r\nfor (let i = 0; i < 16; i++) {\r\n    BAT_ADJACENCY[i] = [];\r\n}\r\nBAT_EDGES.forEach(([a, b]) => {\r\n    BAT_ADJACENCY[a].push(b);\r\n    BAT_ADJACENCY[b].push(a);\r\n});\r\n\r\n// ═══════════════════════════════════════════════════════════════\r\n// 게임 타입 설정\r\n// ═══════════════════════════════════════════════════════════════\r\n\r\nconst GONU_TYPES = {\r\n    umul: {\r\n        name: '우물고누',\r\n        description: '가장 기본적인 고누. 각자 2개의 말로 상대를 봉쇄하면 승리!',\r\n        rules: [\r\n            '각자 2개의 말을 가지고 시작합니다',\r\n            '말은 선을 따라 한 칸씩만 이동합니다',\r\n            '중앙(우물)으로는 이동할 수 없습니다',\r\n            '상대의 말이 더 이상 움직일 수 없게 만들면 승리!',\r\n        ],\r\n        nodes: UMUL_NODES,\r\n        edges: UMUL_EDGES,\r\n        adjacency: UMUL_VALID_MOVES,\r\n        initialPieces: () => ({\r\n            0: 'B',  // 상단 - 흑\r\n            4: 'B',  // 하단 - 흑 (대각선 위치)\r\n            1: 'R',  // 좌측 - 적\r\n            3: 'R',  // 우측 - 적\r\n        }),\r\n        piecesPerPlayer: 2,\r\n        boardWidth: 300,\r\n        boardHeight: 300,\r\n        checkWin: (pieces, currentPlayer) => {\r\n            // 상대방이 움직일 수 없으면 승리\r\n            const opponent = currentPlayer === 'B' ? 'R' : 'B';\r\n            const opponentPieces = Object.entries(pieces)\r\n                .filter(([, color]) => color === opponent)\r\n                .map(([nodeId]) => parseInt(nodeId));\r\n\r\n            for (const nodeId of opponentPieces) {\r\n                const moves = UMUL_VALID_MOVES[nodeId] || [];\r\n                for (const target of moves) {\r\n                    if (!pieces[target]) {\r\n                        return null; // 움직일 수 있는 곳이 있음\r\n                    }\r\n                }\r\n            }\r\n            return currentPlayer; // 상대방이 움직일 수 없음 = 현재 플레이어 승리\r\n        },\r\n        isWell: (nodeId) => nodeId === 2, // 중앙이 우물\r\n    },\r\n    hobak: {\r\n        name: '호박고누',\r\n        description: '출발선이 있는 고누. 각자 3개의 말로 상대를 봉쇄하면 승리!',\r\n        rules: [\r\n            '각자 3개의 말을 가지고 시작합니다',\r\n            '말은 선을 따라 한 칸씩만 이동합니다',\r\n            '출발선에서 나온 말은 출발선으로 돌아갈 수 없습니다',\r\n            '상대 출발선으로도 들어갈 수 없습니다',\r\n            '상대의 말이 더 이상 움직일 수 없게 만들면 승리!',\r\n        ],\r\n        nodes: HOBAK_NODES,\r\n        edges: HOBAK_EDGES,\r\n        adjacency: HOBAK_ADJACENCY,\r\n        initialPieces: () => ({\r\n            0: 'B', 1: 'B', 3: 'B',   // 흑 (상단)\r\n            10: 'R', 7: 'R', 9: 'R',  // 적 (하단)\r\n        }),\r\n        piecesPerPlayer: 3,\r\n        boardWidth: 300,\r\n        boardHeight: 320,\r\n        checkWin: (pieces, currentPlayer) => {\r\n            const opponent = currentPlayer === 'B' ? 'R' : 'B';\r\n            const opponentPieces = Object.entries(pieces)\r\n                .filter(([, color]) => color === opponent)\r\n                .map(([nodeId]) => parseInt(nodeId));\r\n\r\n            for (const nodeId of opponentPieces) {\r\n                const moves = HOBAK_ADJACENCY[nodeId] || [];\r\n                for (const target of moves) {\r\n                    if (!pieces[target]) {\r\n                        // 출발선 제한 체크\r\n                        const targetNode = HOBAK_NODES.find(n => n.id === target);\r\n                        if (targetNode?.isHome) {\r\n                            // 자신의 출발선은 다시 못 들어감, 상대 출발선도 못 들어감\r\n                            continue;\r\n                        }\r\n                        return null;\r\n                    }\r\n                }\r\n            }\r\n            return currentPlayer;\r\n        },\r\n        getHomeNode: (color) => color === 'B' ? 0 : 10,\r\n    },\r\n    bat: {\r\n        name: '밭고누 (네줄고누)',\r\n        description: '4x4 격자에서 자기 말 3개를 일렬로 만들면 상대 말을 제거!',\r\n        rules: [\r\n            '각자 4개의 말을 가지고 시작합니다',\r\n            '말은 선을 따라 한 칸씩만 이동합니다',\r\n            '자기 말 3개가 가로/세로/대각선 일렬이 되면 상대 말 1개 제거',\r\n            '상대 말을 1개만 남기면 승리!',\r\n        ],\r\n        nodes: BAT_NODES,\r\n        edges: BAT_EDGES,\r\n        adjacency: BAT_ADJACENCY,\r\n        initialPieces: () => ({\r\n            0: 'B', 1: 'B', 2: 'B', 3: 'B',   // 흑 (상단 행)\r\n            12: 'R', 13: 'R', 14: 'R', 15: 'R', // 적 (하단 행)\r\n        }),\r\n        piecesPerPlayer: 4,\r\n        boardWidth: 320,\r\n        boardHeight: 320,\r\n        checkWin: (pieces) => {\r\n            // 상대 말이 1개만 남으면 승리\r\n            const blackCount = Object.values(pieces).filter(c => c === 'B').length;\r\n            const redCount = Object.values(pieces).filter(c => c === 'R').length;\r\n            if (blackCount <= 1) return 'R';\r\n            if (redCount <= 1) return 'B';\r\n            return null;\r\n        },\r\n        checkThreeInRow: (pieces, nodeId, color) => {\r\n            // 해당 노드를 포함해서 3개 일렬인지 확인\r\n            const node = BAT_NODES.find(n => n.id === nodeId);\r\n            if (!node) return false;\r\n\r\n            const { row, col } = node;\r\n\r\n            // 가로 체크\r\n            for (let startCol = Math.max(0, col - 2); startCol <= Math.min(1, col); startCol++) {\r\n                let count = 0;\r\n                for (let c = startCol; c < startCol + 3 && c < 4; c++) {\r\n                    const id = row * 4 + c;\r\n                    if (pieces[id] === color) count++;\r\n                }\r\n                if (count === 3) return true;\r\n            }\r\n\r\n            // 세로 체크\r\n            for (let startRow = Math.max(0, row - 2); startRow <= Math.min(1, row); startRow++) {\r\n                let count = 0;\r\n                for (let r = startRow; r < startRow + 3 && r < 4; r++) {\r\n                    const id = r * 4 + col;\r\n                    if (pieces[id] === color) count++;\r\n                }\r\n                if (count === 3) return true;\r\n            }\r\n\r\n            // 대각선 체크 (오른쪽 아래 방향)\r\n            for (let offset = -2; offset <= 0; offset++) {\r\n                let count = 0;\r\n                for (let d = 0; d < 3; d++) {\r\n                    const r = row + offset + d;\r\n                    const c = col + offset + d;\r\n                    if (r >= 0 && r < 4 && c >= 0 && c < 4) {\r\n                        const id = r * 4 + c;\r\n                        if (pieces[id] === color) count++;\r\n                    }\r\n                }\r\n                if (count === 3) return true;\r\n            }\r\n\r\n            // 대각선 체크 (왼쪽 아래 방향)\r\n            for (let offset = -2; offset <= 0; offset++) {\r\n                let count = 0;\r\n                for (let d = 0; d < 3; d++) {\r\n                    const r = row + offset + d;\r\n                    const c = col - offset - d;\r\n                    if (r >= 0 && r < 4 && c >= 0 && c < 4) {\r\n                        const id = r * 4 + c;\r\n                        if (pieces[id] === color) count++;\r\n                    }\r\n                }\r\n                if (count === 3) return true;\r\n            }\r\n\r\n            return false;\r\n        },\r\n    },\r\n};\r\n\r\n// Firestore 직렬화/역직렬화\r\nconst serializePieces = (pieces) => pieces;\r\nconst deserializePieces = (data) => {\r\n    const result = {};\r\n    for (const key in data) {\r\n        result[parseInt(key)] = data[key];\r\n    }\r\n    return result;\r\n};\r\n\r\n// ═══════════════════════════════════════════════════════════════\r\n// AI 로직\r\n// ═══════════════════════════════════════════════════════════════\r\n\r\nconst getAIMove = (gameType, pieces, aiColor) => {\r\n    const config = GONU_TYPES[gameType];\r\n    const adjacency = config.adjacency;\r\n    const opponentColor = aiColor === 'B' ? 'R' : 'B';\r\n\r\n    // AI의 모든 말 찾기\r\n    const aiPieces = Object.entries(pieces)\r\n        .filter(([, color]) => color === aiColor)\r\n        .map(([nodeId]) => parseInt(nodeId));\r\n\r\n    // 가능한 모든 이동 찾기\r\n    const possibleMoves = [];\r\n\r\n    for (const fromNode of aiPieces) {\r\n        const targets = adjacency[fromNode] || [];\r\n        for (const toNode of targets) {\r\n            if (pieces[toNode]) continue; // 이미 말이 있음\r\n\r\n            // 호박고누 출발선 제한 체크\r\n            if (gameType === 'hobak') {\r\n                const targetNodeInfo = HOBAK_NODES.find(n => n.id === toNode);\r\n                if (targetNodeInfo?.isHome) continue;\r\n            }\r\n\r\n            // 우물고누 우물 제한 체크\r\n            if (gameType === 'umul' && config.isWell && config.isWell(toNode)) continue;\r\n\r\n            possibleMoves.push({ from: fromNode, to: toNode });\r\n        }\r\n    }\r\n\r\n    if (possibleMoves.length === 0) return null;\r\n\r\n    // 각 이동에 대한 점수 계산\r\n    const scoredMoves = possibleMoves.map(move => {\r\n        let score = 0;\r\n\r\n        // 시뮬레이션: 이 이동을 했을 때\r\n        const simulatedPieces = { ...pieces };\r\n        delete simulatedPieces[move.from];\r\n        simulatedPieces[move.to] = aiColor;\r\n\r\n        // 1. 승리 가능한 이동은 최우선\r\n        const winner = config.checkWin(simulatedPieces, aiColor);\r\n        if (winner === aiColor) {\r\n            score += 1000;\r\n        }\r\n\r\n        // 2. 상대방의 이동 가능 수 줄이기\r\n        const opponentPieces = Object.entries(simulatedPieces)\r\n            .filter(([, color]) => color === opponentColor)\r\n            .map(([nodeId]) => parseInt(nodeId));\r\n\r\n        let opponentMoves = 0;\r\n        for (const nodeId of opponentPieces) {\r\n            const moves = adjacency[nodeId] || [];\r\n            for (const target of moves) {\r\n                if (!simulatedPieces[target]) {\r\n                    if (gameType === 'hobak') {\r\n                        const targetNode = HOBAK_NODES.find(n => n.id === target);\r\n                        if (!targetNode?.isHome) opponentMoves++;\r\n                    } else if (gameType === 'umul') {\r\n                        if (!config.isWell || !config.isWell(target)) opponentMoves++;\r\n                    } else {\r\n                        opponentMoves++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        score -= opponentMoves * 5; // 상대방 이동 가능 수가 적을수록 좋음\r\n\r\n        // 3. 중앙에 가까울수록 좋음 (밭고누)\r\n        if (gameType === 'bat') {\r\n            const toNode = BAT_NODES.find(n => n.id === move.to);\r\n            if (toNode) {\r\n                const centerDist = Math.abs(toNode.row - 1.5) + Math.abs(toNode.col - 1.5);\r\n                score -= centerDist * 2;\r\n            }\r\n\r\n            // 3연속 만들 수 있으면 보너스\r\n            if (config.checkThreeInRow(simulatedPieces, move.to, aiColor)) {\r\n                score += 100;\r\n            }\r\n        }\r\n\r\n        // 4. 약간의 랜덤성 추가\r\n        score += Math.random() * 3;\r\n\r\n        return { ...move, score };\r\n    });\r\n\r\n    // 가장 높은 점수의 이동 선택\r\n    scoredMoves.sort((a, b) => b.score - a.score);\r\n    return scoredMoves[0];\r\n};\r\n\r\n// ═══════════════════════════════════════════════════════════════\r\n// 메인 컴포넌트\r\n// ═══════════════════════════════════════════════════════════════\r\n\r\nconst GonuGame = () => {\r\n    const { user, userDoc } = useAuth();\r\n    const [gameId, setGameId] = useState(null);\r\n    const [gameData, setGameData] = useState(null);\r\n    const [showCreateRoom, setShowCreateRoom] = useState(true);\r\n    const [newRoomId, setNewRoomId] = useState('');\r\n    const [feedback, setFeedback] = useState({ message: '', type: '' });\r\n    const [selectedPiece, setSelectedPiece] = useState(null);\r\n    const [selectedGameType, setSelectedGameType] = useState('umul');\r\n    const [availableRooms, setAvailableRooms] = useState([]);\r\n    const [showRules, setShowRules] = useState(false);\r\n    const [loading, setLoading] = useState(false);\r\n    const [gameMode, setGameMode] = useState('pvp'); // 'pvp' or 'ai'\r\n    const [aiThinking, setAiThinking] = useState(false);\r\n    const [validMoves, setValidMoves] = useState([]);\r\n    const [pendingCapture, setPendingCapture] = useState(null); // 밭고누에서 상대 말 제거 대기\r\n\r\n    // 로컬 AI 게임 상태\r\n    const [localGame, setLocalGame] = useState(null);\r\n\r\n    const isMyTurn = gameData && user && gameData.turn === (gameData.players.B === user.uid ? 'B' : 'R');\r\n    const myColor = gameData && user && (gameData.players.B === user.uid ? 'B' : 'R');\r\n\r\n    const gameIdRef = useRef(gameId);\r\n    useEffect(() => { gameIdRef.current = gameId; }, [gameId]);\r\n    const gameDataRef = useRef(gameData);\r\n    useEffect(() => { gameDataRef.current = gameData; }, [gameData]);\r\n    const userRef = useRef(user);\r\n    useEffect(() => { userRef.current = user; }, [user]);\r\n\r\n    useEffect(() => {\r\n        const cleanup = () => {\r\n            const currentGameId = gameIdRef.current;\r\n            const currentGameData = gameDataRef.current;\r\n            const currentUser = userRef.current;\r\n            if (\r\n                currentGameId &&\r\n                currentGameData &&\r\n                currentUser &&\r\n                currentGameData.status === 'waiting' &&\r\n                currentGameData.players.B === currentUser.uid\r\n            ) {\r\n                deleteDoc(doc(db, 'gonuGames', currentGameId));\r\n            }\r\n        };\r\n\r\n        window.addEventListener('beforeunload', cleanup);\r\n\r\n        return () => {\r\n            window.removeEventListener('beforeunload', cleanup);\r\n        };\r\n    }, []);\r\n\r\n    // 유효한 이동 위치 계산\r\n    useEffect(() => {\r\n        if (!selectedPiece) {\r\n            setValidMoves([]);\r\n            return;\r\n        }\r\n\r\n        const currentPieces = localGame?.pieces || (gameData ? deserializePieces(gameData.pieces) : {});\r\n        const gameType = localGame?.gameType || gameData?.gameType || 'umul';\r\n        const config = GONU_TYPES[gameType];\r\n        const adjacency = config.adjacency;\r\n        const currentColor = localGame ? 'B' : myColor;\r\n\r\n        if (currentPieces[selectedPiece] !== currentColor) {\r\n            setValidMoves([]);\r\n            return;\r\n        }\r\n\r\n        const moves = [];\r\n        const targets = adjacency[selectedPiece] || [];\r\n\r\n        for (const target of targets) {\r\n            if (currentPieces[target]) continue;\r\n\r\n            // 우물고누 우물 제한\r\n            if (gameType === 'umul' && config.isWell && config.isWell(target)) continue;\r\n\r\n            // 호박고누 출발선 제한\r\n            if (gameType === 'hobak') {\r\n                const targetNode = HOBAK_NODES.find(n => n.id === target);\r\n                if (targetNode?.isHome) continue;\r\n            }\r\n\r\n            moves.push(target);\r\n        }\r\n\r\n        setValidMoves(moves);\r\n    }, [selectedPiece, localGame, gameData, myColor]);\r\n\r\n    const fetchAvailableRooms = useCallback(async () => {\r\n        if (!user) return;\r\n        setLoading(true);\r\n        try {\r\n            const q = query(\r\n                collection(db, 'gonuGames'),\r\n                where('status', '==', 'waiting')\r\n            );\r\n            const querySnapshot = await getDocs(q);\r\n            const rooms = [];\r\n            querySnapshot.forEach((doc) => {\r\n                const data = doc.data();\r\n                if (data.players.B !== user.uid) {\r\n                    rooms.push({ id: doc.id, ...data });\r\n                }\r\n            });\r\n            setAvailableRooms(rooms);\r\n        } catch (error) {\r\n            console.error(\"Error fetching rooms:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [user]);\r\n\r\n    useEffect(() => {\r\n        if (showCreateRoom && user && gameMode === 'pvp') {\r\n            fetchAvailableRooms();\r\n            const interval = setInterval(fetchAvailableRooms, 60000);\r\n            return () => clearInterval(interval);\r\n        }\r\n    }, [showCreateRoom, user, fetchAvailableRooms, gameMode]);\r\n\r\n    const fetchGameData = useCallback(async () => {\r\n        if (!gameId) return;\r\n\r\n        const gameDocRef = doc(db, 'gonuGames', gameId);\r\n        try {\r\n            const docSnap = await getDoc(gameDocRef);\r\n            if (docSnap.exists()) {\r\n                const rawData = docSnap.data();\r\n                setGameData(rawData);\r\n                setShowCreateRoom(false);\r\n\r\n                if (rawData.status === 'finished') {\r\n                    setTimeout(async () => {\r\n                        try { await deleteDoc(gameDocRef); } catch (error) { console.error(\"Error deleting finished game:\", error); }\r\n                    }, 10000);\r\n                }\r\n            } else {\r\n                setFeedback({ message: '게임을 찾을 수 없습니다.', type: 'error' });\r\n                setGameId(null);\r\n                setGameData(null);\r\n                setShowCreateRoom(true);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error fetching game data:\", error);\r\n        }\r\n    }, [gameId]);\r\n\r\n    usePolling(fetchGameData, { interval: 3000, enabled: !!gameId });\r\n\r\n    useEffect(() => {\r\n        if (feedback.message) {\r\n            const timer = setTimeout(() => setFeedback({ message: '', type: '' }), 3000);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [feedback.message]);\r\n\r\n    // AI 턴 처리\r\n    useEffect(() => {\r\n        if (!localGame || localGame.status !== 'active' || localGame.turn !== 'R' || aiThinking || pendingCapture) return;\r\n\r\n        setAiThinking(true);\r\n\r\n        const timer = setTimeout(() => {\r\n            const move = getAIMove(localGame.gameType, localGame.pieces, 'R');\r\n\r\n            if (move) {\r\n                const newPieces = { ...localGame.pieces };\r\n                delete newPieces[move.from];\r\n                newPieces[move.to] = 'R';\r\n\r\n                const config = GONU_TYPES[localGame.gameType];\r\n\r\n                // 밭고누에서 3연속 체크\r\n                if (localGame.gameType === 'bat' && config.checkThreeInRow(newPieces, move.to, 'R')) {\r\n                    // AI가 3연속을 만들었을 때 - 플레이어 말 중 하나 제거\r\n                    const playerPieces = Object.entries(newPieces)\r\n                        .filter(([, color]) => color === 'B')\r\n                        .map(([nodeId]) => parseInt(nodeId));\r\n\r\n                    if (playerPieces.length > 0) {\r\n                        // AI는 랜덤하게 하나 제거 (또는 전략적으로)\r\n                        const targetIdx = Math.floor(Math.random() * playerPieces.length);\r\n                        delete newPieces[playerPieces[targetIdx]];\r\n                    }\r\n                }\r\n\r\n                const winner = config.checkWin(newPieces, 'R');\r\n\r\n                setLocalGame(prev => ({\r\n                    ...prev,\r\n                    pieces: newPieces,\r\n                    turn: 'B',\r\n                    status: winner ? 'finished' : 'active',\r\n                    winner: winner,\r\n                }));\r\n            }\r\n\r\n            setAiThinking(false);\r\n        }, 800);\r\n\r\n        return () => clearTimeout(timer);\r\n    }, [localGame, aiThinking, pendingCapture]);\r\n\r\n    const handleStartAIGame = () => {\r\n        const config = GONU_TYPES[selectedGameType];\r\n        setLocalGame({\r\n            gameType: selectedGameType,\r\n            pieces: config.initialPieces(),\r\n            turn: 'B',\r\n            status: 'active',\r\n            winner: null,\r\n        });\r\n        setShowCreateRoom(false);\r\n    };\r\n\r\n    const handleCreateRoom = async () => {\r\n        if (!user) {\r\n            setFeedback({ message: '로그인이 필요합니다.', type: 'error' });\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        const newGameId = Math.random().toString(36).substring(2, 8);\r\n        const gameRef = doc(db, 'gonuGames', newGameId);\r\n        const gameType = GONU_TYPES[selectedGameType];\r\n\r\n        const initialGameData = {\r\n            pieces: serializePieces(gameType.initialPieces()),\r\n            players: { B: user.uid, R: null },\r\n            playerNames: { B: userDoc.name, R: null },\r\n            turn: 'B',\r\n            status: 'waiting',\r\n            winner: null,\r\n            gameType: selectedGameType,\r\n            gameName: gameType.name,\r\n            createdAt: serverTimestamp(),\r\n        };\r\n\r\n        try {\r\n            await setDoc(gameRef, initialGameData);\r\n            setGameId(newGameId);\r\n            setFeedback({ message: `${gameType.name} 방 생성 완료! 코드: ${newGameId}`, type: 'success' });\r\n            await fetchGameData();\r\n        } catch (error) {\r\n            console.error(\"Error creating room:\", error);\r\n            setFeedback({ message: '방 생성에 실패했습니다.', type: 'error' });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleJoinRoom = async (roomIdToJoin) => {\r\n        const targetRoomId = roomIdToJoin || newRoomId.trim();\r\n        if (!targetRoomId) {\r\n            setFeedback({ message: '참가할 방 코드를 입력하세요.', type: 'error' });\r\n            return;\r\n        }\r\n        if (!user) {\r\n            setFeedback({ message: '로그인이 필요합니다.', type: 'error' });\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        const gameRef = doc(db, 'gonuGames', targetRoomId);\r\n\r\n        try {\r\n            await runTransaction(db, async (transaction) => {\r\n                const gameDoc = await transaction.get(gameRef);\r\n                if (!gameDoc.exists()) throw new Error(\"방을 찾을 수 없습니다.\");\r\n                const data = gameDoc.data();\r\n                if (data.players.R) throw new Error(\"방이 가득 찼습니다.\");\r\n                if (data.players.B === user.uid) throw new Error(\"자신이 만든 방에는 참가할 수 없습니다.\");\r\n\r\n                transaction.update(gameRef, {\r\n                    'players.R': user.uid,\r\n                    'playerNames.R': userDoc.name,\r\n                    status: 'active',\r\n                });\r\n            });\r\n            setGameId(targetRoomId);\r\n            await fetchGameData();\r\n        } catch (error) {\r\n            console.error(\"Error joining room: \", error);\r\n            setFeedback({ message: `참가 실패: ${error.message}`, type: 'error' });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleAdminDeleteRoom = async (roomId) => {\r\n        if (!userDoc?.isAdmin) {\r\n            setFeedback({ message: '삭제 권한이 없습니다.', type: 'error' });\r\n            return;\r\n        }\r\n        try {\r\n            await deleteDoc(doc(db, 'gonuGames', roomId));\r\n            setFeedback({ message: `방 ${roomId}가 삭제되었습니다.`, type: 'success' });\r\n            fetchAvailableRooms();\r\n        } catch (error) {\r\n            console.error(\"Error deleting room by admin:\", error);\r\n            setFeedback({ message: '방 삭제에 실패했습니다.', type: 'error' });\r\n        }\r\n    };\r\n\r\n    // 밭고누에서 상대 말 제거\r\n    const handleCaptureClick = (nodeId) => {\r\n        if (!pendingCapture) return;\r\n\r\n        const pieces = localGame?.pieces || deserializePieces(gameData.pieces);\r\n        const opponentColor = pendingCapture.capturer === 'B' ? 'R' : 'B';\r\n\r\n        if (pieces[nodeId] !== opponentColor) {\r\n            setFeedback({ message: '상대방의 말을 선택하세요.', type: 'error' });\r\n            return;\r\n        }\r\n\r\n        const newPieces = { ...pieces };\r\n        delete newPieces[nodeId];\r\n\r\n        const config = GONU_TYPES[localGame?.gameType || gameData.gameType];\r\n        const winner = config.checkWin(newPieces, pendingCapture.capturer);\r\n\r\n        if (localGame) {\r\n            setLocalGame(prev => ({\r\n                ...prev,\r\n                pieces: newPieces,\r\n                turn: pendingCapture.capturer === 'B' ? 'R' : 'B',\r\n                status: winner ? 'finished' : 'active',\r\n                winner: winner,\r\n            }));\r\n        }\r\n\r\n        setPendingCapture(null);\r\n    };\r\n\r\n    const handleMove = useCallback(async (targetNode) => {\r\n        if (pendingCapture) {\r\n            handleCaptureClick(targetNode);\r\n            return;\r\n        }\r\n\r\n        if (selectedPiece === null) return;\r\n\r\n        // 로컬 AI 게임\r\n        if (localGame) {\r\n            if (localGame.status !== 'active' || localGame.turn !== 'B') return;\r\n\r\n            const pieces = localGame.pieces;\r\n            if (pieces[selectedPiece] !== 'B') return;\r\n            if (!validMoves.includes(targetNode)) {\r\n                setFeedback({ message: '이동할 수 없는 위치입니다.', type: 'error' });\r\n                return;\r\n            }\r\n\r\n            const newPieces = { ...pieces };\r\n            delete newPieces[selectedPiece];\r\n            newPieces[targetNode] = 'B';\r\n\r\n            const config = GONU_TYPES[localGame.gameType];\r\n\r\n            // 밭고누에서 3연속 체크\r\n            if (localGame.gameType === 'bat' && config.checkThreeInRow(newPieces, targetNode, 'B')) {\r\n                // 상대 말 제거 대기 상태로\r\n                setLocalGame(prev => ({\r\n                    ...prev,\r\n                    pieces: newPieces,\r\n                }));\r\n                setPendingCapture({ capturer: 'B' });\r\n                setSelectedPiece(null);\r\n                setFeedback({ message: '3연속! 제거할 상대 말을 선택하세요.', type: 'success' });\r\n                return;\r\n            }\r\n\r\n            const winner = config.checkWin(newPieces, 'B');\r\n\r\n            setLocalGame(prev => ({\r\n                ...prev,\r\n                pieces: newPieces,\r\n                turn: 'R',\r\n                status: winner ? 'finished' : 'active',\r\n                winner: winner,\r\n            }));\r\n            setSelectedPiece(null);\r\n\r\n            if (winner === 'B') {\r\n                setFeedback({ message: '🎉 승리했습니다!', type: 'success' });\r\n            }\r\n            return;\r\n        }\r\n\r\n        // 온라인 게임\r\n        if (!isMyTurn || !gameData) return;\r\n\r\n        const pieces = deserializePieces(gameData.pieces);\r\n        if (pieces[selectedPiece] !== myColor) return;\r\n        if (!validMoves.includes(targetNode)) {\r\n            setFeedback({ message: '이동할 수 없는 위치입니다.', type: 'error' });\r\n            return;\r\n        }\r\n\r\n        const gameRef = doc(db, 'gonuGames', gameId);\r\n\r\n        try {\r\n            await runTransaction(db, async (transaction) => {\r\n                const gameDoc = await transaction.get(gameRef);\r\n                if (!gameDoc.exists()) throw new Error('게임이 존재하지 않습니다.');\r\n                const currentData = gameDoc.data();\r\n                if (currentData.turn !== myColor) throw new Error('상대방의 턴입니다.');\r\n\r\n                const newPieces = { ...deserializePieces(currentData.pieces) };\r\n                delete newPieces[selectedPiece];\r\n                newPieces[targetNode] = myColor;\r\n\r\n                const config = GONU_TYPES[gameData.gameType];\r\n                const winner = config.checkWin(newPieces, myColor);\r\n                const opponentColor = myColor === 'B' ? 'R' : 'B';\r\n\r\n                transaction.update(gameRef, {\r\n                    pieces: serializePieces(newPieces),\r\n                    turn: opponentColor,\r\n                    status: winner ? 'finished' : 'active',\r\n                    winner: winner,\r\n                });\r\n\r\n                if (winner) {\r\n                    const userDocRef = doc(db, 'users', user.uid);\r\n                    transaction.update(userDocRef, { coupons: increment(1) });\r\n\r\n                    logActivity(db, {\r\n                        classCode: userDoc?.classCode,\r\n                        userId: user.uid,\r\n                        userName: userDoc?.name || '사용자',\r\n                        type: ACTIVITY_TYPES.GAME_WIN,\r\n                        description: `${gameData.gameName || '고누'} 승리 - 쿠폰 1개 획득`,\r\n                        couponAmount: 1,\r\n                        metadata: {\r\n                            gameType: 'gonu',\r\n                            gameVariant: gameData.gameType,\r\n                            gameName: gameData.gameName\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n            setSelectedPiece(null);\r\n        } catch (error) {\r\n            console.error('Move error:', error);\r\n            setFeedback({ message: `이동 실패: ${error.message}`, type: 'error' });\r\n        }\r\n    }, [gameId, gameData, isMyTurn, myColor, selectedPiece, user?.uid, localGame, validMoves, pendingCapture]);\r\n\r\n    const handleNodeClick = (nodeId) => {\r\n        if (pendingCapture) {\r\n            handleCaptureClick(nodeId);\r\n            return;\r\n        }\r\n\r\n        const pieces = localGame?.pieces || (gameData ? deserializePieces(gameData.pieces) : {});\r\n        const currentTurn = localGame?.turn || gameData?.turn;\r\n        const currentColor = localGame ? 'B' : myColor;\r\n        const status = localGame?.status || gameData?.status;\r\n\r\n        if (status !== 'active') return;\r\n        if (localGame && currentTurn !== 'B') return;\r\n        if (!localGame && !isMyTurn) return;\r\n\r\n        // 자기 말 선택\r\n        if (pieces[nodeId] === currentColor) {\r\n            setSelectedPiece(nodeId);\r\n            return;\r\n        }\r\n\r\n        // 빈 칸으로 이동\r\n        if (selectedPiece !== null && !pieces[nodeId]) {\r\n            handleMove(nodeId);\r\n        }\r\n    };\r\n\r\n    const handleLeaveGame = async () => {\r\n        if (localGame) {\r\n            setLocalGame(null);\r\n            setShowCreateRoom(true);\r\n            setSelectedPiece(null);\r\n            setPendingCapture(null);\r\n            return;\r\n        }\r\n\r\n        if (gameData && gameData.status === 'waiting' && gameId && gameData.players.B === user.uid) {\r\n            try { await deleteDoc(doc(db, 'gonuGames', gameId)); } catch (error) { console.error(\"Error deleting room:\", error); }\r\n        }\r\n\r\n        setGameId(null);\r\n        setGameData(null);\r\n        setShowCreateRoom(true);\r\n        setSelectedPiece(null);\r\n        setPendingCapture(null);\r\n    };\r\n\r\n    // 게임 보드 렌더링\r\n    const renderBoard = () => {\r\n        const gameType = localGame?.gameType || gameData?.gameType || 'umul';\r\n        const config = GONU_TYPES[gameType];\r\n        const pieces = localGame?.pieces || (gameData ? deserializePieces(gameData.pieces) : {});\r\n        const currentTurn = localGame?.turn || gameData?.turn;\r\n\r\n        return (\r\n            <svg\r\n                className=\"gonu-svg-board\"\r\n                width={config.boardWidth}\r\n                height={config.boardHeight}\r\n                viewBox={`0 0 ${config.boardWidth} ${config.boardHeight}`}\r\n                style={{ width: '100%', maxWidth: config.boardWidth, height: 'auto' }}\r\n            >\r\n                {/* 배경 */}\r\n                <rect x=\"0\" y=\"0\" width={config.boardWidth} height={config.boardHeight} fill=\"#2a2a3a\" rx=\"10\" />\r\n\r\n                {/* 연결선 */}\r\n                {config.edges.map(([from, to], idx) => {\r\n                    const fromNode = config.nodes.find(n => n.id === from);\r\n                    const toNode = config.nodes.find(n => n.id === to);\r\n                    return (\r\n                        <line\r\n                            key={`edge-${idx}`}\r\n                            x1={fromNode.x}\r\n                            y1={fromNode.y}\r\n                            x2={toNode.x}\r\n                            y2={toNode.y}\r\n                            stroke=\"#555\"\r\n                            strokeWidth=\"3\"\r\n                        />\r\n                    );\r\n                })}\r\n\r\n                {/* 노드 및 말 */}\r\n                {config.nodes.map(node => {\r\n                    const piece = pieces[node.id];\r\n                    const isSelected = selectedPiece === node.id;\r\n                    const isValidMove = validMoves.includes(node.id);\r\n                    const isWell = gameType === 'umul' && config.isWell && config.isWell(node.id);\r\n                    const isHome = node.isHome;\r\n                    const isPendingCapture = pendingCapture && piece && piece !== pendingCapture.capturer;\r\n\r\n                    return (\r\n                        <g\r\n                            key={`node-${node.id}`}\r\n                            onClick={() => handleNodeClick(node.id)}\r\n                            style={{ cursor: 'pointer' }}\r\n                        >\r\n                            {/* 노드 배경 */}\r\n                            <circle\r\n                                cx={node.x}\r\n                                cy={node.y}\r\n                                r={isWell ? 20 : 22}\r\n                                fill={isWell ? '#333' : isValidMove ? '#4a7' : isHome ? (isHome === 'B' ? '#334' : '#433') : '#444'}\r\n                                stroke={isSelected ? '#0ff' : isValidMove ? '#4f7' : isPendingCapture ? '#f44' : '#666'}\r\n                                strokeWidth={isSelected || isValidMove || isPendingCapture ? 3 : 2}\r\n                            />\r\n\r\n                            {/* 우물 표시 */}\r\n                            {isWell && (\r\n                                <text\r\n                                    x={node.x}\r\n                                    y={node.y + 5}\r\n                                    textAnchor=\"middle\"\r\n                                    fill=\"#666\"\r\n                                    fontSize=\"12\"\r\n                                    fontWeight=\"bold\"\r\n                                >\r\n                                    우물\r\n                                </text>\r\n                            )}\r\n\r\n                            {/* 출발선 표시 */}\r\n                            {isHome && !piece && (\r\n                                <text\r\n                                    x={node.x}\r\n                                    y={node.y + 5}\r\n                                    textAnchor=\"middle\"\r\n                                    fill={isHome === 'B' ? '#88f' : '#f88'}\r\n                                    fontSize=\"10\"\r\n                                >\r\n                                    출발\r\n                                </text>\r\n                            )}\r\n\r\n                            {/* 말 */}\r\n                            {piece && (\r\n                                <>\r\n                                    <circle\r\n                                        cx={node.x}\r\n                                        cy={node.y}\r\n                                        r={18}\r\n                                        fill={piece === 'B' ? '#1a5fb4' : '#c00'}\r\n                                        stroke={piece === 'B' ? '#62a0ea' : '#f66'}\r\n                                        strokeWidth=\"3\"\r\n                                    />\r\n                                    <circle\r\n                                        cx={node.x - 5}\r\n                                        cy={node.y - 5}\r\n                                        r={6}\r\n                                        fill={piece === 'B' ? '#62a0ea' : '#f44'}\r\n                                        opacity=\"0.6\"\r\n                                    />\r\n                                </>\r\n                            )}\r\n\r\n                            {/* 이동 가능 표시 */}\r\n                            {isValidMove && !piece && (\r\n                                <circle\r\n                                    cx={node.x}\r\n                                    cy={node.y}\r\n                                    r={8}\r\n                                    fill=\"#4f7\"\r\n                                    opacity=\"0.6\"\r\n                                />\r\n                            )}\r\n                        </g>\r\n                    );\r\n                })}\r\n\r\n                {/* 턴 표시 */}\r\n                <text\r\n                    x={config.boardWidth / 2}\r\n                    y={config.boardHeight - 8}\r\n                    textAnchor=\"middle\"\r\n                    fill=\"#aaa\"\r\n                    fontSize=\"11\"\r\n                >\r\n                    {currentTurn === 'B' ? '🔵 파랑 차례' : '🔴 빨강 차례'}\r\n                </text>\r\n            </svg>\r\n        );\r\n    };\r\n\r\n    if (showCreateRoom) {\r\n        return (\r\n            <div className=\"gonu-container\">\r\n                <div className=\"room-creation\">\r\n                    <h2>🎯 고누 게임</h2>\r\n                    <p>한국 전통 보드게임을 즐겨보세요!</p>\r\n\r\n                    {feedback.message && <div className={`feedback ${feedback.type}`}>{feedback.message}</div>}\r\n\r\n                    {/* 게임 모드 선택 */}\r\n                    <div className=\"game-mode-selector\">\r\n                        <h3>🎮 게임 모드</h3>\r\n                        <div className=\"mode-buttons\">\r\n                            <button\r\n                                className={`mode-btn ${gameMode === 'ai' ? 'selected' : ''}`}\r\n                                onClick={() => setGameMode('ai')}\r\n                            >\r\n                                🤖 AI 대전\r\n                            </button>\r\n                            <button\r\n                                className={`mode-btn ${gameMode === 'pvp' ? 'selected' : ''}`}\r\n                                onClick={() => setGameMode('pvp')}\r\n                            >\r\n                                👥 친구 대전\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"game-type-selector\">\r\n                        <h3>게임 종류 선택</h3>\r\n                        <div className=\"game-types\">\r\n                            {Object.entries(GONU_TYPES).map(([key, type]) => (\r\n                                <label key={key} className={`game-type-option ${selectedGameType === key ? 'selected' : ''}`}>\r\n                                    <input type=\"radio\" value={key} checked={selectedGameType === key} onChange={(e) => setSelectedGameType(e.target.value)} />\r\n                                    <div className=\"game-type-info\">\r\n                                        <strong>{type.name}</strong>\r\n                                        <small>{type.description}</small>\r\n                                    </div>\r\n                                </label>\r\n                            ))}\r\n                        </div>\r\n                        <button onClick={() => setShowRules(!showRules)} className=\"rules-toggle-btn\">\r\n                            {showRules ? '규칙 숨기기' : '규칙 보기'}\r\n                        </button>\r\n\r\n                        {showRules && (\r\n                            <div className=\"rules-display\">\r\n                                <h4>{GONU_TYPES[selectedGameType].name} 규칙</h4>\r\n                                <ul>\r\n                                    {GONU_TYPES[selectedGameType].rules.map((rule, idx) => <li key={idx}>{rule}</li>)}\r\n                                </ul>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"room-actions\">\r\n                        {gameMode === 'ai' ? (\r\n                            <button onClick={handleStartAIGame} className=\"create-room-btn\" disabled={loading}>\r\n                                🤖 AI와 대전 시작\r\n                            </button>\r\n                        ) : (\r\n                            <>\r\n                                <button onClick={handleCreateRoom} className=\"create-room-btn\" disabled={loading}>\r\n                                    {loading ? <span className=\"loading\"></span> : '새로운 방 만들기'}\r\n                                </button>\r\n\r\n                                <div className=\"join-room\">\r\n                                    <input type=\"text\" value={newRoomId} onChange={(e) => setNewRoomId(e.target.value)} placeholder=\"방 코드 입력\" maxLength=\"6\" />\r\n                                    <button onClick={() => handleJoinRoom()} disabled={loading}>{loading ? <span className=\"loading\"></span> : '코드로 참가'}</button>\r\n                                </div>\r\n                            </>\r\n                        )}\r\n                    </div>\r\n\r\n                    {gameMode === 'pvp' && availableRooms.length > 0 && (\r\n                        <div className=\"available-rooms\">\r\n                            <h3>📋 대기 중인 방 목록</h3>\r\n                            <div className=\"rooms-list\">\r\n                                {availableRooms.map((room) => (\r\n                                    <div key={room.id} className=\"room-item\">\r\n                                        <div className=\"room-info\">\r\n                                            <span className=\"room-type\">{room.gameName}</span>\r\n                                            <span className=\"room-host\">호스트: {room.playerNames.B}</span>\r\n                                            <span className=\"room-code\">코드: {room.id}</span>\r\n                                        </div>\r\n                                        <div className=\"room-item-buttons\">\r\n                                            <button onClick={() => handleJoinRoom(room.id)} className=\"join-btn\" disabled={loading}>참가</button>\r\n                                            {userDoc?.isAdmin && (\r\n                                                <button onClick={() => handleAdminDeleteRoom(room.id)} className=\"delete-btn\">삭제</button>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // 온라인 게임 로딩\r\n    if (!localGame && !gameData) {\r\n        return <AlchanLoading />;\r\n    }\r\n\r\n    const currentGameType = localGame?.gameType || gameData?.gameType || 'umul';\r\n    const currentStatus = localGame?.status || gameData?.status;\r\n    const currentWinner = localGame?.winner || gameData?.winner;\r\n    const currentTurn = localGame?.turn || gameData?.turn;\r\n\r\n    return (\r\n        <div className=\"gonu-container\">\r\n            <div className=\"game-info\">\r\n                <h2>\r\n                    {GONU_TYPES[currentGameType].name}\r\n                    {localGame && ' (AI 대전)'}\r\n                    {gameId && ` (방: ${gameId})`}\r\n                </h2>\r\n\r\n                {!localGame && (\r\n                    <div className=\"player-info\">\r\n                        <p className={`player-b ${currentTurn === 'B' ? 'active-turn' : ''}`}>\r\n                            🔵 {gameData?.playerNames?.B || '플레이어 1'} {gameData?.players?.B === user?.uid && '(나)'}\r\n                        </p>\r\n                        <p className={`player-r ${currentTurn === 'R' ? 'active-turn' : ''}`}>\r\n                            🔴 {gameData?.playerNames?.R || '대기중...'} {gameData?.players?.R === user?.uid && '(나)'}\r\n                        </p>\r\n                    </div>\r\n                )}\r\n\r\n                {localGame && (\r\n                    <div className=\"player-info\">\r\n                        <p className={`player-b ${currentTurn === 'B' ? 'active-turn' : ''}`}>\r\n                            🔵 나 (파랑)\r\n                        </p>\r\n                        <p className={`player-r ${currentTurn === 'R' ? 'active-turn' : ''}`}>\r\n                            🔴 AI (적) {aiThinking && '🤔 생각 중...'}\r\n                        </p>\r\n                    </div>\r\n                )}\r\n\r\n                {currentStatus === 'finished' ? (\r\n                    <div className=\"game-status winner\">\r\n                        {localGame ? (\r\n                            currentWinner === 'B' ? '🎉 승리했습니다!' : '😢 AI에게 패배했습니다.'\r\n                        ) : (\r\n                            currentWinner === myColor ? '🎉 승리! 쿠폰 1개를 획득했습니다!' : '😢 패배했습니다.'\r\n                        )}\r\n                    </div>\r\n                ) : currentStatus === 'waiting' ? (\r\n                    <div className=\"game-status\">상대방을 기다리는 중...</div>\r\n                ) : pendingCapture ? (\r\n                    <div className=\"game-status capture-mode\">🎯 제거할 상대 말을 선택하세요!</div>\r\n                ) : (\r\n                    <div className=\"game-status\">\r\n                        {localGame ? (\r\n                            currentTurn === 'B' ? \"🎯 당신의 턴입니다.\" : \"⏳ AI가 생각 중...\"\r\n                        ) : (\r\n                            isMyTurn ? \"🎯 당신의 턴입니다.\" : \"⏳ 상대방의 턴을 기다리는 중...\"\r\n                        )}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"board-area\">\r\n                {renderBoard()}\r\n            </div>\r\n\r\n            {feedback.message && <div className={`feedback ${feedback.type}`}>{feedback.message}</div>}\r\n\r\n            <button onClick={handleLeaveGame} className=\"leave-button\">\r\n                {currentStatus === 'finished' ? '나가기' : '게임 나가기'}\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default GonuGame;\r\n"],"names":["UMUL_VALID_MOVES","HOBAK_NODES","id","x","y","isHome","HOBAK_ADJACENCY","BAT_NODES","row","col","push","BAT_EDGES","BAT_ADJACENCY","i","forEach","_ref","a","b","GONU_TYPES","umul","name","description","rules","nodes","edges","adjacency","initialPieces","piecesPerPlayer","boardWidth","boardHeight","checkWin","pieces","currentPlayer","opponent","opponentPieces","Object","entries","filter","_ref2","color","map","_ref3","nodeId","parseInt","moves","target","isWell","hobak","_ref4","_ref5","targetNode","find","n","getHomeNode","bat","blackCount","values","c","length","redCount","checkThreeInRow","node","startCol","Math","max","min","count","startRow","r","offset","d","deserializePieces","data","result","key","GonuGame","_gameData$playerNames","_gameData$players","_gameData$playerNames2","_gameData$players2","user","userDoc","useAuth","gameId","setGameId","useState","gameData","setGameData","showCreateRoom","setShowCreateRoom","newRoomId","setNewRoomId","feedback","setFeedback","message","type","selectedPiece","setSelectedPiece","selectedGameType","setSelectedGameType","availableRooms","setAvailableRooms","showRules","setShowRules","loading","setLoading","gameMode","setGameMode","aiThinking","setAiThinking","validMoves","setValidMoves","pendingCapture","setPendingCapture","localGame","setLocalGame","isMyTurn","turn","players","B","uid","myColor","gameIdRef","useRef","useEffect","current","gameDataRef","userRef","cleanup","currentGameId","currentGameData","currentUser","status","deleteDoc","doc","db","window","addEventListener","removeEventListener","currentPieces","gameType","config","currentColor","targets","fetchAvailableRooms","useCallback","async","q","query","collection","where","querySnapshot","getDocs","rooms","_objectSpread","error","console","interval","setInterval","clearInterval","fetchGameData","gameDocRef","docSnap","getDoc","exists","rawData","setTimeout","usePolling","enabled","timer","clearTimeout","move","getAIMove","aiColor","opponentColor","aiPieces","_ref6","_ref7","possibleMoves","fromNode","toNode","targetNodeInfo","from","to","scoredMoves","score","simulatedPieces","_ref8","_ref9","opponentMoves","abs","random","sort","newPieces","playerPieces","_ref0","_ref1","targetIdx","floor","winner","prev","handleStartAIGame","handleCreateRoom","newGameId","toString","substring","gameRef","initialGameData","R","playerNames","gameName","createdAt","serverTimestamp","setDoc","concat","handleJoinRoom","targetRoomId","roomIdToJoin","trim","runTransaction","gameDoc","transaction","get","Error","update","handleCaptureClick","capturer","handleMove","includes","currentData","userDocRef","coupons","increment","logActivity","classCode","userId","userName","ACTIVITY_TYPES","GAME_WIN","couponAmount","metadata","gameVariant","_jsx","className","children","_jsxs","onClick","_ref11","value","checked","onChange","e","rule","idx","disabled","_Fragment","placeholder","maxLength","room","isAdmin","roomId","handleAdminDeleteRoom","AlchanLoading","currentGameType","currentStatus","currentWinner","currentTurn","renderBoard","width","height","viewBox","style","maxWidth","fill","rx","_ref10","x1","y1","x2","y2","stroke","strokeWidth","piece","isSelected","isValidMove","isPendingCapture","handleNodeClick","cursor","cx","cy","textAnchor","fontSize","fontWeight","opacity"],"sourceRoot":""}