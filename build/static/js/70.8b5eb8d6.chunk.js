"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[70],{1070(e,s,a){a.r(s),a.d(s,{default:()=>N});var t=a(2555),l=a(5043),c=a(5472),n=a(2864),i=a(5016),o=a(5452),d=a(8343),r=a(579);const p=[{value:"food",label:"\uc74c\uc2dd/\uac04\uc2dd",icon:"\ud83c\udf54"},{value:"craft",label:"\uc218\uacf5\uc608/\ub9cc\ub4e4\uae30",icon:"\ud83c\udfa8"},{value:"digital",label:"\ub514\uc9c0\ud138/IT",icon:"\ud83d\udcbb"},{value:"education",label:"\uad50\uc721/\uacfc\uc678",icon:"\ud83d\udcda"},{value:"entertainment",label:"\uc5d4\ud130\ud14c\uc778\uba3c\ud2b8",icon:"\ud83c\udfae"},{value:"service",label:"\uc11c\ube44\uc2a4/\ub300\ud589",icon:"\ud83d\udee0\ufe0f"},{value:"other",label:"\uae30\ud0c0",icon:"\ud83d\udce6"}],h=[{value:"product",label:"\uc0c1\ud488",icon:"\ud83d\udce6",description:"\ubb3c\uac74\uc744 \ud310\ub9e4\ud569\ub2c8\ub2e4"},{value:"service",label:"\uc11c\ube44\uc2a4",icon:"\ud83d\udee0\ufe0f",description:"\uc11c\ube44\uc2a4\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4"}],u=e=>{let{isOpen:s,onClose:a,shop:c,onSave:n}=e;const[i,d]=(0,l.useState)({shopName:"",description:"",category:"other"}),[h,u]=(0,l.useState)(!1);(0,l.useEffect)(()=>{d(c?{shopName:c.shopName||"",description:c.description||"",category:c.category||"other"}:{shopName:"",description:"",category:"other"})},[c,s]);return s?(0,r.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,r.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"modal-header",children:[(0,r.jsx)("h3",{children:c?"\uc0c1\uc810 \uc218\uc815":"\uc0c8 \uc0c1\uc810 \ub9cc\ub4e4\uae30"}),(0,r.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,r.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),i.shopName.trim()){u(!0);try{await n(i),a()}catch(s){o.vF.error("\uc0c1\uc810 \uc800\uc7a5 \uc624\ub958:",s),alert("\uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{u(!1)}}else alert("\uc0c1\uc810 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!")},className:"modal-content",children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"\uc0c1\uc810 \uc774\ub984 *"}),(0,r.jsx)("input",{type:"text",value:i.shopName,onChange:e=>d((0,t.A)((0,t.A)({},i),{},{shopName:e.target.value})),placeholder:"\uc608: \ubbfc\uc218\ub124 \uac04\uc2dd\uac00\uac8c",maxLength:20})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"\uc5c5\uc885"}),(0,r.jsx)("select",{value:i.category,onChange:e=>d((0,t.A)((0,t.A)({},i),{},{category:e.target.value})),children:p.map(e=>(0,r.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"\uc0c1\uc810 \uc18c\uac1c"}),(0,r.jsx)("textarea",{value:i.description,onChange:e=>d((0,t.A)((0,t.A)({},i),{},{description:e.target.value})),placeholder:"\uc6b0\ub9ac \uac00\uac8c\ub97c \uc18c\uac1c\ud574\uc8fc\uc138\uc694!",rows:3,maxLength:100})]}),(0,r.jsxs)("div",{className:"modal-footer",children:[(0,r.jsx)("button",{type:"button",onClick:a,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,r.jsx)("button",{type:"submit",disabled:h,className:"modal-button confirm",children:h?"\uc800\uc7a5 \uc911...":c?"\uc218\uc815\ud558\uae30":"\ub9cc\ub4e4\uae30"})]})]})]})}):null},m=e=>{let{isOpen:s,onClose:a,product:c,shopId:n,onSave:i}=e;const[p,u]=(0,l.useState)({type:"product",name:"",description:"",price:"",stock:""}),[m,x]=(0,l.useState)(!1),v=(0,l.useMemo)(()=>{const e=parseInt(p.price)||0;return Math.round(.1*e)},[p.price]),j=(0,l.useMemo)(()=>(parseInt(p.price)||0)+v,[p.price,v]);(0,l.useEffect)(()=>{var e;c?u({type:c.type||"product",name:c.name||"",description:c.description||"",price:(null===(e=c.price)||void 0===e?void 0:e.toString())||"",stock:c.stock>=0?c.stock.toString():""}):u({type:"product",name:"",description:"",price:"",stock:""})},[c,s]);return s?(0,r.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,r.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"modal-header",children:[(0,r.jsx)("h3",{children:c?"\uc0c1\ud488/\uc11c\ube44\uc2a4 \uc218\uc815":"\uc0c8 \uc0c1\ud488/\uc11c\ube44\uc2a4 \ub4f1\ub85d"}),(0,r.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,r.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p.name.trim())if(!p.price||parseInt(p.price)<=0)alert("\uc62c\ubc14\ub978 \uac00\uaca9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!");else if("product"!==p.type||p.stock&&!(parseInt(p.stock)<=0)){x(!0);try{const e={type:p.type,name:p.name.trim(),description:p.description.trim(),price:parseInt(p.price),taxAmount:v,totalPrice:j,stock:"service"===p.type?-1:parseInt(p.stock)};await i(e),a()}catch(s){o.vF.error("\uc0c1\ud488 \uc800\uc7a5 \uc624\ub958:",s),alert("\uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{x(!1)}}else alert("\uc0c1\ud488\uc758 \uc7ac\uace0 \uc218\ub7c9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!");else alert("\uc0c1\ud488/\uc11c\ube44\uc2a4 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694!")},className:"modal-content",children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"\uc885\ub958 *"}),(0,r.jsx)("div",{className:"type-selector",children:h.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>u((0,t.A)((0,t.A)({},p),{},{type:e.value})),className:"type-button ".concat(p.type===e.value?"active":""),children:[(0,r.jsx)("span",{className:"type-icon",children:e.icon}),(0,r.jsx)("span",{className:"type-label",children:e.label}),(0,r.jsx)("span",{className:"type-desc",children:e.description})]},e.value))})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{children:["product"===p.type?"\uc0c1\ud488\uba85":"\uc11c\ube44\uc2a4\uba85"," *"]}),(0,r.jsx)("input",{type:"text",value:p.name,onChange:e=>u((0,t.A)((0,t.A)({},p),{},{name:e.target.value})),placeholder:"product"===p.type?"\uc608: \uc218\uc81c \ucfe0\ud0a4":"\uc608: \uc218\ud559 \uacfc\uc678",maxLength:30})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"\uc124\uba85"}),(0,r.jsx)("textarea",{value:p.description,onChange:e=>u((0,t.A)((0,t.A)({},p),{},{description:e.target.value})),placeholder:"\uc0c1\ud488/\uc11c\ube44\uc2a4\uc5d0 \ub300\ud574 \uc124\uba85\ud574\uc8fc\uc138\uc694",rows:2,maxLength:100})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"\uac00\uaca9 (\uc138\uc804) *"}),(0,r.jsxs)("div",{className:"input-with-suffix",children:[(0,r.jsx)("input",{type:"number",value:p.price,onChange:e=>u((0,t.A)((0,t.A)({},p),{},{price:e.target.value})),placeholder:"0",min:"1"}),(0,r.jsx)("span",{className:"suffix",children:"\uc6d0"})]})]}),p.price&&parseInt(p.price)>0&&(0,r.jsxs)("div",{className:"tax-info-box",children:[(0,r.jsxs)("div",{className:"tax-row",children:[(0,r.jsx)("span",{children:"\uc0c1\ud488 \uac00\uaca9"}),(0,r.jsx)("span",{children:(0,d.bL)(parseInt(p.price))})]}),(0,r.jsxs)("div",{className:"tax-row highlight",children:[(0,r.jsx)("span",{children:"+ \ubd80\uac00\uc138 (10%)"}),(0,r.jsxs)("span",{children:["+",(0,d.bL)(v)]})]}),(0,r.jsxs)("div",{className:"tax-row total",children:[(0,r.jsx)("span",{children:"\ud310\ub9e4 \uac00\uaca9"}),(0,r.jsx)("span",{className:"neon-text",children:(0,d.bL)(j)})]}),(0,r.jsx)("p",{className:"tax-notice",children:"\ubd80\uac00\uc138 10%\ub294 \uad6d\uc138\uccad\uc5d0 \uc790\ub3d9 \ub0a9\ubd80\ub429\ub2c8\ub2e4"})]}),"product"===p.type&&(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"\uc7ac\uace0 \uc218\ub7c9 *"}),(0,r.jsxs)("div",{className:"input-with-suffix",children:[(0,r.jsx)("input",{type:"number",value:p.stock,onChange:e=>u((0,t.A)((0,t.A)({},p),{},{stock:e.target.value})),placeholder:"0",min:"1"}),(0,r.jsx)("span",{className:"suffix",children:"\uac1c"})]})]}),(0,r.jsxs)("div",{className:"modal-footer",children:[(0,r.jsx)("button",{type:"button",onClick:a,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,r.jsx)("button",{type:"submit",disabled:m,className:"modal-button confirm",children:m?"\uc800\uc7a5 \uc911...":c?"\uc218\uc815\ud558\uae30":"\ub4f1\ub85d\ud558\uae30"})]})]})]})}):null},x=e=>{let{isOpen:s,onClose:a,product:t,shop:c,onConfirm:n}=e;const[i,o]=(0,l.useState)(1),[p,h]=(0,l.useState)(!1),u=(0,l.useMemo)(()=>t?t.totalPrice*i:0,[t,i]);if(!s||!t)return null;const m="service"===t.type?10:Math.min(t.stock,10);return(0,r.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,r.jsxs)("div",{className:"modal-container",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"modal-header",children:[(0,r.jsx)("h3",{children:"\uad6c\ub9e4 \ud655\uc778"}),(0,r.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsxs)("div",{className:"purchase-item-info",children:[(0,r.jsx)("div",{className:"item-icon",children:"product"===t.type?"\ud83d\udce6":"\ud83d\udee0\ufe0f"}),(0,r.jsxs)("div",{className:"item-details",children:[(0,r.jsx)("h4",{children:t.name}),(0,r.jsx)("p",{className:"shop-name",children:null===c||void 0===c?void 0:c.shopName}),(0,r.jsxs)("p",{className:"item-price",children:[(0,d.bL)(t.totalPrice)," (\ubd80\uac00\uc138 \ud3ec\ud568)"]})]})]}),(0,r.jsxs)("div",{className:"quantity-selector",children:[(0,r.jsx)("label",{children:"product"===t.type?"\uad6c\ub9e4 \uc218\ub7c9":"\uc774\uc6a9 \ud69f\uc218"}),(0,r.jsxs)("div",{className:"quantity-controls",children:[(0,r.jsx)("button",{onClick:()=>o(Math.max(1,i-1)),className:"quantity-btn",children:"-"}),(0,r.jsx)("span",{className:"quantity-value",children:i}),(0,r.jsx)("button",{onClick:()=>o(Math.min(m,i+1)),className:"quantity-btn",children:"+"}),"product"===t.type&&(0,r.jsxs)("span",{className:"stock-info",children:["(\uc7ac\uace0: ",t.stock,"\uac1c)"]})]})]}),(0,r.jsxs)("div",{className:"total-amount-box",children:[(0,r.jsx)("span",{children:"\ucd1d \uacb0\uc81c \uae08\uc561"}),(0,r.jsx)("span",{className:"total-price neon-text",children:(0,d.bL)(u)})]})]}),(0,r.jsxs)("div",{className:"modal-footer",children:[(0,r.jsx)("button",{onClick:a,className:"modal-button cancel",children:"\ucde8\uc18c"}),(0,r.jsx)("button",{onClick:async()=>{h(!0);try{await n(i),a()}catch(e){alert(e.message||"\uad6c\ub9e4 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{h(!1)}},disabled:p,className:"modal-button confirm",children:p?"\ucc98\ub9ac \uc911...":"\uad6c\ub9e4\ud558\uae30"})]})]})})},v=e=>{let{shop:s,onClick:a}=e;const t=p.find(e=>e.value===s.category);return(0,r.jsxs)("div",{onClick:a,className:"shop-card",children:[(0,r.jsxs)("div",{className:"shop-card-header",children:[(0,r.jsx)("div",{className:"shop-icon",children:(null===t||void 0===t?void 0:t.icon)||"\ud83c\udfea"}),(0,r.jsxs)("div",{className:"shop-info",children:[(0,r.jsx)("h3",{className:"shop-name",children:s.shopName}),(0,r.jsxs)("p",{className:"shop-owner",children:[s.ownerName,"\ub2d8\uc758 \uac00\uac8c"]})]})]}),s.description&&(0,r.jsx)("p",{className:"shop-description",children:s.description}),(0,r.jsxs)("div",{className:"shop-card-footer",children:[(0,r.jsx)("span",{className:"shop-category",children:(null===t||void 0===t?void 0:t.label)||"\uae30\ud0c0"}),(0,r.jsxs)("span",{className:"shop-sales",children:["\ucd1d \ub9e4\ucd9c: ",(0,d.bL)(s.totalSales||0)]})]})]})},j=e=>{let{product:s,shop:a,onBuy:t,isOwner:l,onEdit:c,onDelete:n}=e;return(0,r.jsxs)("div",{className:"product-card",children:[(0,r.jsxs)("div",{className:"product-card-header",children:[(0,r.jsx)("div",{className:"product-icon",children:"product"===s.type?"\ud83d\udce6":"\ud83d\udee0\ufe0f"}),(0,r.jsxs)("div",{className:"product-info",children:[(0,r.jsxs)("div",{className:"product-title-row",children:[(0,r.jsx)("h4",{className:"product-name",children:s.name}),(0,r.jsx)("span",{className:"product-type-badge ".concat(s.type),children:"product"===s.type?"\uc0c1\ud488":"\uc11c\ube44\uc2a4"})]}),s.description&&(0,r.jsx)("p",{className:"product-description",children:s.description}),(0,r.jsxs)("div",{className:"product-price-row",children:[(0,r.jsx)("span",{className:"product-price neon-text",children:(0,d.bL)(s.totalPrice)}),(0,r.jsx)("span",{className:"vat-included",children:"(VAT \ud3ec\ud568)"}),"product"===s.type&&(0,r.jsx)("span",{className:"stock-badge ".concat(s.stock>0?"":"soldout"),children:s.stock>0?"\uc7ac\uace0 ".concat(s.stock,"\uac1c"):"\ud488\uc808"})]})]})]}),(0,r.jsx)("div",{className:"product-card-actions",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>c(s),className:"action-btn edit",children:"\u270f\ufe0f \uc218\uc815"}),(0,r.jsx)("button",{onClick:()=>n(s),className:"action-btn delete",children:"\ud83d\uddd1\ufe0f \uc0ad\uc81c"})]}):(0,r.jsx)("button",{onClick:()=>t(s,a),disabled:"product"===s.type&&s.stock<=0,className:"action-btn buy",children:"product"===s.type&&s.stock<=0?"\ud488\uc808":"\ud83d\uded2 \uad6c\ub9e4\ud558\uae30"})})]})},N=()=>{const{user:e,userDoc:s,refreshUserDocument:h}=(0,i.As)(),[N,b]=(0,l.useState)("browse"),[y,f]=(0,l.useState)([]),[w,g]=(0,l.useState)(null),[k,C]=(0,l.useState)([]),[A,S]=(0,l.useState)(null),[D,I]=(0,l.useState)([]),[P,O]=(0,l.useState)(!1),[L,q]=(0,l.useState)(!1),[H,V]=(0,l.useState)(null),[E,G]=(0,l.useState)(null),[M,J]=(0,l.useState)(null),[T,F]=(0,l.useState)(!0),[U,_]=(0,l.useState)(!1),[B,Z]=(0,l.useState)("all"),[R,z]=(0,l.useState)(""),K=(0,l.useCallback)(async()=>{try{F(!0);const e=(0,c.rJ)(n.db,"personalShops"),s=(0,c.query)(e,(0,c.where)("status","==","active")),a=(await(0,c.getDocs)(s)).docs.map(e=>(0,t.A)({id:e.id},e.data())).sort((e,s)=>{var a,t,l,c;const n=(null===(a=e.createdAt)||void 0===a||null===(t=a.toDate)||void 0===t?void 0:t.call(a))||new Date(0);return((null===(l=s.createdAt)||void 0===l||null===(c=l.toDate)||void 0===c?void 0:c.call(l))||new Date(0))-n}).slice(0,50);f(a)}catch(e){o.vF.error("\uc0c1\uc810 \ubaa9\ub85d \ub85c\ub4dc \uc624\ub958:",e)}finally{F(!1)}},[]),Q=(0,l.useCallback)(async()=>{if(e)try{const s=(0,c.rJ)(n.db,"personalShops"),a=(0,c.query)(s,(0,c.where)("ownerId","==",e.uid),(0,c.limit)(1)),l=await(0,c.getDocs)(a);if(!l.empty){const e=(0,t.A)({id:l.docs[0].id},l.docs[0].data());g(e);const s=(0,c.rJ)(n.db,"shopProducts"),a=(0,c.query)(s,(0,c.where)("shopId","==",e.id)),i=(await(0,c.getDocs)(a)).docs.map(e=>(0,t.A)({id:e.id},e.data())).sort((e,s)=>{var a,t,l,c;const n=(null===(a=e.createdAt)||void 0===a||null===(t=a.toDate)||void 0===t?void 0:t.call(a))||new Date(0);return((null===(l=s.createdAt)||void 0===l||null===(c=l.toDate)||void 0===c?void 0:c.call(l))||new Date(0))-n});C(i)}}catch(s){o.vF.error("\ub0b4 \uc0c1\uc810 \ub85c\ub4dc \uc624\ub958:",s)}},[e]),W=(0,l.useCallback)(async e=>{try{_(!0);const s=(0,c.rJ)(n.db,"shopProducts"),a=(0,c.query)(s,(0,c.where)("shopId","==",e)),l=(await(0,c.getDocs)(a)).docs.map(e=>(0,t.A)({id:e.id},e.data())).filter(e=>"available"===e.status).sort((e,s)=>{var a,t,l,c;const n=(null===(a=e.createdAt)||void 0===a||null===(t=a.toDate)||void 0===t?void 0:t.call(a))||new Date(0);return((null===(l=s.createdAt)||void 0===l||null===(c=l.toDate)||void 0===c?void 0:c.call(l))||new Date(0))-n});I(l)}catch(s){o.vF.error("\uc0c1\ud488 \ub85c\ub4dc \uc624\ub958:",s)}finally{_(!1)}},[]);(0,l.useEffect)(()=>{K(),Q()},[K,Q]),(0,l.useEffect)(()=>{A&&W(A.id)},[A,W]);const X=async e=>{window.confirm('"'.concat(e.name,'"\uc744(\ub97c) \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?'))&&(await(0,c.kd)((0,c.H9)(n.db,"shopProducts",e.id)),await Q())},Y=(0,l.useMemo)(()=>y.filter(e=>{if("all"!==B&&e.category!==B)return!1;if(R){const s=R.toLowerCase();return e.shopName.toLowerCase().includes(s)||e.ownerName.toLowerCase().includes(s)||e.description&&e.description.toLowerCase().includes(s)}return!0}),[y,B,R]);return(0,r.jsxs)("div",{className:"personal-shop-container",children:[(0,r.jsxs)("div",{className:"market-header",children:[(0,r.jsx)("h1",{children:"\uac1c\uc778 \uc0c1\uc810"}),(0,r.jsx)("p",{className:"header-subtitle",children:"\ub098\ub9cc\uc758 \uc0c1\uc810\uc744 \uc5f4\uace0 \uc0c1\ud488/\uc11c\ube44\uc2a4\ub97c \ud310\ub9e4\ud574\ubcf4\uc138\uc694!"})]}),(0,r.jsx)("div",{className:"market-tabs",children:[{id:"browse",label:"\uc0c1\uc810 \ub458\ub7ec\ubcf4\uae30",icon:"\ud83d\udecd\ufe0f"},{id:"myshop",label:"\ub0b4 \uc0c1\uc810",icon:"\ud83c\udfea"},{id:"sales",label:"\ud310\ub9e4 \ub0b4\uc5ed",icon:"\ud83d\udcca"}].map(e=>(0,r.jsxs)("button",{onClick:()=>{b(e.id),S(null)},className:"tab-button ".concat(N===e.id?"active":""),children:[(0,r.jsx)("span",{className:"tab-icon",children:e.icon}),(0,r.jsx)("span",{className:"tab-label",children:e.label})]},e.id))}),(()=>{var e,s,a;switch(N){case"browse":return(0,r.jsx)("div",{className:"tab-content",children:A?(0,r.jsxs)("div",{className:"shop-detail-view",children:[(0,r.jsx)("button",{onClick:()=>{S(null),I([])},className:"back-button",children:"\u2190 \uc0c1\uc810 \ubaa9\ub85d\uc73c\ub85c"}),(0,r.jsxs)("div",{className:"shop-detail-header",children:[(0,r.jsx)("div",{className:"shop-detail-icon",children:(null===(e=p.find(e=>e.value===A.category))||void 0===e?void 0:e.icon)||"\ud83c\udfea"}),(0,r.jsxs)("div",{className:"shop-detail-info",children:[(0,r.jsx)("h2",{children:A.shopName}),(0,r.jsxs)("p",{className:"owner",children:[A.ownerName,"\ub2d8\uc758 \uac00\uac8c"]}),A.description&&(0,r.jsx)("p",{className:"description",children:A.description})]})]}),(0,r.jsxs)("div",{className:"products-section",children:[(0,r.jsx)("h3",{children:"\ud310\ub9e4 \uc0c1\ud488"}),U?(0,r.jsx)("div",{className:"loading-state",children:"\uc0c1\ud488\uc744 \ubd88\ub7ec\uc624\ub294 \uc911..."}):0===D.length?(0,r.jsxs)("div",{className:"empty-state",children:[(0,r.jsx)("span",{className:"empty-icon",children:"\ud83d\udced"}),(0,r.jsx)("p",{children:"\ub4f1\ub85d\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"})]}):(0,r.jsx)("div",{className:"products-grid",children:D.map(e=>(0,r.jsx)(j,{product:e,shop:A,onBuy:(e,s)=>{G(e),J(s)},isOwner:!1},e.id))})]})]}):(0,r.jsxs)("div",{className:"shop-list-view",children:[(0,r.jsxs)("div",{className:"controls-section",children:[(0,r.jsx)("div",{className:"search-box",children:(0,r.jsx)("input",{type:"text",value:R,onChange:e=>z(e.target.value),placeholder:"\uc0c1\uc810 \uac80\uc0c9...",className:"search-input"})}),(0,r.jsxs)("select",{value:B,onChange:e=>Z(e.target.value),className:"category-filter",children:[(0,r.jsx)("option",{value:"all",children:"\uc804\uccb4 \uc5c5\uc885"}),p.map(e=>(0,r.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))]})]}),T?(0,r.jsx)("div",{className:"loading-state",children:"\uc0c1\uc810\uc744 \ubd88\ub7ec\uc624\ub294 \uc911..."}):0===Y.length?(0,r.jsxs)("div",{className:"empty-state",children:[(0,r.jsx)("span",{className:"empty-icon",children:"\ud83c\udfea"}),(0,r.jsx)("p",{children:R||"all"!==B?"\uac80\uc0c9 \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4":"\uc544\uc9c1 \ub4f1\ub85d\ub41c \uc0c1\uc810\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"})]}):(0,r.jsx)("div",{className:"shops-grid",children:Y.map(e=>(0,r.jsx)(v,{shop:e,onClick:()=>S(e)},e.id))})]})});case"myshop":return(0,r.jsx)("div",{className:"tab-content",children:w?(0,r.jsxs)("div",{className:"my-shop-view",children:[(0,r.jsxs)("div",{className:"my-shop-header",children:[(0,r.jsxs)("div",{className:"my-shop-info",children:[(0,r.jsx)("div",{className:"my-shop-icon",children:(null===(s=p.find(e=>e.value===w.category))||void 0===s?void 0:s.icon)||"\ud83c\udfea"}),(0,r.jsxs)("div",{className:"my-shop-details",children:[(0,r.jsx)("h2",{children:w.shopName}),(0,r.jsx)("p",{className:"category",children:null===(a=p.find(e=>e.value===w.category))||void 0===a?void 0:a.label}),w.description&&(0,r.jsx)("p",{className:"description",children:w.description})]}),(0,r.jsx)("button",{onClick:()=>O(!0),className:"edit-shop-btn",children:"\u270f\ufe0f \uc218\uc815"})]}),(0,r.jsxs)("div",{className:"my-shop-stats",children:[(0,r.jsxs)("div",{className:"stat-item",children:[(0,r.jsx)("span",{className:"stat-label",children:"\ucd1d \ub9e4\ucd9c"}),(0,r.jsx)("span",{className:"stat-value neon-text",children:(0,d.bL)(w.totalSales||0)})]}),(0,r.jsxs)("div",{className:"stat-item",children:[(0,r.jsx)("span",{className:"stat-label",children:"\ub0a9\ubd80\ud55c \ubd80\uac00\uc138"}),(0,r.jsx)("span",{className:"stat-value",children:(0,d.bL)(w.totalTaxPaid||0)})]})]})]}),(0,r.jsxs)("div",{className:"products-header",children:[(0,r.jsxs)("h3",{children:["\ub0b4 \uc0c1\ud488/\uc11c\ube44\uc2a4 (",k.length,")"]}),(0,r.jsx)("button",{onClick:()=>{V(null),q(!0)},className:"add-product-btn",children:"\u2795 \ub4f1\ub85d\ud558\uae30"})]}),0===k.length?(0,r.jsxs)("div",{className:"empty-state",children:[(0,r.jsx)("span",{className:"empty-icon",children:"\ud83d\udce6"}),(0,r.jsx)("p",{children:"\ub4f1\ub85d\ub41c \uc0c1\ud488\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,r.jsx)("span",{className:"empty-hint",children:"\uc0c1\ud488\uc774\ub098 \uc11c\ube44\uc2a4\ub97c \ub4f1\ub85d\ud574\ubcf4\uc138\uc694!"})]}):(0,r.jsx)("div",{className:"products-grid",children:k.map(e=>(0,r.jsx)(j,{product:e,shop:w,isOwner:!0,onEdit:e=>{V(e),q(!0)},onDelete:X},e.id))})]}):(0,r.jsx)("div",{className:"create-shop-view",children:(0,r.jsxs)("div",{className:"create-shop-card",children:[(0,r.jsx)("span",{className:"create-icon",children:"\ud83c\udfea"}),(0,r.jsx)("h2",{children:"\ub098\ub9cc\uc758 \uc0c1\uc810\uc744 \ub9cc\ub4e4\uc5b4\ubcf4\uc138\uc694!"}),(0,r.jsx)("p",{children:"\uc0c1\ud488\uc774\ub098 \uc11c\ube44\uc2a4\ub97c \ud310\ub9e4\ud558\uace0 \uc218\uc775\uc744 \uc62c\ub824\ubcf4\uc138\uc694"}),(0,r.jsx)("button",{onClick:()=>O(!0),className:"create-shop-btn",children:"\ud83c\udfea \uc0c1\uc810 \ub9cc\ub4e4\uae30"})]})})});case"sales":return(0,r.jsx)("div",{className:"tab-content",children:(0,r.jsxs)("div",{className:"empty-state",children:[(0,r.jsx)("span",{className:"empty-icon",children:"\ud83d\udcca"}),(0,r.jsx)("p",{children:"\ud310\ub9e4 \ub0b4\uc5ed \uae30\ub2a5 \uc900\ube44 \uc911..."})]})});default:return null}})(),(0,r.jsx)(u,{isOpen:P,onClose:()=>O(!1),shop:w,onSave:async a=>{e&&(w?await(0,c.mZ)((0,c.H9)(n.db,"personalShops",w.id),(0,t.A)((0,t.A)({},a),{},{updatedAt:(0,c.O5)()})):await(0,c.addDoc)((0,c.rJ)(n.db,"personalShops"),(0,t.A)((0,t.A)({},a),{},{ownerId:e.uid,ownerName:(null===s||void 0===s?void 0:s.name)||"\uc775\uba85",status:"active",totalSales:0,totalTaxPaid:0,createdAt:(0,c.O5)(),updatedAt:(0,c.O5)()})),await Q(),await K())}}),(0,r.jsx)(m,{isOpen:L,onClose:()=>{q(!1),V(null)},product:H,shopId:null===w||void 0===w?void 0:w.id,onSave:async s=>{w&&(H?await(0,c.mZ)((0,c.H9)(n.db,"shopProducts",H.id),(0,t.A)((0,t.A)({},s),{},{updatedAt:(0,c.O5)()})):await(0,c.addDoc)((0,c.rJ)(n.db,"shopProducts"),(0,t.A)((0,t.A)({},s),{},{shopId:w.id,ownerId:e.uid,status:"available",soldCount:0,createdAt:(0,c.O5)(),updatedAt:(0,c.O5)()})),V(null),await Q())}}),(0,r.jsx)(x,{isOpen:!!E,onClose:()=>{G(null),J(null)},product:E,shop:M,onConfirm:async t=>{if(!e||!E||!M)throw new Error("\uad6c\ub9e4 \uc815\ubcf4\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");const l=E.totalPrice*t,i=E.taxAmount*t,o=E.price*t;if(((null===s||void 0===s?void 0:s.cash)||0)<l)throw new Error("\uc794\uc561\uc774 \ubd80\uc871\ud569\ub2c8\ub2e4!");if(M.ownerId===e.uid)throw new Error("\ubcf8\uc778 \uc0c1\uc810\uc5d0\uc11c\ub294 \uad6c\ub9e4\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4!");const d=null===s||void 0===s?void 0:s.classCode;let r=null;if(d){const{getClassAdminUid:e}=await Promise.resolve().then(a.bind(a,3744));r=await e(d)}await(0,c.c4)(n.db,async a=>{const p=(0,c.H9)(n.db,"users",e.uid);a.update(p,{cash:(0,c.GV)(-l)});const h=(0,c.H9)(n.db,"users",M.ownerId);if(a.update(h,{cash:(0,c.GV)(o)}),d){const e=(0,c.H9)(n.db,"nationalTreasuries",d);if(a.set(e,{totalAmount:(0,c.GV)(i),vatRevenue:(0,c.GV)(i),lastUpdated:(0,c.O5)()},{merge:!0}),r){const e=(0,c.H9)(n.db,"users",r);a.update(e,{cash:(0,c.GV)(i),updatedAt:(0,c.O5)()})}}const u=(0,c.H9)(n.db,"personalShops",M.id);a.update(u,{totalSales:(0,c.GV)(o),totalTaxPaid:(0,c.GV)(i)});const m=(0,c.H9)(n.db,"shopProducts",E.id),x={soldCount:(0,c.GV)(t)};"product"===E.type&&(x.stock=(0,c.GV)(-t),E.stock-t<=0&&(x.status="soldout")),a.update(m,x);const v=(0,c.rJ)(n.db,"activities");a.set((0,c.H9)(v),{type:"shop_purchase",buyerId:e.uid,buyerName:(null===s||void 0===s?void 0:s.name)||"\uc775\uba85",sellerId:M.ownerId,sellerName:M.ownerName,shopId:M.id,shopName:M.shopName,productId:E.id,productName:E.name,productType:E.type,quantity:t,unitPrice:E.totalPrice,totalAmount:l,taxAmount:i,timestamp:(0,c.O5)()})}),h&&await h(),A&&await W(A.id),G(null),J(null),alert("\uad6c\ub9e4\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4!")}})]})}}}]);
//# sourceMappingURL=70.8b5eb8d6.chunk.js.map