{"version":3,"file":"static/js/785.68c631c0.chunk.js","mappings":"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","sources":["pages/real-estate/RealEstateRegistry.js"],"sourcesContent":["/* src/pages/real-estate/RealEstateRegistry.js (ëª¨ë“  í•¨ìˆ˜ê°€ í¬í•¨ëœ ìµœì¢…ë³¸ - ê´€ë¦¬ì ê¸°ëŠ¥ ê°•í™”) */\r\nimport React, { useState, useEffect } from \"react\";\r\nimport \"./RealEstateRegistry.css\";\r\nimport { useAuth } from \"../../contexts/AuthContext\";\r\n\r\n// firebase.jsì—ì„œ ìµìŠ¤í¬íŠ¸í•˜ëŠ” í•¨ìˆ˜ë“¤\r\nimport {\r\n  db,\r\n  functions,\r\n  serverTimestamp,\r\n  collection,\r\n  doc,\r\n  getDoc,\r\n  getDocs,\r\n  setDoc,\r\n  updateDoc,\r\n  writeBatch,\r\n  query,\r\n  where,\r\n  runTransaction,\r\n  increment,\r\n} from \"../../firebase\";\r\nimport { httpsCallable } from \"firebase/functions\";\r\nimport { globalCache } from \"../../services/globalCacheService\";\r\n\r\nimport { logger } from \"../../utils/logger\";\n// onSnapshotê³¼ orderByëŠ” firebase/firestoreì—ì„œ ì§ì ‘ ê°€ì ¸ì˜µë‹ˆë‹¤.\r\nimport {\r\n  onSnapshot as firebaseOnSnapshot,\r\n  orderBy as firebaseOrderBy,\r\n} from \"firebase/firestore\";\r\n\r\nconst DEFAULT_SETTINGS = {\r\n  totalProperties: 30,\r\n  basePrice: 50000000,\r\n  rentPercentage: 1,\r\n  layoutColumns: 6,\r\n  lastRentCollection: null,\r\n};\r\n\r\nconst RealEstateRegistry = () => {\r\n  const {\r\n    userDoc: currentUser,\r\n    loading: authLoading,\r\n    isAdmin,\r\n    refreshUserDocument,\r\n    optimisticUpdate,\r\n    allClassMembers, // ğŸ”¥ [ì¶”ê°€] í•™ê¸‰ êµ¬ì„±ì› ë°ì´í„°\r\n  } = useAuth();\r\n\r\n  const classCode = currentUser?.classCode;\r\n\r\n  const [properties, setProperties] = useState([]);\r\n  const [settings, setSettings] = useState(DEFAULT_SETTINGS);\r\n  const [allUsersData, setAllUsersData] = useState([]);\r\n\r\n  const [settingsLoading, setSettingsLoading] = useState(true);\r\n  const [propertiesLoading, setPropertiesLoading] = useState(true);\r\n  const [usersLoading, setUsersLoading] = useState(true);\r\n\r\n  const [showAdminPanel, setShowAdminPanel] = useState(false);\r\n  const [operationLoading, setOperationLoading] = useState(false);\r\n  const [selectedProperty, setSelectedProperty] = useState(null);\r\n  const [showQuickAction, setShowQuickAction] = useState(null);\r\n  const [adminInputs, setAdminInputs] = useState({ ...DEFAULT_SETTINGS });\r\n\r\n  // ğŸ”¥ [ì œê±°] body ìŠ¤í¬ë¡¤ ì¡°ì‘ ì™„ì „ ì œê±° - CSSë¡œë§Œ ì²˜ë¦¬\r\n  // ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ì— overflow-y: auto ì„¤ì •ìœ¼ë¡œ ëª¨ë‹¬ ë‚´ë¶€ ìŠ¤í¬ë¡¤ í—ˆìš©\r\n  // bodyëŠ” ì „í˜€ ê±´ë“œë¦¬ì§€ ì•Šì•„ì„œ ë ˆì´ì•„ì›ƒ ê¹¨ì§ ë°©ì§€\r\n\r\n  // Settings ë¡œë“œ Effect (í´ë§ ë°©ì‹ìœ¼ë¡œ ë³€ê²½ - ë¬´í•œ ë£¨í”„ ë°©ì§€)\r\n  useEffect(() => {\r\n    if (!classCode) {\r\n      setSettings(DEFAULT_SETTINGS);\r\n      setAdminInputs({ ...DEFAULT_SETTINGS });\r\n      setSettingsLoading(false);\r\n      return;\r\n    }\r\n\r\n    let mounted = true;\r\n    setSettingsLoading(true);\r\n\r\n    const settingsRefInstance = doc(\r\n      db,\r\n      \"classes\",\r\n      classCode,\r\n      \"realEstateSettings\",\r\n      \"settingsDoc\"\r\n    );\r\n\r\n    const fetchSettings = async () => {\r\n      if (!mounted) return;\r\n\r\n      try {\r\n        const docSnap = await getDoc(settingsRefInstance);\r\n        if (!mounted) return;\r\n\r\n        if (docSnap.exists()) {\r\n          const fetchedSettings = docSnap.data();\r\n          if (fetchedSettings.lastRentCollection?.toDate) {\r\n            fetchedSettings.lastRentCollection =\r\n              fetchedSettings.lastRentCollection.toDate();\r\n          }\r\n          setSettings(fetchedSettings);\r\n          setAdminInputs({\r\n            totalProperties: fetchedSettings.totalProperties.toString(),\r\n            basePrice: fetchedSettings.basePrice.toString(),\r\n            rentPercentage: fetchedSettings.rentPercentage.toString(),\r\n            layoutColumns: fetchedSettings.layoutColumns.toString(),\r\n          });\r\n        } else {\r\n          // ì„¤ì •ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš© (ê´€ë¦¬ìë§Œ ìƒì„± ê°€ëŠ¥)\r\n          if (mounted) {\r\n            setSettings(DEFAULT_SETTINGS);\r\n            setAdminInputs({ ...DEFAULT_SETTINGS });\r\n          }\r\n\r\n          // ê´€ë¦¬ìì¸ ê²½ìš°ì—ë§Œ ê¸°ë³¸ ì„¤ì • ìƒì„± ì‹œë„\r\n          if (isAdmin && isAdmin()) {\r\n            try {\r\n              await setDoc(settingsRefInstance, {\r\n                ...DEFAULT_SETTINGS,\r\n                createdAt: serverTimestamp(),\r\n                classCode: classCode,\r\n                updatedAt: serverTimestamp(),\r\n              });\r\n            } catch (error) {\r\n              console.warn(\"[RealEstate] ê¸°ë³¸ ì„¤ì • ìƒì„± ì‹¤íŒ¨ (ê´€ë¦¬ìë§Œ ê°€ëŠ¥):\", error.message);\r\n            }\r\n          }\r\n        }\r\n        if (mounted) {\r\n          setSettingsLoading(false);\r\n        }\r\n      } catch (error) {\r\n        // í•™ìƒ ê³„ì •ì€ settings ì½ê¸° ê¶Œí•œì´ ì—†ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ warnìœ¼ë¡œ ì²˜ë¦¬\r\n        console.warn(\"[RealEstate] Settings ì½ê¸° ì‹¤íŒ¨ (ê¸°ë³¸ê°’ ì‚¬ìš©):\", error.message);\r\n        if (mounted) {\r\n          setSettings(DEFAULT_SETTINGS);\r\n          setAdminInputs({ ...DEFAULT_SETTINGS });\r\n          setSettingsLoading(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchSettings(); // ì´ˆê¸° ë¡œë“œ\r\n    const interval = setInterval(fetchSettings, 15 * 60 * 1000); // ğŸ”¥ [ìµœì í™”] 15ë¶„ë§ˆë‹¤ í´ë§ (Firestore ì½ê¸° ìµœì†Œí™”)\r\n\r\n    return () => {\r\n      mounted = false;\r\n      clearInterval(interval);\r\n    };\r\n  }, [classCode]);\r\n\r\n  // ğŸ”¥ Properties ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜ (ë‚™ê´€ì  ì—…ë°ì´íŠ¸ í›„ ì„œë²„ ë°ì´í„°ì™€ ë™ê¸°í™”)\r\n  const refreshProperties = React.useCallback(async () => {\r\n    if (!classCode) return;\r\n\r\n    try {\r\n      const propertiesCollectionRefInstance = collection(\r\n        db,\r\n        \"classes\",\r\n        classCode,\r\n        \"realEstateProperties\"\r\n      );\r\n      const q = query(propertiesCollectionRefInstance, firebaseOrderBy(\"id\"));\r\n      const querySnapshot = await getDocs(q);\r\n\r\n      const propsData = querySnapshot.docs.map((doc) => ({\r\n        firestoreDocId: doc.id,\r\n        ...doc.data(),\r\n        lastRentPayment: doc.data().lastRentPayment?.toDate\r\n          ? doc.data().lastRentPayment.toDate()\r\n          : null,\r\n      }));\r\n      propsData.sort((a, b) => parseInt(a.id) - parseInt(b.id));\r\n\r\n      setProperties(propsData);\r\n      logger.log('[RealEstate] Properties refreshed:', propsData.length);\r\n    } catch (error) {\r\n      console.error(\"[RealEstate] Error refreshing properties:\", error);\r\n    }\r\n  }, [classCode]);\r\n\r\n  // Properties ë¡œë“œ Effect (í´ë§ ë°©ì‹ìœ¼ë¡œ ë³€ê²½ - ë¬´í•œ ë£¨í”„ ë°©ì§€)\r\n  useEffect(() => {\r\n    if (!classCode) {\r\n      setProperties([]);\r\n      setPropertiesLoading(false);\r\n      return;\r\n    }\r\n\r\n    let mounted = true;\r\n    setPropertiesLoading(true);\r\n\r\n    const propertiesCollectionRefInstance = collection(\r\n      db,\r\n      \"classes\",\r\n      classCode,\r\n      \"realEstateProperties\"\r\n    );\r\n    const q = query(propertiesCollectionRefInstance, firebaseOrderBy(\"id\"));\r\n\r\n    const fetchProperties = async () => {\r\n      if (!mounted) return;\r\n\r\n      try {\r\n        const querySnapshot = await getDocs(q);\r\n        if (!mounted) return;\r\n\r\n        const propsData = querySnapshot.docs.map((doc) => ({\r\n          firestoreDocId: doc.id,\r\n          ...doc.data(),\r\n          lastRentPayment: doc.data().lastRentPayment?.toDate\r\n            ? doc.data().lastRentPayment.toDate()\r\n            : null,\r\n        }));\r\n        propsData.sort((a, b) => parseInt(a.id) - parseInt(b.id));\r\n\r\n        if (mounted) {\r\n          setProperties(propsData);\r\n          setPropertiesLoading(false);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"[RealEstate] Error fetching properties:\", error);\r\n        if (mounted) {\r\n          setProperties([]);\r\n          setPropertiesLoading(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchProperties(); // ì´ˆê¸° ë¡œë“œ\r\n    const interval = setInterval(fetchProperties, 15 * 60 * 1000); // ğŸ”¥ [ìµœì í™”] 15ë¶„ë§ˆë‹¤ í´ë§ (Firestore ì½ê¸° ìµœì†Œí™”)\r\n\r\n    return () => {\r\n      mounted = false;\r\n      clearInterval(interval);\r\n    };\r\n  }, [classCode]);\r\n\r\n  // ğŸ”¥ [ìµœì í™”] í•™ê¸‰ ì‚¬ìš©ì ëª©ë¡ - AuthContextì—ì„œ ì œê³µí•˜ëŠ” allClassMembers ì‚¬ìš© (ì¤‘ë³µ ì¡°íšŒ ì œê±°)\r\n  useEffect(() => {\r\n    if (!classCode) {\r\n      setAllUsersData([]);\r\n      setUsersLoading(false);\r\n      return;\r\n    }\r\n\r\n    // AuthContextì—ì„œ ì´ë¯¸ í•™ê¸‰ êµ¬ì„±ì› ë°ì´í„°ë¥¼ ì œê³µí•˜ë¯€ë¡œ ì¬ì‚¬ìš©\r\n    if (allClassMembers && allClassMembers.length > 0) {\r\n      setAllUsersData(allClassMembers);\r\n      setUsersLoading(false);\r\n    } else {\r\n      // AuthContextì—ì„œ ë°ì´í„°ê°€ ì—†ì„ ê²½ìš°ì—ë§Œ ì§ì ‘ ì¡°íšŒ\r\n      setUsersLoading(true);\r\n      const usersQuery = query(\r\n        collection(db, \"users\"),\r\n        where(\"classCode\", \"==\", classCode)\r\n      );\r\n      getDocs(usersQuery)\r\n        .then((snapshot) => {\r\n          setAllUsersData(\r\n            snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() }))\r\n          );\r\n        })\r\n        .catch((error) => {\r\n          console.error(\"[RealEstate] Error fetching users by classCode:\", error);\r\n          setAllUsersData([]);\r\n        })\r\n        .finally(() => setUsersLoading(false));\r\n    }\r\n  }, [classCode, allClassMembers]);\r\n\r\n  const handleInitializeProperties = async () => {\r\n    if (!classCode || !currentUser || !isAdmin()) {\r\n      alert(\"ì´ˆê¸°í™” ê¶Œí•œì´ ì—†ê±°ë‚˜ í•™ê¸‰ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n    if (\r\n      !window.confirm(\r\n        `ì •ë§ë¡œ í•™ê¸‰ [${classCode}]ì˜ ëª¨ë“  ë¶€ë™ì‚°ì„ ì •ë¶€ ì†Œìœ  ì´ˆê¸°ê°’ìœ¼ë¡œ ë˜ëŒë¦¬ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`\r\n      )\r\n    )\r\n      return;\r\n    setOperationLoading(true);\r\n    try {\r\n      const currentSettings = settings;\r\n      const basePrice = currentSettings.basePrice;\r\n      const rent = Math.round(\r\n        basePrice * (currentSettings.rentPercentage / 100)\r\n      );\r\n      const batch = writeBatch(db);\r\n      const propCollRef = collection(\r\n        db,\r\n        \"classes\",\r\n        classCode,\r\n        \"realEstateProperties\"\r\n      );\r\n      const existingPropsSnapshot = await getDocs(propCollRef);\r\n      existingPropsSnapshot.forEach((doc) => batch.delete(doc.ref));\r\n      for (let i = 1; i <= currentSettings.totalProperties; i++) {\r\n        const propertyIdStr = i.toString();\r\n        const propertyDocRef = doc(propCollRef, propertyIdStr);\r\n        batch.set(propertyDocRef, {\r\n          id: propertyIdStr,\r\n          price: basePrice,\r\n          owner: \"government\",\r\n          ownerName: \"ì •ë¶€\",\r\n          rent: rent,\r\n          tenant: null,\r\n          tenantId: null,\r\n          tenantName: null,\r\n          forSale: false,\r\n          salePrice: 0,\r\n          lastRentPayment: null,\r\n          createdAt: serverTimestamp(),\r\n          updatedAt: serverTimestamp(),\r\n          classCode: classCode,\r\n        });\r\n      }\r\n      await batch.commit();\r\n      alert(\"ë¶€ë™ì‚°ì´ ì„±ê³µì ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.\");\r\n      setShowAdminPanel(false);\r\n    } catch (error) {\r\n      console.error(\"[RealEstate] Error initializing properties:\", error);\r\n      alert(\"ë¶€ë™ì‚° ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ: \" + error.message);\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePurchaseProperty = async (propertyId) => {\r\n    if (!currentUser || !classCode) {\r\n      alert(\"ë¡œê·¸ì¸ì´ í•„ìš”í•˜ê±°ë‚˜ í•™ê¸‰ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n\r\n    const property = properties.find(p => p.id === propertyId);\r\n    if (!property) {\r\n      alert(\"ë¶€ë™ì‚° ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n\r\n    const purchasePrice = property.salePrice || property.price;\r\n\r\n    logger.log('[RealEstate] ë¶€ë™ì‚° êµ¬ë§¤ ì‹œì‘:', { propertyId, purchasePrice });\r\n\r\n    // ğŸ”¥ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ 1: í˜„ê¸ˆ ì°¨ê°\r\n    if (optimisticUpdate) {\r\n      optimisticUpdate({ cash: -purchasePrice });\r\n    }\r\n\r\n    // ğŸ”¥ ë‚™ê´€ì  ì—…ë°ì´íŠ¸ 2: êµ¬ë§¤í•œ ë¶€ë™ì‚°ì— ì¦‰ì‹œ ì…ì£¼ + ì†Œìœ ì ë³€ê²½ (UI ì—…ë°ì´íŠ¸)\r\n    const previousPropertyState = { ...property };\r\n    const previousProperties = [...properties];\r\n\r\n    setProperties(prevProperties =>\r\n      prevProperties.map(p =>\r\n        p.id === propertyId\r\n          ? {\r\n              ...p,\r\n              owner: currentUser.id,\r\n              ownerName: currentUser.name,\r\n              forSale: false,\r\n              salePrice: null,\r\n              tenant: currentUser.name,\r\n              tenantId: currentUser.id,\r\n              tenantName: currentUser.name,\r\n            }\r\n          : {\r\n              ...p,\r\n              // ë‹¤ë¥¸ ë¶€ë™ì‚°ì— ì…ì£¼ ì¤‘ì´ì—ˆë‹¤ë©´ í‡´ê±° ì²˜ë¦¬\r\n              tenant: p.tenantId === currentUser.id ? null : p.tenant,\r\n              tenantId: p.tenantId === currentUser.id ? null : p.tenantId,\r\n              tenantName: p.tenantId === currentUser.id ? null : p.tenantName,\r\n            }\r\n      )\r\n    );\r\n\r\n    setOperationLoading(true);\r\n\r\n    try {\r\n      const purchaseRealEstateFunction = httpsCallable(functions, 'purchaseRealEstate');\r\n      const result = await purchaseRealEstateFunction({ propertyId });\r\n\r\n      logger.log('[RealEstate] êµ¬ë§¤ ì„±ê³µ:', result.data);\r\n\r\n      // ğŸ”¥ ì„œë²„ ë°ì´í„°ì™€ ë™ê¸°í™” (ë‚™ê´€ì  ì—…ë°ì´íŠ¸ í™•ì •)\r\n      await refreshProperties();\r\n\r\n      if (refreshUserDocument) refreshUserDocument();\r\n      setShowQuickAction(null);\r\n      setSelectedProperty(null);\r\n      alert(`ë¶€ë™ì‚° #${propertyId}ë¥¼ ì„±ê³µì ìœ¼ë¡œ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤.`);\r\n    } catch (error) {\r\n      console.error('[RealEstate] êµ¬ë§¤ ì‹¤íŒ¨:', error);\r\n\r\n      // ì‹¤íŒ¨ ì‹œ ë¡¤ë°± 1: í˜„ê¸ˆ ë³µêµ¬\r\n      if (optimisticUpdate) {\r\n        optimisticUpdate({ cash: purchasePrice });\r\n      }\r\n\r\n      // ì‹¤íŒ¨ ì‹œ ë¡¤ë°± 2: ë¶€ë™ì‚° ìƒíƒœ ì „ì²´ ë³µêµ¬ (ì´ì „ ìƒíƒœë¡œ ë˜ëŒë¦¼)\r\n      setProperties(previousProperties);\r\n\r\n      alert(error.message || 'ë¶€ë™ì‚° êµ¬ë§¤ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSetForSale = async (propertyId) => {\r\n    const property = properties.find((p) => p.id === propertyId);\r\n    if (\r\n      !property ||\r\n      !currentUser ||\r\n      property.owner !== currentUser.id ||\r\n      !classCode\r\n    ) {\r\n      alert(\"ì†Œìœ í•œ ë¶€ë™ì‚°ë§Œ íŒë§¤í•  ìˆ˜ ìˆê±°ë‚˜ ì •ë³´ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n    const salePriceInput = prompt(\"íŒë§¤ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš” (ìˆ«ìë§Œ):\");\r\n    if (!salePriceInput) return;\r\n    const salePrice = parseInt(salePriceInput);\r\n    if (isNaN(salePrice) || salePrice <= 0) {\r\n      alert(\"ìœ íš¨í•œ íŒë§¤ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš”.\");\r\n      return;\r\n    }\r\n\r\n    // ğŸ”¥ ë‚™ê´€ì  ì—…ë°ì´íŠ¸: íŒë§¤ ìƒíƒœ ì¦‰ì‹œ ë³€ê²½\r\n    const previousPropertyState = { ...property };\r\n    setProperties(prevProperties =>\r\n      prevProperties.map(p =>\r\n        p.id === propertyId\r\n          ? { ...p, forSale: true, salePrice: salePrice }\r\n          : p\r\n      )\r\n    );\r\n\r\n    setOperationLoading(true);\r\n    const propertyRef = doc(\r\n      db,\r\n      \"classes\",\r\n      classCode,\r\n      \"realEstateProperties\",\r\n      propertyId\r\n    );\r\n    try {\r\n      await updateDoc(propertyRef, {\r\n        forSale: true,\r\n        salePrice: salePrice,\r\n        updatedAt: serverTimestamp(),\r\n      });\r\n\r\n      // ğŸ”¥ ì„œë²„ ë°ì´í„°ì™€ ë™ê¸°í™”\r\n      await refreshProperties();\r\n\r\n      setShowQuickAction(null);\r\n      setSelectedProperty(null);\r\n      alert(\"íŒë§¤ ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\");\r\n    } catch (error) {\r\n      console.error(\"íŒë§¤ ì„¤ì • ì˜¤ë¥˜:\", error);\r\n\r\n      // ì‹¤íŒ¨ ì‹œ ë¡¤ë°±\r\n      setProperties(prevProperties =>\r\n        prevProperties.map(p =>\r\n          p.id === propertyId ? previousPropertyState : p\r\n        )\r\n      );\r\n\r\n      alert(\"íŒë§¤ ì„¤ì • ì¤‘ ì˜¤ë¥˜ ë°œìƒ: \" + error.message);\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n    // ê´€ë¦¬ìê°€ ì •ë¶€ ì†Œìœ  ë¶€ë™ì‚° íŒë§¤ ì„¤ì •\r\n    const handleAdminSetForSale = async (propertyId) => {\r\n        if (!isAdmin()) {\r\n            alert(\"ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.\");\r\n            return;\r\n        }\r\n        const salePriceInput = prompt(\"íŒë§¤ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš” (ìˆ«ìë§Œ):\");\r\n        if (!salePriceInput) return;\r\n        const salePrice = parseInt(salePriceInput);\r\n        if (isNaN(salePrice) || salePrice <= 0) {\r\n            alert(\"ìœ íš¨í•œ íŒë§¤ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš”.\");\r\n            return;\r\n        }\r\n\r\n        // ğŸ”¥ ë‚™ê´€ì  ì—…ë°ì´íŠ¸: íŒë§¤ ìƒíƒœ ì¦‰ì‹œ ë³€ê²½\r\n        const property = properties.find(p => p.id === propertyId);\r\n        const previousPropertyState = property ? { ...property } : null;\r\n        setProperties(prevProperties =>\r\n          prevProperties.map(p =>\r\n            p.id === propertyId\r\n              ? { ...p, forSale: true, salePrice: salePrice }\r\n              : p\r\n          )\r\n        );\r\n\r\n        setOperationLoading(true);\r\n        const propertyRef = doc(db, \"classes\", classCode, \"realEstateProperties\", propertyId);\r\n        try {\r\n            await updateDoc(propertyRef, {\r\n                forSale: true,\r\n                salePrice: salePrice,\r\n                updatedAt: serverTimestamp(),\r\n            });\r\n\r\n            // ğŸ”¥ ì„œë²„ ë°ì´í„°ì™€ ë™ê¸°í™”\r\n            await refreshProperties();\r\n\r\n            setShowQuickAction(null);\r\n            setSelectedProperty(null);\r\n            alert(\"ì •ë¶€ ì†Œìœ  ë¶€ë™ì‚° íŒë§¤ ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\");\r\n        } catch (error) {\r\n            console.error(\"ì •ë¶€ ì†Œìœ  ë¶€ë™ì‚° íŒë§¤ ì„¤ì • ì˜¤ë¥˜:\", error);\r\n\r\n            // ì‹¤íŒ¨ ì‹œ ë¡¤ë°±\r\n            if (previousPropertyState) {\r\n              setProperties(prevProperties =>\r\n                prevProperties.map(p =>\r\n                  p.id === propertyId ? previousPropertyState : p\r\n                )\r\n              );\r\n            }\r\n\r\n            alert(\"ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: \" + error.message);\r\n        } finally {\r\n            setOperationLoading(false);\r\n        }\r\n    };\r\n\r\n    // ê´€ë¦¬ìê°€ ì •ë¶€ ì†Œìœ  ë¶€ë™ì‚° íŒë§¤ ì·¨ì†Œ\r\n    const handleAdminCancelSale = async (propertyId) => {\r\n        if (!isAdmin()) {\r\n            alert(\"ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.\");\r\n            return;\r\n        }\r\n\r\n        // ğŸ”¥ ë‚™ê´€ì  ì—…ë°ì´íŠ¸: íŒë§¤ ì·¨ì†Œ ì¦‰ì‹œ ë°˜ì˜\r\n        const property = properties.find(p => p.id === propertyId);\r\n        const previousPropertyState = property ? { ...property } : null;\r\n        setProperties(prevProperties =>\r\n          prevProperties.map(p =>\r\n            p.id === propertyId\r\n              ? { ...p, forSale: false, salePrice: null }\r\n              : p\r\n          )\r\n        );\r\n\r\n        setOperationLoading(true);\r\n        const propertyRef = doc(db, \"classes\", classCode, \"realEstateProperties\", propertyId);\r\n        try {\r\n            await updateDoc(propertyRef, {\r\n                forSale: false,\r\n                salePrice: 0,\r\n                updatedAt: serverTimestamp(),\r\n            });\r\n\r\n            // ğŸ”¥ ì„œë²„ ë°ì´í„°ì™€ ë™ê¸°í™”\r\n            await refreshProperties();\r\n\r\n            setShowQuickAction(null);\r\n            setSelectedProperty(null);\r\n            alert(\"ì •ë¶€ ì†Œìœ  ë¶€ë™ì‚° íŒë§¤ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.\");\r\n        } catch (error) {\r\n            console.error(\"ì •ë¶€ ì†Œìœ  ë¶€ë™ì‚° íŒë§¤ ì·¨ì†Œ ì˜¤ë¥˜:\", error);\r\n\r\n            // ì‹¤íŒ¨ ì‹œ ë¡¤ë°±\r\n            if (previousPropertyState) {\r\n              setProperties(prevProperties =>\r\n                prevProperties.map(p =>\r\n                  p.id === propertyId ? previousPropertyState : p\r\n                )\r\n              );\r\n            }\r\n\r\n            alert(\"ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: \" + error.message);\r\n        } finally {\r\n            setOperationLoading(false);\r\n        }\r\n    };\r\n\r\n\r\n  const handleCancelSale = async (propertyId) => {\r\n    if (!classCode) return;\r\n\r\n    // ğŸ”¥ ë‚™ê´€ì  ì—…ë°ì´íŠ¸: íŒë§¤ ì·¨ì†Œ ì¦‰ì‹œ ë°˜ì˜\r\n    const property = properties.find(p => p.id === propertyId);\r\n    const previousPropertyState = property ? { ...property } : null;\r\n    setProperties(prevProperties =>\r\n      prevProperties.map(p =>\r\n        p.id === propertyId\r\n          ? { ...p, forSale: false, salePrice: null }\r\n          : p\r\n      )\r\n    );\r\n\r\n    setOperationLoading(true);\r\n    const propertyRef = doc(\r\n      db,\r\n      \"classes\",\r\n      classCode,\r\n      \"realEstateProperties\",\r\n      propertyId\r\n    );\r\n    try {\r\n      await updateDoc(propertyRef, {\r\n        forSale: false,\r\n        salePrice: 0,\r\n        updatedAt: serverTimestamp(),\r\n      });\r\n\r\n      // ğŸ”¥ ì„œë²„ ë°ì´í„°ì™€ ë™ê¸°í™”\r\n      await refreshProperties();\r\n\r\n      setShowQuickAction(null);\r\n      setSelectedProperty(null);\r\n      alert(\"íŒë§¤ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.\");\r\n    } catch (error) {\r\n      console.error(\"íŒë§¤ ì·¨ì†Œ ì˜¤ë¥˜:\", error);\r\n\r\n      // ì‹¤íŒ¨ ì‹œ ë¡¤ë°±\r\n      if (previousPropertyState) {\r\n        setProperties(prevProperties =>\r\n          prevProperties.map(p =>\r\n            p.id === propertyId ? previousPropertyState : p\r\n          )\r\n        );\r\n      }\r\n\r\n      alert(\"íŒë§¤ ì·¨ì†Œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: \" + error.message);\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleTenancy = async (propertyId) => {\r\n    if (!currentUser || !classCode) return;\r\n\r\n    const property = properties.find(p => p.id === propertyId);\r\n    if (!property) {\r\n      alert(\"ë¶€ë™ì‚° ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n\r\n    const isAlreadyTenantElsewhere = properties.some(\r\n      (p) => p.tenantId === currentUser.id && p.id !== propertyId\r\n    );\r\n\r\n    const isTenantOfThisProperty = property.tenantId === currentUser.id;\r\n\r\n    // ğŸ”¥ [ì¶”ê°€] ë‚™ê´€ì  ì—…ë°ì´íŠ¸: í‡´ê±°ì¸ì§€ ì…ì£¼ì¸ì§€ íŒë‹¨\r\n    const isVacating = isTenantOfThisProperty;\r\n\r\n    // ì´ì „ ìƒíƒœ ì €ì¥ (ë¡¤ë°±ìš©)\r\n    const previousProperties = [...properties];\r\n\r\n    if (isVacating) {\r\n      // ğŸ”¥ ë‚™ê´€ì  ì—…ë°ì´íŠ¸: í‡´ê±° ì²˜ë¦¬\r\n      setProperties(prevProperties =>\r\n        prevProperties.map(p =>\r\n          p.id === propertyId\r\n            ? {\r\n                ...p,\r\n                tenant: null,\r\n                tenantId: null,\r\n                tenantName: null,\r\n              }\r\n            : p\r\n        )\r\n      );\r\n    } else {\r\n      // ğŸ”¥ ë‚™ê´€ì  ì—…ë°ì´íŠ¸: ì…ì£¼ ì²˜ë¦¬ + í˜„ê¸ˆ ì°¨ê° + ê¸°ì¡´ ì…ì£¼ì§€ í‡´ê±°\r\n      if (optimisticUpdate) {\r\n        optimisticUpdate({ cash: -property.rent });\r\n      }\r\n\r\n      setProperties(prevProperties =>\r\n        prevProperties.map(p =>\r\n          p.id === propertyId\r\n            ? {\r\n                ...p,\r\n                tenant: currentUser.name,\r\n                tenantId: currentUser.id,\r\n                tenantName: currentUser.name,\r\n              }\r\n            : {\r\n                ...p,\r\n                // ë‹¤ë¥¸ ë¶€ë™ì‚°ì— ì…ì£¼ ì¤‘ì´ì—ˆë‹¤ë©´ í‡´ê±° ì²˜ë¦¬\r\n                tenant: p.tenantId === currentUser.id ? null : p.tenant,\r\n                tenantId: p.tenantId === currentUser.id ? null : p.tenantId,\r\n                tenantName: p.tenantId === currentUser.id ? null : p.tenantName,\r\n              }\r\n        )\r\n      );\r\n    }\r\n\r\n    setOperationLoading(true);\r\n    const propertyRef = doc(\r\n      db,\r\n      \"classes\",\r\n      classCode,\r\n      \"realEstateProperties\",\r\n      propertyId\r\n    );\r\n    const userRef = doc(db, \"users\", currentUser.id);\r\n\r\n    try {\r\n      let transactionResult = null;\r\n\r\n      await runTransaction(db, async (transaction) => {\r\n        const propertyDoc = await transaction.get(propertyRef);\r\n        if (!propertyDoc.exists())\r\n          throw new Error(\"ë¶€ë™ì‚° ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\r\n        const propertyData = propertyDoc.data();\r\n\r\n        const userDoc = await transaction.get(userRef);\r\n        if (!userDoc.exists())\r\n          throw new Error(\"ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\r\n        const userData = userDoc.data();\r\n\r\n        if (propertyData.tenantId === currentUser.id) {\r\n          // í‡´ê±° ì²˜ë¦¬\r\n          transaction.update(propertyRef, {\r\n            tenant: null,\r\n            tenantId: null,\r\n            tenantName: null,\r\n            lastRentPayment: null,\r\n            updatedAt: serverTimestamp(),\r\n          });\r\n          transactionResult = { type: 'vacate' };\r\n          return;\r\n        }\r\n\r\n        if (propertyData.tenantId)\r\n          throw new Error(\"ì´ë¯¸ ë‹¤ë¥¸ ì‚¬ëŒì´ ì…ì£¼í•´ ìˆìŠµë‹ˆë‹¤.\");\r\n        if (isAlreadyTenantElsewhere)\r\n          throw new Error(\r\n            \"ì´ë¯¸ ë‹¤ë¥¸ ë¶€ë™ì‚°ì— ì…ì£¼í•´ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € í‡´ê±°í•´ì•¼ í•©ë‹ˆë‹¤.\"\r\n          );\r\n        if (userData.cash < propertyData.rent)\r\n          throw new Error(\"ì²« ì›”ì„¸ë¥¼ ë‚¼ í˜„ê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤.\");\r\n\r\n        transaction.update(userRef, {\r\n          cash: increment(-propertyData.rent),\r\n          updatedAt: serverTimestamp(),\r\n        });\r\n\r\n        if (propertyData.owner !== \"government\") {\r\n          const ownerRef = doc(db, \"users\", propertyData.owner);\r\n          // ìê¸° ë•…ì— ì…ì£¼í•˜ëŠ” ê²½ìš°, ìê¸° ìì‹ ì—ê²Œ ì›”ì„¸ë¥¼ ë‚´ê²Œ ë˜ë¯€ë¡œ cashëŠ” ë³€ë™ ì—†ìŒ\r\n          if (propertyData.owner !== currentUser.id) {\r\n            transaction.update(ownerRef, {\r\n              cash: increment(propertyData.rent),\r\n              updatedAt: serverTimestamp(),\r\n            });\r\n          }\r\n        }\r\n\r\n        transaction.update(propertyRef, {\r\n          tenant: currentUser.name,\r\n          tenantId: currentUser.id,\r\n          tenantName: currentUser.name,\r\n          lastRentPayment: serverTimestamp(),\r\n          updatedAt: serverTimestamp(),\r\n        });\r\n\r\n        transactionResult = { type: 'moveIn', rent: propertyData.rent };\r\n      });\r\n\r\n      // ğŸ”¥ íŠ¸ëœì­ì…˜ ì™„ë£Œ í›„ ì²˜ë¦¬\r\n      if (transactionResult?.type === 'vacate') {\r\n        alert(\"ì„±ê³µì ìœ¼ë¡œ í‡´ê±°í–ˆìŠµë‹ˆë‹¤.\");\r\n      } else if (transactionResult?.type === 'moveIn') {\r\n        alert(\"ì„±ê³µì ìœ¼ë¡œ ì…ì£¼í–ˆìŠµë‹ˆë‹¤. ì²« ì›”ì„¸ê°€ ì§€ë¶ˆë˜ì—ˆìŠµë‹ˆë‹¤.\");\r\n\r\n        // ğŸ”¥ [ì¤‘ìš”] ìœ ì € ìºì‹œ ë¬´íš¨í™” í›„ ì„œë²„ì—ì„œ ìµœì‹  ë°ì´í„° ê°€ì ¸ì˜¤ê¸°\r\n        if (currentUser?.id) {\r\n          globalCache.invalidate(`user_${currentUser.id}`);\r\n          logger.log('[RealEstate] ì…ì£¼ ì™„ë£Œ - ìœ ì € ìºì‹œ ë¬´íš¨í™”:', currentUser.id);\r\n        }\r\n      }\r\n\r\n      // ğŸ”¥ ì„œë²„ ë°ì´í„°ì™€ ë™ê¸°í™”\r\n      await refreshProperties();\r\n      if (refreshUserDocument) refreshUserDocument();\r\n      setShowQuickAction(null);\r\n      setSelectedProperty(null);\r\n    } catch (error) {\r\n      console.error(\"ì…ì£¼/í‡´ê±° ì²˜ë¦¬ ì˜¤ë¥˜:\", error);\r\n\r\n      // ğŸ”¥ ë¡¤ë°±: ì´ì „ ìƒíƒœë¡œ ë³µêµ¬\r\n      setProperties(previousProperties);\r\n      if (!isVacating && optimisticUpdate) {\r\n        optimisticUpdate({ cash: property.rent });\r\n      }\r\n\r\n      alert(`ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`);\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveSettings = async () => {\r\n    if (!classCode || !isAdmin()) {\r\n      alert(\"ì„¤ì • ì €ì¥ ê¶Œí•œì´ ì—†ê±°ë‚˜ í•™ê¸‰ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n    const newTotal = parseInt(adminInputs.totalProperties);\r\n    const newBasePrice = parseInt(adminInputs.basePrice);\r\n    const newRentPercentage = parseFloat(adminInputs.rentPercentage);\r\n    const newLayoutColumns = parseInt(adminInputs.layoutColumns);\r\n    if (\r\n      isNaN(newTotal) ||\r\n      isNaN(newBasePrice) ||\r\n      isNaN(newRentPercentage) ||\r\n      isNaN(newLayoutColumns) ||\r\n      newTotal <= 0 ||\r\n      newBasePrice <= 0 ||\r\n      newRentPercentage < 0 ||\r\n      newLayoutColumns <= 0\r\n    ) {\r\n      alert(\r\n        \"ìœ íš¨í•˜ì§€ ì•Šì€ ê°’ì´ ìˆìŠµë‹ˆë‹¤. ê°€ê²©, ë¶€ë™ì‚° ê°œìˆ˜, ì¹¸ ìˆ˜ëŠ” 0ë³´ë‹¤ ì»¤ì•¼í•©ë‹ˆë‹¤.\"\r\n      );\r\n      return;\r\n    }\r\n    setOperationLoading(true);\r\n    const newSettingsData = {\r\n      totalProperties: newTotal,\r\n      basePrice: newBasePrice,\r\n      rentPercentage: newRentPercentage,\r\n      layoutColumns: newLayoutColumns,\r\n      updatedAt: serverTimestamp(),\r\n    };\r\n    try {\r\n      const settingsRefInstance = doc(\r\n        db,\r\n        \"classes\",\r\n        classCode,\r\n        \"realEstateSettings\",\r\n        \"settingsDoc\"\r\n      );\r\n      await updateDoc(settingsRefInstance, newSettingsData);\r\n      alert(\r\n        \"ì„¤ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë³€ê²½ëœ ì´ ë¶€ë™ì‚° ê°œìˆ˜ ë“±ì€ 'ë¶€ë™ì‚° ì´ˆê¸°í™”'ë¥¼ í†µí•´ ë°˜ì˜í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\r\n      );\r\n      setShowAdminPanel(false);\r\n    } catch (error) {\r\n      console.error(\"ì„¤ì • ì €ì¥ ì˜¤ë¥˜:\", error);\r\n      alert(\"ì„¤ì • ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: \" + error.message);\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n  // ğŸ”¥ [ì¶”ê°€] ê´€ë¦¬ìê°€ í•™ìƒì„ ê°•ì œë¡œ ë¹ˆ ë¶€ë™ì‚°ì— ì…ì£¼ì‹œí‚¤ëŠ” í•¨ìˆ˜\r\n  const handleAdminAssignSeat = async (userId, userName) => {\r\n    if (!classCode || !currentUser || !isAdmin()) {\r\n      alert(\"ê¶Œí•œì´ ì—†ê±°ë‚˜ í•™ê¸‰ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n\r\n    // ë¹ˆ ë¶€ë™ì‚° ì°¾ê¸° (ì„¸ì…ìê°€ ì—†ëŠ” ë¶€ë™ì‚°)\r\n    const emptyProperties = properties.filter(p => !p.tenantId);\r\n\r\n    if (emptyProperties.length === 0) {\r\n      alert(\"ë°°ì •í•  ìˆ˜ ìˆëŠ” ë¹ˆ ë¶€ë™ì‚°ì´ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n\r\n    // ì²« ë²ˆì§¸ ë¹ˆ ë¶€ë™ì‚° ì„ íƒ\r\n    const targetProperty = emptyProperties[0];\r\n\r\n    if (!window.confirm(\r\n      `'${userName}' í•™ìƒì„ ë¶€ë™ì‚° #${targetProperty.id}ì— ê°•ì œë¡œ ì…ì£¼ì‹œí‚¤ì‹œê² ìŠµë‹ˆê¹Œ?\\n\\nì›”ì„¸: ${(targetProperty.rent / 10000).toFixed(0)}ë§Œì›\\nì†Œìœ ì: ${targetProperty.owner === 'government' ? 'ì •ë¶€' : targetProperty.ownerName}`\r\n    )) {\r\n      return;\r\n    }\r\n\r\n    setOperationLoading(true);\r\n\r\n    // ğŸ”¥ ë‚™ê´€ì  ì—…ë°ì´íŠ¸: ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸\r\n    const previousProperties = [...properties];\r\n    setProperties(prevProperties =>\r\n      prevProperties.map(p =>\r\n        p.id === targetProperty.id\r\n          ? {\r\n              ...p,\r\n              tenant: userName,\r\n              tenantId: userId,\r\n              tenantName: userName,\r\n            }\r\n          : {\r\n              ...p,\r\n              // ê¸°ì¡´ì— ë‹¤ë¥¸ ê³³ì— ì…ì£¼í•´ ìˆì—ˆë‹¤ë©´ í‡´ê±° ì²˜ë¦¬\r\n              tenant: p.tenantId === userId ? null : p.tenant,\r\n              tenantId: p.tenantId === userId ? null : p.tenantId,\r\n              tenantName: p.tenantId === userId ? null : p.tenantName,\r\n            }\r\n      )\r\n    );\r\n\r\n    try {\r\n      const propertyRef = doc(\r\n        db,\r\n        \"classes\",\r\n        classCode,\r\n        \"realEstateProperties\",\r\n        targetProperty.id\r\n      );\r\n      const userRef = doc(db, \"users\", userId);\r\n\r\n      await runTransaction(db, async (transaction) => {\r\n        const propertyDoc = await transaction.get(propertyRef);\r\n        if (!propertyDoc.exists()) {\r\n          throw new Error(\"ë¶€ë™ì‚° ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\r\n        }\r\n        const propertyData = propertyDoc.data();\r\n\r\n        const userDocSnap = await transaction.get(userRef);\r\n        if (!userDocSnap.exists()) {\r\n          throw new Error(\"ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\r\n        }\r\n        const userData = userDocSnap.data();\r\n\r\n        // ì´ë¯¸ ë‹¤ë¥¸ ì‚¬ëŒì´ ì…ì£¼í–ˆëŠ”ì§€ í™•ì¸\r\n        if (propertyData.tenantId) {\r\n          throw new Error(\"ì´ë¯¸ ë‹¤ë¥¸ ì‚¬ëŒì´ ì…ì£¼í•´ ìˆìŠµë‹ˆë‹¤.\");\r\n        }\r\n\r\n        // ğŸ”¥ ê´€ë¦¬ì ê°•ì œ ì…ì£¼ì´ë¯€ë¡œ í˜„ê¸ˆ í™•ì¸ ì—†ì´ ì…ì£¼ ì²˜ë¦¬\r\n        // ì›”ì„¸ëŠ” ì§•ìˆ˜í•˜ì§€ ì•ŠìŒ (ì²« ì›”ì„¸ ë¬´ë£Œ)\r\n        transaction.update(propertyRef, {\r\n          tenant: userName,\r\n          tenantId: userId,\r\n          tenantName: userName,\r\n          lastRentPayment: serverTimestamp(),\r\n          updatedAt: serverTimestamp(),\r\n        });\r\n      });\r\n\r\n      logger.log(`[RealEstate] ê´€ë¦¬ì ê°•ì œ ì…ì£¼ ì™„ë£Œ: ${userName} -> ë¶€ë™ì‚° #${targetProperty.id}`);\r\n      alert(`'${userName}' í•™ìƒì´ ë¶€ë™ì‚° #${targetProperty.id}ì— ì…ì£¼í–ˆìŠµë‹ˆë‹¤.`);\r\n\r\n      // ğŸ”¥ ì„œë²„ ë°ì´í„°ì™€ ë™ê¸°í™”\r\n      await refreshProperties();\r\n\r\n      // ğŸ”¥ [ì¤‘ìš”] ìœ ì € ìºì‹œ ë¬´íš¨í™”\r\n      if (userId) {\r\n        globalCache.invalidate(`user_${userId}`);\r\n        logger.log('[RealEstate] ê°•ì œ ì…ì£¼ - ìœ ì € ìºì‹œ ë¬´íš¨í™”:', userId);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error(\"[RealEstate] ê°•ì œ ì…ì£¼ ì˜¤ë¥˜:\", error);\r\n\r\n      // ğŸ”¥ ë¡¤ë°±: ì´ì „ ìƒíƒœë¡œ ë³µêµ¬\r\n      setProperties(previousProperties);\r\n\r\n      alert(`ê°•ì œ ì…ì£¼ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`);\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n  // ğŸ”¥ [ìµœì í™”] ëª¨ë“  ë¯¸ì…ì£¼ í•™ìƒì„ ìë™ìœ¼ë¡œ ë¹ˆ ë¶€ë™ì‚°ì— ë°°ì • - ë°°ì¹˜ ì“°ê¸°ë¡œ ë³€ê²½\r\n  const handleAdminAssignAllSeats = async () => {\r\n    if (!classCode || !currentUser || !isAdmin()) {\r\n      alert(\"ê¶Œí•œì´ ì—†ê±°ë‚˜ í•™ê¸‰ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n\r\n    const tenantIds = new Set(properties.map((p) => p.tenantId).filter(Boolean));\r\n    const nonTenantsList = allUsersData.filter(\r\n      (user) => !tenantIds.has(user.id) && !user.isAdmin\r\n    );\r\n\r\n    if (nonTenantsList.length === 0) {\r\n      alert(\"ëª¨ë“  í•™ìƒì´ ì´ë¯¸ ì…ì£¼í•´ ìˆìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n\r\n    const emptyProperties = properties.filter(p => !p.tenantId);\r\n\r\n    if (emptyProperties.length < nonTenantsList.length) {\r\n      alert(`ë¹ˆ ë¶€ë™ì‚°ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.\\në¯¸ì…ì£¼ í•™ìƒ: ${nonTenantsList.length}ëª…\\në¹ˆ ë¶€ë™ì‚°: ${emptyProperties.length}ê°œ`);\r\n      return;\r\n    }\r\n\r\n    if (!window.confirm(\r\n      `${nonTenantsList.length}ëª…ì˜ í•™ìƒì„ ìë™ìœ¼ë¡œ ë¹ˆ ë¶€ë™ì‚°ì— ë°°ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`\r\n    )) {\r\n      return;\r\n    }\r\n\r\n    setOperationLoading(true);\r\n\r\n    try {\r\n      // ğŸ”¥ [ìµœì í™”] ë°°ì¹˜ ì“°ê¸°ë¡œ ëª¨ë“  ë°°ì •ì„ í•œ ë²ˆì— ì²˜ë¦¬ (Nê°œ ì“°ê¸° â†’ 1ê°œ ì“°ê¸°)\r\n      const batch = writeBatch(db);\r\n      const assignments = []; // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸ìš©\r\n\r\n      for (let i = 0; i < nonTenantsList.length; i++) {\r\n        const user = nonTenantsList[i];\r\n        const targetProperty = emptyProperties[i];\r\n\r\n        const propertyRef = doc(\r\n          db,\r\n          \"classes\",\r\n          classCode,\r\n          \"realEstateProperties\",\r\n          targetProperty.id\r\n        );\r\n\r\n        batch.update(propertyRef, {\r\n          tenant: user.name,\r\n          tenantId: user.id,\r\n          tenantName: user.name,\r\n          lastRentPayment: serverTimestamp(),\r\n          updatedAt: serverTimestamp(),\r\n        });\r\n\r\n        assignments.push({\r\n          propertyId: targetProperty.id,\r\n          userId: user.id,\r\n          userName: user.name,\r\n        });\r\n\r\n        // ìœ ì € ìºì‹œ ë¬´íš¨í™”\r\n        globalCache.invalidate(`user_${user.id}`);\r\n      }\r\n\r\n      // ğŸ”¥ í•œ ë²ˆì— ì»¤ë°‹ (Firestore ì“°ê¸° ë¹„ìš© ëŒ€í­ ì ˆê°)\r\n      await batch.commit();\r\n\r\n      // ë¡œì»¬ ìƒíƒœ ì¼ê´„ ì—…ë°ì´íŠ¸\r\n      setProperties(prevProperties =>\r\n        prevProperties.map(p => {\r\n          const assignment = assignments.find(a => a.propertyId === p.id);\r\n          if (assignment) {\r\n            return {\r\n              ...p,\r\n              tenant: assignment.userName,\r\n              tenantId: assignment.userId,\r\n              tenantName: assignment.userName,\r\n            };\r\n          }\r\n          return p;\r\n        })\r\n      );\r\n\r\n      logger.log(`[RealEstate] ë°°ì¹˜ ìë™ ë°°ì • ì™„ë£Œ: ${assignments.length}ëª…`);\r\n      alert(`ìë™ ë°°ì • ì™„ë£Œ!\\n\\nì„±ê³µ: ${assignments.length}ëª…`);\r\n\r\n      // ğŸ”¥ ì„œë²„ ë°ì´í„°ì™€ ë™ê¸°í™”\r\n      await refreshProperties();\r\n\r\n    } catch (error) {\r\n      console.error(\"[RealEstate] ìë™ ë°°ì • ì „ì²´ ì˜¤ë¥˜:\", error);\r\n      alert(`ìë™ ë°°ì • ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`);\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n  // â­ï¸ [ìˆ˜ì •ëœ í•¨ìˆ˜] ì›”ì„¸ ì§•ìˆ˜ ë¡œì§ ê°œì„  (ì”ì•¡ ë¶€ì¡± ì‹œ ì „ì•¡ ì§•ìˆ˜)\r\n  // ğŸ”¥ [ì¶”ê°€] ì›”ì„¸ 0ì›ì¸ ë¶€ë™ì‚° ìˆ˜ì • í•¨ìˆ˜\r\n  const handleFixZeroRent = async () => {\r\n    if (!classCode || !currentUser || !isAdmin()) {\r\n      alert(\"ê¶Œí•œì´ ì—†ê±°ë‚˜ í•™ê¸‰ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n\r\n    // ğŸ”¥ [ì¤‘ìš”] í˜„ì¬ ì„¤ì •ê°’ í™•ì¸\r\n    const currentRentPercentage = settings.rentPercentage || 1;\r\n    logger.log(`[FixRent] í˜„ì¬ ì›”ì„¸ ë¹„ìœ¨: ${currentRentPercentage}%`);\r\n\r\n    if (!window.confirm(\r\n      `ì›”ì„¸ê°€ 0ì›ì¸ ë¶€ë™ì‚°ì„ ëª¨ë‘ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\n\\ní˜„ì¬ ì„¤ì •:\\n- ì›”ì„¸ ë¹„ìœ¨: ${currentRentPercentage}%\\n- ê¸°ë³¸ ë¶€ë™ì‚° ê°€ê²©: ${(settings.basePrice / 10000).toFixed(0)}ë§Œì›\\n\\nê° ë¶€ë™ì‚°ì˜ ê°€ê²© Ã— ${currentRentPercentage}%ë¡œ ì›”ì„¸ê°€ ì„¤ì •ë©ë‹ˆë‹¤.`\r\n    )) {\r\n      return;\r\n    }\r\n\r\n    setOperationLoading(true);\r\n    try {\r\n      const propCollRef = collection(db, \"classes\", classCode, \"realEstateProperties\");\r\n      const allPropertiesSnapshot = await getDocs(propCollRef);\r\n\r\n      const batch = writeBatch(db);\r\n      let fixedCount = 0;\r\n\r\n      allPropertiesSnapshot.forEach((propDoc) => {\r\n        const data = propDoc.data();\r\n        // ì›”ì„¸ê°€ 0ì´ê±°ë‚˜ ì—†ëŠ” ê²½ìš°\r\n        if (!data.rent || data.rent === 0) {\r\n          // ğŸ”¥ [ìˆ˜ì •] settingsì˜ rentPercentage ì‚¬ìš©\r\n          const propertyPrice = data.price || settings.basePrice;\r\n          const calculatedRent = Math.round(propertyPrice * (currentRentPercentage / 100));\r\n\r\n          batch.update(propDoc.ref, {\r\n            rent: calculatedRent,\r\n            updatedAt: serverTimestamp(),\r\n          });\r\n          fixedCount++;\r\n          logger.log(`[FixRent] ë¶€ë™ì‚° #${data.id}: ê°€ê²© ${(propertyPrice / 10000).toFixed(0)}ë§Œì› Ã— ${currentRentPercentage}% = ì›”ì„¸ ${(calculatedRent / 10000).toFixed(1)}ë§Œì›`);\r\n        }\r\n      });\r\n\r\n      if (fixedCount > 0) {\r\n        await batch.commit();\r\n        await refreshProperties();\r\n        alert(`ì›”ì„¸ ìˆ˜ì • ì™„ë£Œ!\\n\\n${fixedCount}ê°œ ë¶€ë™ì‚°ì˜ ì›”ì„¸ë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.\\n(ì›”ì„¸ ë¹„ìœ¨: ${currentRentPercentage}%)`);\r\n      } else {\r\n        alert(\"ì›”ì„¸ê°€ 0ì›ì¸ ë¶€ë™ì‚°ì´ ì—†ìŠµë‹ˆë‹¤.\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"[FixRent] ì˜¤ë¥˜:\", error);\r\n      alert(\"ì›”ì„¸ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ ë°œìƒ: \" + error.message);\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCollectRent = async () => {\r\n    if (!classCode || !currentUser || !isAdmin()) {\r\n      alert(\"ì›”ì„¸ ì§•ìˆ˜ ê¶Œí•œì´ ì—†ê±°ë‚˜ í•™ê¸‰ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.\");\r\n      return;\r\n    }\r\n    if (\r\n      !window.confirm(\r\n        `í•™ê¸‰ [${classCode}]ì˜ ëª¨ë“  ì„¸ì…ìë¡œë¶€í„° ì›”ì„¸ë¥¼ ê°•ì œ ì§•ìˆ˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì”ì•¡ ë¶€ì¡± ì‹œ ê°€ì§„ í˜„ê¸ˆì„ ëª¨ë‘ ì§•ìˆ˜)`\r\n      )\r\n    )\r\n      return;\r\n\r\n    setOperationLoading(true);\r\n    let successCount = 0;\r\n    let failCount = 0;\r\n    let unpaidUsers = []; // ë¯¸ë‚©ì ëª…ë‹¨ (ì „ì•¡ ë‚©ë¶€ ëª»í•œ ê²½ìš°)\r\n    const now = serverTimestamp();\r\n    const propCollRef = collection(\r\n      db,\r\n      \"classes\",\r\n      classCode,\r\n      \"realEstateProperties\"\r\n    );\r\n    const rentedPropertiesQuery = query(\r\n      propCollRef,\r\n      where(\"tenantId\", \"!=\", null)\r\n    );\r\n\r\n    try {\r\n      const rentedPropertiesSnapshot = await getDocs(rentedPropertiesQuery);\r\n      if (rentedPropertiesSnapshot.empty) {\r\n        alert(\"ì›”ì„¸ë¥¼ ì§•ìˆ˜í•  ì„¸ì…ìê°€ ìˆëŠ” ë¶€ë™ì‚°ì´ ì—†ìŠµë‹ˆë‹¤.\");\r\n        setOperationLoading(false);\r\n        return;\r\n      }\r\n\r\n      for (const propDoc of rentedPropertiesSnapshot.docs) {\r\n        const property = propDoc.data();\r\n\r\n        if (property.tenantId && property.rent > 0) {\r\n          try {\r\n            // Firestore íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì¼ê´€ì„± ë³´ì¥\r\n            // ğŸ”¥ ì¤‘ìš”: íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ëª¨ë“  ì½ê¸°(get)ë¥¼ ë¨¼ì € ìˆ˜í–‰í•˜ê³ , ê·¸ ë‹¤ìŒ ëª¨ë“  ì“°ê¸°(update)ë¥¼ ìˆ˜í–‰í•´ì•¼ í•¨\r\n            const result = await runTransaction(db, async (transaction) => {\r\n              // ===== 1ë‹¨ê³„: ëª¨ë“  ì½ê¸° ì‘ì—… ìˆ˜í–‰ =====\r\n              const tenantDocRef = doc(db, \"users\", property.tenantId);\r\n              const tenantSnap = await transaction.get(tenantDocRef);\r\n\r\n              if (!tenantSnap.exists()) {\r\n                // ì„¸ì…ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìœ¼ë©´ ê³„ì•½ í•´ì§€ ì²˜ë¦¬\r\n                console.warn(`ì„¸ì…ì ID ${property.tenantId}ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê³„ì•½ì„ ìë™ìœ¼ë¡œ í•´ì§€í•©ë‹ˆë‹¤.`);\r\n                transaction.update(propDoc.ref, {\r\n                  tenantId: null,\r\n                  tenant: null,\r\n                  tenantName: null,\r\n                  lastRentPayment: null,\r\n                  updatedAt: now,\r\n                });\r\n                return {\r\n                  status: \"tenant_not_found\",\r\n                  propertyId: property.id,\r\n                  tenantId: property.tenantId\r\n                };\r\n              }\r\n\r\n              const tenantData = tenantSnap.data();\r\n              const rentAmount = property.rent;\r\n\r\n              // ì§‘ì£¼ì¸ ë¬¸ì„œ ë¯¸ë¦¬ ì½ê¸° (ì“°ê¸° ì „ì— ëª¨ë“  ì½ê¸° ì™„ë£Œ)\r\n              let ownerSnap = null;\r\n              if (property.owner !== \"government\" && property.owner !== property.tenantId) {\r\n                const ownerDocRef = doc(db, \"users\", property.owner);\r\n                ownerSnap = await transaction.get(ownerDocRef);\r\n              }\r\n\r\n              // ===== 2ë‹¨ê³„: ëª¨ë“  ì“°ê¸° ì‘ì—… ìˆ˜í–‰ =====\r\n              // ëˆì´ ë¶€ì¡±í•œ ê²½ìš°: ìˆëŠ” ëˆë§Œ ëª¨ë‘ ì§€ë¶ˆí•˜ê³  ë¯¸ë‚© ì²˜ë¦¬\r\n              if (tenantData.cash < rentAmount) {\r\n                const amountPaid = tenantData.cash; // ì‹¤ì œ ì§€ë¶ˆí•  ê¸ˆì•¡\r\n\r\n                // ì„¸ì…ì ëˆ 0ìœ¼ë¡œ ì—…ë°ì´íŠ¸\r\n                transaction.update(tenantDocRef, {\r\n                  cash: 0,\r\n                  updatedAt: now,\r\n                });\r\n\r\n                // ì§‘ì£¼ì¸ì—ê²Œ ì§€ë¶ˆ (0ì› ì´ìƒì¼ ë•Œ)\r\n                if (amountPaid > 0 && ownerSnap && ownerSnap.exists()) {\r\n                  transaction.update(ownerSnap.ref, {\r\n                    cash: increment(amountPaid),\r\n                    updatedAt: now,\r\n                  });\r\n                }\r\n\r\n                // ë¶€ë™ì‚° ë‚©ë¶€ì¼ ê°±ì‹ \r\n                transaction.update(propDoc.ref, {\r\n                  lastRentPayment: now,\r\n                  updatedAt: now,\r\n                });\r\n\r\n                // ë¯¸ë‚©ìœ¼ë¡œ ê²°ê³¼ ë°˜í™˜\r\n                return {\r\n                  status: \"unpaid\",\r\n                  name: tenantData.name || `ID: ${property.tenantId}`,\r\n                };\r\n              }\r\n\r\n              // ëˆì´ ì¶©ë¶„í•œ ê²½ìš°: ì •ìƒ ë‚©ë¶€\r\n              transaction.update(tenantDocRef, {\r\n                cash: increment(-rentAmount),\r\n                updatedAt: now,\r\n              });\r\n\r\n              if (ownerSnap && ownerSnap.exists()) {\r\n                transaction.update(ownerSnap.ref, {\r\n                  cash: increment(rentAmount),\r\n                  updatedAt: now,\r\n                });\r\n              }\r\n\r\n              transaction.update(propDoc.ref, {\r\n                lastRentPayment: now,\r\n                updatedAt: now,\r\n              });\r\n\r\n              return { status: \"success\" };\r\n            });\r\n\r\n            // íŠ¸ëœì­ì…˜ ê²°ê³¼ì— ë”°ë¼ ì¹´ìš´í„° ë° ë¯¸ë‚©ì ëª…ë‹¨ ì²˜ë¦¬\r\n            if (result.status === \"unpaid\") {\r\n              unpaidUsers.push(result.name);\r\n            } else if (result.status === \"tenant_not_found\") {\r\n              logger.log(`ë¶€ë™ì‚° ID ${result.propertyId}ì˜ ê³„ì•½ì´ í•´ì§€ë˜ì—ˆìŠµë‹ˆë‹¤ (ì„¸ì…ì ${result.tenantId} ë¯¸ì¡´ì¬)`);\r\n              // ê³„ì•½ í•´ì§€ëŠ” ì‹¤íŒ¨ë¡œ ì¹´ìš´íŠ¸í•˜ì§€ ì•ŠìŒ (ìë™ ì²˜ë¦¬)\r\n            } else {\r\n              successCount++;\r\n            }\r\n          } catch (transactionError) {\r\n            console.error(\r\n              `ë¶€ë™ì‚° ID ${property.id} ì›”ì„¸ ì§•ìˆ˜ íŠ¸ëœì­ì…˜ ì‹¤íŒ¨:`,\r\n              transactionError\r\n            );\r\n            failCount++;\r\n          }\r\n        }\r\n      }\r\n\r\n      const settingsRefInstance = doc(\r\n        db,\r\n        \"classes\",\r\n        classCode,\r\n        \"realEstateSettings\",\r\n        \"settingsDoc\"\r\n      );\r\n      await updateDoc(settingsRefInstance, {\r\n        lastRentCollection: now,\r\n        updatedAt: now,\r\n      });\r\n\r\n      let resultMessage = `ì›”ì„¸ ì§•ìˆ˜ ì™„ë£Œ: ì„±ê³µ ${successCount}ê±´, ì‹¤íŒ¨ ${failCount}ê±´, ë¯¸ë‚©(ì”ì•¡ë¶€ì¡±) ${unpaidUsers.length}ê±´.`;\r\n      if (unpaidUsers.length > 0) {\r\n        resultMessage += `\\n\\n[ë¯¸ë‚© í•™ìƒ ëª…ë‹¨]\\n${unpaidUsers.join(\", \")}`;\r\n      }\r\n      alert(resultMessage);\r\n\r\n      if (refreshUserDocument) refreshUserDocument();\r\n    } catch (error) {\r\n      console.error(\"ì›”ì„¸ ì§•ìˆ˜ ì¤‘ ì „ì²´ ì˜¤ë¥˜:\", error);\r\n      alert(\"ì›”ì„¸ ì§•ìˆ˜ ì¤‘ ì‹¬ê°í•œ ì˜¤ë¥˜ ë°œìƒ: \" + error.message);\r\n    } finally {\r\n      setOperationLoading(false);\r\n    }\r\n  };\r\n\r\n  const renderPropertyLayout = () => {\r\n    const layoutProperties = properties.slice(0, settings.totalProperties);\r\n    return (\r\n      <div className=\"property-layout\">\r\n        <h3>ğŸ¢ ë¶€ë™ì‚° ë°°ì¹˜ë„ (í•™ê¸‰: {classCode || \"ì •ë³´ ì—†ìŒ\"})</h3>\r\n        <div\r\n          className=\"layout-grid\"\r\n          style={{\r\n            gridTemplateColumns: `repeat(${settings.layoutColumns}, 1fr)`,\r\n          }}\r\n        >\r\n          {Array.from({ length: settings.totalProperties }, (_, index) => {\r\n            const propertyId = (index + 1).toString();\r\n            const property = layoutProperties.find((p) => p.id === propertyId);\r\n            \r\n            let statusClass = \"layout-cell empty\";\r\n            let title = `#${propertyId}`;\r\n\r\n            if (property) {\r\n                const ownerData = allUsersData?.find((u) => u.id === property.owner);\r\n                const ownerName = property.ownerName || (property.owner === \"government\" ? \"ì •ë¶€\" : ownerData?.name || \"ì†Œìœ ì£¼ ë¶ˆëª…\");\r\n                const tenantData = allUsersData?.find((u) => u.id === property.tenantId);\r\n                const tenantDisplayName = property.tenantName || tenantData?.name;\r\n\r\n                title = `#${propertyId} - ${ownerName}`;\r\n                if (property.tenantId) {\r\n                    title += ` (ì„ì°¨ì¸: ${tenantDisplayName || 'ì„¸ì…ì ë¶ˆëª…'})`;\r\n                }\r\n\r\n                if (property.tenantId === currentUser?.id) {\r\n                    statusClass = \"layout-cell rented-by-me\";\r\n                    title = `#${propertyId} - ${ownerName} (ë‚´ê°€ ì„ì°¨ì¤‘)`;\r\n                } \r\n                else if (property.forSale) {\r\n                    statusClass = \"layout-cell for-sale\";\r\n                } \r\n                else if (property.owner === currentUser?.id) {\r\n                    statusClass = \"layout-cell owned\";\r\n                } \r\n                else if (property.owner === \"government\") {\r\n                    statusClass = \"layout-cell government\";\r\n                } \r\n                else {\r\n                    statusClass = \"layout-cell occupied\";\r\n                }\r\n            }\r\n\r\n            return (\r\n              <div\r\n                key={propertyId}\r\n                className={statusClass}\r\n                onClick={() => property && setShowQuickAction(property)}\r\n                title={title}\r\n              >\r\n                {propertyId}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n        <div className=\"layout-legend\">\r\n          <div className=\"legend-item\">\r\n            <div className=\"legend-color government\"></div>\r\n            <span>ì •ë¶€ ì†Œìœ </span>\r\n          </div>\r\n          <div className=\"legend-item\">\r\n            <div className=\"legend-color owned\"></div>\r\n            <span>ë‚´ ì†Œìœ </span>\r\n          </div>\r\n          <div className=\"legend-item\">\r\n            <div className=\"legend-color rented-by-me-legend\"></div>\r\n            <span>ë‚´ê°€ ì„ì°¨ì¤‘</span>\r\n          </div>\r\n          <div className=\"legend-item\">\r\n            <div className=\"legend-color for-sale\"></div>\r\n            <span>íŒë§¤ì¤‘</span>\r\n          </div>\r\n          <div className=\"legend-item\">\r\n            <div className=\"legend-color occupied\"></div>\r\n            <span>íƒ€ì¸ ì†Œìœ </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderQuickActionModal = () => {\r\n    if (!showQuickAction || !currentUser) return null;\r\n    const property = showQuickAction;\r\n    const isOwner = property.owner === currentUser.id;\r\n    const isTenantOfThisProperty = property.tenantId === currentUser.id;\r\n    const isTenantElsewhere = properties.some(\r\n      (p) => p.tenantId === currentUser.id && p.id !== property.id\r\n    );\r\n    const isGovProperty = property.owner === 'government';\r\n\r\n\r\n    const ownerData = allUsersData?.find((u) => u.id === property.owner);\r\n    const ownerName =\r\n      property.owner === \"government\"\r\n        ? \"ì •ë¶€\"\r\n        : property.ownerName || ownerData?.name || \"ì†Œìœ ì£¼ ë¶ˆëª…\";\r\n    const tenantData = allUsersData?.find((u) => u.id === property.tenantId);\r\n    const tenantName = property.tenantName || tenantData?.name;\r\n\r\n    let tenancyButton;\r\n    if (isTenantOfThisProperty) {\r\n      tenancyButton = (\r\n        <button\r\n          className=\"quick-action-btn btn-rent\"\r\n          onClick={() => handleTenancy(property.id)}\r\n          disabled={operationLoading}\r\n        >\r\n          í‡´ê±°í•˜ê¸°\r\n        </button>\r\n      );\r\n    } else if (property.tenantId) {\r\n      tenancyButton = (\r\n        <button className=\"quick-action-btn btn-rent\" disabled>\r\n          ì…ì£¼ë¶ˆê°€\r\n        </button>\r\n      );\r\n    } else if (isTenantElsewhere) {\r\n      tenancyButton = (\r\n        <button\r\n          className=\"quick-action-btn btn-rent\"\r\n          disabled\r\n          title=\"ë‹¤ë¥¸ ê³³ì— ì…ì£¼í•´ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € í‡´ê±°í•˜ì„¸ìš”.\"\r\n        >\r\n          ì…ì£¼í•˜ê¸°\r\n        </button>\r\n      );\r\n    } else {\r\n      tenancyButton = (\r\n        <button\r\n          className=\"quick-action-btn btn-rent\"\r\n          onClick={() => handleTenancy(property.id)}\r\n          disabled={operationLoading || currentUser.cash < property.rent}\r\n        >\r\n          ì…ì£¼í•˜ê¸°\r\n        </button>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"modal-overlay\" onClick={() => setShowQuickAction(null)}>\r\n        <div\r\n          className=\"quick-action-modal\"\r\n          onClick={(e) => e.stopPropagation()}\r\n        >\r\n          <div className=\"quick-modal-header\">\r\n            <h3>âš¡ ë¹ ë¥¸ ì•¡ì…˜ #{property.id}</h3>\r\n            <button\r\n              className=\"close-btn\"\r\n              onClick={() => setShowQuickAction(null)}\r\n            >\r\n              âœ•\r\n            </button>\r\n          </div>\r\n          <div className=\"quick-modal-content\">\r\n            <div className=\"quick-property-info\">\r\n              <div className=\"quick-info-row\">\r\n                <span className=\"detail-label\">ì†Œìœ ì</span>\r\n                <span className=\"detail-value\">{ownerName}</span>\r\n              </div>\r\n              <div className=\"quick-info-row\">\r\n                <span className=\"detail-label\">ë¶€ë™ì‚° ê°€ê²©</span>\r\n                <span className=\"detail-value\">\r\n                  {(property.price / 10000).toFixed(0)}ë§Œì›\r\n                </span>\r\n              </div>\r\n              <div className=\"quick-info-row\">\r\n                <span className=\"detail-label\">ì›”ì„¸</span>\r\n                <span className=\"detail-value\">\r\n                  {(property.rent / 10000).toFixed(0)}ë§Œì›\r\n                </span>\r\n              </div>\r\n              {tenantName && (\r\n                <div className=\"quick-info-row\">\r\n                  <span className=\"detail-label\">ì„¸ì…ì</span>\r\n                  <span className=\"detail-value\">{tenantName}</span>\r\n                </div>\r\n              )}\r\n              {property.forSale && (\r\n                <div className=\"quick-info-row\">\r\n                  <span className=\"detail-label\">íŒë§¤ê°€ê²©</span>\r\n                  <span\r\n                    className=\"detail-value\"\r\n                    style={{ color: \"#ef4444\", fontWeight: \"bold\" }}\r\n                  >\r\n                    {(property.salePrice / 10000).toFixed(0)}ë§Œì›\r\n                  </span>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"quick-actions\">\r\n              {(isGovProperty || property.forSale) &&\r\n                !isOwner && (\r\n                  <button\r\n                    className=\"quick-action-btn btn-purchase\"\r\n                    onClick={() => handlePurchaseProperty(property.id)}\r\n                    disabled={\r\n                      operationLoading ||\r\n                      currentUser.cash <\r\n                        (property.forSale ? property.salePrice : property.price)\r\n                    }\r\n                  >\r\n                    êµ¬ë§¤í•˜ê¸°\r\n                  </button>\r\n                )}\r\n              {tenancyButton}\r\n              {isOwner && !property.forSale && (\r\n                <button\r\n                  className=\"quick-action-btn btn-sell\"\r\n                  onClick={() => handleSetForSale(property.id)}\r\n                  disabled={operationLoading}\r\n                >\r\n                  íŒë§¤í•˜ê¸°\r\n                </button>\r\n              )}\r\n              {isOwner && property.forSale && (\r\n                <button\r\n                  className=\"quick-action-btn btn-cancel\"\r\n                  onClick={() => handleCancelSale(property.id)}\r\n                  disabled={operationLoading}\r\n                >\r\n                  íŒë§¤ì·¨ì†Œ\r\n                </button>\r\n              )}\r\n              {isAdmin() && isGovProperty && !property.forSale && (\r\n                <button\r\n                    className=\"quick-action-btn btn-sell\"\r\n                    onClick={() => handleAdminSetForSale(property.id)}\r\n                    disabled={operationLoading}\r\n                >\r\n                    (ê´€ë¦¬ì) íŒë§¤ì„¤ì •\r\n                </button>\r\n              )}\r\n              {isAdmin() && isGovProperty && property.forSale && (\r\n                  <button\r\n                      className=\"quick-action-btn btn-cancel\"\r\n                      onClick={() => handleAdminCancelSale(property.id)}\r\n                      disabled={operationLoading}\r\n                  >\r\n                      (ê´€ë¦¬ì) íŒë§¤ì·¨ì†Œ\r\n                  </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderPropertyGrid = () => {\r\n    const activeProperties = properties.slice(0, settings.totalProperties);\r\n    if (activeProperties.length === 0 && !propertiesLoading)\r\n      return (\r\n        <div className=\"loading-message\">\r\n          ë¶€ë™ì‚° ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ê´€ë¦¬ìê°€ ì´ˆê¸°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\r\n        </div>\r\n      );\r\n\r\n    const userIsTenantElsewhere = properties.some(\r\n      (p) => p.tenantId === currentUser?.id\r\n    );\r\n\r\n    return (\r\n      <div className=\"property-grid\">\r\n        {activeProperties.map((property) => {\r\n          const isOwner = currentUser && property.owner === currentUser.id;\r\n          const isTenantOfThisProperty =\r\n            currentUser && property.tenantId === currentUser.id;\r\n          const isGovProperty = property.owner === 'government';\r\n\r\n          const ownerData = allUsersData?.find((u) => u.id === property.owner);\r\n          const ownerName =\r\n            property.owner === \"government\"\r\n              ? \"ì •ë¶€\"\r\n              : property.ownerName || ownerData?.name || \"ì†Œìœ ì£¼ ë¶ˆëª…\";\r\n          const tenantData = allUsersData?.find(\r\n            (u) => u.id === property.tenantId\r\n          );\r\n          const tenantNameDisplay = property.tenantName || tenantData?.name;\r\n          let propertyClass = \"property-card\";\r\n          if (property.owner === \"government\") propertyClass += \" government\";\r\n          else if (isOwner) propertyClass += \" owned\";\r\n          else if (property.forSale) propertyClass += \" for-sale\";\r\n          else propertyClass += \" other-owned\";\r\n\r\n          let tenancyButton;\r\n          if (isTenantOfThisProperty) {\r\n            tenancyButton = (\r\n              <button\r\n                className=\"btn-action btn-rent\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  handleTenancy(property.id);\r\n                }}\r\n                disabled={operationLoading}\r\n              >\r\n                í‡´ê±°\r\n              </button>\r\n            );\r\n          } else if (property.tenantId) {\r\n            tenancyButton = (\r\n              <button className=\"btn-action btn-rent\" disabled>\r\n                ì…ì£¼ë¶ˆê°€\r\n              </button>\r\n            );\r\n          } else if (userIsTenantElsewhere) {\r\n            tenancyButton = (\r\n              <button\r\n                className=\"btn-action btn-rent\"\r\n                disabled\r\n                title=\"ë‹¤ë¥¸ ê³³ì— ì…ì£¼í•´ ìˆìŠµë‹ˆë‹¤.\"\r\n              >\r\n                ì…ì£¼\r\n              </button>\r\n            );\r\n          } else {\r\n            tenancyButton = (\r\n              <button\r\n                className=\"btn-action btn-rent\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  handleTenancy(property.id);\r\n                }}\r\n                disabled={operationLoading || !currentUser || currentUser.cash < property.rent}\r\n              >\r\n                ì…ì£¼\r\n              </button>\r\n            );\r\n          }\r\n\r\n          return (\r\n            <div\r\n              key={property.id}\r\n              className={propertyClass}\r\n              onClick={() => setSelectedProperty(property)}\r\n            >\r\n              <div className=\"property-header\">\r\n                <h4>#{property.id}</h4>\r\n                <div style={{ display: \"flex\", gap: \"0.5rem\" }}>\r\n                  {property.forSale && (\r\n                    <span className=\"sale-badge\">íŒë§¤ì¤‘</span>\r\n                  )}\r\n                  {property.tenantId && (\r\n                    <span className=\"rent-badge\">ì„ëŒ€ì¤‘</span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"property-info\">\r\n                <div className=\"info-row\">\r\n                  <span className=\"label\">ì†Œìœ ì</span>\r\n                  <span className=\"value\">{ownerName}</span>\r\n                </div>\r\n                <div className=\"info-row\">\r\n                  <span className=\"label\">ê°€ê²©</span>\r\n                  <span className=\"value\">\r\n                    {(property.price / 10000).toFixed(0)}ë§Œì›\r\n                  </span>\r\n                </div>\r\n                <div className=\"info-row\">\r\n                  <span className=\"label\">ì›”ì„¸</span>\r\n                  <span className=\"value\">\r\n                    {(property.rent / 10000).toFixed(0)}ë§Œì›\r\n                  </span>\r\n                </div>\r\n                {tenantNameDisplay && (\r\n                  <div className=\"info-row\">\r\n                    <span className=\"label\">ì„¸ì…ì</span>\r\n                    <span className=\"value\">{tenantNameDisplay}</span>\r\n                  </div>\r\n                )}\r\n                {property.forSale && (\r\n                  <div className=\"info-row sale-price\">\r\n                    <span className=\"label\">íŒë§¤ê°€</span>\r\n                    <span className=\"value\">\r\n                      {(property.salePrice / 10000).toFixed(0)}ë§Œì›\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"property-actions\">\r\n                {(isGovProperty || property.forSale) &&\r\n                  !isOwner && (\r\n                    <button\r\n                      className=\"btn-action btn-purchase\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        handlePurchaseProperty(property.id);\r\n                      }}\r\n                      disabled={\r\n                        operationLoading ||\r\n                        !currentUser ||\r\n                        currentUser.cash <\r\n                          (property.forSale\r\n                            ? property.salePrice\r\n                            : property.price)\r\n                      }\r\n                    >\r\n                      êµ¬ë§¤\r\n                    </button>\r\n                  )}\r\n                {tenancyButton}\r\n                {isOwner && !property.forSale && (\r\n                  <button\r\n                    className=\"btn-action btn-sell\"\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleSetForSale(property.id);\r\n                    }}\r\n                    disabled={operationLoading}\r\n                  >\r\n                    íŒë§¤ì„¤ì •\r\n                  </button>\r\n                )}\r\n                {isOwner && property.forSale && (\r\n                  <button\r\n                    className=\"btn-action btn-cancel\"\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      handleCancelSale(property.id);\r\n                    }}\r\n                    disabled={operationLoading}\r\n                  >\r\n                    íŒë§¤ì·¨ì†Œ\r\n                  </button>\r\n                )}\r\n                {isAdmin() && isGovProperty && !property.forSale && (\r\n                    <button\r\n                        className=\"btn-action btn-sell\"\r\n                        onClick={(e) => { e.stopPropagation(); handleAdminSetForSale(property.id); }}\r\n                        disabled={operationLoading}\r\n                    >\r\n                        (ê´€ë¦¬ì)íŒë§¤\r\n                    </button>\r\n                )}\r\n                {isAdmin() && isGovProperty && property.forSale && (\r\n                    <button\r\n                        className=\"btn-action btn-cancel\"\r\n                        onClick={(e) => { e.stopPropagation(); handleAdminCancelSale(property.id); }}\r\n                        disabled={operationLoading}\r\n                    >\r\n                        (ê´€ë¦¬ì)ì·¨ì†Œ\r\n                    </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n  \r\n  if (authLoading || settingsLoading || propertiesLoading || usersLoading) {\r\n    return <div className=\"loading-message\">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>;\r\n  }\r\n\r\n  const tenantIds = new Set(\r\n    properties.map((p) => p.tenantId).filter(Boolean)\r\n  );\r\n  const nonTenants = allUsersData.filter(\r\n    (user) => !tenantIds.has(user.id) && !user.isAdmin\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <div className=\"real-estate-exchange\">\r\n        {operationLoading && <div className=\"loading-overlay\">ì²˜ë¦¬ ì¤‘...</div>}\r\n        <div className=\"exchange-header\">\r\n          <div className=\"header-content\">\r\n            <h1>ğŸ¢ ë¶€ë™ì‚° ê±°ë˜ì†Œ (í•™ê¸‰: {classCode || \"ì •ë³´ ì—†ìŒ\"})</h1>\r\n          </div>\r\n        </div>\r\n        <div className=\"stats-container\">\r\n          <div className=\"stats-bar\">\r\n            <div className=\"stat-item\">\r\n              <div className=\"stat-icon\">ğŸ˜ï¸</div>\r\n              <div className=\"stat-content\">\r\n                <div className=\"stat-value\">{settings.totalProperties}</div>\r\n                <div className=\"stat-label\">ì „ì²´ ë¶€ë™ì‚°</div>\r\n              </div>\r\n            </div>\r\n            <div className=\"stat-item\">\r\n              <div className=\"stat-icon\">ğŸ‘¥</div>\r\n              <div className=\"stat-content\">\r\n                <div className=\"stat-value\">\r\n                  {properties.filter((p) => p.owner !== \"government\").length}\r\n                </div>\r\n                <div className=\"stat-label\">ê°œì¸ ì†Œìœ </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"stat-item\">\r\n              <div className=\"stat-icon\">ğŸ </div>\r\n              <div className=\"stat-content\">\r\n                <div className=\"stat-value\">\r\n                  {properties.filter((p) => p.tenantId).length}\r\n                </div>\r\n                <div className=\"stat-label\">ì„ëŒ€ ì¤‘</div>\r\n              </div>\r\n            </div>\r\n            <div className=\"stat-item\">\r\n              <div className=\"stat-icon\">ğŸ’°</div>\r\n              <div className=\"stat-content\">\r\n                <div className=\"stat-value\">\r\n                  {properties.filter((p) => p.forSale).length}\r\n                </div>\r\n                <div className=\"stat-label\">íŒë§¤ ì¤‘</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"exchange-content\">\r\n          {renderPropertyLayout()}\r\n          {isAdmin() && (\r\n            <div className=\"admin-controls\">\r\n                <button\r\n                    className=\"admin-btn settings\"\r\n                    onClick={() => setShowAdminPanel(true)}\r\n                    style={{ textDecoration: \"none\" }}\r\n                >\r\n                    âš™ï¸ ê´€ë¦¬ì ì„¤ì •\r\n                </button>\r\n              <button\r\n                className=\"admin-btn collect\"\r\n                onClick={handleCollectRent}\r\n                disabled={operationLoading}\r\n              >\r\n                ğŸ’¸ ì›”ì„¸ ì§•ìˆ˜\r\n              </button>\r\n              <button\r\n                className=\"admin-btn settings\"\r\n                onClick={handleFixZeroRent}\r\n                disabled={operationLoading}\r\n              >\r\n                ğŸ”§ ì›”ì„¸ 0ì› ìˆ˜ì •\r\n              </button>\r\n            </div>\r\n          )}\r\n          <div className=\"properties-section\">\r\n            <h2>ğŸ“Š ë¶€ë™ì‚° ëª©ë¡</h2>\r\n            {renderPropertyGrid()}\r\n          </div>\r\n        </div>\r\n        \r\n        {renderQuickActionModal()}\r\n        {selectedProperty && (\r\n          <div\r\n            className=\"modal-overlay\"\r\n            onClick={() => setSelectedProperty(null)}\r\n          >\r\n            <div className=\"property-modal\" onClick={(e) => e.stopPropagation()}>\r\n              <div className=\"modal-header\">\r\n                <h3>â„¹ï¸ ë¶€ë™ì‚° #{selectedProperty.id} ìƒì„¸ì •ë³´</h3>\r\n                <button\r\n                  className=\"close-btn\"\r\n                  onClick={() => setSelectedProperty(null)}\r\n                >\r\n                  âœ•\r\n                </button>\r\n              </div>\r\n              <div className=\"modal-content\">\r\n                <div className=\"property-details\">\r\n                  <div className=\"detail-row\">\r\n                    <span className=\"detail-label\">ì†Œìœ ì</span>\r\n                    <span className=\"detail-value\">\r\n                      {selectedProperty.owner === \"government\"\r\n                        ? \"ì •ë¶€\"\r\n                        : selectedProperty.ownerName ||\r\n                          allUsersData?.find(\r\n                            (u) => u.id === selectedProperty.owner\r\n                          )?.name ||\r\n                          \"ì†Œìœ ì£¼ ë¶ˆëª…\"}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"detail-row\">\r\n                    <span className=\"detail-label\">ë¶€ë™ì‚° ê°€ê²©</span>\r\n                    <span className=\"detail-value\">\r\n                      {selectedProperty.price.toLocaleString()}ì›\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"detail-row\">\r\n                    <span className=\"detail-label\">ì›”ì„¸</span>\r\n                    <span className=\"detail-value\">\r\n                      {selectedProperty.rent.toLocaleString()}ì›\r\n                    </span>\r\n                  </div>\r\n                  {selectedProperty.tenantId && (\r\n                    <div className=\"detail-row\">\r\n                      <span className=\"detail-label\">ì„¸ì…ì</span>\r\n                      <span className=\"detail-value\">\r\n                        {selectedProperty.tenantName ||\r\n                          allUsersData?.find(\r\n                            (u) => u.id === selectedProperty.tenantId\r\n                          )?.name ||\r\n                          \"ì„¸ì…ì ë¶ˆëª…\"}\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  {selectedProperty.forSale && (\r\n                    <div className=\"detail-row sale-highlight\">\r\n                      <span className=\"detail-label\">íŒë§¤ê°€ê²©</span>\r\n                      <span className=\"detail-value\">\r\n                        {selectedProperty.salePrice.toLocaleString()}ì›\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  {selectedProperty.lastRentPayment && (\r\n                    <div className=\"detail-row\">\r\n                      <span className=\"detail-label\">ìµœê·¼ ì›”ì„¸ ë‚©ë¶€ì¼</span>\r\n                      <span className=\"detail-value\">\r\n                        {selectedProperty.lastRentPayment instanceof Date\r\n                          ? selectedProperty.lastRentPayment.toLocaleDateString()\r\n                          : \"ì •ë³´ ì—†ìŒ\"}\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      {showAdminPanel && isAdmin() && (\r\n        <div\r\n          className=\"modal-overlay\"\r\n          onClick={() => setShowAdminPanel(false)}\r\n          style={{\r\n            position: 'fixed',\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            backgroundColor: 'rgba(0, 0, 0, 0.6)',\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            alignItems: 'flex-start',\r\n            zIndex: 999999,\r\n            padding: '2rem 1rem',\r\n            overflowY: 'auto'\r\n          }}\r\n        >\r\n          <div\r\n            className=\"admin-panel\"\r\n            onClick={(e) => e.stopPropagation()}\r\n            style={{\r\n              backgroundColor: 'white',\r\n              borderRadius: '16px',\r\n              boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)',\r\n              width: '100%',\r\n              maxWidth: '600px',\r\n              maxHeight: '90vh',\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              position: 'relative',\r\n              zIndex: 1000000\r\n            }}\r\n          >\r\n            <div className=\"panel-header\">\r\n              <h3>âš™ï¸ ê´€ë¦¬ì ì„¤ì • (í•™ê¸‰: {classCode})</h3>\r\n              <button className=\"close-btn\" onClick={() => setShowAdminPanel(false)}>âœ•</button>\r\n            </div>\r\n            <div className=\"panel-content\">\r\n              <div className=\"form-group\">\r\n                <label>í™œì„±í™”í•  ë¶€ë™ì‚° ê°œìˆ˜ (ë³€ê²½ í›„ 'ë¶€ë™ì‚° ì´ˆê¸°í™”' í•„ìš”)</label>\r\n                <input type=\"number\" min=\"1\" max=\"100\" value={adminInputs.totalProperties} onChange={(e) => setAdminInputs(prev => ({ ...prev, totalProperties: e.target.value }))} />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <label>ë°°ì¹˜ë„ í•œ ì¤„ë‹¹ ì¹¸ ìˆ˜</label>\r\n                <select value={adminInputs.layoutColumns} onChange={(e) => setAdminInputs(prev => ({ ...prev, layoutColumns: e.target.value }))}>\r\n                  {[4, 5, 6, 7, 8, 10].map(n => <option key={n} value={n.toString()}>{n}ì¹¸</option>)}\r\n                </select>\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <label>ê¸°ë³¸ ë¶€ë™ì‚° ê°€ê²© (ì›) (ë³€ê²½ í›„ 'ë¶€ë™ì‚° ì´ˆê¸°í™”' í•„ìš”)</label>\r\n                <input type=\"number\" min=\"1000000\" step=\"1000000\" value={adminInputs.basePrice} onChange={(e) => setAdminInputs(prev => ({ ...prev, basePrice: e.target.value }))} />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <label>ì›”ì„¸ ë¹„ìœ¨ (%) (ë³€ê²½ í›„ 'ë¶€ë™ì‚° ì´ˆê¸°í™”' í•„ìš”)</label>\r\n                <input type=\"number\" min=\"0\" max=\"20\" step=\"0.1\" value={adminInputs.rentPercentage} onChange={(e) => setAdminInputs(prev => ({ ...prev, rentPercentage: e.target.value }))} />\r\n              </div>\r\n              <div className=\"non-tenant-list\">\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px' }}>\r\n                  <h4 style={{ margin: 0 }}>âš ï¸ ë¯¸ì…ì£¼ í•™ìƒ ({nonTenants.length}ëª…)</h4>\r\n                  {nonTenants.length > 0 && (\r\n                    <button\r\n                      onClick={handleAdminAssignAllSeats}\r\n                      disabled={operationLoading}\r\n                      style={{\r\n                        padding: '8px 16px',\r\n                        backgroundColor: '#10b981',\r\n                        color: 'white',\r\n                        border: 'none',\r\n                        borderRadius: '6px',\r\n                        cursor: operationLoading ? 'not-allowed' : 'pointer',\r\n                        fontSize: '13px',\r\n                        fontWeight: '700',\r\n                        opacity: operationLoading ? 0.6 : 1,\r\n                        transition: 'all 0.2s',\r\n                        boxShadow: '0 2px 4px rgba(0,0,0,0.1)'\r\n                      }}\r\n                      onMouseOver={(e) => !operationLoading && (e.target.style.backgroundColor = '#059669')}\r\n                      onMouseOut={(e) => !operationLoading && (e.target.style.backgroundColor = '#10b981')}\r\n                    >\r\n                      ğŸ˜ï¸ ëª¨ë‘ ìë™ ë°°ì •\r\n                    </button>\r\n                  )}\r\n                </div>\r\n                {nonTenants.length > 0 ? (\r\n                  <ul style={{ listStyle: 'none', padding: 0, maxHeight: '300px', overflowY: 'auto' }}>\r\n                    {nonTenants.map(user => (\r\n                      <li key={user.id} style={{\r\n                        display: 'flex',\r\n                        justifyContent: 'space-between',\r\n                        alignItems: 'center',\r\n                        padding: '8px 12px',\r\n                        marginBottom: '6px',\r\n                        backgroundColor: '#f9fafb',\r\n                        borderRadius: '6px',\r\n                        border: '1px solid #e5e7eb'\r\n                      }}>\r\n                        <span style={{ fontWeight: '500' }}>{user.name}</span>\r\n                        <button\r\n                          onClick={() => handleAdminAssignSeat(user.id, user.name)}\r\n                          disabled={operationLoading}\r\n                          style={{\r\n                            padding: '6px 12px',\r\n                            backgroundColor: '#3b82f6',\r\n                            color: 'white',\r\n                            border: 'none',\r\n                            borderRadius: '6px',\r\n                            cursor: operationLoading ? 'not-allowed' : 'pointer',\r\n                            fontSize: '13px',\r\n                            fontWeight: '600',\r\n                            opacity: operationLoading ? 0.6 : 1,\r\n                            transition: 'all 0.2s'\r\n                          }}\r\n                          onMouseOver={(e) => !operationLoading && (e.target.style.backgroundColor = '#2563eb')}\r\n                          onMouseOut={(e) => !operationLoading && (e.target.style.backgroundColor = '#3b82f6')}\r\n                        >\r\n                          ğŸ  ìë¦¬ ë°°ì •\r\n                        </button>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                ) : (\r\n                  <p style={{ color: '#059669', fontWeight: '600', textAlign: 'center', padding: '20px' }}>âœ… ëª¨ë“  í•™ìƒì´ ì…ì£¼í–ˆìŠµë‹ˆë‹¤!</p>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"panel-actions\">\r\n              <button className=\"btn-primary\" onClick={handleSaveSettings} disabled={operationLoading}>ğŸ’¾ ì„¤ì • ì €ì¥</button>\r\n              <button className=\"btn-danger\" onClick={handleInitializeProperties} disabled={operationLoading}>ğŸ”„ ë¶€ë™ì‚° ì´ˆê¸°í™”</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RealEstateRegistry;"],"names":["DEFAULT_SETTINGS","totalProperties","basePrice","rentPercentage","layoutColumns","lastRentCollection","RealEstateRegistry","_allUsersData$find","_allUsersData$find2","userDoc","currentUser","loading","authLoading","isAdmin","refreshUserDocument","optimisticUpdate","allClassMembers","useAuth","classCode","properties","setProperties","useState","settings","setSettings","allUsersData","setAllUsersData","settingsLoading","setSettingsLoading","propertiesLoading","setPropertiesLoading","usersLoading","setUsersLoading","showAdminPanel","setShowAdminPanel","operationLoading","setOperationLoading","selectedProperty","setSelectedProperty","showQuickAction","setShowQuickAction","adminInputs","setAdminInputs","_objectSpread","useEffect","mounted","settingsRefInstance","doc","db","fetchSettings","async","docSnap","getDoc","exists","_fetchedSettings$last","fetchedSettings","data","toDate","toString","setDoc","createdAt","serverTimestamp","updatedAt","error","console","warn","message","interval","setInterval","clearInterval","refreshProperties","React","propertiesCollectionRefInstance","collection","q","query","firebaseOrderBy","propsData","getDocs","docs","map","_doc$data$lastRentPay","firestoreDocId","id","lastRentPayment","sort","a","b","parseInt","logger","log","length","fetchProperties","querySnapshot","_doc$data$lastRentPay2","usersQuery","where","then","snapshot","catch","finally","handlePurchaseProperty","alert","property","find","p","propertyId","purchasePrice","salePrice","price","cash","previousProperties","prevProperties","owner","ownerName","name","forSale","tenant","tenantId","tenantName","purchaseRealEstateFunction","httpsCallable","functions","result","concat","handleSetForSale","salePriceInput","prompt","isNaN","previousPropertyState","propertyRef","updateDoc","handleAdminSetForSale","handleAdminCancelSale","handleCancelSale","handleTenancy","isAlreadyTenantElsewhere","some","isVacating","rent","userRef","_transactionResult","_transactionResult2","transactionResult","runTransaction","propertyDoc","transaction","get","Error","propertyData","userData","update","type","increment","ownerRef","globalCache","invalidate","_jsx","className","children","tenantIds","Set","filter","Boolean","nonTenants","user","has","_jsxs","_Fragment","renderPropertyLayout","layoutProperties","slice","style","gridTemplateColumns","Array","from","_","index","statusClass","title","ownerData","u","tenantData","tenantDisplayName","onClick","textDecoration","window","confirm","successCount","failCount","unpaidUsers","now","propCollRef","rentedPropertiesQuery","rentedPropertiesSnapshot","empty","propDoc","tenantDocRef","tenantSnap","ref","status","rentAmount","ownerSnap","ownerDocRef","amountPaid","push","transactionError","resultMessage","join","disabled","currentRentPercentage","toFixed","allPropertiesSnapshot","batch","writeBatch","fixedCount","forEach","propertyPrice","calculatedRent","Math","round","commit","renderPropertyGrid","activeProperties","userIsTenantElsewhere","isOwner","isTenantOfThisProperty","isGovProperty","tenantNameDisplay","tenancyButton","propertyClass","e","stopPropagation","display","gap","renderQuickActionModal","isTenantElsewhere","color","fontWeight","toLocaleString","Date","toLocaleDateString","position","top","left","right","bottom","backgroundColor","justifyContent","alignItems","zIndex","padding","overflowY","borderRadius","boxShadow","width","maxWidth","maxHeight","flexDirection","min","max","value","onChange","prev","target","n","step","marginBottom","margin","nonTenantsList","emptyProperties","assignments","i","targetProperty","userId","userName","assignment","border","cursor","fontSize","opacity","transition","onMouseOver","onMouseOut","listStyle","userDocSnap","handleAdminAssignSeat","textAlign","newTotal","newBasePrice","newRentPercentage","parseFloat","newLayoutColumns","newSettingsData","currentSettings","delete","propertyIdStr","propertyDocRef","set"],"ignoreList":[],"sourceRoot":""}