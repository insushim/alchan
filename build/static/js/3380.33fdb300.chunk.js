"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[3380],{3380(e,s,t){t.r(s),t.d(s,{default:()=>o});var a=t(5043),n=t(3216),i=t(2864),c=t(5472),r=t(5452);var l=t(579);const o=()=>{const{roomId:e}=(0,n.g)(),[s,t]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[u,h]=(0,a.useState)([]),[m,p]=(0,a.useState)(null),[x,v]=(0,a.useState)(""),[j,b]=(0,a.useState)(!1),[y,N]=(0,a.useState)(""),[f,g]=(0,a.useState)(!1),w=(0,n.Zp)();(0,a.useEffect)(()=>{(async()=>{const s=await(0,c.x7)((0,c.H9)(i.db,"musicRooms",e));s.exists()?t(s.data().name):N("\uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \ubc29\uc785\ub2c8\ub2e4.")})()},[e]);return y?(0,l.jsx)("div",{className:"student-request-container error-container",children:y}):(0,l.jsxs)("div",{className:"student-request-container",children:[(0,l.jsx)("h2",{children:s}),f?(0,l.jsxs)("div",{className:"success-section",children:[(0,l.jsxs)("h3",{children:['"',m.snippet.title,'"']}),(0,l.jsx)("p",{children:"\uc74c\uc545 \uc2e0\uccad\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4!"}),(0,l.jsxs)("div",{className:"success-actions",children:[(0,l.jsx)("button",{onClick:()=>{g(!1),p(null),d(""),h([])},className:"action-btn continue-btn",children:"\uacc4\uc18d \uc2e0\uccad\ud558\uae30"}),(0,l.jsx)("button",{onClick:()=>w("/learning-board/music-request"),className:"action-btn back-btn",children:"\ub3cc\uc544\uac00\uae30"})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o.trim()){b(!0),N("");try{const e=await(async e=>{const s=await fetch("https://www.googleapis.com/youtube/v3/search?part=snippet&q=".concat(encodeURIComponent(e),"&type=video&key=").concat("AIzaSyCLoVzkfTOLt7qtESk0_EKrdogn9nqD9Oc","&maxResults=10"));if(!s.ok){const e=await s.json();throw r.vF.error("YouTube API Error:",e),new Error("YouTube \uc601\uc0c1\uc744 \uac80\uc0c9\ud558\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. API \ud0a4\ub098 \uc694\uccad\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694.")}return(await s.json()).items})(o);h(e),g(!1)}catch(s){N("YouTube \uc601\uc0c1\uc744 \uac80\uc0c9\ud558\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),r.vF.error(s)}finally{b(!1)}}},className:"search-form",children:[(0,l.jsx)("input",{type:"text",className:"search-input",value:o,onChange:e=>d(e.target.value),placeholder:"\uc2e0\uccad\ud560 \ub178\ub798 \uc81c\ubaa9\uc774\ub098 \uc544\ud2f0\uc2a4\ud2b8\ub97c \uac80\uc0c9\ud558\uc138\uc694"}),(0,l.jsx)("button",{type:"submit",className:"search-btn",disabled:j,children:j?"\uac80\uc0c9 \uc911...":"\uac80\uc0c9"})]}),u.length>0&&(0,l.jsxs)("div",{className:"search-results",children:[(0,l.jsx)("h4",{children:"\uac80\uc0c9 \uacb0\uacfc"}),(0,l.jsx)("ul",{className:"video-list",children:u.map(e=>(0,l.jsxs)("li",{className:"video-item ".concat((null===m||void 0===m?void 0:m.id.videoId)===e.id.videoId?"selected":""),onClick:()=>p(e),children:[(0,l.jsx)("img",{src:e.snippet.thumbnails.default.url,alt:e.snippet.title,loading:"lazy",width:"120",height:"90"}),(0,l.jsx)("p",{children:e.snippet.title})]},e.id.videoId))})]}),m&&(0,l.jsxs)("div",{className:"request-section",children:[(0,l.jsx)("h4",{children:"\uc2e0\uccad \uc815\ubcf4"}),(0,l.jsxs)("p",{children:["\uc120\ud0dd\ub41c \uace1: ",m.snippet.title]}),(0,l.jsx)("input",{type:"text",className:"requester-name-input",value:x,onChange:e=>v(e.target.value),placeholder:"\uc2e0\uccad\uc790 \uc774\ub984\uc744 \uc785\ub825\ud558\uc138\uc694"}),(0,l.jsx)("button",{onClick:async()=>{if(m&&x.trim())try{await(0,c.addDoc)((0,c.rJ)(i.db,"musicRooms",e,"playlist"),{videoId:m.id.videoId,title:m.snippet.title,requesterName:x.trim(),requestedAt:(0,c.O5)()}),g(!0)}catch(s){N("\uc74c\uc545\uc744 \uc2e0\uccad\ud558\ub294 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),r.vF.error(s)}else alert("\uc601\uc0c1\uacfc \uc2e0\uccad\uc790 \uc774\ub984\uc744 \ubaa8\ub450 \uc785\ub825\ud574\uc8fc\uc138\uc694.")},className:"request-btn",children:"\uc774 \uace1\uc73c\ub85c \uc2e0\uccad\ud558\uae30"})]})]})]})}}}]);
//# sourceMappingURL=3380.33fdb300.chunk.js.map