/*! For license information please see 718.071a4e18.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[718],{5088(e,s,a){a.d(s,{A:()=>t});const t=(0,a(7784).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},6245(e,s,a){a.d(s,{A:()=>t});const t=(0,a(7784).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},8718(e,s,a){a.r(s),a.d(s,{default:()=>b});var t=a(2555),l=a(5043),r=a(5016),o=a(4689),n=a(5472),c=a(2395),d=a(5088),i=a(2054),p=a(6245);const u=(0,a(7784).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var x=a(5452),m=a(579);const b=()=>{const{userDoc:e}=(0,r.As)(),s=null===e||void 0===e?void 0:e.classCode,[a,b]=(0,l.useState)([]),[g,y]=(0,l.useState)(!0),[f,h]=(0,l.useState)("pending"),[v,k]=(0,l.useState)(null),j=(0,l.useMemo)(()=>(0,c.Qg)(o.Cn,"processTaskApproval"),[]);(0,l.useEffect)(()=>{if(!s)return;const e=(0,n.rJ)(o.db,"pendingApprovals");let a;a="all"===f?(0,n.query)(e,(0,n.where)("classCode","==",s),(0,n.orderBy)("requestedAt","desc")):(0,n.query)(e,(0,n.where)("classCode","==",s),(0,n.where)("status","==",f),(0,n.orderBy)("requestedAt","desc")),y(!0);const l=(0,n.aQ)(a,e=>{const s=e.docs.map(e=>(0,t.A)({id:e.id},e.data()));b(s),y(!1)},e=>{x.vF.error("[AdminApprovalPanel] \uad6c\ub3c5 \uc624\ub958:",e),y(!1)});return()=>l()},[s,f]);const A=(0,l.useCallback)(async(e,s)=>{if(!v){k(e);try{const a=await j({approvalId:e,action:s});a.data.success&&alert(a.data.message)}catch(a){x.vF.error("[AdminApprovalPanel] \ucc98\ub9ac \uc2e4\ud328:",a),alert("\ucc98\ub9ac \uc2e4\ud328: ".concat(a.message))}finally{k(null)}}},[v,j]),N=a.filter(e=>"pending"===e.status).length,C=e=>{if(!e)return"-";return(e.toDate?e.toDate():new Date(e)).toLocaleString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},w=[{key:"pending",label:"\ub300\uae30\uc911",icon:d.A},{key:"approved",label:"\uc2b9\uc778\ub428",icon:i.A},{key:"rejected",label:"\uac70\uc808\ub428",icon:p.A},{key:"all",label:"\uc804\uccb4",icon:u}];return(0,m.jsxs)("div",{className:"max-w-4xl mx-auto p-4 md:p-6",children:[(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsx)("h1",{className:"text-2xl md:text-3xl font-bold mb-2",style:{color:"#e8e8ff"},children:"\ud560\uc77c \uc2b9\uc778 \uad00\ub9ac"}),(0,m.jsx)("p",{className:"text-sm",style:{color:"#9999bb"},children:"\ud559\uc0dd\ub4e4\uc758 \ubcf4\ub108\uc2a4 \ud560\uc77c \uc644\ub8cc \uc694\uccad\uc744 \uc2b9\uc778\ud558\uac70\ub098 \uac70\uc808\ud569\ub2c8\ub2e4."})]}),(0,m.jsx)("div",{className:"flex gap-2 mb-6 flex-wrap",children:w.map(e=>{let{key:s,label:a,icon:t}=e;return(0,m.jsxs)("button",{onClick:()=>h(s),className:"flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-medium transition-all",style:{backgroundColor:f===s?"rgba(99, 102, 241, 0.3)":"rgba(30, 30, 50, 0.6)",border:"1px solid ".concat(f===s?"rgba(99, 102, 241, 0.5)":"rgba(100, 116, 139, 0.2)"),color:f===s?"#818cf8":"#94a3b8",cursor:"pointer"},children:[(0,m.jsx)(t,{size:14}),a,"pending"===s&&N>0&&(0,m.jsx)("span",{className:"ml-1 px-1.5 py-0.5 rounded-full text-xs font-bold",style:{backgroundColor:"rgba(245, 158, 11, 0.3)",color:"#fbbf24"},children:N})]},s)})}),g?(0,m.jsx)("div",{className:"text-center py-12",style:{color:"#9999bb"},children:"\ub85c\ub529 \uc911..."}):0===a.length?(0,m.jsx)("div",{className:"text-center py-12 rounded-xl",style:{backgroundColor:"rgba(20, 20, 35, 0.6)",border:"1px solid rgba(100, 116, 139, 0.15)",color:"#9999bb"},children:"pending"===f?"\ub300\uae30 \uc911\uc778 \uc2b9\uc778 \uc694\uccad\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.":"\ud574\ub2f9\ud558\ub294 \uc694\uccad\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,m.jsx)("div",{className:"space-y-3",children:a.map(e=>{var s;return(0,m.jsx)("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:"rgba(20, 20, 35, 0.6)",border:"1px solid ".concat("pending"===e.status?"rgba(245, 158, 11, 0.3)":"approved"===e.status?"rgba(34, 197, 94, 0.2)":"rgba(239, 68, 68, 0.2)")},children:(0,m.jsxs)("div",{className:"p-4 flex flex-col md:flex-row md:items-center gap-3",children:[(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,m.jsx)("span",{className:"font-bold text-sm",style:{color:"#e8e8ff"},children:e.studentName}),(0,m.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium",style:{backgroundColor:"pending"===e.status?"rgba(245, 158, 11, 0.2)":"approved"===e.status?"rgba(34, 197, 94, 0.2)":"rgba(239, 68, 68, 0.2)",color:"pending"===e.status?"#fbbf24":"approved"===e.status?"#4ade80":"#f87171"},children:"pending"===e.status?"\ub300\uae30\uc911":"approved"===e.status?"\uc2b9\uc778\ub428":"\uac70\uc808\ub428"})]}),(0,m.jsxs)("p",{className:"text-sm mb-1 truncate",style:{color:"#c0c0e0"},children:[e.isJobTask&&e.jobTitle?"[".concat(e.jobTitle,"] "):"",e.taskName]}),(0,m.jsxs)("div",{className:"flex items-center gap-3 text-xs",style:{color:"#9999bb"},children:[(0,m.jsx)("span",{children:"cash"===e.cardType?"\ud83d\udcb0 ".concat(null===(s=e.rewardAmount)||void 0===s?void 0:s.toLocaleString(),"\uc6d0"):"\ud83c\udfab ".concat(e.rewardAmount,"\ucfe0\ud3f0")}),(0,m.jsx)("span",{children:C(e.requestedAt)})]})]}),"pending"===e.status&&(0,m.jsxs)("div",{className:"flex gap-2 flex-shrink-0",children:[(0,m.jsxs)("button",{onClick:()=>A(e.id,"approve"),disabled:v===e.id,className:"flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-medium transition-all cursor-pointer",style:{backgroundColor:"rgba(34, 197, 94, 0.2)",border:"1px solid rgba(34, 197, 94, 0.4)",color:"#4ade80",opacity:v===e.id?.5:1},children:[(0,m.jsx)(i.A,{size:16}),"\uc2b9\uc778"]}),(0,m.jsxs)("button",{onClick:()=>A(e.id,"reject"),disabled:v===e.id,className:"flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm font-medium transition-all cursor-pointer",style:{backgroundColor:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.4)",color:"#f87171",opacity:v===e.id?.5:1},children:[(0,m.jsx)(p.A,{size:16}),"\uac70\uc808"]})]}),"pending"!==e.status&&e.processedAt&&(0,m.jsxs)("div",{className:"text-xs flex-shrink-0",style:{color:"#9999bb"},children:["\ucc98\ub9ac: ",C(e.processedAt)]})]})},e.id)})})]})}}}]);
//# sourceMappingURL=718.071a4e18.chunk.js.map