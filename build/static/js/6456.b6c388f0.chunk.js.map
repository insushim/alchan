{"version":3,"file":"static/js/6456.b6c388f0.chunk.js","mappings":"yLA6Be,SAASA,IACtB,MAAOC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,MA6CrC,OA3CAC,EAAAA,EAAAA,WAAU,KACR,IAzBuBC,OAAOC,UAAUC,UAAUC,SAAS,aAyBtC,OAErB,MAAMC,EAAcC,UAClB,IACE,MAAMC,QAAYC,MAAM,gCAADC,OAhCX,kBAiCiC,oBAC3C,CAAEC,QAAS,CAAEC,OAAQ,oCAEvB,IAAKJ,EAAIK,GAAI,OAEb,MAAMC,QAAgBN,EAAIO,OACpBC,EAAYF,EAAQG,SAG1B,GA9BeC,EAACC,EAAQC,KAC9B,IAAKA,EAAS,OAAO,EACrB,MAAMC,EAAIF,EAAOG,QAAQ,KAAM,IAAIC,MAAM,KAAKC,IAAIC,QAC5CC,EAAIN,EAAQG,MAAM,KAAKC,IAAIC,QACjC,IAAK,IAAIE,EAAI,EAAGA,EAAIC,KAAKC,IAAIR,EAAES,OAAQJ,EAAEI,QAASH,IAAK,CACrD,MAAMI,GAAQV,EAAEM,IAAM,IAAMD,EAAEC,IAAM,GACpC,GAAII,EAAO,EAAG,OAAO,EACrB,GAAIA,EAAO,EAAG,OAAO,CACvB,CACA,OAAO,GAqBGb,CAAeF,EApCDgB,MACxB,MAAMC,EAAQ/B,OAAOC,UAAUC,UAAU6B,MAAM,uBAC/C,OAAOA,EAAQA,EAAM,GAAK,MAgCGD,IAEwB,CAAC,IAADE,EAE7C,MAAMC,EAAyB,QAAjBD,EAAGpB,EAAQsB,cAAM,IAAAF,OAAA,EAAdA,EAAgBG,KAAMhB,GAAMA,EAAEiB,KAAKC,SAAS,SACzDJ,GACFpC,EAAU,CACRyC,QAASxB,EACTyB,YAAaN,EAASO,qBACtBJ,KAAMxB,EAAQwB,MAAI,gBAAA5B,OAAUM,IAGlC,CACF,CAAE,MAAA2B,GACA,GAKEC,EAAYC,WAAWvC,EAAa,KAGpCwC,EAAWC,YAAYzC,EA7DV,OA+DnB,MAAO,KACL0C,aAAaJ,GACbK,cAAcH,KAEf,IAEEhD,GAGHoD,EAAAA,EAAAA,KAAA,OAAKC,UAAU,yCAAwCC,UACrDC,EAAAA,EAAAA,MAAA,OACEF,UAAU,8EACVG,MAAO,CAAEC,WAAY,6CAA8CH,SAAA,EAEnEF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,2GAEfE,EAAAA,EAAAA,MAAA,OAAKF,UAAU,8BAA6BC,SAAA,EAC1CF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,uFAAsFC,UACnGF,EAAAA,EAAAA,KAACM,EAAAA,EAAQ,CAACL,UAAU,+BAGtBE,EAAAA,EAAAA,MAAA,OAAKF,UAAU,iBAAgBC,SAAA,EAC7BF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,mCAAkCC,SAAC,kDAChDF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,yBAAwBC,SAAEtD,EAAOwC,WAGhDY,EAAAA,EAAAA,KAAA,KACEO,KAAM3D,EAAO2C,YACbU,UAAU,sHAAqHC,SAChI,8BAIDF,EAAAA,EAAAA,KAAA,UACEQ,QAASA,IAAM3D,EAAU,MACzBoD,UAAU,qGAAoGC,UAE9GF,EAAAA,EAAAA,KAACS,EAAAA,EAAC,CAACR,UAAU,sBA/BH,IAqCtB,C","sources":["components/AppUpdateChecker.js"],"sourcesContent":["// src/components/AppUpdateChecker.js\n// Android 앱에서만 GitHub Releases 새 버전 체크\nimport React, { useState, useEffect } from \"react\";\nimport { Download, X } from \"lucide-react\";\n\nconst GITHUB_REPO = \"insushim/alchan\"; // GitHub 저장소\nconst CHECK_INTERVAL = 6 * 60 * 60 * 1000; // 6시간마다 체크\n\nconst isAndroidApp = () => window.navigator.userAgent.includes(\"AlchanApp\");\n\n// 현재 APK 버전 (User-Agent에서 추출)\nconst getCurrentVersion = () => {\n  const match = window.navigator.userAgent.match(/AlchanApp\\/([\\d.]+)/);\n  return match ? match[1] : null;\n};\n\n// 버전 비교 (semver)\nconst isNewerVersion = (latest, current) => {\n  if (!current) return false;\n  const a = latest.replace(/^v/, \"\").split(\".\").map(Number);\n  const b = current.split(\".\").map(Number);\n  for (let i = 0; i < Math.max(a.length, b.length); i++) {\n    const diff = (a[i] || 0) - (b[i] || 0);\n    if (diff > 0) return true;\n    if (diff < 0) return false;\n  }\n  return false;\n};\n\nexport default function AppUpdateChecker() {\n  const [update, setUpdate] = useState(null);\n\n  useEffect(() => {\n    if (!isAndroidApp()) return;\n\n    const checkUpdate = async () => {\n      try {\n        const res = await fetch(\n          `https://api.github.com/repos/${GITHUB_REPO}/releases/latest`,\n          { headers: { Accept: \"application/vnd.github.v3+json\" } },\n        );\n        if (!res.ok) return;\n\n        const release = await res.json();\n        const latestTag = release.tag_name; // \"v1.0.5\"\n        const currentVersion = getCurrentVersion();\n\n        if (isNewerVersion(latestTag, currentVersion)) {\n          // APK 다운로드 URL 찾기\n          const apkAsset = release.assets?.find((a) => a.name.endsWith(\".apk\"));\n          if (apkAsset) {\n            setUpdate({\n              version: latestTag,\n              downloadUrl: apkAsset.browser_download_url,\n              name: release.name || `알찬 ${latestTag}`,\n            });\n          }\n        }\n      } catch {\n        // 네트워크 오류 무시\n      }\n    };\n\n    // 앱 시작 1분 후 첫 체크\n    const initTimer = setTimeout(checkUpdate, 60 * 1000);\n\n    // 이후 6시간마다\n    const interval = setInterval(checkUpdate, CHECK_INTERVAL);\n\n    return () => {\n      clearTimeout(initTimer);\n      clearInterval(interval);\n    };\n  }, []);\n\n  if (!update) return null;\n\n  return (\n    <div className=\"fixed bottom-4 left-4 right-4 z-[9990]\">\n      <div\n        className=\"relative rounded-2xl overflow-hidden shadow-2xl border border-indigo-500/40\"\n        style={{ background: \"linear-gradient(135deg, #1a1a2e, #111128)\" }}\n      >\n        <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-indigo-500/60 to-transparent\" />\n\n        <div className=\"p-4 flex items-center gap-3\">\n          <div className=\"flex-shrink-0 w-10 h-10 bg-indigo-500/20 rounded-xl flex items-center justify-center\">\n            <Download className=\"w-5 h-5 text-indigo-400\" />\n          </div>\n\n          <div className=\"flex-1 min-w-0\">\n            <p className=\"text-white font-semibold text-sm\">앱 업데이트 가능</p>\n            <p className=\"text-slate-400 text-xs\">{update.name}</p>\n          </div>\n\n          <a\n            href={update.downloadUrl}\n            className=\"flex-shrink-0 px-3 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-bold rounded-xl transition-colors\"\n          >\n            업데이트\n          </a>\n\n          <button\n            onClick={() => setUpdate(null)}\n            className=\"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full bg-slate-700/60 text-slate-400\"\n          >\n            <X className=\"w-4 h-4\" />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["AppUpdateChecker","update","setUpdate","useState","useEffect","window","navigator","userAgent","includes","checkUpdate","async","res","fetch","concat","headers","Accept","ok","release","json","latestTag","tag_name","isNewerVersion","latest","current","a","replace","split","map","Number","b","i","Math","max","length","diff","getCurrentVersion","match","_release$assets","apkAsset","assets","find","name","endsWith","version","downloadUrl","browser_download_url","_unused","initTimer","setTimeout","interval","setInterval","clearTimeout","clearInterval","_jsx","className","children","_jsxs","style","background","Download","href","onClick","X"],"ignoreList":[],"sourceRoot":""}