"use strict";(self.webpackChunkinconomysu_class=self.webpackChunkinconomysu_class||[]).push([[771],{1771:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var n=s(4919),i=s(5043),r=s(5016),o=s(791),a=s(5472),l=s(577),c=s(9270),d=s(6841),u=s(579);const m={1:[2,4,5],2:[1,3,5],3:[2,4,5],4:[1,3,5],5:[1,2,3,4]},f=[{id:0,x:150,y:30,isHome:"B"},{id:1,x:150,y:90},{id:2,x:230,y:150},{id:3,x:150,y:210},{id:4,x:70,y:150},{id:5,x:150,y:150},{id:6,x:150,y:270,isHome:"R"}],h={0:[1],1:[2,4,5],2:[1,3,5],3:[2,4,5],4:[1,3,5],5:[1,2,3,4],6:[3]},v=[];for(let b=0;b<4;b++)for(let e=0;e<4;e++)v.push({id:4*b+e,x:60+80*e,y:60+80*b,row:b,col:e});const p=[];for(let b=0;b<4;b++)for(let e=0;e<3;e++)p.push([4*b+e,4*b+e+1]);for(let b=0;b<3;b++)for(let e=0;e<4;e++)p.push([4*b+e,4*(b+1)+e]);for(let b=0;b<3;b++)for(let e=0;e<3;e++)p.push([4*b+e,4*(b+1)+e+1]);for(let b=0;b<3;b++)for(let e=1;e<4;e++)p.push([4*b+e,4*(b+1)+e-1]);const y={};for(let b=0;b<16;b++)y[b]=[];p.forEach(e=>{let[t,s]=e;y[t].push(s),y[s].push(t)});const g={umul:{name:"\uc6b0\ubb3c\uace0\ub204",description:"\uac00\uc7a5 \uae30\ubcf8\uc801\uc778 \uace0\ub204. \uac01\uc790 2\uac1c\uc758 \ub9d0\ub85c \uc0c1\ub300\ub97c \ubd09\uc1c4\ud558\uba74 \uc2b9\ub9ac!",rules:["\uac01\uc790 2\uac1c\uc758 \ub9d0\uc744 \uac00\uc9c0\uace0 \uc2dc\uc791\ud569\ub2c8\ub2e4","\ub9d0\uc740 \uc6d0 \ub458\ub808\ub97c \ub530\ub77c \ud55c \uce78\uc529\ub9cc \uc774\ub3d9\ud569\ub2c8\ub2e4","\uc911\uc559(\uc6b0\ubb3c)\uc73c\ub85c\ub294 \uc774\ub3d9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4","\uc0c1\ub300\uc758 \ub9d0\uc774 \ub354 \uc774\uc0c1 \uc6c0\uc9c1\uc77c \uc218 \uc5c6\uac8c \ub9cc\ub4e4\uba74 \uc2b9\ub9ac!","\uc2e4\uc218\ud558\uc9c0 \uc54a\uc73c\uba74 \ubb34\uc2b9\ubd80\uac00 \ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4"],nodes:[{id:1,x:150,y:40},{id:2,x:260,y:150},{id:3,x:150,y:260},{id:4,x:40,y:150},{id:5,x:150,y:150}],edges:[[1,2],[2,3],[3,4],[4,1],[1,5],[5,3],[2,5],[5,4]],adjacency:m,initialPieces:()=>({1:"B",2:"B",3:"R",4:"R"}),piecesPerPlayer:2,boardWidth:300,boardHeight:300,firstMoveRestriction:{from:2,to:5},checkWin:(e,t)=>{const s="B"===t?"R":"B",n=Object.entries(e).filter(e=>{let[,t]=e;return t===s}).map(e=>{let[t]=e;return parseInt(t)});for(const i of n){const t=m[i]||[];for(const s of t)if(!e[s])return null}return t},isWell:e=>5===e},hobak:{name:"\ud638\ubc15\uace0\ub204",description:"\ucd9c\ubc1c\uc120\uc774 \uc788\ub294 \uace0\ub204. \uac01\uc790 3\uac1c\uc758 \ub9d0\ub85c \uc0c1\ub300\ub97c \ubd09\uc1c4\ud558\uba74 \uc2b9\ub9ac!",rules:["\uac01\uc790 3\uac1c\uc758 \ub9d0\uc744 \uac00\uc9c0\uace0 \uc2dc\uc791\ud569\ub2c8\ub2e4","\ub9d0\uc740 \uc120\uc744 \ub530\ub77c \ud55c \uce78\uc529\ub9cc \uc774\ub3d9\ud569\ub2c8\ub2e4","\ucd9c\ubc1c\uc120\uc5d0\uc11c \ub098\uc628 \ub9d0\uc740 \ucd9c\ubc1c\uc120\uc73c\ub85c \ub3cc\uc544\uac08 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4","\uc0c1\ub300 \ucd9c\ubc1c\uc120\uc73c\ub85c\ub3c4 \ub4e4\uc5b4\uac08 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4","\uc0c1\ub300\uc758 \ub9d0\uc774 \ub354 \uc774\uc0c1 \uc6c0\uc9c1\uc77c \uc218 \uc5c6\uac8c \ub9cc\ub4e4\uba74 \uc2b9\ub9ac!"],nodes:f,edges:[[0,1],[1,2],[2,3],[3,4],[4,1],[1,5],[2,5],[3,5],[4,5],[3,6]],adjacency:h,initialPieces:()=>({0:"B",1:"B",4:"B",6:"R",3:"R",2:"R"}),piecesPerPlayer:3,boardWidth:300,boardHeight:300,checkWin:(e,t)=>{const s="B"===t?"R":"B",n=Object.entries(e).filter(e=>{let[,t]=e;return t===s}).map(e=>{let[t]=e;return parseInt(t)});for(const i of n){const t=h[i]||[];for(const s of t)if(!e[s]){const e=f.find(e=>e.id===s);if(null!==e&&void 0!==e&&e.isHome)continue;return null}}return t},getHomeNode:e=>"B"===e?0:6},bat:{name:"\ubc2d\uace0\ub204 (\ub124\uc904\uace0\ub204)",description:"4x4 \uaca9\uc790\uc5d0\uc11c \uc790\uae30 \ub9d0 3\uac1c\ub97c \uc77c\ub82c\ub85c \ub9cc\ub4e4\uba74 \uc0c1\ub300 \ub9d0\uc744 \uc81c\uac70!",rules:["\uac01\uc790 4\uac1c\uc758 \ub9d0\uc744 \uac00\uc9c0\uace0 \uc2dc\uc791\ud569\ub2c8\ub2e4","\ub9d0\uc740 \uc120\uc744 \ub530\ub77c \ud55c \uce78\uc529\ub9cc \uc774\ub3d9\ud569\ub2c8\ub2e4","\uc790\uae30 \ub9d0 3\uac1c\uac00 \uac00\ub85c/\uc138\ub85c/\ub300\uac01\uc120 \uc77c\ub82c\uc774 \ub418\uba74 \uc0c1\ub300 \ub9d0 1\uac1c \uc81c\uac70","\uc0c1\ub300 \ub9d0\uc744 1\uac1c\ub9cc \ub0a8\uae30\uba74 \uc2b9\ub9ac!"],nodes:v,edges:p,adjacency:y,initialPieces:()=>({0:"B",1:"B",2:"B",3:"B",12:"R",13:"R",14:"R",15:"R"}),piecesPerPlayer:4,boardWidth:320,boardHeight:320,checkWin:e=>{const t=Object.values(e).filter(e=>"B"===e).length,s=Object.values(e).filter(e=>"R"===e).length;return t<=1?"R":s<=1?"B":null},checkThreeInRow:(e,t,s)=>{const n=v.find(e=>e.id===t);if(!n)return!1;const{row:i,col:r}=n;for(let o=Math.max(0,r-2);o<=Math.min(1,r);o++){let t=0;for(let n=o;n<o+3&&n<4;n++){e[4*i+n]===s&&t++}if(3===t)return!0}for(let o=Math.max(0,i-2);o<=Math.min(1,i);o++){let t=0;for(let n=o;n<o+3&&n<4;n++){e[4*n+r]===s&&t++}if(3===t)return!0}for(let o=-2;o<=0;o++){let t=0;for(let n=0;n<3;n++){const a=i+o+n,l=r+o+n;if(a>=0&&a<4&&l>=0&&l<4){e[4*a+l]===s&&t++}}if(3===t)return!0}for(let o=-2;o<=0;o++){let t=0;for(let n=0;n<3;n++){const a=i+o+n,l=r-o-n;if(a>=0&&a<4&&l>=0&&l<4){e[4*a+l]===s&&t++}}if(3===t)return!0}return!1}}},x=e=>{const t={};for(const s in e)t[parseInt(s)]=e[s];return t},j=()=>{var e,t,s,m;const{user:h,userDoc:p}=(0,r.As)(),[y,j]=(0,i.useState)(null),[b,B]=(0,i.useState)(null),[N,w]=(0,i.useState)(!0),[k,R]=(0,i.useState)(""),[A,W]=(0,i.useState)({message:"",type:""}),[T,E]=(0,i.useState)(null),[C,H]=(0,i.useState)("umul"),[I,S]=(0,i.useState)([]),[M,G]=(0,i.useState)(!1),[P,O]=(0,i.useState)(!1),[L,_]=(0,i.useState)("pvp"),[z,F]=(0,i.useState)(!1),[V,D]=(0,i.useState)([]),[J,q]=(0,i.useState)(null),[K,Q]=(0,i.useState)(null),U=b&&h&&b.turn===(b.players.B===h.uid?"B":"R"),X=b&&h&&(b.players.B===h.uid?"B":"R"),Y=(0,i.useRef)(y);(0,i.useEffect)(()=>{Y.current=y},[y]);const Z=(0,i.useRef)(b);(0,i.useEffect)(()=>{Z.current=b},[b]);const $=(0,i.useRef)(h);(0,i.useEffect)(()=>{$.current=h},[h]),(0,i.useEffect)(()=>{const e=()=>{const e=Y.current,t=Z.current,s=$.current;e&&t&&s&&"waiting"===t.status&&t.players.B===s.uid&&(0,a.kd)((0,a.H9)(o.db,"gonuGames",e))};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]),(0,i.useEffect)(()=>{if(null===T||void 0===T)return void D([]);const e=(null===K||void 0===K?void 0:K.pieces)||(b?x(b.pieces):{}),t=(null===K||void 0===K?void 0:K.gameType)||(null===b||void 0===b?void 0:b.gameType)||"umul",s=g[t],n=s.adjacency,i=K?"B":X,r=parseInt(T);if(e[r]!==i)return void D([]);const o=[],a=n[r]||[],l=(null===K||void 0===K?void 0:K.moveCount)||0;for(const c of a)if(!e[c]){if("umul"===t&&0===l&&s.firstMoveRestriction){const{from:e,to:t}=s.firstMoveRestriction;if(r===e&&c===t)continue}if("hobak"===t){const e=f.find(e=>e.id===c);if(null!==e&&void 0!==e&&e.isHome)continue}o.push(c)}D(o)},[T,K,b,X]);const ee=(0,i.useCallback)(async()=>{if(h){O(!0);try{const e=(0,a.P)((0,a.rJ)(o.db,"gonuGames"),(0,a._M)("status","==","waiting")),t=await(0,a.GG)(e),s=[];t.forEach(e=>{const t=e.data();t.players.B!==h.uid&&s.push((0,n.A)({id:e.id},t))}),S(s)}catch(e){console.error("Error fetching rooms:",e)}finally{O(!1)}}},[h]);(0,i.useEffect)(()=>{if(N&&h&&"pvp"===L){ee();const e=setInterval(ee,6e4);return()=>clearInterval(e)}},[N,h,ee,L]);const te=(0,i.useCallback)(async()=>{if(!y)return;const e=(0,a.H9)(o.db,"gonuGames",y);try{const t=await(0,a.x7)(e);if(t.exists()){const s=t.data();B(s),w(!1),"finished"===s.status&&setTimeout(async()=>{try{await(0,a.kd)(e)}catch(t){console.error("Error deleting finished game:",t)}},1e4)}else W({message:"\uac8c\uc784\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",type:"error"}),j(null),B(null),w(!0)}catch(t){console.error("Error fetching game data:",t)}},[y]);(0,l.nm)(te,{interval:3e3,enabled:!!y}),(0,i.useEffect)(()=>{if(A.message){const e=setTimeout(()=>W({message:"",type:""}),3e3);return()=>clearTimeout(e)}},[A.message]);const se=(0,i.useRef)(null),ne=(0,i.useRef)(K);(0,i.useEffect)(()=>{ne.current=K},[K]),(0,i.useEffect)(()=>{!K||"active"!==K.status||"R"!==K.turn||z||J||(F(!0),se.current&&clearTimeout(se.current),se.current=setTimeout(()=>{const e=ne.current;if(e&&"R"===e.turn)try{const t=((e,t,s)=>{const i=g[e],r=i.adjacency,o="B"===s?"R":"B",a=Object.entries(t).filter(e=>{let[,t]=e;return t===s}).map(e=>{let[t]=e;return parseInt(t)}),l=[];for(const n of a){const s=r[n]||[];for(const r of s)if(!t[r]){if("hobak"===e){const e=f.find(e=>e.id===r);if(null!==e&&void 0!==e&&e.isHome)continue}"umul"===e&&i.isWell&&i.isWell(r)||l.push({from:n,to:r})}}if(0===l.length)return null;const c=l.map(a=>{let l=0;const c=(0,n.A)({},t);delete c[a.from],c[a.to]=s,i.checkWin(c,s)===s&&(l+=1e3);const d=Object.entries(c).filter(e=>{let[,t]=e;return t===o}).map(e=>{let[t]=e;return parseInt(t)});let u=0;for(const t of d){const s=r[t]||[];for(const t of s)if(!c[t])if("hobak"===e){const e=f.find(e=>e.id===t);null!==e&&void 0!==e&&e.isHome||u++}else"umul"===e&&i.isWell&&i.isWell(t)||u++}if(l-=5*u,"bat"===e){const e=v.find(e=>e.id===a.to);e&&(l-=2*(Math.abs(e.row-1.5)+Math.abs(e.col-1.5))),i.checkThreeInRow(c,a.to,s)&&(l+=100)}return l+=3*Math.random(),(0,n.A)((0,n.A)({},a),{},{score:l})});return c.sort((e,t)=>t.score-e.score),c[0]})(e.gameType,e.pieces,"R");if(t){const s=(0,n.A)({},e.pieces);delete s[t.from],s[t.to]="R";const i=g[e.gameType];if("bat"===e.gameType&&i.checkThreeInRow(s,t.to,"R")){const e=Object.entries(s).filter(e=>{let[,t]=e;return"B"===t}).map(e=>{let[t]=e;return parseInt(t)});if(e.length>0){delete s[e[Math.floor(Math.random()*e.length)]]}}const r=i.checkWin(s,"R");Q((0,n.A)((0,n.A)({},e),{},{pieces:s,turn:"B",status:r?"finished":"active",winner:r,moveCount:(e.moveCount||0)+1}))}else Q((0,n.A)((0,n.A)({},e),{},{status:"finished",winner:"B"}))}catch(t){console.error("AI move error:",t)}finally{F(!1)}else F(!1)},1200))},[null===K||void 0===K?void 0:K.turn,null===K||void 0===K?void 0:K.status,z,J]);const ie=()=>{const e=g[C];Q({gameType:C,pieces:e.initialPieces(),turn:"B",status:"active",winner:null,moveCount:0}),w(!1)},re=async()=>{if(!h)return void W({message:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.",type:"error"});O(!0);const e=Math.random().toString(36).substring(2,8),t=(0,a.H9)(o.db,"gonuGames",e),s=g[C],n={pieces:s.initialPieces(),players:{B:h.uid,R:null},playerNames:{B:p.name,R:null},turn:"B",status:"waiting",winner:null,gameType:C,gameName:s.name,createdAt:(0,a.O5)()};try{await(0,a.BN)(t,n),j(e),W({message:"".concat(s.name," \ubc29 \uc0dd\uc131 \uc644\ub8cc! \ucf54\ub4dc: ").concat(e),type:"success"}),await te()}catch(i){console.error("Error creating room:",i),W({message:"\ubc29 \uc0dd\uc131\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",type:"error"})}finally{O(!1)}},oe=async e=>{const t=e||k.trim();if(!t)return void W({message:"\ucc38\uac00\ud560 \ubc29 \ucf54\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694.",type:"error"});if(!h)return void W({message:"\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.",type:"error"});O(!0);const s=(0,a.H9)(o.db,"gonuGames",t);try{await(0,a.c4)(o.db,async e=>{const t=await e.get(s);if(!t.exists())throw new Error("\ubc29\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");const n=t.data();if(n.players.R)throw new Error("\ubc29\uc774 \uac00\ub4dd \ucc3c\uc2b5\ub2c8\ub2e4.");if(n.players.B===h.uid)throw new Error("\uc790\uc2e0\uc774 \ub9cc\ub4e0 \ubc29\uc5d0\ub294 \ucc38\uac00\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");e.update(s,{"players.R":h.uid,"playerNames.R":p.name,status:"active"})}),j(t),await te()}catch(n){console.error("Error joining room: ",n),W({message:"\ucc38\uac00 \uc2e4\ud328: ".concat(n.message),type:"error"})}finally{O(!1)}},ae=e=>{if(!J)return;const t=(null===K||void 0===K?void 0:K.pieces)||x(b.pieces),s="B"===J.capturer?"R":"B";if(t[e]!==s)return void W({message:"\uc0c1\ub300\ubc29\uc758 \ub9d0\uc744 \uc120\ud0dd\ud558\uc138\uc694.",type:"error"});const i=(0,n.A)({},t);delete i[e];const r=g[(null===K||void 0===K?void 0:K.gameType)||b.gameType].checkWin(i,J.capturer);K&&Q(e=>(0,n.A)((0,n.A)({},e),{},{pieces:i,turn:"B"===J.capturer?"R":"B",status:r?"finished":"active",winner:r})),q(null)},le=(0,i.useCallback)(async e=>{if(J)return void ae(e);if(null===T)return;if(K){if("active"!==K.status||"B"!==K.turn)return;const t=K.pieces;if("B"!==t[T])return;if(!V.includes(e))return void W({message:"\uc774\ub3d9\ud560 \uc218 \uc5c6\ub294 \uc704\uce58\uc785\ub2c8\ub2e4.",type:"error"});const s=(0,n.A)({},t);delete s[T],s[e]="B";const i=g[K.gameType];if("bat"===K.gameType&&i.checkThreeInRow(s,e,"B"))return Q(e=>(0,n.A)((0,n.A)({},e),{},{pieces:s})),q({capturer:"B"}),E(null),void W({message:"3\uc5f0\uc18d! \uc81c\uac70\ud560 \uc0c1\ub300 \ub9d0\uc744 \uc120\ud0dd\ud558\uc138\uc694.",type:"success"});const r=i.checkWin(s,"B");return Q(e=>(0,n.A)((0,n.A)({},e),{},{pieces:s,turn:"R",status:r?"finished":"active",winner:r,moveCount:(e.moveCount||0)+1})),E(null),void("B"===r&&W({message:"\ud83c\udf89 \uc2b9\ub9ac\ud588\uc2b5\ub2c8\ub2e4!",type:"success"}))}if(!U||!b)return;if(x(b.pieces)[T]!==X)return;if(!V.includes(e))return void W({message:"\uc774\ub3d9\ud560 \uc218 \uc5c6\ub294 \uc704\uce58\uc785\ub2c8\ub2e4.",type:"error"});const t=(0,a.H9)(o.db,"gonuGames",y);try{await(0,a.c4)(o.db,async s=>{const i=await s.get(t);if(!i.exists())throw new Error("\uac8c\uc784\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");const r=i.data();if(r.turn!==X)throw new Error("\uc0c1\ub300\ubc29\uc758 \ud134\uc785\ub2c8\ub2e4.");const l=(0,n.A)({},x(r.pieces));delete l[T],l[e]=X;const d=g[b.gameType].checkWin(l,X),u="B"===X?"R":"B";if(s.update(t,{pieces:l,turn:u,status:d?"finished":"active",winner:d}),d){const e=(0,a.H9)(o.db,"users",h.uid);s.update(e,{coupons:(0,a.GV)(1)}),(0,c.Mx)(o.db,{classCode:null===p||void 0===p?void 0:p.classCode,userId:h.uid,userName:(null===p||void 0===p?void 0:p.name)||"\uc0ac\uc6a9\uc790",type:c.gI.GAME_WIN,description:"".concat(b.gameName||"\uace0\ub204"," \uc2b9\ub9ac - \ucfe0\ud3f0 1\uac1c \ud68d\ub4dd"),couponAmount:1,metadata:{gameType:"gonu",gameVariant:b.gameType,gameName:b.gameName}})}}),E(null)}catch(s){console.error("Move error:",s),W({message:"\uc774\ub3d9 \uc2e4\ud328: ".concat(s.message),type:"error"})}},[y,b,U,X,T,null===h||void 0===h?void 0:h.uid,K,V,J]);if(N)return(0,u.jsx)("div",{className:"gonu-container",children:(0,u.jsxs)("div",{className:"room-creation",children:[(0,u.jsx)("h2",{children:"\ud83c\udfaf \uace0\ub204 \uac8c\uc784"}),(0,u.jsx)("p",{children:"\ud55c\uad6d \uc804\ud1b5 \ubcf4\ub4dc\uac8c\uc784\uc744 \uc990\uaca8\ubcf4\uc138\uc694!"}),A.message&&(0,u.jsx)("div",{className:"feedback ".concat(A.type),children:A.message}),(0,u.jsxs)("div",{className:"game-mode-selector",children:[(0,u.jsx)("h3",{children:"\ud83c\udfae \uac8c\uc784 \ubaa8\ub4dc"}),(0,u.jsxs)("div",{className:"mode-buttons",children:[(0,u.jsx)("button",{className:"mode-btn ".concat("ai"===L?"selected":""),onClick:()=>_("ai"),children:"\ud83e\udd16 AI \ub300\uc804"}),(0,u.jsx)("button",{className:"mode-btn ".concat("pvp"===L?"selected":""),onClick:()=>_("pvp"),children:"\ud83d\udc65 \uce5c\uad6c \ub300\uc804"})]})]}),(0,u.jsxs)("div",{className:"game-type-selector",children:[(0,u.jsx)("h3",{children:"\uac8c\uc784 \uc885\ub958 \uc120\ud0dd"}),(0,u.jsx)("div",{className:"game-types",children:Object.entries(g).map(e=>{let[t,s]=e;return(0,u.jsxs)("label",{className:"game-type-option ".concat(C===t?"selected":""),children:[(0,u.jsx)("input",{type:"radio",value:t,checked:C===t,onChange:e=>H(e.target.value)}),(0,u.jsxs)("div",{className:"game-type-info",children:[(0,u.jsx)("strong",{children:s.name}),(0,u.jsx)("small",{children:s.description})]})]},t)})}),(0,u.jsx)("button",{onClick:()=>G(!M),className:"rules-toggle-btn",children:M?"\uaddc\uce59 \uc228\uae30\uae30":"\uaddc\uce59 \ubcf4\uae30"}),M&&(0,u.jsxs)("div",{className:"rules-display",children:[(0,u.jsxs)("h4",{children:[g[C].name," \uaddc\uce59"]}),(0,u.jsx)("ul",{children:g[C].rules.map((e,t)=>(0,u.jsx)("li",{children:e},t))})]})]}),(0,u.jsx)("div",{className:"room-actions",children:"ai"===L?(0,u.jsx)("button",{onClick:ie,className:"create-room-btn",disabled:P,children:"\ud83e\udd16 AI\uc640 \ub300\uc804 \uc2dc\uc791"}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{onClick:re,className:"create-room-btn",disabled:P,children:P?(0,u.jsx)("span",{className:"loading"}):"\uc0c8\ub85c\uc6b4 \ubc29 \ub9cc\ub4e4\uae30"}),(0,u.jsxs)("div",{className:"join-room",children:[(0,u.jsx)("input",{type:"text",value:k,onChange:e=>R(e.target.value),placeholder:"\ubc29 \ucf54\ub4dc \uc785\ub825",maxLength:"6"}),(0,u.jsx)("button",{onClick:()=>oe(),disabled:P,children:P?(0,u.jsx)("span",{className:"loading"}):"\ucf54\ub4dc\ub85c \ucc38\uac00"})]})]})}),"pvp"===L&&I.length>0&&(0,u.jsxs)("div",{className:"available-rooms",children:[(0,u.jsx)("h3",{children:"\ud83d\udccb \ub300\uae30 \uc911\uc778 \ubc29 \ubaa9\ub85d"}),(0,u.jsx)("div",{className:"rooms-list",children:I.map(e=>(0,u.jsxs)("div",{className:"room-item",children:[(0,u.jsxs)("div",{className:"room-info",children:[(0,u.jsx)("span",{className:"room-type",children:e.gameName}),(0,u.jsxs)("span",{className:"room-host",children:["\ud638\uc2a4\ud2b8: ",e.playerNames.B]}),(0,u.jsxs)("span",{className:"room-code",children:["\ucf54\ub4dc: ",e.id]})]}),(0,u.jsxs)("div",{className:"room-item-buttons",children:[(0,u.jsx)("button",{onClick:()=>oe(e.id),className:"join-btn",disabled:P,children:"\ucc38\uac00"}),(null===p||void 0===p?void 0:p.isAdmin)&&(0,u.jsx)("button",{onClick:()=>(async e=>{if(null!==p&&void 0!==p&&p.isAdmin)try{await(0,a.kd)((0,a.H9)(o.db,"gonuGames",e)),W({message:"\ubc29 ".concat(e,"\uac00 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),type:"success"}),ee()}catch(t){console.error("Error deleting room by admin:",t),W({message:"\ubc29 \uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",type:"error"})}else W({message:"\uc0ad\uc81c \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.",type:"error"})})(e.id),className:"delete-btn",children:"\uc0ad\uc81c"})]})]},e.id))})]})]})});if(!K&&!b)return(0,u.jsx)(d.AlchanLoading,{});const ce=(null===K||void 0===K?void 0:K.gameType)||(null===b||void 0===b?void 0:b.gameType)||"umul",de=(null===K||void 0===K?void 0:K.status)||(null===b||void 0===b?void 0:b.status),ue=(null===K||void 0===K?void 0:K.winner)||(null===b||void 0===b?void 0:b.winner),me=(null===K||void 0===K?void 0:K.turn)||(null===b||void 0===b?void 0:b.turn);return(0,u.jsxs)("div",{className:"gonu-container",children:[(0,u.jsxs)("div",{className:"game-info",children:[(0,u.jsxs)("h2",{children:[g[ce].name,K&&" (AI \ub300\uc804)",y&&" (\ubc29: ".concat(y,")")]}),!K&&(0,u.jsxs)("div",{className:"player-info",children:[(0,u.jsxs)("p",{className:"player-b ".concat("B"===me?"active-turn":""),children:["\ud83d\udd35 ",(null===b||void 0===b||null===(e=b.playerNames)||void 0===e?void 0:e.B)||"\ud50c\ub808\uc774\uc5b4 1"," ",(null===b||void 0===b||null===(t=b.players)||void 0===t?void 0:t.B)===(null===h||void 0===h?void 0:h.uid)&&"(\ub098)"]}),(0,u.jsxs)("p",{className:"player-r ".concat("R"===me?"active-turn":""),children:["\ud83d\udd34 ",(null===b||void 0===b||null===(s=b.playerNames)||void 0===s?void 0:s.R)||"\ub300\uae30\uc911..."," ",(null===b||void 0===b||null===(m=b.players)||void 0===m?void 0:m.R)===(null===h||void 0===h?void 0:h.uid)&&"(\ub098)"]})]}),K&&(0,u.jsxs)("div",{className:"player-info",children:[(0,u.jsx)("p",{className:"player-b ".concat("B"===me?"active-turn":""),children:"\ud83d\udd35 \ub098 (\ud30c\ub791)"}),(0,u.jsxs)("p",{className:"player-r ".concat("R"===me?"active-turn":""),children:["\ud83d\udd34 AI (\uc801) ",z&&"\ud83e\udd14 \uc0dd\uac01 \uc911..."]})]}),"finished"===de?(0,u.jsx)("div",{className:"game-status winner",children:K?"B"===ue?"\ud83c\udf89 \uc2b9\ub9ac\ud588\uc2b5\ub2c8\ub2e4!":"\ud83d\ude22 AI\uc5d0\uac8c \ud328\ubc30\ud588\uc2b5\ub2c8\ub2e4.":ue===X?"\ud83c\udf89 \uc2b9\ub9ac! \ucfe0\ud3f0 1\uac1c\ub97c \ud68d\ub4dd\ud588\uc2b5\ub2c8\ub2e4!":"\ud83d\ude22 \ud328\ubc30\ud588\uc2b5\ub2c8\ub2e4."}):"waiting"===de?(0,u.jsx)("div",{className:"game-status",children:"\uc0c1\ub300\ubc29\uc744 \uae30\ub2e4\ub9ac\ub294 \uc911..."}):J?(0,u.jsx)("div",{className:"game-status capture-mode",children:"\ud83c\udfaf \uc81c\uac70\ud560 \uc0c1\ub300 \ub9d0\uc744 \uc120\ud0dd\ud558\uc138\uc694!"}):(0,u.jsx)("div",{className:"game-status",children:K?"B"===me?"\ud83c\udfaf \ub2f9\uc2e0\uc758 \ud134\uc785\ub2c8\ub2e4.":"\u23f3 AI\uac00 \uc0dd\uac01 \uc911...":U?"\ud83c\udfaf \ub2f9\uc2e0\uc758 \ud134\uc785\ub2c8\ub2e4.":"\u23f3 \uc0c1\ub300\ubc29\uc758 \ud134\uc744 \uae30\ub2e4\ub9ac\ub294 \uc911..."})]}),(0,u.jsx)("div",{className:"board-area",children:(()=>{const e=(null===K||void 0===K?void 0:K.gameType)||(null===b||void 0===b?void 0:b.gameType)||"umul",t=g[e],s=(null===K||void 0===K?void 0:K.pieces)||(b?x(b.pieces):{}),n=(null===K||void 0===K?void 0:K.turn)||(null===b||void 0===b?void 0:b.turn);return(0,u.jsxs)("svg",{className:"gonu-svg-board",width:t.boardWidth,height:t.boardHeight,viewBox:"0 0 ".concat(t.boardWidth," ").concat(t.boardHeight),style:{width:"100%",maxWidth:t.boardWidth,height:"auto"},children:[(0,u.jsx)("rect",{x:"0",y:"0",width:t.boardWidth,height:t.boardHeight,fill:"#2a2a3a",rx:"10"}),"umul"===e&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("circle",{cx:150,cy:150,r:110,fill:"none",stroke:"#555",strokeWidth:"3"}),(0,u.jsx)("line",{x1:150,y1:40,x2:150,y2:260,stroke:"#555",strokeWidth:"3"}),(0,u.jsx)("line",{x1:40,y1:150,x2:260,y2:150,stroke:"#555",strokeWidth:"3"})]}),"umul"!==e&&t.edges.map((e,s)=>{let[n,i]=e;const r=t.nodes.find(e=>e.id===n),o=t.nodes.find(e=>e.id===i);return(0,u.jsx)("line",{x1:r.x,y1:r.y,x2:o.x,y2:o.y,stroke:"#555",strokeWidth:"3"},"edge-".concat(s))}),t.nodes.map(n=>{const i=s[n.id],r=T===n.id,o=V.includes(n.id),a="umul"===e&&t.isWell&&t.isWell(n.id),l=n.isHome,c=J&&i&&i!==J.capturer;return(0,u.jsxs)("g",{onClick:()=>(e=>{if(J)return void ae(e);const t=(null===K||void 0===K?void 0:K.pieces)||(b?x(b.pieces):{}),s=(null===K||void 0===K?void 0:K.turn)||(null===b||void 0===b?void 0:b.turn),n=K?"B":X;"active"===((null===K||void 0===K?void 0:K.status)||(null===b||void 0===b?void 0:b.status))&&(K&&"B"!==s||(K||U)&&(t[e]!==n?null===T||t[e]||le(e):E(e)))})(n.id),style:{cursor:"pointer"},children:[(0,u.jsx)("circle",{cx:n.x,cy:n.y,r:a?20:22,fill:a?"#333":o?"#4a7":l?"B"===l?"#334":"#433":"#444",stroke:r?"#0ff":o?"#4f7":c?"#f44":"#666",strokeWidth:r||o||c?3:2}),a&&(0,u.jsx)("text",{x:n.x,y:n.y+5,textAnchor:"middle",fill:"#666",fontSize:"12",fontWeight:"bold",children:"\uc6b0\ubb3c"}),l&&!i&&(0,u.jsx)("text",{x:n.x,y:n.y+5,textAnchor:"middle",fill:"B"===l?"#88f":"#f88",fontSize:"10",children:"\ucd9c\ubc1c"}),i&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("circle",{cx:n.x,cy:n.y,r:18,fill:"B"===i?"#1a5fb4":"#c00",stroke:"B"===i?"#62a0ea":"#f66",strokeWidth:"3"}),(0,u.jsx)("circle",{cx:n.x-5,cy:n.y-5,r:6,fill:"B"===i?"#62a0ea":"#f44",opacity:"0.6"})]}),o&&!i&&(0,u.jsx)("circle",{cx:n.x,cy:n.y,r:8,fill:"#4f7",opacity:"0.6"})]},"node-".concat(n.id))}),(0,u.jsx)("text",{x:t.boardWidth/2,y:t.boardHeight-8,textAnchor:"middle",fill:"#aaa",fontSize:"11",children:"B"===n?"\ud83d\udd35 \ud30c\ub791 \ucc28\ub840":"\ud83d\udd34 \ube68\uac15 \ucc28\ub840"})]})})()}),A.message&&(0,u.jsx)("div",{className:"feedback ".concat(A.type),children:A.message}),(0,u.jsx)("button",{onClick:async()=>{if(K)return Q(null),w(!0),E(null),void q(null);if(b&&"waiting"===b.status&&y&&b.players.B===h.uid)try{await(0,a.kd)((0,a.H9)(o.db,"gonuGames",y))}catch(e){console.error("Error deleting room:",e)}j(null),B(null),w(!0),E(null),q(null)},className:"leave-button",children:"finished"===de?"\ub098\uac00\uae30":"\uac8c\uc784 \ub098\uac00\uae30"})]})}}}]);
//# sourceMappingURL=771.d42e7f18.chunk.js.map